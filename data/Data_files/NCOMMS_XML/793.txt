article id="http://dx.doi.org/10.1038/NCOMMS14106"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Prediction and real-time compensation of qubit decoherence via machine learning  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
'The wide-ranging adoption of quantum technologies requires practical, high-performance advances in our ability to maintain quantum coherence while facing the challenge of state collapse under measurement.  #@NEW_LINE#@#  Here we use techniques from control theory and machine learning to predict the future evolution of a qubits state; we deploy this information to suppress stochastic, semiclassical decoherence, even when access to measurements is limited.  #@NEW_LINE#@#  First, we implement a time-division multiplexed approach, interleaving measurement periods with periods of unsupervised but stabilised operation during which qubits are available, for example, in quantum information experiments.  #@NEW_LINE#@#  Second, we employ predictive feedback during sequential but time delayed measurements to reduce the Dick effect as encountered in passive frequency standards.  #@NEW_LINE#@#  Both experiments demonstrate significant improvements in qubit-phase stability over traditional measurement-based feedback approaches by exploiting time domain correlations in the noise processes.  #@NEW_LINE#@#  This technique requires no additional hardware and is applicable to all two-level quantum systems where projective measurements are possible.'  #@NEW_LINE#@#  

Introduction  #@NEW_LINE#@#  
'The applications of quantum-enabled technologies are compelling and already demonstrating significant impacts, especially in the realm of sensing1,2,3,4,5 and metrology6.  #@NEW_LINE#@#  However, in nearly all applications the phenomenon of decoherenceeffectively the randomization of a quantum systems state by the environmentlimits the viability of quantum technologies.  #@NEW_LINE#@#  In the case of qubits, fundamental building blocks in many applications, the net result is that the useful lifetime of the qubit state is shortened, reducing their deployability for quantum information7, quantum simulation8,9,10,11,12,13 or other applications.  #@NEW_LINE#@#  Methodologies for stabilising qubits against decoherence represent a critical need in quantum technology.  #@NEW_LINE#@#  ', 'Control engineering14 techniques are emerging as a promising alternative to engineering passive robustness at the device level in realising stable quantum systems15,16,17,18.  #@NEW_LINE#@#  Beyond widely adopted open-loop control18,19,20, a qubit subjected to stochastic evolution of its phase degree of freedomdephasing (inset Fig 1a
)can be stabilised by cyclically performing measurements on the qubit and then compensating for the measured phase evolution in a feedback loop21,22,23.  #@NEW_LINE#@#  However, so far, feedback control24,25,26,27,28 has largely been limited by state-collapse under projective measurement, mandating access to weak measurements22 or ancilla states29, or largely sacrificing useful quantum coherence in the controlled system23.  #@NEW_LINE#@#  ', 'Figure 1: Prediction of the future evolution of a qubit subject to stochastic dephasing.  #@NEW_LINE#@#  (a) The average, random phase evolution of the qubit during each measurement under the influence of an engineered noise trace, A, is probed via Ramsey spectroscopy and a projective measurement performed before the qubit state is reinitialised and the process repeated (Supplementary Methods).  #@NEW_LINE#@#  Time is represented in discrete increments of t, approximately corresponding to the measurement time.  #@NEW_LINE#@#  Values of tk0 refer to past measurements used to make predictions and tk0 refer to future predictions.  #@NEW_LINE#@#  Noise possesses a quasi-white power spectral density up to frequency cut-off c, which we sample at s=40c.  #@NEW_LINE#@#  Future qubit evolution is calculated offline based on these measurements.  #@NEW_LINE#@#  Data labelled n=1* correspond to traditional feedback (no prediction).  #@NEW_LINE#@#  (inset) Bloch sphere representation of randomization of qubit phase.  #@NEW_LINE#@#  (b) Correlation between M(tk) and A(tk) represented as a scatter plot for all measurements in this data set.  #@NEW_LINE#@#  Ellipses are guides to the eye calculated to have major and minor axis determined by the eigenvectors of the datas covariance matrix.  #@NEW_LINE#@#  The Pearson product-moment correlation coefficient, r, is calculated to quantify the quality of the measurementshere 97%.  #@NEW_LINE#@#  (c) Normalized r.m.s.  #@NEW_LINE#@#  errors  between A(tk) and P(tk) as a function of past measurements and discrete steps forward in time, averaged over all elements of the data set.  #@NEW_LINE#@#  Data are normalized to the lowest overall value in the field and are presented using a logarithmic scale to highlight differences over a broad dynamic range.  #@NEW_LINE#@#  The first row corresponds to traditional feedback.Full size image', 'Figure 2: Experimental time-division multiplexing for qubit stabilization against dephasing.  #@NEW_LINE#@#  (a) Schematics showing the key aspects of the implementation.  #@NEW_LINE#@#  Noise is continuously injected into the system.  #@NEW_LINE#@#  Measurements are taken up to t0 and processed in real-time to predict future evolution of the qubit phase many time steps ahead, P(tk).  #@NEW_LINE#@#  From t0 measurement-free compensation based on P(tk) is applied during each discrete time step (light green arrows) up to tk when a diagnostic measurement is performed to verify the accuracy of the prediction/correction process.  #@NEW_LINE#@#  Full details appear in Supplementary Methods.  #@NEW_LINE#@#  (b) Probe and stabilization cycles of a time-division multiplexed measurement using n=100 past measurements and prediction/correction up to k=50 time steps ahead.  #@NEW_LINE#@#  Green shading indicates reduced residual phase errors.  #@NEW_LINE#@#  (c) r.m.s.  #@NEW_LINE#@#  results from time-division multiplexed measurements for different tk and n compared against traditional feedback and averaged over 50 unique stabilization periods.  #@NEW_LINE#@#  Data are normalized to the r.m.s.  #@NEW_LINE#@#  of A indicated by the horizontal dashed line.  #@NEW_LINE#@#  The other dotted/dashed lines are simulations.  #@NEW_LINE#@#  Markers represent the averaged results of diagnostic measurements.  #@NEW_LINE#@#  For these data s=40c.Full size image', 'Our objective is to enhance the performance of incoherent feedback stabilization (that is, using only classical information) of a qubit experiencing dephasing while also relaxing the need for projective measurements.  #@NEW_LINE#@#  Our approach is based on predictive control; a variety of techniques in filtering14,30,31,32 and machine learning33 allow the estimation of future state evolution based on past measurement outcomes of the system.  #@NEW_LINE#@#  Here, we deploy a well established algorithm from machine learning to learn about a random dephasing process affecting a qubit, and then predict the impact of future dephasing based only on standard projective measurements.  #@NEW_LINE#@#  We use this information to perform real-time stabilization of the qubit state during periods in which the qubit is unsupervised but still subject to stochastic dephasing.  #@NEW_LINE#@#  Our method exploits the presence of commonly encountered temporal correlations in the dephasing process34 to allow future prediction; no deterministic model of qubit state evolution is required.  #@NEW_LINE#@#  To the best of our knowledge, despite its ubiquity in classical settings, predictive control has not been employed in the context of quantum-coherent technologies.'  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
'Supervised learning based on qubit-phase measurements', 'In the language of machine learning, we consider the qubits instantaneous phase which we would like to predict at a future discretized time, tk, as labels, P(tk), and an arbitrary number, n, of previous measurements, iM (indexed by i and obtained by any appropriate method), as their associated features.  #@NEW_LINE#@#  We then calculate a linear combination of the features with optimized weighting coefficients, w={w}i,k, as a prediction of the label, .  #@NEW_LINE#@#  Based on measured features, the entries of w are optimized for each time step, tk, reflecting the time-varying correlations in the dephasing process, captured through the power spectrum.  #@NEW_LINE#@#  ', 'We demonstrate prediction of a qubits state subject to stochastic dephasing by performing experiments using the ground-state hyperfine states, |F=0, mF=0 and |F=1, mF=0, in trapped 171Yb+ ions as a qubit with transition frequency near 12.6 GHz.  #@NEW_LINE#@#  A coherent superposition of the qubit states in the measurement basis induced by microwave control35 evolves freely under the influence of an engineered dephasing interaction larger than any intrinsic noise in our experimental system (Supplementary Methods).  #@NEW_LINE#@#  In general we work in a regime where the noise evolves slowly during a single measurement period TM, but we allow the rate at which measurements of qubit-phase evolution are takenthe sampling frequency sto vary relative to the highest frequency in the noise power spectrum, c (c.f.  #@NEW_LINE#@#  Fig 3f).  #@NEW_LINE#@#  The dephasing noise processes presented here are all derived from a flat-top frequency power spectrum with characteristic cut-off at c. More complex spectra are discussed in Supplementary Discussion and demonstrate similar performance.  #@NEW_LINE#@#  ', 'Figure 3: Experimental comparison of long-term stabilization using traditional and predictive feedback.  #@NEW_LINE#@#  (a) Schematics showing the key aspects of our cyclic feedback implementation using overlapping measurements.  #@NEW_LINE#@#  (bd) Demonstration of feedback accuracy for different sampling frequencies s quantified in units of c, presented through correlation plots (c.f.  #@NEW_LINE#@#  Fig 1c) for traditional feedback (blue) and prediction (magenta).  #@NEW_LINE#@#  Data presented are derived from Fig 1a.  #@NEW_LINE#@#  (e) Measured sample variance for various protocols as a function of the number of cycles.  #@NEW_LINE#@#  Data are normalized to the sample variance of the uncorrected (free-running) signal at 1,000 samples.  #@NEW_LINE#@#  Each line represents data taken for one particular noise realization and thick lines represent the ensemble average.  #@NEW_LINE#@#  The inset shows an example suppression of variance over measurement outcomes using predictive against traditional feedback (normalized to the noise amplitude).  #@NEW_LINE#@#  (f) Sample variance at N=1,000 as a function of sampling frequency s in units of c, normalized to the sample variance of the uncorrected signal.  #@NEW_LINE#@#  The measurement time is fixed and s varied through introduction of dead time between measurements.  #@NEW_LINE#@#  Dotted lines display simulations and markers the measurement results averaged over ten noise realizations.  #@NEW_LINE#@#  Error bars represent the s.d.  #@NEW_LINE#@#  of the mean and the shaded areas show the maximum spread of outcomes.  #@NEW_LINE#@#  For fixed noise parameters varying s serves as a proxy for changing the ratio of  (Supplementary Discussion).  #@NEW_LINE#@#  Simulations and measurements in all panels use n=20.Full size image', 'An important aspect of our approach is that measurements providing data serving as features may be performed through any suitable protocol.  #@NEW_LINE#@#  For instance, performing a series of p projective measurements on a single qubit to obtain ensemble-averaged information simply sets the scale of the measurement period, , with  the duration of a single experiment.  #@NEW_LINE#@#  Here, we employ a projective measurement that captures statistical information through a spatial ensemble.  #@NEW_LINE#@#  The impact of such differences is explicitly captured in the sampling frequency of the measurement process.  #@NEW_LINE#@#  ', 'Forward prediction of stochastic qubit-phase evolution', 'We begin by accumulating a series of projective measurements of the qubits phase under engineered dephasing.  #@NEW_LINE#@#  These serve as training data for the algorithm to optimize the coefficients in w. We then perform another series of measurements (shown, Fig 1a) under application of a different noise process possessing similar statistical characteristics as used in acquiring the training data.  #@NEW_LINE#@#  This approach ensures that our estimates of prediction accuracy are conservative and exhibit reasonable model robustness and generality.  #@NEW_LINE#@#  Performing the learning algorithm on a single data set can enhance performance of the prediction algorithm but introduces extreme sensitivity to the input model, ultimately reducing prediction efficacy in the presence of variations in the detailed form of the noise.  #@NEW_LINE#@#  ', 'An example engineered noise trace in time with overlaid measurement outcomes, M, is depicted in Fig 1a, with 97% correlation between M and the applied phase A (Fig 1b).  #@NEW_LINE#@#  Beyond time t0 we predict future labels of qubit-phase evolution P(tk), up to step t150 using a variable number, n, of past measurements and the trained coefficients in w. Calculated predictions approximate A well, reproducing key features including inflection points, maxima and minima as a function of tk.  #@NEW_LINE#@#  Our knowledge of the noise is used exclusively for quantitative evaluation of prediction efficacyit does not enter into the machine-learning algorithm in any form.  #@NEW_LINE#@#  ', 'Prediction accuracy increases with n, as the algorithm learns more about the temporal correlations in A.  #@NEW_LINE#@#  For values of kn, corresponding to prediction times exceeding the range over which the algorithm possesses knowledge about the noise features, the prediction quality diminishes.  #@NEW_LINE#@#  In addition, over very large values of tk the prediction tends towards the mean of the noise.  #@NEW_LINE#@#  Comparing predictive estimation to a traditional feedback model, in which future estimates are based simply on the last measured value M(t0), the algorithm shows a distinct advantage as it allows for temporal evolution of the noise in the future.  #@NEW_LINE#@#  ', 'The quantitative benefits of predictive estimation relative to traditional feedback, and the large tk behaviour of the predictive algorithm are succinctly captured in the root-mean-square (r.m.s.)  #@NEW_LINE#@#  prediction error averaged over the entire data set, , and calculated as a function of tk and n (Fig 1c).  #@NEW_LINE#@#  This demonstrates that even over a large ensemble of predictions the algorithms advantages remain robust.  #@NEW_LINE#@#  We now move on to provide examples of real-time qubit stabilization in which the incorporation of future state prediction shows significant advantages over existing techniques.  #@NEW_LINE#@#  ', 'Time-division multiplexed decoherence suppression', 'As described above, a reliance on feedback involving frequent projective measurements renders a qubit effectively useless for quantum information or other applications, but omission of stabilization techniques in the presence of dephasing noise may lead to phase errors and eventually to total decoherence.  #@NEW_LINE#@#  To mitigate the effect of dephasing, we tailor an approach in which we temporally multiplex the necessary measurement and actuation operations in distinct probe and stabilization periods respectively (Fig 2a,b).  #@NEW_LINE#@#  During the probe period, a fixed number of measurements are taken and processed in real time.  #@NEW_LINE#@#  From these measurement outcomes the algorithm produces a prediction of the future time-dependent evolution of the noise during the subsequent stabilization period up to some tk; the qubit is dedicated exclusively to measurement of the dephasing process in the probe period.  #@NEW_LINE#@#  During the stabilization period, corrections are applied during each discrete time step to compensate the predicted stochastic phase evolution, but no measurements are conducted; this permits periods of unsupervised evolution during which the qubit is useful and stabilised against dephasing.  #@NEW_LINE#@#  ', 'As an example we set the objective of maintaining zero net qubit-phase accumulation (in the rotating frame) during each time step of the stabilization period such that arbitrary high-fidelity operations may be conducted on the qubit; here we apply only the identity.  #@NEW_LINE#@#  Diagnostic measurements are performed after a variable number of corrections to demonstrate the efficacy of this approach but would not ordinarily be required.  #@NEW_LINE#@#  Two representative S probe/stabilization cycles are displayed in Fig 2b showing a reduction in integrated phase error of about 70% after a stabilization delay of t50 during the first cycle and a reduction of about 85% during the second.  #@NEW_LINE#@#  These improvements are partially limited by measurement fidelity, as illustrated in the ensemble-averaged data (Fig 2c).  #@NEW_LINE#@#  Predictive compensation in all tested regimes is superior to corrections based only on traditional feedback down to measurement fidelity limits.  #@NEW_LINE#@#  Compared against numerical simulations we see that for small tk the algorithm can provide large relative gains.  #@NEW_LINE#@#  ', 'Predictive estimation inside a periodic feedback loop', 'In a second application we employ real-time predictive control in a metrological context.  #@NEW_LINE#@#  Qubits realised in atoms are frequently used as stable references against which local oscillators (LOs) may be disciplined36.  #@NEW_LINE#@#  However, stochastic evolution of the LO frequency between interrogations leads to imperfect corrections in the feedback loop.  #@NEW_LINE#@#  This scenario is commonly encountered when classical processing, actuation and system reinitialisation introduce dead time, producing an effective lag in the feedback loop which degrades the long-term stability of the locked oscillator37.  #@NEW_LINE#@#  The impact of rapid fluctuations in the LO frequency relative to dead time is generally referred to as the Dick effect38, and represents a significant limiting phenomenon in passive frequency standards using atomic references.  #@NEW_LINE#@#  The correspondence between LO-induced instabilities in frequency references and dephasing in qubits39 thus invites the application of predictive control in a setting where periodic interrogation and projective measurement are native to the feedback loops used in precision frequency metrology.  #@NEW_LINE#@#  ', 'The usefulness of predictive estimation in improving correction accuracy inside a feedback loop is demonstrated in Fig 3bd, where we plot the predicted phase P(tk) (based on two different techniques) against the applied phase error A(tk).  #@NEW_LINE#@#  A prediction with unity correlation to the applied noise would form a diagonal line along P=A (similar to Fig 1b), while imperfect predictionshence imperfect correctionsresult in a dispersion of points around this line in an ellipse.  #@NEW_LINE#@#  ', 'We vary the sampling frequencies s as a proxy for introducing a variable dead time in the feedback loop (Supplementary Discussion).  #@NEW_LINE#@#  In a regime where the LO-induced dephasing process evolves slowly, quantified as sc, both M(t0) and the predicted phase P(tk) show positive correlation to A(tk) (Fig 3b).  #@NEW_LINE#@#  As we decrease s, noise evolution during the dead time leads to diminishing correlation between the prediction and actual noise, causing the ellipses to rotate and broadena manifestation of the Dick effect.  #@NEW_LINE#@#  ', 'Predictive estimates are compared with the traditional feedback model described above.  #@NEW_LINE#@#  For s approaching the Nyquist limit we observe that the traditional prediction can become anticorrelated with the rapidly evolving applied noise (blue ellipse, Fig 3d), which in real-world applications would lead to an unstable system under feedback.  #@NEW_LINE#@#  By contrast, using optimized predictions, the decrease in correlation is much slower and the machine-learning algorithm prevents the prediction from ever becoming anticorrelated with the applied dephasing noise.  #@NEW_LINE#@#  In circumstances tested we always find the optimal prediction correlation rPrT for traditional feedback.  #@NEW_LINE#@#  Corrections used to discipline the qubit or LO based on predictive estimation can therefore possess enhanced average accuracy relative to traditional feedback.  #@NEW_LINE#@#  ', 'We now implement real-time evaluation of P(tk) inside a feedback loop, demonstrating the ability to improve the individual corrections and ultimately achieve improved long-term stability of the locked qubit.  #@NEW_LINE#@#  In our experiment we set n=20, calculate P(tk) on the fly, and cyclically correct based on these predictions (Fig 3a), again comparing against traditional feedback.  #@NEW_LINE#@#  The long-term stability achieved under both methods is calculated via the sample variance40 over a variable number of feedback cycles (Fig 3e).  #@NEW_LINE#@#  ', 'Over the range of dead times explored experimentally, the use of optimized predictive feedback, in which future estimates are updated as new measurements are acquired in real time, yields net enhancements over the free-running LO (Fig 3e,f).  #@NEW_LINE#@#  This includes regimes near the Nyquist limit where rapid evolution of the noise can result in feedback-induced instability as in Fig 3d.  #@NEW_LINE#@#  Over most of this range and for the noise parameters we have employed, performance gains over traditional feedback are 2 × using optimized predictive feedbacka metrologically significant improvement using only enhanced software in the stabilization.  #@NEW_LINE#@#  Similar performance enhancements have been observed for a wide range of noise spectra and parameters (Supplementary Discussion).  #@NEW_LINE#@#  ', 'Predictive estimation applied to intrinsic system noise', 'Finally, with quantitative evaluation of these techniques in hand using engineered noise, we move on to a study of the intrinsic dephasing noise in our system, which arises due to a combination of LO phase noise and magnetic field fluctuations.  #@NEW_LINE#@#  We perform thousands of sequential projective measurements on the free-running qubitLO system and process predictions offline.  #@NEW_LINE#@#  The spectrum of measured fluctuations combines a 1/f2 type low-frequency tail with an approximately white plateau, resulting in significant spectral weight near the measurement cycle time.  #@NEW_LINE#@#  We perform an analysis similar to that presented in Fig 1, with prediction accuracy quantified using the r.m.s.  #@NEW_LINE#@#  error between predictions and the future measurement outcomes as a function of tk (Fig 4a).  #@NEW_LINE#@#  ', 'Figure 4: Application of predictive qubit state estimation to intrinsic system noise.  #@NEW_LINE#@#  (a) r.m.s.  #@NEW_LINE#@#  errors between predictions, P and actual values (A) for various numbers of past measurements and discrete steps forward in time, averaged over the whole set of validation data.  #@NEW_LINE#@#  The r.m.s.  #@NEW_LINE#@#  values are normalized to the r.m.s.d.  #@NEW_LINE#@#  of the uncorrected data from zero.  #@NEW_LINE#@#  The bottom row (1*) corresponds to traditional feedback.  #@NEW_LINE#@#  (b) Sample variance of the corrected measurements averaged over 5,000 cycles, as a function of past measurements used for prediction, normalized to the sample variance of the uncorrected system.  #@NEW_LINE#@#  The expected sample variance obtained by performing traditional feedback is added for comparison.  #@NEW_LINE#@#  Data are split into two subsets, where the first 70% serve for training purposes and the remaining 30% are used for validation.  #@NEW_LINE#@#  (Inset) Power spectrum of a series of projective measurements on the free-running qubitLO system.  #@NEW_LINE#@#  The data is overlaid with a smoothed version to visualize the general trend.  #@NEW_LINE#@#  The maximum frequency in the spectrum corresponds to our sampling frequency and is about 1.7 Hz.Full size image', 'Our machine-learning algorithm enhances the prediction of future qubit evolution by 30% relative to the r.m.s.  #@NEW_LINE#@#  error of the uncorrected measurements.  #@NEW_LINE#@#  We achieve similar performance gains relative to both traditional feedback and the free-running system in calculated sample variance over thousands of correction cycles based on predicted qubit phase, Fig 4b.  #@NEW_LINE#@#  In this case the rapid evolution of the noise causes traditional feedback to produce a larger sample variance than free evolutiona situation similar to that experienced in Fig 3d.  #@NEW_LINE#@#  The calculated performance enhancements of our method on the intrinsic system noise are significant and show that our algorithm possesses the capability to improve the stability against the noise background in our system.'  #@NEW_LINE#@#  

Discussion  #@NEW_LINE#@#  
'In this work we have demonstrated the ability to deploy machine-learning techniques to predict and pre-emptively compensate for stochastic qubit dephasing.  #@NEW_LINE#@#  By exploiting temporal correlations in noise processes, we are able to suppress dephasing during periods when probing the qubit state is not possible, even though we have no deterministic model of the qubits evolution.  #@NEW_LINE#@#  Implementing this approach requires neither additional quantum resources nor extra experimental hardware.  #@NEW_LINE#@#  Instead we rely on software-based machine-learning techniques, which extract optimal performance from information that would have already been collected during common experimental implementations.  #@NEW_LINE#@#  It has been shown numerically that it is possible to implement an analytical solution to maximally exploit noise correlations captured through the noise power spectrum41.  #@NEW_LINE#@#  However in our experimental demonstration the ease of implementation lends itself to use for large values of k and n where prediction is extended far into the future and the computational requirement of large matrix inversions make analytic techniques impractical.  #@NEW_LINE#@#  In addition, deviations from the idealization of noise characteristics represented by use of a simple power spectral density, as well as correlations appearing in the measurement process, are easily captured by the machine-learning algorithm but invisible to such analytic approaches.  #@NEW_LINE#@#  ', 'The capability to suppress errors in quantum systems undergoing stochastic evolution has direct implications for the metrology and quantum information communities.  #@NEW_LINE#@#  In particular the ability to suppress the magnitude of residual dephasing errors makes this technique an attractive complement to open-loop dynamic error suppression for quantum information.  #@NEW_LINE#@#  Any reduction in the strength of the effective noise experienced by the qubit exponentially improves the fidelity of an operation implemented using dynamic error suppression20.  #@NEW_LINE#@#  Even in the limit of quasi-static noise, reducing the magnitude of the dephasing error experienced during a dynamically protected operation will improve the ultimate fidelity achievable in a nontrivial quantum logic operation42.  #@NEW_LINE#@#  The complementarity between open- and closed-loop stabilization is a common theme in control engineering and translates well to the current setting.  #@NEW_LINE#@#  Future experiments will involve an expansion to a greater variety of machine-learning algorithms for system characterization and stabilization, and treatment of more complex control scenarios with non-commuting noise terms in the qubit Hamiltonian, nonlinearities in the control, and use of various measurement bases.  #@NEW_LINE#@#  ', 'Data availability', 'Data published in this article and the computer code used for simulation is available from the authors.'  #@NEW_LINE#@#  


