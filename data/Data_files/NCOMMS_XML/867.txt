article id="http://dx.doi.org/10.1038/NCOMMS14439"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Local self-uniformity in photonic networks  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
'The interaction of a material with light is intimately related to its wavelength-scale structure.  #@NEW_LINE#@#  Simple connections between structure and optical response empower us with essential intuition to engineer complex optical functionalities.  #@NEW_LINE#@#  Here we develop local self-uniformity (LSU) as a measure of a random networks internal structural similarity, ranking networks on a continuous scale from crystalline, through glassy intermediate states, to chaotic configurations.  #@NEW_LINE#@#  We demonstrate that complete photonic bandgap structures possess substantial LSU and validate LSUs importance in gap formation through design of amorphous gyroid structures.  #@NEW_LINE#@#  Amorphous gyroid samples are fabricated via three-dimensional ceramic printing and the bandgaps experimentally verified.  #@NEW_LINE#@#  We explore also the wing-scale structuring in the butterfly Pseudolycaena marsyas and show that it possesses substantial amorphous gyroid character, demonstrating the subtle order achieved by evolutionary optimization and the possibility of an amorphous gyroids self-assembly.'  #@NEW_LINE#@#  

Introduction  #@NEW_LINE#@#  
'A complete photonic bandgap (PBG) is frequency window within which a material, by virtue of its structure, supports no propagating electromagnetic modes.  #@NEW_LINE#@#  Typically, structures which possess complete PBGs are periodic arrays of dielectric material; such arrays are called photonic crystals (PhCs).  #@NEW_LINE#@#  PhCs have the potential to play a key role in the development of next-generation photonic integrated circuits1,2,3.  #@NEW_LINE#@#  However, although the complexity of PhC-based technologies continues to grow, questions regarding the fundamental mechanisms of PBG formation remain unresolved4,5,6.  #@NEW_LINE#@#  ', 'The formation of PBGs is conventionally interpreted as a result of coherent scattering by a PhCs lattice planes7,8.  #@NEW_LINE#@#  In this picture, a plane wave may be scattered onto its counter-propagating equivalent when the wavevector of the initial state lies on the edge of the PhCs Brillouin zone (BZ).  #@NEW_LINE#@#  When this condition is met, a pair of orthogonal standing wave modes, each possessing a distinct electromagnetic field profile, is formed5,9,10.  #@NEW_LINE#@#  Energetic interaction between the electric field and the underlying dielectric distribution then breaks the degeneracy of the standing wave states.  #@NEW_LINE#@#  For the specific propagation direction under consideration, the resulting forbidden spectral range defines a photonic stop gap.  #@NEW_LINE#@#  ', 'To engineer a complete PBG, photonic stop gaps must open along all propagation directions.  #@NEW_LINE#@#  Further, these stops gaps must be spectrally aligned.  #@NEW_LINE#@#  Both these considerations can be addressed by designing PhCs to possess maximally spherical BZs11.  #@NEW_LINE#@#  The search for the first complete PBG thus focussed on face-centred cubic crystalsthe most isotropic of the three-dimensional (3D) Bravais latticesand discovered a large complete gap in a diamond-like network of dielectric material12.  #@NEW_LINE#@#  In spite of the many PhC designs that have since been discovered, those based on the diamond network remain the champion, possessing the largest complete PBGs13,14.  #@NEW_LINE#@#  ', 'There is, however, much evidence to suggest that PBG formation is governed by more than just coherent scattering processes.  #@NEW_LINE#@#  PhCs derived from the body-centred cubic single-network gyroid (SNG) structure (triamond) and low-symmetry diamond embeddings all possess near-champion PBGs in spite of their less spherical BZs13.  #@NEW_LINE#@#  Although based on a face-centred cubic lattice, the inverse opal network exhibits a complete PBG only one quarter the size of the champion diamond gap1.  #@NEW_LINE#@#  Most tellingly, a glassy 3D networkdubbed photonic amorphous diamond (PAD)exhibits a sizeable complete PBG4.  #@NEW_LINE#@#  This gap exists despite PADs diffuse primary diffraction maximum which spreads the structures coherent scattering power of a range of wavevectors5.  #@NEW_LINE#@#  ', 'Similar evidence is found in two-dimensional structures that possess PBGs for light with a transverse electric (TE) polarization.  #@NEW_LINE#@#  Amongst these structures, the champion PhC design is a honeycomb network of dielectric material15.  #@NEW_LINE#@#  Many glassy networks that can be broadly styled as hyperuniform disordered honeycombs have been found to possess sizeable TE PBGs6,16,17,18,19,20.  #@NEW_LINE#@#  As with PAD, these gaps exist despite the diminished coherent scattering power of each structure.  #@NEW_LINE#@#  ', 'Here, we address the mechanisms governing PBG formation by re-formulating the ideal structural properties of a PBG-forming network.  #@NEW_LINE#@#  To achieve this, we introduce the concept of local self-uniformity (LSU).  #@NEW_LINE#@#  LSU measures the geometrical and topological similarities of the local environments in a connected network of uniform valency.  #@NEW_LINE#@#  We note that existing sizeable PBG networks possess significant LSU.  #@NEW_LINE#@#  We demonstrate the connection between LSU and PBG forming ability by designing novel amorphous gyroid (amorphous triamond) connected networks.  #@NEW_LINE#@#  Specifically, amorphous gyroids can possess sizeable PBGs and an amorphous gyroids LSU is strongly correlated with its PBG width.  #@NEW_LINE#@#  This correlation is explained by recognizing the contribution of spatially localized resonant scattering processes to PBG formation in connected networks.  #@NEW_LINE#@#  Locally self-uniform ceramic 3D-printed amorphous gyroids are characterized through microwave transmission experiments.  #@NEW_LINE#@#  We explore also the possibility that amorphous gyroid exists within the wing scales of butterflies.  #@NEW_LINE#@#  In particular, we reveal that the microstructure in the scales of Pseudolycaena marsyas possesses substantial amorphous gyroid character and demonstrate that the butterflys reflectance spectrum can be effectively reproduced by amorphous gyroid microstructures.'  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
'Local self-uniformity', 'The exact structure of glasses has long been debated21.  #@NEW_LINE#@#  Recent research has demonstrated the complex interplay of ordered and disordered phases in the vitreous state22,23,24.  #@NEW_LINE#@#  The disparate variety of bulk metallic glasses in particular has challenged researchers to develop predictive theories of an alloys glass-forming ability25.  #@NEW_LINE#@#  The existence of sizeable PBGs in glassy networks exposes an analogous deficiency in current understanding of a structures PBG forming ability.  #@NEW_LINE#@#  Unlike silicate and metallic glasses, the structures of glassy PBG materials are designed.  #@NEW_LINE#@#  Nevertheless, the structural characteristics that render these glasses amenable to PBG formation remain mysterious.  #@NEW_LINE#@#  With the aim of clarifying these PBG forming characteristics, here we develop LSU a general measure of structural order in connected networks.  #@NEW_LINE#@#  ', 'A typical PhC consists of a connected distribution of dielectric material surrounded by air.  #@NEW_LINE#@#  As an example, Fig 1a,b show the champion PhC diamond; it is a connected network of dielectric cylinders (green) arranged as in a diamond crystal.  #@NEW_LINE#@#  A PBGs size is usually measured as a dimensionless width given by /0the frequency width divided by the central frequency.  #@NEW_LINE#@#  Figure 1c displays an amorphous version of the diamond network.  #@NEW_LINE#@#  The complete PBG in diamond has been shown to have a width of 30% for dielectric material of refractive index 3.6 (ref.  #@NEW_LINE#@#  13).  #@NEW_LINE#@#  We focus our discussion of PBG properties hereafter in this high-refractive index regime.  #@NEW_LINE#@#  ', 'Figure 1: Strongly isotropic networks and their amorphous derivatives in three dimensions.The WS cell of a diamond PhC (a) contains a 1-tree of dielectric material (green); the edges of the tree define a tetrahedral unit.  #@NEW_LINE#@#  Stacking of the WS cells generates the champion diamond PhC (b).  #@NEW_LINE#@#  Amorphous diamond (c) consists of deformed tetrahedral units connected in a CRN.  #@NEW_LINE#@#  Similarly, the WS cell of a single-network gyroid PhC contains a 2-tree (d), comprising dielectric material (blue), in which each vertex is a trihedron.  #@NEW_LINE#@#  When stacked, the WS cells generate a single-network gyroid PhC with a near-champion PBG (e).  #@NEW_LINE#@#  Amorphous gyroid (f) comprises deformed trihedral units connected in a CRN.Full size image', 'To describe a general connected network, we decompose it into a set of vertices and edges.  #@NEW_LINE#@#  A vertex is a point at which two or more distinct lobes of material intersect.  #@NEW_LINE#@#  An edge is a vector between two vertices that specifies the central axis of a lobe of material.  #@NEW_LINE#@#  As an illustration, Fig 1a shows the fundamental unit of a diamond network in its WignerSeitz (WS) cell.  #@NEW_LINE#@#  A vertex, which sits at the centre of the cell, has four edges connecting it to its nearest neighbour vertices.  #@NEW_LINE#@#  The four nearest neighbours sit at the corners of a tetrahedron and the four edges define a tetrahedral unit.  #@NEW_LINE#@#  Similarly, Fig 1d shows the fundamental unit of a SNG structure in its WS cell.  #@NEW_LINE#@#  The central vertex has three nearest neighbour vertices to which it is connected by three edges.  #@NEW_LINE#@#  These edges are of equal length and are separated by inter-edge angles of 120°; we call this configuration a trihedral unit.  #@NEW_LINE#@#  ', 'The WS cell is the basic building block from which an extended periodic network can be assembled.  #@NEW_LINE#@#  Stacking the WS cells of diamond and SNG produces extended diamond (Fig 1b) and gyroid (Fig 1e) networks, respectively.  #@NEW_LINE#@#  An extended periodic network of this type is a highly ordered case of a continuous random network (CRN).  #@NEW_LINE#@#  A general CRN is a collection of vertices, connected by edges, which are arbitrarily positioned in space26.  #@NEW_LINE#@#  CRNs do not typically possess translational periodicities as the diamond and gyroid crystals do.  #@NEW_LINE#@#  Instead, Fig 1c illustrates a classic CRNan amorphous diamond network, studied extensively as a model of amorphous silicon27,28.  #@NEW_LINE#@#  Every vertex in amorphous diamond is tetravalent and has four nearest neighbours that describe the points of a deformed tetrahedron.  #@NEW_LINE#@#  The resulting network is a connected assembly of deformed tetrahedral units.  #@NEW_LINE#@#  Similarly, an amorphous gyroid is a CRN comprising deformed trihedral units as depicted in Fig 1f.  #@NEW_LINE#@#  ', 'We now introduce the concept of a tree within a CRN.  #@NEW_LINE#@#  An n-tree on a vertex a of a CRN is the set of edges and vertices that can be reached from a by traversing no more than n edges.  #@NEW_LINE#@#  The trees root edges are understood to mean the edges belonging to vertex a.  #@NEW_LINE#@#  To illustrate this, the diamond WS cell (Fig 1a) contains a 1-tree.  #@NEW_LINE#@#  The SNG WS cell (Fig 1d) contains a single 2-tree.  #@NEW_LINE#@#  A tree thus describes a small network unit within a CRN.  #@NEW_LINE#@#  ', 'We define LSU as a property of a CRN that describes the extent to which its component n-trees have shapes similar to that of nearby n-trees within the network.  #@NEW_LINE#@#  For the moment, we consider comparing some example 1-trees.  #@NEW_LINE#@#  Such trees consist of a central vertex with a number of edges .  #@NEW_LINE#@#  At first, we consider two trihedral 1-trees which we label  and .  #@NEW_LINE#@#  ', 'To measure the extent to which these two trees have similar shape we follow the process shown in Fig 2a.  #@NEW_LINE#@#  First, we label the root edges of both trees as (1a, 2a, 3a) and (1b, 2b, 3b).  #@NEW_LINE#@#  Second, we specify a permutation of the labels of tree b, say 213.  #@NEW_LINE#@#  Third, we attempt to align the two trees such that the root edges overlap in the prescribed permutation.  #@NEW_LINE#@#  This alignment is achieved by performing a congruent transformation on tree .  #@NEW_LINE#@#  That is, we physically pick up the tree and perform any combination of a translation, a rotation and a reflection until the edges of both trees overlap as desired29.  #@NEW_LINE#@#  Fourth, we score the extent to which  and  now overlap by taking the scalar product of the edge vectors in pairs as determined by the permutation.  #@NEW_LINE#@#  The result of this comparison is normalized such that perfectly overlapping trees receive a maximum score of 1.  #@NEW_LINE#@#  ', 'Figure 2: Comparison of 1-trees illustrated with trihedra, tetrahedra and octahedra.Two identical trihedral trees (a) are labelled by their edges.  #@NEW_LINE#@#  The edges of tree b are then permuted.  #@NEW_LINE#@#  Tree b can then be rotated around the edge 3b axis and made to perfectly overlap tree a.  #@NEW_LINE#@#  Similarly, two identical tetrahedral trees are labelled (b), and then the edges of tree b permuted.  #@NEW_LINE#@#  Reflection of tree B in the plane of edges 2b and 4b, followed by rotation around the new edge 3b axis, brings the two trees into alignment.  #@NEW_LINE#@#  Two identical octahedral trees (c) can also be compared.  #@NEW_LINE#@#  We apply a permutation to tree Bs edges.  #@NEW_LINE#@#  When overlapped, the two trees are now mismatched; their yellow and purple edges are not aligned and cannot be made so by any congruent transformation without creating a new mismatch.Full size image', 'Finally we repeat steps 1 through 4 and score the overlap of  and  for all !  #@NEW_LINE#@#  permutations of their root-edge alignment.  #@NEW_LINE#@#  We define the spatial similarity statistic ab of these two trees as the average result of the !  #@NEW_LINE#@#  comparisons (see the Methods section).  #@NEW_LINE#@#  ', 'This process can be applied without modification to determine the spatial similarity statistic of two identical tetrahedral 1-trees, as shown in Fig 2b.  #@NEW_LINE#@#  As before, we label the root edges of the two trees and specify some arbitrary permutation of the root edges of tree b; Fig 2b shows the permutation 2413.  #@NEW_LINE#@#  Once permuted, tree b is congruently transformed by a translation, a reflection and a rotation to maximally overlap with tree a.  #@NEW_LINE#@#  The quality of the overlap is then measured.  #@NEW_LINE#@#  The average overlap quality for all 4!  #@NEW_LINE#@#  root-edge alignment permutations defines the spatial similarity statistic ab.  #@NEW_LINE#@#  ', 'In Fig 2a,b, we note that that the two trihedra and tetrahedra could be made to overlap exactly for their respective root edge permutations.  #@NEW_LINE#@#  In fact, pairs of either trihedra or tetrahedra will overlap exactly for all root edge permutations and have a spatial similarity statistic of unity.  #@NEW_LINE#@#  This property of trihedral and tetrahedral units is a corollary of work on strong isotropy29.  #@NEW_LINE#@#  There exist only three strongly isotropic networks in three dimensions or less.  #@NEW_LINE#@#  In three dimensions, these networks are diamond (Fig 1b) and single gyroid (Fig 1e).  #@NEW_LINE#@#  In two dimensions, the honeycomb network is the only strongly isotropic network.  #@NEW_LINE#@#  ', 'We consider now a third set of example 1-treestwo identical simple cubic network units (Fig 2c), each with six edges about a central vertexand calculate their spatial similarity statistic.  #@NEW_LINE#@#  We find that perfect overlap can be achieved for specific root edge permutations, but in most cases there is no congruent transformation to align the two trees correctly; we call such a permutation inaccessible (this is depicted in Fig 2c).  #@NEW_LINE#@#  As a result, the simple cubic crystal does not possess a strong isotropy property.  #@NEW_LINE#@#  In the remainder of this paper, we focus on trees comprising trivalent and tetravalent vertices only.  #@NEW_LINE#@#  ', 'To build a robust measure of network structural order, we require a formalism that can compare the trees of arbitrarily disordered networks.  #@NEW_LINE#@#  We thus build upon the measurement of tree spatial similarity statistics in the following ways.  #@NEW_LINE#@#  We stipulate that the CRN from which the trees are drawn comprises only vertices with a fixed number of edges.  #@NEW_LINE#@#  We then generalize the measurement of tree spatial similarities to n-trees of any size.  #@NEW_LINE#@#  In this case, the correct edge overlap pairings are not known beyond the root edges.  #@NEW_LINE#@#  To solve this, we have developed an algorithm which determines the natural edge overlaps; this is detailed in the Methods section.  #@NEW_LINE#@#  We also allow the similarities of arbitrarily disordered trees to be measured.  #@NEW_LINE#@#  Here we acknowledge that the root edges of two trees will not necessarily overlap perfectly.  #@NEW_LINE#@#  Instead, for each permutation we find a transformation that yields an approximate overlap.  #@NEW_LINE#@#  We then quantify the quality of this overlap according to a metric of spatial similarity (see Methods section).  #@NEW_LINE#@#  ', 'We now define a CRNs LSU distribution nl to depth n and locality l as the set of n-tree spatial similarities ab for all pairs of trees whose root vertices are within l edges of one another.  #@NEW_LINE#@#  The LSU distribution is a set of spatial similarities that describes the extent to which the CRNs geometry is uniform on the length-scale l. For example, 22 describes the spatial similarities for all pairs of trees of depth 2 separated by two edges or less.  #@NEW_LINE#@#  ', 'We present a set of example LSU distributions in Fig 3.  #@NEW_LINE#@#  Figure 3a shows 22 for an amorphous diamond network.  #@NEW_LINE#@#  The trees in amorphous diamond are non-identical and present a broad distribution of spatial similarity statistics.  #@NEW_LINE#@#  However, the spatial similarities remain relatively large and show that the local geometries in the CRN are similar.  #@NEW_LINE#@#  Fig 3b compares three LSU distributions, 12, 22 and 32, for amorphous diamond.  #@NEW_LINE#@#  Amorphous networks have strong positional correlations at local length-scales that fade with distance; as a result, trees become more spatially dissimilar as their depths increase.  #@NEW_LINE#@#  We note that strongly isotropic networks are the only CRNs whose nl comprise a single peak at unity for all tree depths and localities; they are uniquely identified by their LSU distributions.  #@NEW_LINE#@#  This property is a consequence of the definition of strong isotropy29.  #@NEW_LINE#@#  The LSU distributions are thus naturally interpreted as a continuous measure of the extent to which a network is strongly isotropic.  #@NEW_LINE#@#  ', 'Figure 3: Example LSU distributions.  #@NEW_LINE#@#  (a) The distribution of spatial similarity statistics for tree comparisons of depth 2 and locality 2 (22) for an amorphous diamond network.  #@NEW_LINE#@#  (b) LSU distributions n2 of amorphous diamond for different tree depths n. (c) 22 for a 216-vertex sample comprising a single gyroid crystallite suspended in amorphous gyroid, demonstrating LSUs ability to differentiate between phases.  #@NEW_LINE#@#  (d) 22 distributions for two characteristic types of amorphous gyroid networktype-1 (1-tree local order) and type-2 (2-tree local order).Full size image', 'LSU distributions can also be used as a diagnostic of the phases present in a CRN.  #@NEW_LINE#@#  Figure 3c presents 22 for an amorphous gyroid sample containing a gyroid crystallite surrounded by an amorphous network.  #@NEW_LINE#@#  The distribution comprises a background spectrum from which a clear peak emerges =0.98.  #@NEW_LINE#@#  The peak signifies the existence of network regions comprising a strained crystalline gyroid phase.  #@NEW_LINE#@#  The LSU distribution is thus diagnostic of separate phases within a system and is useful for probing the local order of complex systems undergoing phase transitions22.  #@NEW_LINE#@#  ', 'Champion photonic bandgap architectures', '3D architectures which exhibit large complete PBGs, together with two-dimensional architectures with large TE PBGs, possess a number of shared structural characteristics.  #@NEW_LINE#@#  First, successful architectures are connected networks of dielectric material5,18,30.  #@NEW_LINE#@#  Second, the champion structuresthe honeycomb and diamond networks in two and three dimensions, respectivelyare both strongly isotropic.  #@NEW_LINE#@#  SNG, which is the only other strongly isotropic network, exhibits a near-champion PBG of width 28% for a refractive index contrast of 3.6:1 (see Supplementary Fig 1).  #@NEW_LINE#@#  Third, amorphous derivatives of both honeycomb and diamond networks exhibit PBGs which are sizeable but smaller than the gaps of their parent crystalline networks.  #@NEW_LINE#@#  Crucially, both networks possess significant but imperfect LSU (see Fig 3a).  #@NEW_LINE#@#  ', 'Overall, evidence suggests that the extent of a networks LSU influences its PBG forming ability.  #@NEW_LINE#@#  Hence, we expect that a hypothetical amorphous SNG, analogous to PAD4 and disordered honeycomb6, should possess both a high degree of LSU and a sizeable complete PBG.  #@NEW_LINE#@#  To the best of our knowledge, amorphous gyroids have not been observed in any context.  #@NEW_LINE#@#  We thus undertake the design of amorphous gyroids as a means of testing the relationship between LSU and PBG forming ability.  #@NEW_LINE#@#  To achieve this, we apply the Wooten-Winer-Weaire (WWW) algorithm to anneal amorphous gyroids from random seed networks27,28.  #@NEW_LINE#@#  In order to yield faithfully gyroidal local geometries, networks are annealed using a modified potential energy function that is distinct to the regular Keating energy27 (see also Supplementary Methods).  #@NEW_LINE#@#  ', 'We generated a set of amorphous gyroid models of varying total size as measured by their number of component vertices N. In particular, we generated an ensemble of 57, 216-vertex models across a spectrum of disorder.  #@NEW_LINE#@#  PBGs were probed by numerical solution of the Maxwell equations via a plane wave expansion method31.  #@NEW_LINE#@#  A refractive index contrast of 3.6:1 was used for all calculations.  #@NEW_LINE#@#  Bandgap widths were measured as a percentage of their central frequency.  #@NEW_LINE#@#  ', 'We demonstrate that amorphous gyroid networks can possess sizeable PBGs.  #@NEW_LINE#@#  The average PBG measured for a set of high-quality 1,000-vertex networks was 16%.  #@NEW_LINE#@#  The largest single gap observed was for a well-annealed 216-vertex network and had a size of 21%.  #@NEW_LINE#@#  These gap widths compare favourably with the 18% gap in PAD at the same refractive index contrast4.  #@NEW_LINE#@#  ', 'We investigated our ensemble of 216-vertex networks closely, calculating the LSU 22 distribution for each network.  #@NEW_LINE#@#  In Fig 4a we plot the mean value  of each distribution against PBG width for all 57 networks.  #@NEW_LINE#@#  We see that gap width is strongly correlated with network LSU.  #@NEW_LINE#@#  We expect PBGs in amorphous gyroid to open within the gap region of a SNG PhC of equivalent index contrast.  #@NEW_LINE#@#  We thus defined the SNG gap as a critical frequency region, and counted the number of photonic bands that each of our 216-vertex networks support within this window.  #@NEW_LINE#@#  The number of bands within the critical frequency region can be interpreted as an integrated density of states (DOS).  #@NEW_LINE#@#  We plot the integrated DOS against  in Fig 4b.  #@NEW_LINE#@#  We see that a networks inability to support electromagnetic modes is strongly correlated with its LSU (see also Supplementary Figs 2 and 3 and Supplementary Notes 1 and 2).  #@NEW_LINE#@#  Together these results demonstrate the power of LSU as a predictor of PBG forming ability.  #@NEW_LINE#@#  ', 'Figure 4: LSU and PBG forming ability.The LSU of amorphous gyroid networks, as measured by the mean of their 22 distributions, is strongly correlated with PBG width (a).  #@NEW_LINE#@#  Similarly, the integrated DOS N() decreases smoothly with increasing 22 (b).  #@NEW_LINE#@#  Fit lines (cubic polynomials) are for visualization purposes only.  #@NEW_LINE#@#  Approximate LSU regions for type-1 and type-2 networks are indicated (a, orange).  #@NEW_LINE#@#  We present also the edge length frequency (f) distributions (c,f), inter-edge (), dihedral () and skew () angle frequency distributions (d,g) and structure factor slices (e,h) for typical type-1 and type-2 networks, respectively.  #@NEW_LINE#@#  Structure factor intensities I are plotted on logarithmic colour scales and data in both panels is normalized to the maximum intensity I0 of h.Full size image', 'We now discuss two characteristic types of amorphous gyroid in detail; we call these type-1 and type-2 networks.  #@NEW_LINE#@#  We characterize the networks through histograms of their geometrical properties.  #@NEW_LINE#@#  In particular, we measure edge lengths (d), inter-edge angles (), dihedral angles () and skew angles ().  #@NEW_LINE#@#  Note that the skew angle measures the coplanarity of a trihedral unit, with =/2 representing a flat trihedron (see Supplementary Methods).  #@NEW_LINE#@#  ', 'Figure 4c,d show typical frequency distributions of d, ,  and  for type-1 networks.  #@NEW_LINE#@#  They are characterized by strongly peaked edge-length and inter-edge angle distributions, but have non-uniform dihedral and skew angles.  #@NEW_LINE#@#  Type-1 networks can thus be considered high-quality amorphous networks of trihedral 1-tree units.  #@NEW_LINE#@#  Figure 4f,g show the same distributions for a typical type-2 network.  #@NEW_LINE#@#  Its d, ,  and  distributions are all peaked around the ideal values for gyroidal vertices.  #@NEW_LINE#@#  Compared with type-1 networks, the local geometries of type-2 structures are much closer to an ideal strongly isotropic configuration.  #@NEW_LINE#@#  They possess gyroidal structural order on the length-scale of a 2-tree unitthe fundamental building block of SNG (Fig 1d).  #@NEW_LINE#@#  Type-1 networks have  values around 0.72.  #@NEW_LINE#@#  Type-2 networks have significantly higher LSUs with  around 0.89.  #@NEW_LINE#@#  Typical 22 distributions for these networks are shown in Fig 3d.  #@NEW_LINE#@#  ', 'Figure 4e,h show planar slices through the structure factors of type-1 and type-2 networks, respectively.  #@NEW_LINE#@#  The structure factor is a quantity that characterizes a structures coherent scattering power as a function of wavevector.  #@NEW_LINE#@#  We see that the peak scattering power of both network types is distributed in a circular ring on account of the average isotropy of the structures; wavevectors that lie on this ring are strongly scattered.  #@NEW_LINE#@#  We averaged the full structure factor across all propagation directions and measured the peak scattering power of type-2 networks to be approximately 1.6 times greater than type-1.  #@NEW_LINE#@#  In spite of this small increase, type-2 networks take the PBG width from practically zero to a maximum of 21%.  #@NEW_LINE#@#  We attribute these radically different PBG widths to the formation of locally self-uniform trees within type-2 networks.  #@NEW_LINE#@#  ', 'We now demonstrate the natural connection between LSU and PBG formation in connected networks.  #@NEW_LINE#@#  In addition to the coherent scattering (Bragg) mechanism, there exists a Mie scattering mechanism5,32 of PBG formation.  #@NEW_LINE#@#  The Mie mechanism is known to be the dominant formation process for transverse magnetic (TM) polarization gaps in dielectric cylinder arrays.  #@NEW_LINE#@#  Specifically, sizeable PBGs exist in periodic10, quasicrystalline18 and random6 cylinder arrangements and are observed to be of the same origin in each case32.  #@NEW_LINE#@#  ', 'The gap originates from resonant scattering by the Mie modes of a single cylinder.  #@NEW_LINE#@#  For all TM-gap cylinder arrays, it is clear from the electric field profiles at the edges of the fundamental PBG that Mie scattering mediates light propagation6,10,18.  #@NEW_LINE#@#  Just below the gap, modes are characterized by localization of field nodes in the vicinity of the cylinder surfaces.  #@NEW_LINE#@#  Just above the gap, field nodes consistently bisect the dielectric cylinders.  #@NEW_LINE#@#  These two node profiles derive from the interaction of a plane wave with an isolated cylinder, and are associated with the first and second Mie resonances, respectively32.  #@NEW_LINE#@#  Just above the first Mie resonance, incident and scattered fields are in antiphase at the cylinder surface; this creates a localized standing wavefront which inhibits propagation and leads to PBG formation32.  #@NEW_LINE#@#  ', 'Existing evidence suggests that PBG formation in two-dimensional and 3D dielectric networks is governed by a similar mechanism of resonant scattering.  #@NEW_LINE#@#  Specifically, careful examination of the gap-edge eigenmodes of all honeycomb-derived networks presents a consistent picture of the nature of these scattering resonances.  #@NEW_LINE#@#  In both crystalline and hyperuniform disordered honeycombs6,18, modes just below the fundamental PBG are characterized magnetic field nodes localized within the dielectric network (conversely, field anti-nodes focus within the air cells).  #@NEW_LINE#@#  Just above the PBG, magnetic field nodes pass between air cells, cutting the inter-vertex dielectric walls almost normally.  #@NEW_LINE#@#  These gap-edge node characteristics are consistent across honeycomb-derived trivalent networks and, by analogy to the TM case, evidence the significance of spatially localized resonant scattering processes.  #@NEW_LINE#@#  ', 'We therefore view CRNs as a connected ensemble of distinct scattering units (n-trees) which, in isolation, exhibit a number of resonant electromagnetic modes.  #@NEW_LINE#@#  For frequencies just above a resonance, scattered and incident fields are in antiphase and interfere destructively, localizing a field node in the vicinity of the scatterer and suppressing propagation through it.  #@NEW_LINE#@#  ', 'A potential champion PBG structure comprises geometrically identical scattering units.  #@NEW_LINE#@#  All scattering centres thus possess degenerate electromagnetic resonances, and the spectral ranges for which each scatterer inhibits transmission are maximally aligned.  #@NEW_LINE#@#  Fixed valence networks comprising non-identical scattering units exhibit smaller PBGs than their crystalline precursors.  #@NEW_LINE#@#  Structural deformation of the scattering centres breaks the degeneracy of their scattering resonances; the resulting PBG is thus narrowed by imperfect overlap of the spectral ranges for which each scattering centre suppresses transmission.  #@NEW_LINE#@#  ', 'The set of networks comprising geometrically identical scattering units exhibits a clear hierarchy of PBG size33 (see Supplementary Table 1).  #@NEW_LINE#@#  Specifically, networks built from vertices with a low coordination number possess the largest PBGs.  #@NEW_LINE#@#  Accordingly, the diamond and SNG architectures are champion and near-champion, respectively; these networks are strongly isotropic due to the simplicity of their vertices and comprise scattering units which are perfectly superimposable under permutation.  #@NEW_LINE#@#  This combinatorial symmetry has a strong influence on the PBG width.  #@NEW_LINE#@#  We argue that symmetry under permutation minimizes the number of distinct scattering resonances that a scattering centre supports.  #@NEW_LINE#@#  As a result, the frequency gaps between scattering resonances are maximized, together with the width of the spectral region above resonance for which transmission is suppressed.  #@NEW_LINE#@#  ', 'Fundamentally, both Bragg and resonant scattering mechanisms contribute to PBG formation.  #@NEW_LINE#@#  The largest PBGs are obtained by optimization of a structures dielectric fill fraction to overlap the spectral range associated with the two mechanisms.  #@NEW_LINE#@#  We note, however, that strong diffraction rings in the structure factor of amorphous materials do not directly lead to PBGs, but reflect the presence of local order that, depending on its LSU, may favour gap formation.  #@NEW_LINE#@#  This observation clarifies the relationship between LSU and work on PBG formation in hyperuniform structures6.  #@NEW_LINE#@#  Architectures derived from disordered hyperuniform point patterns possess significant local structural correlations and local geometrical order; these characteristics have proven essential in establishing sizeable PBGs6.  #@NEW_LINE#@#  However, hyperuniform point patterns must be tessellated in an ad-hoc way to produce viable PBG-forming networks6,34.  #@NEW_LINE#@#  This tessellation protocol naturally creates nearly-optimal network topologies, but these networks are successful only because they possess locally self-uniform structural order.  #@NEW_LINE#@#  In contrast to hyperuniformity, LSU measures both geometrical and topological order simultaneously and is thus an effective measure of PBG forming ability.  #@NEW_LINE#@#  Hyperuniformity and LSU remain compatible; we note the emergence of a hyperuniform-like exclusion domain around k=0 in the structure factor of networks with significant LSU (Fig 4h).  #@NEW_LINE#@#  The association of LSU with PBG formation parallels the proof that amorphous materials with well-defined atomic connectivity can possess an electronic bandgap35.  #@NEW_LINE#@#  ', 'Microwave experiments with amorphous gyroid', 'To verify our theoretical calculations, we fabricated millimetre-scale amorphous gyroid samples and experimentally characterized their PBGs.  #@NEW_LINE#@#  Samples were produced at the Fraunhofer Institute for Ceramic Technologies and Systems using a 3D ceramic printing technique.  #@NEW_LINE#@#  The samples were made from alumina (Al2O3), whose permittivity was experimentally determined to be =(9.5±0.3) at frequencies in the microwave K band (1826.5 GHz).  #@NEW_LINE#@#  Two types of sample were made: cuboidal samples of SNG (Fig 5c) and amorphous gyroid (Fig 5a,d), and a cylindrical sample of amorphous gyroid (Fig 5b).  #@NEW_LINE#@#  The internal network, comprising cylinders with diameter D=2.03 mm, was well formed (Fig 5c,d).  #@NEW_LINE#@#  The gyroid primitive cell parameter was designed to be 3.08 mm and experimentally measured to be a=(3.13±0.05) mm.  #@NEW_LINE#@#  ', 'Figure 5: Microwave experiments with single network and amorphous gyroid structures.Alumina prototypes of amorphous gyroid, both a single piece cuboid (a) and a compound cylinder (b).  #@NEW_LINE#@#  View down the (111) axis of our single-network gyroid sample (c), and along an arbitrary axis of amorphous gyroid (d), showing the network quality.  #@NEW_LINE#@#  Comparison of transmission between single-network gyroid (SNG 111) and amorphous gyroid (A-Gyroid) cuboidal samples (e,f, respectively), with gap edges predicted by plane wave expansion (vertical dashed lines); measured data was smoothed by Fourier filtering for clarity.  #@NEW_LINE#@#  Measured (g) and simulated (h) polar false-colour maps of transmission for the amorphous gyroid cylinder, with gap edges calculated by band structure overlaid as black and white rings, respectively.  #@NEW_LINE#@#  Scale bars in (c,d) 5 mm.Full size image', 'Measurements were made with microwave radiation using an established experimental set-up9,19.  #@NEW_LINE#@#  Each sample was placed between two facing microwave horn antennae connected to an HP-8510C vector network analyser (VNA).  #@NEW_LINE#@#  Figure 5e,f present the transmission as a function of frequency along the (111) crystal axis of SNG and an arbitrary amorphous gyroid axis, respectively.  #@NEW_LINE#@#  Both samples show wide transmission gaps, with up to 35 dB of attenuation.  #@NEW_LINE#@#  Propagation through the periodic sample (Fig 5e,f) is predominantly ballistic9; photons are weakly scattered both above and below the PBG, and the gap edges are well defined.  #@NEW_LINE#@#  As a result, the measured transmission gap for the SNG sample agrees very well with the simulated PBG, highlighted by vertical dashed lines in the figure.  #@NEW_LINE#@#  ', 'The measured transmission gap for the amorphous gyroid sample (Fig 5f) is also centred at the frequency range calculated by simulation (shown as dashed lines), although it appears wider; we attribute this to the limited dynamic range of our experiment (see Methods section) and strong diffusive scattering9.  #@NEW_LINE#@#  Scattering processes are significant for the amorphous network.  #@NEW_LINE#@#  They scatter radiation both away from the detector and into different polarization states.  #@NEW_LINE#@#  As a result, strongly scattered radiation has a low coupling efficiency into the receiver horn antenna; this prevents the transmission from recovering its peak value for frequencies above the PBG, thus widening the perceived transmission gap.  #@NEW_LINE#@#  ', 'We employed the amorphous gyroid cylindrical sample (Fig 5b) to investigate the isotropy of the PBG.  #@NEW_LINE#@#  The sample was rotated around its cylindrical axis and a transmission spectrum was recorded every 2°.  #@NEW_LINE#@#  The resulting set of transmission spectra is presented in Fig 5g as a polar, false-color map in which the radial coordinate represents frequency and the angular coordinate records the cylinders rotation angle36,37.  #@NEW_LINE#@#  Here, the rotational isotropy of the PBG is clear; the blue-and-green ring represents an isotropic transmission gap.  #@NEW_LINE#@#  The expected PBG edges, as predicted by band structure calculation, are overlaid as black solid curves.  #@NEW_LINE#@#  We corroborate the PBG isotropy by performing finite-difference time-domain (FDTD) electromagnetic simulations.  #@NEW_LINE#@#  Specifically, we place a number of dipole sources inside our amorphous gyroid cylinder, and record the power flux some distance from the cylinder using a circular array of detectors (see Supplementary Methods).  #@NEW_LINE#@#  This result is presented as a second polar false-colour map in Fig 5h; the expected PBG edges, according to the band structure, are overlaid as white solid curves.  #@NEW_LINE#@#  Although the transmission contrast of the experimental data is noise-limited (see Supplementary Note 3), the frequencies of the experimentally measured PBGs accord well with the results of both band structure and FDTD simulations.  #@NEW_LINE#@#  ', 'Self-uniformity by evolution', 'Many plants and animals have evolved wavelength-scale microstructures as means of producing colour38,39,40,41.  #@NEW_LINE#@#  Study of these architectures can inspire the development of industrial scale fabrication techniques for next-generation PhC-based technologies42,43,44.  #@NEW_LINE#@#  ', 'In this regard, self-assembly is a particularly attractive fabrication method.  #@NEW_LINE#@#  The three strongly isotropic networks have all been observed to self-assemble45,46,47,48.  #@NEW_LINE#@#  Interestingly, amorphous honeycomb and diamond have also been observed in the natural world49,50; it is thus clear that a self-assembly pathway capable of producing complex short-range order exists.  #@NEW_LINE#@#  Here, we explore evidence that an amorphous gyroid could be similarly self-assembled.  #@NEW_LINE#@#  First, we demonstrate that topological defects exist in the gyroidal microstructures of green hairstreak butterflies47,51.  #@NEW_LINE#@#  We then present a disordered network structure in the scales of the Cambridge Blue butterfly and model its reflectance spectrum with an amorphous gyroid structure52.  #@NEW_LINE#@#  ', 'Many butterfly species are known to derive colouration from gyroidal networks of chitin within their scales, most famously Parides sesostris (the emerald-patched cattleheart) and numerous species of the genus Callophrys (the green hairstreaks).  #@NEW_LINE#@#  Microscopy has demonstrated that the scales contain numerous crystallites of a well-ordered network of chitin in air51,53.  #@NEW_LINE#@#  Small angle X-ray scattering (SAXS) has assigned the symmetry group of SNG to the structures47.  #@NEW_LINE#@#  ', 'However, tomographic reconstruction of the chitin/air interface in Callophrys rubi shows that the network is not everywhere a perfect topological gyroid51.  #@NEW_LINE#@#  Evidence suggests that the chitin network passes continuously between adjacent gyroid grains, and that this grain-matching is facilitated by topological network defects51.  #@NEW_LINE#@#  Further, different crystallites within the same scale exhibit different chitin fill fractions.  #@NEW_LINE#@#  Accounting for these observations, we now show that SNG crystallites incorporating small amounts of topological and positional disorder are better models of the scale structure in the green hairstreaks than a perfect gyroid crystal.  #@NEW_LINE#@#  ', 'To model the SAXS results, we approximate the scale as an ensemble of separate crystallites which contribute to the diffraction spectrum independently.  #@NEW_LINE#@#  The positional correlations between adjacent crystal domains are destroyed by the matching defects at the grain boundaries; the SAXS spectrum can thus be considered an incoherent superposition of the diffraction patterns of distinct crystallites.  #@NEW_LINE#@#  To fit the experimental results, we generate a number of distinct crystallites across a range of chitin fill fractions and sum their diffraction patterns incoherently, optimizing their weights in the summation to minimize the Reitveld weighted profile R factor, Rwp, of the fit54.  #@NEW_LINE#@#  We calculate two types of fits, described in detail in the Methods section.  #@NEW_LINE#@#  In the first case, we model the scales as perfect gyroids, employing the level-set approximation of the gyroid minimal surface (dotted orange curve in Fig 6a).  #@NEW_LINE#@#  In the second case, we model the tomographic data51 using partially disordered gyroid (PDG) networks (dashed blue line in Fig 6a).  #@NEW_LINE#@#  PDG is generated by introducing a small number of topological defects into a perfectly ordered gyroid net.  #@NEW_LINE#@#  Specifically, one defect is introduced for every 100 network vertices together with a small amount of vertex positional disorder.  #@NEW_LINE#@#  ', 'Figure 6: LSU in butterfly scales.Comparison with SAXS data of level-set and partially disordered gyroid models of wing scales in the butterfly C. gryneus (a).  #@NEW_LINE#@#  Specimen of Ps.  #@NEW_LINE#@#  marsyas (b) and FIB section of one of its blue scales (c), imaged with 52° tilt in the FIB.  #@NEW_LINE#@#  Detail (d), taken from (c), compared with a projection of an amorphous gyroid model (e).  #@NEW_LINE#@#  Transmission electron micrograph of a Ps.  #@NEW_LINE#@#  marsyas scale cross-section (f).  #@NEW_LINE#@#  Comparison of experimental reflectance data from a large wing area to an amorphous gyroid scale model (g).  #@NEW_LINE#@#  Scale bars, 1 cm (b); 1 m (c); 500 nm (d,e); and 1.5 m (f).  #@NEW_LINE#@#  The TEM section (f) is reproduced with permission from Vértesy et al.52.  #@NEW_LINE#@#  TEM, transmission electron microscopy.Full size image', 'Note that, at publication, no SAXS data for C. rubi was available.  #@NEW_LINE#@#  Instead we compare our models to SAXS results for Callophrys gryneus (solid green line in Fig 6a); we expect the microstructure in C. gryneus to comprise gyroid grains connected by topological matching defects, just as in C. rubi.  #@NEW_LINE#@#  Rwp values for our level-set and PDG fits are 980 and 645, respectively, suggesting that PDG is a superior model of the green hairstreak scale structure.  #@NEW_LINE#@#  The pure level-set model produces overly prominent peaks, particularly between the (110) and (211), and (400) and (420) reflections.  #@NEW_LINE#@#  The inclusion of topological and positional disorder dampens the network correlations and reduces this contrast across the whole spectrum.  #@NEW_LINE#@#  The quality of the disordered PDG fit is most evident for high (hkl) values; here, the overall profile of the pattern, in particular the double peak of the (321) and (400) planes, is well-captured.  #@NEW_LINE#@#  ', 'Taken together, the tomographic data51 and the results of our scale modelling (Fig 6a) suggest that topological imperfections form, to a limited degree, at the grain boundaries in the gyroidal microstructures of the green hairstreaks.  #@NEW_LINE#@#  The existence of these topological defects renders the hairstreaks (sub-family Theclinae) a promising family of butterflies within which to search for an amorphous gyroid.  #@NEW_LINE#@#  ', 'We now turn our attention to the Cambridge Blue butterfly (Ps.  #@NEW_LINE#@#  marsyas, Theclinae, Fig 6b).  #@NEW_LINE#@#  Its wing scales contain a unique aperiodic photonic structuring from which they derive a blue brilliance.  #@NEW_LINE#@#  Focussed ion beam (FIB) sections reveal an intricately connected trivalent network, with fully 3D interconnectivity and an apparent LSU (Fig 6c).  #@NEW_LINE#@#  Computational projections of amorphous gyroid with a volume fill fraction of 25% strongly resemble the butterfly network (Fig 6d,e).  #@NEW_LINE#@#  Transmission electron microscopy sections (Fig 6f) reveal a mixture of interwoven layering and fully disordered network regions52.  #@NEW_LINE#@#  In cross-section, the lower half of the scale (bottom half of Fig 6f) appears as a dark bandthis increased contrast can be associated with pigmentation55.  #@NEW_LINE#@#  ', 'We now model scales of Ps.  #@NEW_LINE#@#  marsyas as amorphous gyroid CRNs and investigate the compatibility of these models with experimental reflectance measurements.  #@NEW_LINE#@#  We employ a number of amorphous gyroid CRNs with  around 0.88.  #@NEW_LINE#@#  We calculate their far field reflectance spectra by FDTD solution of the Maxwell equations.  #@NEW_LINE#@#  ', 'We estimated the scale thickness from FIB sections to be 1300±200 nm.  #@NEW_LINE#@#  The lower half of the scale was taken to be absorbing in accordance with the pigment distribution observed by transmission electron microscopy (Fig 6f).  #@NEW_LINE#@#  We suggest a plausible model for the complex refractive index of the Ps.  #@NEW_LINE#@#  marsyas pigment, derived from the extinction coefficient of the pigment in Papilio nireus (see the Methods section).  #@NEW_LINE#@#  Amorphous gyroid edge lengths for our Ps.  #@NEW_LINE#@#  marsyas sample were estimated from electron micrographs to be 117±6 nm; this corresponds to an effective SNG primitive cell parameter of a=166±8 nm.  #@NEW_LINE#@#  The reflectance of a large wing area of Ps.  #@NEW_LINE#@#  marsyas was measured by a previous study52; scaling of the amorphous gyroid (110)-type SAXS peak to the wavelength of maximum reflectance suggests a=169 nm.  #@NEW_LINE#@#  The theoretical reflectance presented (Fig 6g) is an average over six amorphous gyroid models, all scaled by an a value of 166 nm.  #@NEW_LINE#@#  ', 'Given the assumptions made in modelling the pigmentation, the general agreement between theoretical and experimental reflectance spectra suggests that an amorphous gyroid with a UV-absorbing pigment is a plausible model of the structure in Ps.  #@NEW_LINE#@#  marsyas scales.  #@NEW_LINE#@#  The divergence at UV wavelengths is attributable to uncertainty in the exact complex refractive index of the butterfly scale across a 300 to 700 nm range; future studies should measure this directly.  #@NEW_LINE#@#  The small divergence at red wavelengths is attributable to reflections from unmodelled melanized ground scales.  #@NEW_LINE#@#  ', 'Two other neotropical hairstreaks, Arcas imperialis (Theclinae) and Evenus coronata (Theclinae)close relatives of the Cambridge Bluehave previously been surveyed through microscopy56.  #@NEW_LINE#@#  Their structures appear to possess strong multilayer and gyroidal characteristics, respectively.  #@NEW_LINE#@#  It is therefore possible that amorphous gyroid has evolved in the Cambridge Blue by some small change in scale cell development conditions, leading to an evolutionary divergence.  #@NEW_LINE#@#  Indeed, such a divergence has been postulated in the case of the gyroid-containing Pa sesostris, whose-scale structuring has diverged from the perforated multilayers of many closely related Parides species57.  #@NEW_LINE#@#  ', 'Our work indicates that the scale structuring in the Cambridge Blue is related to an amorphous gyroid.  #@NEW_LINE#@#  Electromagnetic modelling shows that amorphous gyroid models are consistent with observed reflectance data and the existence of topological matching defects between gyroid grains in green hairstreak scales suggests that the production of amorphous gyroid is developmentally possible.  #@NEW_LINE#@#  ', 'Any further search for a natural amorphous gyroid should not be limited to butterflies.  #@NEW_LINE#@#  A thorough survey of avian feather barbs has revealed an abundance of colour-producing channel-type architectures.  #@NEW_LINE#@#  Several speciesDiglossa cyanae58 (Thraupidae), Passerina cyanea58 (Cardinalidae) and Alcedo atthis59 (Alcedinidae)are themselves a brilliant blue and possess microstructures with striking similarity to amorphous gyroid.  #@NEW_LINE#@#  Experimentally, it may be possible to produce amorphous gyroid or a similar architecture via block co-polymer self-assembly60.  #@NEW_LINE#@#  It is possible to generate mixed lamellar and gyroidal states that may resemble the Ps.  #@NEW_LINE#@#  marsyas structure61,62.  #@NEW_LINE#@#  An alternative pathway may be to quench the phase transition between the gyroid and metastable perforated multilayer phases62.'  #@NEW_LINE#@#  

Discussion  #@NEW_LINE#@#  
'We have introduced LSU as means of measuring the extent to which local environments in a CRN of fixed valency are spatially similar.  #@NEW_LINE#@#  When applied to strictly trivalent and tetravalent networks the states of maximum LSU are the strongly isotropic single gyroid and diamond networks, respectively.  #@NEW_LINE#@#  As a networks LSU decreases from its maximum it becomes glassy and eventually chaotic.  #@NEW_LINE#@#  LSU can thus classify all CRNs of fixed valency by the extent of their internal order.  #@NEW_LINE#@#  ', 'We designed LSU as a means of characterizing the optical properties of CRNs.  #@NEW_LINE#@#  In particular, we have shown that networks with maximal LSU possess champion PBGs in both 2D and 3D.  #@NEW_LINE#@#  Further, other known networks endowed with a complete PBG in 3D or a TE polarization PBG in 2D are characterized by high levels of LSU.  #@NEW_LINE#@#  PBGs result from scattering by the electromagnetic resonances of a networks local scattering units.  #@NEW_LINE#@#  When these units are spatially similar, their resonances are maximally degenerate and complete PBG formation is favoured.  #@NEW_LINE#@#  LSU is thus a predictive measure of a networks PBG forming ability.  #@NEW_LINE#@#  While here we focussed on trivalent and tetravalent networks, LSU can be generalized to include networks of arbitrary or mixed valency.  #@NEW_LINE#@#  ', 'We have introduced designs of novel amorphous gyroid CRNs.  #@NEW_LINE#@#  Here we used ceramic 3D printing to fabricate amorphous gyroid samples in high-refractive index alumina and demonstrated their sizeable isotropic PBGs via microwave transmission experiments.  #@NEW_LINE#@#  The relevance of amorphous gyroid, and architectures which can be derived from it, is broad.  #@NEW_LINE#@#  In particular, its development, or that of a closely related CRN, appears to have occurred in the scales of the butterfly Ps.  #@NEW_LINE#@#  marsyas.  #@NEW_LINE#@#  That it is possible to self-assemble such a structure is a prerequisite for its existence in natural systems.  #@NEW_LINE#@#  It may be possible to produce amorphous gyroid networks via block co-polymer experiments or equivalent self-assembly methods.  #@NEW_LINE#@#  This poses an interesting experimental challenge, the solution of which will facilitate the fabrication of advanced optical metamaterials for industrial applications43,60.  #@NEW_LINE#@#  ', 'Fundamentally, we have demonstrated that the tree comparison method is a powerful framework for controlling the LSU of the scattering centres in a CRN.  #@NEW_LINE#@#  Sculpting a networks LSU distributions translates directly to advanced control over its optical properties.  #@NEW_LINE#@#  The optical properties controlled need not be limited to PBG forming ability; they could include structural colour, the scattering mean free path63 and random lasing64.  #@NEW_LINE#@#  Moreover, similar design principles may be employed to control other wave phenomena in electronic, phononic, elastic and acoustic materials.'  #@NEW_LINE#@#  

Methods  #@NEW_LINE#@#  
'Definition of the LSU distributions', 'Consider a CRN C with a set of defined vertex positions and inter-vertex connectivities, in which each vertex in C has exactly  edges.  #@NEW_LINE#@#  We define an n-tree  on vertex a of C as the set of vertices within n edges of a.  #@NEW_LINE#@#  The root edges of  are all the edges of .  #@NEW_LINE#@#  Computationally, all information regarding  can be obtained by performing a breadth-first graph search to depth n from vertex a.  #@NEW_LINE#@#  ', 'We consider now two n-trees of equal depth  and .  #@NEW_LINE#@#  We label the root edges of the trees {1a, 2aa} and {1b, 2b ... b}, respectively.  #@NEW_LINE#@#  The spatial similarity statistic ab of these two trees is defined as', '', 'where f is a similarity measure which grades the overlap of  and  when they are maximally aligned in a root edge permutation i.  #@NEW_LINE#@#  We sum the similarities for all !  #@NEW_LINE#@#  overlap permutations of the trees root edges and then take the average.  #@NEW_LINE#@#  ', 'The value of the spatial similarity statistic will depend both on the form that the measure f takes and the method that is used to maximally align the two trees for each permutation.  #@NEW_LINE#@#  We describe our choice of f and the alignment procedure we follow in the next section.  #@NEW_LINE#@#  ', 'The LSU distributions of the CRN are particular sets of spatial similarity statistics.  #@NEW_LINE#@#  We define a new tree  with depth l on vertex a.  #@NEW_LINE#@#  The set of vertices in  is the local neighbourhood of a to depth l. The LSU distribution nl can then be written as', '', 'nl is thus the set of spatial similarity statistics for all trees of depth n whose root vertices are within l edges of one another.  #@NEW_LINE#@#  nl can be plotted as histograms as in Fig 3.  #@NEW_LINE#@#  In Fig 3 the histogram frequencies are normalized through division by the total number of spatial similarity statistics in nl.  #@NEW_LINE#@#  ', 'Calculation of the overlap between two trees', 'Here we discuss in detail the exact form of our similarity measure f and the process by which two trees are maximally overlapped.  #@NEW_LINE#@#  We note that the choice of f is an important user-controllable degree of freedom.  #@NEW_LINE#@#  In general, f must be maximal when two trees can be overlapped perfectly; this defines uniquely the maximally self-uniform configuration.  #@NEW_LINE#@#  However, the exact manner in which overlap is calculated can be defined to best suit the application and to possess meaningful properties as the network departs from maximal self-uniformity.  #@NEW_LINE#@#  Here, we adopt an intuitive framework in which tree edges are overlapped in pairs with their most natural partners.  #@NEW_LINE#@#  ', 'Consider now an n-tree  in the CRN C. We label its  vertices with index j, subject to the constraint that indices {1, 2 ... } represent the trees root edges.  #@NEW_LINE#@#  The branches of the tree are defined by its edge vectors.  #@NEW_LINE#@#  For  we denote these as , which defines the vector to vertex j from its parent vertex as defined by a breadth-first graph search starting on a.  #@NEW_LINE#@#  ', 'Consider now two n-trees  and .  #@NEW_LINE#@#  Before they can be compared, they must be maximally overlapped.  #@NEW_LINE#@#  This process consists of determining a congruent transformation which maximizes the overlap of their root edges in some chosen permutation i.  #@NEW_LINE#@#  First,  is translated such that vertices a and b overlap.  #@NEW_LINE#@#  Second,  is rotated until  and  are parallel; this is always possible.  #@NEW_LINE#@#  Third,  is rotated about the  axis until  and  are maximally parallel, defined to be the configuration which minimizes their scalar product.  #@NEW_LINE#@#  For disordered trees, it is not usually possible to make these two vectors perfectly parallel.  #@NEW_LINE#@#  For trivalent networks, we deem these three steps sufficient to maximally align the two trees.  #@NEW_LINE#@#  ', 'For tetravalent networks it is necessary to introduce a fourth alignment step.  #@NEW_LINE#@#  In this case,  is reflected in the plane defined by  and  so as to bring  into maximal alignment with  and  with .  #@NEW_LINE#@#  This step is performed only if the alignment between  and  is improved, as measured by an increase in the value of ·+·.  #@NEW_LINE#@#  At this point, the two trees are considered to be maximally aligned.  #@NEW_LINE#@#  ', 'Once maximally aligned, we define our similarity measure f for grading the overlap of two trees as', '', 'Overlap is calculated between edge pairs by taking their scalar product and normalizing it with the square of their mean norm; overlap of a single pairing is thus distributed on 1, 1.  #@NEW_LINE#@#  The 1 edge pair comparisons are summed and averaged such that f yields a maximum value of unity for perfectly overlapping trees.  #@NEW_LINE#@#  ', 'Edge pairs are overlapped in the combination that is most natural.  #@NEW_LINE#@#  The whole overlap calculation is performed recursively in a depth-first sense, greatly simplifying the process of determining natural pairings.  #@NEW_LINE#@#  At a particular point in the algorithms execution, it has reached some vertex pair j and k(j) by comparison of the natural edge pair  with .  #@NEW_LINE#@#  Overlap of all (1)!  #@NEW_LINE#@#  possible sets of edge pair comparisons is calculated.  #@NEW_LINE#@#  The set that maximizes the sum of edge pair scalar products is chosen as the set of natural pairings; this result is accepted, and the algorithm proceeds to calculate overlap for the edges around each of the (1) child vertices.  #@NEW_LINE#@#  This decision process is captured in the notation , to reflect that the choice of edge vector in tree b is a function of the edge vector  to which it is being compared.  #@NEW_LINE#@#  ', 'Finally, the spatial similarity statistic ab is determined by repeating this process for all root edge permutations according to equation (1).  #@NEW_LINE#@#  ', 'Microwave transmission measurement', 'Gyroid and amorphous gyroid models were printed and finished in the workshops of the Fraunhofer Institute for Ceramic Technologies and Systems, Dresden.  #@NEW_LINE#@#  The gyroid primitive cell parameter was designed to be to be 3.08 mm.  #@NEW_LINE#@#  As part of the printing process, the samples were sintered at high temperature, shrinking in side-length by 20% and introducing some uncertainty into their true sizes.  #@NEW_LINE#@#  Actual scaling values were thus measured and fill fractions were determined using a water displacement method, yielding an effective gyroid primitive cell parameter of a=3.13±0.05 mm, and alumina volume-fill-fractions between 27 and 29%.  #@NEW_LINE#@#  Amorphous gyroid samples were fabricated preferentially.  #@NEW_LINE#@#  We also produced one SNG model.  #@NEW_LINE#@#  This model was designed for measurement of transmission along the 111 axis; this axis was chosen because of its symmetry (see Supplementary Note 4).  #@NEW_LINE#@#  ', 'Characterization of the samples was performed with microwave radiation using an HP-8510C VNA.  #@NEW_LINE#@#  A single polarization mode was coupled through a pair of rectangular horn antennae and a pair of custom-made Teflon microwave lenses.  #@NEW_LINE#@#  For the measurements shown in Fig 5e,f, the beam was aligned along the short edge of the cuboidal samples (Fig 5a,c) and perpendicular to a flat sample surface, and the frequency varied from 15 to 35 GHz.  #@NEW_LINE#@#  Note that frequencies beyond the standard microwave K band (1826.5 GHz) have very low efficiency coupling through the horns and waveguides.  #@NEW_LINE#@#  For the measurements shown in Fig 5g, the cylindrical sample was aligned with the incident beam perpendicular to the cylinder axis, around which we rotated the sample and recorded the transmission every 2°.  #@NEW_LINE#@#  This set of measurements was performed across a frequency range of 1727 GHz.  #@NEW_LINE#@#  ', 'The total dynamic range of the HP-8510C VNA is from 0 to 65 dB (measured dark noise).  #@NEW_LINE#@#  A large area of microwave-absorbing material, into which a window was cut to hold the sample, was used to prevent reflection and scattering of radiation into the environment.  #@NEW_LINE#@#  The normalized transmission is then defined as the ratio between detected intensities with and without the sample in place.  #@NEW_LINE#@#  The addition of microwave-absorbing material lowers the overall coupling-efficiency through the pair of horn-antennae.  #@NEW_LINE#@#  As a result, the actual accessible dynamic range through this measurement is only 35 dB, which limits the measured gap-depth.  #@NEW_LINE#@#  This limited dynamic range is apparent in the amorphous gyroid transmission of Fig 5f; the transmission bottoms out and becomes noisy for frequencies between 20 and 26 GHz.  #@NEW_LINE#@#  For the same reason, transmission results for the amorphous gyroid cylinder (Fig 5g) appear noisy in comparison to the theoretical results (Fig 5h).  #@NEW_LINE#@#  An increased dynamic range could be accessed by amplifying the source power.  #@NEW_LINE#@#  ', 'SAXS pattern modelling', 'The total scattered intensity measured in a SAXS experiment can be written as a Fourier transform of the electron density function (r):', '', 'for q the scattering vector in reciprocal space, re the radius of the electron and V the total sample volume65.  #@NEW_LINE#@#  We Fourier transform the difference between (r) and its volume average  to remove the forward scattering peak and access any diffraction signatures that may be present at small scattering vectors.  #@NEW_LINE#@#  The (r) functions for our 3D network structures were generated by voxelization and were distributed on 0, 1, representing the air and chitin distributions of the butterfly scale networks, respectively.  #@NEW_LINE#@#  Fourier transforms were calculated using a fast Fourier transform algorithm.  #@NEW_LINE#@#  Powder-like structure factors were calculated by azimuthal averaging of the total scattered intensity.  #@NEW_LINE#@#  Structure factors were normalized to the intensity of the (110) peak for comparison with experimental data.  #@NEW_LINE#@#  ', 'To model the observed scattering from C. gryneus, we investigated both partially disordered gyroid (PDG) networks and level-set surfaces as approximations to the chitin network.  #@NEW_LINE#@#  In all cases, cubic crystallites of dimension 10a (1,000 vertex points) were used.  #@NEW_LINE#@#  When f=0, the function', '', 'defines the level-set approximation to the gyroid surface; it divides space into two inter-penetrating labyrinths each with a 50% volume fill.  #@NEW_LINE#@#  For f0, it defines a surface with the symmetry of SNG, and alters the relative filling fraction of the two labyrinths.  #@NEW_LINE#@#  A set of level-set basis states was generated by sampling these different fill fractions via a critical value t, assigning unity to (r) for ft and zero otherwise.  #@NEW_LINE#@#  ', 'PDG networks were generated by introducing geometrical and topological disorder into SNGs.  #@NEW_LINE#@#  All PDG networks were topologically disordered by the introduction of 10 StoneWales defects.  #@NEW_LINE#@#  This was performed using our implementation of the WWW algorithm.  #@NEW_LINE#@#  Geometrical disorder was added by perturbation of the vertex points by a random vector whose magnitude was normally distributed with mean zero and s.d.  #@NEW_LINE#@#  up to 40% of the gyroid edge length.  #@NEW_LINE#@#  To increase the physicality of this disorder, perturbations were propagated through the network with their magnitude decaying with depth; vertex positions thus retained a local correlation.  #@NEW_LINE#@#  The final set of disordered SNG basis states sampled various degrees of vertex positional disorder, as defined by their perturbation standard deviations and rates of perturbation decay, each across a set of fill fractions.  #@NEW_LINE#@#  ', 'Final diffraction spectra consist of a weighted sum over the diffraction patterns of the appropriate basis states.  #@NEW_LINE#@#  A fit to the experimental data was performed by optimization of these weights so as to minimize the Rietveld weighted profile factor of the fit.  #@NEW_LINE#@#  ', 'Pseudolycaena marsyas scale imaging', 'A dried male specimen of Ps.  #@NEW_LINE#@#  marsyas was acquired online from The Bugmaniac Insect Shop.  #@NEW_LINE#@#  The specimen was spread and mounted for sample photography.  #@NEW_LINE#@#  Single scales were removed, mounted and gold sputtered to produce a 4 nm coating.  #@NEW_LINE#@#  Scales were then imaged via electron microscopy, and sectioned using a FIB.  #@NEW_LINE#@#  ', 'SNG net scaling parameters were estimated from micrographs under the assumption that network regions with a locally honeycomb-like appearance correspond to the nine-segment helices visible along the SNG (111) axis.  #@NEW_LINE#@#  The appearance of such regions is similar to views along the (111) axis of gyroid crystallites in green hairstreak butterflies, supporting this supposition.  #@NEW_LINE#@#  The radius r of such a helix satisfies the approximate relation 2r=7.732l, for l the SNG edge length.  #@NEW_LINE#@#  ', 'Pseudolycaena marsyas reflectance modelling', 'Models of Ps.  #@NEW_LINE#@#  marsyas scales were generated using type-2 amorphous gyroid networks with  around 0.88.  #@NEW_LINE#@#  The effective single-network gyroid primitive unit cell dimension was estimated from micrographs of Ps.  #@NEW_LINE#@#  marsyas to be a=166±8 nm, corresponding to an edge length of l=117±6 nm.  #@NEW_LINE#@#  Approximating the scales reflectance as a result of coherent scattering from (111)-plane-type reflections suggests a=169 nm.  #@NEW_LINE#@#  ', 'Six models were made, each of thickness 1,350 nm and scaled with an a value of 166 nm.  #@NEW_LINE#@#  To model the apparent variation in cross-member thickness within the scales network, amorphous gyroid point patterns were decorated with cylinders having normally distributed radii r, with a mean fractional radius r/l=0.44 and a 15% s.d.  #@NEW_LINE#@#  The resulting network has a mean volume fill fraction of 25%.  #@NEW_LINE#@#  ', 'The Maxwell equations were solved using the Lumericals implementation of the FDTD method (Lumerical Solutions, Inc).  #@NEW_LINE#@#  The previously published experimental data was gathered through normal illumination of a large wing area and use of an integrating sphere in reflection.  #@NEW_LINE#@#  To model this, scales were illuminated from above at normal incidence with a total field scattered field source.  #@NEW_LINE#@#  The scattered fields were recorded by a monitor box, and were projected into the far field in the upper half-space, back along the axis of incidence.  #@NEW_LINE#@#  The total power scattered into the upper half-space was determined and normalized to the injected power.  #@NEW_LINE#@#  Reflectance data was calculated across the wavelength range 360670 nm using a uniform 11.5 nm mesh.  #@NEW_LINE#@#  ', 'Cylinders in the upper half of each scale were modelled as a dispersive material with the refractive index of chitin as measured by polarizing interference microscopy applied to the butterfly Graphium sarpedon66.  #@NEW_LINE#@#  In accordance with an existing study55, the dark banding of the lower half of the Ps.  #@NEW_LINE#@#  marsyas scale was interpreted as pigmentation.  #@NEW_LINE#@#  The absorbance of this pigmentation was not measured experimentally.  #@NEW_LINE#@#  Rather, we suggest that the pigment is ultraviolet absorbing, as has been shown to be the case for Papilio nireus55, the gyroid-containing butterfly Pa. sesostris53 and many other structurally-coloured butterflies67.  #@NEW_LINE#@#  ', 'To make progress in modelling the reflectance of Ps.  #@NEW_LINE#@#  marsyas scales, we propose a plausible complex refractive index for the pigmented lower layer.  #@NEW_LINE#@#  We derive the extinction coefficient () of the ultraviolet-absorbing pigment in Papilio nireus using the BeerLambert law55.  #@NEW_LINE#@#  The real component of the refractive index was taken to be equal to that of the upper layer of the scale.  #@NEW_LINE#@#  Lumericals in-built refractive index fitting algorithm was used to fit this combination of n and ; extra weight was given to the imaginary component to accurately model the absorption.  #@NEW_LINE#@#  The resulting complex refractive index used for the lower half of the scales is inset into Fig 6g.  #@NEW_LINE#@#  ', 'The reflectance spectrum of Fig 6g should be interpreted in light of the assumptions we have made in modelling the complex refractive index of the pigment.  #@NEW_LINE#@#  Given these assumptions, the agreement between the theoretical and experimental reflectance data shows that an amorphous gyroid network is a plausible model for the structure in Ps.  #@NEW_LINE#@#  marsyas scales.  #@NEW_LINE#@#  The divergence between theoretical and experimental reflectance at ultraviolet wavelengths is a result of uncertainty in the true refractive index of the Ps.  #@NEW_LINE#@#  marsyas pigment in this wavelength range.  #@NEW_LINE#@#  Further modelling of Ps.  #@NEW_LINE#@#  marsyas scales should be informed by a direct measurement of their complex refractive index55.  #@NEW_LINE#@#  ', 'Data availability', 'The data underlying the findings of this study are available without restriction.  #@NEW_LINE#@#  Details of the data and how to request access are available from the University of Surrey publications repository: http://dx.doi.org/10.15126/surreydata.00813094.'  #@NEW_LINE#@#  


