article id="http://dx.doi.org/10.1038/ncomms12857"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
The Google matrix controls the stability of structured ecological and biological networks  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
'Mays celebrated theoretical work of the 70s contradicted the established paradigm by demonstrating that complexity leads to instability in biological systems.  #@NEW_LINE#@#  Here Mays random-matrix modelling approach is generalized to realistic large-scale webs of species interactions, be they structured by networks of competition, mutualism or both.  #@NEW_LINE#@#  Simple relationships are found to govern these otherwise intractable models, and control the parameter ranges for which biological systems are stable and feasible.  #@NEW_LINE#@#  Our analysis of model and real empirical networks is only achievable on introducing a simplifying Google-matrix reduction scheme, which in the process, yields a practical ecological eigenvalue stability index.  #@NEW_LINE#@#  These results provide an insight into how network topology, especially connectance, influences species stable coexistence.  #@NEW_LINE#@#  Constraints controlling feasibility (positive equilibrium populations) in these systems are found more restrictive than those controlling stability, helping explain the enigma of why many classes of feasible ecological models are nearly always stable.'  #@NEW_LINE#@#  

Introduction  #@NEW_LINE#@#  
'Some of the outstanding unsolved challenges in theoretical biology concern the puzzling relationships between the feasibility, stability and complexity of biological systems1,2,3,4,5,6,7,8,9,10,11,12,13,14.  #@NEW_LINE#@#  Robert Mays seminal paper1 from the 70s, drew on the emergent patterns of ensembles of large random matrices to demonstrate that more complex and highly interconnected ecosystems are less likely to be stable, (that is, in terms of returning to equilibrium after disturbance).  #@NEW_LINE#@#  The approach has been applied widely in many other disciplines, ranging from systems biology, neurosciences, social network theory, to economics and banking systems15,16.  #@NEW_LINE#@#  Mays analysis has been broadened in recent years as methods for analysing random matrices have advanced2,3,4.  #@NEW_LINE#@#  In addition to stability, any credible ecological model must maintain the basic constraint of feasibility, that all species present must have positive population abundances at equilibrium5,6.  #@NEW_LINE#@#  However, for systems of only minimal complexity, the study of feasibility becomes mathematically intractable.  #@NEW_LINE#@#  Fortunately, progress over the last decade in network science has made exciting new approaches available.  #@NEW_LINE#@#  From this viewpoint, Rohr, Saavedra and Bascompte (RSB) in ref.  #@NEW_LINE#@#  6 introduced a framework which characterizes the range of parameters possible to simultaneously conserve feasibility and stability in large complex networks.  #@NEW_LINE#@#  ', 'Here we propose a completely new direction based on a powerful reduction approach for studying complex systems having large-scale interaction architectures.  #@NEW_LINE#@#  Mutualistic pollination networks, for example, have blocks of competitive and mutualistic interactions6,7, which often drown out the presence of other subtle underlying factors that might matter more, and can result in complex stability transitions.  #@NEW_LINE#@#  A basic understanding of these systems is still lacking6,7.  #@NEW_LINE#@#  By peeling away community-wide background interactions, simpler conditions for feasibility and stability can be derived.  #@NEW_LINE#@#  We make use of the same basic mechanism that sits at the heart of Brin and Pages17 Google matrix which ranks web pages, as it sifts through billions of hyperlinks across the entire world-wide-web17,18.  #@NEW_LINE#@#  The method provides a new way of working with time-honoured ecological interaction matrices.  #@NEW_LINE#@#  From this perspective, the Google matrix was made use of in Mathematical Biology (Stone19 (1988)), some 10 years before it was invented by Google (Supplementary Note 4).'  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
'Competition model', 'The LotkaVolterra (LV) equations of interspecific competition have been a source of tremendous inspiration for ecologists.  #@NEW_LINE#@#  The equations, for n-competing species, read5,13,14,19,20,21,22:', '', 'Here Ni is the abundance of the ith species, while the positive parameter ri greater than 0 defines its birth-rate.  #@NEW_LINE#@#  Central to our work is the interaction matrix A=(aij).  #@NEW_LINE#@#  The competition coefficient aij greater than 0 measures the negative impact species-j has directly on species-i.  #@NEW_LINE#@#  Intraspecific competition coefficients for individuals within a species are scaled to unity aii=1, as are the carrying capacities of all species.  #@NEW_LINE#@#  These commonly adopted scalings have a long historical justification1,5,13,14,19,20,21,22, but may also be relaxed (Supplementary Note 1K).  #@NEW_LINE#@#  ', 'In the naive uniform competition model each species competes with every other with equal strength aij=c, (0 less_than c less_than 1).  #@NEW_LINE#@#  To incorporate the vagaries of the real world, the limited uniform model may be brought to life by incorporating stochasticity that acts to structurally disturb interaction parameters14,19,20,21,22,23.  #@NEW_LINE#@#  A large ensemble of competitive communities may be specified all of which on the average, resemble the uniform model:', '', 'with mean interaction strength  less_than aij greater than =c.  #@NEW_LINE#@#  The structural disturbance matrix B=(bij) has elements of mean zero, uniformly distributed in the interval cv, +cv with spread v (0v1), and variance Var(bij)=2.  #@NEW_LINE#@#  In this model, environmental fluctuations make the interaction strengths vary about the mean strength of competition.  #@NEW_LINE#@#  Thus two communities may both have the same average strength of competition c, but the one undergoing stronger perturbations will show a greater variation in its interaction coefficients.  #@NEW_LINE#@#  Hence the stochastic model associates increasing disturbance with an increase in 2.  #@NEW_LINE#@#  We will find it convenient to represent the level of disturbance in the whole community by , where:', '', 'The ensemble contains the totality of possible interaction matrices.  #@NEW_LINE#@#  Each matrix is associated with its own equilibrium vector of population abundances.  #@NEW_LINE#@#  The subset of feasible solutions of (1), all have positive equilibria, with  greater than 0 for each species-i (* indicating equilibrium).  #@NEW_LINE#@#  The feasible subset represents all possible candidates for survival as a persistent system.  #@NEW_LINE#@#  ', 'For competition communities, the ecological interaction matrix A may be decomposed into three components: a background network of uniform all-to-all competitive interactions C (cij=c), a matrix of perturbations B=(bij) and the self-regulatory interactions via the diagonal identity matrix (1c) I.  #@NEW_LINE#@#  Then A=(1c)I+B+C, or in full:', '', 'The first matrix on the Right Hand (RH) side is Mays matrix of fluctuations AM=(1c)I+B, while the second is the rank-one matrix C.', 'Stability of competition model', 'Under what conditions are feasible model competition systems stable?  #@NEW_LINE#@#  Recall that local stability guarantees that an ecosystem will return to equilibrium after a small population perturbation, while global stability ensures return to equilibrium for any sized population perturbation1,24.  #@NEW_LINE#@#  Theoretical ecologists study matrix eigenvalues (i) of the stability matrix S=DA to determine local stability where diagonal matrix D =diag().  #@NEW_LINE#@#  It is important to emphasize that for the models studied here, for feasible systems (D greater than 0), the matrix S is locally stable if all the eigenvalues of the matrix AM have positive real parts (Methods section).  #@NEW_LINE#@#  ', 'A major achievement of May1 was to characterize the stability properties of the random matrix of fluctuations AM=(1c)I+B when competition is absent (C=0).  #@NEW_LINE#@#  This reflects the stability of all those systems close to equilibrium in which interactions are equally likely to be positive or negative.  #@NEW_LINE#@#  May1 demonstrated that a typical random community will be locally stable if the interaction disturbances are not too large, namely:', '', 'and unstable otherwise (Fig1a).  #@NEW_LINE#@#  The larger the number of species n, the sharper the transition from stability to instability at =1 (Fig 1a).  #@NEW_LINE#@#  However, the analysis does not give direct information about the stability of structured communities, such as communities of competition.  #@NEW_LINE#@#  Nevertheless, the matrix AM will be shown to form the backbone of more complex ecological network models.  #@NEW_LINE#@#  ', 'Figure 1: Local stability and feasibility.  #@NEW_LINE#@#  (a) Percentage of locally stable May matrices AM as a function of disturbance  in an ensemble of 500 matrices for different community sizes n=10, 20, 50 and 100.  #@NEW_LINE#@#  Mays stability threshold sits at =1.  #@NEW_LINE#@#  (b).  #@NEW_LINE#@#  The probability of feasibility, Pr (feasible), as a function of disturbance , for n-species competition with different community sizes n=1, 8, 14, 20 and 100.  #@NEW_LINE#@#  Each probability marked by a square, circle and so on is the proportion of feasible systems in 500 runs of equation (1).  #@NEW_LINE#@#  Analytical prediction from Supplementary Note 1C displayed as continuous curves.Full size image', 'We begin by arguing that stability criterion (5) for the May matrix AM proves to be the exact same stability condition for feasible LV-competition systems but for any c (0 less_than c less_than 1), in equation (1).  #@NEW_LINE#@#  To understand this, compare the matrices:', '', 'In fact A is just AM, but perturbed by the uniform competition matrix C. Quite remarkably, we show that the stability matrices associated with these two matrices are Google matrices (Methods section) and therefore have all eigenvalues, except for one, exactly the same (Fig 2b; Supplementary Note 1F).  #@NEW_LINE#@#  The end result is that matrix C, with all its many interactions, has little relevance for determining stability, which can be deduced solely from analysis of the reduced matrix AM (Supplementary Note 1E).  #@NEW_LINE#@#  The result, which is not trivial, has gone unnoticed previously, but it is robust and holds almost exactly when the scaling of model (1) is relaxed (Supplementary Note 1K).  #@NEW_LINE#@#  The same underlying concept was taken advantage of in a different context to calculate PageRank via the Google matrix, in a way that takes into account the massive number of links across the entire world-wide-web17 (Methods section).  #@NEW_LINE#@#  Putting this all together, we have found:', 'Figure 2: Competition model.  #@NEW_LINE#@#  (a) Competition model.  #@NEW_LINE#@#  Characteristics of communities having n=20 species, competition c=0.3, as a function of disturbance .  #@NEW_LINE#@#  Percentage of 500 systems that were: (i) feasible: %F (red line); (ii) possessed locally stable interaction matrices A: %LS (Locally Stable; green line); (iii) feasible together with locally stable interaction matrices A: %F&LS (blue circles); (iv) having globally stable interaction matrices %GS (Globally Stable; magenta): (v) both feasible and having globally stable interaction matrices: %F&GS (also blue circles).  #@NEW_LINE#@#  The graphs indicate %F=%F&LS=%F&GS.  #@NEW_LINE#@#  (b) As the stability matrix S=DA (blue line) is a Google matrix , its critical eigenvalue is identical to that of SM=DAM (red+; see Methods-Google matrix).  #@NEW_LINE#@#  The critical eigenvalues of the two matrices lie exactly on the same curve when plotted as a function of competition strength c. Here the competition interaction matrix is A=I(1 c)+C+B and AM=I(1 c)+B with n=10, v=0.4.Full size image', 'Result A', 'Feasible competition systems for any c (0 less_than c less_than 1), are locally stable if Mays matrix AM is locally stable, namely when  less_than 1, and unstable otherwise.  #@NEW_LINE#@#  The larger the number of species, n, the sharper is the transition from stability to instability at =1(Fig 1a).  #@NEW_LINE#@#  ', 'The conclusion should be seen as a restatement of Mays1 result for random communities, but now here widened to apply for random communities structured with competition.  #@NEW_LINE#@#  The parameter  representing the intensity of structural disturbances, completely governs stability in a simple manner.  #@NEW_LINE#@#  It should also be noted that we are chiefly interested in local stability, since fortuitously, feasible locally stable competition systems can be shown to be nearly always globally stable (Supplementary Note 1G; The exceptions are discussed in the Methods section.).  #@NEW_LINE#@#  ', 'Feasibility of competition model', 'Following the lead from Roberts (1974, 1989), suppose we draw a system at random from the stochastic ensemble competition model, for fixed model parameters.  #@NEW_LINE#@#  We are interested in determining the probability of its feasibility, Pr(Feasible), for which all n-species have positive equilibrium populations.  #@NEW_LINE#@#  The probability Pr(Feasible) may be estimated as the percentage of feasible systems from a set of 500 random model systems as plotted in Fig 1b.  #@NEW_LINE#@#  It is possible to show that for a given community size n, the probability is purely a function of  (Supplementary Note 1C).  #@NEW_LINE#@#  The model estimates of Pr(Feasible) match analytical predictions closely (Methods section).  #@NEW_LINE#@#  Clearly the larger the number of species n, the more difficult it becomes to generate a feasible system.  #@NEW_LINE#@#  Moreover, Fig 1b demonstrates that large feasible systems (n greater than 14) require that the variability of the structural disturbances is not too large, specifically  less_than 1.  #@NEW_LINE#@#  ', 'Importantly, analytical and numerical analyses predict that almost all feasible competition systems sit in the range  less_than 1 (Methods section, Supplementary Note 1H).  #@NEW_LINE#@#  Hence feasible systems must be stable (locally and globally; Methods section, Supplementary Note 1I) and certainly for large systems, all are stable (n greater than 14; Fig 2a).  #@NEW_LINE#@#  ', 'To understand this further, Fig 2a displays the feasibility and stability characteristics of an n=20 species community with c=0.3, and plotted as a function of disturbance .  #@NEW_LINE#@#  These results were deduced numerically from equation 1.  #@NEW_LINE#@#  Almost all feasible model communities are locally stable, and nearly always globally stable.  #@NEW_LINE#@#  As  increases, the proportion of feasible systems (red) reduces to zero well before the proportion of locally (green) or globally (magenta) stable interaction matrices reduce to zero.  #@NEW_LINE#@#  As such, these calculations predict that nearly all feasible systems are stable, a characteristic that appears to be not restricted to the specific parameter ranges of Fig 2a (Supplementary Note 1J).  #@NEW_LINE#@#  ', 'However, this probability argument does not make transparent the key link between feasibility and stability.  #@NEW_LINE#@#  In Supplementary Note 1H a simple generic mathematical argument identifies this link, and can be explained via Fig 3a.  #@NEW_LINE#@#  As shown, when  increases, at least one positive equilibrium population is destined to become unsustainably large in magnitude, and finally blows-up at 1 when stability of the interaction matrix A is lost.  #@NEW_LINE#@#  Before blow up, the large equilibrium values of some populations necessarily drive weaker species to extinction (=0.58), and negative values, explaining why feasibility is lost before stability of the interaction matrix A is lost.  #@NEW_LINE#@#  This is the first theoretical prediction of the transition in a relatively general setting.  #@NEW_LINE#@#  ', 'Figure 3: Equilibrium blow-up and loss of stability.  #@NEW_LINE#@#  (a) Equilibrium abundances for competition model (v=1, c=0.3) with n=20 species plotted versus disturbance level .  #@NEW_LINE#@#  The green line plots the real part of the critical eigenvalue of the interaction matrix A which zeroes when =1.04, initiating instability.  #@NEW_LINE#@#  Feasibility is lost when =0.58 and a population goes negative, well before stability of A is lost at =1.04 where equilibria blow-up see Methods section.  #@NEW_LINE#@#  (b) Equilibrium abundances of CM-model for n=20 species (n1=n2=10; c=0.2, q=0.7) plotted versus destabilizing interaction strength m. Feasibility is lost at m=0.19.  #@NEW_LINE#@#  This is well before the critical eigenvalue (green line) zeroes at the equilibrium blow-up point m=0.27, where stability of A is lost.Full size image', 'Competition-mutualism (CM) networks', 'The same methods can be extended to study more complex ecological systems, such as the animal-plant system presented in RSB (refs 6, 7) in which mutualistic and competition networks operate simultaneously.  #@NEW_LINE#@#  Despite years of study, the stability properties of these systems remain poorly understood.  #@NEW_LINE#@#  Let Ai and Pi and denote the abundances of n1 animal species and n2 plant species.  #@NEW_LINE#@#  Equations (1) then read:', '', 'Here, all plants species compete with each other with the same negative interaction strength c (0 less_than c less_than 1) and likewise for animal species.  #@NEW_LINE#@#  Any interactions between plant species-i and animal species-j are mutualistic and positive (mij0).  #@NEW_LINE#@#  ', 'The interaction matrix A may be split into its competitive and mutualistic blocks, and for the naive uniform model:', '', 'The two diagonal blocks of matrix C* represent the uniform competitive interactions within plants and within animals.  #@NEW_LINE#@#  Off-diagonal blocks of C* are set zero given plants do not compete with animals for the same resources.  #@NEW_LINE#@#  ', 'The two off-diagonal cooperative blocks define the matrix M* of mutualistic interactions between plants and animals.  #@NEW_LINE#@#  Diagonal blocks are set to zero, since in this scheme animals (/plants) do not help their kind.  #@NEW_LINE#@#  Matrix M*, as shown schematically above, represents the uniform model of all-to-all interactions, although other network topologies are also explored.  #@NEW_LINE#@#  This includes connectance, whereby a proportion (1q) of randomly chosen nonzero interactions of M* are set to zero, leaving a proportion q nonzero.  #@NEW_LINE#@#  ', 'Moving over to the stochastic ensemble model framework, nonzero mutualistic interactions are taken to be of the form mij=m+bij greater than 0 , and thus all of the same average strength m. The mutualism matrix is now', '', 'where B =(bij) consists of random mean-zero structural disturbances, and where the uniform model corresponds to B=0.  #@NEW_LINE#@#  The bij are uniformly distributed in the interval mv, +mv with spread v (0v1), having corresponding variance Var(bij)=2.  #@NEW_LINE#@#  We are chiefly interested in local stability of the interaction matrix A since fortuitously, feasible locally stable CM-systems are always found globally stable (Supplementary Note 2; RSB).  #@NEW_LINE#@#  ', 'Consider then an n-species fully connected community (n1=n2=n/2 plants and animals; q=1).  #@NEW_LINE#@#  Figure 4a outlines the feasibility and stability properties as a function of mutualism m and competition c. The interaction matrix A is locally stable for all parameters inside the shaded prominent Triangle of Stability  (green and brown).  #@NEW_LINE#@#  Note that the region where systems are both feasible and stable (brown), is necessarily enclosed within .  #@NEW_LINE#@#  Stability requires competition c to lie in an interval between lower and upper bounds: strong enough to prevent runaway mutualism, but not too strong to promote competitive exclusion.  #@NEW_LINE#@#  Moreover the interval shrinks as mutualism increases in intensity, thereby creating the triangles geometry.  #@NEW_LINE#@#  Figure 4b demonstrates that  can span large areas of parameter space, especially when disturbance is low (for example, v=0.1), indicative of relatively high structural stability.  #@NEW_LINE#@#  The latter implies the existence of a relatively large area in parameter space where the model is both feasible and stable.  #@NEW_LINE#@#  ', 'Figure 4: CM-model.  #@NEW_LINE#@#  (a,b) with n=100 species (n1=n2=50), all-to-all mutualistic connectance q=1 and disturbance spread v=0.5.  #@NEW_LINE#@#  All systems are feasible and stable (F&S) in brown area of parameter space, which is here mutualistic strength m versus competition c. Systems possessing stable interaction matrices (S) but not feasible are located in green area of parameter space.  #@NEW_LINE#@#  The Triangle of Stability  has LH-stability border where qm=c (magenta circles).  #@NEW_LINE#@#  The RH-Stability border is determined by the second-eigenvalue criterion equation (5) (red circles); and corroborated by numerical computations (blue line).  #@NEW_LINE#@#  (b) Similar to (a) with q=1, but compares two disturbance levels, v=0.1, and v=0.5 by overlaying plots.  #@NEW_LINE#@#  (c) As (b) but with low connectance q=0.4.  #@NEW_LINE#@#  (d) Canadian forest pollination matrix analysis n1=102, n2=12; q=0.13.  #@NEW_LINE#@#  v=0.5; (e) Height h() of triangle , versus q (when n1=n2=50; v=0.2).  #@NEW_LINE#@#  Simulations (red) and mathematical prediction h()1/ (blue) from Supplementary Note 2D; (f) Testing Mays criterion CM=1 (see below Result C).  #@NEW_LINE#@#  F and S plotted as function of disturbance CM versus c (q=1, m=0.2) for n1=n2=50 species.Full size image', 'Contrast this pattern with a community of intermediate connectance q=0.4 in Fig 4c, where  proves to be relatively small in area.  #@NEW_LINE#@#  This small  holds for disturbance levels that are both low (v=0.1) and high (v=0.9), and is characteristic to a wide range of connectance levels 0.1 less_than q less_than 0.9 as shown in Fig 4e.  #@NEW_LINE#@#  Intriguingly, CM-systems are endowed with intrinsically poor structural stability for the intermediate connectances typical of real world networks (Fig 4d).  #@NEW_LINE#@#  Note however, once connectance q exceeds 50% structural stability actually increases with q; at first gradually but the increase is rapid once the interaction network becomes tight (Fig 4e).  #@NEW_LINE#@#  ', 'Extending the Google matrix approach to CM networks', 'Ideally we would like to be able to predict the stability and other characteristics of the CM-system from a knowledge of the empirical interaction network M. It is not obvious that the Google matrix approach outlined above can contribute because the matrices involved are more complex in structure here.  #@NEW_LINE#@#  Quite remarkably though, the reduction approach can be successfully extended, and yields general criteria for mutualism matrices M of arbitrary topology.  #@NEW_LINE#@#  ', 'Progress can be made by determining the borders of the triangle of stability  (Fig 4a).  #@NEW_LINE#@#  The left-hand (LH) border is just the line qmc (magenta circles; Supplementary Note 2D).  #@NEW_LINE#@#  On this border a species benefits from mutualism are on average equal to its losses from competition.  #@NEW_LINE#@#  Stability requires that mutualism levels be of limited intensity qm less_than c, which include all points in Fig 4a below the LH-border.  #@NEW_LINE#@#  ', 'The RH-stability border is found by applying the Google reduction to interaction matrix A=I(1c)+C*M. The reduction makes it possible to discard the competition interaction matrix C*, and leads to a simple condition based importantly, on 2(M), the second-largest or subdominant eigenvalue of the mutualism matrix M (Supplementary Note 2C).  #@NEW_LINE#@#  In Supplementary Note 2C it is shown that the RH-stability boundary in Fig 4a corresponds to the line 2(M)=1c.  #@NEW_LINE#@#  ', 'Result B', 'Summarising, stability requires that we consider only points in parameter space lying below the LH-border of the triangle .  #@NEW_LINE#@#  For these points: feasible CM-models are locally stable if', '', 'and unstable otherwise.  #@NEW_LINE#@#  ', 'This establishes a direct connection between the topology of M, as coded into the eigenvalues10 of M, and the stability of the CM-model.  #@NEW_LINE#@#  While many analyses (for example, ref.  #@NEW_LINE#@#  10) focus on the dominant eigenvalue of M, this can lead to a wrong interpretation for understanding general stability.  #@NEW_LINE#@#  The above criterion (10) was tested on simulated model mutualism networks in Fig 4a,c,d,f and provides excellent predictions (red circles) of the true RH-stability border (blue).  #@NEW_LINE#@#  ', 'The criterion (10) is appropriate whether or not M* has block structure or the disturbance matrix B is random, thereby opening the door for studying real empirical networks (Supplementary Note 3).  #@NEW_LINE#@#  As an example, consider the highly speciose mutualist-pollination network from Canadian spruce-fir forests25, having n1=102 insect species, and n2=12 plants.  #@NEW_LINE#@#  The eigenvalue 2(M) accurately identifies the RH-stability border of  in Fig 4d (red circles).  #@NEW_LINE#@#  The low connectance (q=0.13) of the matrix effectively swivels  to the left, and results in a mutualism-competition trade-off: intense mutualism can be maintained only for sufficiently weak levels of competition, and vice-versa.  #@NEW_LINE#@#  In this respect, the mutualistic network acts to reduce or minimize competition7.  #@NEW_LINE#@#  ', 'Note that the feasible systems (brown region) in Fig 4 are contained fully within the triangle of stability .  #@NEW_LINE#@#  Figure 3b makes clear a step-wise transition.  #@NEW_LINE#@#  As mutualistic strength (m) increase from zero, feasibility is lost first, followed by loss of stability of the interaction matrix A at higher levels of disturbance (Methods section; Supplementary Note 2E).  #@NEW_LINE#@#  ', 'All-to-all mutualism', 'Returning now to the methodology, it is enlightening to take the Google reduction procedure one step further.  #@NEW_LINE#@#  Suppose that the matrix M* is significantly structured, for example, in all-to-all connected blocks with connectance q=1.  #@NEW_LINE#@#  Now when investigating stability, both matrices C* and M* may be discarded (Supplementary Note 2C).  #@NEW_LINE#@#  Stability may then be determined from the matrix: AM=I(1c)B, which returns us back to the May criterion:', 'Result C', 'Assuming that we consider only points in parameter space lying below the LH-border (Supplementary Note 2E), then: feasible all-to-all block CM-systems are locally stable if matrix AM is locally stable.and unstable otherwise (Supplementary Note 2D).  #@NEW_LINE#@#  ', 'The criterion gives deeper insight into the determinants of stability in the CM-model.  #@NEW_LINE#@#  Namely stability is lost when the underlying stable uniform model is perturbed too severely.  #@NEW_LINE#@#  For the simplest case, where the number of animal equals the number of plant species (n1=n2=, q=1), the May stability condition requires CM less_than 1, and instability when CM greater than 1, where now  (Supplementary Note 2A).  #@NEW_LINE#@#  In Fig 4a,f, the May criterion accurately predicts the border of stability at CM=1 (black line).  #@NEW_LINE#@#  The LH-border occurs as predicted at m=c=0.2 (magenta).  #@NEW_LINE#@#  ', 'Real mutualism networks', 'Although claims have been made that mutualism networks have strong internal structure6, our analysis of 20 real empirical mutualism networks from RSB show them to have almost identical characteristics as their randomized matrix counterparts26,27 in terms of two key parameterstheir critical eigenvalue and species nestedness (Fig 5; Supplementary Note 2F).  #@NEW_LINE#@#  Surprisingly, any internal topological structure in these networks cannot play a major role, assuming realistic biological constraints that preserve the network degree distribution26,27.  #@NEW_LINE#@#  The impact of these features on the eigenvalue appears to be minimal compared with the impact of connectance on structural stability, as just outlined.  #@NEW_LINE#@#  ', 'Figure 5: Nestedness.The critical eigenvalue (blue line) of the interaction matrix and nestedness (black line; calculated as in ref.  #@NEW_LINE#@#  26 for each of 21 empirical networks separated along x-axis (RSB; Supplementary Note 2F) where parameters taken as c=0.2 and m=0.1.  #@NEW_LINE#@#  Each red/green circle shows the average of the eigenvalue/nestedness of 25 randomized matrices26,27.Full size image'  #@NEW_LINE#@#  

Discussion  #@NEW_LINE#@#  
'In conclusion, while recent studies of the CM-model have failed to find any stability conditions or particular pattern in how the critical (stability) level of mutualistic strength varies with model parameters (RSB), the techniques presented here result in strong clear relationships.  #@NEW_LINE#@#  Moreover, Mays1 early stability predictions equation (5) for large complex random systems and equation (10), hold surprisingly well for competition, as well as highly networked CM-systems; local stability is lost when disturbances increase beyond a relatively small threshold level (=1).  #@NEW_LINE#@#  This proneness to instability increases with the number of species, intensity of competition and level of disturbance.  #@NEW_LINE#@#  Analysis of structural stability, the range of parameter space for which feasibility and stability holds, leads to a different but not contradictory viewpoint, more in line with Elton28.  #@NEW_LINE#@#  Namely, CM-systems have poor structural stability for 0.1 less_than q less_than 0.9, while tightly connected ecological networks have the highest structural stability.  #@NEW_LINE#@#  Ecosystem stability and vulnerability should be assessed by integrating the results from these two different frameworks.  #@NEW_LINE#@#  ', 'The theory developed here also makes clear that constraints on feasibility are more restrictive than those on stability, and explains why nearly all feasible systems are stable for many classes of ecological models (Supplementary Note 2E).  #@NEW_LINE#@#  Interestingly, loss of feasibility might be viewed as an early warning precursor of the interaction matrix losing stability.  #@NEW_LINE#@#  Hence, external anomalies from changing climate, resource availability or environmental hazards, may readily lead to species extinctions often well before ecosystem instability can even be identified.  #@NEW_LINE#@#  The tools presented here, based on the Google matrix, extend the scope of Mays study of large complex systems making it possible to untangle other important ecological interaction structures.  #@NEW_LINE#@#  These techniques can be readily adapted to a wide range of disciplines in network science.'  #@NEW_LINE#@#  

Methods  #@NEW_LINE#@#  
'Feasibility', 'A calculation (Supplementary Note 1C, refs 19, 20) shows that the probability a single arbitrary species has a positive equilibrium population is purely a function of , the variability of the structural disturbances, that is, Pr( greater than 0)=p(), as plotted in Fig 1b (purple).  #@NEW_LINE#@#  A good approximation for the probability that all n-species are positive is then: Pr(Feasible)=p()n. The predictions of feasibility, Pr(Feasible) accurately match model simulations for a wide range of community sizes n and parameters.  #@NEW_LINE#@#  This is seen in Fig 1b which plots Pr(Feasible) as estimated as the percentage of feasible systems from a set of 500 random model systems.  #@NEW_LINE#@#  The figure shows that large feasible systems are only possible if the variability of the structural disturbances is not too large, or in quantitative terms, if  less_than 1 (cf equation (3)).  #@NEW_LINE#@#  Only then can p() be large enough to ensure that Pr(Feasible) is significantly greater than zero.  #@NEW_LINE#@#  Even for relatively small systems, the probability of feasibility is slight when 1 (for example, Pr(Feasible)=0.07 when =1, n=8).  #@NEW_LINE#@#  ', 'Stability', 'The stability of equation (1) is determined by the eigenvalues of the stability or community matrix S=DA, where D is the diagonal matrix D =diag().  #@NEW_LINE#@#  Local stability is ensured iff all eigenvalues of S have positive real parts.  #@NEW_LINE#@#  For feasible competition systems, D greater than 0, it is demonstrated in Supplementary Note 1I that the matrix S is locally stable iff all eigenvalues of AM have positive real parts.  #@NEW_LINE#@#  Global stability is ensured if the symmetric matrix A+AT greater than 0 is positive definite (that is, has all eigenvalues positive; (24) and Supplementary Note 1G).  #@NEW_LINE#@#  In fact, nearly all feasible competition systems are globally stable, with rare counterexamples appearing only for  greater than 0.71 when the number of species n is not large (Fig 2a (magenta)) as proven in Supplementary Note 1G.  #@NEW_LINE#@#  ', 'When Google meets LotkaVolterra', 'The simplest Google matrix is of the form:', '', 'where E is a matrix with Eij=1/n.  #@NEW_LINE#@#  The matrix A is an nxn stochastic matrix whose row sums add to unity, that is, Ae=e, e=1, 1, 1, ., 1, 1.  #@NEW_LINE#@#  Matrix A usually represents a scaled directed network such as the world-wide-web.  #@NEW_LINE#@#  The Google matrix G has two special properties.  #@NEW_LINE#@#  (I) First, there is a left-eigenvector  of G such that G=, referred to as the PageRank vector, that provides a rank of the relative importance of the nodes (/webpages) in the network17.  #@NEW_LINE#@#  (II) A second property concerns the eigenvalues of A.  #@NEW_LINE#@#  Specifically, if A has eigenvalues 1=1, 2, , n1, n, then the eigenvalues of G are18 1=1, (1c)2, , (1c)n1, (1c)n. It is important that the damping factor c is in the range 0 less_than c less_than 1, because this gaurantees a unique solution for the PageRank vector and one that can be computed in a fast way and whose convergence is assured.  #@NEW_LINE#@#  ', 'A more general Google matrix is of the form  where A is an nxn matrix (not necessarily stochastic) and u is a right eigenvector of A.  #@NEW_LINE#@#  In the case of the LotkaVolterra competition model, the interaction matrix is:', '', 'where the matrix of ones is E=e.eT and.  #@NEW_LINE#@#  eT=1, 1, 1,  1, 1 and AM is the May stability matrix.  #@NEW_LINE#@#  But A is not a Google matrix since e is not a right eigenvector of A, and thus neither of the two properties above will hold.  #@NEW_LINE#@#  However, at equilibrium the LV equations also satisfy the additional constraint AN*=e, where N* is the vector of equilibrium populations.  #@NEW_LINE#@#  Using this, it is easy to show that the stability matrix S=DA is a Google matrix.  #@NEW_LINE#@#  Because of the scaling involved and property II above, all but one of the eigenvalues of S=DA are identical to the eigenvalues of the May stability matrix DAM (ref.  #@NEW_LINE#@#  19; Supplementary Notes 1F and 4).  #@NEW_LINE#@#  ', 'Feasibilty lost before stability', 'For competition systems see main text.  #@NEW_LINE#@#  A similar generic mechanism is found for CM-systems.  #@NEW_LINE#@#  As the mutualistic interaction strength m increases from zero in Fig 3b, many of the equilibrium populations grow exponentially, and ultimately reach unsustainable levels.  #@NEW_LINE#@#  Thus feasibility is lost at m=0.19, well before the population blow-up point at m=0.27 where stability of the interaction matrix is always lost.  #@NEW_LINE#@#  The mechanism reflects an intrinsic bifurcation instability of the CM-model whereby at high levels of mutualism, species with large abundances drive weaker species to low levels and then negative values so that feasibility is lost before stability is lost.  #@NEW_LINE#@#  For this reason, all feasible CM-models examined here are stable, as explained in more depth in Supplementary Note 2E.  #@NEW_LINE#@#  ', 'CM-systems and the subdominant eigenvalue', 'Intriguingly 2(M) is a direct proxy for interaction variability and our analysis finds it composed of two components: 2(M)=Rand1+Rand2 (Supplementary Note 2D).  #@NEW_LINE#@#  (i) Rand1 represents the variability or spread of the structural disturbances bij, via the parameter v. Surprisingly, this component has negligible impact unless connectance is extreme for example, q1.  #@NEW_LINE#@#  (ii) Rand2 represents the randomness induced by connectivity itself, since each interaction has a probability q of being nonzero.  #@NEW_LINE#@#  This component eclipses the former when 0.1 less_than q less_than 0.9.  #@NEW_LINE#@#  Figure 4e shows how the height h() and thus area of the stability triangle, depends on q according to both simulations and mathematical predictions (Supplementary Note 2D).  #@NEW_LINE#@#  Unusually, h() is almost constant and of low magnitude for 0.1 less_than q less_than 0.9.  #@NEW_LINE#@#  In this regime, a networks connectivity has large restrictive impact on the area of , and thus structural stability.  #@NEW_LINE#@#  ', 'Data availability', 'The study required analysis of 21 empirical mutualism networks.  #@NEW_LINE#@#  The data were chosen based on the networks analysed in the paper of Rohr et al.  #@NEW_LINE#@#  (ref.  #@NEW_LINE#@#  6) and published at www.web-of-life.es.'  #@NEW_LINE#@#  


