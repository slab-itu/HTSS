article id="http://dx.doi.org/10.1038/ncomms15145"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Energy scaling of targeted optimal control of complex networks  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
'Recently it has been shown that the control energy required to control a dynamical complex network is prohibitively large when there are only a few control inputs.  #@NEW_LINE#@#  Most methods to reduce the control energy have focused on where, in the network, to place additional control inputs.  #@NEW_LINE#@#  Here, in contrast, we show that by controlling the states of a subset of the nodes of a network, rather than the state of every node, while holding the number of control signals constant, the required energy to control a portion of the network can be reduced substantially.  #@NEW_LINE#@#  The energy requirements exponentially decay with the number of target nodes, suggesting that large networks can be controlled by a relatively small number of inputs as long as the target set is appropriately sized.  #@NEW_LINE#@#  We validate our conclusions in model and real networks to arrive at an energy scaling law to better design control objectives regardless of system size, energy restrictions, state restrictions, input node choices and target node choices.'  #@NEW_LINE#@#  

Introduction  #@NEW_LINE#@#  
'Recent years have witnessed increased interest from the scientific community regarding the control of complex dynamical networks1,2,3,4,5,6,7,8,9,10,11,12,13,14.  #@NEW_LINE#@#  Some common types of networks examined throughout the literature are power grids15,16, communication networks17,18, gene regulatory networks19, neuronal systems20,21, food webs22 and social systems23.  #@NEW_LINE#@#  We define networks as being composed of two components; the nodes that constitute the individual members of the network and the edges that describe the coupling or information sharing between nodes24.  #@NEW_LINE#@#  Particular focus has been paid to our ability to control these networks6,8,9,10,11,12,14,25.  #@NEW_LINE#@#  A network is deemed controllable if a set of appropriate control signals can drive the network from an arbitrary initial condition to any final condition in finite time.  #@NEW_LINE#@#  If a network is controllable, a control signal that achieves such a goal is not necessarily unique.  #@NEW_LINE#@#  ', 'One important metric to characterize these control signals is the energy that each one requires.  #@NEW_LINE#@#  From optimal control theory, we can define the control action that, for a given distribution of the control input signals, satisfies both our initial and final conditions as well as minimizes the energy required to perform the task26.  #@NEW_LINE#@#  The energy associated with the minimum energy control action provides an energetic theoretical limit.  #@NEW_LINE#@#  Knowledge of the minimum control energy is crucial to understand how expensive it can be to control a given network when applying any alternative control signal.  #@NEW_LINE#@#  The minimum energy framework has recently been examined in refs 27, 28, which have shown that based on the underlying network structure, the distribution of the control input signals, the desired final state and other parameters, the energy to control a network may lie on a distribution that spans a broad range of orders of magnitude.  #@NEW_LINE#@#  In this paper, we focus on reducing the energy that is maximum with respect to the choice of the initial state, final state and, in general, of an arbitrary control action.  #@NEW_LINE#@#  We note that in real applications involving large complex networks, achieving control over all of the network nodes is often unfeasible27,28 and ultimately unnecessary.  #@NEW_LINE#@#  ', 'One possible method to reduce the required energy was investigated in ref.  #@NEW_LINE#@#  29, where additional control signals were added in optimal locations in the network according to each nodes distance from the current set of control signals.  #@NEW_LINE#@#  In refs 30, 31, the minimum dominating set (MDS) of the underlying graph of a network is determined and each node in the MDS is assumed capable of generating an independent signal along each of its outgoing edges.  #@NEW_LINE#@#  As every node not in the MDS is only one edge away from a node in the MDS, and each edge from an MDS node to a non-MDS represents a unique control signal, the control energy will be relatively small.  #@NEW_LINE#@#  In this paper, for the first time, we adjust the control goal to affect only a subset of the network nodes, chosen as the targets of the control action, and consider the effect of this choice on the required control energy.  #@NEW_LINE#@#  This type of target control action is typically what is needed in applications in gene regulatory networks32, financial networks33 and social systems34.  #@NEW_LINE#@#  ', 'Our first main contribution is determining how the energy scales with the cardinality of the target set.  #@NEW_LINE#@#  In particular, we find that the minimum control energy to control a portion of the complex network decays exponentially as the number of targets is decreased.  #@NEW_LINE#@#  Previous work27,28 has only investigated the control energy for complex networks when the target set coincides with the set of all nodes.  #@NEW_LINE#@#  We also look at the energetic relation between the number of targets and other network parameters such as the number of inputs and the amount of time allocated for the control action.  #@NEW_LINE#@#  Our second main contribution is showing that target control is applicable to other control actions generated with respect to other cost functions.  #@NEW_LINE#@#  Target control has received recent attention in refs 14, 35, which examined methods to choose a minimal set of independent control signals necessary to control just the targets.  #@NEW_LINE#@#  Here a target control signal is examined that is optimal with respect to a general quadratic cost function that appears often in the control of many real systems.'  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
'Problem formulation', 'Complex networks consist of two parts; a set of nodes with their interconnections that represent the topology of the network, and the dynamics that describe the time evolution of the network nodes.  #@NEW_LINE#@#  First, we summarize the definitions needed to describe a network.  #@NEW_LINE#@#  We define , i=1,,n to be the set of n nodes that constitute a network.  #@NEW_LINE#@#  The adjacency matrix is a real, square n × n matrix, A, which has non-zero elements aij if node i receives a signal from node j.  #@NEW_LINE#@#  For each node i we count the number of receiving connections, called the in-degree , and the number of outgoing connections, called the out-degree .  #@NEW_LINE#@#  The average in-degree and average out-degree for a network is kav.  #@NEW_LINE#@#  One common way to characterize the topology of a network is by its degree distribution.  #@NEW_LINE#@#  Often the in-degree and out-degree distributions of networks that appear in science and engineering applications are scale-free, that is, p(k)k where k is either the in-degree or the out-degree with corresponding in and out, and most often 23 (ref.  #@NEW_LINE#@#  36).  #@NEW_LINE#@#  ', 'While most dynamical networks that arise in science and engineering are governed by nonlinear differential equations, the fundamental differences between individual networks and the uncertainty of precise dynamics make any substantial overarching conclusions difficult6,35,36.  #@NEW_LINE#@#  Nonetheless, linear controllers have proven to be adequate in many applications by approximating nonlinear systems as linear systems in local regions of the n-dimensional state space37.  #@NEW_LINE#@#  We examine linear dynamical systems, as it is a necessary first step to understanding how target control may benefit nonlinear systems.  #@NEW_LINE#@#  The linear time invariant network dynamics are', '', 'where x(t)=x1(t),,xn(t)T is the n × 1 time-varying state vector, u(t)=u1(t),,um(t)T is the m × 1 time-varying external control input vector and y(t)=y1(t),,yp(t)T is the p × 1 time-varying vector of outputs, or targets.  #@NEW_LINE#@#  The n × n matrix A={aij} is the adjacency matrix described previously, the n × m matrix B defines the nodes in which the m control input signals are injected, and the p × n matrix C expresses the relations between the states that are designated as the outputs.  #@NEW_LINE#@#  In addition, the diagonal values of A, aii, i=1,,n, which represent self-regulation, such as birth/death rates in food webs, station keeping in vehicle consensus, degradation of cellular products and so on, are chosen to be unique at each node (see proposition 1 in ref.  #@NEW_LINE#@#  38).  #@NEW_LINE#@#  These diagonal values are chosen to also guarantee that A is Hurwitz so the system in equation (1) is internally stable.  #@NEW_LINE#@#  We restrict ourselves to the case when B (C) has linearly independent columns (rows) with a single non-zero element, that is, each control signal is injected into a single node (defined as an input node) and each output is drawn from a single node (defined as a target node).  #@NEW_LINE#@#  Our particular choice of the matrix C is consistent with target control, as our goal is to individually control each one of the target nodes.  #@NEW_LINE#@#  Our selection of the matrix B is due to our assumption that different network nodes may be selectively affected by a particular control signal, for example, a drug interacting with a specific node in a protein network.  #@NEW_LINE#@#  Note that in todays information-rich world, a main technological limitation is not generating control signal, but rather placing actuators at the input nodes; hence our assumption that each actuator is driven by an independent control signal is sound14.  #@NEW_LINE#@#  We define  as the subset of target nodes and  as the number of target nodes.  #@NEW_LINE#@#  A small sample schematic is shown in Fig 1a, which demonstrates the graphical layout of our problem emphasizing the graph structure and the role of input nodes and targets.  #@NEW_LINE#@#  Here by an input node, we mean a node that directly receives one and only one control input such as nodes 1 and 2 in Fig 1a.  #@NEW_LINE#@#  The explicit equation for the time evolution of the outputs is', 'Figure 1: An example network and control energy reduction with fewer targets.  #@NEW_LINE#@#  (a) A sample network with seven nodes and colour-coded input signals (blue) and output sensors (pink).  #@NEW_LINE#@#  Note that each control input is directly connected to a single node, and each output sensor receives the state of a single node.  #@NEW_LINE#@#  Nodes directly connected to the pink outputs are target nodes, that is, they have a prescribed final state that we wish to achieve in finite time, tf.  #@NEW_LINE#@#  The corresponding vector y(tf) is defined in terms of the states as well.  #@NEW_LINE#@#  Nodes directly receiving a signal from a blue node are called input nodes and the remaining nodes are neither input nodes nor target nodes.  #@NEW_LINE#@#  (b) We examine a three-node network where every node is a target node (pink nodes) and one node receives a control input (blue).  #@NEW_LINE#@#  The edge weights are shown and the self-loop magnitude k=1.  #@NEW_LINE#@#  (c) The state evolution is shown where the initial condition is the origin and the final state for each target node is yi(tf)=1, i=1,2,3.  #@NEW_LINE#@#  (d) The square of the magnitude of the control input is also shown.  #@NEW_LINE#@#  The energy, or the control effort, is found by integrating the square of the magnitude of the control input.  #@NEW_LINE#@#  For this case, E=|u(t)|2382 (a.u.).  #@NEW_LINE#@#  (e) The same network as in b but now only one node is declared a target node.  #@NEW_LINE#@#  (f) The state evolution is shown where the initial condition remains the origin but the final condition is only defined for y3(tf)=1.  #@NEW_LINE#@#  (g) The square of the magnitude of the control input is also shown.  #@NEW_LINE#@#  Note the different vertical axis scale as compared to d. For the second case, E=|u(t)|266.3 (a.u.  #@NEW_LINE#@#  ).Full size image', '', 'where we are free to choose u(t) such that it satisfies the prescribed initial state, x(t0)=x0 and desired final output, y(tf)=yf.  #@NEW_LINE#@#  Note that if we set C=In, where In is the n × n identity matrix, then y(t)=x(t).  #@NEW_LINE#@#  ', 'The minimum energy control input, well known from linear systems theory39, minimizes the cost function  and satisfies an arbitrary initial condition and an arbitrary final condition if the system is controllable.  #@NEW_LINE#@#  A similar control input is optimal when the final condition is imposed on only some of the states, that is, on the target nodes (see the derivation in Supplementary Note 2)', '', 'The real, symmetric, semi-positive definite matrix  is the controllability Gramian.  #@NEW_LINE#@#  Note that in deriving equation (3) we must assume that the triplet (A, B, C) is output controllable, which can be determined if the matrix rank(CB|CAB||CAn1B)=p.  #@NEW_LINE#@#  If the triplet is output controllable, it implies that the matrix CWCT is invertible39,40.  #@NEW_LINE#@#  This suggests the possibility that while the entire network may not be controllable (that is, C=In and W is singular), for a given B (of the form described above) there may be a controllable subspace (subset of nodes) within the network.  #@NEW_LINE#@#  On the other hand, every subspace of the controllable subspace is also controllable.  #@NEW_LINE#@#  In the following discussions we proceed under the assumption that the pair (A, B) is controllable by following the methodology in ref.  #@NEW_LINE#@#  38, and focus on the effect that the choice of the matrix C has on the control energy.  #@NEW_LINE#@#  ', 'We also consider a more general linear-quadratic optimal control problem, that is, we attempt to minimize a quadratic cost function that applies a weight to the states, x(t), and the control inputs, u(t).  #@NEW_LINE#@#  This type of cost function is applied in a variety of science and engineering applications such as medical treatments or biological systems41,42, consensus or synchronization of distributed agents43,44,45, networked systems46, social interactions47 and many more', '', 'The n × n matrix Q applies a weight to the states and the m × m matrix R applies a weight to the control inputs.  #@NEW_LINE#@#  The n × m matrix M allows for mixed-term weights, which may arise for specially designed trajectories, optimization of human motion or other physical constraints48,49,50,51.  #@NEW_LINE#@#  We restrict the cost function matrix Q to be symmetric semi-positive definite and the matrix R to be symmetric positive definite.  #@NEW_LINE#@#  We derive a closed-form expression for the optimal control input associated with equation (4) using the property that the Hamiltonian system, which arises during the solution (derived in Supplementary Note 4) can be decoupled', '', 'The symmetric matrix S is the solution to , the continuous time algebraic Riccati equation and the other matrices are defined as', '', 'The derivation of equations (5) and (6) is detailed in Supplementary Note 4.  #@NEW_LINE#@#  ', 'Optimal energy and worst case direction', 'The energy associated with an arbitrary control input, such as equation (3) or (5), , while only targeting the nodes in , is defined as .  #@NEW_LINE#@#  Note that E(p) also depends on which p nodes are in the target set, , that is, there is a distribution of values of E(p) for all target node sets of size p. The energy E(p) is a measure of the effort, which must be provided to achieve the control goal.  #@NEW_LINE#@#  In the subsequent definitions and relations, when a variable is a function of p, we more specifically mean it is a function of a specific target set of size p of which there are  possible sets.  #@NEW_LINE#@#  We can define the energy when the control input is of the form in equation (3) as', '', 'where the vector  is the control manoeuvre and Wp is the p × p symmetric, real, non-negative definite output controllability Gramian.  #@NEW_LINE#@#  Note that when C is defined as above, that is, its rows are linearly independent versors, the reduced Gramian Wp is a p-dimensional principal submatrix of W. A small, three-node example of the benefits of target control is shown in Fig 1bg.  #@NEW_LINE#@#  In the first scenario (Fig 1bd) each node has a prescribed final state (p=n=3) and in the second scenario (Fig 1eg) only a single node is targeted (p=1).  #@NEW_LINE#@#  The energy is calculated for each scenario by integrating the curves in Fig 1d,g from which we find that E(3)=382 and E(1)=66.3.  #@NEW_LINE#@#  Even though the second scenario has one-third of the targets, the energy is reduced by a sixth (compare also the different scales on the y axis of Fig 1d,g).  #@NEW_LINE#@#  We denote the eigenvalues of Wp as , i=1,,p, which are ordered such that  when the triplet (A, B, C) is output controllable.  #@NEW_LINE#@#  By defining the magnitude of the vector, ||=, we can define the worst-case (or maximum) energy according to the MinMax theorem, which provides a bound for equation (7).  #@NEW_LINE#@#  The bounds are functions of the extremal eigenvalues of Wp', '', 'The upper extreme of the control energy for any control action is , which is what we call the worst-case energy.  #@NEW_LINE#@#  For an arbitrary vector , which can be represented as a linear combination of the eigenvectors of Wp, the energy can be defined as a weighted sum of the inverse eigenvalues, , which includes the worst-case energy.  #@NEW_LINE#@#  Moreover, for the large scale-free networks that are of interest in applications, typically , j=2,,p, and  provides the approximate order of the energy required to move the system in any arbitrary direction of state space.  #@NEW_LINE#@#  This is demonstrated with an example in Supplementary Note 5.  #@NEW_LINE#@#  ', 'We investigate how the selection of the target nodes affects , the inverse of the smallest eigenvalue of the output Gramian.  #@NEW_LINE#@#  To better understand the role of the number of target nodes on the worst-case energy, we consider an iterative process by which we start from the case when every node is in the target set, , and progressively remove nodes.  #@NEW_LINE#@#  Say   is an eigenvalue of Wi before (after) removal of a target node.  #@NEW_LINE#@#  By Cauchys interlacing theorem we have that', '', 'In particular, from (9) we note that , indicating that the smallest eigenvalue cannot decrease after removal of a target node.  #@NEW_LINE#@#  This implies that the maximum energy  for all i such that 1in1.  #@NEW_LINE#@#  ', 'Energy scaling with reduction of target space', 'We would like to determine the rate of increase of  as p decreases, which is not obvious from equation (9).  #@NEW_LINE#@#  At each step p,  contains p nodes in the target set (such that  and p decreases from n1 to 1) and the output controllability Gramian is partitioned such that Wp is a principal minor of Wp+1.  #@NEW_LINE#@#  ', '', 'We let the matrix  be the matrix Wp+1 except that the first row of Wp+1 in equation (10) has been replaced with zeros, and we define the vectors  to be the left (right) eigenvector associated with the smallest eigenvalue of Wp ().  #@NEW_LINE#@#  The relation between two consecutive values,  and , can be expressed linearly as , where .  #@NEW_LINE#@#  The notation a1 denotes the first value of a vector a.  #@NEW_LINE#@#  Each value of p exactly quantifies the rate of increase at each step of the specific process and also relates the maximum energies .  #@NEW_LINE#@#  We can also relate any two target sets of size k and j such that 1k less_than jn and ', '', 'where  is the geometric mean of i, i=k,, (j1), which is independent of the order of the nodes chosen to be removed between  and .  #@NEW_LINE#@#  To define a network characteristic parameter , we average equation (11) over many possible choices of the target sets  and , where we have selected k=n/10 and j=n', '', 'where the symbol · indicates an average over many possible choices of n/10 nodes for the target set.  #@NEW_LINE#@#  By applying equation (12) to equation (11) and by setting k=n/10 and j=p greater than k (for an extended discussion see Supplementary Note 3), we achieve the scaling equation used throughout the simulations', '', 'The linear relationship is shown in Figs 2, 3, 4, where p/n is decreased from 1 (the target set ) to 0.1 (the target set consists of 10% of the nodes drawn randomly from the set of all nodes).  #@NEW_LINE#@#  Further details of the scaling law and its relation to the spectral characteristics of the output controllability Gramian can be found in Supplementary Note 3, and the practical calculation can be found in the Methods section.  #@NEW_LINE#@#  For the simulations in Figs 2, 3, 4, 5, 6, 7, around 50% of the nodes are chosen to be input nodes (which we have verified yields a controllable pair (A, B)).  #@NEW_LINE#@#  ', 'Figure 2: The variation of  with respect to model network parameters.  #@NEW_LINE#@#  (a) The maximum control energy is computed for model networks constructed with the static model and the ErdosRenyi (ER) model while varying the target node fraction.  #@NEW_LINE#@#  For the static model, four different power-law exponents are used.  #@NEW_LINE#@#  The average degree of each model network is kav=2.5 and its size is n=500.  #@NEW_LINE#@#  The input node fraction nd=0.5, chosen such that the pair (A, B) is controllable.  #@NEW_LINE#@#  Further aspects like edge weights and values along the diagonal of the adjacency matrix are discussed in the Methods section.  #@NEW_LINE#@#  Each set of target nodes is chosen randomly from the nodes in the network.  #@NEW_LINE#@#  Each point represents the mean value of the control energy taken over 50 realizations.  #@NEW_LINE#@#  The error bars represent one s.d.  #@NEW_LINE#@#  Note the linear growth of the logarithm of the control energy.  #@NEW_LINE#@#  The slopes of these curves are the values of  corresponding to each set of parameters.  #@NEW_LINE#@#  A linear fit curve is provided in grey.  #@NEW_LINE#@#  Also, as  grows, that is, the scale-free models become more homogeneous, the slope approaches that of the ErdosRenyi model.  #@NEW_LINE#@#  (b) The same study as in a except that kav=8.0.  #@NEW_LINE#@#  The same behaviour is seen but note the difference in scales of the vertical axis.  #@NEW_LINE#@#  Each point is the mean over 50 realizations, and error bars represent one s.d.  #@NEW_LINE#@#  (c) The study in a and b is performed for more values of kav, and the value of  is computed for each curve.Full size image', 'Figure 3: Energy scaling as time horizon and input node fraction are varied.Besides the average degree and power-law exponent that describe the underlying graph of the network (Fig 2), there are other parameters that can affect the control energy such as the time horizon and the number of designated input nodes.  #@NEW_LINE#@#  (a) The time horizon, defined as tft0, is varied for networks constructed using the static model with the following properties: n=500; in=out=3.0; kav=5.0; and nd=0.5.  #@NEW_LINE#@#  As we choose t0=0, the time horizon is equivalent to just tf.  #@NEW_LINE#@#  The main plot shows how the log of the maximum control energy changes with target node fraction, p/n.  #@NEW_LINE#@#  Each point represents the mean over 50 realizations, and error bars represent one s.d.  #@NEW_LINE#@#  The inset shows how  changes with the time horizon.  #@NEW_LINE#@#  We see a sharp increase as the time horizon decreases.  #@NEW_LINE#@#  (b) We also investigate how  varies with the number of input nodes.  #@NEW_LINE#@#  The same class of network is examined as in a: n=500; in=out=3.0; and kav=5.0.  #@NEW_LINE#@#  For both simulations, nodes are randomly and independently chosen to be in each target set.  #@NEW_LINE#@#  We see that  grows as the number of input nodes decreases as shown in the inset.Full size image', 'Figure 4: Values of  for real data sets.  #@NEW_LINE#@#  (a) We compute the maximum control energy required for the s420st circuit network and the TM metabolic network for increasing target node fraction, p/n.  #@NEW_LINE#@#  Each point represents the mean of 50 realizations where each realization is a specific choice of the nodes in the target node set.  #@NEW_LINE#@#  Error bars represent one s.d.  #@NEW_LINE#@#  (b) The same analysis performed for the Carpinteria food web, the protein structure 1 network and a Facebook forum network.  #@NEW_LINE#@#  Each point represents the mean of 50 realizations where each realization is a specific choice of the nodes in the target node set.  #@NEW_LINE#@#  Error bars represent one s.d.  #@NEW_LINE#@#  For both a and b, the linear behaviour exists only when the target fraction increases beyond p/n=0.1.  #@NEW_LINE#@#  (c) We numerically compute values of  for real data sets (compiled in Supplementary Table 1) for comparison when nd=0.45 or larger.  #@NEW_LINE#@#  The values of  are plotted against each networks average degree as the degree distribution that best describes the degree sequence may or may not be scale-free.  #@NEW_LINE#@#  Nonetheless, we see a similar trend that low average-degree networks have a larger value of , as demonstrated in Fig 2c.  #@NEW_LINE#@#  Also worth noting is that networks from the same class (as defined in the legend) tend to have similar values of .Full size image', 'Figure 5: DPR of real networks.Probability density functions (PDF) of the distribution of  for a selection of real networks that have undergone DPR and nd=0.45.  #@NEW_LINE#@#  (a) RHS59 from social.  #@NEW_LINE#@#  (b) s420st (ref.  #@NEW_LINE#@#  53) from circuit.  #@NEW_LINE#@#  (c) TP-met54 from metabolic.  #@NEW_LINE#@#  (d) North Euro Grid60 from infrastructure.  #@NEW_LINE#@#  (e) Carpinteria55 from Food Web.  #@NEW_LINE#@#  (f) Each of the corresponding P values are listed in the table.  #@NEW_LINE#@#  The vertical lines mark the value of real, which corresponds to the original network.Full size image', 'Figure 6: Average energy for increasing state weight matrices.We demonstrate that for both model networks and real data sets, increasing  (where the state weight matrix, Q=In), does not significantly increase the average energy.  #@NEW_LINE#@#  (a) The static model is used to generate model networks with parameters n=300 and kav=5.0, where nd=0.5.  #@NEW_LINE#@#  Note that the order of magnitude, here represented as a linear scale with respect to the logarithm of the energy, is approximately constant.  #@NEW_LINE#@#  Each point is averaged over 50 iterations of model networks and final desired states, which have Euclidean norm equal to one.  #@NEW_LINE#@#  (b) Two real networks are also examined and the average energy is computed.  #@NEW_LINE#@#  Each point is the mean over 50 realizations where each realization represents a choice of final condition such that the final condition has Euclidean norm equal to one.  #@NEW_LINE#@#  For both studies, error bars represent one s.d.Full size image', 'Figure 7: Energy reduction for increasing state weight matrices.We construct a single model network using the static model52 with the parameters n=300, nd=n/4, =2.7 and kav=5.  #@NEW_LINE#@#  The energy scaling is examined for the general quadratic cost function.  #@NEW_LINE#@#  We compute  for different values of  such that the state weight matrix Q=In.  #@NEW_LINE#@#  The values of  for =0, 1 and 10 are =13.46, 13.66 and 13.53, respectively.  #@NEW_LINE#@#  Each point is averaged over 50 iterations of target node sets.  #@NEW_LINE#@#  The simulations are performed with initial condition set to the origin and the final condition chosen randomly such that ||yf||=1.  #@NEW_LINE#@#  Error bars represent one s.d.Full size image', 'The exponential decay of the energy as p/n decreases has immediate practical relevance as it indicates that large networks, which may require a very large amount of energy to fully control27, will require much less even when a significant portion of the network is controlled.  #@NEW_LINE#@#  However, the rate of this exponential decrease, , is network-specific.  #@NEW_LINE#@#  We compute the value of  for 50 scale-free model networks, constructed with the static model in ref.  #@NEW_LINE#@#  52 for specific parameters kav, the average degree, and in=out=, the power law exponents of the in- and out-degrees, and take the mean over the realizations.  #@NEW_LINE#@#  We observe in Fig 2 that  varies with both of the network parameters  and kav.  #@NEW_LINE#@#  A large value of  indicates that target control is highly beneficial for that particular network, that is, the average energy required to control a portion of that network is much lower when the size of the target set is reduced.  #@NEW_LINE#@#  In Fig 2a,b, the exponentially increasing value of the worst-case energy  is shown with respect to the size of the target set normalized by the size of the network, p/n, for various values of in=out= when kav=2.5 and 8.0, respectively.  #@NEW_LINE#@#  The bars in Fig 2a,b are one s.d.  #@NEW_LINE#@#  over the 50 realizations each point represents, or in other words, when p nodes are in the target set , it is most likely that  will lie between those bars.  #@NEW_LINE#@#  The decrease of  as  and kav increase for scale-free networks is displayed in Fig 2c.  #@NEW_LINE#@#  Overall, we see that  is largest for sparse, non-homogeneous networks (that is, low kav and low ), which are also the hardest to control, that is, they have the largest worst-case energy when all of the nodes are targeted.  #@NEW_LINE#@#  This indicates that target control will be particularly beneficial when applied to metabolic interaction networks and protein structures, some of which are symmetric and which are known to have low values of  (ref.  #@NEW_LINE#@#  36), as seen in Fig 2b, where both classes of networks are shown to have large values of .  #@NEW_LINE#@#  ', 'The effects other network parameters have on  are examined in Fig 3.  #@NEW_LINE#@#  Figure 3a displays some sample curves for  for shorter or longer values of (tft0), the time horizon.  #@NEW_LINE#@#  The inset shows how  increases as the time horizon (tft0) decreases.  #@NEW_LINE#@#  We see that when (tft0) approaches zero from the right,  increases sharply, which shows the increased benefit of target control as the time horizon is reduced.  #@NEW_LINE#@#  Figure 3b examines how  changes for various numbers of input nodes (represented as a fraction of the total number of nodes in the network).  #@NEW_LINE#@#  The inset collects values of  for different values of nd, which increases as the number of input nodes is decreased.  #@NEW_LINE#@#  The role of the time horizon28 and the number of input nodes27 on the control energy have been discussed in the literature for the case in which all the nodes were targeted.  #@NEW_LINE#@#  ', 'Comparing the results between both panels in Fig 3 and the results in Fig 2, we see that each parameter has more or less of an effect on the control energy.  #@NEW_LINE#@#  Shortening the time horizon from the nominal value tf=1 (which was used in Fig 2) by four orders of magnitude doubled the value of .  #@NEW_LINE#@#  Decreasing the number of input nodes from n/2 (the number used in Fig 2) to only n/5 also roughly doubled the value of .  #@NEW_LINE#@#  In comparison, increasing the heterogeneity of the network, by decreasing the power-law exponent , from 3 to slightly larger than 2 increased  10- to 20-fold.  #@NEW_LINE#@#  Clearly the underlying topology, as described by the power-law exponent, plays the largest role in determining (and thus affecting) the control energy.  #@NEW_LINE#@#  ', 'We also analyse data sets collected from various fields in science and engineering to study how the worst-case energy changes with the size of the target set for networks with more realistic structures.  #@NEW_LINE#@#  We are particularly interested in the possibility that these networks display different properties in terms of their target controllability, when compared to the model networks analysed.  #@NEW_LINE#@#  To this end, we consider different classes of networks, for example, food webs, infrastructure, metabolic networks, social interactions and so on.  #@NEW_LINE#@#  The name, source and some important properties of each of the data sets are collected in Supplementary Note 8.  #@NEW_LINE#@#  For each network we choose edge weights and diagonal values from the uniform distribution as discussed in the Methods section below.  #@NEW_LINE#@#  Overall, we see a similar relationship in terms of the average degree kav and  in Fig 4c as for the model networks in Fig 2c.  #@NEW_LINE#@#  The real data sets that have a large worst-case energy when all of the nodes are targeted, , tend to also have the largest value of , which acts as a measure of the rate of improvement with target control.  #@NEW_LINE#@#  It should be noted that the value of  varies little within each class of networks (for example, food webs, infrastructure, metabolic networks, social interactions and so on as seen in Fig 4c), which suggests that the structure of each class is similar.  #@NEW_LINE#@#  Fields of study where networks tend to have a large  would benefit the most from examining situations when a control law could be implemented that only targets some of the elements in the network.  #@NEW_LINE#@#  ', 'For an arbitrary network,  cannot be accurately determined from a single value of .  #@NEW_LINE#@#  Some networks, which have a large worst-case energy when every node is targeted, can have a much smaller worst-case energy when only a small portion of the network is controlled as compared to other networks.  #@NEW_LINE#@#  It is interesting to note from Fig 4a,b that at some target fraction p/n the energy trends of two different real networks may cross.  #@NEW_LINE#@#  Specifically, in Fig 4a, when every node is targeted, p/n=1, the s420st (ref.  #@NEW_LINE#@#  53) circuit has a larger maximum energy, , than the TM-met54 metabolic network.  #@NEW_LINE#@#  However, when p/n is smaller than 0.6, it requires, on average, more energy to control a portion of the TM-met network than an equivalent portion in the s420st network.  #@NEW_LINE#@#  The same type of behaviour is seen in Fig 4b between three networks: Food web Carpinteria55, a protein interaction network prot_struct_1 (ref.  #@NEW_LINE#@#  53) and social network Facebook forum56.  #@NEW_LINE#@#  In summary, we can see that one can estimate the value of  from the average degree of the network but to determine the worst-case energy, at least one point along the energy curve for a specific cardinality of the target set is also required (as in Fig 4a,b).  #@NEW_LINE#@#  ', 'Figure 5 shows a comparison for several real networks between the value of  of each original network and the values of  for an ensemble of networks that have been generated by randomly rewiring each real networks connectivity while preserving the degrees of its nodes (see Methods).  #@NEW_LINE#@#  We see that for all the real networks examined, their value of  is larger than the values of  obtained for the randomized versions to a statistically significant level.  #@NEW_LINE#@#  We conclude that the potential advantage of applying target control to real networks is higher than for networks derived from random connections such as the static model52, which we have used to construct our model networks.  #@NEW_LINE#@#  ', 'We compute the energy for the control input .  #@NEW_LINE#@#  The control consists of two parts,  that is proportional to the states and  that is of a similar form to equation (3).  #@NEW_LINE#@#  ', '', 'Note that the integral in the third line of equation (14), when R=Im, is the quadratic form , which scales exponentially with the cardinality of the target set.  #@NEW_LINE#@#  The other two terms are functions of the state trajectory, which are not appreciably altered by the number of targeted nodes.  #@NEW_LINE#@#  We thus expect to see similar energy scaling behaviour for the cost function equation (4) with QOn × n and MOn × m.', 'In some applications a cost applied to the states may be beneficial as it will substantially alter the state trajectories (see the example in Supplementary Note 4).  #@NEW_LINE#@#  In the following simulations, to restrict the number of variables we consider, the mixed-term weight matrix M=On × m and the state weight matrix Q=I, that is, a diagonal matrix with constant real value, , on the diagonal.  #@NEW_LINE#@#  In Fig 6a model networks are considered of different scale-free exponents .  #@NEW_LINE#@#  In Fig 6b, the real networks IEEE 118 bus test grid (https://www.ee.washington.edu/research/pstca/pf118/pg_tca118bus.htm) and Florida everglades foodweb (http://vlado.fmf.uni-lj.si/pub/networks/data/) are optimally controlled with respect to the cost function in equation (4), and the approximate maximum energy (computed by numerically integrating equation (4)) is determined for increasing values of the scalar .  #@NEW_LINE#@#  As  increases in Fig 6a,b, each point along the curve is of approximately the same order of magnitude.  #@NEW_LINE#@#  As  is varied, the order of magnitude of the maximum energy does not change substantially, and mainly depends on the triplet (A, B, C) without much effect by the matrix Q.  #@NEW_LINE#@#  ', 'Finally, we offer evidence to connect the energy scaling law derived for the minimum energy optimal control problem to the energy scaling apparent for the control signal that arises in the solution of the general quadratic cost function, equation (4).  #@NEW_LINE#@#  Figure 7 shows that not only does the order of magnitude of the maximum energy not change significantly but also the rate of increase, , of the maximum energy does not change significantly with respect to the size of the target set either.  #@NEW_LINE#@#  We compute , the energy scaling, for a single model network while we increase the state weight cost matrix defined as the diagonal matrix Q=In.  #@NEW_LINE#@#  This suggests that if  is computed for a network with respect to the minimum energy formulation, it can be used to approximate  when the cost function is quadratic with respect to the states as well.'  #@NEW_LINE#@#  

Discussion  #@NEW_LINE#@#  
'This paper discusses a framework to optimally control a portion of a complex network for assigned initial conditions and final conditions, and given the sets of input nodes and target nodes.  #@NEW_LINE#@#  We provide an analytic solution to this problem in terms of a reduced Gramian matrix Wp, where the dimensions of this matrix are equal to the number of target nodes one attempts to control.  #@NEW_LINE#@#  We show that for a fixed number of input nodes, the energy required to control a portion of the network decreases exponentially with the cardinality of the target set, so even controlling a significant number of nodes requires much less energy than when every node is targeted.  #@NEW_LINE#@#  The energy reduction, expressed as the rate , is largest for networks that are heterogeneous (small power-law exponent  in a scale-free degree distribution) and sparse (small kav), with a short time horizon and fewer control inputs.  #@NEW_LINE#@#  The control of these networks typically has especially large control energy demands.  #@NEW_LINE#@#  Thus, target control is most beneficial for those networks that are most difficult to control.  #@NEW_LINE#@#  From the simulations that we have performed on model networks, we have seen that the effect each of these parameters has is not equal.  #@NEW_LINE#@#  The control energy required is most dependent on the underlying structure of the network, which we see can increase  by as much as 20 times holding all other parameters constant.  #@NEW_LINE#@#  Adjusting the time horizon over multiple orders of magnitude, or reducing the number of input nodes from 50% to 20% doubled the value of , which is a comparatively small increase.  #@NEW_LINE#@#  ', 'The potential applications for developing target controls are numerous, from local jobs among networked robots to economic policies designed to affect only specific sectors.  #@NEW_LINE#@#  We see that data sets from the literature in many fields also experience the reduced energy benefits from target control.  #@NEW_LINE#@#  The networks that describe metabolic interactions and protein structures have some of the largest values of  suggesting target control would be the most beneficial in those fields.  #@NEW_LINE#@#  ', 'We have also considered a linear-quadratic optimal control problem (in terms of the objective function (4)) applied to dynamical complex networks.  #@NEW_LINE#@#  We show that the scaling factor  for a network with control parameters nd and tf remains nearly the same whether the control is optimal with respect to the minimum energy control input as in equation (3) or is optimal with respect to the quadratic cost function as in equation (5).  #@NEW_LINE#@#  The observed decrease of the control energy over many orders of magnitude indicates a strong potential impact of this research in applications where control over the entire network is not necessarily required.'  #@NEW_LINE#@#  

Methods  #@NEW_LINE#@#  
'Model networks', 'In our analyses, similar to ref.  #@NEW_LINE#@#  27, we assume the networks have stable dynamics.  #@NEW_LINE#@#  The scale-free model networks we consider throughout the paper and the Supplementary Information are constructed with the static model52.  #@NEW_LINE#@#  The ErdosRenyi graphs represent the static model when the nodal weights are all the same, that is, when the power-law exponent approaches infinity.  #@NEW_LINE#@#  Edge weights are chosen from a uniform distribution between 0.5 and 1.5.  #@NEW_LINE#@#  Unique values, i, are included, drawn from a uniform distribution between1 and 1 so that the eigenvalues of the adjacency matrix are all unique.  #@NEW_LINE#@#  The weighted adjacency matrix A is stabilized with a value  such that each diagonal value of A is {aii}=i+, where i=1,, n. The value  is chosen such that the maximum eigenvalue of A is equal to 1.  #@NEW_LINE#@#  The matrix B is constructed by choosing which nodes in the network require an independent control signal.  #@NEW_LINE#@#  The matrices B (C) are composed of m (p) versors as columns (rows).  #@NEW_LINE#@#  The controllability Gramian, Wp, can be calculated as a function of the eigendecomposition of the state matrix A=VV1', '', 'where the notation VT denotes the transpose of the inverse of a matrix V and the  operator denotes the direct product.  #@NEW_LINE#@#  Note that V must be invertible (so that A is diagonalizable), that is, the eigenvectors of A must span .  #@NEW_LINE#@#  The matrix Y has elements', '', 'Note that the uniqueness and negative definiteness of the eigenvalues ensure that Yij is finite for every i, j=1,, n, that is, i+j0, and the set of eigenvectors of A are linearly independent and thus the inverse of V exists.  #@NEW_LINE#@#  ', 'Choosing input nodes', 'When determining the set of input nodes that guarantees network controllability, often the methods presented in ref.  #@NEW_LINE#@#  6, derived from structural controllability, are applied.  #@NEW_LINE#@#  As the networks we are concerned with have unique diagonal elements in the adjacency matrix, structural controllability states that the network can be controlled with a single control input attached to every node in the network (see theorem 1 and proof in ref.  #@NEW_LINE#@#  38).  #@NEW_LINE#@#  Cowan et al.38 consider an adjacency matrix with unique diagonal elements along the main diagonal and state that this type of matrix can be controlled with a single control input attached to the power-dominating set (PDS) of the underlying graph.  #@NEW_LINE#@#  The PDS is the smallest set of nodes from which all other nodes can be reached, that is, there is at least one directed path from the nodes in the PDS to every other node in the network.  #@NEW_LINE#@#  In the work presented here, different from ref.  #@NEW_LINE#@#  38, we compute an overestimate of the PDS (that retains the property that all other nodes in the network are reachable) and attach a unique control input to each node in the set.  #@NEW_LINE#@#  We then add additional nodes, chosen randomly, to the set of input nodes until there are m input nodes where m is a predefined integer less than n. Thus, if there are m input nodes, then there are m control inputs (see the sample network in Fig 1a).  #@NEW_LINE#@#  ', 'Practical computation of ', 'Here we provide additional details on how Figs 2, 3, 4, which show the exponential scaling of the energy with respect to the cardinality of the target set, were generated.  #@NEW_LINE#@#  For large networks, computing the mean over all possible sets of target nodes is computationally expensive.  #@NEW_LINE#@#  Instead, we approximate  by computing the mean value of  for some sample values of p, p=n/10,2n/10,,n by randomly choosing p nodes to be in a target set and computing the inverse of the smallest eigenvalue of Wp.  #@NEW_LINE#@#  In each of the simulations, we compute the mean and s.d.  #@NEW_LINE#@#  of the logarithm of the smallest eigenvalue of Wp for typically 50 iterations.  #@NEW_LINE#@#  By plotting the values of , we see that a linear model is appropriate and we compute a linear least-squares best fit for the data.  #@NEW_LINE#@#  The linear curve fit provides a good approximation of  as shown in Figs 2, 3, 4.  #@NEW_LINE#@#  ', 'Degree-preserving randomization', 'To test whether the value of  measured for the real networks is a function of just the average degree, kav, and the degree distribution (scale-free, exponential and so on) or if there are other factors that play a role, we measure  for randomized versions of the real networks.  #@NEW_LINE#@#  We use degree-preserving randomization (DPR) to ensure that the randomized real network has the same average degree and the same degree sequence.  #@NEW_LINE#@#  The randomization rewires the edges of the network by randomly choosing two edges and swapping the receiving nodes.  #@NEW_LINE#@#  The process is repeated for an allotted amount of iterations until the networks are sufficiently rewired.  #@NEW_LINE#@#  We compare each real network with its rewired counterparts in terms of their measured values of .  #@NEW_LINE#@#  We see in every case that real, the value of  that corresponds to an original network derived from a data set listed in Supplementary Table 1, deviates significantly from the distribution of  for the DPR networks.  #@NEW_LINE#@#  The corresponding P values are listed in Fig 5.  #@NEW_LINE#@#  The disparity indicates that the real networks have special network features unaccounted for in the randomly rewired versions.  #@NEW_LINE#@#  Furthermore, because for all cases real is greater than any  obtained from the DPR networks, our target strategies are more beneficial for the original networks.  #@NEW_LINE#@#  ', 'Numerical controllability', 'Recent literature on the control of complex networks has discussed the importance of recognizing the differences between theoretically controllable networks and numerically controllable networks.  #@NEW_LINE#@#  The issue arises in Gramian-based control schemes as the condition number of the Gramian can be quite large for certain barely controllable systems, that is, ones where the control inputs only just satisfy analytic controllability measures.  #@NEW_LINE#@#  Sun and Motter57 found a second phase transition after a system (A, B) becomes analytically controllable, named the numerical controllability transition.  #@NEW_LINE#@#  While we acknowledge the importance of recognizing the second transition, for this article, we opt to use multi-precision so we can examine trends even when there is a relatively small number of control inputs, which would otherwise make some networks be not numerically controllable using double precision.  #@NEW_LINE#@#  Here, the Matlab toolbox Advanpix58 allows the computation of the eigendecomposition of the Gramian W to be performed in an arbitrarily precise manner.  #@NEW_LINE#@#  Say i and vi are the ith eigenvalue and eigenvector of W, respectively.  #@NEW_LINE#@#  The average residual error, using Advanpix, is', '', 'Typical values of a used throughout this paper are 100200.  #@NEW_LINE#@#  ', 'We also use Advanpix when computing the energy for the general quadratic cost function in equation (14).  #@NEW_LINE#@#  To approximate the integral, we use LegendreGauss (LG) quadrature with appropriate weights and points.  #@NEW_LINE#@#  ', '', 'We choose L=50 and compute the necessary LG weights wi and LG points i, i=1,, 50.  #@NEW_LINE#@#  ', 'Data availability', 'The codes used to obtain the results in this study are available from the authors on reasonable request.'  #@NEW_LINE#@#  


