article id="http://dx.doi.org/10.1038/ncomms10870"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Intensifying the response of distributed optical fibre sensors using 2D and 3D image restoration  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
'Distributed optical fibre sensors possess the unique capability of measuring the spatial and temporal map of environmental quantities that can be of great interest for several field applications.  #@NEW_LINE#@#  Although existing methods for performance enhancement have enabled important progresses in the field, they do not take full advantage of all information present in the measured data, still giving room for substantial improvement over the state-of-the-art.  #@NEW_LINE#@#  Here we propose and experimentally demonstrate an approach for performance enhancement that exploits the high level of similitude and redundancy contained on the multidimensional information measured by distributed fibre sensors.  #@NEW_LINE#@#  Exploiting conventional image and video processing, an unprecedented boost in signal-to-noise ratio and measurement contrast is experimentally demonstrated.  #@NEW_LINE#@#  The method can be applied to any white-noise-limited distributed fibre sensor and can remarkably provide a 100-fold improvement in the sensor performance with no hardware modification.'  #@NEW_LINE#@#  

Introduction  #@NEW_LINE#@#  
'Distributed fibre sensors1,2 exploit specific optical effects activated along optical fibres, to obtain a spatially distributed profile of environmental quantities such as temperature, strain, pressure, electromagnetic fields and so on.  #@NEW_LINE#@#  This feature offers unique attributes and capabilities compared with conventional discrete sensing methods1,2.  #@NEW_LINE#@#  Conventional distributed fibre sensors can be classified in a wide range of types2 based on the nature of the exploited optical effect.  #@NEW_LINE#@#  There exist types based on optical absorption, fluorescence, evanescent field or interferometers, among others1,2; however, most of the distributed sensors use natural scattering processes3,4 present in optical fibres along with interrogating methods based on time-domain5 or frequency-domain6 reflectometry.  #@NEW_LINE#@#  These are sensors essentially based on Rayleigh scattering7,8,9,10,11, spontaneous Raman scattering12,13,14 and spontaneous or stimulated Brillouin scattering15,16,17,18,19,20,21,22,23,24.  #@NEW_LINE#@#  The spatial resolution of distributed sensors is primarily determined by the bandwidth of the interrogating signal, which is typically traded off with the power contrast in the detected signal.  #@NEW_LINE#@#  Under an optimized configuration, the best performance attained by any distributed sensor is ultimately determined by the signal-to-noise ratio (SNR) of the measurements16,24.  #@NEW_LINE#@#  Therefore, to ensure a given measurement quality (defined by the measurand resolution), a minimum SNR has to be secured in the system24,25.  #@NEW_LINE#@#  This imposes an important tradeoff between spatial resolution and sensing range, which affects all kinds of distributed fibre sensors1,2,25,26,27.  #@NEW_LINE#@#  Sensors with high (that is, sharp) spatial resolution are inherently limited by the short interaction time and low energy involved in the scattering process (locally activated at each fibre position), enabling measurements only along short ranges19,20 (typically below 1 km).  #@NEW_LINE#@#  On the other hand, sensors with metric resolution can typically operate over many tens of kilometres of optical fibre.  #@NEW_LINE#@#  In this case, the SNR and quality of the measurements are basically limited by the onset of nonlinear effects28,29,30,31,32, which constraint the maximum optical power launched into the sensing fibre, and by the fibre attenuation, which leads to an exponentially decaying sensor response and poor measurement contrast at the end of long optical fibres24,25.  #@NEW_LINE#@#  ', 'The clear understanding reached in recent years on the factors ultimately limiting the sensor capabilities has motivated researchers to propose and demonstrate specially designed methods for performance enhancement33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54.  #@NEW_LINE#@#  Among several advanced techniques, methods such as distributed Raman amplification34,35,36,37, optical pulse coding38,39,40,41,42,43 or different signal processing methods44,45,46,47,48,49,50,51 have resulted in implementations outperforming classical standard configurations.  #@NEW_LINE#@#  Whereas each of these methods can individually provide up to about 1012 dB SNR enhancement, a higher improvement can only be reached by a proper combination of several of those techniques52,53,54, at the cost of complex and expensive implementations.  #@NEW_LINE#@#  ', 'Among several existing methods, signal processing techniques, such as optical pulse coding38,39,40,41,42,43, wavelet transform44,45,46,47,48 and Fourier transform49 have demonstrated to be very efficient tools to remove noise.  #@NEW_LINE#@#  However, their exploitation for distributed sensing has been restricted so far only to one-dimensional (1D) arrays of data.  #@NEW_LINE#@#  Those techniques can be readily applied, for instance, to Raman-distributed fibre sensors38,44, owing to the 1D nature of the acquired data (corresponding to 1D traces of the anti-Stokes, Rayleigh and Stokes backscattered light12,13,14).  #@NEW_LINE#@#  In the case of Brillouin- and Rayleigh-based distributed sensors, in which time and frequency are scanned, signal processing has been used to denoise individual longitudinal traces (that is, at a fixed scanned frequency) independently from each other39,40,41,45, the measured local spectrum at each fibre location47 or the retrieved measurand profile48.  #@NEW_LINE#@#  Although methods such as timefrequency coding42,43 take advantage of the double scanning (fibre position and pumpprobe frequency detuning) required in Brillouin sensing, the provided SNR enhancement is basically given by the ability of the code to reduce noise in a 1D array of data.  #@NEW_LINE#@#  Indeed, none of the existing methods for performance enhancement exploit the redundancies and correlations contained in the multidimensional domain of the measured information.  #@NEW_LINE#@#  This is so far a feature of distributed fibre sensors that has been completely unexplored in the state-of-the-art; however, as such measurements contain repeated structures of information in a multidimensional domain (time, frequency and position), they can be smartly and efficiently exploited to improve the SNR of the measurements.  #@NEW_LINE#@#  ', 'In the following, we propose and experimentally demonstrate an approach that exploits correlated patterns of information and their high degree of redundancy for enhancing the measurement quality and performance of distributed optical fibre sensors.  #@NEW_LINE#@#  In particular, this approach makes use of image and video enhancement processing for removing noise and increasing the contrast of noisy measurements obtained by any kind of distributed sensor.  #@NEW_LINE#@#  To the best of our knowledge, this is the first time that such a multidimensional approach is used to restore information and enhance the capabilities of distributed fibre sensors.  #@NEW_LINE#@#  Here we demonstrate an unprecedented boost in SNR, which can reach two orders of magnitude (that is, 20 dB SNR enhancement), being equivalent or even superior to the use of extensively complex hardware sophistications but at a minor fraction of the cost.  #@NEW_LINE#@#  Any dB gained in SNR can be used to improve the sensor performance, that is, to extend the range, to sharpen the spatial resolution, to reduce the measurement time (reducing the number of averages), or simply to improve the measurand accuracy24.  #@NEW_LINE#@#  The technique can be applied to any conventional or advanced sensor in which the acquired data can be arranged in a two-dimensional (2D) or three-dimensional (3D) data structure.  #@NEW_LINE#@#  This includes any possible configuration for distributed fibre sensing based on, for example, faint long gratings55, Rayleigh7,8,9,10,11, Raman12,13,14 or Brillouin15,16,17,18,19,20,21,22,23,24 scattering (or any combination of them); however, the use of the method can also be extended to any reflectometry-based technique for fibre characterization5,6 as well as for quasi-distributed or multiplexed sensors, such as arrays of fibre Bragg gratings56, in which the measured information can be arranged in a 2D or 3D data structure.'  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
'2D image processing for sensor data restoration', 'We first tested the proposed method on measurements obtained by a standard Brillouin optical time-domain analyser15,16 (BOTDA), using the proof-of-concept experimental setup shown in Fig 1.  #@NEW_LINE#@#  For a 2-m spatial resolution over a 50-km-long sensing fibre, the SNR of the implemented system turns out to be optimized using a 125-MHz high-transimpedance photodetector57.  #@NEW_LINE#@#  Although this high-transimpendance makes the system thermal-noise dominated, this leads to an optimized electrical SNR57.  #@NEW_LINE#@#  To provide a reliable demonstration of the technique proposed in this study, noisy distributed measurements are intentionally acquired using only four time-averaged traces per scanned frequency (two averaged traces for each orthogonal polarization).  #@NEW_LINE#@#  It is noteworthy that the acquisition procedure in Brillouin sensors makes inherently use of a 2D data structure M(z,f) in the position z and frequency f domains, from which the environmental information is retrieved by detecting spectral shifts of the peak gain frequency.  #@NEW_LINE#@#  Figure 2a shows the noisy 3D map of the Brillouin gain spectrum (BGS) measured along the sensing fibre for different pumpprobe frequency offsets f. In this case we use a sampling rate of 5 ns per digital point in the analogue-to-digital converter, corresponding to a sampling interval of 0.5 m per point (using for convenience the typical time-to-position conversion based on the group velocity of light in the fibre), whereas a spectral range of 200 MHz is scanned with steps of 1 MHz.  #@NEW_LINE#@#  The measurement process therefore results in a 2D matrix M(z,f) of 100,000 × 200 data points containing the local BGS at each sampled fibre location.  #@NEW_LINE#@#  Image processing58,59 here associates each acquired positionfrequency pair (z,f) to a pixel (x,y) of a noisy digital image (illustrated in Fig 2b), where x and y are the spatial coordinates of the image.  #@NEW_LINE#@#  This image can be represented by a two-variable function f(x,y) with values belonging to a 1D space, such as in a greyscale image58,59 and mapping the local Brillouin gain measured at a given position z and frequency offset f. For a better visual perception of the data, a blue scale is chosen in Fig 2, where pixels with darker tones represent positionfrequency pairs having higher Brillouin gain (it is noteworthy that the scale is inverted when compared with the traditional representation of monochrome images58,59).  #@NEW_LINE#@#  A high level of redundancy in the signal amplitude associated to given positionfrequency pairs can be found along the entire 2D data structure M(z,f); this actually becomes evident if we consider that the same BGS (having a known spectral shape) is repeatedly measured along the fibre, being only spectrally shifted at positions where the local environmental conditions change16,17.  #@NEW_LINE#@#  Although the fibre attenuation can alter the BGS peak amplitude with distance, Fig 2 shows that the matrix M(z,f) can still be decomposed into small 2D patches containing several closely located longitudinal points having essentially the same average amplitude.  #@NEW_LINE#@#  ', 'Figure 1: Experimental setup of a basic BOTDA sensor.The light of a conventional distributed-feedback laser operating at 1,550 nm is split into distinct branches to generate the pump and probe signals.  #@NEW_LINE#@#  In the upper branch, a high-extinction ratio ( greater than 40 dB) electro-optic modulator (EOM), driven by a microwave signal and operating in carrier-suppression mode, generates a two-sideband probe signal.  #@NEW_LINE#@#  A polarization switch is used to compensate for the polarization-induced fading affecting the Brillouin gain along the fibre.  #@NEW_LINE#@#  The probe power launched into the fibre is set to 6 dBm to avoid unwanted spectral distortions resulting from non-local effects as reported in ref.  #@NEW_LINE#@#  23.  #@NEW_LINE#@#  In the lower branch, a high onoff ratio ( greater than  50 dB) pump pulse of 20 ns is generated by a semiconductor optical amplifier (SOA) and then boosted by an erbium-doped fibre amplifier (EDFA) up to 100 mW (limit imposed by modulation instability, as indicated in ref.  #@NEW_LINE#@#  31).  #@NEW_LINE#@#  The sensing fibre is a 50-km-long standard single-mode fibre.  #@NEW_LINE#@#  On the receiver side, a narrowband (10 GHz) fibre Bragg grating (FBG) is inserted to select the lower-frequency probe sideband, which is detected by a 125-MHz photoreceiver.  #@NEW_LINE#@#  Time-domain traces are then collected using an acquisition card connected to a computer.Full size image', 'Figure 2: Measured BGS versus distance.  #@NEW_LINE#@#  (a) Three-dimensional map of the measured BGS as a function of distance.  #@NEW_LINE#@#  Measurements are obtained along a 50-km-long sensing fibre using a spatial resolution of 2 m, 4 temporal averages (2 averages per each orthogonal polarization state), a sampling interval of 0.5 m, a spectral scanning range of 200 MHz and a frequency step of 1 MHz.  #@NEW_LINE#@#  (b) Top view of the measured BGS, where pixels with darker blue tones represent position-frequency pairs with higher Brillouin gain.  #@NEW_LINE#@#  This image provides a visual representation of the noisy measured data and depicts the image to be enhanced by image processing.Full size image', 'To exploit the high level of similitude and redundancy present in the 2D domain of the data, we here use two of the best-known image denoising methods as proof-of-concept, to evaluate the effectiveness of the proposed approach: the so-called non-local means (NLM)59,60,61,62,63 and wavelet denoising (WD)64,65,66,67 (see Methods for details).  #@NEW_LINE#@#  Whereas the former method operates in the spatial domain of the image, that is, making direct use of the measured data points (raw data), the later method converts the raw data into the wavelet domain (corresponding to a particular representation of the spectral domain of the image), where the components associated with noise are filtered out by wavelet shrinkage using a hard thresholding function64,65,66.  #@NEW_LINE#@#  Supplementary Fig 1 shows the denoised images resulting after processing the raw measured data points.  #@NEW_LINE#@#  Although a simple visual inspection of these images indicates a clear improvement in the data quality (compared with Fig 2b), we evaluate the effectiveness of the denoising using an objective metric by calculating the SNR of the time-domain trace obtained at the peak Brillouin gain frequency24.  #@NEW_LINE#@#  To allow a fair comparison with existing techniques, it is worth mentioning that we use here the definition of SNR calculated to be proportional to the trace amplitude, which means the ratio between the mean amplitude of the measured local response and its standard deviation24,25,51,52,53, contrarily to some works where the SNR is defined to be proportional to the electrical power16,45,50.  #@NEW_LINE#@#  ', 'Figure 3a,b compare the SNR of the raw noisy traces (blue lines) and the ones obtained after denoising (red lines) with the NLM and WD methods, respectively.  #@NEW_LINE#@#  Black dashed lines correspond to the respective linear fitting (in dB scale) of the SNR versus distance.  #@NEW_LINE#@#  Experimental results point out that the SNR of 1.4 dB obtained at 50 km distance on the raw data can be substantially boosted up to 15.2 and 15.6 dB by applying the NLM and WD methods, respectively.  #@NEW_LINE#@#  It is noteworthy that those values represent a remarkable SNR enhancement of 13.8 and 14.2 dB using each of the respective methods.  #@NEW_LINE#@#  Although the SNR improvement provided by these two denoising methods is fairly equivalent, we should mention that the computational complexity of the NLM is normally much larger, especially in our implementation (see Discussion section), giving a crucial advantage to the WD, unless dedicated programming and implementation are used for the NLM processing63.  #@NEW_LINE#@#  It is also important to mention that although the Brillouin frequency shift (BFS) of the sensing fibre is in this case longitudinally quite uniform, the reported SNR improvement is obtained by the NLM and WD methods using parameters that secure a spatial resolution of 2 m, as described in the Methods and demonstrated hereafter in Fig 4.  #@NEW_LINE#@#  ', 'Figure 3: Impact of 2D image processing on BOTDA measurements.The sensing performance enhancement provided by the 2D NLM (left) and 2D WD (right) methods is evaluated by comparing the raw (blue curves) and processed (red curves) data.  #@NEW_LINE#@#  (a,b) SNR versus distance, showing that the raw SNR of 1.4 dB (obtained at 50 km distance with 2 m spatial resolution and 4 averaged traces) can be improved up to 15.2 and 15.6 dB with the NLM and 2D WD methods, respectively.  #@NEW_LINE#@#  The black dashed lines show a linear fitting (in dB scale) of the SNR curves versus distance.  #@NEW_LINE#@#  (c,d) BGS measured near the far fibre end, pointing out that a significant increase in the measurement contrast can be obtained by image processing.  #@NEW_LINE#@#  (e,f) Uncertainty on the determination of the peak gain frequency versus distance, showing that the uncertainty of 4.8 MHz obtained in the raw data at 50 km can be significantly reduced down to 0.20 and 0.19 MHz with the NLM and 2D WD methods, respectively.Full size image', 'Figure 4: Validation of the maintained spatial resolution.Impact of the 2D image processing technique on the spatial resolution of the implemented BOTDA sensor, for the 2D NLM (left) and 2D WD (right) methods.  #@NEW_LINE#@#  (a,b) BFS profiles around a 2-m-long hotspot located near the far end of the sensing fibre, for the NLM and WD methods, respectively.  #@NEW_LINE#@#  The black dashed lines show a reference BFS profile retrieved directly from measurements (that is, with no image processing) acquired with a much larger number (4,000) of averaged traces.  #@NEW_LINE#@#  Results demonstrate that the applied image processing methods have only an imperceptible impact on the spatial resolution of the sensor.  #@NEW_LINE#@#  (c,d) Two-dimensional representation of the noise component eliminated by 2D NLM and 2D WD methods.  #@NEW_LINE#@#  These figures are obtained subtracting the denoised images from the original image (2D data matrix with the raw BOTDA traces), in the case of a hotspot measurement.  #@NEW_LINE#@#  Results show only the fibre section where the hotspot is located, indicating that the eliminated noise components do not contain any evidence of visual patterns or relevant information that could affect the proper hotspot detection.Full size image', 'The SNR enhancement demonstrated above has actually a massive impact on the quality of the obtained BGS.  #@NEW_LINE#@#  Figure 3c,d highlight the huge contrast enhancement in the BGS measurements and the considerable noise reduction provided by image processing.  #@NEW_LINE#@#  No relevant distortion can be observed in the BGS obtained after processing.  #@NEW_LINE#@#  An accurate distributed BFS profile is then obtained by fitting a quadratic curve to the BGS obtained at each fibre location24.  #@NEW_LINE#@#  The ultimate impact of image processing on the measurement quality turns evident when calculating the standard deviation of the retrieved BFS.  #@NEW_LINE#@#  Figure 3e,f show that the frequency uncertainty of 4.8 MHz obtained with the raw data at 50 km distance can be remarkably improved down to 0.20 and 0.19 MHz using the NLM and WD methods, respectively.  #@NEW_LINE#@#  These values are actually in perfect agreement with the uncertainty expected from the experimental SNR24 obtained after denoising.  #@NEW_LINE#@#  ', 'To corroborate that the proposed technique does not actually lead to a penalizing loss of information (for example, loss of spatial resolution capabilities) and eliminates mostly the uncorrelated noise present in the measurements, it is essential to demonstrate that the applied 2D processing does not excessively blur the denoised images.  #@NEW_LINE#@#  For this purpose, a 2-m section of fibre at 50 km distance is heated up to 40 °C, while the rest of the fibre is kept at room temperature (27 °C).  #@NEW_LINE#@#  Figure 4a,b show the BFS profiles around the hotspot location obtained from the raw and denoised data for the NLM and WD methods.  #@NEW_LINE#@#  To accurately assess the impact of image processing on the spatial resolution, the sampling interval in this figure is reduced down to 0.2 m, while a reference BFS profile of the hotspot (black dashed line in the figures) is obtained using 4,000 averages and no processing, thus providing a reliable reference profile with comparable SNR.  #@NEW_LINE#@#  Results highlight the correct detection of the 2-m-long hotspot, demonstrating that the applied processing has an imperceptible impact on the spatial resolution even under low SNR conditions.  #@NEW_LINE#@#  We should emphasize that this verification of the spatial resolution is obtained with the same denoising parameters used to process the raw data when estimating the SNR improvement reported in Fig 3a,b, and therefore they fully represent the spatial resolution capabilities reached by the NLM and WD techniques when enhancing the SNR by 14 dB.  #@NEW_LINE#@#  This clearly demonstrates the benefits of the proposed method when, for instance, compared with classical low-pass filtering techniques, which are highly affected by the tradeoff between noise reduction and spatial resolution.  #@NEW_LINE#@#  In contrast to low-pass filtering, the here-proposed technique uses a nonlinear approach, in which no explicit bandwidth notion is relevant; the amount of removed noise depends exclusively on the frequency components of the useful signal and their level of redundancy.  #@NEW_LINE#@#  The redundancy of information increases the amplitude of the frequency components inherent to the useful signal, while low-amplitude components are assumed to be noise and removed by the processing.  #@NEW_LINE#@#  This nonlinear denoising approach enables us to measure events with a sharp spatial resolution (that is, maintaining high-frequency components), while reducing significantly the noise (that is, random and low-amplitude components present in the low and/or high frequency range).  #@NEW_LINE#@#  Thus, fundamentally there is no discernible bandwidth change between raw and processed data, as proved by the hotspot measurements in Fig 4a,b.  #@NEW_LINE#@#  More quantitatively, if we consider the spatial resolution of 2 m and the sampling interval of 0.5 m, a digital low-pass filter of maximum four points could be used (equivalent to a four-point moving average window).  #@NEW_LINE#@#  This leads to a 3-dB SNR improvement, which is much lower than the 14-dB improvement here demonstrated.  #@NEW_LINE#@#  Considering that the electrical bandwidth in the system is 125 MHz, an electrical low-pass filter of 50 MHz bandwidth could still be used to secure a spatial resolution of 2 m, but this has also minor impact on the SNR.  #@NEW_LINE#@#  Figure 4c,d actually confirm that the eliminated 2D component (obtained subtracting the denoised image from the original noisy image) is essentially white noise, showing no specific features or patterns that could indicate the elimination of relevant information.  #@NEW_LINE#@#  ', 'Extending the concept to video processing', 'The principle of distributed fibre sensing assumes that the temporal evolution of the measurand changes slowly compared with the acquisition time.  #@NEW_LINE#@#  In the case of Brillouin and Rayleigh sensors, this leads to consecutive 2D measurements containing highly correlated information.  #@NEW_LINE#@#  Based on this feature, the concept proposed in this study can be extended to the 3D case60,61,62, in which each measurement (in the positionfrequency domain) is assimilated to a frame of a video sequence.  #@NEW_LINE#@#  This approach exploits not only the redundancy found in the 2D domain of the measurements but also in the temporal dimension, thus leading to a very powerful tool for a better data restoration and noise removal in distributed fibre sensing.  #@NEW_LINE#@#  Using the same setup reported in Fig 1, we acquire consecutive 2D data matrices M(z,f) every 42 s. Although this measurement time can be still reduced due to the small averaging number (four averaged traces per scanned frequency), the response time of the equipment used in this lab demonstration eventually limited our minimum acquisition time.  #@NEW_LINE#@#  ', 'Considering that the temporal evolution of the measurand might reduce the correlation existing between consecutive measurements, the effectiveness of video processing60,61,62 is experimentally verified under conditions in which the fibre temperature changes during the measurement process.  #@NEW_LINE#@#  It is important to bear in mind that if the measurands were completely static (that is, showing no temporal variations), an excellent and trivial solution to increase the SNR would be the use of a simple (linear) temporal averaging of consecutive measurements.  #@NEW_LINE#@#  However, owing to the dynamical nature of the environment, such a kind of averaging leads to blurred images, resulting in loss of information and details, as depicted in Supplementary Fig 2 (see description in next paragraphs).  #@NEW_LINE#@#  Video processing here takes into account the non-stationary characteristics of the data in the temporal domain60,61,62.  #@NEW_LINE#@#  ', 'Measurements are processed using a 3D NLM algorithm60,61,62 (see Methods).  #@NEW_LINE#@#  As in the 2D case, the 3D spatio-temporal NLM method uses the self-similarity of an image, but the search for repeated patterns is extended to several consecutive frames60,61,62.  #@NEW_LINE#@#  Figure 5a shows the SNR of the trace measured at the peak gain frequency for the raw (blue curve) and denoised (red curve) data using the 3D NLM method60,61,62 based on ten consecutive measurements (frames).  #@NEW_LINE#@#  The figure indicates that the raw SNR of 1.4 dB obtained at 50 km distance can be increased up to 22.1 dB using 3D NLM processing.  #@NEW_LINE#@#  This is  greater than 6.5 dB improvement with respect to the 2D image processing reported above and corresponds to a remarkable absolute SNR enhancement of 20.7 dB.  #@NEW_LINE#@#  The benefits provided by this SNR enhancement can be clearly observed in Fig 5b, which shows the BGS measured at 50 km distance obtained from the raw and denoised data.  #@NEW_LINE#@#  Figure 5c highlights that the BFS uncertainty of 4.85 MHz, obtained from the raw data, can be significantly reduced down to 0.055 MHz with this 3D NLM processing, being in good agreement with the attained SNR enhancement24.  #@NEW_LINE#@#  ', 'Figure 5: Impact of video processing on BOTDA measurements.The sensing performance enhancement provided by the 3D NLM methods is evaluated by comparing the raw (blue curves) and processed (red curves) data for different parameters.  #@NEW_LINE#@#  (a) SNR versus distance, showing that the raw SNR of 1.4 dB can be improved up to 22.1 dB when 10 consecutive measurements are used for denoising.  #@NEW_LINE#@#  (b) BGS measured near 50 km distance.  #@NEW_LINE#@#  (c) Uncertainty on the BGS peak frequency versus distance, showing that the uncertainty of 4.85 MHz obtained in the raw data at 50 km distance can be significantly reduced down to 0.055 MHz.  #@NEW_LINE#@#  (d) BFS profile around a 2-m-long hotspot located near the far end of the sensing fibre.  #@NEW_LINE#@#  Negligible impact on the spatial resolution of the sensor can be observed.  #@NEW_LINE#@#  The black dashed line in d shows a reference BFS profile retrieved directly from a measurement obtained with 4,000 averaged traces.Full size image', 'Supplementary Movie 1 shows the BFS profile along the last metres of fibre measured when the temperature of a 2-m section changes from 10 °C up to 40 °C (the rest of the fibre is at 27 °C).  #@NEW_LINE#@#  As also shown in Fig 5d and Supplementary Fig 2, results demonstrate that the retrieved BFS profiles present no observable distortion of the hotspot, while negligible delay is observed when compared with the temperature evolution retrieved from the raw measurements.  #@NEW_LINE#@#  This represents a key advantage of video processing when compared, for example, with linear temporal averaging, which generally leads to delays in the temporal evolution of the measurand, as demonstrated in Supplementary Fig 2.  #@NEW_LINE#@#  ', 'Denoising 1D data using 2D image processing', 'In sensors measuring only 1D data, such as Raman-distributed temperature sensors, a 2D image can be formed considering time as a second dimension when stacking successive sequential measurements.  #@NEW_LINE#@#  To validate the proposed method in this case, we use a generic Raman-distributed sensor scheme12,13,14, as depicted in Fig 6.  #@NEW_LINE#@#  Using a 9-km-long sensing fibre, a spatial resolution of 2 m and a sampling interval of 0.5 m, we measure 1D time-domain traces of the spontaneous Raman anti-Stokes and Stokes backscattered components using 4,096 averages, within a measurement time of 25 s. Traces are consecutively measured, while the temperature of 10 m of fibre (at the end of the sensing range) is changed from room temperature (25 °C) up to 40 °C.  #@NEW_LINE#@#  ', 'Figure 6: Experimental setup of a basic Raman-distributed sensor.The system operates using a conventional distributed-feedback laser operating at 1,552 nm, followed by an electro-optic modulator (EOM) to generate pulses of 10 ns and an erbium-doped fibre amplifier (EDFA) to boost the pulse power.  #@NEW_LINE#@#  Optical pulses of about 4W peak power are launched into the sensing fibre through a wavelength-selective filter (WSF), which also separates the spontaneous Stokes and anti-Stokes Raman components backscattered from the sensing fibre into two branches.  #@NEW_LINE#@#  These two spectral components are sent into two parallel 50 MHz avalanche photodetectors (APD), followed by an acquisition system connected to a computer.  #@NEW_LINE#@#  The sensing fibre corresponds to a 50/125-m graded-index multimode fibre 9 km long.  #@NEW_LINE#@#  As a result of intermodal dispersion, the spatial resolution at the end of the sensing fibre is 2 m.Full size image', 'As suggested, we form two 2D images (one for the Stokes and another for the anti-Stokes signal) stacking together consecutive time-domain traces.  #@NEW_LINE#@#  Figure 7a,b provide 2D image representations of the evolution of consecutive Raman anti-Stokes and Stokes traces within the last 200 m of fibre.  #@NEW_LINE#@#  The temperature evolution affecting the anti-Stokes trace amplitude around 8.86 km is evident in Fig 7a.  #@NEW_LINE#@#  Although the entire set of data contained in those images could be used for denoising, a sliding temporal window of 21 consecutive measurements is chosen here.  #@NEW_LINE#@#  Thanks to this restricted temporal window, the processing time is highly reduced without significantly compromising the denoising capabilities of the method63.  #@NEW_LINE#@#  Thus, to remove noise from a current measurement, matrices MaS(z,t) and MS(z,t) of 18,000 × 21 points (including the raw measurements of the current and previous 20 anti-Stokes and Stokes traces) are processed by the 2D NLM method.  #@NEW_LINE#@#  This procedure is continuously repeated for each new measured trace and independently for the Stokes and anti-Stokes signals.  #@NEW_LINE#@#  After applying image denoising to the raw measurements, the ratio anti-Stokes to Stokes is calculated at each fibre location, and by following a standard calibration procedure the actual distributed temperature profile is finally obtained12,13.  #@NEW_LINE#@#  ', 'Figure 7: Two-dimensional images formed from stacked 1D Raman time-domain traces.The images show excerpts from the time-domain traces of the spontaneous Raman (a) anti-Stokes and (b) Stokes components, measured using a 9-km-long sensing fibre.  #@NEW_LINE#@#  During the measurement process, the temperature of 10 m of fibre has been increased from room temperature (25 °C) up to 40 °C.  #@NEW_LINE#@#  For the sake of clarity, only the last 200 m are shown in the figure.Full size image', 'Figure 8a shows the temporal evolution of the measured temperature within the hotspot section, whereas Fig 8b shows the measured temperature profile around the hotspot after the fibre temperature reaches a stable temperature of 40 °C.  #@NEW_LINE#@#  Results demonstrate that no loss of spatial resolution and no distortion or delay in the temperature evolution are induced by the processing.  #@NEW_LINE#@#  Figure 8c shows that the SNR of 26.2 dB obtained at 8.86 km distance with the raw data can be significantly improved up to 39.8 dB after 2D NLM denoising.  #@NEW_LINE#@#  This corresponds to an SNR enhancement of 13.6 dB, which leads to a temperature resolution improvement from 0.5 °C (obtained from raw data at the fibre end) down to 0.022 °C after NLM processing, as shown in Fig 8d.  #@NEW_LINE#@#  ', 'Figure 8: Impact of 2D image processing on 1D Raman traces.The performance of the sensor and the impact of 2D image denoising is evaluated while the temperature of 10 m at the end of the sensing fibre is slowly increased in time.  #@NEW_LINE#@#  Results obtained from the raw data (blue) are compared with the ones obtained from the denoised data using the 2D NLM method (red curve), in which a moving window of 21 consecutive traces is considered.  #@NEW_LINE#@#  (a) Temporal evolution of the measured temperature at the hotspot location; this result shows that image processing induces no delay or distortion in the measured hotspot temperature.  #@NEW_LINE#@#  (b) Distributed temperature profile near the hotspot location, demonstrating that the denoising process produces no perceptible loss of spatial resolution.  #@NEW_LINE#@#  (c) SNR versus distance, validating an SNR enhancement of 13.6 dB at the end of the sensing range.  #@NEW_LINE#@#  (d) Temperature resolution versus distance, showing that the use of 2D NLM method can improve the temperature uncertainty from 0.5 °C down to 0.022 °C.Full size image'  #@NEW_LINE#@#  

Discussion  #@NEW_LINE#@#  
'In this study, we have proposed and demonstrated the use of image/video denoising techniques58,59,60,61,62,63,64,65,66,67 as an efficient approach to enhance the SNR of distributed fibre sensors.  #@NEW_LINE#@#  To the best of our knowledge, this is the first time that the high levels of correlation and redundancy contained in the multidimensional domain of the measurements obtained by distributed fibre sensors are exploited for performance improvement.  #@NEW_LINE#@#  Compared with state-of-the-art methods, the multidimensional processing approach here proposed turns much more efficient than applying known (1D) denoising algorithms44,45,46,47,48,49,50,51 simply replicated in the different dimensions of interest.  #@NEW_LINE#@#  For instance, the independent use of 1D processing to denoise time-domain traces and then applied to the processed data in frequency domain leads to denoised data points that do not benefit from the similitude and redundancy that can only be found in a 2D or 3D data structure containing the entire measured information.  #@NEW_LINE#@#  For this reason, the method here proposed offers exceptional denoising capabilities when compared with state-of-the-art techniques33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54, enabling a remarkable and unprecedented SNR enhancement, boosting the sensor performance24 up to about two orders of magnitude with no loss of relevant information at minor added cost.  #@NEW_LINE#@#  This translates, for instance, into an unmatched 100-fold improvement in the measurand accuracy of conventional distributed sensors.  #@NEW_LINE#@#  Furthermore, this multidimensional processing can be freely implemented on top of existing sophisticated methods for performance improvement33,34,35,36,37,38,39,40,41,42,43 such as optical pulse coding and/or distributed Raman amplification, thus resulting in a fully additional SNR enhancement.  #@NEW_LINE#@#  ', 'Although the Brillouin system used in this study as a proof-of-concept is thermal-noise dominated, it is worth mentioning that the efficiency of the proposed technique would be similar if shot noise, spontaneous-signal beat noise (when using an erbium-doped fibre amplifier in the receiver) or relative intensity noise (RIN) had an impact on the measurements57.  #@NEW_LINE#@#  In fact, the largest contribution to noise in those cases is given basically by the continuous-wave probe power reaching the receiver25,57, whereas the response of the BOTDA trace only corresponds to a very small fraction of this continuous-wave level (typically 1% for 1 m spatial resolution), having a negligible impact on the signal noise.  #@NEW_LINE#@#  Such sources of noise can therefore as well be considered additive and uniform along the fibre57.  #@NEW_LINE#@#  When RIN dominates, traces can be affected by noisy patterns that could partially impact on the gained SNR of the non-local means and WD methods used in this study; however, we should mention that there exists a vast variety of image processing algorithms and some of them could be more efficient for removing RIN.  #@NEW_LINE#@#  Further research on this subject is still necessary and goes beyond the scope of this study.  #@NEW_LINE#@#  If Brillouin time-domain traces are affected by stationary patterns, for instance, when polarization fading are imperfectly compensated, then image processing will consider those patterns as real signal, leading to a non-uniform noise removal along the fibre.  #@NEW_LINE#@#  However, as fading are proportional to the Brillouin gain, they would eventually affect the noise removal along the first kilometres of fibre, where the SNR is still high, and therefore under normal operation conditions there should be no real detrimental effects at long distances (low SNR region dominated by white noise) where the benefit from image denoising is more crucial.  #@NEW_LINE#@#  Furthermore, if slow-varying temporal instabilities affect the sensor operation, for instance, due to thermal fluctuations, the effectiveness of the denoising might also be reduced when the temporal dimension is considered in the processing.  #@NEW_LINE#@#  This is because slow-varying fluctuations and instabilities could be interpreted by image/video processing as a correlated signal containing relevant (that is, non-random) information, thus imposing an ultimate limit to the estimated SNR improvement.  #@NEW_LINE#@#  ', 'Although the concept proposed in this study has only been demonstrated for BOTDA and Raman sensors, it is envisaged that image/video processing can also be applied to improve SNR of other sensors, such as Brillouin optical-time domain reflectometers21, as well as schemes based on frequency domain18 and correlation domain19,20.  #@NEW_LINE#@#  Furthermore, the concept can also be extended to Rayleigh-based sensors7,8,9,10,11, such as phase-sensitive optical time-domain or frequency-domain reflectometers for quasi-static strain and temperature sensing, where image/video processing can be applied to the 2D data matrix containing the calculated correlation spectrum versus distance9,10,11.  #@NEW_LINE#@#  Although correlation noise could dominate the correlation spectrum in that case, some dedicated image/video processing algorithm could still provide an important enhancement in the contrast of the main correlation peak.  #@NEW_LINE#@#  This certainly requires a further study and goes beyond the main scope of this study.  #@NEW_LINE#@#  In addition, the approach followed for denoising 1D traces can also be applied to standard reflectometry measurements5,6, including even more sophisticated methods for fibre characterization.  #@NEW_LINE#@#  ', 'An interesting aspect that should be highlighted is that the 3D approach here proposed has proved to be very efficient when dealing with the dynamical character of the measurements.  #@NEW_LINE#@#  This is because video sequences are also inherently non-stationary60,61,62 and therefore conventional video processing can easily deal with the motion of pixels among different frames.  #@NEW_LINE#@#  This, if properly tackled and implemented for instance in a dedicated graphic processing unit, could have interesting applications in dynamic distributed sensing22.  #@NEW_LINE#@#  Nevertheless, we should clarify that video denoising typically follow two different approaches: (i) the use of methods with no motion compensation60,61,62 and (ii) the use of methods with explicit motion compensation68,69,70.  #@NEW_LINE#@#  Whereas the 3D NLM60,61,62 used here as a proof-of-concept belongs to the first group, there exist also several movie denoising techniques belonging to the second category, such as the 3D WD68,69,70.  #@NEW_LINE#@#  Further investigation can be still carried out to verify the effectiveness of methods based on explicit motion compensation68,69,70.  #@NEW_LINE#@#  However, we should mention that the concept of calculating the motion of pixels, that is, the trajectory of pixels through consecutive frames, is already inherently incorporated in the 3D NLM method60,61 and therefore already demonstrated in this study.  #@NEW_LINE#@#  ', 'It is also worth mentioning that the experimental results shown in this study have been obtained by simple image/video denoising implementations, where parameters have been selected by following standard recommendations and fine empirical adjustments to maximize the noise removal avoiding any loss of relevant information.  #@NEW_LINE#@#  However, more dedicated strategies for adjusting parameters could be still developed and further investigated.  #@NEW_LINE#@#  For instance, the possibility for auto-tuning parameters and adaptive window sizes to avoid oversmoothing fast spatial and temporal changes of the measurand could also be investigated.  #@NEW_LINE#@#  ', 'The processing time of the method could also be further investigated and improved.  #@NEW_LINE#@#  No special hardware has been here used to optimize the processing time.  #@NEW_LINE#@#  Considering the large number of acquired points in the demonstration sensors, the implementation of a standard NLM algorithm turns out to be computationally very demanding.  #@NEW_LINE#@#  Using a conventional computer with a 3.5-GHz processor and 8 GB RAM, the 2D NLM processing time of each matrix of 18,000 × 21 points in the implemented Raman sensor turns out to be about 1 s. On the other hand, denoising the 2D data matrix of 100,000 × 200 points in the BOTDA sensor takes about 30 s: this is about one order of magnitude larger than the time required by the WD, which requires  less_than 1 s for processing the same data.  #@NEW_LINE#@#  Furthermore, the 3D NLM denoising of the same matrix size, but considering ten consecutive frames, is about 4 min.  #@NEW_LINE#@#  This time can however be highly reduced following specific strategies62,63: for example, using parallel computation to distribute the operations on several processors.  #@NEW_LINE#@#  In fact, the NLM method is intrinsically well suited for parallelization and multithreading63, making this kind of approach very efficient and straightforward.  #@NEW_LINE#@#  Much further improvement can also be obtained if dedicated algorithms and programming are used to implement image/video denoising in a dedicated graphic processing unit installed in a sensor system.  #@NEW_LINE#@#  This shows that we are just at the early stages of research, only unveiling a part of the promising potential of these techniques.  #@NEW_LINE#@#  ', 'Although in this study we demonstrate only the effectiveness of image denoising methods, other techniques for image enhancement58 (different from denoising) can also be employed to increase the measurement quality of distributed fibre sensors in some particular conditions or to spot particular events in a massive data flow.  #@NEW_LINE#@#  This can be obtained using dedicated algorithms58, for instance, to sharpen image details, increase the dynamic range of particular features, restore blurring effects, enhance contrast and edges, and several other approaches.  #@NEW_LINE#@#  Many of those methods actually offer the possibility to recognize objects or patterns, which could be very helpful for the detection of special features that could be present in the measurand.  #@NEW_LINE#@#  Blur-removing strategies could also be investigated to sharpen the detection of small events, comparable to or potentially shorter than the spatial resolution of the sensor.'  #@NEW_LINE#@#  

Methods  #@NEW_LINE#@#  
'Non-local means', 'This technique59,60,61,62,63 proposes an original paradigm in noise reduction by taking advantage of the high degree of redundancy contained in the 2D or 3D data measured by a distributed fibre sensor.  #@NEW_LINE#@#  The method is based on the use of sliding neighbourhoods or 2D patches, which correspond to sets of all pixels j=(x,y) that surround a certain pixel at  within a window of a predefined size.  #@NEW_LINE#@#  The similarity between two pixels i and j is performed by comparing, not only the values  and f(j)=f(x,y) assigned to the pixels but the entire 2D patches or neighbourhoods surrounding the pixels of interest59,60.  #@NEW_LINE#@#  For this, a so-called similarity neighbourhood i surrounding the pixel i is defined and then compared with all other similarity neighbourhoods j of the same size existing in the entire 2D matrix containing the data provided by the sensor.  #@NEW_LINE#@#  ', 'The degree of similitude and redundancy in the data is evaluated in a patch-by-patch basis by calculating the Euclidean distance59,60 ||f(i)-f(j)|| between all values f(i) and f (j) within neighbourhoods i and j.  #@NEW_LINE#@#  It turns out that the Euclidean distance is small when a high level of similitude exist between both compared windows i and j, and therefore the highly similar values f(i) and f(j) associated to both pixels i and j can be averaged to reduce noise59,60.  #@NEW_LINE#@#  More specifically, to eliminate noise from a pixel i in the 2D data matrix, the value f(i) associated to such a pixel is processed by the NLM method calculating the following weighted average59,60:', '', 'where I is the entire domain of the image, f(j) corresponds to the value of the image associated to the pixel j and w(i,j) are the weighting factors calculated as59,60', '', 'where h is a smoothing control parameter and Z(i) is a normalization factor defined so that the sum of all values of w(i,j), for a given pixel i, results to be equal to one.  #@NEW_LINE#@#  It should be noted that the weighting factors w(i,j) are independent of the geometry and only depend on the similarity of the data around pixels i and j.  #@NEW_LINE#@#  This feature characterizes the method as non-local, as pixels j whose surroundings are similar to the pixel i are associated to a higher weight w(i,j), regardless of the relative (spatial) distance between the two pixels.  #@NEW_LINE#@#  ', 'A strict condition for the processing is that the similarity window size must be comparable to the smallest details in the image59,60, which in the context of distributed fibre sensing is associated to the spatial resolution capabilities of the sensor.  #@NEW_LINE#@#  Considering that all implemented and analysed systems in this study (Brillouin and Raman sensors) have a spatial resolution of 2 m and a sampling interval of 0.5 m, the similarity window has been chosen of size 3 × 3.  #@NEW_LINE#@#  This size, corresponding to three longitudinal data points (that is, 1.5 m long), is smaller than the spatial resolution of the system, ensuring that the processing does not have any detrimental impact on the real spatial resolution of the sensor.  #@NEW_LINE#@#  ', 'On the other hand, the parameter h controls the level of blurring of the method and its optimum value depends on the noise level of the data.  #@NEW_LINE#@#  Following the recommendation given in ref.  #@NEW_LINE#@#  59, h has been set to ten times the noise standard deviation .  #@NEW_LINE#@#  In the Brillouin gain data shown in Fig 2, the noise standard deviation is =7.2 × 104; thus h has been set to 7.2 × 103.  #@NEW_LINE#@#  In the case of the Raman sensor implemented in this work, the noise standard deviation of data in Fig 7 is evaluated to be =6.9 × 104 and therefore h has been set to 6.9 × 103.  #@NEW_LINE#@#  ', 'Furthermore, we should consider the large amount of data obtained by the implemented sensors.  #@NEW_LINE#@#  For instance, in the case of the implemented BOTDA sensor 20 M points (that is, 20 Mpix) are acquired to cover 50 km of sensing fibre, sampled every 0.5 m and scanning 200 frequencies, so that the calculation of equations (1) and (2) turns out to be extremely demanding.  #@NEW_LINE#@#  To reduce the processing time, the strategy proposed in ref.  #@NEW_LINE#@#  59 is applied, in which a spatially constrained search window is defined.  #@NEW_LINE#@#  This window is larger than the similarity window, but smaller than the entire 2D matrix (image) so that the search for repeated patterns is only restricted to the area covered by this search window.  #@NEW_LINE#@#  In practice, using a similarity window of 3 × 3 and h=7.2 × 103, it is empirically observed that a satisfactory noise removal is obtained at a reasonable computational cost when defining a search window of 13 × 13.  #@NEW_LINE#@#  Increasing this search area has only led to a marginal SNR improvement, at the cost of a substantial increase in the processing time.  #@NEW_LINE#@#  ', 'As in the 2D case, the 3D spatio-temporal NLM method60,61,62 uses the self-similarity of an image to reduce the noise of a pixel  by averaging weighed image sections at coordinates (x,y) that have high level of similarity; however, in this case the search for repeated patterns is also extended to several consecutive frames60,61,62.  #@NEW_LINE#@#  As the spatial features of the acquired BOTDA data are maintained, the same parameters as in the 2D case are used for video denoising, but with the difference that the search for repeated patterns is extended to ten consecutive measurements.  #@NEW_LINE#@#  ', 'Finally, in the case of processing 1D data provided by the implemented Raman distributed sensor, two 2D images (one for the Stokes and another for the anti-Stokes component) are formed by stacking together consecutive time-domain traces.  #@NEW_LINE#@#  A sliding search window of size 23 × 23 is used for 2D NLM denoising.  #@NEW_LINE#@#  ', 'Wavelet denoising', 'The method is based on the 2D discrete wavelet transform (DWT) and a wavelet shrinkage strategy64,65,66, and has been applied only to BOTDA measurements as a proof-of-concept.  #@NEW_LINE#@#  To eliminate noise using a 2D WD approach, data provided by the BOTDA sensor are decomposed using the Mallat algorithm67 into versions of sub-images containing different levels of details.  #@NEW_LINE#@#  After testing many mother wavelets, the wavelet sym7 has been chosen because of the better denoising capabilities obtained in this case, while the number of levels of decomposition has been set to 5.  #@NEW_LINE#@#  By comparing the wavelet coefficients obtained in the 2D DWT with a predefined threshold, wavelet shrinkage is then applied to the wavelet coefficients using a hard thresholding strategy66.  #@NEW_LINE#@#  This means that all wavelet coefficients having an amplitude below a given threshold are associated to noise and set to zero, whereas high-amplitude coefficients are associated to useful information provided by the sensor.  #@NEW_LINE#@#  Following the recommendation given in ref.  #@NEW_LINE#@#  59, in this case the threshold level has been set to three times the noise standard deviation from which a small adjustment has been performed to optimize the amount of removed noise.  #@NEW_LINE#@#  Thus, considering that the noise standard deviation is =7.2 × 104 for the BOTDA measurements, the threshold value is set to 2.6 × 103 (3.6).  #@NEW_LINE#@#  The output 2D data matrix (considered as the output image) is reconstructed from the result of this thresholding stage, using an inverse 2D DWT procedure, which converts the data back to the spatial domain of the image.'  #@NEW_LINE#@#  


