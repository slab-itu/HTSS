article id="http://dx.doi.org/10.1038/ncomms15037"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Generic decoding of seen and imagined objects using hierarchical visual features  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
'Object recognition is a key function in both human and machine vision.  #@NEW_LINE#@#  While brain decoding of seen and imagined objects has been achieved, the prediction is limited to training examples.  #@NEW_LINE#@#  We present a decoding approach for arbitrary objects using the machine vision principle that an object category is represented by a set of features rendered invariant through hierarchical processing.  #@NEW_LINE#@#  We show that visual features, including those derived from a deep convolutional neural network, can be predicted from fMRI patterns, and that greater accuracy is achieved for low-/high-level features with lower-/higher-level visual areas, respectively.  #@NEW_LINE#@#  Predicted features are used to identify seen/imagined object categories (extending beyond decoder training) from a set of computed features for numerous object images.  #@NEW_LINE#@#  Furthermore, decoding of imagined objects reveals progressive recruitment of higher-to-lower visual representations.  #@NEW_LINE#@#  Our results demonstrate a homology between human and machine vision and its utility for brain-based information retrieval.'  #@NEW_LINE#@#  

Introduction  #@NEW_LINE#@#  
'Brain decoding through machine learning analysis of functional magnetic resonance imaging (fMRI) activity has enabled the interpretation of mental contents, including what people see1,2, remember3,4,5,6,7, imagine8,9,10,11,12 and dream13.  #@NEW_LINE#@#  Most previous studies have relied on a classification-based approach, where a statistical classifier (decoder) is trained to learn a relationship between fMRI patterns and the target contents to be decoded.  #@NEW_LINE#@#  Such approaches entail a fundamental constraint on the number of possible outputs.  #@NEW_LINE#@#  Namely, the outputs are limited to the classes used for decoder training, preventing the decoder from predicting any classes that are not used in training.  #@NEW_LINE#@#  ', 'Recent studies have overcome this limitation by designing decoders for retinotopically organized, image-level features14,15,16.  #@NEW_LINE#@#  This method enables the decoding of novel visual images not presented during training sessions.  #@NEW_LINE#@#  Kay et al.14 built an encoding model consisting of retinotopically organized Gabor wavelet filters.  #@NEW_LINE#@#  They used a visual image database and the predicted brain activities produced by an encoding model.  #@NEW_LINE#@#  The measured brain activity was then decoded by determining the visual image in the database corresponding to the predicted brain activity most similar to the measured brain activity.  #@NEW_LINE#@#  This technique has also been used to identify remembered artworks from the early visual cortical activity17.  #@NEW_LINE#@#  Miyawaki et al.16 constructed a modular decoding model consisting of multi-scale local decoders (modules) that predicted the contrast of local image patches.  #@NEW_LINE#@#  The model enabled reconstruction of arbitrary visual images from brain activity by combining the outputs of the local decoders despite having been trained with brain activity for a small number of random images.  #@NEW_LINE#@#  ', 'While visual image identification14,15,17 and reconstruction16 are suitable for decoding according to image-based similarity, they do not provide explicit information regarding the object a person is seeing or imagining.  #@NEW_LINE#@#  The possible objects we may see or imagine in daily life are countless, and object-based information is often more directly relevant to our visually guided behaviour than image-based information.  #@NEW_LINE#@#  Establishing methods for decoding generic object categories from brain activity would provide practical benefits for technologies utilizing information decoded from brain activity and may increase understanding of the way the human brain represents a vast number of objects.  #@NEW_LINE#@#  ', 'In this study, we aim to decode seen and imagined object categories, including those not used in decoder training from fMRI signals measured while subjects either viewed or imagined object images.  #@NEW_LINE#@#  We extended the modular decoding approach originally developed for visual image reconstruction16 to the decoding of generic object categories.  #@NEW_LINE#@#  ', 'To tailor the modular decoding approach to the objectives of this study, we assumed that an object category can be represented by a set of visual features with several invariances.  #@NEW_LINE#@#  These features correspond to those proposed for the object recognition challenge in machine vision18,19,20,21,22,23,24 (Fig 1a), which aims at enabling a computer to recognize objects in images according to their category names.  #@NEW_LINE#@#  The selection of visual features is a critical aspect of this approach because even if images depict the same object, they do not necessarily have pixel-wise similarity as a result of varying rotation, scale, position and other visual attributes.  #@NEW_LINE#@#  Thus objects may be more suitably represented using mid- or high-level visual features which are invariant to such image differences rather than the low-level features (for example, local contrast13 or Gabor wavelet filter14,15,17) used for visual image reconstruction and identification.  #@NEW_LINE#@#  ', 'Figure 1: Generic object decoding.  #@NEW_LINE#@#  (a) Visual feature extraction from natural images using computational models.  #@NEW_LINE#@#  Visual features were calculated from natural images using CNN (CNN18), HMAX (HMAX13), GIST and SIFT+BoF.  #@NEW_LINE#@#  (b) Overview of generic object decoding.  #@NEW_LINE#@#  fMRI activity was measured while subjects viewed natural images.  #@NEW_LINE#@#  Decoders were trained to predict the values of the visual features for presented images/objects from multi-voxel fMRI signals.  #@NEW_LINE#@#  Given measured fMRI activity, a feature vector was predicted and it is used to identify the seen or imagined object by comparing it with the feature vectors of numerous objects in an annotated image database including those not used for decoder training.Full size image', 'We tested a total of 13 candidates of visual feature types/layers constructed from four models (Fig 1a, see Methods section): a convolutional neural network (CNN) model20 (CNN1CNN8), HMAX model21,22,23 (HMAX1HMAX3), GIST24, and scale invariant feature transform18 combined with the Bag of Features19 (SIFT+BoF).  #@NEW_LINE#@#  Some of the models emulate the hierarchical structure of the human visual system (CNN and HMAX), while others are designed for scene recognition (GIST) and object recognition (SIFT+BoF) in machine vision.  #@NEW_LINE#@#  These visual feature types/layers have multiple levels of complexity, and it has been reported that representations of these model outputs are statistically similar to visual cortical activity21,22,25,26,27,28,29,30.  #@NEW_LINE#@#  ', 'Using these visual features, we present a new approach called generic object decoding, in which arbitrary object categories are decoded from human brain activity (Fig 1b).  #@NEW_LINE#@#  We used the online image database, ImageNet31, and trained regression models (decoders) to predict visual features extracted by the computational models from brain activity recorded by fMRI while subjects viewed natural images (150 categories).  #@NEW_LINE#@#  The trained decoders were then used to predict feature vectors of seen and imagined objects that were not used in decoder training from the fMRI activity patterns.  #@NEW_LINE#@#  By comparing the predicted feature vector with the category-average feature vectors calculated from images in the image database, we identify seen and imagined object categories from those defined in a database (15,372 categories in ImageNet31).  #@NEW_LINE#@#  Because arbitrary object categories are represented in this feature space, the identified categories are not limited to those used in training.  #@NEW_LINE#@#  ', 'Here we first demonstrate that visual feature values of seen objects calculated by the computational models can be predicted from multiple brain areas, showing tight associations between hierarchical visual cortical areas and the complexity levels of visual features.  #@NEW_LINE#@#  In addition, we show that stimulus-trained decoders can be used to decode visual features of imagined objects, providing evidence for the progressive recruitment of hierarchical neural representations in a top-to-bottom manner.  #@NEW_LINE#@#  Finally, we test whether the features predicted from brain activity patterns are useful for identifying seen and imagined objects for arbitrary categories.'  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
'Generic object decoding', 'Our objective was to decode arbitrary object categories (not included in model training) from human brain activity measured using fMRI.  #@NEW_LINE#@#  First, we extracted feature values from object images using a total of 13 visual feature types/layers (CNN18, HMAX13, GIST and SIFT+BoF; 1,000 units for each feature type/layer).  #@NEW_LINE#@#  We thereby represented an object image by a feature vector of each feature type/layer (Fig 1a).  #@NEW_LINE#@#  Second, decoders were trained to predict the vectors of visual features of seen objects from brain activity patterns (Fig 1b).  #@NEW_LINE#@#  Third, using the trained decoders, a feature vector was predicted from brain activity measured while seeing or imagining an object that was not used in decoder training.  #@NEW_LINE#@#  Finally, the predicted feature vector was used to identify a seen/imagined object by calculating the similarity between the predicted and the category-average feature vectors calculated from an annotated image database.  #@NEW_LINE#@#  ', 'To test the feasibility of generic decoding of seen and imagined objects from brain activity, we conducted two fMRI experiments: an image presentation experiment, and an imagery experiment (Fig 2).  #@NEW_LINE#@#  In the image presentation experiment, fMRI signals were measured while subjects viewed a sequence of object images (Fig 2a).  #@NEW_LINE#@#  The image presentation experiment consisted of two sessions: the training image session and the test image session.  #@NEW_LINE#@#  In the training image session, 1,200 images from 150 object categories (8 images from each category) were each presented once.  #@NEW_LINE#@#  In the test image session, 50 images from 50 object categories (one image from each category) were each presented 35 times.  #@NEW_LINE#@#  In the imagery experiment, fMRI signals were measured while subjects imagined about 1 of the 50 object categories (10 times for each category), which were the same as those in the test image session (Fig 2b).  #@NEW_LINE#@#  The categories in the test image session and the imagery experiment were not used in the training image session.  #@NEW_LINE#@#  While we show results with fMRI signals averaged across all trials (35 trials for the test image session and 10 trials for the imagery experiment), quantitatively similar results were obtained with a much smaller number of averaged samples (see Supplementary Information).  #@NEW_LINE#@#  ', 'Figure 2: Experimental design.  #@NEW_LINE#@#  (a) Image presentation experiment.  #@NEW_LINE#@#  Images were presented in the centre of the display with a central fixation spot.  #@NEW_LINE#@#  The colour of the fixation spot changed from white to red for 0.5 s before each stimulus block started to indicate the onset of the block.  #@NEW_LINE#@#  Subjects maintained steady fixation throughout each run and performed a one-back repetition detection task on the images, responding with a button press for each repetition.  #@NEW_LINE#@#  (b) Imagery experiment.  #@NEW_LINE#@#  The onset of each trial was marked by a change in the fixation colour.  #@NEW_LINE#@#  Cue stimuli composed of an array of object names were visually presented for 3 s. The onset and the end of the imagery periods were signalled by auditory beeps.  #@NEW_LINE#@#  After the first beep, the subjects were instructed to imagine as many object images as possible pertaining to the category indicated by red letters.  #@NEW_LINE#@#  They continued imagining with their eyes closed (15 s) until the second beep.  #@NEW_LINE#@#  Subjects were then instructed to evaluate the vividness of their mental imagery (3 s).  #@NEW_LINE#@#  Note that the actual cue consisted of an array of 50 object names, while only subsets of the words are depicted in this figure because of space limitations.Full size image', 'We performed our analysis for each combination of feature types/layers and brain regions of interest (ROIs; V1V4, the lateral occipital complex (LOC), fusiform face area (FFA), parahippocampal place area (PPA), lower visual cortex (LVC; V1V3), higher visual cortex (HVC; covering regions around LOC, FFA and PPA) and the entire visual cortex (VC; covering all of the visual subareas listed above); see Methods section and Supplementary Fig 1 for definitions of the ROIs).  #@NEW_LINE#@#  ', 'A set of linear regression functions (sparse linear regression (SLR) model32) was used to predict visual feature vectors (1,000 feature units for each feature type/layer; see Methods section) from the fMRI signals in each ROI.  #@NEW_LINE#@#  A unit decoder was trained to predict the values of the feature vectors calculated from the viewed images, using fMRI signals from the training image session (that is, 1,000 decoders for each feature type/layer).  #@NEW_LINE#@#  The trained decoders were then used to predict the vectors of each feature type/layer for the test object categories from measured fMRI signals in the test image session and the imagery experiment.  #@NEW_LINE#@#  ', 'Image feature decoding', 'We first investigated whether we could decode the values of visual feature vectors for presented images from brain activity.  #@NEW_LINE#@#  Decoding accuracy was evaluated by the correlation coefficient between true and predicted feature values of each feature unit (Fig 3a).  #@NEW_LINE#@#  Correlation coefficients were averaged across the units in each feature type/layer for multiple ROIs and then averaged across five subjects.  #@NEW_LINE#@#  Because the distribution of feature values and the number of feature units of the original population differed between feature types/layers, interpreting decoding accuracy differences across feature types/layers was difficult.  #@NEW_LINE#@#  For example, when accuracy was evaluated by normalized root mean square errors, the overall pattern of accuracy across feature types/layers differed from the pattern derived from correlations (Supplementary Fig 2).  #@NEW_LINE#@#  Therefore, in the following we focussed on the pattern of accuracies across ROIs in each feature type/layer.  #@NEW_LINE#@#  ', 'Figure 3: Image feature decoding and the homology of CNN and the human brain.  #@NEW_LINE#@#  (a) Example of a feature unit.  #@NEW_LINE#@#  True (black) and predicted (light grey) feature values for 50 test images are shown for Unit #562 of CNN Layer 8 (CNN8) predicted from the whole VC.  #@NEW_LINE#@#  (b) Image feature decoding accuracy.  #@NEW_LINE#@#  Mean decoding accuracies are shown for each combination of the feature type/layer and ROI (error bars, 95% confidence interval (CI) across five subjects).Full size image', 'Figure 3b shows the decoding accuracy for features of presented images in multiple ROIs.  #@NEW_LINE#@#  The predicted feature values positively correlated with the true values for all featureROI combinations (one-sided t-test after Fishers z-transform, uncorrected P less_than 0.05).  #@NEW_LINE#@#  Interestingly, the choice of feature types/layers and ROIs affected the accuracy pattern.  #@NEW_LINE#@#  As observed in the results for the CNN layers, higher-order features tended to be better predicted from fMRI signals in higher rather than lower ROIs, and lower-order features tended to be better predicted from fMRI signals in lower rather than higher ROIs (analysis of variance (ANOVA), interaction between layer and ROI, P less_than 0.01).  #@NEW_LINE#@#  Similar tendencies were also observed with HMAX (ANOVA, interaction between feature type and ROI, P less_than 0.01).  #@NEW_LINE#@#  Such differences were also observed in the decoding accuracies obtained from LVC and HVC (Supplementary Fig 3).  #@NEW_LINE#@#  These results reveal a tight association between hierarchical visual areas and the complexity levels of visual features in image feature decoding accuracy.  #@NEW_LINE#@#  ', 'To understand more details about what each visual feature represents, we synthesized preferred images that strongly activated individual units in each CNN layer using the activation maximization technique33,34,35,36 (Fig 4; see Supplementary Fig 4 for more examples; see Methods section).  #@NEW_LINE#@#  The generated images showed gradually increasing complexity, from simple edge-detector-like representations to more complex shapes, textures or object parts and to intact objects.  #@NEW_LINE#@#  Because CNN68 are fully connected layers, position information about their preferred pattern was lost.  #@NEW_LINE#@#  These preferred images of individual CNN units resemble the critical features found in monkey electrophysiological studies37.  #@NEW_LINE#@#  ', 'Figure 4: Preferred images and weight distributions for CNN layers.  #@NEW_LINE#@#  (a) Examples of preferred images for individual units (four randomly selected units) in each CNN layer.  #@NEW_LINE#@#  Because each unit of CNN8 corresponds to a specific category, the names of the categories for each unit are shown at the top left.  #@NEW_LINE#@#  (b) Voxel weight maps on the flattened cortical surface.  #@NEW_LINE#@#  Weights resulting from the decoders trained to predict feature values of a single feature unit are shown for Unit #105 of CNN8 and for Unit #253 of CNN2 (predicted from VC, Subject 3).  #@NEW_LINE#@#  The preferred image for each unit is indicated in the inset.  #@NEW_LINE#@#  (c) Distributions of selected voxels across individual subareas for CNN layers.  #@NEW_LINE#@#  Distributions of selected voxels used for prediction are shown for each CNN layer (predicted from VC, averaged across five subjects).  #@NEW_LINE#@#  The proportion of selected voxels for each subarea was calculated by first counting the numbers of selected voxels for individual feature units, aggregating them over 1,000 feature units in each layer, and then normalizing with the total voxels.Full size image', 'Analyses of voxel weights learned by the image feature decoders (trained with VC) showed differences in the spatial distribution of predictive voxels between visual feature types/layers.  #@NEW_LINE#@#  We used a linear regression model in which voxel weights were estimated with sparseness priors32, resulting in a small subset of voxels selected with non-zero weights (hence relevant for decoding).  #@NEW_LINE#@#  Examples of voxel sets for a CNN2 unit and a CNN8 unit are shown in Fig 4b.  #@NEW_LINE#@#  While the voxels selected for predicting a CNN2 unit were distributed mainly around the lower visual areas (V1V3), those for predicting a CNN8 unit were distributed around more anterior areas (Fig 4b).  #@NEW_LINE#@#  Distributions of predictive voxels for the visual feature types/layers were consistent with the results of the image feature decoding analysis using individual ROIs (Fig 3b): voxels in the lower/higher ROIs were more frequently selected for predicting lower/higher visual features, respectively (Fig 4c; ANOVA, interaction between feature type/layer and ROI, P less_than 0.01; see Supplementary Fig 5 for distributions for HMAX13, GIST and SIFT+BoF).  #@NEW_LINE#@#  ', 'Additionally, we found that the image feature decoding accuracy in each unit was positively correlated with the category discriminability of each unit (Fig 5).  #@NEW_LINE#@#  As an index of category discriminability, we calculated the F-statistic of each feature unit (a ratio of inter- and intra-category variations of feature values calculated from images in the ImageNet (15,322 categories)).  #@NEW_LINE#@#  The distributions of the category discriminability from each feature type/layer showed that high-level features tended to demonstrate high discriminability for both CNN and HMAX (Fig 5a bottom).  #@NEW_LINE#@#  Within each feature type/layer, positive correlations between decoding accuracy and category discriminability were observed for all visual features except for HMAX1 (Fig 5b,c).  #@NEW_LINE#@#  Furthermore, decoding accuracy and category discriminability were positively correlated even when feature units were combined across all feature types/layers (Fig 5c, all), and were averaged within each feature type/layer (Fig 5c, mean).  #@NEW_LINE#@#  While this analysis was performed with decoders trained on whole VC activity, this tendency was robustly reproduced in each ROI.  #@NEW_LINE#@#  Thus decodable feature units tended to be critical for defining object categories.  #@NEW_LINE#@#  ', 'Figure 5: Category discriminability versus decodability of individual feature units.  #@NEW_LINE#@#  (a) Scatterplot of image feature decoding accuracy against category discriminability for all the feature types/layers (top panel, predicted from VC, averaged across five subjects for each unit), and the distributions of category discriminability for each feature type/layer (bottom panel; vertical lines denote the mode of each distribution).  #@NEW_LINE#@#  Each dot in the scatter plot denotes the F-statistic and the decoding accuracy for a feature unit (1,000 units).  #@NEW_LINE#@#  (b) Scatterplots for individual feature types/layers.  #@NEW_LINE#@#  (c) Correlation coefficients between category discriminability and image feature decoding accuracy (error bars, 95% CI across five subjects; asterisks, one-sided t-test after Fishers z-transform, uncorrected P less_than 0.05).  #@NEW_LINE#@#  The solid line in the scatterplots indicates a fitted regression line.Full size image', 'Category-average feature decoding', 'In computer vision, object recognition is typically performed by matching the feature vector of an input image with a set of category-specific feature vectors, assuming that hierarchical features are progressively rendered invariant to represent object categories.  #@NEW_LINE#@#  To link image feature decoding with object recognition, we next tested whether the feature values from the image feature decoders (cf., Fig 3) predicted the values of category-specific feature vectors.  #@NEW_LINE#@#  We constructed category-specific feature vectors by averaging the feature vectors of multiple images annotated with the same object category (15,372 categories in ImageNet31).  #@NEW_LINE#@#  To evaluate the prediction accuracy in each unit, Pearsons correlation coefficients were calculated between the predicted and the category-average feature values for the series of test trials.  #@NEW_LINE#@#  We then averaged the correlation coefficients across the units in each feature type/layer.  #@NEW_LINE#@#  Evaluation with category-average features allowed us to extend the feature decoding analysis to the imagery experiment, in which subjects freely imagined about an object cued by text, and thus there were no ground truth images from which visual features could be calculated.  #@NEW_LINE#@#  ', 'Correlation coefficients between the features decoded from stimulus- and imagery-induced brain activity and the category-average features in multiple ROIs are shown in Fig 6 (see Supplementary Fig 8 for distributions of correlation coefficients for individual units).  #@NEW_LINE#@#  Features decoded from stimulus-induced brain activity were significantly correlated with the category-average features for all featureROI combinations (Fig 6a; one-sided t-test after Fishers z-transform, uncorrected P less_than 0.05).  #@NEW_LINE#@#  In contrast to image features (Fig 3b), category-average features were better predicted in higher than lower ROIs for most feature types/layers.  #@NEW_LINE#@#  Imagery-induced brain activity showed a similar prediction pattern, but with reduced accuracies: relatively high correlations were found for mid-to-high-level CNN features using mid-to-high-level ROIs (V4, LOC, FFA and PPA) (Fig 6b).  #@NEW_LINE#@#  Thus the results showed that image features decoded from stimulus- and imagery-induced brain activity were predictive of category-specific features, particularly with mid-to-high-level CNN features decoded from mid-to-high-level ROIs.  #@NEW_LINE#@#  Poorer prediction with other features and ROIs may be due to the lack of invariance to image attributes that were irrelevant for object recognition.  #@NEW_LINE#@#  The capacity of imagery-induced brain activity to predict mid-level, as well as top-level, CNN features suggests that mental imagery may recruit neural representations of visual features with intermediate complexity, which are not simply pictorial or conceptual, via progressive topdown processing.  #@NEW_LINE#@#  ', 'Figure 6: Prediction of category-average features from stimulus- and imagery-induced brain activity.  #@NEW_LINE#@#  (a) Correlation coefficients with predicted features from stimulus-induced brain activity.  #@NEW_LINE#@#  (b) Correlation coefficients with predicted features from imagery-induced brain activity.  #@NEW_LINE#@#  Mean correlation coefficients are shown for each feature type/layer and ROI (error bars, 95% CI across five subjects).  #@NEW_LINE#@#  See Supplementary Fig 6 for the relation between category discriminability and prediction accuracy (cf., Fig 5c).  #@NEW_LINE#@#  Similar analyses can be performed using the decoders trained with category-average features (not image features) for training stimulus images (category-average feature decoders), showing qualitatively similar prediction results with higher accuracy for imagery-induced brain activity (Supplementary Figs 7 and 8b).Full size image', 'To find out a signature of such progressive topdown processing, we performed a time-resolved feature prediction analysis.  #@NEW_LINE#@#  While the results in Fig 6 are based on the average brain activity during the entire 9-s stimulus or 15-s imagery period, the time course of prediction accuracies at each time point reveals differences between CNN layers and ROIs (Fig 7).  #@NEW_LINE#@#  When the features in each CNN layer were predicted from imagery-induced brain activity in the whole VC, the peak timings for higher CNN layers tended to precede those for lower CNN layers, except CNN1, which showed poor prediction accuracy and no clear peak (Fig 7a,b; ANOVA, interaction between time and CNN layer, P less_than 0.01).  #@NEW_LINE#@#  Similarly, when feature prediction accuracies for all layers were averaged for each ROI, the peak timings for higher ROIs tended to precede those for lower ROIs (Fig 7c,d; ANOVA, interaction between time and ROI, P less_than 0.01; see Supplementary Fig 9 for the time courses for each CNN layer).  #@NEW_LINE#@#  Such time differences across CNN layers or ROIs were not found with stimulus-induced brain activity (Fig 7eh).  #@NEW_LINE#@#  Although anecdotally, subjects reported that, in the imagery task of this study, it often took several seconds for vivid visual imagery to develop.  #@NEW_LINE#@#  Thus, the imagery task may have progressively activated hierarchical neural representations in a top-to-bottom manner over several seconds in concert with the vividness of imagery.  #@NEW_LINE#@#  ', 'Figure 7: Time course of feature prediction from imagery- and stimulus-induced brain activity.At each time point/volume around the task period, correlation coefficients were calculated between the predicted and the category-average feature values for the series of test trials (averaged across five subjects; shaded areas, 95% CI across feature units; filled circles, peak timing).  #@NEW_LINE#@#  (a,b) Line plots and colour display for prediction from imagery-induced brain activity (VC) at different CNN layers.  #@NEW_LINE#@#  (c,d) Prediction from imagery-induced brain activity in individual ROIs (averaged over CNN18).  #@NEW_LINE#@#  (e,f) Prediction from stimulus-induced brain activity (VC) at different CNN layers.  #@NEW_LINE#@#  (g,h) Prediction from stimulus-induced brain activity in individual ROIs (average over CNN18).  #@NEW_LINE#@#  Analyses were performed on the volume-by-volume basis while colour maps are drawn by averaging time courses evaluated by every single volume or the averages of every two or three volumes, by allowing overlap for display purposes.Full size image', 'Object category identification', 'We next conducted identification analysis14,16 to examine whether a predicted feature vector was useful for identifying a seen or imagined object.  #@NEW_LINE#@#  Because our approach is not constrained by the categories used for decoder training, we can perform identification analysis for thousands of object categories, including those not used for model training.  #@NEW_LINE#@#  Here the category of the seen or imagined object was identified from a variable number of candidate categories (Fig 8).  #@NEW_LINE#@#  We constructed the candidate feature vector set consisting of object categories used in the test image session (and imagery experiments) and a specified number of object categories randomly selected from the 15,322 categories provided by ImageNet31.  #@NEW_LINE#@#  Given an fMRI sample, category identification was performed by selecting the category-average feature vector with the highest correlation coefficient with the predicted feature vector.  #@NEW_LINE#@#  ', 'Figure 8: Category identification procedure.Correlation coefficients were calculated between predicted feature vectors and category-average feature vectors for categories in the candidate set, consisting of the presented or imagined category and a specified number of categories randomly selected from the ImageNet database31.  #@NEW_LINE#@#  The category with the highest correlation coefficient was selected as the predicted category (marked by a star).Full size image', 'First, we illustrated examples with the top six categories selected from 1,000 candidates (Fig 9a).  #@NEW_LINE#@#  For both seen and imagined objects, the true categories were correctly selected or highly ranked.  #@NEW_LINE#@#  Even when the correct categories were not assigned, the top six categories appeared to include similar or related categories (for example, the decoded feature vector for duck misidentified as another type of bird solitaire).  #@NEW_LINE#@#  ', 'Figure 9: Object categories ranked by similarity to decoded feature vectors.  #@NEW_LINE#@#  (a) Object category rankings and correlation scores.  #@NEW_LINE#@#  Rankings of object categories are shown for two viewed objects (fire extinguisher and duck) and two imagined objects (silk hat and tambourine; CNN8; predicted from VC; candidate sets consisting of each one of the true categories (n=50) and 999 randomly selected false categories).  #@NEW_LINE#@#  The candidate object names and correlation scores for the top six objects with the highest correlation coefficients are shown in the middle panels (correct object names indicated in red).  #@NEW_LINE#@#  The panels at the bottom illustrate the correlation coefficients for 1,000 object categories in descending order.  #@NEW_LINE#@#  (b) Relationship between the object category ranking and the semantic distance (CNN8; predicted from VC; shaded areas, 95% CI across five subjects).  #@NEW_LINE#@#  (c) Correlation coefficients between the rank and the semantic distance for all feature types/layers (predicted from VC).  #@NEW_LINE#@#  Correlation coefficients were calculated for each candidate set and target category and then averaged across 1,000 repetitions of candidate selection and 50 target categories (error bars, 95% CI across five subjects; asterisks, one-sided t-test after Fishers z-transform, uncorrected P less_than 0.05).Full size image', 'Next, we quantitatively evaluated the relationships between rank and semantic distance with respect to the target categories and the categories ranked in each position.  #@NEW_LINE#@#  Semantic distance was defined by the shortest path length between the categories in the WordNet tree38 and was calculated between the target category and each of the 1,000 candidate categories.  #@NEW_LINE#@#  The 1,000 distance values were then sorted by the object category ranking (the similarity to the decoded feature vector) and averaged over 1,000 repetitions of random candidate selection and 50 target categories.  #@NEW_LINE#@#  The analysis showed that categories ranked in higher positions tended to show shorter semantic distances to target categories (Fig 9b).  #@NEW_LINE#@#  Semantic distance was positively correlated with rank, especially for mid-to-high-level CNN layers (CNN38) and SIFT+BoF under both seen and imagined conditions (Fig 9c; asterisks, one-sided t-test after Fishers z-transform, uncorrected P less_than 0.05).  #@NEW_LINE#@#  These results suggest that, for these feature types/layers, semantically similar, if not correct, categories can be selected with the feature vector predicted from brain activity.  #@NEW_LINE#@#  ', 'For quantitative evaluation, we assessed identification accuracy of seen and imagined objects when the number of candidate sets was two (Fig 10a,b; see Supplementary Fig 10 for identification accuracy as a function of the number of average samples).  #@NEW_LINE#@#  This analysis was performed with feature vectors for individual feature types/layers and with concatenated feature vectors for CNN18 (8,000 units), HMAX13 (3,000 units) and all 13 feature types/layers (13,024 units).  #@NEW_LINE#@#  ', 'Figure 10: Identification accuracy.Identification was performed for all combinations of 1 of the 50 test object categories and 1 of the 15,322 candidate categories (identification from two categories; predicted from VC: error bars, 95% CI across five subjects; dashed line, chance level, 50%).  #@NEW_LINE#@#  (a) Seen object identification accuracy.  #@NEW_LINE#@#  (b) Imagined object identification accuracy.  #@NEW_LINE#@#  While the identification analyses here were performed with the image feature decoders trained to predict image features of presented images, it is also possible to use category-average feature decoders trained with category-average features for training stimulus images.  #@NEW_LINE#@#  See Supplementary Figs 12 and 13 for the results of the category-average feature decoders.Full size image', 'The analysis revealed that both seen and imagined objects were successfully identified with statistically significant accuracy for most of the feature types/layers (one-sided t-test, uncorrected P less_than 0.05 except for CNN1, HMAX2 and HMAX3 under the imagery condition) with highest accuracy around mid-level features (CNN56).  #@NEW_LINE#@#  Furthermore, when the same analysis was performed for each ROI, above-chance accuracy was achieved for most featureROI combinations (Supplementary Fig 11).  #@NEW_LINE#@#  Intriguingly, mid-level features decoded from higher ROIs were most useful for identifying both seen and imagined object categories.  #@NEW_LINE#@#  ', 'Additional analyses revealed that the pairs with larger semantic distances (WordNets path length) tended to have higher identification accuracies (Supplementary Fig 14), consistent with the relationships between the identified rank and semantic distance (Fig 9c).  #@NEW_LINE#@#  Because we used a pretrained CNN model, the 1,000 categories used in the model accidentally included 20 of the test categories in our study.  #@NEW_LINE#@#  However, the identification accuracy with the other 30 non-overlapping categories alone was qualitatively similar to the main results (Supplementary Fig 15).'  #@NEW_LINE#@#  

Discussion  #@NEW_LINE#@#  
'We have shown that via hierarchical visual feature representation, arbitrary object categories seen and imagined by subjects can be predicted from fMRI signals in the human VC.  #@NEW_LINE#@#  The trained decoders successfully predicted the feature values of the presented images.  #@NEW_LINE#@#  Higher-/lower-order visual features tended to be better predicted from fMRI signals in higher/lower cortical areas, respectively.  #@NEW_LINE#@#  Further, decoders trained to predict feature vectors of presented images can be used to predict those of both seen and imagined object categories, enabling the identification of seen and imagined object categories despite not using the same categories for decoder training.  #@NEW_LINE#@#  Interestingly, mid-level features were most useful for identifying object categories, suggesting the significant contributions of mid-level features to construct discriminative representations for object categories.  #@NEW_LINE#@#  Thus, our results demonstrate that a decoding model trained on a limited set of object categories generalizes to decode arbitrary object categories, providing a proof of concept for generic object decoding.  #@NEW_LINE#@#  This framework is also known as the zero-data learning or zero-shot learning in the machine-learning field39, in which a model must generalize to classes with no training data.  #@NEW_LINE#@#  Moreover, successful predictions of category-average features at mid-to-high-level CNN layers and object category identification from imagery-induced brain activity in mid-to-high-level ROIs would suggest that mental imagery may recruit neural representations of visual features with intermediate complexity, which are elicited in visual perception, via progressive topdown processing.  #@NEW_LINE#@#  ', 'Our analyses demonstrated that visual features extracted by computational models were successfully predicted from brain activity patterns (Fig 3).  #@NEW_LINE#@#  The analysis revealed a hierarchical correspondence between cortical hierarchy and the levels of visual feature representations.  #@NEW_LINE#@#  These results were consistent with previous demonstrations of high representational similarity between the top layer of a CNN and visual cortical activity in the inferior temporal cortex of humans27,28 and non-human primates25,26,27.  #@NEW_LINE#@#  Moreover, several previous studies reported that features from the middle layer of a hierarchical neural network were able to accurately predict V4 brain activity25,26.  #@NEW_LINE#@#  In addition, a previous study reported an explicit gradient for feature complexity in visual cortical hierarchy using an encoding approach28.  #@NEW_LINE#@#  Our results are consistent with these findings, showing a homology between the hierarchies of individual areas from lower to HVC and the CNN layers using a decoding approach.  #@NEW_LINE#@#  Thus our results support the idea that CNN models can provide a good proxy for the hierarchical feed-forward visual system for object recognition.  #@NEW_LINE#@#  ', 'In our analyses, we selected 1,000 feature units to reduce computational cost, as some layers of the CNN (CNN17) originally contained  greater than 100,000 units.  #@NEW_LINE#@#  However, it is possible that the selection of the 1,000 units biased the results.  #@NEW_LINE#@#  To test this possibility, we repeated the same identification analysis by resampling units from the original feature populations and repeatedly changing the number of units from 10 to 1,000 (Supplementary Fig 16).  #@NEW_LINE#@#  The analysis demonstrated that the identification accuracies of most feature types/layers were almost saturated when several hundred units were used, and qualitatively similar results to the main results were obtained for different numbers of units.  #@NEW_LINE#@#  ', 'Our results may be relevant to the long-standing debate regarding whether mental imagery is symbolic (language-like) or depictive (picture-like)40,41.  #@NEW_LINE#@#  In our analysis, the decoders trained on brain activity induced by visual stimuli were able to generalize to predict the category-average feature vectors of not only seen but also imagined object categories (Fig 5), enabling the identification of imagined object categories using the feature vector decoded from brain activity during imagery (Fig 10b).  #@NEW_LINE#@#  Previous studies reported that the common neural representations are used during perception and mental imagery for low-level image properties3,4,5,17, including information about orientation, spatial frequency and retinotopic location, as well as for high-level semantic and conceptual representations8,9,10,12, depending on the tasks performed by subjects.  #@NEW_LINE#@#  Our analyses further revealed progressive recruitment of multiple levels of hierarchical visual features, including features with intermediate complexity that go beyond low-level image properties and bridge the gap between pictorial and conceptual representations (Fig 7).  #@NEW_LINE#@#  Our analyses quantify the topdown effects of hierarchical visual cortical activity during mental imagery, suggesting that feature-level representations elicited in visual perception were recruited during mental object imagery in a graded manner.  #@NEW_LINE#@#  Taken together, these results reveal the nature of mental imagery as a type of topdown perception.  #@NEW_LINE#@#  ', 'We extended the modular decoding approach previously proposed in our visual image reconstruction study16 to high-level object vision using visual features with multiple levels of complexity (Fig 4a).  #@NEW_LINE#@#  Since images depicting the same kinds of objects do not necessarily have pixel-wise similarity, complex and invariant features would appear to be suitable for object identification.  #@NEW_LINE#@#  However, a simulation study suggested that intermediate level rather than highly complicated visual features are more useful for object discrimination42.  #@NEW_LINE#@#  Our additional analysis with true feature vectors calculated from stimulus images (with no prediction errors; equivalent to generic object recognition in machine vision) also showed a slightly poorer identification with CNN8 than with CNN7 (Supplementary Fig 17).  #@NEW_LINE#@#  Consistent with these observations, our results from decoded feature vectors showed the highest identification accuracy with mid-level rather than top-level CNN features.  #@NEW_LINE#@#  These results suggest the suitability of mid-level, or generic, features for discriminative object representation, possibly consistent with electrophysiological studies of monkey inferior temporal cortex37,43.  #@NEW_LINE#@#  ', 'Our approach is relevant to a previous study that focussed on semantic feature representations to establish relations between word meanings and brain activity44.  #@NEW_LINE#@#  The study demonstrated decoding of arbitrary nouns thought by subjects using encoding models and statistics of word co-occurrence.  #@NEW_LINE#@#  Our work differs from that attempt in that we employed computational models that produced visual feature representations from images to establish the relations between brain activity in VC and object categories, making it possible to address how hierarchical visual feature representations associated with visual objects are recruited during mental imagery.  #@NEW_LINE#@#  Furthermore, in the experiment of the previous study44, subjects were presented with both line drawings and noun labels of concrete objects and were instructed to think about the properties of the target object.  #@NEW_LINE#@#  In contrast, in our image presentation experiment, visual images were presented alone with no cognitive task other than the one-back repetition task to maintain subjects attention, and in the imagery experiment, subjects were only required to imagine visual images of the target category without any additional tasks.  #@NEW_LINE#@#  Our results demonstrated that imagining about object images is sufficient to achieve generic decoding of imagined object categories utilizing the commonality of feature-level representations between perception and imagery.  #@NEW_LINE#@#  ', 'In the present study, we used decoding approach instead of the representational similarity analysis27,45,46,47,48 or encoding approaches14,15,17,25,26,28 to link brain activity and visual features (see Supplementary Figs 1820 for analyses of the encoding approach).  #@NEW_LINE#@#  While the representational similarity analysis and encoding approaches can evaluate mass characteristics of each visual features (for example, a specific layer of the CNN) associated with brain activity, our decoding approach can characterize individual feature units in terms of decodability from distributed brain activity patterns.  #@NEW_LINE#@#  As previously demonstrated, computational models with a high representational similarity to brain activity patterns in the inferior temporal cortex showed better categorization accuracy27.  #@NEW_LINE#@#  Thus it may be possible to use the prediction accuracy of individual units as a guide to find effective units for better object recognition performance in machine vision.  #@NEW_LINE#@#  Indeed, our analyses revealed that the feature units better predicted from brain activity showed higher category discriminability (Fig 5).  #@NEW_LINE#@#  This finding is consistent with the conclusions of previous studies25,26,27 and supports the notion that feature decoding accuracy may be a suitable guide for selecting more useful features for object recognition.  #@NEW_LINE#@#  ', 'Our identification analyses revealed that highly ranked candidate categories tended to be semantically similar to the target categories for mid-to-high-level CNN layers and SIFT+BoF (Fig 9b,c).  #@NEW_LINE#@#  Therefore, even when identification was incorrect, we were able to predict semantically similar categories to the target category.  #@NEW_LINE#@#  However, this tendency was not observed with HMAX or GIST.  #@NEW_LINE#@#  Because GIST captures low-level image properties24,29, it is not surprising that rank and the semantic distance were not correlated.  #@NEW_LINE#@#  Conversely, HMAX was designed to model the higher-level visual system, but did not show a positive correlation between rank and semantic distance.  #@NEW_LINE#@#  This may suggest that HMAX cannot capture the semantics of objects, which is consistent with the indications of several previous studies27,45,46,47,48.  #@NEW_LINE#@#  ', 'Our approach allows the decoding of arbitrary object categories not limited to those used for decoder training.  #@NEW_LINE#@#  This new method has a range of potential practical applications, particularly in situations where what kind of objects should be decoded is unknown.  #@NEW_LINE#@#  Because our approach can decode imagined categories, it may also be possible to decode the contents of dreaming or daydreaming13.  #@NEW_LINE#@#  Reading the contents of such spontaneously generated thinking may be beneficial for understanding the functions of such cognitive phenomena.  #@NEW_LINE#@#  Achieving this requires distinguishing the conceivable differences in neural representation between volitional and spontaneous mental imagery.  #@NEW_LINE#@#  This formulates a challenging problem in future research.  #@NEW_LINE#@#  In addition, our approach may provide a basis for a brain-based information retrieval system by translating brain activity into words or concepts.  #@NEW_LINE#@#  Using the outputs of decoders, our approach may create a query for an information retrieval system based on brain activity.  #@NEW_LINE#@#  ', 'The framework of directly predicting visual features from brain activity may be utilized for applications developed with deep neural networks.  #@NEW_LINE#@#  Recent advances have enabled image reconstruction49 and description generation50 from feature patterns obtained by processing images through CNN.  #@NEW_LINE#@#  Combining these technologies with brain decoding may extend previous reconstruction study16 and the present work to produce richer outputs.  #@NEW_LINE#@#  Our results demonstrating the predictability of CNN features from the brain may then open the possibility to develop new technology for brain machine interface by combining brain decoding and deep neural networks.'  #@NEW_LINE#@#  

Methods  #@NEW_LINE#@#  
'Subjects', 'Five healthy subjects (one female and four males, aged between 23 and 38 years) with normal or corrected-to-normal vision participated in the experiments.  #@NEW_LINE#@#  Rather than using statistical methods to determine the sample size, the sample size was chosen to match previous fMRI studies with similar behavioral protocols.  #@NEW_LINE#@#  All subjects had considerable experience participating in fMRI experiments, and were highly trained.  #@NEW_LINE#@#  All subjects provided written informed consent for participation in the experiments, and the study protocol was approved by the Ethics Committee of ATR.  #@NEW_LINE#@#  ', 'Visual images', 'Images were collected from an online image database ImageNet31 (2011, fall release), an image database where images are grouped according to the hierarchy in WordNet38.  #@NEW_LINE#@#  We selected 200 representative object categories (synsets) as stimuli in the visual image presentation experiment.  #@NEW_LINE#@#  After excluding images with a width or height  less_than 100 pixels or aspect ratio  greater than 1.5 or  less_than 2/3, all remaining images in ImageNet were cropped to the centre.  #@NEW_LINE#@#  For copyright reasons, the images in Figs 1, 2, 3, 8 and 9 are not the actual images from ImageNet used in our experiments.  #@NEW_LINE#@#  The original images are replaced with images with similar contents for display purposes.  #@NEW_LINE#@#  ', 'Experimental design', 'We conducted two types of experiments: an image presentation experiment, and an imagery experiment.  #@NEW_LINE#@#  All visual stimuli were rear-projected onto a screen in an fMRI scanner bore using a luminance-calibrated liquid crystal display projector.  #@NEW_LINE#@#  Data from each subject were collected over multiple scanning sessions spanning approximately 2 months.  #@NEW_LINE#@#  On each experiment day, one consecutive session was conducted for a maximum of 2 hours.  #@NEW_LINE#@#  Subjects were given adequate time for rest between runs (every 310 min) and were allowed to take a break or stop the experiment at any time.  #@NEW_LINE#@#  ', 'The image presentation experiment consisted of two distinct types of sessions: training image sessions and test image sessions, each of which consisted of 24 and 35 separate runs (9 min 54 s for each run), respectively.  #@NEW_LINE#@#  Each run contained 55 stimulus blocks consisting of 50 blocks with different images and five randomly interspersed repetition blocks where the same image as in the previous block was presented.  #@NEW_LINE#@#  In each stimulus block, an image (12 × 12 degrees of visual angle) was flashed at 2 Hz for 9 s. Images were presented at the centre of the display with a central fixation spot.  #@NEW_LINE#@#  The colour of the fixation spot changed from white to red for 0.5 s before each stimulus block began to indicate the onset of the block.  #@NEW_LINE#@#  Extra 33- and 6-s rest periods were added to the beginning and end of each run, respectively.  #@NEW_LINE#@#  Subjects maintained steady fixation throughout each run and performed a one-back repetition detection task on the images, responding with a button press for each repetition to maintain their attention on the presented images (mean task performance across five subjects; sensitivity=0.930; specificity=0.995).  #@NEW_LINE#@#  In the training image session, a total of 1,200 images from 150 object categories (8 images from each category) were each presented only once.  #@NEW_LINE#@#  In the test image session, a total of 50 images from 50 object categories (1 image from each category) were presented 35 times each.  #@NEW_LINE#@#  Importantly, the categories in the test image session were not used in the training image session.  #@NEW_LINE#@#  The presentation order of the categories was randomized across runs.  #@NEW_LINE#@#  ', 'In the imagery experiment, subjects were required to visually imagine images from 1 of the 50 categories that were presented in the test image session of the image presentation experiment.  #@NEW_LINE#@#  Prior to the experiment, 50 image exemplars from each category were exposed to train the correspondence between object names and the visual images specified by the names.  #@NEW_LINE#@#  The imagery experiment consisted of 20 separate runs and each run contained 25 imagery blocks (10 min 39 s for each run).  #@NEW_LINE#@#  Each imagery block consisted of a 3-s cue period, a 15-s imagery period, a 3-s evaluation period and a 3-s rest period.  #@NEW_LINE#@#  Extra 33- and 6-s rest periods were added to the beginning and end of each run, respectively.  #@NEW_LINE#@#  During the rest periods, a white fixation spot was presented at the centre of the display.  #@NEW_LINE#@#  The colour of the fixation spot changed from white to red for 0.5 s to indicate the onset of the blocks from 0.8 s before each cue period began.  #@NEW_LINE#@#  During the cue period, words describing the names of the 50 categories presented in the test image session were visually presented around the centre of the display (1 target and 49 distractors).  #@NEW_LINE#@#  The position of each word was randomly changed across blocks to avoid contamination of cue-specific effects on the fMRI response during imagery periods.  #@NEW_LINE#@#  The word corresponding to the category to be imagined was presented in red (target) and the other words were presented in black (distractors).  #@NEW_LINE#@#  The onset and end of the imagery periods were signaled by beep sounds.  #@NEW_LINE#@#  Subjects were required to start imagining as many object images pertaining to the category described by the red word as possible, and were instructed to keep their eyes closed from the first beep until the second beep.  #@NEW_LINE#@#  After the second beep, the word corresponding to the target category was presented to allow the subjects evaluate the vividness of their mental imagery on a five-point scale (very vivid, fairly vivid, rather vivid, not vivid, cannot recognize the target) by a button press.  #@NEW_LINE#@#  The 25 categories in each run were pseudo-randomly selected from 50 categories such that the two consecutive runs contained all 50 categories.  #@NEW_LINE#@#  ', 'Retinotopy experiment', 'The retinotopy experiment followed the conventional protocol51,52 using a rotating wedge and an expanding ring of a flickering checkerboard.  #@NEW_LINE#@#  The data were used to delineate the borders between each visual cortical area and to identify the retinotopic map (V1V4) on the flattened cortical surfaces of individual subjects.  #@NEW_LINE#@#  ', 'Localizer experiment', 'We performed functional localizer experiments to identify the LOC, FFA and PPA for each individual subject53,54,55.  #@NEW_LINE#@#  The localizer experiment consisted of 48 runs and each run contained 16 stimulus blocks.  #@NEW_LINE#@#  In this experiment, intact or scrambled images (12 × 12 degrees of visual angle) from face, object, house and scene categories were presented at the centre of the screen.  #@NEW_LINE#@#  Each of the eight stimulus types (four categories × two conditions) was presented twice per run.  #@NEW_LINE#@#  Each stimulus block consisted of a 15-s intact or scrambled stimulus presentation.  #@NEW_LINE#@#  The intact and scrambled stimulus blocks were presented successively (the order of the intact and scrambled stimulus blocks was random), followed by a 15-s rest period consisting of a uniform grey background.  #@NEW_LINE#@#  Extra 33- and 6-s rest periods were added to the beginning and end of each run, respectively.  #@NEW_LINE#@#  In each stimulus block, 20 different images of the same type were presented for 0.3 s, followed by an intervening blank screen of 0.4 s.', 'MRI acquisition', 'fMRI data were collected using 3.0-Tesla Siemens MAGNETOM Trio A Tim scanner located at the ATR Brain Activity Imaging Center.  #@NEW_LINE#@#  An interleaved T2*-weighted gradient-EPI (echo-planar imaging) scan was performed to acquire functional images covering the entire brain (image presentation, imagery and localizer experiments: repetition time (TR), 3,000 ms; echo time (TE), 30 ms; flip angle, 80 deg; field of view (FOV), 192 × 192 mm2; voxel size, 3 × 3 × 3 mm3; slice gap, 0 mm; number of slices, 50) or the entire occipital lobe (retinotopy experiment: TR, 2,000 ms; TE, 30 ms; flip angle, 80 deg; FOV, 192 × 192 mm2; voxel size, 3 × 3 × 3 mm3; slice gap, 0 mm; number of slices, 30).  #@NEW_LINE#@#  T2-weighted turbo spin echo images were scanned to acquire high-resolution anatomical images of the same slices used for the EPI (image presentation, imagery and localizer experiments: TR, 7,020 ms; TE, 69 ms; flip angle, 160 deg; FOV, 192 × 192 mm2; voxel size, 0.75 × 0.75 × 3.0 mm3; retinotopy experiment: TR, 6,000 ms; TE, 57 ms; flip angle, 160 deg; FOV, 192 × 192 mm2; voxel size, 0.75 × 0.75 × 3.0 mm3).  #@NEW_LINE#@#  T1-weighted magnetization-prepared rapid acquisition gradient-echo fine-structural images of the entire head were also acquired (TR, 2,250 ms; TE, 3.06 ms; TI, 900 ms; flip angle, 9 deg, FOV, 256 × 256 mm2; voxel size, 1.0 × 1.0 × 1.0 mm3).  #@NEW_LINE#@#  ', 'MRI data preprocessing', 'The first 9-s scans for experiments with TR=3 s (image presentation, imagery and localizer experiments) and 8-s scans for experiments with TR=2 s (retinotopy experiment) of each run were discarded to avoid MRI scanner instability.  #@NEW_LINE#@#  The acquired fMRI data underwent three-dimensional motion correction using SPM5 (http://www.fil.ion.ucl.ac.uk/spm).  #@NEW_LINE#@#  The data were then coregistered to the within-session high-resolution anatomical image of the same slices used for EPI and subsequently to the whole-head high-resolution anatomical image.  #@NEW_LINE#@#  The coregistered data were then reinterpolated by 3 × 3 × 3 mm3 voxels.  #@NEW_LINE#@#  ', 'For the data from the image presentation experiment and imagery experiment, after within-run linear trend removal, voxel amplitudes were normalized relative to the mean amplitude of the entire time course within each run.  #@NEW_LINE#@#  The normalized voxel amplitudes from each experiment were then averaged within each 9-s stimulus block (three volumes; image presentation experiment) or within each 15-s imagery period (five volumes; imagery experiment), respectively (unless otherwise stated) after shifting the data by 3 s (one volume) to compensate for haemodynamic delays.  #@NEW_LINE#@#  ', 'ROI selection', 'V1V4 were delineated by the standard retinotopy experiment51,52.  #@NEW_LINE#@#  The retinotopy experiment data were transformed to Talairach coordinates and the visual cortical borders were delineated on the flattened cortical surfaces using BrainVoyager QX (http://www.brainvoyager.com).  #@NEW_LINE#@#  The voxel coordinates around the greywhite matter boundary in V1V4 were identified and transformed back into the original coordinates of the EPI images.  #@NEW_LINE#@#  The voxels from V1 to V3 were combined, and defined as the LVC.  #@NEW_LINE#@#  The LOC, FFA and PPA were identified using conventional functional localizers53,54,55.  #@NEW_LINE#@#  The localizer experiment data were analysed using SPM5.  #@NEW_LINE#@#  The voxels showing significantly higher responses to objects, faces or scenes than for scrambled images (two-sided t-test, uncorrected P less_than 0.05 or 0.01) were identified and defined as LOC, FFA and PPA, respectively.  #@NEW_LINE#@#  A contiguous region covering LOC, FFA and PPA was manually delineated on the flattened cortical surfaces, and the region was defined as the HVC.  #@NEW_LINE#@#  Voxels overlapping with LVC were excluded from the HVC.  #@NEW_LINE#@#  Voxels from V1 to V4 and the HVC were combined to define the VC.  #@NEW_LINE#@#  In the regression analysis, voxels showing the highest correlation coefficient with the target variable in the training image session were selected to predict each feature (with a maximum of 500 voxels for V1V4, LOC, FFA and PPA; 1,000 voxels for LVC, HVC and VC).  #@NEW_LINE#@#  ', 'Visual features', 'We used four types of computational models: a CNN20, HMAX21,22,23, GIST24 and SIFT18 combined with the BoF16 to construct visual features from images.  #@NEW_LINE#@#  The features with a model-training phase (HMAX and SIFT+BoF) used 1,000 images belonging to the categories used in the training image session (150 categories) for training.  #@NEW_LINE#@#  Each model is further described in the following subsections.  #@NEW_LINE#@#  ', 'Convolutional neural network', 'We used the MatConvNet implementation (http://www.vlfeat.org/matconvnet/) of the CNN model20, which was trained with images in ImageNet31 to classify 1,000 object categories.  #@NEW_LINE#@#  The CNN consisted of five convolutional layers and three fully connected layers.  #@NEW_LINE#@#  We randomly selected 1,000 units in each of the first to seventh layers and used all 1,000 units in the eighth layer.  #@NEW_LINE#@#  We represented each image by a vector of those units outputs and named them CNN1CNN8, respectively.  #@NEW_LINE#@#  ', 'HMAX', 'HMAX21,22,23 is a hierarchical model that extends the simple and complex cells described by Hubel and Wiesel56,57 and computed features through hierarchical layers.  #@NEW_LINE#@#  These layers consist of an image layer and six subsequent layers (S1, C1, S2, C2, S3 and C3), which are built from the previous layers by alternating template matching and max operations.  #@NEW_LINE#@#  In the calculations at each layer, we employed the same parameters as in a previous study22, except that the number of features in layers C2 and C3 was set to 1,000.  #@NEW_LINE#@#  We represented each image by a vector of the three types of HMAX features, which consisted of 1,000 randomly selected outputs of units in layers S1, S2 and C2, and all 1,000 outputs in layer C3.  #@NEW_LINE#@#  We defined these outputs as HMAX1, HMAX2 and HMAX3, respectively.  #@NEW_LINE#@#  ', 'GIST', 'GIST is a model developed for the computer-aided scene categorization task24.  #@NEW_LINE#@#  To compute GIST, an image was first converted to greyscale and resized to have a maximum width of 256 pixels.  #@NEW_LINE#@#  Next, the image was filtered using a set of Gabor filters (16 orientations, 4 scales).  #@NEW_LINE#@#  After that, the filtered images were segmented by a 4 × 4 grid (16 blocks), and then the filtered outputs within each block were averaged to extract 16 responses for each filter.  #@NEW_LINE#@#  The responses from multiple filters were concatenated to create a 1,024-dimensional feature vector for each image (16 (orientations) × 4 (scales) × 16 (blocks)=1,024).  #@NEW_LINE#@#  ', 'SIFT with BoF (SIFT+BoF)', 'The visual features using the SIFT with the BoF approach were calculated from SIFT descriptors.  #@NEW_LINE#@#  We computed SIFT descriptors from the images using the VLFeat58 implementation of dense SIFT.  #@NEW_LINE#@#  In the BoF approach, each component of the feature vector (visualwords) is created by vector-quantizing extracted descriptors.  #@NEW_LINE#@#  Using 1,000,000 SIFT descriptors calculated from an independent training image set, we performed k-means clustering to create a set of 1,000 visualwords.  #@NEW_LINE#@#  The SIFT descriptors extracted from each image were quantized into visualwords using the nearest cluster centre, and the frequency of each visualword was calculated to create a BoF histogram for each image.  #@NEW_LINE#@#  Finally, all of the histograms obtained through the above processing underwent L-1 normalization to become unit norm vectors.  #@NEW_LINE#@#  Consequently, features from SIFT with the BoF approach are invariant to image scaling, translation and rotation and are partially invariant to illumination changes and affine or three-dimensional projection.  #@NEW_LINE#@#  ', 'Visual feature decoding', 'We constructed decoding models to predict the visual feature vectors of seen objects from fMRI activity using a linear regression function.  #@NEW_LINE#@#  Here we used SLR (http://www.cns.atr.jp/cbi/sparse_estimation/index.html)32 that can automatically select the important features for prediction.  #@NEW_LINE#@#  Sparse estimation is known to perform well when the dimensionality of the explanatory variable is high, as is the case with fMRI data59.  #@NEW_LINE#@#  ', 'Given an fMRI sample  consisting of the activity of d voxels as input, the regression function can be expressed by', '', 'where xi is a scalar value specifying the fMRI amplitude of the voxel i, wi is the weight of voxel i and w0 is the bias.  #@NEW_LINE#@#  For simplicity, the bias w0 is absorbed into the weight vector such that .  #@NEW_LINE#@#  The dummy variable x0=1 is introduced into the data such that .  #@NEW_LINE#@#  Using this function, we modeled the lth component of each visual feature vector as a target variable tl (l{1,, L}) that is explained by the regression function y(x) with additive Gaussian noise as described by', '', 'where  is a zero mean Gaussian random variable with noise precision .  #@NEW_LINE#@#  ', 'Given a training data set, SLR computes the weights for the regression function such that the regression function optimizes an objective function.  #@NEW_LINE#@#  To construct the objective function, we first express the likelihood function by', '', 'where N is the number of samples and X is an N × (d+1) fMRI data matrix whose nth row is the d+one-dimensional vector xn, and  are the samples of a component of the visual feature vector.  #@NEW_LINE#@#  ', 'We performed Bayesian parameter estimation and adopted the automatic relevance determination prior32 to introduce sparsity into the weight estimation.  #@NEW_LINE#@#  We considered the estimation of the weight parameter w given the training data sets {X, tl}.  #@NEW_LINE#@#  We assumed a Gaussian distribution prior for the weights w and non-informative priors for the weight precision parameters  and the noise precision parameter , which are described as', '', '', '', 'In the Bayesian framework, we considered the joint probability distribution of all the estimated parameters, and the weights can be estimated by evaluating the following joint posterior probability of w:', '', 'Given that the evaluation of the joint posterior probability  is analytically intractable, we approximated it using the variational Bayesian method32,60,61.  #@NEW_LINE#@#  While the results shown in the main figures are based on this automatic relevance determination model, we obtained qualitatively similar results using other regression models (Supplementary Figs 21 and 22).  #@NEW_LINE#@#  ', 'We trained linear regression models that predict feature vectors of individual feature types/layers for seen object categories given fMRI samples in the training image session.  #@NEW_LINE#@#  For test data sets, fMRI samples corresponding to the same categories (35 samples in the test image session, 10 samples in the imagery experiment) were averaged across trials to increase the signal-to-noise ratio of the fMRI signals.  #@NEW_LINE#@#  Using the learned models, we predicted feature vectors of seen/imagined objects from averaged fMRI samples to construct one predicted feature vector for each of the 50 test categories.  #@NEW_LINE#@#  ', 'Synthesizing preferred images using activation maximization', 'We used the activation maximization method to generate preferred images for individual units in each CNN layer33,34,35,36.  #@NEW_LINE#@#  Synthesizing preferred images starts from a random image and optimizes the image to maximally activate a target CNN unit by iteratively calculating how the image should be changed via backpropagation.  #@NEW_LINE#@#  This analysis was implemented using custom software written in MATLAB based on Python codes provided in a series of blog posts (Mordvintsev, A., Olah, C., Tyka, M., DeepDreama code example for visualizing Neural Networks, https://github.com/google/deepdream, 2015; Øygard, A. M.,Visualizing GoogLeNet Classes, https://github.com/auduno/deepdraw, 2015).  #@NEW_LINE#@#  ', 'Identification analysis', 'In the identification analyses, seen/imagined object categories were identified using the visual feature vectors decoded from fMRI signals.  #@NEW_LINE#@#  Prior to the identification analysis, visual feature vectors were computed for all of the preprocessed images in all of the categories (15,372 categories in ImageNet31) except for those used in the fMRI experiments and their hypernym/hyponym categories and those used for visual feature model training (HMAX and SIFT+BoF).  #@NEW_LINE#@#  The visual feature vectors of individual images were averaged within each category to create category-average feature vectors for all of the categories to form the candidate set.  #@NEW_LINE#@#  We computed Pearsons correlation coefficients between the decoded and the category-average feature vectors in the candidate sets.  #@NEW_LINE#@#  To quantify accuracy, we created candidate sets consisting of the seen/imagined categories and the specified number of randomly selected categories.  #@NEW_LINE#@#  None of the categories in the candidate set were used for decoder training.  #@NEW_LINE#@#  Given a decoded feature vector, category identification was conducted by selecting the category with the highest correlation coefficient among the candidate sets.  #@NEW_LINE#@#  ', 'Statistics', 'In the main analysis, we used t-tests to examine whether the mean of the correlation coefficients and the mean of the identification accuracies across subjects significantly exceeded the chance level (0 for correlation coefficient, and 50% for identification accuracy).  #@NEW_LINE#@#  For correlation coefficients, Fishers z-transform was applied before the statistical tests.  #@NEW_LINE#@#  Before every t-test, we performed the ShapiroWilk test to check normality, and we confirmed that the null hypothesis that the data that came from a normal distribution was not rejected for all cases (P greater than 0.01).  #@NEW_LINE#@#  ', 'Data and code availability', 'The experimental data and codes that support the findings of this study are available from our repository: https://github.com/KamitaniLab/GenericObjectDecoding.'  #@NEW_LINE#@#  


