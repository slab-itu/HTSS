article id="http://dx.doi.org/10.1038/NCOMMS16047"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
The ancestral flower of angiosperms and its early diversification  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
'Recent advances in molecular phylogenetics and a series of important palaeobotanical discoveries have revolutionized our understanding of angiosperm diversification.  #@NEW_LINE#@#  Yet, the origin and early evolution of their most characteristic feature, the flower, remains poorly understood.  #@NEW_LINE#@#  In particular, the structure of the ancestral flower of all living angiosperms is still uncertain.  #@NEW_LINE#@#  Here we report model-based reconstructions for ancestral flowers at the deepest nodes in the phylogeny of angiosperms, using the largest data set of floral traits ever assembled.  #@NEW_LINE#@#  We reconstruct the ancestral angiosperm flower as bisexual and radially symmetric, with more than two whorls of three separate perianth organs each (undifferentiated tepals), more than two whorls of three separate stamens each, and more than five spirally arranged separate carpels.  #@NEW_LINE#@#  Although uncertainty remains for some of the characters, our reconstruction allows us to propose a new plausible scenario for the early diversification of flowers, leading to new testable hypotheses for future research on angiosperms.'  #@NEW_LINE#@#  

Introduction  #@NEW_LINE#@#  
'Flowers are the reproductive structures of angiosperms (flowering plants), which represent ca.  #@NEW_LINE#@#  90% of all living land plants and upon which most of terrestrial life depends, either directly or indirectly.  #@NEW_LINE#@#  However, flowers are a relatively recent evolutionary innovation on the geological timescale of plant diversification.  #@NEW_LINE#@#  The most recent common ancestor of all living angiosperms likely existed 140250 million years ago1,2,3.  #@NEW_LINE#@#  In contrast, the most recent common ancestor of all extant seed plants (that is, angiosperms and gymnosperms) is estimated to have lived 310350 million years ago4,5.  #@NEW_LINE#@#  A key question in evolutionary biology concerns the origin of the angiosperms and of their most important defining structure, the flower4,6,7,8,9,10,11,12.  #@NEW_LINE#@#  To address this problem, there are three complementary approaches7.  #@NEW_LINE#@#  The first is to study the fossil record and attempt to identify the closest extinct relatives of angiosperms4,6.  #@NEW_LINE#@#  The second is to seek answers in the growing body of evolutionary developmental genetic (evo-devo) studies on the reproductive structures of living angiosperms and gymnosperms8,11,13,14.  #@NEW_LINE#@#  The third approach, which we apply here using a massive new data set and state-of-the-art analytical methods, is to infer the structure of ancestral flowers using the distribution of floral traits among extant angiosperms, the latest estimates of their phylogeny and models of morphological evolution.  #@NEW_LINE#@#  This approach allows us to uncover important clues on the origin and subsequent diversification of the flower by providing estimates of what flowers were like at key points in time.  #@NEW_LINE#@#  ', 'Previous attempts to reconstruct the ancestral flower using a modern phylogenetic framework of angiosperms15,16,17 have improved our understanding of ancestral floral traits, such as the ancestral structure of the carpel18.  #@NEW_LINE#@#  However, several essential aspects of the ancestral flower have so far remained unresolved, due to particularly confounding variation in floral structure among the earliest diverging lineages of angiosperms18,19,20.  #@NEW_LINE#@#  For instance, it was still unknown whether the ancestral flower was unisexual or bisexual21.  #@NEW_LINE#@#  Furthermore, although the reconstruction of the ancestral flower has received some attention, the more general question of its subsequent early evolution and diversification has been little addressed in recent years9,20,22.  #@NEW_LINE#@#  In addition, previous efforts were limited by taxon sampling and the lack of model-based approaches to address these questions.  #@NEW_LINE#@#  ', 'Here we present the largest data set of floral traits ever assembled (13,444 referenced data points), sampling 792 species from 63 orders (98%) and 372 families (86%) of angiosperms.  #@NEW_LINE#@#  Using chronograms from molecular dating analyses calibrated with 136 fossil constraints1, we provide the first model-based reconstructions of ancestral flowers at the deepest nodes in the phylogeny of angiosperms.  #@NEW_LINE#@#  We infer ancestral states for 27 floral traits using three approaches: maximum parsimony (MP), maximum likelihood (ML) and a reversible-jump Markov Chain Monte Carlo (rjMCMC) Bayesian approach that allows simultaneous exploration of multiple models of morphological evolution.  #@NEW_LINE#@#  In addition, each analysis was replicated using alternative hypotheses for early angiosperm phylogeny (for example, whether Amborella alone or Amborella and Nymphaeales together are the sister group of all remaining angiosperms) and two alternative estimates for the age of the angiosperms, which remain highly debated topics (Supplementary Discussion)1,2,4,23.  #@NEW_LINE#@#  We found that our results are generally robust and unaffected by the choice of ancestral state reconstruction method, alternative phylogenies and different divergence time estimates.  #@NEW_LINE#@#  However, model-based methods (ML and Bayesian) resolve some long-standing questions where parsimony continues to give equivocal answers.'  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
'The reconstructed ancestral flower', 'We infer that the flower of the most recent common ancestor of all living angiosperms (hereafter referred to as the ancestral flower) was most likely bisexual and had an undifferentiated perianth of more than ten tepals, an androecium of more than ten stamens, and a gynoecium of more than five carpels.  #@NEW_LINE#@#  We also infer that the perianth and the androecium probably had whorled phyllotaxis with three organs per whorl.  #@NEW_LINE#@#  Taken together, these numbers imply at least four whorls in each organ category (Fig 1; see Supplementary Data 1 and Supplementary Discussion for estimates of uncertainty associated with ancestral states).  #@NEW_LINE#@#  Further, we show that the perianth was radially symmetric (actinomorphic), the stamens had introrse anthers (that is, shedding their pollen towards the centre of the flower), the carpels were superior and most likely spirally arranged, and all floral organs were free from each other.  #@NEW_LINE#@#  In spite of similarities with some extant flowers, there is no living species that shares this exact combination of characters.  #@NEW_LINE#@#  This implies that all extant flowers, including those of the earliest-diverging lineages of angiosperms (for example, Amborella and Nymphaeales), are derived in several aspects24.  #@NEW_LINE#@#  In particular, the model-based answer to the much-debated question of sex evolution in angiosperms as a whole shows that the ancestral flower was bisexual and confirms that the functionally unisexual flowers of Amborella are derived (Fig 2 and Supplementary Discussion).  #@NEW_LINE#@#  ', 'Figure 1: Three-dimensional model of the ancestral flower reconstructed from our analyses.Here we provide the states with highest mean posterior probability and their associated credibility intervals from the reversible-jump Bayesian analysis of the C series of trees, which takes into account all forms of uncertainty (parameters, tree, branch times, model).  #@NEW_LINE#@#  States marked with three asterisks (***) indicate high confidence and consistency across methods of reconstruction (for example, perianth present, undifferentiated and actinomorphic).  #@NEW_LINE#@#  Other states need to be interpreted with caution as their reconstruction was either associated with higher uncertainty (for example, perianth phyllotaxis, number of stamen whorls) or inconsistent across methods (for example, sex reconstructed as equivocal with parsimony).  #@NEW_LINE#@#  The colours, shapes and relative sizes of organs were not inferred from our analyses and were chosen here for artistic reasons.  #@NEW_LINE#@#  The exact number of organs could not be reconstructed precisely.  #@NEW_LINE#@#  Minimum numbers were chosen for this representation, but reconstructions with more floral organs are also compatible with our results (for further details, see Supplementary Discussion, section Reconstructing the ancestral flower).  #@NEW_LINE#@#  A rotating version of this model is provided as Supplementary Movie 1.Full size image', 'Figure 2: Maximum likelihood ancestral state reconstruction of functional sex of flowers in angiosperms.Our results show that bisexual flowers are ancestral and that unisexual flowers evolved many times independently.  #@NEW_LINE#@#  The pie charts at the centre of the figure indicate the proportional likelihoods for reconstructed ancestral states at 15 key nodes (here we illustrate character 100_A on the maximum clade credibility tree from the C series; for complete results, see Supplementary Data 1 and Supplementary Data 1423).  #@NEW_LINE#@#  The photographs illustrate the diversity of angiosperm flowers (photographs by H.S., Y.S., J.S.  #@NEW_LINE#@#  and M.v.B.  #@NEW_LINE#@#  ).Full size image', 'We also evaluated the level of correlation among floral traits and its impact on reconstructed ancestral states.  #@NEW_LINE#@#  We found significant support for correlated evolution in 4048% of the pairs tested (Table 1), a result consistent with previous studies of floral integration25,26,27,28,29,30.  #@NEW_LINE#@#  However, accounting for these correlations does not substantially affect the results obtained from analyses of individual traits (Supplementary Data 2 and Supplementary Discussion).  #@NEW_LINE#@#  ', 'Table 1 Matrix of all pairwise correlations tested among binary floral traits.Full size table', 'Uncertainty in ancestral state reconstructions', 'Estimating features of the ancestral flower is a difficult task, because there are neither suitable outgroups for direct comparison4,10 nor fossil flowers known from the time period when this ancestor existed31.  #@NEW_LINE#@#  In this study, we make these inferences based on the distribution of traits in extant angiosperms and their phylogenetic relationships, and, for the first time, methods using explicit models of stochastic evolution for morphological characters.  #@NEW_LINE#@#  While these analyses help us resolve long-standing ambiguities (for example, whether the ancestral flower was bisexual or unisexual) and reconstruct ancestral flowers at internal key nodes rarely assessed in previous work (for example, Pentapetalae), such reconstructions necessarily come with limitations and some uncertainty.  #@NEW_LINE#@#  However, it should be possible to quantify this uncertainty.  #@NEW_LINE#@#  ', 'Through our detailed comparison of three reconstruction methods, five series of trees (each sampling 1,000 chronograms obtained from fossil-calibrated divergence time analyses in BEAST), two timescales for the angiosperms and many models of morphological evolution, we found that reversible-jump Bayesian methods perform best at measuring uncertainty in ancestral state reconstruction, whereas ML nearly always suggested misleadingly high confidence (Supplementary Discussion).  #@NEW_LINE#@#  For this reason, 95% credibility intervals (CIs) obtained from the reversible-jump Bayesian analyses are reported throughout this study (Fig 1 and Supplementary Data 1).  #@NEW_LINE#@#  This is an important step forward because previous higher-level studies of floral evolution focused almost exclusively on parsimony reconstructions and lacked any assessment of uncertainty associated with ancestral states.  #@NEW_LINE#@#  Furthermore, early work on ancestral state reconstruction suggested a positive relationship between uncertainty and node depth32, which would predict that all ancestral states reconstructed for the root of our angiosperm tree should be uncertain.  #@NEW_LINE#@#  Interestingly, we found that this is not always true (about half of the floral traits examined yielded highly confident estimates; Fig 3 and Supplementary Discussion), although we observe that focal nodes nested in Monocotyledoneae and Eudicotyledoneae are on average reconstructed with higher confidence than deeper nodes.  #@NEW_LINE#@#  ', 'Figure 3: Overview of confidence in ancestral state reconstructions across all traits (X axis), focal nodes (Y axis) and sets of trees (panels).Confidence scores on a three-star scale were attributed for each trait-node combination based on the cross-comparison of MP, ML and rjMCMC results and the lower bound of the rjMCMC credibility intervals (see Supplementary Discussion for details).  #@NEW_LINE#@#  A more detailed version of this figure with row and column captions is provided in Supplementary Data 1.  #@NEW_LINE#@#  Light=low confidence; dark=high confidence.Full size image', 'A new scenario for the early evolution of flowers', 'Our study provides the first tentative evidence that the ancestral flower of all angiosperms most likely had a perianth (tepals) and an androecium (stamens) organized in whorls, rather than in a spiral.  #@NEW_LINE#@#  Although reconstruction of ancestral floral phyllotaxis proved relatively uncertain in this study (Supplementary Discussion), as in previous work based on parsimony alone18,19,20, the implications of our result are important to consider for two reasons.  #@NEW_LINE#@#  First, the idea that whorled phyllotaxis of floral organs always evolved from spiral phyllotaxis is still prevalent among botanists.  #@NEW_LINE#@#  Our analyses provide the most comprehensive evidence so far that the opposite is more likely within crown-group angiosperms (this does not preclude the possibility that the ancestral flower was itself derived from a spiral ancestor further down the stem lineage of the group).  #@NEW_LINE#@#  Second, this result, if correct, would imply that the early evolution of angiosperm flowers was marked by successive reduction of the number of whorls in both the perianth and the androecium (Fig 4).  #@NEW_LINE#@#  The vast majority of angiosperm flowers are characterized by two perianth whorls and one or two stamen whorls (Fig 5)22.  #@NEW_LINE#@#  Our results suggest two different evolutionary pathways for the reduction in number of whorls in early angiosperm evolution: reduction by loss of entire whorls (Magnoliidae, Monocotyledoneae) or reduction by merging of whorls concomitant with an increase in the number of organs per whorl (Pentapetalae) (Supplementary Discussion).  #@NEW_LINE#@#  This scenario has implications for comparative evo-devo studies of floral structure across angiosperms, prompting a re-examination of available evidence and interpretations of ABCE model variants13,33.  #@NEW_LINE#@#  In particular, this scenario implies that the two perianth whorls of Monocotyledoneae could be homologous with the corolla (inner perianth whorl) of Pentapetalae (Fig 4 and Supplementary Discussion), suggesting that the sliding boundary ABCE model of Liliaceae could in fact be a conserved Arabidopsis ABCE model expressed in reduced flowers lacking the ancestral two outermost perianth whorls.  #@NEW_LINE#@#  However, other alternatives exist, including one where the two perianth whorls of Monocotyledoneae are homologous with the calyx (outer perianth whorl) of Pentapetalae by loss of the ancestral two innermost perianth whorls.  #@NEW_LINE#@#  ', 'Figure 4: Simplified scenario for the earliest phase of floral diversification as inferred from our analyses.Each floral diagram summarizes the main features of our reconstructed ancestors for key nodes of the tree (for details, see Supplementary Discussion and Supplementary Figs 27).  #@NEW_LINE#@#  This figure only depicts the presumed first 40 million years of floral evolution, without exhaustively representing every new morphology that arose during that time.  #@NEW_LINE#@#  The absolute timescale provided here corresponds to divergence time estimated with a narrow constraint on the maximum age of angiosperms1; relaxing this constraint to reflect alternative studies that yielded older age estimates for angiosperms resulted in nearly identical ancestral reconstructions (see Supplementary Discussion).  #@NEW_LINE#@#  Note that there is uncertainty associated with some of these reconstructions (especially for Angiospermae, Magnoliidae and Eudicotyledoneae).  #@NEW_LINE#@#  Therefore, the scenario illustrated here is one of several plausible alternatives and should be taken with caution.  #@NEW_LINE#@#  Floral diagram colour code: light green=undifferentiated tepals; green=sepals; yellow=petals; red=stamens; blue=carpels.Full size image', 'Figure 5: Maximum likelihood ancestral state reconstructions of four representative floral characters.The pie charts at the centre of the figure indicate the proportional likelihoods for reconstructed ancestral states at 15 key nodes (here we optimized the characters on the maximum clade credibility tree from the C series; for complete results, see Supplementary Data 1 and Supplementary Data 1423).  #@NEW_LINE#@#  Grey branches denote missing, inapplicable or polymorphic data.  #@NEW_LINE#@#  (a) Ovary position (character 102_B).  #@NEW_LINE#@#  (b) Fusion of perianth (character 204_A).  #@NEW_LINE#@#  (c) Symmetry of perianth (character 207_B).  #@NEW_LINE#@#  (d) Number of perianth whorls (character 231_A).Full size image', 'What does this scenario of early whorl reduction tell us about the evolutionary forces at play?  #@NEW_LINE#@#  We propose that early reduction in the number of whorls of ancestral flowers presented selective advantages that eventually led to the extinction of its original, multiparted floral groundplan.  #@NEW_LINE#@#  First, both the protective function of the perianth and its role in pollinator attraction could be achieved through fewer organ whorls, potentially explaining the progressive loss or merging of whorls.  #@NEW_LINE#@#  Second, it is possible that a reduced number of perianth whorls facilitated the divergence and canalization of genetic programs among whorls, leading to the strong perianth differentiation into sepals and petals that is characteristic of most members of Pentapetalae13.  #@NEW_LINE#@#  Third, a reduced number of whorls may have been a prerequisite for secondary elaboration of floral structure (for example, bilateral symmetry, fusion of organs; Fig 5), which led to the wide diversity of floral forms and pollination strategies observed in contemporary flowers25.  #@NEW_LINE#@#  In particular, a reduced number of whorls may have been selected for because it facilitated the close spatial and functional association of organs leading to a higher level of functional complexity34.  #@NEW_LINE#@#  This process, known as synorganization, is thought to have increased pollination efficiency and helped trigger some of the most spectacular radiations in angiosperms, such as the Asteraceae and Orchidaceae35.  #@NEW_LINE#@#  ', 'From a functional perspective, it may seem difficult to explain why the hypothesized ancestral flower had more perianth organs than most extant flowers.  #@NEW_LINE#@#  It is plausible that this property is a contingent result of the series of evolutionary transformations (as yet unknown) that led to the ancestral flower from its seed plant ancestors, rather than representing an optimal structure.  #@NEW_LINE#@#  We suggest that the ancestral flower may in fact have been labile with respect to the number of perianth and androecium whorls and thus the total number of organs in each category.  #@NEW_LINE#@#  More stable patterns in the early evolutionary history of angiosperms evolved either by reduction in the number of whorls (as outlined above) or by a transition to spiral phyllotaxis, which has been argued to provide an optimal spatial arrangement in flowers with many organs36.  #@NEW_LINE#@#  Thus, under our scenario, we interpret the entirely spiral flowers of lineages such as Amborella, Austrobaileyales and Calycanthaceae as alternative trajectories in floral evolution from a multiparted, whorled ancestor.'  #@NEW_LINE#@#  

Discussion  #@NEW_LINE#@#  
'In principle, the fossil record could inform us about the plausibility of our reconstructed ancestral flower and our proposed scenario for its subsequent diversification.  #@NEW_LINE#@#  The oldest confirmed fossil flowers are no older than 130 Ma6,31,37,38, whereas estimates for the most recent common ancestor of all living angiosperms (that is, the age of our reconstructed ancestral flower) range between 140 and 250 Ma1,2,3.  #@NEW_LINE#@#  By the time of the first extensive record of fossil flowers in the late Aptian and Albian (100120 Ma), fossils indicate that the radiation of angiosperms had proceeded well into Nymphaeales, Magnoliidae, Chloranthaceae, early-diverging eudicots and early-diverging monocots6,31,39, as also implied by our scenario (Fig 4).  #@NEW_LINE#@#  Many angiosperms in these AptianAlbian floras and the few known older ones had simple flowers6,37,38,39, which both the present and previous analyses18,20 interpret as secondarily reduced.  #@NEW_LINE#@#  However, the record is consistent with our reconstruction in that late Aptian and Albian flowers with whorled and often trimerous phyllotaxis are more diverse than those with spiral phyllotaxis, and in that no fossils with the typical Pentapetalae pattern of five sepals and five petals are known until the latest Albian40.  #@NEW_LINE#@#  Therefore, although there is a probable time lag in fossil preservation of the earliest angiosperm lineages, the sequence of origin of floral traits in the fossil record is largely consistent with our reconstructed initial stages of floral evolution.  #@NEW_LINE#@#  ', 'The origin of the angiosperm flower remains among the most difficult and most important unresolved topics in evolutionary biology4,6,7,8,9,10,11.  #@NEW_LINE#@#  The growing understanding of the distribution of floral traits in both fossil and extant taxa, and the availability of modern analytical tools will be crucial in this long-standing debate.  #@NEW_LINE#@#  Because our approach cannot reconstruct events that occurred on the stem lineage of angiosperms, our study does not address the origin of the flower directly, but it does provide a novel and detailed picture of the flower of the most recent ancestor of all living angiosperms as well as the earliest steps of the subsequent floral diversification.  #@NEW_LINE#@#  These results are a major step forward for understanding the origin of floral diversity and evolution in angiosperms as a whole.  #@NEW_LINE#@#  Progress in reconstructing the evolutionary steps that gave rise to the flower of the most recent common ancestor may require new fossil discoveries, especially along the stem lineage of angiosperms31, or new breakthroughs in evo-devo research14 and related emerging fields41.'  #@NEW_LINE#@#  

Methods  #@NEW_LINE#@#  
'Phylogenetic analyses', 'Ancestral state reconstruction using model-based methods requires a phylogenetic tree with branch lengths proportional to time (that is, a chronogram) or to the number of inferred molecular substitutions (that is, a phylogram).  #@NEW_LINE#@#  We preferred the first option because we did not want to assume a strict correlation of molecular and morphological evolutionary rates.  #@NEW_LINE#@#  The recent relaxed clock molecular dating analysis of Magallón et al.1 was chosen as the starting point for this study because it was calibrated with the largest number (136) of well-justified fossil age constraints ever used at this scale, while at the same time including a very large number of terminal taxa (792), representing 63 orders (98%) and 372 families (86%) of angiosperms.  #@NEW_LINE#@#  We also reanalysed this data set in a number of alternative ways to evaluate the impact of various parameters of this dated tree on our analyses.  #@NEW_LINE#@#  ', 'The A series of analyses refers to the original BEAST analyses of Magallón et al.1, which provided a maximum clade credibility (MCC) tree, used in our parsimony and ML analyses, and a collection of 1,042 trees sampled from the posterior stationary distribution, which we used for our Bayesian analyses of trait evolution.  #@NEW_LINE#@#  These trees, however, presented two drawbacks for our analyses.  #@NEW_LINE#@#  First, their topology had been heavily constrained according to the results of Soltis et al.16, and thus represented only one of the several alternatives for deep-level relationships in angiosperms.  #@NEW_LINE#@#  Second, the BEAST analyses had been conducted with a fixed topology, producing a collection of trees that differed in branch lengths (times) but not topology.  #@NEW_LINE#@#  Thus, integrating phylogenetic uncertainty in our Bayesian analyses of trait evolution was the primary motivation for reanalysing the data set in BEAST without fixing the topology.  #@NEW_LINE#@#  ', 'The B series of analyses refers to the reanalysis of the data set of Magallón et al.1 in BEAST 1.8 (ref.  #@NEW_LINE#@#  42) without using any topological constraints (that is, topology estimated, not fixed), and with all other parameters equal (see below).  #@NEW_LINE#@#  These analyses produced trees with Amborella sister to Nymphaeales rather than to all other angiosperms, and with monocots sister to Chloranthaceae+Magnoliidae rather than to Ceratophyllaceae+Eudicotyledoneae (see Supplementary Discussion and Supplementary Fig 1).  #@NEW_LINE#@#  Other relationships and divergence times were very similar to those found in the A series, but with some variation among trees of the posterior sample regarding the more weakly supported nodes.  #@NEW_LINE#@#  ', 'The C series of analyses refers to the same setup as the B series, but with two topological constraints for deep-level angiosperm relationships: (1) Amborella sister to the rest of angiosperms; (2) Monocotyledoneae+Ceratophyllaceae+ Eudicotyledoneae together forming a clade (excluding Chloranthaceae and Magnoliidae; Supplementary Fig 1).  #@NEW_LINE#@#  These two constraints are supported by the majority of phylogenomic analyses based on complete plastid genomes17,43,44,45 and are consistent with the 17-gene analyses of Soltis et al.16.  #@NEW_LINE#@#  The results from the C series were very similar to those of the A and B series (see Supplementary Discussion).  #@NEW_LINE#@#  ', 'The D and E series were set up with two alternative topological constraints for major clades of angiosperms suggested by recent nuclear phylotranscriptomic analyses (Supplementary Discussion and Supplementary Fig 1).  #@NEW_LINE#@#  In the D series, we constrained Chloranthaceae, Magnoliidae, Ceratophyllaceae and Eudicotyledoneae to form a clade23.  #@NEW_LINE#@#  In the E series, we constrained Chloranthaceae and Ceratophyllaceae to be sister taxa46,47.  #@NEW_LINE#@#  ', 'In addition, we tested the impact of the age of the angiosperms on our ancestral state reconstructions.  #@NEW_LINE#@#  The original analyses of Magallón et al.1 included a narrow age constraint of 136139.35 Ma on the crown-group age of angiosperms based on a quantitative analysis of the fossil record.  #@NEW_LINE#@#  The A200, B200, C200, D200 and E200 series refer to the exact same setups as the A, B, C, D and E series, but with this constraint removed, resulting in chronograms with crown angiosperms typically over 200 Ma old.  #@NEW_LINE#@#  ', 'All new phylogenetic and molecular dating analyses were conducted with BEAST 1.8 (ref.  #@NEW_LINE#@#  42) using the same settings, fossil calibrations and protocols as in the A series1.  #@NEW_LINE#@#  For the B series, five independent Markov Chain Monte Carlo (MCMC) runs of different length (up to 20M generations) were conducted, for a total of ca.  #@NEW_LINE#@#  71M generations (after discarding the first 2M generations from each run as burn-in).  #@NEW_LINE#@#  The posterior was resampled every 50K generations to produce a set of 1,412 trees used in the Bayesian trait analyses.  #@NEW_LINE#@#  For the C series, six runs were conducted for a total of ca.  #@NEW_LINE#@#  85M generations, which were resampled every 50K generation to produce a set of 1,706 trees.  #@NEW_LINE#@#  For each of the D, E, B200, C200, D200 and E200 series of analyses, two runs were conducted for a total of 36M generations, which were resampled every 35K generation to produce sets of 1,028 trees.  #@NEW_LINE#@#  We note that the effective sample size for some parameters of these analyses did not all reach 200 as recommended, suggesting that longer runs might be needed for accurate estimation of phylogenetic relationships and divergence times, consistent with the previous finding that this large data set is difficult to analyse with a Bayesian relaxed clock without fixing the topology1.  #@NEW_LINE#@#  We argue that the posterior samples we obtained here are acceptable for the purpose of this study, because the goal of our reanalyses of the Magallón et al.1 data set was to take into account and evaluate the impact of phylogenetic uncertainty on the results from the A series (the original trees from Magallón et al.1, with fixed topology).  #@NEW_LINE#@#  As we report in detail in the Supplementary Discussion, the estimated general topology, divergence times and ancestral states were remarkably similar across tree series (Supplementary Data 1 and Supplementary Tables 1 and 2).  #@NEW_LINE#@#  However, we recommend caution with the use of these trees for purposes other than this study.  #@NEW_LINE#@#  The MCC tree from each BEAST analysis is provided as Supplementary Data 312.  #@NEW_LINE#@#  ', 'Terminal taxa in the original molecular data set of Magallón et al.1 were either species or genera, with different species sampled for different genes.  #@NEW_LINE#@#  For this study, we transformed the trees of hybrid terminal taxa into trees of species by choosing the species with the most genes sampled for each hybrid (genus-level) terminal taxon.  #@NEW_LINE#@#  This allowed us to produce trees of 792 species and prepare a matching data set of floral traits for exactly the same species, following a strict exemplar approach (see below).  #@NEW_LINE#@#  All of our trees also included six outgroup gymnosperm species.  #@NEW_LINE#@#  Because floral traits are not applicable outside angiosperms (unless controversial homology statements are made), these species were not included in our data set of floral traits and were pruned out of the trees before ancestral state reconstruction.  #@NEW_LINE#@#  Clade names in this paper follow APG IV48 and the Angiosperm Phylogeny Website49 for orders and families, and Cantino et al.50 and Soltis et al.16 for all clades above order.  #@NEW_LINE#@#  ', 'Data set of floral traits', 'We recorded 21 floral traits in 792 species of angiosperms using the collaborative database PROTEUS51.  #@NEW_LINE#@#  The floral traits were chosen and defined to be as broadly applicable as possible.  #@NEW_LINE#@#  For instance, we do not have a character for the number of petals in this data set, because not all angiosperms have petals and all petals are not necessarily homologous.  #@NEW_LINE#@#  Instead, we recorded the total number of perianth parts (sepals plus petals, or tepals).  #@NEW_LINE#@#  All characters are explained and justified in detail in the Supplementary Methods.  #@NEW_LINE#@#  ', 'Floral traits were recorded from a diversity of published and online sources, including many focused morphological studies and a few personal observations.  #@NEW_LINE#@#  Each data record in PROTEUS is linked to an explicit source, which allowed us to cross-check, validate or correct many records following initial entry.  #@NEW_LINE#@#  In total, the data set presented here contains 13,444 floral trait data records obtained from 947 distinct sources.  #@NEW_LINE#@#  The complete list of records and linked sources (references) is available in Supplementary Data 13.  #@NEW_LINE#@#  ', 'All primary characters used in data entry were transformed for analysis (discrete characters were simplified and continuous characters were discretized; see Supplementary Methods for justification and details of these transformations).  #@NEW_LINE#@#  Some characters were transformed in more than one way, leading to a final data matrix of 27 characters and 792 species (Supplementary Data 13).  #@NEW_LINE#@#  Data files were then exported from PROTEUS in appropriate formats for analysis.  #@NEW_LINE#@#  ', 'We used a strict exemplar approach for scoring traits, which means that data were only scored for a species if we could confirm that they were observed in this species (that is, we did not use any general family descriptions or make any assumptions that all species of a genus share the same character states).  #@NEW_LINE#@#  The species were selected because of their inclusion in a recent molecular dating study1.  #@NEW_LINE#@#  Thus, our sample is independent from the floral traits.  #@NEW_LINE#@#  While this approach is both desirable and suitable for the methods we used, we acknowledge that it implies that our data set does not represent the complete variation of floral traits across all angiosperms.  #@NEW_LINE#@#  Thus, our study was not designed to reconstruct the finer-scale evolution of flowers near the tips of the tree (for example, within orders), and our results remain conditional on future denser sampling of the angiosperm phylogeny.  #@NEW_LINE#@#  Our strict exemplar approach also means that data are missing for some traits in some species (total missing data: 27%, including cases of inapplicability).  #@NEW_LINE#@#  Because missing or inapplicable data are more or less evenly and haphazardly distributed across our tree, and species with such data are in effect pruned out in the ancestral reconstruction analyses, it is unlikely that missing data had a strong impact on our results.  #@NEW_LINE#@#  ', 'Ancestral state reconstruction', 'Each floral trait was analysed for each series of trees (A, B, C, D, E, A200, B200, C200, D200, E200) using three complementary approaches52: MP using the ancestral.pars function of the phangorn 2.0.2 package53 in R54, ML using the rayDISC function of the corHMM 1.18 package55 in R54, and a Bayesian rjMCMC approach56,57 using BayesTraits 2 (ref.  #@NEW_LINE#@#  58).  #@NEW_LINE#@#  MP and ML reconstructions were conducted on the MCC tree from each BEAST analysis, whereas Bayesian rjMCMC analyses were conducted on collections of at least 1,000 trees sampled from the posterior stationary distribution from the BEAST analyses.  #@NEW_LINE#@#  Here, we focus on and report results for 15 key nodes in the phylogeny of angiosperms, corresponding to well-recognized major clades (including Angiospermae, Mesangiospermae, Magnoliidae, Monocotyledoneae, Eudicotyledoneae, Pentapetalae, Rosidae and Asteridae).  #@NEW_LINE#@#  However, graphical MP and ML reconstructions for the entire tree are available (Supplementary Data 1423).  #@NEW_LINE#@#  ', 'For each floral trait, we tested and compared at least two distinct Markov models of discrete character evolution in our ML analyses: the equal rates (ER) or Mk model59, which assumes a single rate of transition among all possible states, and the all rates different (ARD) or AsymmMk model60,61, which allows a distinct rate for each possible transition between two states.  #@NEW_LINE#@#  In addition, we tested two unidirectional models for all binary characters (UNI01 and UNI10: rates from 1 to 0 or 0 to 1, respectively, set to zero)52,62, a symmetrical model for all multistate characters (SYM: rates equal for transitions between two given states), and three ordered models for all multistate characters derived from quantitative variables (ORD: rates between non-adjacent states set to zero; ORDSYM: symmetrical version; ORDER: single-rate version).  #@NEW_LINE#@#  Initial tests showed that for some characters, the prior on the root state could affect results in terms of both transition rates and ancestral states62.  #@NEW_LINE#@#  Therefore, we systematically tested both inferences using flat priors32,63 (equal probability for all states, the default option in most R packages) and a prior with root state frequencies same as equilibrium64 (we denote such variants with the eq suffix, for example, ARDeq is the implementation of the ARD model with equilibrium root prior), for all models except ER (equilibrium=equal frequencies) and the unidirectional models (root state implied by the model).  #@NEW_LINE#@#  Although the ARD model might seem more realistic than the more restrictive variants listed above, it may be very difficult to estimate all transition rates accurately, especially for multistate characters.  #@NEW_LINE#@#  Thus, we tested the fit of these models using the Akaike Information Criterion corrected for sample size, which allowed us to select the model that best fits the data while minimizing the number of parameters65.  #@NEW_LINE#@#  We here report the ML results from the best-fit model.  #@NEW_LINE#@#  ', 'Bayesian ancestral state reconstruction analyses allowed us to explore three sources of uncertainty not accounted for in ML analyses: transition rate uncertainty, phylogenetic uncertainty and dating uncertainty57.  #@NEW_LINE#@#  In addition, the rjMCMC approach allowed us to explore model uncertainty56.  #@NEW_LINE#@#  This approach is particularly useful where model space is very large, such as for multistate discrete characters (see Supplementary Methods).  #@NEW_LINE#@#  Each rjMCMC analysis was run in BayesTraits for 10M generations, sampling parameters and ancestral states for 15 key nodes every 100 generations, and starting with an exponential hyperprior with a mean on a uniform interval from 0 to 1.  #@NEW_LINE#@#  Apparent stationarity was checked in Tracer 1.6 (ref.  #@NEW_LINE#@#  66).  #@NEW_LINE#@#  Discarding the first 1M generations as burn-in was sufficient for all analyses and effective sample size values were nearly always very high (above 200), except for a few particular traits characterized by frequent jumps of the chain between very different models.  #@NEW_LINE#@#  ', 'Here, we report the results from these three analyses at each focal node in the form of the most parsimonious state(s), the most likely state (that is, with highest marginal likelihood), and the state with highest mean probability, respectively (Supplementary Data 1).  #@NEW_LINE#@#  For the latter (Bayesian rjMCMC), we also report the 95% CI for the probability of the state.  #@NEW_LINE#@#  In several cases, these CIs are very wide, with probabilities ranging from ca.  #@NEW_LINE#@#  0 to 1.  #@NEW_LINE#@#  Such intervals indicate strong uncertainty in ancestral state reconstructions, where MP and ML can be misleading in showing artificial precision and confidence in the reconstructed ancestral state.  #@NEW_LINE#@#  For this reason, we refer mostly to the rjMCMC results in this paper and call for caution in interpretation of our results where CIs are very wide.  #@NEW_LINE#@#  However, for most traits, nodes and trees, the three approaches reconstructed the same ancestral state and rjMCMC CIs were narrow (Supplementary Data 1 and Supplementary Discussion).  #@NEW_LINE#@#  ', 'Correlation analyses', 'As flowers are highly complex and integrated structures, floral traits are unlikely to evolve independently from one another25,26,27,28,29,30.  #@NEW_LINE#@#  Although our main goal was not to evaluate the level of morphological integration in flowers, it is possible that such correlations might impact ancestral state reconstructions.  #@NEW_LINE#@#  However, in contrast to recently developed multivariate approaches for continuous characters67,68,69, no comparative method exists yet to account for the potential correlation of more than two discrete characters, unless a drastic simplification of model space is made25.  #@NEW_LINE#@#  In addition, correlated models and analyses have typically been developed for binary characters56,60.  #@NEW_LINE#@#  The stochastic mapping approach to correlation tests allows inclusion of multistate characters, but does not model character correlation and starts at the outset by reconstructing ancestral states independently at all nodes70; it was thus not relevant to our specific objective here.  #@NEW_LINE#@#  Therefore, we tested correlations among all possible pairs of binary floral traits in our data set.  #@NEW_LINE#@#  To do so, we first removed redundancies for multiple versions of the same character (Supplementary Methods), and then transformed all multistate characters into binary characters by maintaining the hypothesized ancestral state for the angiosperms as one state and pooling the remaining states as another (for example, for the number of perianth whorls, we analysed one-two whorls versus more than two whorls).  #@NEW_LINE#@#  We thus obtained a new set of 22 presumably independent characters and analysed all 231 pairwise correlations among these characters (Table 1).  #@NEW_LINE#@#  Given our observation that reconstructed ancestral states in the single-trait analyses were remarkably consistent across the 10 series of phylogenetic trees (see Supplementary Discussion), we conducted all of our correlation analyses using the C series of trees, which best reflects the current consensus on higher-level angiosperm phylogeny and allows us to take into account phylogenetic uncertainty.  #@NEW_LINE#@#  ', 'As for our single-trait analyses, we used both an ML and a Bayesian rjMCMC approach to test for correlations and their impact on reconstructed ancestral states, using again the rayDISC function of corHMM 1.18 (ref.  #@NEW_LINE#@#  55) in R54 for ML analyses and BayesTraits 2 (ref.  #@NEW_LINE#@#  58) for rjMCMC analyses.  #@NEW_LINE#@#  The ML approach allowed us to test the fit of a small set of combined Markov models (that is, with 4 × 4 Q matrices to model all possible transitions among the four possible combined states, excluding dual transitions), including correlated (dependent) and uncorrelated (independent) models60.  #@NEW_LINE#@#  Specifically, for each character pair, we fitted four correlated models (ARDnodual, ARDnodualeq, differing only in the root state prior: see above; SYMnodual, SYMnodualeq) and three uncorrelated models (ERnodual, UNCORRnodual, UNCORRnodualeq; UNCORRnodual corresponds to the most general, 4-parameter independent model from ref.  #@NEW_LINE#@#  56).  #@NEW_LINE#@#  Using Akaike Information Criterion corrected for sample size, we selected the best-fit model and compared the ancestral combined states reconstructed with those obtained in our single-trait analyses (Supplementary Data 2).  #@NEW_LINE#@#  As a measure of support for correlation, we report the cumulative Akaike weight of correlated models (Table 1).  #@NEW_LINE#@#  The rjMCMC approach allowed us to explore the vast space of the 21,146 possible Markov combined models for the evolution of two binary characters, sampling models according to their posterior probability56, with settings as above (10M generations, sampling every 100 generations).  #@NEW_LINE#@#  As for single-trait analyses, the ancestral states reconstructed using this approach integrate over model, parameter, tree and dating uncertainty, as measured by the CIs associated with the probability (proportional likelihood) of each state (Supplementary Data 2).  #@NEW_LINE#@#  Support for correlation is here measured by the Bayes Factor comparing the dependent models to the independent models, rewritten as the ratio of the posterior to the prior odds of the two models56: BFDI=P(MD|D)/P(MI|D)/(2114651)/51, where P(MD|D) and P(MI|D) are the sampling frequencies of dependent and independent models, respectively.  #@NEW_LINE#@#  ', 'Data availability', 'Summary (MCC) BEAST trees are provided as Supplementary Data 312 and a complete list of morphological data records and references (extracted from PROTEUS) is provided as Supplementary Data 13.  #@NEW_LINE#@#  Additional trees and data files are available from the authors on request.'  #@NEW_LINE#@#  


