article id="http://dx.doi.org/10.1038/NCOMMS15459"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Digital logic circuits in yeast with CRISPR-dCas9 NOR gates  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
'Natural genetic circuits enable cells to make sophisticated digital decisions.  #@NEW_LINE#@#  Building equally complex synthetic circuits in eukaryotes remains difficult, however, because commonly used components leak transcriptionally, do not arbitrarily interconnect or do not have digital responses.  #@NEW_LINE#@#  Here, we designed dCas9-Mxi1-based NOR gates in Saccharomyces cerevisiae that allow arbitrary connectivity and large genetic circuits.  #@NEW_LINE#@#  Because we used the chromatin remodeller Mxi1, our gates showed minimal leak and digital responses.  #@NEW_LINE#@#  We built a combinatorial library of NOR gates that directly convert guide RNA (gRNA) inputs into gRNA outputs, enabling the gates to be wired together.  #@NEW_LINE#@#  We constructed logic circuits with up to seven gRNAs, including repression cascades with up to seven layers.  #@NEW_LINE#@#  Modelling predicted the NOR gates have effectively zero transcriptional leak explaining the limited signal degradation in the circuits.  #@NEW_LINE#@#  Our approach enabled the largest, eukaryotic gene circuits to date and will form the basis for large, synthetic, cellular decision-making systems.'  #@NEW_LINE#@#  

Introduction  #@NEW_LINE#@#  
'Living cells make decisions based on information processing genetic programmes.  #@NEW_LINE#@#  Many of these programmes execute digital functions1,2,3,4,5,6,7,8.  #@NEW_LINE#@#  The capability to build synthetic digital systems in living cells could allow engineers to build novel decision-making regulatory networks for use in a variety of applications9, ranging from gene therapies that modify cell state based on sensed information10,11 to entirely new developmental programmes for tissue engineering12,13.  #@NEW_LINE#@#  In electronics a compositional approach has allowed the construction of digital circuits of great complexity to be quickly designed and implemented.  #@NEW_LINE#@#  Here, we have developed set of low-variability genetic parts that can be routinely composed to create large digital circuits in yeast cells.  #@NEW_LINE#@#  ', 'Genetic components that implement simple logical operations, which in principle could be interconnected to form complex logic functions, have been demonstrated14,15,16,17,18,19,20,21,22,23.  #@NEW_LINE#@#  DNA-binding domains (DBDs) such as zinc fingers and TALEs (transcription activator-like effectors) have been used to construct libraries of transcription factors in eukaryotes19,24,25,26,27.  #@NEW_LINE#@#  However, scaling with DBDs in eukaryotes has been difficult because of challenges in synthesizing libraries of orthogonal parts28,29.  #@NEW_LINE#@#  Libraries of DBD-based parts have been shown in prokaryotes, but extensive part characterization and computer-aided design (CAD) was necessary to identify part combinations that yielded functional logic circuits22.  #@NEW_LINE#@#  Recently, programmable and orthogonal CRISPR-dCas9 transcription factors have been employed18,20,30,31,32,33,34 to build up to five component circuits using dCas9-mediated repression in prokaryotes18.  #@NEW_LINE#@#  Transcriptional repression in these circuits is likely due to steric hindrance of RNA polymerase by dCas9.  #@NEW_LINE#@#  Although dCas9 allows for programmable interconnections, its response function is leaky leading to signal degradation when layered18.  #@NEW_LINE#@#  Site-specific recombinases have been employed in genetic circuits as a means to reduce leak35,36,37, but there are a limited number of such enzymes restricting the scalability of this approach.  #@NEW_LINE#@#  Here, we address these issues, advancing the art of engineering living digital circuits by focusing on two main engineering goals.  #@NEW_LINE#@#  ', 'First, we built a universal, single-gene NOR logic gate; the NOR gates are functionally complete38 and as such can be composed to implement any logic function.  #@NEW_LINE#@#  Crucially, the input and output signals of our gates have the same molecular types while still being programmable so that, as in electronics, gates can be wired together.  #@NEW_LINE#@#  To achieve this, we made use of the CRISPR-dCas9 system: the signals in our framework are guide RNAs (gRNAs) whose sequences specifically match up to programmable target sequences on our NOR gate promoters.  #@NEW_LINE#@#  ', 'Second, we required a consistent OFF state for our NOR gates.  #@NEW_LINE#@#  To achieve this, we used the chromatin remodelling repression domain Mxi1 to take advantage of the eukaryotic cells ability to repress gene expression, by fusing this domain to dCas9 (ref.  #@NEW_LINE#@#  30).  #@NEW_LINE#@#  The Mxi1 domain is thought to recruit histone deacetylases39,40, and with it we observed strong transcriptional repression in our circuits.  #@NEW_LINE#@#  The strong and consistent OFF behaviour we observe with our NOR gates is a key factor that allows them to be composed into larger circuits by minimizing accumulation of transcriptional leak with every added layer.  #@NEW_LINE#@#  A mathematical model of our NOR gates predicts that they have effectively no transcriptional leak in their OFF states.  #@NEW_LINE#@#  We show that with low leak there exist parameters that allow our NOR gates to be composed without significant signal degradation.  #@NEW_LINE#@#  More importantly, we show experimentally that we can build a variety of digital logic circuits composed of up to five NOR gates and seven internal gRNA wires, as well as cascades of gates with up to seven layers that still have digital responses according to our specifications.  #@NEW_LINE#@#  ', 'In summary, we developed low-variability single-gene NOR gates that can be regularly interconnected into arbitrary topologies that implement large digital circuits in yeast cells.  #@NEW_LINE#@#  Neither meticulous characterization of individual parts nor sophisticated design tools were necessary to find combinations of NOR gates that conferred functional circuits.  #@NEW_LINE#@#  Because the technology is essentially generic and easy to rewire, it can in principle be used to implement arbitrary internal logic for a variety of synthetic cellular decision-making systems, such as those being explored for diagnostics11,41, therapeutics41,42 and development43,44.'  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
'NOR gate architecture', 'We built a universal, single-gene logic gate, in our case a NOR gate (Fig 1a).  #@NEW_LINE#@#  The NOR gate outputs are then gRNAs that match the target sequences on other NOR gate promoters (Fig 1b).  #@NEW_LINE#@#  Our NOR gates are genomically integrated into yeast cells (Fig 1c).  #@NEW_LINE#@#  We avoided using RNA polymerase (Pol) III promoters to express gRNAs20,30,31,34 because they have low expression levels relative to Pol II promoters and are more difficult to engineer45,46.  #@NEW_LINE#@#  By programming the NOR gate input target sequences and output gRNA sequences in a set of gates, we were able to construct a variety of circuit topologies (Fig 1d).  #@NEW_LINE#@#  ', 'Figure 1: Schematic of the NOR gate architecture and circuit composition.  #@NEW_LINE#@#  (a) A NOR gate input stage consists of a Pol II pGRR promoter that is fully repressed by the binding of either one or both of its cognate gRNA-dCas9-Mxi1 complexes.  #@NEW_LINE#@#  The output stage of the NOR gate is a gRNA transcript, flanked by self-cleaving ribozymes (RGR).  #@NEW_LINE#@#  Cleavage sites are indicated by red arrows.  #@NEW_LINE#@#  The cleavage of the ribozymes prevents nuclear export of the gRNA, indicated by dotted grey arrow.  #@NEW_LINE#@#  (b) The process of NOR gate library construction.  #@NEW_LINE#@#  Our library consists of a set of 400 two-input pGRR promoters and 20 RGR outputs for a total of 8,000 possible NOR gates.  #@NEW_LINE#@#  (c) Genomically integrating NOR gates into S. cerevisiae.  #@NEW_LINE#@#  (d) Arbitrary circuits are constructed by integrating multiple NOR gates into a single strain.Full size image', 'Second, we required a consistent OFF state for our NOR gates that corresponded to complete or near complete repression of the output promoter (Supplementary Fig 1).  #@NEW_LINE#@#  we used the chromatin remodelling repression domain Mxi1 to take advantage of the eukaryotic cells ability to repress gene expression, by fusing this domain to dCas9 (ref.  #@NEW_LINE#@#  30) (Fig 2a).  #@NEW_LINE#@#  When compared with a number of repression domains, Mxi1 showed the strongest repression (Supplementary Fig 2).  #@NEW_LINE#@#  Our results suggest that such repression provides a significantly improved and more consistent OFF signal compared with repression via steric hindrance (Fig 2b), in which dCas9 is interfering with transcriptional initiation, but is not remodelling chromatin.  #@NEW_LINE#@#  A mathematical model of our NOR gates, fit to both steady-state and time response data, predicts them have effectively zero transcriptional leak in their OFF states.  #@NEW_LINE#@#  Additionally, the model predicts that repression via steric hindrance leaks more than repression via dCas9-Mxi1 (Fig 2b).  #@NEW_LINE#@#  ', 'Figure 2: Orthogonality and repression via dCas9-Mxi1.  #@NEW_LINE#@#  (a) A constitutive promoter drives expression of gRNAs paired with a combinatorial library of cognate promoters.  #@NEW_LINE#@#  Orthogonality of the gRNA guide sequences was tested by crossing the 20 pGRRi,null promoters, each expressing GFP, with the 20 gRNAi, creating 400 different strains of yeast.  #@NEW_LINE#@#  Fluorescence values of each strain were measured using flow cytometry.  #@NEW_LINE#@#  Fluorescence values from one biological replicate are displayed in the matrix.  #@NEW_LINE#@#  (b) Dose response curves are shown for repression via dCas9-Mxi1 and dCas9 repression via steric hindrance of pGRR driving GFP at three separate positions in the promoter.  #@NEW_LINE#@#  The three positions are annotated on the pGRR promoter representation.  #@NEW_LINE#@#  At all three positions, at maximal induction, dCas9-Mxi1 represses the promoter to a lower fluorescence level than dCas9 alone.  #@NEW_LINE#@#  Model fits predicted the parameter value L, representing transcriptional leak, for all curves.  #@NEW_LINE#@#  At all three positions the predicted L value is as small or smaller for dCas9-Mix1 than for steric repression.  #@NEW_LINE#@#  Error bars represent the s.d.  #@NEW_LINE#@#  of three biological replicates measured over three separate experiments.Full size image', 'Our approach allowed for the construction of the largest eukaryotic gene circuits, to the best of our knowledge, ever demonstrated (Table 1).  #@NEW_LINE#@#  ', 'Table 1 Synthetic circuit size comparison.Full size table', 'The gate NORi,j,k, with input signals ri and rj and output rk, consists of a gRNA-responsive Pol II promoter (pGRRi,j) input stage, driving an output stage, ribozyme-flanked gRNA (RGRk) (Fig 1a).  #@NEW_LINE#@#  According to NOR logic, rk is high only when both ri and rj are low.  #@NEW_LINE#@#  A signal, ri, is defined as a gRNA complexed with a dCas9-Mix1 fusion protein that confers strong transcriptional repression when bound to DNA30.  #@NEW_LINE#@#  The gRNA signals are distinguished by their unique 5 guide sequence.  #@NEW_LINE#@#  A 20-component library of signals defining r1r20 was used in this work (Supplementary Table 1).  #@NEW_LINE#@#  The pGRRi,j promoter contains two, 20 base-pair (bp) target sites that match ri and rj respectively.  #@NEW_LINE#@#  Since we designed 20 signals, there are 203=8,000 total NOR gates in the set.  #@NEW_LINE#@#  A NORi,j,k functions as a NOTj,k if the pGRRi,j contains two identical target sites, if the pGRRi,j contains only one target site from the 20 component library (pGRRi,null) or if ri is simply not used in the circuit.  #@NEW_LINE#@#  A target sequence of null refers to a pGRR that contains a target sequence that does not match any gRNA used in the containing circuit.  #@NEW_LINE#@#  ', 'Input stage promoter design', 'The pGRRi,j promoter is tightly repressed when gRNA-dCas9-Mxi1 is bound to one or both of its two 20 bp target sites.  #@NEW_LINE#@#  The core region of the pGRRi,j, the minimal pCYC1 promoter, was chosen based on its successful use with dCas9 in the past32.  #@NEW_LINE#@#  Because the promoter has relatively low expression levels and we wanted its output to have a strong ON output when not repressed, an upstream activating sequence (UAS) from the strong pGPD promoter47 was added, forming the base pGRR promoter.  #@NEW_LINE#@#  The UAS increased the unrepressed expression level of the pGRR output by approximately threefold while maintaining the same OFF state expression level in the presence of ri and rj, further separating the digital ON and digital OFF levels (Supplementary Fig 3a).  #@NEW_LINE#@#  A pGRR promoter map highlighting all relevant sequence features is included in Supplementary Fig 4.  #@NEW_LINE#@#  A library of 11 pGRRi,j promoters, with i and j chosen from the 20 guide sequences, showed limited expression variability when driving GFP, with an 18% s.d.  #@NEW_LINE#@#  from the mean (Supplementary Fig 3b) Of the 20 pGRRi,null:GFP constructs (i ranging from 1 to 20), 16 were repressed to or near the level of Saccharomyces cerevisiae autofluorescence in the presence of the corresponding signal ri (Supplementary Fig 1).  #@NEW_LINE#@#  ', 'Output stage RNA design', 'Two different RNA pol II expression methods were used in this work (Supplementary Fig 5).  #@NEW_LINE#@#  The first was an RGR design utilizing a 5 minimal hammerhead ribozyme (mHH) and a 3 hepatitis delta virus ribozyme (HDV), flanking the gRNA48.  #@NEW_LINE#@#  The second was an insulated RGR (iRGR) with the mHH replaced by an avocado sunblotch viroid (ASBV) ribozyme.  #@NEW_LINE#@#  Both designs are intended to post-transcriptionally remove nuclear export signals, the 5 cap and 3 poly-A tail49,50.  #@NEW_LINE#@#  It has been shown that RNA device folding can be insulated from surrounding sequence context through computational sequence selection51,52.  #@NEW_LINE#@#  Ten guide sequences were chosen for the RGR architecture that were computationally predicted to confer proper folding of the mHH 5 ribozyme.  #@NEW_LINE#@#  Ten more guide sequences were chosen for the iRGR context whose ASBV 5 ribozyme is predicted to fold properly regardless of guide sequence.  #@NEW_LINE#@#  We observed similar levels of dCas9-Mxi1-mediated repression with gRNAs expressed from both iRGR and RGR constructs (Supplementary Fig 6).  #@NEW_LINE#@#  Interestingly, RGR transcripts lacking a 5 ribozyme also showed dCas9-Mxi1-mediated repression.  #@NEW_LINE#@#  These results are consistent with previous studies that indicate a majority of 5 extended gRNA target sequences are processed to 20 nucleotides53.  #@NEW_LINE#@#  No significant crosstalk was observed when all r110 (RGR design) and r1120 (iRGR design) were paired with all pGRR1-20,null:GFP among noncognate pairs (Fig 2a and Supplementary Fig 7).  #@NEW_LINE#@#  Out of 20 total RGRs (RGR110 and iRGR1120) when targeted to their cognate pGRR1-20,null:GFP constructs, 16 repressed fluorescence to or near the level of autofluorescence for S. cerevisiae (Supplementary Fig 1).  #@NEW_LINE#@#  ', 'Logic circuits', 'As a demonstration of the complex circuits possible with our NOR gates, six two-input, one-output digital logic circuits were built by integrating up to five NOR gate cassettes into various selectable loci in the yeast genome (Fig 3af).  #@NEW_LINE#@#  The output of each circuit was made observable by having the last NOR gate drive the expression of GFP.  #@NEW_LINE#@#  The circuits were constructed from the 16 guide sequences of the 20-component library that exhibited the strongest repression (Supplementary Fig 1).  #@NEW_LINE#@#  The truth table for each gate was experimentally obtained by constructing four separate strains, one for each pair of possible input values, in which the corresponding gRNA input signals were expressed from constitutive promoters (Supplementary Table 2).  #@NEW_LINE#@#  ', 'Figure 3: NOR gate-based logic circuits.  #@NEW_LINE#@#  (af) Six different two-input logic circuits constructed by interconnecting NOR gates.  #@NEW_LINE#@#  For each of the four input possibilities (, +, +, and ++), a distinct strain was constructed with the corresponding inputs expressed off of constitutive promoters (for logical +), or not integrated at all (for logical ).  #@NEW_LINE#@#  Fluorescence values were collected using flow cytometry of cells growing in log phase.  #@NEW_LINE#@#  The histograms represent population fraction from three different biological replicates measured during a single experiment and were normalized so that area sums to unity.  #@NEW_LINE#@#  Fluorescence population ratios of the circuits are included in the Supplementary Table 3.Full size image', 'We observed fluorescence intensity differences in the digital ON and OFF states in various circuits.  #@NEW_LINE#@#  To distinguish circuit state, value bands for digital ON, OFF and Undefined, fluorescence values were determined with the 16 guide sequences and their cognate pGRR promoters used in circuit construction (Supplementary Fig 8).  #@NEW_LINE#@#  For the state of a circuit to be considered ON or OFF we specified that a majority of cell population fall in the expected fluorescence band.  #@NEW_LINE#@#  Population fraction tables for all circuits can be found in Supplementary Table 3.  #@NEW_LINE#@#  ', 'Circuits containing different NOR gate variants can exhibit a range of behaviours.  #@NEW_LINE#@#  For example, 15 versions of the XOR, from Fig 3e, constructed using different NOR gates exhibited a range of performance (Supplementary Fig 9).  #@NEW_LINE#@#  We hypothesize that circuit performance variations are due to expression differences in the pGRR promoters and repression efficiency variations of the gRNA in the individual NOR gates of the circuit.  #@NEW_LINE#@#  ', 'Cascades', 'To test the limits of size and complexity our NOR gate circuits can achieve inverter cascades of depth one through seven were composed with NOT gates (Fig 4a).  #@NEW_LINE#@#  The cascade of depth D was made by the addition of a NOT gate to repress the input stage of the depth D1 cascade.  #@NEW_LINE#@#  Each successive addition of a NOT gate inverter resulted in switching the behaviour of the output GFP expression.  #@NEW_LINE#@#  As seen previously with the two-input logic circuits, there is considerable variability within the ON and OFF states.  #@NEW_LINE#@#  However, circuits that are expected to exhibit ON or OFF behaviour are clearly distinguishable from one another according to our digital ON and OFF specification.  #@NEW_LINE#@#  As cascade depth increased the fluorescence levels of the OFF states for all of the odd depth cascades increased.  #@NEW_LINE#@#  Similarly, except for the cascade of depth 6, as cascade depth increased the fluorescence levels of the ON states decreased.  #@NEW_LINE#@#  This suggests a gradual degradation of circuit function as the number of layers increased.  #@NEW_LINE#@#  Similar behaviour was also observed for other repression cascades that were constructed (Supplementary Fig 10).  #@NEW_LINE#@#  Alternative versions of 6 gRNA cascades were constructed and showed variability in their levels of ON (Supplementary Fig 11).  #@NEW_LINE#@#  ', 'Figure 4: Repression cascade characterization.  #@NEW_LINE#@#  (a) Repression cascades of one to seven gRNAs.  #@NEW_LINE#@#  Cascades were created with sequential genomic integrations of NOT gates.  #@NEW_LINE#@#  The final output of each cascade is a NOT gate that expresses GFP.  #@NEW_LINE#@#  Each NOT gate represses the output of a subsequent NOT gate.  #@NEW_LINE#@#  Cascades with an even number of layers express a high level of GFP, creating a digital ON output, and odd depth cascades express low levels of GFP, creating a digital OFF output.  #@NEW_LINE#@#  Fluorescence measurements were taken using flow cytometry.  #@NEW_LINE#@#  The histograms represent population fraction from three different biological replicates measured during a single experiment and were normalized so that area sums to unity.  #@NEW_LINE#@#  Fluorescence population ratios of the circuits are included in Supplementary Table 3.  #@NEW_LINE#@#  (b) Temporal dynamics for cascades of one to four gRNAs.  #@NEW_LINE#@#  Expression of the input gRNA was induced with -estradiol.  #@NEW_LINE#@#  A model of the cascade, in which each layer is treated as a Hill function, was used to fit the data.  #@NEW_LINE#@#  The plot shows the data from one biological replicate.  #@NEW_LINE#@#  As the number of layers in the cascade increases, signal degradation and increased time to steady state is observed.  #@NEW_LINE#@#  (c) The steady-state response function for the four inducible cascades.  #@NEW_LINE#@#  Error bars represent the s.d.  #@NEW_LINE#@#  of three biological replicates measured over three separate experiments.  #@NEW_LINE#@#  (d) A representation of the model.  #@NEW_LINE#@#  The model was used to generate the fits for the steady-state and kinetic inducible cascade experiments.Full size image', 'To investigate the temporal characteristics of the inverter cascades, we analysed the kinetics of cascades of depth one through four.  #@NEW_LINE#@#  A -estradiol-inducible promoter54 was used to activate transcription of the input gRNA and GFP expression was periodically measured over the course of 30 h of log phase growth (Fig 4b).  #@NEW_LINE#@#  With increasing cascade depth, a clear delay in output response was evident, with the cascades reaching half-maximal expression at 4.1±0.5, 10.8±1.0, 12.0±1.2 and 17.8±1.0 h (residual s.d.  #@NEW_LINE#@#  deviation) for cascades of depth one through four respectively.  #@NEW_LINE#@#  The dose response curves of the four cascades were also measured after passaging cells over 5 days (Fig 4c).  #@NEW_LINE#@#  Consistent with the steady-state cascades, the induction of a gRNA targeting the input of the cascade switched the output of the cascade from OFF to ON (even depth cascades) or from ON to OFF (odd depth cascades).  #@NEW_LINE#@#  Some signal degradation with successive layers was observed (Fig 4c), suggesting a limit to the possible depth of the cascades.  #@NEW_LINE#@#  ', 'Mathematical modelling', 'A kinetic model was constructed to capture the behaviour of our synthetic cascades.  #@NEW_LINE#@#  The model combines successive Hill functions to represent simple transcription and repression associated with each gRNA-dCas9-Mxi1 signal.  #@NEW_LINE#@#  The parameters vd and kd roughly capture expression and repression strengths of the promoters driving each gRNA-dCas9-Mxi1 signal, rd.  #@NEW_LINE#@#  The parameter L represents the transcriptional leak as a percentage of the maximal expression of a given gate when maximally repressed parameters n and b capture the cooperativity of repression.  #@NEW_LINE#@#  Degradation/dilution of gRNA-dCas9-Mxi1 signals respectively (Fig 4d).  #@NEW_LINE#@#  The steady-state dose response and kinetic time course for inducible cascade data were both fit to the model (Fig 4b,c).  #@NEW_LINE#@#  Due to the different growth conditions of the steady-state and kinetic cascade experiments, two separate model fits were generated for each experiment.  #@NEW_LINE#@#  As inducible cascades were built in such a way that they shared many of the same pGRR and gRNA components (Fig 4b), parameters for the one-, two-, three- and four-layer cascades were shared between the models and fit simultaneously.  #@NEW_LINE#@#  To address potential model identifiability issues parameter values were constrained based on published biological values (Supplementary Table 4).  #@NEW_LINE#@#  The fitting results were found to correlate well with the experimental data.  #@NEW_LINE#@#  The measured 18% s.d.  #@NEW_LINE#@#  from the mean for the promoter strength values matches well with the 24% s.d.  #@NEW_LINE#@#  from the mean of the promoter strength parameters, vd (Supplementary Table 4).  #@NEW_LINE#@#  ', 'Model fits of the steady-state and time course data predict the transcriptional leak of repression due to dcas9-Mxi1, the value of L, to be effectively zero, L=0.6±0.1% (s.d.  #@NEW_LINE#@#  ), equivalent to the production of roughly one transcript every 5 to 10 cell divisions.  #@NEW_LINE#@#  The reported value of L was calculated as the average of the predicted transcriptional leak from the model fits from Fig 2b.  #@NEW_LINE#@#  To demonstrate the ability of dCas9-Mxi1 to decrease transcriptional leak compared with steric repression via dCas9, gRNA dose response curves of repression at three pGRR promoter target site positions were performed using dCas9 and dCas9-Mxi1 (Fig 2b).  #@NEW_LINE#@#  At maximal induction, dCas9-Mxi1 represses the promoter to a lower fluorescence level than dCas9 alone at all three positions.  #@NEW_LINE#@#  Repression via steric hindrance showed promoter positional variations in predicted leak parameter values.  #@NEW_LINE#@#  The observed positional variation is consistent with previous results32.  #@NEW_LINE#@#  In all three positions dCas9-Mxi1 was predicted to have the same or lower leak parameter L. These data indicate that in the context of our NOR gates, dCas9-Mxi1 confers stronger and more consistent repression than dCas9 alone.  #@NEW_LINE#@#  Alternative plots comparing dCas9 and dCas9-Mxi1 repression as a function of inducible promoter activation driving gRNA are included in Supplementary Fig 12.  #@NEW_LINE#@#  ', 'The temporal responses of the cascades were predicted from simulations using randomly sampled parameters within the range of the model fit.  #@NEW_LINE#@#  Parameter values for kinetic simulations were resampled from the model fit using the kinetic time course experimental data.  #@NEW_LINE#@#  Response times were found to rise linearly (r2=0.83) with increasing circuit depth.  #@NEW_LINE#@#  Linear regression analysis estimated the slope of the increase in response time per layer to be equal to 184.9±0.2 (s.e.m.)  #@NEW_LINE#@#  min layer1 (Fig 5a), consistent with our experimental results.  #@NEW_LINE#@#  Response delay was found to depend primarily on the degradation/dilution rate b of gRNA-dCas9-Mxi1 (Supplementary Fig 13) that controls the overall timescale of the dynamics.  #@NEW_LINE#@#  ', 'Figure 5: Model predictions and analysis of repression cascades.  #@NEW_LINE#@#  (a) Simulations of time to half-maximal response using the model.  #@NEW_LINE#@#  Increasingly layered cascades show a positive linear relationship between circuit time to half-maximal response and circuit depth, with a slope of 184.9±0.2 (s.e.m.)  #@NEW_LINE#@#  min layer1.  #@NEW_LINE#@#  The first four data points highlighted in purple are experimental data from Fig 4b.  #@NEW_LINE#@#  (b) Signal degradation, , in a cascade increases as transcriptional leak of the gates increase.  #@NEW_LINE#@#  Boxplots of  values were plotted with binned values of the leak parameter L. At values of L  less_than 1.75% the spread of performance of the cascades is significantly larger.  #@NEW_LINE#@#  The bin containing the steady-state experimentally predicted value of dCas9-Mxi1, L=0.6±0.1% (s.d.  #@NEW_LINE#@#  ), is highlighted in purple.  #@NEW_LINE#@#  The bins highlighted in orange and yellow contain the predicted L values for the steric repression measurements in Fig 2 of position 1, L=25.0%, and position 3, L=61.3%, respectively.Full size image', 'To extrapolate the model to predict the effect of leak on signal degradation for deeper cascades, cascades of various lengths were simulated, with increasing values of L, using randomly sampled parameter sets within the range of dose response experimental fits.  #@NEW_LINE#@#  Dynamic range of a cascade length D, D, was calculated for each cascade.  #@NEW_LINE#@#  Here dynamic range is defined as the log fold change of the maximal and minimal response of a cascade, .  #@NEW_LINE#@#  A log-linear relationship was found between D and D. This relationship was used to calculate the signal degradation, , representing the percent loss in dynamic range per each additional layer (Fig 5b).  #@NEW_LINE#@#  ', 'Signal degradation was found to be largely dependent on the transcriptional leak parameter, L (Fig 5b and Supplementary Fig 12).  #@NEW_LINE#@#  As leak increases, , on average, increases.  #@NEW_LINE#@#  At values of L  greater than 80%, the median value of  trends to 80%.  #@NEW_LINE#@#  At values of L  less_than 1.75%, the spread of performance of the cascades is significantly larger.  #@NEW_LINE#@#  In this range the performance of the cascade is more sensitive to other parameters in the model.  #@NEW_LINE#@#  Our estimate of leak from the dose response experiments, L= 0.6±0.1% (s.d.  #@NEW_LINE#@#  ), falls within the sensitive range, indicating the importance of utilizing well-performing NOR gates in large circuits built using our architecture.  #@NEW_LINE#@#  In addition, these data show the significance of reducing NOR gate leak when constructing larger circuits.'  #@NEW_LINE#@#  

Discussion  #@NEW_LINE#@#  
'We introduced a class of dCas9-based modular genetic NOR gates that behave digitally, have low variability and show minimal retroactivity or effects on cell growth.  #@NEW_LINE#@#  These features made these gates relatively easy to combine into Boolean logic circuits that are among the largest ever built in any organism.  #@NEW_LINE#@#  In particular, we found that most circuits in Figs 3 and 4 required that only a handful of gate combinations be screened to identify a functional design, and others required only one.  #@NEW_LINE#@#  ', 'Table 1 compares our technology with selected published circuits.  #@NEW_LINE#@#  We measured circuit complexity with a combination of two metrics: the number of gates and the number of connections among gates, allowing us to locate circuits in a two-dimensional plot (Supplementary Fig 14).  #@NEW_LINE#@#  We can calculate a complexity score using the two metrics, complexity=(gates2+connections2)1/2.  #@NEW_LINE#@#  For example, the XOR gate had five gates and four connections, producing a complexity of (52+42)1/2=6.4, while the cascade has a complexity of (72+12)1/2=9.2.  #@NEW_LINE#@#  These complexities compare well with gene circuits developed in Escherichia coli, for example.  #@NEW_LINE#@#  Our NOR gates enabled extremely simple design and construction of large gene circuits.  #@NEW_LINE#@#  Before genetic circuits can be made much larger, however, many factors that influence the size and complexity of synthetic genetic circuits must be addressed.  #@NEW_LINE#@#  ', 'First, the gates in any framework must be well behaved.  #@NEW_LINE#@#  Gates can suffer from retroactivity, where a downstream gate affects the behaviour of upstream gates to which it is not connected by design55,56,57.  #@NEW_LINE#@#  In this case it is quite difficult to design large circuits even with CAD because we may not know the source of the retroactivity, how to model it or how to design with it.  #@NEW_LINE#@#  In addition, gates can be highly variable, where the outputs levels of one gate do not match the input levels of the next.  #@NEW_LINE#@#  Electrical engineers call this an impedance mismatch.  #@NEW_LINE#@#  A recent paper22 addressed retroactivity by adding insulators to their gates.  #@NEW_LINE#@#  By meticulously characterizing the performance each gate, and using CAD, they were able to select compatible subsets of parts out of which they constructed circuits as large as those demonstrated here, despite gate variability.  #@NEW_LINE#@#  Not all of the circuits predicted to work by the CAD tool functioned correctly, possibly due to residual retroactive effects, requiring the circuits to be screened for function.  #@NEW_LINE#@#  In contrast, our gates are considerably less variable and do not seem to be confounded by retroactive effects, at least in circuits with complexities  less_than 9.0.  #@NEW_LINE#@#  In such a case and when circuit sizes are small ( less_than 20 components) circuits are easy to design by hand since any subset of components from a library is likely to yield a functional circuit.  #@NEW_LINE#@#  Thus, in our case, the design problem is easy enough that extensive part characterization and CAD tools were not necessary at the circuit level (even though CAD tools such as standard DNA editors and secondary structure predictors for RNA were used at the sequence level).  #@NEW_LINE#@#  ', 'Second, the host organism presents many unique challenges.  #@NEW_LINE#@#  Each organism can be thought of as a different computer operating system.  #@NEW_LINE#@#  Promoters, for example, in E. coli are 60 bp of DNA long, and transcriptional regulation is a fairly well-understood process58.  #@NEW_LINE#@#  In contrast, the size of promoter and regulatory regions vary widely and can range from 250 bp to 10 kb in yeast and other eukaryotes.  #@NEW_LINE#@#  Transcriptional regulation in eukaryotes is complex, involving a variety of mechanisms including chromatin remodelling59,60,61,62,63, and understanding it remains a highly active area of research64.  #@NEW_LINE#@#  Therefore, unfortunately, any genetic circuit technology designed for one kingdom of life is unlikely to be easily ported to another, especially those built on transcriptional or translational processes.  #@NEW_LINE#@#  Thus, directly comparing circuit architectures between organisms, as we did between yeast and E. coli in Table 1, is difficult.  #@NEW_LINE#@#  Nevertheless, we believe that because CRISPR-dCas9 functions in mammalian cells20,30,31,32,34,48, and the human Mxi1 repression domain has been used in synthetic contexts to regulate transcription in human cells30,39,40, our NOR gates could be ported into mammalian cells, with difficulties of strain engineering likely dominating.  #@NEW_LINE#@#  ', 'Third, the method by which circuits are constructed and the genetic tractability of the host affects progress toward building large circuits.  #@NEW_LINE#@#  For example, the circuits we present here are all singly integrated into the yeast genome, because plasmid-based systems exhibit cell-to-cell variation in copy number.  #@NEW_LINE#@#  That made the process of building and testing strains slow, costly and cumbersome and in fact limited our ability to build circuits much larger than those shown here.  #@NEW_LINE#@#  Larger circuits and large libraries of circuit variants will require that we develop, for example, one-pot assembly methods for large DNA constructs65.  #@NEW_LINE#@#  Depending on the technology, such assemblies may be more or less difficult to harness.  #@NEW_LINE#@#  For example, our circuits currently benefit from the fact that the gates are integrated into disparate genetic locations that decreases the possibility of interference between gates due to chromatin remodelling62,66 and of yeasts tendency to recombine nearby homologous regions67.  #@NEW_LINE#@#  ', 'The success or failure of different approaches to building bigger circuits may depend on how well behaved, insulated, simple and scalable the input low-level devices and gates are.  #@NEW_LINE#@#  In addition, relaxing the requirement that circuits be digital, so that analogue or mixed analogue/digital circuits can be used when appropriate, will likely open up the design space, further increasing the size of the circuits we can build so that one day they can match the size and performance of natural genetic circuits.'  #@NEW_LINE#@#  

Methods  #@NEW_LINE#@#  
'Construction of yeast strains', 'Yeast transformations were carried out using a standard lithium acetate protocol68.  #@NEW_LINE#@#  Yeast cells were made competent by growing 50 ml cultures in rich media to log growth phase, then spinning down the cells and washing with H20.  #@NEW_LINE#@#  Next, linearized DNA, salmon sperm donor DNA, 50% polyethylene glycol and 1 M LiOAc were combined with 50 l of competent cells and the mixture was heat shocked at 42 °C for 15 min.  #@NEW_LINE#@#  The cells were then spun down, supernatant was removed and they were resuspended in H2O and then plated on selective agar media.  #@NEW_LINE#@#  Transformations were done into MATa W303-1A and MATalpha W303-1B background strains.  #@NEW_LINE#@#  Matings of the MATa and MATalpha were performed by coculturing both mating types and plating the culture onto selective agar media.  #@NEW_LINE#@#  All strains and sequences used in this work are detailed in the Supplementary Data 1.  #@NEW_LINE#@#  ', 'RNA design', 'RGR and iRGR sequences were computationally designed to enable the 5 hammerhead ribozymes to fold into their target, functionally active, structures.  #@NEW_LINE#@#  ViennaRNA (RNAfold 2.1.9) was used to simulate long timescale (thermodynamic equilibrium) at an input temperature of 37 °C.  #@NEW_LINE#@#  Kinefold (kinefold_long_static_bianary 20060404) was used to simulate short timescale folding (cotranscriptional folding) with inputs of low and high polymerization rates of 25 and 50 nt s1 respectively, helix minimum free energy=6.346 kcal mol1 and folded without pseudoknots or entanglements.  #@NEW_LINE#@#  A total of 12 Kinefold simulations were run for each candidate sequence and agglomerated to generate average folding trace data.  #@NEW_LINE#@#  ', 'Ribozyme target structures needed for both viennaRNA and Kinefold simulation evaluation were determined by folding ribozyme sequences (Minimal HH: 5- NNNNNNCTGATGAGTCCGTGAGGACGAAACGAGTAAGCTCGTCNNNNNN-3 ASBV1: 5-GGGACGGGCCATCATCTATCCCTGAAGAGAC GAAGGCTTCGGCCAAGTCGAAACGGAAACGTCGGATAGTCGCCCGTCCC-3) using RNAfold and Kinefold (melt and anneal of 1 min), respectively.  #@NEW_LINE#@#  RGR targeting sequences and iRGR insulating sequences were screened in specific 5 promoter contexts (pGAL1min: 5-AGTATCAACAAAAAATTGTTAATATACCTCTATACT TTAACGTCAAGGAGAAAAAACTATACGGATTCTAGAACTAGTGGATCTACAAA-3, pAHD1: 5-CAAGCTATACCAAGCATACAATCAACTATCTCATATACAGGATTCTAGAA CTAGTGGATCTACAAA-3, pCYC1: 5-ACTATACTTCTATAGACACACAAACACAAATACACACACTAATCTAGATATTGGATTCT AGAACTAGTGGATCTACAAA-3) and in the 3 context of the targeting sequence and the gRNA handle sequence (gRNA handle: 5-GTTTTAGAGCTAGAAATAGCAAGTTAAAATAAGGCTAGTCCGTTATCAACTTGAAAAAG TGGCACCGAGTCGGTGCTTTT-3).  #@NEW_LINE#@#  ', 'Randomly generated 20 bp candidate targeting sequences for RGR, of which the most 5 6 bp defined the closing stem of the minimal HH ribozyme, were folded in the context of each promoter to confirm that the target structure was present in the MFE structure (viennaRNA) and that the target structure was present at  greater than 90% in the RNA folding trace at both low and high polymerase rates (Kinefold).  #@NEW_LINE#@#  Targeting sequences that enabled correct folding in the context of each promoter were considered successful.  #@NEW_LINE#@#  For iRGRs, randomly generated 5 and 3 insulating sequences were designed for each of the three promoter types and were screened for function in the same manner.  #@NEW_LINE#@#  However, to select for the most robust insulating sequences, each was screened against 75 randomly generated and 10 randomly generated 20 bp guide sequences using viennaRNA and Kinefold, respectively.  #@NEW_LINE#@#  ', 'Cytometry', 'Fluorescence intensity was measured with a BD Accuri C6 flow cytometer equipped with a CSampler plate adapter using excitation wavelengths of 488 and 640 nm and an emission detection filter at 533 nm (FL1 channel).  #@NEW_LINE#@#  A total of 10,000 events above a 400,000 FSC-H threshold (to exclude debris) were recorded for each sample with and core size of 22 mm using the Accuri C6 CFlow Sampler software.  #@NEW_LINE#@#  Cytometry data were exported as FCS 3.0 files and processed using the flowCore R software package and custom R scripts (Supplementary Software 1) to obtain the mean FL1-A value at each data point.  #@NEW_LINE#@#  ', 'Data collection for orthogonality matrix', 'Cytometry readings were taken with cultures inoculated into synthetic complete with cells from freshly struck out on agar.  #@NEW_LINE#@#  Colonies were picked from plates and grown for 3 h at 30 °C before reads were taken.  #@NEW_LINE#@#  ', 'Data collection for logic circuits and static cascades', 'Cytometry measurements were taken on cells grown in cultures diluted 1:1,000 from saturated culture for 16 h at 30 °C.  #@NEW_LINE#@#  ', 'Data collection for inducible cascades', 'Cells from saturated culture were diluted 1:100 into fresh media with a Beta Estradiol (e) concentration of 100 nm.  #@NEW_LINE#@#  Cytometry measurements were taken over an 30 h period.  #@NEW_LINE#@#  During the time course, cells were periodically diluted to keep them in log growth phase.  #@NEW_LINE#@#  Experimental data collected for steady state were measured for four strains, each containing four different e-inducible cascades.  #@NEW_LINE#@#  Each of the four strains was induced with 18 different doses of e ranging from 0 to 100 M in a single batch of 72 cultures.  #@NEW_LINE#@#  Cells were diluted every 815 h to prevent culture saturation.  #@NEW_LINE#@#  Steady-state fluorescence readings were taken after 5 days when the cultures were in log phase.  #@NEW_LINE#@#  ', 'Model description', 'A deterministic model of our system was described by three ordinary differential equations characterizing transcription, degradation and repression.  #@NEW_LINE#@#  The gRNA-dCas9-Mxi1 and green fluorescent protein (GFP) molecular constituents were modelled as follows:', '', '', 'rd is the concentration of the dth gRNA-dCas9-Mxi1, d ranges from 1 to D1, where D is the number of layers in the cascade; rD is the input gRNA driven by the inducible promoter; vd is the promoter strength driving each rd in terms of the maximum steady-state concentration of gRNA from the promoter; G is the measurable normalized concentration of GFP; b is the degradation/dilution rate of all rd; B is the degradation/dilution for GFP; kd is the repression strength of rd to its cognate promoter, in terms of the number of repressors required to suppress a promoter to half strength; to its cognate promoter is modelled with kd, the number of repressors required to suppress a promoter to half-strength; and n is a Hill coefficient.  #@NEW_LINE#@#  For the transfer function, V, K, nu respectively represent the maximum transcription, MichaelisMenten constant and Hill coefficient of the inducible promoter; u is the input e in M. Concentration is rescaled as the MichaelisMenten constant or the number of gRNAs required to suppress a NOT gate to half-maximal.  #@NEW_LINE#@#  Note that the model makes the assumptions that (1) there is no crosstalk between gRNA components, (2) Mxi1 represses transcription completely with no transcriptional leak and (3) dCas9-Mxi1 bind quickly and irreversibly to gRNA.  #@NEW_LINE#@#  ', 'Fitting procedure', 'Parameters were optimized using differential evolution followed by minimization using the BFGS (BroydenFletcherGoldfarbShanno) algorithm69.  #@NEW_LINE#@#  For the steady-state experiments, optimal parameter fits for the parameters v0ssv3ss, k0ssk3ss, Vss, nss were generated from three separate experiments.  #@NEW_LINE#@#  For each of the three experiments, 17 parameter fits were generated using differential evolution/BFGS and means were calculated for a total of 51 steady-state parameter sets.  #@NEW_LINE#@#  The means from each experiment were used to determine the experimental error () for estimating each parameter (Supplementary Table 4).  #@NEW_LINE#@#  For the kinetics experiments, five parameter fits for v0kineticsv3kinetics, k0kineticsk3kinetics, b, B, Vkinetics, nkinetics were generated from a single experiment (Supplementary Table 4).  #@NEW_LINE#@#  As there were only data for a single kinetics experiment, experimental errors for the kinetic parameter values were not calculated.  #@NEW_LINE#@#  Parameters K and nu were determined in a separate experiment by driving a YFP with the pGALZ4 -estradiol inducible; this promoter is the same promoter used in the inducible cascades.  #@NEW_LINE#@#  The kinetics and steady-state parameter sets were resampled in downstream analyses to generate Monte Carlo simulations of longer repression cascades (Supplementary Software 1).  #@NEW_LINE#@#  ', 'Model predictions', 'Long repression cascades of 1 to 11 (D  {1  11}) layers were simulated using the system of ordinary differential equations.  #@NEW_LINE#@#  Parameters for simulated cascades were generated by resampling parameter sets generated during the fitting procedure.  #@NEW_LINE#@#  For the kinetic model predictions, 10,000 simulated cascades were generated by resampling parameters from 5 parameter sets estimated from the kinetics experiment.  #@NEW_LINE#@#  The time-to-half max of GFP (G) was calculated for each cascade length D and plotted in Fig 5a.  #@NEW_LINE#@#  For the signal degradation () predictions in Fig 5b, 100,000 simulated cascades of length D=7 were simulated by resampling parameters from the 51 parameter sets estimated from the 3 steady-state experiments.  #@NEW_LINE#@#  To compare L versus , L was sampled from a uniform distribution between 0 and 1.  #@NEW_LINE#@#  Signal degradation () was calculated as the percent change in dynamic range per additional layer.  #@NEW_LINE#@#  The dynamic range at each layer d in a cascade of length D was calculated as:', '', 'Dynamic range was found to have a log-linear relationship with the length of the cascade, and hence the average slope between d versus log(d) was calculated using linear regression for each of the 100,000 simulations of cascades of length D by:', '', 'with D=7.  #@NEW_LINE#@#  With  being the change in log(d) with each additional layer, the percent loss in dynamic range per layer or signal degradation  is calculated as', '', 'Values for L were binned using a bin size of 0.035 and  versus L was plotted to generate Fig 5b.  #@NEW_LINE#@#  ', 'Data availability', 'No data sets were generated during the current study.  #@NEW_LINE#@#  All data values supporting the experimental conclusions are shown either in main or Supplementary Figures (source data and DNA are available from corresponding author).  #@NEW_LINE#@#  A list of strains and sequences used for plasmids constructed are included in Supplementary Data 1.  #@NEW_LINE#@#  Custom software used in this work is available in Supplementary Software 1.'  #@NEW_LINE#@#  


