article id="http://dx.doi.org/10.1038/ncomms10996"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Computations of uncertainty mediate acute stress responses in humans  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
'The effects of stress are frequently studied, yet its proximal causes remain unclear.  #@NEW_LINE#@#  Here we demonstrate that subjective estimates of uncertainty predict the dynamics of subjective and physiological stress responses.  #@NEW_LINE#@#  Subjects learned a probabilistic mapping between visual stimuli and electric shocks.  #@NEW_LINE#@#  Salivary cortisol confirmed that our stressor elicited changes in endocrine activity.  #@NEW_LINE#@#  Using a hierarchical Bayesian learning model, we quantified the relationship between the different forms of subjective task uncertainty and acute stress responses.  #@NEW_LINE#@#  Subjective stress, pupil diameter and skin conductance all tracked the evolution of irreducible uncertainty.  #@NEW_LINE#@#  We observed a coupling between emotional and somatic state, with subjective and physiological tuning to uncertainty tightly correlated.  #@NEW_LINE#@#  Furthermore, the uncertainty tuning of subjective and physiological stress predicted individual task performance, consistent with an adaptive role for stress in learning under uncertain threat.  #@NEW_LINE#@#  Our finding that stress responses are tuned to environmental uncertainty provides new insight into their generation and likely adaptive function.'  #@NEW_LINE#@#  

Introduction  #@NEW_LINE#@#  
'Stress has broad ranging physiological consequences1.  #@NEW_LINE#@#  Although acute stress is often characterized as a challenge to homeostasis, the precise features of the environment that contribute to the generation of stress responses are largely unknown.  #@NEW_LINE#@#  Understanding the computations that underlie acute stress responses is important for insight into how stress relates to adaptive behaviour, potentially illuminating links between stress and disease, and facilitating treatment of stress-related disorders2.  #@NEW_LINE#@#  ', 'Extant work suggests that unpredictability and uncontrollability are central features of stressful experiences3,4,5,6,7.  #@NEW_LINE#@#  Classic experiments in rodents demonstrate that rats exposed to a series of electric shocks show attenuated stress responses if they are able to predict or control the timing of a stressor8, with subsequent work in humans documenting increased pain and stress in response to unpredictable stimuli9,10,11.  #@NEW_LINE#@#  However, such experiments typically contrast conditions of complete unpredictability to those of complete predictability4.  #@NEW_LINE#@#  Such binary comparisons do not capture the dynamic nature of uncertainty, which varies as an organism learns about and interacts with its environment12.  #@NEW_LINE#@#  Furthermore, stress affects learning13, suggesting that reduction of uncertainty may be a function of stress responses.  #@NEW_LINE#@#  Previous approaches have thus left several key questions unanswered.  #@NEW_LINE#@#  ', 'First, it remains to be demonstrated whether the subjective and autonomic responses to acute stressors track fluctuations in uncertainty over time, which would imply a link between the processes underpinning learning and those of stress control.  #@NEW_LINE#@#  Second, it is unclear whether such responses relate to objective unpredictability or whether they are entrained to subjective estimates of uncertainty.  #@NEW_LINE#@#  If so, interindividual variation in assessment of uncertainty might provide insight into the considerable variation in acute stress responses across individuals14.  #@NEW_LINE#@#  Finally, recent work has demonstrated that individuals track separable forms of uncertainty during learning15, and it is unclear which form of uncertainty is important for driving subjective and autonomic responses to acute stressors16.  #@NEW_LINE#@#  ', 'To address these questions, we here adopt a subject-specific Bayesian model of decision making to track distinct forms of uncertainty and examine their relationship to acute stress responses during an aversive learning paradigm (Fig 1).  #@NEW_LINE#@#  Uncertainty can be parsed into several distinct forms17,18, for which there exists a variety of theoretical and neurobiological evidence12,15,19,20.  #@NEW_LINE#@#  For example, forecasters predicting the performance of a football team over the coming season face several distinct sources of uncertainty when formulating their predictions.  #@NEW_LINE#@#  First, there is irreducible uncertainty, which captures a chance slip by a goalkeeper or a fortuitously mis-struck shot.  #@NEW_LINE#@#  Irreducible uncertainty reflects the randomness inherent to any complex environment.  #@NEW_LINE#@#  Irreducible uncertainty might increase if it begins to rain, decreasing the accuracy with which players move.  #@NEW_LINE#@#  Second, after a series of summer signings, it may be unclear how good a team is, producing uncertainty about the probability of a team winning each match.  #@NEW_LINE#@#  As the season progresses, this estimation uncertainty falls as the strengths and weaknesses of the team become evident, although it may vary with local dips and surges in form.  #@NEW_LINE#@#  A third source of unpredictability in this context is managerial instability.  #@NEW_LINE#@#  Assuming the manager influences performance, uncertainty about how long the current manager will remain in charge makes it harder to predict performance.  #@NEW_LINE#@#  This volatility uncertainty is about the stability of the context.  #@NEW_LINE#@#  To appreciate this, compare the stability in English football of Arsenal Football Club (1 manager for the last 18 years) to the famous volatility of Newcastle United (19 managers over the same period).  #@NEW_LINE#@#  ', 'Figure 1: Task structure and stress measures.  #@NEW_LINE#@#  (a) Learning task.  #@NEW_LINE#@#  Visual stimuli (rocks) were probabilistically associated with outcomes (snake or no snake).  #@NEW_LINE#@#  Subjects made a prediction of the outcome on each trial.  #@NEW_LINE#@#  The appearance of a snake was accompanied by the delivery of a painful electric shock.  #@NEW_LINE#@#  (b) Example trial.  #@NEW_LINE#@#  Here the participant incorrectly predicts no snake.  #@NEW_LINE#@#  Timing was jittered; see Methods.  #@NEW_LINE#@#  (c) The probabilities governing stimulusoutcome relationships shifted unpredictably over time, producing fluctuations in uncertainty.  #@NEW_LINE#@#  (d) Subjective stress ratings were collected every four to six trials.  #@NEW_LINE#@#  Measures of skin conductance (n=45) and pupil dilatation (n=22) were collected in some subjects.Full size image', 'To dissect the role of these three forms of uncertainty in acute stress, we utilized an hierarchical Bayesian perspective21 (Fig 2a).  #@NEW_LINE#@#  Importantly, the model is fit individually to each subject, with two free parameters ( and ) capturing variation between individuals and allowing for divergence between subjective and objective uncertainty.  #@NEW_LINE#@#  In this framework, beliefs at several levels of a probabilistic hierarchy are represented as Gaussian distributions characterized by means and variances, the latter quantities corresponding to uncertainty.  #@NEW_LINE#@#  This naturally captures the sources of uncertainty described above: irreducible uncertainty resulting from probabilistic relationships between predictors and outcomes, estimation uncertainty resulting from imperfect knowledge of those probabilistic relationships, and volatility uncertainty reflecting potential environmental instability17.  #@NEW_LINE#@#  How these different forms of uncertainty contribute to subjective and autonomic responses to acute stressors is unknown.  #@NEW_LINE#@#  ', 'Figure 2: Modelling of learning and stress.  #@NEW_LINE#@#  (a) Hierarchical Gaussian Filter model21.  #@NEW_LINE#@#  Beliefs are represented in probability distributions organized in a hierarchy, with the speed of updating at each level influenced by the estimate at the level above.  #@NEW_LINE#@#  This allows learning to occur more quickly in volatile environments.  #@NEW_LINE#@#  Each level is Gaussian, characterized by a mean () and a variance (), which corresponds to uncertainty.  #@NEW_LINE#@#  These representations unfold over time, with the model furnishing an estimate at each level, for each trial.  #@NEW_LINE#@#  We take these dynamic representations of uncertainty from this model (b) and use them to predict stress responses (c) using linear modelling (d).  #@NEW_LINE#@#  The resultant regression coefficients (1n) quantify the influence of each form of uncertainty on that stress measure.  #@NEW_LINE#@#  Note that X1n are the regressors in the linear model, which include but are not limited to uncertainty trajectories; we also include terms such as number of shocks, and nuisance variables such as gaze co-ordinates.Full size image', 'We evaluated the contribution of different forms of uncertainty to subjective and physiological stress responses, using a commonly employed acute stressor over which we had precise control, electric shock22,23,24,25.  #@NEW_LINE#@#  Participants completed a probabilistic learning task (Fig 1) in which electric shocks were delivered with varying predictability.  #@NEW_LINE#@#  On each trial, a stimulus (rock A or rock B) was presented and participants were asked to predict whether or not there was a snake underneath (snake or no snake).  #@NEW_LINE#@#  Each time a snake was presented, participants received a painful electric shock to the hand.  #@NEW_LINE#@#  We used a computational model of learning21 (Fig 2a) to estimate the dynamic fluctuations in uncertainty experienced by each individual based on the predictions they made.  #@NEW_LINE#@#  Although the sluggish dynamics of endocrine responses preclude a detailed analysis of the relationship between cortisol release and uncertainty26, we measured salivary cortisol levels by way of confirmation of our stress induction.  #@NEW_LINE#@#  We complemented this slow measure with high-frequency assessments of subjective stress and sympathetic arousal, which vary on a timescale equivalent to the forms of uncertainty in which we are interested.  #@NEW_LINE#@#  This allowed us to examine the online evolution of stress responses rather than merely their delayed endocrine consequences, which may have distinct determinants and function27,28.  #@NEW_LINE#@#  As acute stress involves the co-ordinated action of emotional, physiological and motivational systems29, we measured subjective stress ratings, pupil diameter and skin conductance (Fig 1d) throughout the task.  #@NEW_LINE#@#  Pupil diameter and skin conductance provided established measures of activity in the autonomic nervous system, a key effector of acute stress responses30,31,32.  #@NEW_LINE#@#  We found that all three were predicted by subjective irreducible uncertainty.  #@NEW_LINE#@#  We further examined interindividual variance in the degree of coupling between uncertainty and stress responses, which we related to the ability of participants to learn in an uncertain dynamic environment.'  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
'Unpredictable aversive threat induces stress', 'On each trial, participants (n=45) were shown one of two rocks and asked to predict whether or not there was a snake underneath (Fig 1a,b).  #@NEW_LINE#@#  Participants were explicitly informed of the reciprocal probabilities linking the two stimuli:', '', 'The probabilistic mapping from stimulus (rock) to outcome (snake) shifted over the course of the experiment (Fig 1c), requiring participants to track this relationship over time.  #@NEW_LINE#@#  When an outcome was revealed, the presence of a snake was deterministically associated with an electric shock delivered to the back of the left hand.  #@NEW_LINE#@#  Over the course of 320 trials, the probabilistic mapping between stimuli and outcomes changed every 2638 trials, requiring participants to maintain and update their beliefs about the probability of a snake being under either rock.  #@NEW_LINE#@#  Participants chose correctly on 68% of trials on average.  #@NEW_LINE#@#  Our use of electric shock proved an effective elicitor of cortisol release.  #@NEW_LINE#@#  A SkillingsMack test (used to account for non-normality and missing data, see Methods) confirmed that cortisol concentrations changed over the course of the experiment (Skillings Mack T7=18.48, P=0.010).  #@NEW_LINE#@#  Paired tests indicated that this was due to an elevation of cortisol above baseline 20 min after the first shocks were received (Wilcoxon rank sum, Z=2.20, P=0.028), in line with the typical time course of endocrine responses26,28,33.  #@NEW_LINE#@#  ', 'Hierarchical Bayesian learning explains predictions of shock', 'We compared the performance of three learning models in explaining the predictions that participants made on each trial, defining our model space by reference to a recent study using a similar prediction paradigm15.  #@NEW_LINE#@#  The simplest was a RescorlaWagner model34, in which beliefs are updated by prediction errors with a fixed learning rate.  #@NEW_LINE#@#  Our second model, the Sutton K1 (ref.  #@NEW_LINE#@#  35), allows the learning rate to vary as a function of recent prediction errors.  #@NEW_LINE#@#  The third model was a three-level Hierarchical Gaussian Filter (HGF)21 in which beliefs are updated via prediction errors, with learning rates influenced by uncertainty about the veracity of current beliefs and environmental stability (Fig 2a).  #@NEW_LINE#@#  The HGF is hierarchical in the sense that learning occurs simultaneously on multiple levels.  #@NEW_LINE#@#  We consider a three-level model, as this has been shown to describe learning in a similar task where tonepicture associations were learned in a non-stressful context15.  #@NEW_LINE#@#  ', 'The first level of the HGF constitutes participants predictions for each trial, the second level represents beliefs about probabilities that give rise to those predictions, and the third level quantifies the estimated volatility of the probabilities.  #@NEW_LINE#@#  On each trial, the model provides an estimate for each level, before the outcome is revealed and the estimate updated accordingly.  #@NEW_LINE#@#  Circumflexes (^) are used to distinguish the pre-update estimates from the updated versions.  #@NEW_LINE#@#  The model is Gaussian in that predictions at each level are represented by a Gaussian distribution, described by its mean, , and variance, , with i denoting the level in question (1, 2 or 3 in our model).  #@NEW_LINE#@#  The variance  represents the uncertainty of the estimate at each level.  #@NEW_LINE#@#  As previously alluded to, the first-, second- and third-level variance (, and ) correspond to irreducible, estimation and volatility uncertainty, respectively.  #@NEW_LINE#@#  Updates of beliefs at each level occur via prediction errors that propagate upwards and are weighted by the ratio of the uncertainty of the level that generated them to the uncertainty of the level being updated, a form of precision weighting15.  #@NEW_LINE#@#  ', 'We compared these three models (RescorlaWagner; Sutton K1; HGF) in a Random-Effects Model Comparison36, using tools freely available online37 (Fig 3a).  #@NEW_LINE#@#  We found that the HGF was the best model by a considerable margin (model frequency=82%, exceedance probability 1).  #@NEW_LINE#@#  This is a close replication of the aforementioned study in which tonepicture associations were learned in a non-stressful context15.  #@NEW_LINE#@#  Having ascertained that the HGF was the model that best explained the predictions made by our participants, we proceeded to examine the distribution of fitted model parameters across the population.  #@NEW_LINE#@#  Fitting of the HGF allows for variance between individuals15,21, which in this instantiation is expressed by two parameters:  and .  #@NEW_LINE#@#  is a constant component of the learning rate at the second level, capturing variability in how rapidly people update their beliefs.  #@NEW_LINE#@#  determines the rate of update of the third level; this parameter can be understood as capturing metavolatility, with higher values implying a belief in a less stable world (Fig 2a).  #@NEW_LINE#@#  ', 'Figure 3: Assessing models of learning.  #@NEW_LINE#@#  (a) Random-Effects Bayesian Model Comparison confirmed that the Hierarchical Gaussian Filter (HGF) outperformed fixed-learning-rate models (RescorlaWagner) and variable-learning-rate non-Bayesian models (Sutton K1).  #@NEW_LINE#@#  (b) Life stress was assessed with a Perceived Stress Scale38.  #@NEW_LINE#@#  Life stress scores were correlated with the metavolatility parameter () in the HGF, suggesting that more stressed individuals believe the world to be less stable (n=41; Spearman =0.38, P=0.014).Full size image', 'We found that individuals metavolatility parameter correlated with levels of chronic stress, as assessed by a questionnaire measure of life stress, the Perceived Stress Scale38 (Fig 3b; Spearman =0.39, P=0.014; non-parametric statistics used due to non-normality of  (KolmogorovSmirnov test, P less_than 0.001)).  #@NEW_LINE#@#  This suggests that people who report higher levels of life stress behave as if they believe that the environment is more uncertain, indicating that chronic stress levels may be affected by prior exposure to environments of high uncertainty.  #@NEW_LINE#@#  This confirms that interindividual variability in stress relates to variability in beliefs about uncertainty, as expected if stress responses are tuned by exposure to uncertainty in the real world.  #@NEW_LINE#@#  Having established a relationship between beliefs about uncertainty and a static subjective measure of chronic stress, we next addressed the coupling between uncertainty trajectories and dynamic stress measures.  #@NEW_LINE#@#  ', 'Current irreducible uncertainty predicts subjective stress', 'Having found that the HGF was the appropriate model of learning in our task, we asked how the dynamic quantities represented in this model related to acute stress responses.  #@NEW_LINE#@#  In fitting the HGF to each participant, we obtained estimated trajectories of surprise (absolute prediction errors) and uncertainty over time (Fig 2b).  #@NEW_LINE#@#  To assess the influence of surprise and uncertainty on subjective stress, we fit multiple regression models (Fig 2d) to subjective stress ratings for each participant (example trajectory shown in Fig 4a).  #@NEW_LINE#@#  We compared the ability of four different models to predict stress ratings.  #@NEW_LINE#@#  All four models incorporated the previous stress rating and the number of shocks received since the last rating.  #@NEW_LINE#@#  Our predictions therefore took the following form:', 'Figure 4: Irreducible uncertainty predicts subjective stress.  #@NEW_LINE#@#  (a) Example subjective stress trajectory for one participant (blue) and irreducible uncertainty estimates for that individual (red).  #@NEW_LINE#@#  (b) Comparison of regression models of subjective stress.  #@NEW_LINE#@#  All models shared two components: the value of the previous rating and the number of shocks delivered since the last rating.  #@NEW_LINE#@#  The surprise model summed the surprise (|1|) for each outcome since the previous rating, while models 13 included the estimated uncertainty at each level of the Hierarchical Gaussian Filter at the time of rating.  #@NEW_LINE#@#  Irreducible uncertainty () provided the best fit to our participants (n=45).  #@NEW_LINE#@#  (c) Irreducible uncertainty predicts prediction response times.  #@NEW_LINE#@#  A curve describing the variance of a Bernoulli distribution representing beliefs about probabilities, corresponding to irreducible uncertainty, predicts average response times (Pearson r=0.99, P less_than 0.001).  #@NEW_LINE#@#  (d) The winning regression model predicting subjective stress responses (mean r2=0.25).  #@NEW_LINE#@#  Shocks and irreducible uncertainty both predicted subjective stress ratings (single-sample t-tests, P less_than 0.001; P=0.0024).  #@NEW_LINE#@#  Error bars represent s.e.m.Full size image', '', 'Here k represents the rating number (165), and i(k) is the trial number (1320) associated with rating k (ratings occurred on average every 46 trials).  #@NEW_LINE#@#  Hence, the shock term is the number of shocks received since the last subjective stress rating.  #@NEW_LINE#@#  ', 'Our first model summed the surprise experienced by a participant since the last rating, as captured by the variable 1 in the HGF.  #@NEW_LINE#@#  The other three regression models quantified the uncertainty represented at each level of the HGF: irreducible uncertainty (), estimation uncertainty () and volatility uncertainty ().  #@NEW_LINE#@#  ', 'Subjective stress responses were best predicted by a model incorporating solely the current level of irreducible uncertainty (; model frequency=41%, exceedance probability=0.849; Fig 4b).  #@NEW_LINE#@#  The resultant model is depicted in Fig 4d.  #@NEW_LINE#@#  As predicted, participants reported being most stressed when they believed the current state was high in irreducible uncertainty.  #@NEW_LINE#@#  All parameters were significantly greater than zero (single-sample t-tests on parameters from multiple regression: previous rating =0.25, t44=7.60, P less_than 0.001; shocks =0.074, t44=3.58, P less_than 0.001; irreducible uncertainty =0.099, t44=3.22, P=0.0024).  #@NEW_LINE#@#  We found no evidence for a model of subjective stress featuring multiple forms of uncertainty (Supplementary Fig 1A).  #@NEW_LINE#@#  In addition, we found that the estimates of subjective irreducible uncertainty furnished by the HGF provided better predictions of subjective stress than the objective irreducible uncertainty on each trial (Supplementary Fig 1B,C).  #@NEW_LINE#@#  ', 'Subjective irreducible uncertainty is highest in our task when the subjects estimated probability of a shock is 50%, corresponding to a situation where the environment is utterly unpredictable, and maximal in entropy17,18.  #@NEW_LINE#@#  There is an inverted-U relationship between irreducible uncertainty and probability, according to the variance of a Bernoulli distribution (uncertainty=probability × (1probability)).  #@NEW_LINE#@#  This relationship was also reflected in participants behaviour, in that they were slowest making decisions under conditions of maximal uncertainty (Fig 4c; Pearson correlation, r=0.99, P less_than 0.001).  #@NEW_LINE#@#  ', 'We found that subjective stress responses are predicted by the trajectory of irreducible uncertainty experienced by each individual.  #@NEW_LINE#@#  The link between subjective and physiological indices of stress is problematic, with proposals that stress responses should exhibit coherence29 not well supported by extant data39.  #@NEW_LINE#@#  Consequently, we next asked whether irreducible uncertainty also predicts physiological arousal, examining its relationship with two standard physiological stress measures, pupil diameter and skin conductance (Fig 2c).  #@NEW_LINE#@#  ', 'Physiological stress reflects uncertainty and surprise', 'As a first step in gaining insight into the role played by uncertainty, we epoched physiological responses (pupil diameter, n=22; skin conductance, n=37; see Methods) by trial, starting 2 s before an outcome was revealed.  #@NEW_LINE#@#  On the basis of evidence that pupil diameter and skin conductance reflect surprise40, and building on our finding that subjective stress responses are predicted by irreducible uncertainty, we implemented median splits, separating trials according to whether they were high or low in irreducible uncertainty and high or low in surprise.  #@NEW_LINE#@#  This resulted in four groupings (high/high, high/low, low/high and low/low).  #@NEW_LINE#@#  Taking the average across participants, we observed that uncertainty increased pupil diameter throughout the trial (Fig 5a), with an additional, positive effect of surprise 2 s after outcome presentation.  #@NEW_LINE#@#  The time course of skin conductance responses was similar, albeit slower (Supplementary Fig 2A).  #@NEW_LINE#@#  Two-way analysis of variance demonstrated that both pupil diameter and skin conductance were increased by irreducible uncertainty (pupil: F1,21=22.56, P less_than 0.001, 2=0.051; skin conductance: F1,36=9.36, P=0.004, 2=0.104) and surprise (pupil: F1,21=20.71, P less_than 0.001, 2=0.045; skin conductance: F1,36=12.40, P=0.001, 2=0.070), with no interaction (pupil: F1,21=0.51, P=0.48; skin conductance: F1,36=0.14, P=0.71).  #@NEW_LINE#@#  ', 'Figure 5: Physiological responses reflect uncertainty and surprise.  #@NEW_LINE#@#  (a) Median splits indicate that both irreducible uncertainty and surprise increase pupil diameter (both P less_than 0.001).  #@NEW_LINE#@#  Shading is s.e.m.  #@NEW_LINE#@#  across participants.  #@NEW_LINE#@#  (b) Baseline pupil diameter and skin conductance on each trial displayed a clear inverted-U relationship with belief, as seen for subjective stress.  #@NEW_LINE#@#  A curve describing the variance of a Bernoulli distribution fit well (Pearson correlations: pupil diameter: r=0.96, P less_than 0.001; skin conductance: r=0.84, P=0.002).  #@NEW_LINE#@#  Error bars represent s.e.m.  #@NEW_LINE#@#  (c) A multiple regression model demonstrated a role for uncertainty throughout the trial for both pupil diameter (robust regression =0.11, single-sample t-test, t21=4.72, P less_than 0.001) and skin conductance (robust regression =0.044, single-sample t-test, t36=2.25, P=0.031).  #@NEW_LINE#@#  Error bars represent s.e.m.  #@NEW_LINE#@#  (d) Across subjects, the sensitivity of subjective stress to irreducible uncertainty correlated with the sensitivity observed in pupil diameter (Pearson correlation, n=22, r=0.52, P=0.013) and skin conductance (Pearson correlation, n=37, r=0.38, P=0.021) models.  #@NEW_LINE#@#  Each data point is one participant.Full size image', 'Within the framework of our model, information about uncertainty on the current trial is available to the subject before the trial begins, as it is computed on the basis of trial history21.  #@NEW_LINE#@#  Consequently, we asked whether baseline pupil diameter and skin conductance, as assessed at the start of each trial, reflected the subjective belief of probabilities on that trial, as represented in our learning model.  #@NEW_LINE#@#  We found that baseline arousal displayed an inverted-U relationship with belief, strikingly reminiscent of the relationship between reaction time and belief (compare Figs 4c and 5b).  #@NEW_LINE#@#  To confirm this relationship, we show that a curve fit to the variance of a Bernoulli distribution, describing the relationship between irreducible uncertainty and belief, captured this relationship well (Pearson correlations, pupil: r=0.96, P less_than 0.001; skin conductance: r=0.84, P=0.002).  #@NEW_LINE#@#  ', 'To examine more precisely this relationship between uncertainty, surprise and skin conductance, we employed a model-based approach (Fig 2d), convolving response functions for pupillary41 and skin conductance42 responses with our predictors (see Methods for full details of model and Supplementary Fig 3 for details of pupillary response function).  #@NEW_LINE#@#  We included surprise as a regressor in our models to ensure that responses to uncertainty were independent of the surprise at outcome (Supplementary Fig 2B).  #@NEW_LINE#@#  We found that the level of irreducible uncertainty on each trial was a significant predictor of both pupil diameter (robust regression =0.11, single-sample t-test t21=4.72, P less_than 0.001) and skin conductance (=0.044, t36=2.25, P=0.031; Fig 5c).  #@NEW_LINE#@#  ', 'Finally, we asked whether the sensitivity of physiological stress to uncertainty related to that inferred from reported subjective stress responses.  #@NEW_LINE#@#  We took the magnitude of the regression coefficients () for irreducible uncertainty from our models of pupil diameter and skin conductance, and compared them with the equivalent terms from our subjective stress model.  #@NEW_LINE#@#  In both cases, the two were positively correlated (Pearson correlation, pupil: r=0.52, P=0.013; skin conductance: r=0.38, P=0.021; Fig 5d) such that individuals whose subjective reports were more sensitive to uncertainty also showed a greater impact of uncertainty upon their physiological stress responses.  #@NEW_LINE#@#  This concordance between emotional and physiological state is predicted by theories of emotion43, although direct evidence for this relationship is rare44.  #@NEW_LINE#@#  Our computational perspective on the cognitive dynamics of stress responses reveal a strong coherence between emotional and physiological systems, although we note that the sensitivity of the two physiological measures was not themselves correlated (Supplementary Fig 4).  #@NEW_LINE#@#  ', 'Uncertainty tuning of stress predicts performance', 'We hypothesized that if the tuning of stress responses to uncertainty is adaptive, the degree of coupling between uncertainty and stress responses would predict how well participants performed in our task.  #@NEW_LINE#@#  We found this was indeed the case, as both subjective (Pearson correlation, r=0.37, P=0.012) and pupillary (Pearson correlation, r=0.62, P=0.0023) sensitivity to uncertainty predicted task performance (Fig 6a,b).  #@NEW_LINE#@#  Thus, the degree to which stress responses track irreducible uncertainty in the environment predicts learning under uncertain threat, in accordance with an adaptive account of stress responses under uncertainty.  #@NEW_LINE#@#  No such relationship was evident between gross measures of stress such as the mean or variance of stress ratings, highlighting the utility of our model-based approach (Supplementary Fig 5).  #@NEW_LINE#@#  We also observed a negative relationship between intolerance of uncertainty and pupil diameter (Supplementary Fig 6).  #@NEW_LINE#@#  ', 'Figure 6: Relationship between uncertainty sensitivity and task performance.  #@NEW_LINE#@#  (a) Subjective stress sensitivity (the regression coefficient for uncertainty in the subjective stress model) correlated with how frequently participants predicted the correct outcome (Pearson correlation, n=45, r=0.37, P=0.012).  #@NEW_LINE#@#  (b) Pupillary sensitivity to uncertainty also predicted performance (Pearson correlation, n=22, r=0.62, P=0.0023).  #@NEW_LINE#@#  Each data point is one participant.Full size image'  #@NEW_LINE#@#  

Discussion  #@NEW_LINE#@#  
'Stress responses are co-ordinated physiological and behavioural responses to environmental challenges1.  #@NEW_LINE#@#  The precise features of the environment that generate stress have proved hard to pin down, particularly within a quantitative framework.  #@NEW_LINE#@#  Here we reveal a strong relationship between stress and subjective estimates of a quantifiable property of the environment, namely, irreducible uncertainty.  #@NEW_LINE#@#  This demonstrates that computational models of learning can provide quantitative metrics of environmental and psychological variables that drive emotional and physiological stress responses.  #@NEW_LINE#@#  In the present case, this highlights a striking relationship between a specific form of uncertainty and stress responses.  #@NEW_LINE#@#  ', 'We built on recent progress in computational modelling of subjective well being45, to inform a dissection of subjective stress responses.  #@NEW_LINE#@#  This was made possible by a hierarchical Bayesian model that allowed us to infer the trajectory of uncertainty experienced by each individual in our experiment.  #@NEW_LINE#@#  The use of computational models has proved indispensable in exploring the relationship between stress, genotype and behaviour46, but has not to our knowledge previously been applied to understand the genesis of stress responses.  #@NEW_LINE#@#  Our finding that such models can be used to link subjective uncertainty and stress responses adds to a growing consensus that detailed quantitative models are indispensable for the understanding of complex biological and mental phenomena47,48,49,50.  #@NEW_LINE#@#  ', 'Having identified that irreducible uncertainty best predicted subjective stress responses, we next asked whether physiological responses were similarly predicted by uncertainty.  #@NEW_LINE#@#  Pupil diameter is a readout of central arousal thought to relate to noradrenergic activity in the locus coeruleus51.  #@NEW_LINE#@#  Recent evidence suggests that locus coeruleus firing correlates with pupil diameter in the macaque monkey, and that stimulation of the locus coeruleus is sufficient to induce changes in pupil diameter52.  #@NEW_LINE#@#  Although noradrenergic dynamics are crucial in orchestrating acute stress responses53 as well as their behavioural54 and mnemonic55 impact, pupillometry is not typically employed in studies of stress (though see Henckens et al.  #@NEW_LINE#@#  for a notable exception).  #@NEW_LINE#@#  This is surprising given that pupillary response metrics provide insight into emotional31 and cognitive dynamics41,56,57.  #@NEW_LINE#@#  Our finding that pupil diameter reflects the surprise associated with an outcome, regardless of valence, replicates previous results56,57,58.  #@NEW_LINE#@#  Furthermore, we also find a correlation between pupil diameter and the current level of irreducible uncertainty, with greater pupil diameter associated with higher levels of uncertainty.  #@NEW_LINE#@#  In rewarding environments, pupil diameter has been shown to reflect estimation uncertainty and, as we find here, irreducible uncertainty, often referred to as risk56,57.  #@NEW_LINE#@#  ', 'A recent study examining individual differences in aversive learning found a post-outcome pupillary sensitivity to volatility58.  #@NEW_LINE#@#  The authors found that learning-rate malleability in the face of changing volatility was related to trait anxiety.  #@NEW_LINE#@#  We additionally establish a link between chronic stress states and beliefs of environmental volatility (Fig 2c).  #@NEW_LINE#@#  However, the stimulusoutcome contingencies used in the previous study kept irreducible uncertainty roughly constant, precluding the comprehensive characterization of multiple forms of uncertainty and the relation to the dynamics of emotional and physiological stress responses that we perform here.  #@NEW_LINE#@#  Our finding that pre-outcome pupil diameter correlates with irreducible uncertainty, and that this modulation is proportional to the effect of uncertainty on subjective stress, is uniquely enabled by our design, and not inconsistent with the volatility sensitivity observed previously.  #@NEW_LINE#@#  ', 'Fluctuations in skin conductance depend on activity in the sympathetic nervous system42, a key component of physiological stress responses53.  #@NEW_LINE#@#  Our finding that skin conductance tracks uncertainty chimes with findings using the Iowa Gambling Task, in which participants make choices between decks of cards that produce rewards and punishments of varying magnitudes.  #@NEW_LINE#@#  Greater skin conductance responses are elicited whenever participants choose a card from the pack with higher risk, as defined by the variance of the outcome distribution59.  #@NEW_LINE#@#  However, binary choices in static environments do not reveal whether skin conductance truly reflects uncertainty or instead some aspect of the decision process.  #@NEW_LINE#@#  Our results suggest that even in non-instrumental settings, somatic state relates closely to uncertainty in the environment.  #@NEW_LINE#@#  Furthermore, we show that these responses are dynamically driven by evolving internal estimates of irreducible uncertainty.  #@NEW_LINE#@#  ', 'Our multiple stress measures reflect the view that stress is a multidimensional construct, expressed through subjective and physiological channels43.  #@NEW_LINE#@#  Some theoretical accounts highlight the importance of coherence between stress systems in response to a challenge29, although discordance between the amplitude of physiological and subjective stress responses is rife (reviewed by Campbell and Ehlert39).  #@NEW_LINE#@#  This is in part because the stressors typically used in laboratory experiments with humans, such as social stress, are difficult to parameterise, precluding a detailed quantitative analysis.  #@NEW_LINE#@#  Conversely, using a quantitative computational approach, we show that emotional and physiological stress responses track uncertainty and are correlated within individuals.  #@NEW_LINE#@#  We do not claim that ours are exhaustive metrics of stress, nor that chronic stress necessarily behaves similarly to the acute stress examined here.  #@NEW_LINE#@#  Establishing how acute stress accumulates to produce allostasis60, and what effects such allostasis exerts on subsequent acute stress responses, is a major challenge for the field.  #@NEW_LINE#@#  ', 'An integrated understanding of normal brain function and its perturbation in disease will require detailed analysis at multiple levels of description, from behavioural to cellular.  #@NEW_LINE#@#  Here we provide a computational account of acute stress responses in humans.  #@NEW_LINE#@#  Dysfunction of stress response systems is common to many psychiatric disorders2, suggesting that a computational decomposition of stress responses of the kind provide here may prove a fruitful addition to the nascent field of computational psychiatry61.'  #@NEW_LINE#@#  

Methods  #@NEW_LINE#@#  
'Participants', 'All experiments were approved by the University College London Ethics Review Board.  #@NEW_LINE#@#  Participants (n=45, 25 females, aged 1935 years) were recruited via the UCL Institute of Cognitive Neuroscience recruitment mailing list, and gave their written informed consent before beginning any experiments.  #@NEW_LINE#@#  All participants were healthy, with no history of neurological or psychiatric disorders, and no family history of epilepsy.  #@NEW_LINE#@#  Sample size was based on recent experiments involving stress33.  #@NEW_LINE#@#  ', 'Task', 'Participants initially underwent a shock thresholding procedure (see below).  #@NEW_LINE#@#  Participants then received thorough instruction (see below) that made explicit the structure of the task, and completed a practice session of 30 trials of the probabilistic learning task used in the main experiment.  #@NEW_LINE#@#  They were also familiarized with the use of the subjective stress rating scale.  #@NEW_LINE#@#  ', 'Our learning task was closely modelled on that used in a recent study leveraging the same computational framework in a non-stressful context15.  #@NEW_LINE#@#  Timings on each trial were jittered using a uniform distribution to allow us to maximally divorce physiological responses to different events.  #@NEW_LINE#@#  ', 'Each participant completed a set of 320 trials.  #@NEW_LINE#@#  On each trial, participants were presented with one of two stimuli (in our case, rocks).  #@NEW_LINE#@#  These stimuli remained on screen for 300 ms (±50 ms) before participants were asked to make a prediction, signalled with a button press, as to which outcome (snake or no snake) was likely to follow (Fig 1a,b).  #@NEW_LINE#@#  This decision was made under time pressure, with a timeout period averaging 1,000 ms (±200 ms).  #@NEW_LINE#@#  ', 'Once the decision had been made, the prediction was displayed for an average of 1,200 ms (±200 ms), before the outcome was revealed.  #@NEW_LINE#@#  Outcomes remained on screen for 1,000 ms (±200 ms).  #@NEW_LINE#@#  In the case of the snake stimulus, outcome presentation was coincident with the delivery of a shock.  #@NEW_LINE#@#  This was followed by an intertrial interval of 2,000 ms (±500 ms), during which a fixation cross was displayed.  #@NEW_LINE#@#  ', 'The probabilistic mapping from stimulus to outcome shifted over the course of the experiment (Fig 1c), requiring participants to constantly track the relationship over time.  #@NEW_LINE#@#  This resulted in fluctuations in the level of various forms of uncertainty.  #@NEW_LINE#@#  Each session of 320 trials was divided into 10 blocks of different stimulusoutcome probabilities, of lengths that varied between 26 and 38 trials.  #@NEW_LINE#@#  The transitions between these blocks were not made explicit to the subject.  #@NEW_LINE#@#  The probabilities governing each block varied from heavily biased (90/10), through moderately biased (70/30) to unbiased (50/50), allowing us to examine the effect of predictability on stress responses.  #@NEW_LINE#@#  We used four repeats each of the biased probability blocks (2 for each bias direction, that is, 70/30 and 30/70) and two repeats of the 50/50 to generate 10 blocks in total.  #@NEW_LINE#@#  ', 'Participants were paid a base rate of £10 and informed that they would receive an extra £0.05 for each correct prediction they made.  #@NEW_LINE#@#  Outcomes (correct/incorrect) were not explicitly signalled.  #@NEW_LINE#@#  Participants were allowed to take a self-timed break every 10 min.  #@NEW_LINE#@#  ', 'For 41 of the 45 subjects, we report questionnaire measures of life stress (Perceived Stress Scale, PSS).  #@NEW_LINE#@#  Data from the remaining participants were lost due to a technical error.  #@NEW_LINE#@#  Some subjects (n=23) completed questionnaires on a separate day, while the remainder (n=22) did so after the main task.  #@NEW_LINE#@#  We also collected a questionnaire measure of intolerance of uncertainty (n=43; Supplementary Fig 6), depression (Beck Depression Index), and a questionnaire related to anxiety (Mood & Anxiety Symptom Questionnaire).  #@NEW_LINE#@#  We do not report data from the latter two questionnaires here.  #@NEW_LINE#@#  ', 'Participant instruction', 'Participants were given detailed computerized instruction on the structure of the task.  #@NEW_LINE#@#  This emphasized that the accuracy of their predictions did not affect the number of shocks they received but did influence their earnings on the task.  #@NEW_LINE#@#  Understanding was confirmed with the question: How much do you earn per correct prediction?  #@NEW_LINE#@#  ', 'We also attempted to ensure good understanding of the probabilistic relationships governing stimulus:outcome relationships.  #@NEW_LINE#@#  We emphasized that the probabilities were reciprocal (p(snake|rock A)=1p(snake|rock B)), and checked for comprehension with the question: If the probability of a snake being under rock A is 40%, what is the probability of it being under rock B?  #@NEW_LINE#@#  ', 'Participants were further informed that the probabilities changed throughout the task, and that at times might appear to be random, that is, the probability of an outcome following each stimulus might be equal (50/50).  #@NEW_LINE#@#  ', 'Shock thresholding procedure', 'Electric shocks were controlled using a Digitimer DS5 system in conjunction with a National Instruments Data Acquisition Board, which allowed control of shock amplitude via Matlab (Mathworks).  #@NEW_LINE#@#  Electrodes were placed 0.5 cm apart on the first dorsal interosseous of the left hand.  #@NEW_LINE#@#  Electrode sites were cleaned with alcohol and a mild abrasive (NuPrep Skin Prep Gel).  #@NEW_LINE#@#  Shocks were delivered using BioPac Ag/AgCl electrodes filled with Sigma Spectra 360 Electrode Gel, attached using double-sided adhesive pads.  #@NEW_LINE#@#  ', 'Participants first underwent a thresholding procedure that allowed us to map their subjective sensitivity to shock.  #@NEW_LINE#@#  Thresholding consisted of a sequence of 80 shocks, with currents of magnitudes between 0.1 and 10 mA chosen according to a staircasing procedure.  #@NEW_LINE#@#  After each shock, participants were asked to report how painful it was, from a rating of 1 (not painful) to 5 (very painful).  #@NEW_LINE#@#  We used an automated thresholding procedure inspired by Gracely et al.62, in which separate staircases are used to estimate the transition points between each rating (1/2,2/3,3/4,4/5).  #@NEW_LINE#@#  For robustness, we used two independent staircases, running the QUEST thresholding algorithm63 for each transition.  #@NEW_LINE#@#  This gave a total of eight independent staircases, with trials from each staircase randomly interleaved.  #@NEW_LINE#@#  At the end of thresholding, we averaged the two estimates for the 4/5 boundary to set the shock intensity for the rest of the experiment.  #@NEW_LINE#@#  Participants were given a sample shock at this intensity and in three cases we reduced the amplitude of the experimental shock by 20% at the participants request.  #@NEW_LINE#@#  Shock sensitivity was also measured at the end of the task, and on average showed a slight decrease (single-sample t-test, t44=2.70, P=0.097, d=0.403), equivalent to an 11% reduction in subjective pain.  #@NEW_LINE#@#  ', 'Stress measures', 'Each participant was asked to make 65 subjective stress ratings at semiregular points throughout the probabilistic learning task (every 46 trials).  #@NEW_LINE#@#  These required participants to move a marker along a line to answer the question How stressed do you feel at this moment?  #@NEW_LINE#@#  (Fig 1d).  #@NEW_LINE#@#  All analyses were conducted on z-scored ratings to obviate between-subject differences in use of the scale.  #@NEW_LINE#@#  ', 'Pupil diameter was recorded in a subset of participants (n=22) using an EyeLink 1000 System (SR Research), sampled at 100 Hz.  #@NEW_LINE#@#  Participants were seated in a darkened room, and asked to maintain fixation wherever possible.  #@NEW_LINE#@#  Stimuli were luminance matched, with the no snake outcome signalled by a scrambled version of the snake picture.  #@NEW_LINE#@#  ', 'Skin conductance was recorded from the index and middle fingertips of the left hand using 8 mm BioPac AgCl electrodes.  #@NEW_LINE#@#  Electrodes were filled with a 0.5%-NaCl paste (BioPac Gel 101) and attached using double-sided adhesive pads supplemented by tape.  #@NEW_LINE#@#  We utilized a custom recording system based on the provision of a constant current between the two electrodes and the measurement of the resultant voltage, allowing calculation of the conductance of the skin (AT64, Autogenic Systems).  #@NEW_LINE#@#  This signal was converted to an optical pulse and then digitally recorded at 100 Hz in Spike2 (v6.17).  #@NEW_LINE#@#  ', 'In a subset of subjects (20), we collected saliva samples at 8 time points, from which we measured cortisol concentrations.  #@NEW_LINE#@#  To avoid baseline elevation due to anticipatory stress we collected two baseline readings (samples 1 and 2) on a separate day, on which participants were aware that no shocks would be received.  #@NEW_LINE#@#  On the day of the experiment, we collected the following samples: (3) on arrival; (4) immediately before task (15 min after shock thresholding); (5) 10 min into task; (6) 20 min into task; (7) 30 min into task; and (8) post task.  #@NEW_LINE#@#  Participants salivated through straws into 2-ml polypropylene tubes.  #@NEW_LINE#@#  Samples were frozen on the day of collection.  #@NEW_LINE#@#  Analysis was performed by Viapath at Kings College Hospital, using a competitive immunoassay.  #@NEW_LINE#@#  Briefly, cortisol in the sample competes with cortisol conjugated to horseradish peroxidase for binding sites on a microtitre plate.  #@NEW_LINE#@#  Unbound reagents are then washed away.  #@NEW_LINE#@#  Bound cortisol enzyme conjugate is measured by the reaction of the horseradish peroxidase enzyme to the substrate tetramethylbenzidine, producing a blue colour.  #@NEW_LINE#@#  A yellow colour is formed after stopping the reaction with an acidic solution.  #@NEW_LINE#@#  The concentration of cortisol in the sample is calculated as a function of the optical absorption at 450 nm; more absorption implies greater concentration of cortisol enzyme conjugate, and therefore lower concentration of cortisol in the sample.  #@NEW_LINE#@#  For further details, see Arakawa et al.64.  #@NEW_LINE#@#  Some samples were not suitable for analysis due to damage in storage (28/160).  #@NEW_LINE#@#  To accommodate for these missing values, we used a SkillingMack test to assess changes in cortisol over time.  #@NEW_LINE#@#  One subject was excluded due to baseline concentrations  greater than 3 s.d.s away from the mean (60.59 nmol l1; population mean=6.92 nmol l1; population s.d.=13.57 nmol l1).  #@NEW_LINE#@#  To verify that this did not affect our conclusions, we repeated our analyses without excluding this subject, and found comparable results.  #@NEW_LINE#@#  All data were log transformed before analysis to render data close to normal33.  #@NEW_LINE#@#  ', 'Analysis of pupil diameter', 'Data were exported using the EDF2ASC plugin, and imported as ASCII files into Matlab.  #@NEW_LINE#@#  Pupil diameter measurements were downsampled to 100 Hz, and low-pass filtered (4 Hz, third-order Butterworth)41.  #@NEW_LINE#@#  Blinks were automatically detected by the EyeLink software, and removed by linear interpolation of samples 140 ms either side of the blink.  #@NEW_LINE#@#  Data were then z-scored and detrended.  #@NEW_LINE#@#  No further artefact removal was necessary.  #@NEW_LINE#@#  ', 'Linear modelling involved a mixture of delta and boxcar regressors convolved with a canonical pupillary response function (see below for details of response functions)41.  #@NEW_LINE#@#  For phasic responses, we also convolved regressors with the first and second derivatives of the canonical response function, a standard method in magnetic resonance imaging65 designed to accommodate inaccuracies in the modelling of the amplitude and timing of induced responses.  #@NEW_LINE#@#  These were subsequently orthogonalised to their respective regressors, to apportion shared variance to the primary regressor.  #@NEW_LINE#@#  We took an additional step to remove signal due to changes in luminance, which produces pupil constrictions discernible from emotional/cognitive pupillary changes by their short latency31.  #@NEW_LINE#@#  We estimated a luminance response function for each subject on the basis of passive viewing of the images in our task (each image presented 50 times, displayed for 1,000 ms, with a jittered intertrial interval of between 9,000 and 1,100 ms).  #@NEW_LINE#@#  This provided a response function that could then be convolved with each presentation of an image, allowing us to discriminate fast, luminance-dependent constrictions from slower dilatations relating to cognitive variables (Supplementary Fig 3).  #@NEW_LINE#@#  Following convolution of predictors with their response functions, predictors were z-scored.  #@NEW_LINE#@#  Details of the full linear model can be found in Supplementary Table 1.  #@NEW_LINE#@#  ', 'Analysis of skin conductance', 'Data were first visually inspected and eight participants were rejected due to low recording quality.  #@NEW_LINE#@#  ', 'Data from the remaining 37 participants were imported and preprocessed using tools from the SCRalyze suite42.  #@NEW_LINE#@#  Data were downsampled to 10 Hz and low-pass filtered (5 Hz, first-order Butterworth).  #@NEW_LINE#@#  We used a custom artefact rejection regime based on the second differential of the signal; non-physiological signals were identified by their very rapid rate of change.  #@NEW_LINE#@#  Subjects took self-paced breaks every 10 min, which caused substantial changes in skin conductance amplitude due to movement of the arm, and so we discarded the first five trials following a break.  #@NEW_LINE#@#  The time series was then concatenated, detrended and z-scored.  #@NEW_LINE#@#  ', 'For linear models, we used a mixture of delta and boxcar regressors to represent phasic and sustained influences on skin conductance.  #@NEW_LINE#@#  These regressors were then convolved with the canonical skin conductance response function outlined in ref.  #@NEW_LINE#@#  35 and provided in SCRalyze (http://scralyze.sourceforge.net/) (see below for details of response functions).  #@NEW_LINE#@#  We utilized a variety of nuisance regressors to isolate changes in skin conductance relating to our cognitive variables of interest.  #@NEW_LINE#@#  All predictors were z-scored before modelling.  #@NEW_LINE#@#  Details of the full linear model can be found in Supplementary Table 2.  #@NEW_LINE#@#  ', 'Modelling of learning', 'We modelled learning in our task using several models.  #@NEW_LINE#@#  Three of these (RescorlaWagner, Sutton K1, Hierarchical Gaussian Filter) were implemented using the HGF toolbox (http://www.translationalneuromodeling.org/hgf-toolbox-v3-0/).  #@NEW_LINE#@#  For a full list of priors, see Supplementary Table 3.  #@NEW_LINE#@#  For details of each model, see Supplementary Table 4.  #@NEW_LINE#@#  ', 'The model that best explained our data was the HGF (Fig 2a).  #@NEW_LINE#@#  Introduced by Mathys et al.21, the HGF is a Bayesian learning model not constrained by the optimality typically assumed by such models; instead, subject-specific fitting allows for interindividual variability in learning.  #@NEW_LINE#@#  A recent functional magnetic resonance imaging study using the HGF highlighted its utility in assessing learning under uncertainty and its neural correlates15; our task and analysis were inspired by the ones used there.  #@NEW_LINE#@#  For a full description of the structure of the HGF, the reader is referred to the start of the Results section.  #@NEW_LINE#@#  ', 'The HGF was fit to each individuals choices using Variational Bayes, with two free parameters: , a metavolatility parameter that determines step size at the third level of the HGF; and, , which is a constant component of the learning rate at the second level.  #@NEW_LINE#@#  ', 'The four quantities utilized in our analyses of stress measures are all trajectories over time, with a value that evolves according to the predictions made and outcomes experienced by that subject.  #@NEW_LINE#@#  ', 'The first of these is surprise (|1| in the HGF).  #@NEW_LINE#@#  This is the difference between the observed outcome (1=snake /0=no snake) on trial k and the subjects belief about the probability of that outcome:', '', 'where 1(k) is the actual outcome (1 or 0) and s() is the sigmoid transformation of belief about probabilities before seeing the outcome, that is, the subjects expectations.  #@NEW_LINE#@#  By taking the absolute value of 1(k), we therefore obtain a quantity that represents surprise about outcomes.  #@NEW_LINE#@#  ', 'The three forms of uncertainty we consider are as follows:', ': uncertainty of predictions at the first level on trial k. Because beliefs at the first level take the form of a Bernoulli distribution, the variance is a function of the mean , namely,  × ().  #@NEW_LINE#@#  This means that uncertainty has an inverted-U relationship with belief, as depicted in Figs 3c and 4b.  #@NEW_LINE#@#  Intuitively, this form of uncertainty represents an individuals estimate of the entropy of the environment at that moment in time; that is, how surprising they expect things to be.  #@NEW_LINE#@#  We refer to it as irreducible uncertainty.  #@NEW_LINE#@#  ', ': this is a form of informational uncertainty on trial k, representing lack of knowledge about the current stimulus:outcome relationship.  #@NEW_LINE#@#  Over time and in a stable environment, this uncertainty would fall to zero as the probabilities underlying the task are learned.  #@NEW_LINE#@#  In volatile environments, however, this is not the case.  #@NEW_LINE#@#  In the HGF, this form of uncertainty is approximately equivalent to a time-varying learning rate, used to update beliefs quickly when they are uncertain and slowly when they are supported by plentiful evidence.  #@NEW_LINE#@#  We refer to it as estimation uncertainty.  #@NEW_LINE#@#  ', ': this can also be considered a form of estimation uncertainty, this time over the volatility of the environment at trial k. Again, it controls the speed of learning about volatility, weighting prediction errors from the probability space at the second level.  #@NEW_LINE#@#  We refer to it as volatility uncertainty.  #@NEW_LINE#@#  ', 'We ran an additional pair of RescorlaWagner learning models to test the validity of two assumptions made by the models in the original comparison.  #@NEW_LINE#@#  The first is that we assume participants update probabilities symmetrically on each trial: if p(outcome|stimulus 1) increases then p(outcome|stimulus 2) decreases by the same amount, as constrained by our task and explained to participants.  #@NEW_LINE#@#  To accommodate for departures from this scheme, we used a RescorlaWagner model in which the probabilities for each stimulus were updated independently.  #@NEW_LINE#@#  Second, we examined the possibility that beliefs were updated differently following trials on which shocks were delivered by fitting two learning rates (shock and noshock) for each subject.  #@NEW_LINE#@#  We then compared these two models to the original RescorlaWagner model (in which probabilities were updated symmetrically with a single learning rate).  #@NEW_LINE#@#  Bayesian Model Comparison showed that the simple model comprehensively outperformed the two variants (exceedance probability=1).  #@NEW_LINE#@#  We concluded, therefore, that the assumptions of symmetric probability updating and balanced learning across shock/no shock trials were justified.  #@NEW_LINE#@#  ', 'Modelling of stress', 'We used multiple regression models to examine the relationship between task variables, including the trajectories from the HGF outlined above, and stress responses.  #@NEW_LINE#@#  We used least-squared error to fit data from subjective ratings, using Matlab function glmfit.  #@NEW_LINE#@#  For physiological data, we used robust fitting to avoid spurious fits due to unidentified artefacts.  #@NEW_LINE#@#  These were implemented in Matlab with the function robustfit.  #@NEW_LINE#@#  In both cases, we used two-tailed t-tests to assess whether parameters were different from zero, that is, whether, at the population level, a given parameter meaningfully and consistently contributed to the dependent variable in question.  #@NEW_LINE#@#  ', 'We compared several multiple regression models to examine the effect of uncertainty on subjective stress.  #@NEW_LINE#@#  All models included parameters for the previous rating and the number of shocks received since the last rating.  #@NEW_LINE#@#  The third term varied between models, and captured the effects of absolute prediction error (model 1), and uncertainty at each level (models 24).  #@NEW_LINE#@#  ', 'Model 1: surprise.  #@NEW_LINE#@#  Model 1 omitted an explicit representation of uncertainty, but summed the absolute prediction errors (|1|, bounded 01 on each trial) since the last rating, reflecting surprise in response to outcomes given an individuals beliefs.  #@NEW_LINE#@#  ', 'Model 2: irreducible uncertainty.  #@NEW_LINE#@#  Irreducible uncertainty is the variance of the Bernoulli distribution representing subjects beliefs, captured by the HGF parameter .  #@NEW_LINE#@#  It is highest when p(outcome|stimulus 1) and p(outcome|stimulus 2) are both equal to 0.5, that is, the sequence of outcomes is totally unpredictable.  #@NEW_LINE#@#  Irreducible uncertainty is also correlated with the magnitude of surprise (surprise is on average higher in uncertain situations).  #@NEW_LINE#@#  ', 'Model 3: estimation uncertainty.  #@NEW_LINE#@#  Uncertainty about the probabilities currently governing the observed outcomes is known as estimation uncertainty.  #@NEW_LINE#@#  This is represented in the HGF by the variance of the Gaussian distribution representing beliefs at the second level, .  #@NEW_LINE#@#  ', 'Model 4: volatility uncertainty.  #@NEW_LINE#@#  Finally, we tested the hypothesis that subjective stress related to uncertainty at the third level, corresponding to uncertainty about the volatility of the generative process.  #@NEW_LINE#@#  Again, this is explicitly represented in the HGF as the variance of the Gaussian representing beliefs at the third level, .  #@NEW_LINE#@#  ', 'For physiological stress measures, we convolved predictors with canonical response functions (see below) to account for the time course of physiological responses41,42.  #@NEW_LINE#@#  ', 'Model comparisons', 'We performed two sets of model comparisons.  #@NEW_LINE#@#  In the first, we determined the best learning model to explain predictions made by the subjects, and in the second the best model for subjective stress responses.  #@NEW_LINE#@#  In each case, for each model and each subject, we took the model evidence (F-values for learning models or Bayesian Information Criterion66 for multiple regression models), and used these to assess model fit by Random-Effects Bayesian Model Selection36, as implemented in the VBA toolbox37.  #@NEW_LINE#@#  Random-Effects Bayesian Model Selection allows for heterogeneity in the population; the best model for each individual is allowed to vary, producing an estimate of model frequency in the population (that is, for how many participants that model is the best model) and an exceedance probability (the probability that the model in question is the most frequently utilized in the population).  #@NEW_LINE#@#  ', 'Response functions used in pupillary and skin conductance measures', 'We used linear modelling to elucidate the impact of different events on pupil diameter and skin conductance.  #@NEW_LINE#@#  This approach is well-established in the functional magnetic resonance imaging literature, where the use of General Linear Model (GLM) to interpret haemodynamic responses is common.  #@NEW_LINE#@#  ', 'In this approach, a response function is used to describe how the output of a system (the measured variable) relates to its inputs.  #@NEW_LINE#@#  This response function is then convolved with a representation of the putative inputs to the system, and the resultant time course is used as a predictor in the GLM.  #@NEW_LINE#@#  A common further step is to create secondary and tertiary regressors that are convolved with the first and second derivative of the response function65.  #@NEW_LINE#@#  These dispersion regressors allow for inaccuracy in the timing or form of modelled responses; we utilize this approach in our modelling of events (this is unnecessary when the modelled process is extended over time, and represented by a boxcar).  #@NEW_LINE#@#  ', 'Our response functions were drawn directly from previous studies.  #@NEW_LINE#@#  For skin conductance, we used the skin conductance response functions provided in SCRalyze (http://scralyze.sourceforge.net/), which are based on a gamma function convolved with a Gaussian kernel67.  #@NEW_LINE#@#  ', 'Response functions for pupillary dilatation were first discussed by Hoeks et al.68 and we use the response function described there, which takes the form of a gamma function:', '', 'The constants n and tmax dictate the shape of the response function.  #@NEW_LINE#@#  As advocated in the original paper, we use values of n=10.1 and tmax=930 ms; we note that a recent study using this response function41 demonstrated that this algorithm is robust to changes in the values of the constants used (see the Supplementary Information in ref.  #@NEW_LINE#@#  41).  #@NEW_LINE#@#  ', 'We took an additional step in our modelling of pupillary responses.  #@NEW_LINE#@#  As the appearance of stimuli and outcomes involved increases in luminance, they evoked light-related pupil constrictions.  #@NEW_LINE#@#  Importantly, such luminance responses are faster than the dilatations evoked by cognitive or emotional factors31.  #@NEW_LINE#@#  We accounted for light-related constrictions by convolving stimulus and outcome onsets with a luminance response function, which was fitted to each subject on the basis of a separate data set in which subjects were passively exposed to each of the image used in our experiment (see above and Supplementary Fig 3).  #@NEW_LINE#@#  The best fitting parameters were found using least-squared fitting implemented by the Matlab function fmincon.  #@NEW_LINE#@#  Calculated in this way, average n=3.6 and tmax=839 ms.', 'Statistical analysis', 'All data analysis was completed in Matlab (Mathworks).  #@NEW_LINE#@#  All statistical tests were two-sided.  #@NEW_LINE#@#  We used one-sample t-tests to test for the significance of parameters in multiple regression models, and two-way repeated-measures analysis of variance to analyse the time-course data for skin conductance and pupil diameter.  #@NEW_LINE#@#  We used Pearson correlation coefficients except in the one case in which the data were a priori not normal, having been fit in a logit space (; Fig 2c).  #@NEW_LINE#@#  In this instance, we confirmed non-normality using a KolmogorovSmirnov test, and used Spearmans Rank to assess the correlation non-parametrically.  #@NEW_LINE#@#  ', 'Code availability', 'Custom Matlab code for analysis of skin conductance and pupil diameter is available on request to the corresponding author.  #@NEW_LINE#@#  We used the HGF toolbox (http://www.translationalneuromodeling.org/hgf-toolbox-v3-0/) for modelling of learning, the VBA toolbox for model comparison (mbb-team.github.io/VBA-toolbox/), and the SCRalyze suite for preprocessing of skin conductance data (http://scralyze.sourceforge.net/).'  #@NEW_LINE#@#  


