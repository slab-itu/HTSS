article id="http://dx.doi.org/10.1038/NCOMMS11217"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Magnetic-free non-reciprocity based on staggered commutation  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
'Lorentz reciprocity is a fundamental characteristic of the vast majority of electronic and photonic structures.  #@NEW_LINE#@#  However, non-reciprocal components such as isolators, circulators and gyrators enable new applications ranging from radio frequencies to optical frequencies, including full-duplex wireless communication and on-chip all-optical information processing.  #@NEW_LINE#@#  Such components today dominantly rely on the phenomenon of Faraday rotation in magneto-optic materials.  #@NEW_LINE#@#  However, they are typically bulky, expensive and not suitable for insertion in a conventional integrated circuit.  #@NEW_LINE#@#  Here we demonstrate magnetic-free linear passive non-reciprocity based on the concept of staggered commutation.  #@NEW_LINE#@#  Commutation is a form of parametric modulation with very high modulation ratio.  #@NEW_LINE#@#  We observe that staggered commutation enables time-reversal symmetry breaking within very small dimensions (/1,250 Ã— /1,250 in our device), resulting in a miniature radio-frequency circulator that exhibits reduced implementation complexity, very low loss, strong non-reciprocity, significantly enhanced linearity and real-time reconfigurability, and is integrated in a conventional complementary metaloxidesemiconductor integrated circuit for the first time.'  #@NEW_LINE#@#  

Introduction  #@NEW_LINE#@#  
'Reciprocity in electronics or, equivalently, the principle of time reversibility in optics is a fundamental property of any linear system or material described by symmetric and time-independent permittivity and permeability tensors1.  #@NEW_LINE#@#  Non-reciprocity, however, enables new applications that span radio frequencies (RF) to optical frequencies.  #@NEW_LINE#@#  Optical isolators are critical to on-chip all-optical information processing systems for the protection of lasers and amplifiers, and the mitigation of multipath reflections.  #@NEW_LINE#@#  RF circulators enable full-duplex wireless, an emerging wireless communication paradigm that has been historically considered impractical2, where the transmitter and the receiver operate simultaneously on the same frequency band, potentially doubling network capacity at the physical layer while offering numerous other benefits at the network layer3,4.  #@NEW_LINE#@#  ', 'Non-reciprocal components today are almost exclusively realized through the magneto-optic Faraday effect (Fig 1ac)the application of a magnetic field bias parallel to the direction of propagation rotates the polarization vector of light due to the different propagation velocities of left- and right-circularly polarized waves5.  #@NEW_LINE#@#  Despite significant research efforts in the optical6,7 and RF domains8,9,10, non-reciprocal components based on magneto-optic materials remain incompatible with complementary metaloxidesemiconductor (CMOS) integrated circuit (IC) fabrication processes due to material incompatibilities and the need for a magnetic field bias, significantly restricting their impact.  #@NEW_LINE#@#  ', 'Figure 1: Comparison between non-reciprocity induced by the magneto-optic Faraday effect and staggered commutation.  #@NEW_LINE#@#  (a) A wave propagating in a Faraday-active magneto-optic material experiences no Faraday rotation in the absence of magnetic bias.  #@NEW_LINE#@#  (b) In the presence of magnetic bias in the positive z direction, a wave travelling in the positive z direction experiences Faraday rotation due to the difference in the propagation velocities of right-handed and left-handed circularly polarized waves, whereas (c) a wave travelling in the negative z direction experiences an opposite rotation.  #@NEW_LINE#@#  (d) A wave propagating through a commutated network with no staggering experiences no phase shift.  #@NEW_LINE#@#  (e) Staggered commutation acts as a bias that breaks time reversibility, producing a phase shift for waves travelling from left to right and (f) an opposite phase shift for waves travelling from right to left.Full size image', 'As early as 50 years ago, magnetic-free non-reciprocity and circulators had been investigated at microwave frequencies through the use of the inherent non-reciprocal nature of active devices such as direct-current/voltage-biased transistors11.  #@NEW_LINE#@#  More recently, metamaterials with embedded active transistors have been explored at RF and microwave frequencies12,13,14.  #@NEW_LINE#@#  However, such approaches are fundamentally limited by the noise and nonlinear distortion generated by the active transistors.  #@NEW_LINE#@#  Indeed, for non-reciprocal components used at the front end of RF communication systems (such as circulators), and for front-end components more broadly (such as filters and diplexers), passive approaches with superior linearity and noise performance are paramount15,16.  #@NEW_LINE#@#  Techniques for non-reciprocity leveraging nonlinearity17,18,19,20,21 have also been proposed.  #@NEW_LINE#@#  These techniques, although potentially useful and extensively explored in optical applications, exhibit non-reciprocity over certain signal power levels only and have limited applicability to scenarios where linearity to the signal is required, such as RF communication.  #@NEW_LINE#@#  Lorentz reciprocity may also be broken by introducing time dependency into the material or system1.  #@NEW_LINE#@#  Techniques at optical frequencies based on electro-optic phase modulators have been investigated22,23 but require complex electro-optic modulation networks.  #@NEW_LINE#@#  Approaches based on spatio-temporal parametric modulation of waveguides have been investigated24,25,26,27,28.  #@NEW_LINE#@#  In such approaches, a travelling-wave modulation of the waveguides properties produces direction-dependent mode conversion of the desired signal.  #@NEW_LINE#@#  In the optical domain, the size of the structure is limited by the weak electro-optic or acousto-optic effect24,25,26, which results in an extremely low modulation ratio (modulation ratio is defined as the ratio between the maximum and minimum values of the modulated parameter and extremely weak modulation corresponds to a modulation ratio of practically unity).  #@NEW_LINE#@#  At RF, varactors are able to achieve modulation ratios of around two to four, resulting in structures that are of the order of a wavelength27.  #@NEW_LINE#@#  A second disadvantage of these approaches is that the mode/frequency conversion is undesirable in some applications and necessitates the use of filters24 or diplexers27.  #@NEW_LINE#@#  In recent times, non-reciprocity through spatio-temporal parametric modulation of resonant rings, resulting in angular momentum biasing29, has been demonstrated in the acoustic domain30 and at RF31, resulting in magnetic-free non-reciprocal circulators at or well below the wavelength scale and with low loss32.  #@NEW_LINE#@#  A key challenge with these spatio-temporal parametric modulation approaches in general is that the property that enables modulation (for instance, varactors27,31 or opto-acoustic interactions25) often represents a nonlinearity to the signal itself, in particular when the modulation ratio is high, resulting in nonlinear distortion at higher signal levels.  #@NEW_LINE#@#  There has also been theoretical work on non-reciprocity and a microwave circulator based on parametric modulation of coupled resonators33.  #@NEW_LINE#@#  ', 'Here we introduce magnetic-free, linear and passive phase non-reciprocity based on staggered commutation and a highly-miniaturized RF circulator that embeds the phase-nonreciprocal component within a ring resonator.  #@NEW_LINE#@#  Commutation may be seen as a form of parametric modulation with very high modulation ratio (practically infinite in our prototype), making the phase-nonreciprocal component effectively a point parametric modulator.  #@NEW_LINE#@#  This enables its specific placement in the ring relative to the three circulator ports such that the signal across it is suppressed for excitations from one port, yielding significantly enhanced linearity to that port.  #@NEW_LINE#@#  Furthermore, the need for spatio-temporal modulation in the ring is eliminated, easing modulation complexity.  #@NEW_LINE#@#  Implementation complexity is further eased as no frequency conversion is seen at the circulator ports.  #@NEW_LINE#@#  In addition, when compared with prior art employing spatio-temporal parametric modulation of waveguides24,25,26,27 or electro-optic phase modulation22,23, these concepts allow miniaturization of the unmodulated ring to deeply subwavelength scales (/80 in our prototype).  #@NEW_LINE#@#  When compared with prior art employing angular-momentum biasing in parametrically modulated resonant rings31,32, linearity enhancement is achieved due to the ability to suppress the signal across the point parametric modulator, although it is interesting to consider synergies between the approaches offering the dual benefits of both.'  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
'Phase non-reciprocity through staggered commutation', 'Commutated networks are a class of linear, periodically time-varying (LPTV) networks where the signal is periodically commutated through a bank of linear, time-invariant (LTI) networks (or media as in Fig 1d).  #@NEW_LINE#@#  The first commutated networks relied on mechanical commutation through a rotating brush that periodically contacted a bank of capacitors34,35 to realize narrow comb filters around harmonics of the commutation frequency.  #@NEW_LINE#@#  More recently, electronic commutation using passive transistor-based switches has resulted in high quality-factor (Q) comb filters, commonly called N-path filters, which operate at RF, exhibit significantly lower noise and higher linearity when compared with active RF filters, are compatible with conventional CMOS IC technology and exhibit the potential to replace front-end off-chip surface acoustic wave filters for RF communication applications15,36,37,38,39,40.  #@NEW_LINE#@#  A key requirement is the availability of a high-quality switch with high ON/OFF transmission ratio (or modulation ratio when viewed as parametric modulation) and sufficient switching speed.  #@NEW_LINE#@#  Modern CMOS transistor switches boast ON/OFF conductance ratios as high as 1,000100,000 (ref.  #@NEW_LINE#@#  41), enough to be practically infinite from the perspective of commutated network operation, and switching speeds that enable such commutated networks to operate well into the RF frequency range and continuously improve with CMOS technology scaling.  #@NEW_LINE#@#  It should be emphasized that the transistors are used as reciprocal, highly linear, passive switches without direct-current bias.  #@NEW_LINE#@#  In other words, the switches cannot provide power gain to the desired signal by sourcing power from the modulating clock signals that control the commutation.  #@NEW_LINE#@#  These clocking signals that control the commutation are easily implemented in CMOS and the associated power consumption is due to the charging and discharging of parasitic capacitance in the clock path.  #@NEW_LINE#@#  This power consumption also reduces with CMOS technology scaling due to reducing parasitics.  #@NEW_LINE#@#  ', 'An interesting property of commutated networks that we observe here is that staggering the commutation on either side of the bank of LTI networks results in time-reversal symmetry breaking and phase non-reciprocity (Fig 1e,f).  #@NEW_LINE#@#  Waves travelling in the forward and reverse direction see a different ordering of the first and second commutating switches in time and experience opposite shifts in phase, essentially analogous to the magneto-optic Faraday effect.  #@NEW_LINE#@#  Here, the staggered commutation plays the role of the magnetic Faraday bias.  #@NEW_LINE#@#  ', 'When the first and second set of switches are staggered by +90Â°, forward and reverse travelling waves at or near the commutation frequency experience phase shifts of +90Â° and 90Â°, respectively.  #@NEW_LINE#@#  When a transmission line or waveguide of length 3/4 is wrapped around the staggered commutated network, non-reciprocal wave propagation is achieved as waves may propagate in only one direction (Fig 2a,b).  #@NEW_LINE#@#  In that direction, the 270Â° phase delay through the 3/4 ring adds with 90Â° phase shift of the staggered commutated network to satisfy the boundary condition, enabling wave propagation.  #@NEW_LINE#@#  In the other direction, the 270Â° phase delay adds with the +90Â° phase shift of the staggered commutated network to prohibit wave propagation.  #@NEW_LINE#@#  ', 'Figure 2: Embedding the staggered commutated network within a 3/4 transmission-line ring results in unidirectional wave propagation.  #@NEW_LINE#@#  (a) When the commutated network with +90Â° staggering is embedded in a 3/4 ring, then in one direction, the 270Â° phase delay of the ring adds to the 90Â° phase shift through the commutated network, enabling wave propagation.  #@NEW_LINE#@#  (b) In the other direction, the 270Â° phase delay adds with the +90Â° phase shift of the staggered commutated network, prohibiting wave propagation.Full size image', 'Unidirectional wave propagation not only requires phase non-reciprocity but also requires (near-)perfect transmission through the commutated network.  #@NEW_LINE#@#  In Fig 3, we examine the requirements on the media across which commutation is being performed.  #@NEW_LINE#@#  We consider electrically short transmission-line media, in line with our goal of achieving a point parametric modulator.  #@NEW_LINE#@#  In the depicted simulations, eight-way commutation is considered, the transmission-line characteristic impedance (Zmedium), wave velocity (v) and length (l) are varied, and ideal sets of switches are used for commutation at 750â€‰MHz frequency, with each switch active for 12.5% of the time period.  #@NEW_LINE#@#  With +90Â° staggering, phase non-reciprocity is always observed (phase of the scattering or S-parameters S21 and S12 at the commutation frequency always have a 180Â° difference).  #@NEW_LINE#@#  The magnitudes of S21 and S12 at the commutation frequency are always reciprocal; however, low Zmedium, low velocity v and higher lengths l are required for significant signal transmission.  #@NEW_LINE#@#  In other words, the media must have a significant capacitance, similar to the (reciprocal) comb filter implementations described earlier, which use commutation across capacitor banks without staggering.  #@NEW_LINE#@#  ', 'Figure 3: Signal transmission in a staggered commutated network.Simulated S-parameters of an eight-way staggered commutated network are depicted assuming electrically short transmission line media of varied length l, characteristic impedance Zmedium and velocity v. Ideal switches are commutated at 750â€‰MHz, with each switch active for 12.5% of the time period, and the reference impedance is assumed to be 50â€‰.  #@NEW_LINE#@#  Theoretical calculations based on the analytical formulation presented in Supplementary Note 1, where the electrically short transmission lines are approximated by their capacitance, are also shown and agree very well with simulations.  #@NEW_LINE#@#  The phases of S21 and S12 are always non-reciprocal and differ by 180Â° for 90Â° staggering.  #@NEW_LINE#@#  The magnitudes are always reciprocal; however, for substantial transmission, high l, low Zmedium and low v, or equivalently large capacitance, are required.Full size image', 'The need for capacitance may be intuitively understood by the fact with +90Â° staggering, no direct connection exists between the input and output at any instant assuming at least four paths.  #@NEW_LINE#@#  Therefore, a certain amount of capacitance is required for the media to store sufficient energy for subsequent transmission.  #@NEW_LINE#@#  A formal analysis of a commutated network with transmission-line media based on LPTV network theory is challenging.  #@NEW_LINE#@#  In Supplementary Note 1, with the aid of Supplementary Figs 1 and 2, we have completed an analysis of a staggered commutated network with N capacitors and ideal switches.  #@NEW_LINE#@#  As electrically short transmission lines are being considered, the approximation with capacitors is expected to be accurate.  #@NEW_LINE#@#  Figure 3 also depicts the magnitudes of S21 and S12 at the commutation frequency based on the exact analytical solution in Supplementary Note 1 for the case of l=80â€‰m and an excellent agreement is seen to the simulations.  #@NEW_LINE#@#  ', 'The analytical formulation quantifies the capacitance condition for substantial transmission as  where fs is the commutation frequency and Z0 is the reference impedance.  #@NEW_LINE#@#  Under this condition, at fs for +90Â° staggering, the S-parameters of the staggered commutated network reduce to', '', 'clearly showing the non-reciprocity in the phase of S21 and S12.  #@NEW_LINE#@#  The (reciprocal) magnitudes of S21 and S12 approach unity as N but even N=4 or N=8 are sufficient to achieve low loss, resulting in 1.8 and 0.45â€‰dB transmission, respectively.  #@NEW_LINE#@#  The magnitudes of S11 and S22 approach 0 for N, implying perfect impedance matching.  #@NEW_LINE#@#  ', 'A frequency up-/down-conversion and filtering-based explanation', 'The behaviour may also be explained by viewing each set of commutating switches as an in-phase and quadrature reciprocal modulator that performs a frequency up-conversion and down-conversion, similar to the approach described in prior literature33.  #@NEW_LINE#@#  Indeed, such commutating transistor-based switches are regularly used as frequency converters in RF and microwave integrated electronics42.  #@NEW_LINE#@#  Figure 4 depicts a graphical view of signal propagation through the staggered commutated network in the forward and the reverse directions.  #@NEW_LINE#@#  In each direction, a sinusoidal input signal, cos(int), is assumed at a frequency in near the commutation frequency s. Each set of switches is modelled as an in-phase and quadrature reciprocal modulator that multiplies the input signal with cosine and sine versions of the pump signal at s. The second set of pump signals (2 and 4) are assumed to lead the first set (1 and 3) by +90Â°, representing the staggering.  #@NEW_LINE#@#  The capacitances of the media are assumed to effectively form a low-pass filter in conjunction with the source and load impedances.  #@NEW_LINE#@#  The frequency translation of this low-pass filtering to RF by the commutating switches is the basis for the use of unstaggered commutated networks to realize (reciprocal) comb filters15,36,37,38,39,40.  #@NEW_LINE#@#  This low-pass filter effect substantially attenuates the up-converted signal at s+in and sin after the first modulation.  #@NEW_LINE#@#  It is seen that this leads to signal transmission with non-reciprocal phase response (+90Â°/90Â°) in the forward and reverse directions.  #@NEW_LINE#@#  It should be noted that although the up-converted frequency components are filtered away, this does not result in any power loss for the desired signal as the commutated media are purely capacitive.  #@NEW_LINE#@#  Consequently, the staggered commutated network is lossless for N, as discussed earlier (for finite N, there is loss due to harmonic conversion, albeit small even for N=4 or N=8 as discussed earlier).  #@NEW_LINE#@#  The reader may also verify that in the absence of low-pass filtering, all frequency components at the outputs cancel and the transmission of the structure in both directions is identically zero, which agrees with the theory and simulations in Fig 3 that show very weak tranmission for high Zmedium, low l and high v (that is, low capacitance in the commutated media), and our expectation given a lack of a direct connection between the input and the output.  #@NEW_LINE#@#  ', 'Figure 4: A frequency up-/down-conversion and filtering-based explanation of phase non-reciprocity in staggered commutated networks.A commutator with at least four paths can be viewed as a reciprocal in-phase and quadrature frequency up-downconverter.  #@NEW_LINE#@#  The capacitance of the commutated media acts as a low-pass filter that attenuates the up-converted components after the first commutation.  #@NEW_LINE#@#  As a result, phase non-reciprocity is seen for signals travelling in the forward and reverse directions through a staggered commutated network.  #@NEW_LINE#@#  It may be verified that in the absence of low-pass filtering, all frequency components at the outputs cancel, leading to zero transmission in either direction, which agrees with the theory and simulations in Fig 3 that show very weak transmission for high Zmedium, low l and high v (that is, low capacitance in the commutated media).Full size image', 'A comparison may be made with multi-arm optical isolators based on tandem electro-optic phase modulation22, where back-to-back phase modulation with quarter-wavelength optical delays in between results in non-reciprocity.  #@NEW_LINE#@#  In our approach, commutation is essentially amplitude modulation with very high modulation ratio.  #@NEW_LINE#@#  Staggered commutation results in phase non-reciprocity and the filtering effect that is unique to commutation across media with appreciable capacitance eliminates the need for quarter-wavelength delays, allowing the phase non-reciprocity to be achieved within dimensions as small as /1,250 Ã— /1,250 in our device.  #@NEW_LINE#@#  ', 'A highly-miniaturized RF circulator with enhanced linearity', 'A three-port circulator matched at all ports to a reference impedance of Z0 may be realized by contacting the 3/4 transmission line (also of characteristic impedance Z0) at three points as long as the three ports are spaced /4 apart along the ring circumference, as shown in Fig 5a.  #@NEW_LINE#@#  To analyse this structure, we consider the case of a voltage excitation Vin at port 1.  #@NEW_LINE#@#  Using conventional microwave circuit analysis techniques along with the S-parameters of the staggered commutated network in equation (1) for the case of N, the various node voltages can be determined to be', 'Figure 5: Circulator architecture.  #@NEW_LINE#@#  (a) A 3-port circulator may be realized by adding ports at three points along the ring as long as the circumferential spacing between the ports is /4.  #@NEW_LINE#@#  The S-parameters of such a structure match that of an ideal three-port circulator and are independent of l, the circumferential distance between port 3 and the staggered commutated network.  #@NEW_LINE#@#  (b) However, setting l to 0 suppresses the voltages across the commutated network for excitations at port 1, significantly enhancing the linearity of the structure to port 1 excitations.Full size image', '', 'where V1, V2 and V3 are the three port voltages, Vx and Vy are the voltages on the left and right sides of the staggered commutated network,  is the propagation constant of the 3/4 ring and l is the circumferential distance between port 3 and the commutated network.  #@NEW_LINE#@#  Based on these node voltages and by repeating the calculations with excitations at the other two ports, the S-parameter matrix of the structure can be derived to be:', '', 'This matches the S-parameters of an ideal 3-port circulator.  #@NEW_LINE#@#  It is interesting to note that the S-parameter matrix does not depend on l, meaning that the position of the staggered commutated network relative to ports 1 and 3 does not have an impact on Scirc.  #@NEW_LINE#@#  However, the voltages seen at the two ends of the staggered commutated network (Vx and Vy) when port 1 is excited are functions of l in equation (2).  #@NEW_LINE#@#  Interestingly, these voltages become 0 when l is 0.  #@NEW_LINE#@#  This is a direct consequence of the fact that when l is 0, Vy coincides with port 3 and naturally remains quiet for excitations at port 1 due to the isolation of the circulator (Fig 5b).  #@NEW_LINE#@#  The S-parameters of the staggered commutated network force Vx and Vy to have the same magnitude, making Vx also a quiet node (Fig 5b).  #@NEW_LINE#@#  As a result, voltage swings across the point parametric modulator are suppressed, yielding very high linearity to excitations at port 1.  #@NEW_LINE#@#  ', 'A more comprehensive analysis of the circulator may be performed using the S-parameters of the staggered commutated network in equation (1) for the case of finite N. Interestingly, for l=0, we once again arrive at the ideal S-parameter matrix of equation (3) and Vx=Vy=0 for excitations at port 1.  #@NEW_LINE#@#  This implies that when port 3 coincides with Vy, the presence of a finite number of commutated paths will not limit circulator performance.  #@NEW_LINE#@#  In the presence of finite switch ON resistance, however, there will be finite voltage swing across the commutating switches for excitations at port 1, leading to finite linearity.  #@NEW_LINE#@#  However, this linearity to port 1 excitations will be vastly superior to the linearity to excitations at the other ports that do not enjoy this suppression mechanism.  #@NEW_LINE#@#  ', 'We constructed a prototype at RF using conventional 65â€‰nm CMOS IC technology to implement the electronic commutation across a bank of N=8 capacitors, and three lumped C-L-C networks to miniaturize the 3/4 transmission line ring (Fig 6).  #@NEW_LINE#@#  Miniaturization is eased by the fact that the 3/4 ring is unmodulated, resulting in an overall structure that has a maximum dimension of /80 at the operating frequency of 750â€‰MHz.  #@NEW_LINE#@#  The capacitors of the C-L-C networks are also incorporated in the IC, leaving the three inductors as the only off-chip components.  #@NEW_LINE#@#  The commutated capacitors are chosen to be 26â€‰pF each, roughly six times  (Z0=50â€‰), and are each realized on chip as a pair of 80â€‰m Ã— 80â€‰m metalinsulatormetal capacitors.  #@NEW_LINE#@#  The total size of the staggered commutated network is 320â€‰m Ã— 320â€‰m (/1,250 Ã— /1,250).  #@NEW_LINE#@#  The control signals for the staggered commutation are generated using on-chip clock generation circuitry that is described in additional detail in the Methods section.  #@NEW_LINE#@#  ', 'Figure 6: RF CMOS IC implementation of the circulator.  #@NEW_LINE#@#  (a) A simplified circuit diagram of the circulator is shown.  #@NEW_LINE#@#  Electronic commutation across a bank of N=8 capacitors is performed using reciprocal, passive transistor-based switches without direct-current bias.  #@NEW_LINE#@#  The staggered commutated network enables miniaturization of the unmodulated 3/4 ring using three C-L-C sections.  #@NEW_LINE#@#  (b) The microphotograph of the fabricated IC is shown along with a close-up photograph of the fabricated printed circuit board with the IC housed in a quad-flat no-leads (QFN) package and interfaced with the off-chip inductors.  #@NEW_LINE#@#  The largest dimension of the prototype is 5â€‰mm or /80 at the operating frequency of 750â€‰MHz.Full size image', 'Experimental results', 'S-parameter measurements of the three-port circulator were performed using a measurement setup described in the Methods section.  #@NEW_LINE#@#  In the absence of commutation, with a pair of transistor switches on either side of the capacitor bank permanently closed, the circuit is perfectly reciprocal (Fig 7a,d,g).  #@NEW_LINE#@#  In this configuration the high reciprocal isolations from port 3 to ports 1 and 2 are seen because port 3 is shunted to ground by one of the 26-pF capacitors.  #@NEW_LINE#@#  The quarter-wave transmission lines from port 1 to the staggered commutated network and from port 2 to port 3 transform this near-short-circuit impedance to open circuits at ports 1 and 2, effectively disconnecting port 3 from the rest of the circuit and resulting in a reciprocal structure that exhibits low-loss transmission between port 1 and port 2.  #@NEW_LINE#@#  Similarly, another reciprocal configuration without commutation is depicted, where all switches are permanently open.  #@NEW_LINE#@#  Here, simple circuit analysis reveals that port 1 is effectively disconnected from the rest of the circuit, which now exhibits low-loss reciprocal transmission between ports 2 and 3.  #@NEW_LINE#@#  ', 'Figure 7: Circulator S-parameter measurements.Measured circulator S-parameters (a), (d) and (g) without commutation and (b), (e) and (h) with commutation are shown, as well as (c), (f) and (i) simulated S-parameters that show an excellent match to the measurements.  #@NEW_LINE#@#  Under staggered commutation for clockwise circulation, low loss transmission in the circulation direction (S21, S32 and S13 are 1.7, 1.7 and 3.3â€‰dB, respectively) and an order-of-magnitude isolation in the reverse direction (S12, S23 and S31 are 9.6, 10.4 and 17.4â€‰dB, respectively) are measured at the commutation frequency of 750â€‰MHz.  #@NEW_LINE#@#  When the third port is slightly tuned, non-reciprocity of 4050â€‰dB is measured in S12, S23 and S31 at 750â€‰MHz with negligible impact on transmission in the circulation direction.  #@NEW_LINE#@#  The 20â€‰dB isolation bandwidth in S31 after tuning is 32â€‰MHz or 4.3%.Full size image', 'Under commutation at a frequency of 750â€‰MHz with staggering for clockwise circulation, strong non-reciprocity is measured (Fig 7b,e,h) with low-loss transmission in the direction of circulation (S21, S32 and S13 are 1.7, 1.7 and 3.3â€‰dB, respectively, at 750â€‰MHz) and strong isolation in the reverse direction (S12, S23 and S31 are 9.6, 10.4 and 17.4â€‰dB, respectively, at 750â€‰MHz).  #@NEW_LINE#@#  This represents, on an average, an order of magnitude of non-reciprocity between any two ports and is limited by the imperfect impedance matching at the third port (as is the case with all circulators) caused due to parasitics at the chip-package-board interfaces.  #@NEW_LINE#@#  If the impedance at the third port is slightly tuned, non-reciprocity of 4050â€‰dB or four to five orders of magnitude is seen in S12, S23 and S31 at 750â€‰MHz with negligible impact on transmission in the circulation direction.  #@NEW_LINE#@#  It should be noted that independent tuning is required at the three ports to achieve very high non-reciprocity in all paths, given the inherent asymmetry in the circulator structure.  #@NEW_LINE#@#  Figure 7c,f,i depict the simulated S-parameters under commutation, demonstrating an excellent match to the measurements.  #@NEW_LINE#@#  ', 'Although the analysis in this study has restricted itself to response at the commutation frequency, it is noteworthy that a filtering profile is observed in S32 and S13 across frequency due to the comb-filter functionality inherent to commutation across a capacitor bank.  #@NEW_LINE#@#  The LPTV analysis in Supplementary Note 1 may be extended to determine the response of the staggered commutated network and the circulator across frequency, and confirms this observed (and simulated) filtering profile.  #@NEW_LINE#@#  ', 'Another unique feature of the fabricated prototype is its real-time reconfigurability.  #@NEW_LINE#@#  By changing the staggering between +90Â° and 90Â°, the direction of circulation can be altered, as is seen in Fig 8a.  #@NEW_LINE#@#  The frequency of operation of the circulator can also be tuned by changing the frequency of commutation within the limits dictated by the bandwidth of the 3/4 transmission line ring.  #@NEW_LINE#@#  In Fig 8b, four to five orders of magnitude (4050â€‰dB) of non-reciprocity in S31 is maintained across 700800â€‰MHz.  #@NEW_LINE#@#  ', 'Figure 8: Experimental evidence of reconfigurability and enhanced linearity to port 1 excitations.  #@NEW_LINE#@#  (a) The direction of circulation can be altered by changing the staggering between +90Â° and 90Â°.  #@NEW_LINE#@#  (b) The frequency of operation of the circulator can be tuned by changing the commutation frequency within the limits dictated by the bandwidth of the 3/4 transmission-line ring.  #@NEW_LINE#@#  Here we present the non-reciprocity in S31 across different commutation frequencies ranging from 700 to 800â€‰MHz.  #@NEW_LINE#@#  In each case, tuning of the port 2 impedance is exploited to achieve 4050â€‰dB isolation at the commutation frequency.  #@NEW_LINE#@#  (c) Measured two-tone linearity for transmission from port 1 to port 2 and from port 2 to port 3 are shown when configured for clockwise circulation.  #@NEW_LINE#@#  Nonlinear systems exhibit intermodulation distortion products when excited with two sinusoidal signals.  #@NEW_LINE#@#  The input-referred third-order intercept point (IIP3) represents the (extrapolated) input power of each of the two tones at which the third-order intermodulation products (IM3) at the output are as powerful as the fundamental signals.  #@NEW_LINE#@#  The IIP3 for transmission from port 1 to port 2 is +27.5â€‰dBm (560â€‰mW), nearly two orders of magnitude higher than that from port 2 to port 3 (+8.7â€‰dBm or 7.4â€‰mW), owing to the suppression of the signal across the point parametric modulator for port 1 excitations.Full size image', 'In Fig 8c, we present experimental evidence of the enhanced linearity to excitations at port 1.  #@NEW_LINE#@#  Two-tone intermodulation distortion tests were performed on the prototype for transmission from port 1 to port 2, and from port 2 to port 3.  #@NEW_LINE#@#  The input-referred third-order intercept point (IIP3) for transmission from port 1 to port 2 is +27.5â€‰dBm (560â€‰mW), a remarkable number for a 65nm CMOS IC implementation and nearly two orders of magnitude higher than that from port 2 to port 3 (+8.7â€‰dBm or 7.4â€‰mW) due to the suppression of the signal across the point parametric modulator.  #@NEW_LINE#@#  Aside from intermodulation distortion caused due to third-order nonlinearity, other spurious effects to consider include image signals due to quadrature mismatch and modulation feedthrough.  #@NEW_LINE#@#  The level of the measured spurious image signals produced due to quadrature mismatch for port 1 to port 2 transmission is 51â€‰dB below the main signal.  #@NEW_LINE#@#  This level of image rejection is high enough so that it is not a serious issue when compared with the third-order intermodulation distortion produced for reasonable port 1 power levels.  #@NEW_LINE#@#  The measured modulation feedthrough at port 2 is at 57â€‰dBm.  #@NEW_LINE#@#  Although these levels are already quite low, they can be cancelled further using integrated calibration circuits that are commonly implemented in CMOS RF ICs.  #@NEW_LINE#@#  ', 'Passive LTI systems have a noise figure (NF) that is equal to their loss.  #@NEW_LINE#@#  Passive LPTV systems can exhibit noise folding.  #@NEW_LINE#@#  The measured NF for port 2 to port 3 transmission is 4â€‰dB, higher than the 1.7dB loss.  #@NEW_LINE#@#  Simulations indicate that 2â€‰dB degradation arises from modulation path phase noise due to a poor implementation of the modulation path phase shifter.  #@NEW_LINE#@#  A better implementation of the modulation path phase shifter restores the NF to 2â€‰dB in simulation, close to the 1.7â€‰dB loss level and indicative of only minor NF degradation due to harmonic noise folding.'  #@NEW_LINE#@#  

Discussion  #@NEW_LINE#@#  
'The ability to integrate magnetic-free passive linear non-reciprocal components in CMOS has the potential to revolutionize RF communications.  #@NEW_LINE#@#  The CMOS circulator described in this study exhibits extremely low insertion loss ( less_than 2â€‰dB) and strong non-reciprocity, is compact and features reconfiguration capabilities.  #@NEW_LINE#@#  Furthermore, the enhanced linearity to port 1 is particularly useful for full-duplex or simultaneous transmit-and-receive communication and radar applications3,4, where a high-power transmitter (port 1) and a highly sensitive receiver (port 3) operate simultaneously at the same frequency, and must be interfaced with a shared antenna (port 2).  #@NEW_LINE#@#  In such a configuration, S21 (transmitter to antenna loss), S32 (antenna to receiver loss) and S31 (transmitter to receiver isolation) are the most important performance metrics, where our device performs particularly well.  #@NEW_LINE#@#  Full-duplex communication is drawing significant interest for emerging 5G communication networks43 due to its potential to double network capacity compared with half-duplex communication at the physical layer while offering numerous other benefits at the network layer.  #@NEW_LINE#@#  There has been active research on fully integrated CMOS transceiver ICs supporting full duplex44,45,46,47,48.  #@NEW_LINE#@#  The ability to include the circulator with the transceiver on the same CMOS IC would significantly reduce the cost and form factor, and enhance the performance of full-duplex systems.  #@NEW_LINE#@#  The filtering profile in S32 is also very useful in protecting the highly sensitive receiver from interference signals outside the frequency band of operation.  #@NEW_LINE#@#  ', 'For such applications, the ability to reconfigure the device between reciprocal and non-reciprocal operation is also very useful.  #@NEW_LINE#@#  We demonstrated reconfigurable modes of operation in the absence of commutation where the structure becomes reciprocal with low-loss transmission between the antenna (port 2) and the transmitter (port 1), and the antenna and the receiver (port 3).  #@NEW_LINE#@#  In other words, the prototype can be reconfigured between operation as a non-reciprocal circulator for full-duplex communication and a reciprocal low-loss transmit/receive switch for half-duplex communication.  #@NEW_LINE#@#  ', 'Although the design of this prototype is deliberately asymmetric with respect to the three ports to prioritize linearity to port 1 excitations for communication applications, a symmetric design may also be envisioned where a non-reciprocal phase component is incorporated in all three arms, that is, between all three ports.  #@NEW_LINE#@#  Such a symmetric circulator structure would enable extension of the concept to non-reciprocal metamaterials that support topologically protected wave propagation modes49.  #@NEW_LINE#@#  ', 'The bandwidth of the circulators isolation is limited by the matching between the frequency responses of the 3/4 ring and the staggered commutated network.  #@NEW_LINE#@#  Currently, the 20â€‰dB isolation bandwidth in S31 after tuning is 32â€‰MHz or 4.3% of the operating frequency, useful for commercial cellular LTE and WiFi applications.  #@NEW_LINE#@#  Dispersion engineering techniques to match their responses over a wider frequency range, thus enhancing the isolation amount versus bandwidth trade-off, represent an interesting topic for future research.  #@NEW_LINE#@#  ', 'Commutated networks are known to have response at harmonics of the commutation frequency.  #@NEW_LINE#@#  Response at harmonics can lead to susceptibility to interference near harmonic frequencies and also leads to noise folding.  #@NEW_LINE#@#  Although we have seen that the effect of noise folding on the NF is very small in this circulator structure, a formal analysis of the harmonic response and noise of the overall circulator structure, as well as techniques to suppress the same, also represent an interesting topic for future investigation.  #@NEW_LINE#@#  ', 'It is also interesting to consider the application of these concepts to other domains where a high-quality switch is available, such as optical waves.  #@NEW_LINE#@#  Compact optical switches with one to two orders of magnitude ON/OFF transmission ratio50,51 open the door to optical non-reciprocity and isolation through commutation-based parametric modulation.  #@NEW_LINE#@#  The nanosecond-scale switching speed implies GHz-range commutation frequencies, much smaller than the optical carrier frequency, which can be accomodated by commutating across high-Q optical filters that eliminate one of the modulation sidebands, similar to the low-pass filter effect used in our prototype.'  #@NEW_LINE#@#  

Methods  #@NEW_LINE#@#  
'IC implementation details', 'A block diagram of the IC and component values are provided in Supplementary Fig 3 and Supplementary Table 1, respectively.  #@NEW_LINE#@#  The circulator consists of three lumped C-L-C sections that miniaturize the 3/4 transmission line and a staggered electronically commutated network of eight capacitors.  #@NEW_LINE#@#  All components, except for the three inductors, are integrated on the CMOS IC.  #@NEW_LINE#@#  The switches of the commutated network are implemented using 65â€‰nm CMOS transistors and are driven with two sets of eight non-overlapping clock signals with 12.5% duty cycle.  #@NEW_LINE#@#  These clock signals are generated from two differential (0/180Â°) input clocks that run at four times the desired commutation frequency.  #@NEW_LINE#@#  A divide-by-2 frequency-divider circuit generates four quadrature clocks with 0Â°/90Â°/180Â°/270Â° phase relationship.  #@NEW_LINE#@#  These four clock signals drive two parallel paths for the two sets of switches.  #@NEW_LINE#@#  One of the paths features a programmable phase shifter that allows for arbitrary staggering between the two commutating switch sets.  #@NEW_LINE#@#  This enables switching between +90Â° and 90Â° staggering, which allows dynamic reconfiguration of the circulation direction.  #@NEW_LINE#@#  The phase shifter also allows for fine tuning of the staggered phase shift, to optimize the transmission loss in the circulation direction and isolation in the reverse direction.  #@NEW_LINE#@#  This feature has been exploited in the measurements shown in the main text.  #@NEW_LINE#@#  After phase shifting, another divide-by-2 circuit and a non-overlapping 12.5% duty-cycle clock generation circuit create the clock signals that control the commutating transistor switches.  #@NEW_LINE#@#  ', 'Experimental setups', 'Diagrams of the experimental setups are provided in Supplementary Figs 4 and 5, respectively.  #@NEW_LINE#@#  A list of the equipment used in the two setups is provided in Supplementary Table 2.  #@NEW_LINE#@#  A 180Â° hybrid is used to generate two differential (0Â°/180Â°) signals from a signal generator to drive the clock inputs of the implemented circulator.  #@NEW_LINE#@#  A voltage bias signal is added to the clock signals through bias tees to drive the clock inputs.  #@NEW_LINE#@#  A two-port vector network analyser is used to measure the S-parameters of the circulator two ports at a time, whereas the third port is terminated with a variable impedance tuner to tune the port impedance.  #@NEW_LINE#@#  For the input-referred third-order intercept point linearity test, a two-way power combiner is used to combine two sinusoidal signals generated from two additional signal generators and feed the input port under consideration.  #@NEW_LINE#@#  A spectrum analyser is used to monitor the fundamental signals and the third-order intermodulation distortion products of the circulator at the output port under consideration, whereas the third port is terminated with a 50- termination.'  #@NEW_LINE#@#  


