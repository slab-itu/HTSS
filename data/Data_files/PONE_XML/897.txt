article id="http://dx.doi.org/10.1371/journal.pone.0201446"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Modeling functional specialization of a cell colony under different fecundity and viability rates and resource constraint  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
The emergence of functional specialization is a core problem in biology.  #@NEW_LINE#@#  In this work we focus on the emergence of reproductive (germ) and vegetative viability-enhancing (soma) cell functions (or germ-soma specialization).  #@NEW_LINE#@#  We consider a group of cells and assume that they contribute to two different evolutionary tasks, fecundity and viability.  #@NEW_LINE#@#  The potential of cells to contribute to fitness components is traded off.  #@NEW_LINE#@#  As embodied in current models, the curvature of the trade-off between fecundity and viability is concave in small-sized organisms and convex in large-sized multicellular organisms.  #@NEW_LINE#@#  We present a general mathematical model that explores how the division of labor in a cell colony depends on the trade-off curvatures, a resource constraint and different fecundity and viability rates.  #@NEW_LINE#@#  Moreover, we consider the case of different trade-off functions for different cells.  #@NEW_LINE#@#  We describe the set of all possible solutions of the formulated mathematical programming problem and show some interesting examples of optimal specialization strategies found for our objective fitness function.  #@NEW_LINE#@#  Our results suggest that the transition to specialized organisms can be achieved in several ways.  #@NEW_LINE#@#  The evolution of Volvocalean green algae is considered to illustrate the application of our model.  #@NEW_LINE#@#  The proposed model can be generalized to address a number of important biological issues, including the evolution of specialized enzymes and the emergence of complex organs.  #@NEW_LINE#@#  

Introduction  #@NEW_LINE#@#  
The division of labor and functional specialization emerge ubiquitously in different biological systems and at different levels of life organization.  #@NEW_LINE#@#  For instance, the division of labor occurs in simple multicellular individuals [12], such that cyanobacteria [34], mycobacteria [5], Volvocalean green algae [67] and multicellular yeast [8].  #@NEW_LINE#@#  Various specialization patterns can be observed in different multicellular organisms.  #@NEW_LINE#@#  We can underline two major directions here: specialization in distinct somatic functions and germ-soma specialization [57].  #@NEW_LINE#@#  In this work we mainly focus on the emergence of germ-soma specialization.  #@NEW_LINE#@#  
There are some mathematical models that try to describe the evolution of specialization among somatic functions [5,9].  #@NEW_LINE#@#  For example, Ispolatov et al.  #@NEW_LINE#@#  have considered the process of formation of two-cell aggregates [5].  #@NEW_LINE#@#  Each aggregate can exist either in a unicellular or in a two-cell form.  #@NEW_LINE#@#  The fraction of time that a cell spends in a two-cell form is controlled by cell stickiness, which can evolve in time.  #@NEW_LINE#@#  Also, each cell produces two metabolites.  #@NEW_LINE#@#  In a two-cell form cells can exchange the produced metabolites with other cells, whereas a single cell cannot be involved in such an exchange.  #@NEW_LINE#@#  Ispolatov et al.  #@NEW_LINE#@#  [5] have shown that multicellular organisms can emerge from genetically identical ancestors and that the benefits of aggregation, achieved through specialization in metabolites production, stimulate this emergence.  #@NEW_LINE#@#  This aggregation allows increasing the dimension of phenotype space and provides new global maxima of the fitness function.  #@NEW_LINE#@#  It is worth noting that the changes in cell stickiness can lead to further differentiation of cell types in the colony.  #@NEW_LINE#@#  
Now we will discuss the main issue of our study: the emergence of germ-soma specialization [1012].  #@NEW_LINE#@#  Volvocalean green algae are the most appropriate biological system for studying this issue [1314].  #@NEW_LINE#@#  Volvocalean green algae are flagellated photosynthetic organisms.  #@NEW_LINE#@#  Their lineage contains unicellular organisms, multicellular organisms without cell differentiation, multicellular organisms with partial specialization and multicellular organisms with full germ-soma specialization [13].  #@NEW_LINE#@#  In their seminal work, Michod et al.  #@NEW_LINE#@#  [14] have studied the origin of specialization in colonies of identical cells.  #@NEW_LINE#@#  The fitness of the colony has been defined through its two basic components: viability and fecundity.  #@NEW_LINE#@#  These authors have introduced a specific trade-off function reflecting the intrinsic relationships that link viability and fecundity within a given cell.  #@NEW_LINE#@#  This trade-off emerges due to the cells physiology and other constraints.  #@NEW_LINE#@#  Michod et al.  #@NEW_LINE#@#  [14] have shown how the colonys fitness can be defined using the trade-off functions of individual cells.  #@NEW_LINE#@#  Their work suggests that the curvature of trade-off functions is an important factor that influences the emergence of functional specialization.  #@NEW_LINE#@#  Moreover, Michod et al.  #@NEW_LINE#@#  [14] have stated that small-sized colonies with low initial costs of reproduction have concave trade-off functions at each cell; large-sized colonies require high initial costs of reproduction and, hence, convex trade-off functions.  #@NEW_LINE#@#  
Solari et al.  #@NEW_LINE#@#  [15] have supported the idea that initial costs of reproduction play a significant role in the process of germ-soma separation.  #@NEW_LINE#@#  The model proposed by these authors allows explaining the GS (undifferentiated colonies)GS/S (colonies composed of specialized somatic cells and unspecialized cells)G/S (colonies with complete germ-soma specialization) form of the complexity evolving process in Volvocalean green algae.  #@NEW_LINE#@#  Hallmann [16] has examined in detail the evolution of reproductive development in Volvocalean green algae.  #@NEW_LINE#@#  Gavrilets [17] has studied the emergence of germ-soma specialization via developmental plasticity.  #@NEW_LINE#@#  This author has investigated how regulatory gene expressions, mutation rate, size of a colony and costs of plasticity influence the dynamics of the division of labor.  #@NEW_LINE#@#  Willensdorfer [18] has discussed the phenomenon of somatic cells.  #@NEW_LINE#@#  No any full-terminate somatic cell can reproduce.  #@NEW_LINE#@#  It dies after the colony reproduces.  #@NEW_LINE#@#  This means that these cells should provide some benefits to the organism in order to justify their existence.  #@NEW_LINE#@#  Willensdorfer has presented a model that allows one to determine whether somatic cells are advantageous for the organism or not, and to calculate the optimal fraction of these cells.  #@NEW_LINE#@#  Solari et al.  #@NEW_LINE#@#  [19] have considered the problem under study using some knowledge about different physical processes underlying the organism's evolution.  #@NEW_LINE#@#  Rueffler et al.  #@NEW_LINE#@#  [20] have introduced a general mathematical model of multicellular individuals.  #@NEW_LINE#@#  The main assumption of the model presented in [20] is the presence of some modules that can contribute to different evolutionary functions connected by a trade-off relationship.  #@NEW_LINE#@#  It has been shown that three factors favor different contributions of modules to taskspositional effects, accelerating performance functions and interaction between modules.  #@NEW_LINE#@#  Despite of its generality, the model of Rueffler et al.  #@NEW_LINE#@#  does not predict whether specialization emerges in the system or not.  #@NEW_LINE#@#  
Several authors have developed new models based on the concept of a fitness function.  #@NEW_LINE#@#  In [2123], the models of social choice have been applied to the problem under study.  #@NEW_LINE#@#  It has been shown that the use of the axiomatic approach allows one to construct different social welfare functions that describe the types of fitness-ranking on the set of alternatives representing all states relevant to the group.  #@NEW_LINE#@#  Bossert et al.  #@NEW_LINE#@#  [23] have suggested applying extensive social welfare functions and using their axiomatic properties to better describe the fitness functions of colonies.  #@NEW_LINE#@#  These authors have shown that their axioms are in complete agreement with the fact that the emergence of germ-soma specialization is accompanied by replacing concavity by convexity in the trade-off functions.  #@NEW_LINE#@#  
Most of the fundamental studies discussed above focus on a trade-off relationship between the germ and somatic functions and, in particular, on how this relationship drives the emergence of specialization.  #@NEW_LINE#@#  These studies shed light on how different model's parameters, such as the number of cells in the colony, different levels of regulatory genes expression or the initial cost of reproduction, can change the shape of a trade-off relationship.  #@NEW_LINE#@#  There are, however, some other factors whose impact on the germ-soma separation has not been studied in detail.  #@NEW_LINE#@#  For instance, it is well known that the emergence of specialization is closely related to environmental conditions [24].  #@NEW_LINE#@#  More precisely, a number of empirical studies have shown that the reproduction strategy varies in response to environmental changes [25].  #@NEW_LINE#@#  Kisdi et al.  #@NEW_LINE#@#  [24] have suggested that environmental conditions influence reproductive strategy of cell colonies.  #@NEW_LINE#@#  Also, differences in environmental factors influence viability of the colony.  #@NEW_LINE#@#  If we use a trait-like flagellar motility as an approximation of viability, then viability would depend on the amount of resources dissolved in the surrounding fluid [19] and the type of environment, e.g., still or mixed (see [26]).  #@NEW_LINE#@#  In [27], the rate of survival is used as an approximation of viability.  #@NEW_LINE#@#  In this case, restricted resources lead to a competition between colonies and this competition influences the rates of survival of all interacting colonies.  #@NEW_LINE#@#  It means that there exists a relationship linking fecundity of the colony to its viability and environmental factors.  #@NEW_LINE#@#  
The models described in [1415] assume that all cells of the colony are identical and thus have the same trade-off relationships.  #@NEW_LINE#@#  However, this is a very strong simplification.  #@NEW_LINE#@#  There are several factors which can lead to the emergence of non-identical cells in the colony and to a non-equivalence of cells with respect to biological functions.  #@NEW_LINE#@#  The first such a factor is the presence of mutations.  #@NEW_LINE#@#  Mutations and the natural selection trigger and drive the process of evolution.  #@NEW_LINE#@#  A number of important theoretical approaches to evolution are based on the process of selection involving mutations.  #@NEW_LINE#@#  One of them uses the concept of adaptive dynamics, which is derived based on the selection gradients [2830].  #@NEW_LINE#@#  Mutations occur during cell divisions and change intrinsic structures of cells.  #@NEW_LINE#@#  In other words, this means that different cells can have different trade-off functions.  #@NEW_LINE#@#  Even though initially all cells in the colony are identical, the situation can changes further.  #@NEW_LINE#@#  For instance, Ispolatov et al.  #@NEW_LINE#@#  [5] have considered a model where the genetic parameter of stickiness evolves in time and thus takes different values for different cells.  #@NEW_LINE#@#  A difference between stickiness among cells within the group can lead to the emergence of non-equivalence of cells with respect to a task and, thus, to different trade-off functions of cells.  #@NEW_LINE#@#  
The second factor here is the presence of a specific developmental program which is characterized by asymmetric divisions [31] (Developmental program 2 in Volvocalean green algae [13]).  #@NEW_LINE#@#  The activation of the gls genes in the embryos leads to the appearance of large-small sister-cell pairs [31].  #@NEW_LINE#@#  Gavrilets [17] has provided a model with two prototypes (proto-soma and proto-germ) that can be easily linked to large-small sister-cell pairs.  #@NEW_LINE#@#  However, it would be also interesting to elucidate how the number of these prototypes evolves and to develop a model that deals with an arbitrary number of prototypes.  #@NEW_LINE#@#  
The third factor here is the presence of positional effects described by Rueffler et al.  #@NEW_LINE#@#  [20].  #@NEW_LINE#@#  More precisely, positional effects mean that the contribution of different cells to different tasks depends on the position of each cell within the colony.  #@NEW_LINE#@#  For example, in Volvocalean green algae, cells in the interior or on the edges of the colony do not need to have the same opportunity to contribute to viability.  #@NEW_LINE#@#  Michod et al.  #@NEW_LINE#@#  [14] have assumed that specialization occurs first, and pointed out that specialized germ cells are nonflagellated and thus do not contribute to motility.  #@NEW_LINE#@#  These cells are located in the interior of the colony, making the colony spheroid smaller and lowering drag.  #@NEW_LINE#@#  Another vision would be that if for some reason cells are located in the interior of the colony, then it would make sense for them to become specialized in germ.  #@NEW_LINE#@#  Thus, difference in cells locations generates difference in trade-off relationships among cells.  #@NEW_LINE#@#  
In this work we consider a colony of cells and try to understand incentives for specialization within this colony depending on a given fitness function, encompassing different fecundity and viability rates, and a specific resource constraint.  #@NEW_LINE#@#  We describe three new mathematical models which represent some important generalizations and extensions of the core model of Michod et al.  #@NEW_LINE#@#  [14].  #@NEW_LINE#@#  Firstly, the colony of identical cells is studied.  #@NEW_LINE#@#  We examine whether the changes in available resources and/or fecundity and viability rates can increase the number of specialized cells in small-sized and large-sized colonies.  #@NEW_LINE#@#  Secondly, the colony of cells of different types is studied.  #@NEW_LINE#@#  This differentiation of types may occur as a result of gene mutations, an asymmetric division or positional effects.  #@NEW_LINE#@#  It corresponds to the changes in trade-off functions between viability and fecundity within cells.  #@NEW_LINE#@#  We investigate whether the differentiation of types can lead to the increase in the number of specialized cells in small-sized and large-sized colonies.  #@NEW_LINE#@#  Moreover, we explore how the difference in the types of trade-off functions, available resources or fecundity and viability rates influences the optimal number of specialized cells in the colony.  #@NEW_LINE#@#  Thirdly, we describe a possible generalization of the models considered in the two previous sections.  #@NEW_LINE#@#  The last section provides further discussion and presents some ideas for future research.  #@NEW_LINE#@#  

Materials_and_methods  #@NEW_LINE#@#  
Optimization_model_for_the_colony_of_identical_cells  #@NEW_LINE#@#  
The_model  #@NEW_LINE#@#  
Consider a colony of N cells, with cells indexed i = 1,,N.  #@NEW_LINE#@#  Each cell can contribute to two components of fitness, viability and fecundity.  #@NEW_LINE#@#  Let bi be fecundity of the cell i and vi be viability of this cell.  #@NEW_LINE#@#  Denote b = (b1,..,bN) and v = (v1,..,vN).  #@NEW_LINE#@#  Also, we assume that there is an intrinsic relationship between viability and fecundity within each cell, called a trade-off relationship between viability and fecundity [14].  #@NEW_LINE#@#  Such a trade-off reflects the inner structure of a cell and can be mathematically represented as  #@NEW_LINE#@#  
(1)  #@NEW_LINE#@#  
The function  is the trade-off function between bi and vi.  #@NEW_LINE#@#  It describes the relationship between viability and fecundity for all cells of the colony since in this model we assume that all cells within the colony are identical (i.e., they have the same intrinsic structure).  #@NEW_LINE#@#  
Here we describe a set of important requirements that the trade-off function  should satisfy.  #@NEW_LINE#@#  First of all, we define the constant bmaxR+, such that bmax less_than .  #@NEW_LINE#@#  This constant represents the maximal level of fecundity achieved by a cell, which is bounded due to the cell physiology.  #@NEW_LINE#@#  We assume that the contribution to fecundity provided by each cell cannot be negative.  #@NEW_LINE#@#  Thus, we can describe the trade-off function as .  #@NEW_LINE#@#  For the sake of simplicity we assume that the function  is continuous on [0,bmax] and twice continuously-differentiable on (0,bmax).  #@NEW_LINE#@#  The investment in one biological component of fitness (viability or fecundity) detracts from the other, leading to the following property:  for all b(0,bmax).  #@NEW_LINE#@#  Also, this property implies that (bmax) = 0, (0) = vmax, vmaxR+ and vmaxless_than.  #@NEW_LINE#@#  This means that if a cell makes the maximal possible contribution to one of the fitness components, its contribution to the other component should be minimal or minimally possible (i.e., zero).  #@NEW_LINE#@#  
The groups level of fecundity, B, is an additive function of variables bi, i = 1,.., N. Likewise, the groups level of viability, V, is an additive function of variables vi, i = 1,.., N:  #@NEW_LINE#@#  
(2)  #@NEW_LINE#@#  
The additive form of the groups fecundity seems biologically reasonable, but the additive form of the groups viability is more questionable.  #@NEW_LINE#@#  Following Michod et al.  #@NEW_LINE#@#  [14], we use a trait-like flagellar motility as an approximation of viability.  #@NEW_LINE#@#  Hence, this additive form of the group viability is appropriate here (further, we show that in many cases the assumption of additivity is not necessary for the viability function).  #@NEW_LINE#@#  
Now we will define the fitness of the colony.  #@NEW_LINE#@#  The fitness function, W, should be a function of B and V, satisfying the following properties: W(B,V) is a nonnegative function, such that W(B,V) = 0 if and only if B = 0 or V = 0.  #@NEW_LINE#@#  Moreover, the fitness function should be an increasing function on B and V for all nonnegative values of variables [14], [23].  #@NEW_LINE#@#  We suggest using the following fitness function, satisfying the selected properties:  #@NEW_LINE#@#  
(3)  #@NEW_LINE#@#  
First of all, note that the form (3) of the fitness function reflects the fact that both fitness components are essential for the colony's evolution and survival [5].  #@NEW_LINE#@#  Furthermore, this form of fitness implies the following essential property [14].  #@NEW_LINE#@#  Assume that the colony consists of two cells only: one cell has a high level of viability and a low level of fecundity, while the other cell has a low level of viability and a high level of fecundity.  #@NEW_LINE#@#  Each cell by itself has a low fitness, but together within the colony, the cells can interact with each other, hence, achieve a higher level of fitness.  #@NEW_LINE#@#  Moreover, the form (3) of the fitness function is a generalization of the fitness functions that have been considered in a number of recent works [14], [15], [26], and [27].  #@NEW_LINE#@#  For example, with  =  = 1, we get the fitness function that has been considered by Michod et al.  #@NEW_LINE#@#  [14].  #@NEW_LINE#@#  If the parameters  and  are interpreted as inverses of the time for growth, we get the fitness function proposed by Maliet et al.  #@NEW_LINE#@#  [27], where the time for growth represents the time that the cell is growing during its life cycle.  #@NEW_LINE#@#  If the parameter  is interpreted as an inverse of the generation time, we get the fitness function introduced by Solari et al.  #@NEW_LINE#@#  [15].  #@NEW_LINE#@#  Another interpretation of these parameters stems from Herron et al.  #@NEW_LINE#@#  [26].  #@NEW_LINE#@#  These parameters reflect the importance of the fecundity and viability contributions correspondingly to the fitness of the colony.  #@NEW_LINE#@#  They can be also viewed as the rates of fecundity and viability, respectively.  #@NEW_LINE#@#  Herron et al.  #@NEW_LINE#@#  [26] have considered the population of Volvocalean green algae in mixed and still environments.  #@NEW_LINE#@#  Still environment can be seen as an environment in which viability (i.e., motility) is supposed to be more important than in a mixed environment.  #@NEW_LINE#@#  This means that the value of the exponent  in still environment should be higher than that in mixed environment.  #@NEW_LINE#@#  
We will now introduce the parameter C as the amount of resources available to the colony.  #@NEW_LINE#@#  It would be reasonable to assume that in some cases the amount of available resources is greater than the amount of resources sufficient for the colonys well-being (i.e., the environment does not restrict the colonys well-being and does not influence its optimal reproductive strategy or motility).  #@NEW_LINE#@#  Thus, we can represent the relationship between fecundity, viability and environmental factors using the following inequality:  #@NEW_LINE#@#  
(4)  #@NEW_LINE#@#  
For the sake of simplicity, we assume that the function f has the following linear form:  #@NEW_LINE#@#  
(5)  #@NEW_LINE#@#  
Inequality (5), as well as its parameters, has simple biological interpretations.  #@NEW_LINE#@#  Since C represents the amount of resources available to the colony and there are only two components of fitness, fecundity and viability, it is natural to assume that the colony divides the resource C between these two components.  #@NEW_LINE#@#  The parameter k1 represents the amount of resources necessary to produce one unit of fecundity and k2 represents the amount of resources necessary to produce one unit of viability.  #@NEW_LINE#@#  Obviously, k1  0, k2  0 and C  0.  #@NEW_LINE#@#  
We can now formulate mathematically the fitness optimization problem.  #@NEW_LINE#@#  Consider a colony of identical cells.  #@NEW_LINE#@#  Each cell can contribute to fecundity and viability.  #@NEW_LINE#@#  For each cell there is an intrinsic relationship (trade-off) that links fecundity and viability.  #@NEW_LINE#@#  For all cells this relationship is the same due to the fact that the cells are identical.  #@NEW_LINE#@#  Further in this section, we assume that the trade-off constraints (1) are binding for all cells of the colony.  #@NEW_LINE#@#  The case of binding trade-off constraints is accounted for by changing inequalities by equalities (i.e., vi = (bi)) in (1).  #@NEW_LINE#@#  In the following sections we will show how the solution of our problem changes if the assumption of binding trade-offs is ruled out.  #@NEW_LINE#@#  The fitness of the colony can be described by Eq (3).  #@NEW_LINE#@#  This equation takes into account the importance of each component of the fitness measurement.  #@NEW_LINE#@#  Also, there is a composite resource consumed by a colony that affects the colonys well-being according to Inequality (5).  #@NEW_LINE#@#  The colonys optimal strategy, (b*,v*), consists of maximizing the fitness of the colony subject to all restrictions and conditions mentioned above (note that we can search for b* only because v* can be calculated directly from b* using the trade-off function).  #@NEW_LINE#@#  Thus, we obtain the following mathematical programming problem:  #@NEW_LINE#@#  
(6)  #@NEW_LINE#@#  
Our goal here is to find the set of all optimal fitness strategies for a given colony and make conclusions about its specialization.  #@NEW_LINE#@#  According to [14], the cell i specializes in soma if and only if vi = vmax, and the cell i specializes in germ if and only if bi = bmax.  #@NEW_LINE#@#  
The curvature of trade-off functions is one of the key parameters of functional specialization.  #@NEW_LINE#@#  According to Michod et al.  #@NEW_LINE#@#  [14], this curvature is concave in small-sized colonies and becomes gradually convex as the size of the colony increases.  #@NEW_LINE#@#  Initial cost of reproduction influences the curvature of the trade-off function, making it more convex-like [14].  #@NEW_LINE#@#  In the next sub-section we provide general statements characterizing our model, which hold for colonies of any size.  #@NEW_LINE#@#  Further we describe how these statements work with different types of trade-off functions: convex (for large-sized colonies), linear and concave (for small-sized colonies).  #@NEW_LINE#@#  

General_statements  #@NEW_LINE#@#  
In this and the next sections we assume that the domain of Problem (6) is nonempty, i.e., we consider an environment, such that the amount of composite resources available in this environment is sufficient for the colony in order to live and reproduce.  #@NEW_LINE#@#  There are three possible cases when looking for the solution of Optimization Problem (6).  #@NEW_LINE#@#  Consider the problem of optimization of the fitness function with respect to given trade-off constraints.  #@NEW_LINE#@#  After adding to it the resource constraint, we get Problem (6).  #@NEW_LINE#@#  Two cases are possible here: (a) the addition of the resource constraint does not change the solution of the problem under study (we call it Case 1) and (b) this addition changes the solution of the problem under study.  #@NEW_LINE#@#  Let us describe in more detail the case (b).  #@NEW_LINE#@#  Assume that we have no any trade-off constraint, and the only constraint available is the resource constraint (5) (of course, we also assume that B  0 and V  0).  #@NEW_LINE#@#  In this case we can find the set O of all optimal strategies of the colony.  #@NEW_LINE#@#  After that, we add the trade-off constraints expressed as equalities, and thus get Problem (6).  #@NEW_LINE#@#  Obviously, some points of the set O might be unattainable due to the trade-off constraints.  #@NEW_LINE#@#  Let A be the set of points from O that remain attainable after adding these constraints.  #@NEW_LINE#@#  Two cases are possible here (we call them Cases 2 and 3 correspondingly).  #@NEW_LINE#@#  Case 2: the set A is nonempty.  #@NEW_LINE#@#  It means that the trade-off constraints influence the set of all optimal strategies (because they reduce O to A), but do not influence the optimal value of fitness.  #@NEW_LINE#@#  The only constraint that influences the optimal value of fitness is the resource constraint.  #@NEW_LINE#@#  Case 3: the set A is empty.  #@NEW_LINE#@#  It means that the trade-off constraints influence both the set of all optimal strategies and the optimal value of fitness.  #@NEW_LINE#@#  Here, both the trade-off and resource constraints have impact on the optimal value of fitness.  #@NEW_LINE#@#  Clearly, the addition of the trade-off constraints leads to a decrease in the optimal value of the fitness function.  #@NEW_LINE#@#  Further we provide a more formal description of Cases 13.  #@NEW_LINE#@#  The proofs of all our results are presented in Appendices A and B in S1 Appendix.  #@NEW_LINE#@#  
Case 1.  #@NEW_LINE#@#  This case implies that the resource constraint does not influence the colonys well-being.  #@NEW_LINE#@#  This means that we have a resource restriction such that an optimal fitness strategy for the colony without any resource restriction continues to be available to the colony regardless of environmental constraints.  #@NEW_LINE#@#  
Case 2.  #@NEW_LINE#@#  Consider the following set of fecundity values:  #@NEW_LINE#@#  
(7)  #@NEW_LINE#@#  
The second case implies that the resource constraint influences the colonys well-being and that the set A is not empty.  #@NEW_LINE#@#  Under this assumption, the set A is the solution of Optimization Problem (6).  #@NEW_LINE#@#  In Appendix B in S1 Appendix we prove that the elements of the set A (and only these elements) represent the solution of Problem (6).  #@NEW_LINE#@#  Moreover, we can calculate the maximum fitness W* that the colony can reach (i.e., the optimal fitness that the colony can reach by choosing any reproductive strategy from the set A):  #@NEW_LINE#@#  
(8)  #@NEW_LINE#@#  
We can conclude that the optimal viability and the optimal fecundity of the colony increase as the amount of available resources increases.  #@NEW_LINE#@#  The optimal fecundity of the colony decreases as the amount of resources necessary to produce one unit of fecundity, i.e., the variable k1, increases.  #@NEW_LINE#@#  The optimal viability of the colony decreases as the amount of resources necessary to produce one unit of viability, i.e., the variable k2, increases.  #@NEW_LINE#@#  The optimal fecundity of the colony increases and the optimal viability of the colony decreases as the relative importance of fecundity to viability increases.  #@NEW_LINE#@#  
Thus, the best fitness the colony can get is an increasing function of the amount of available resources and a decreasing function of the amount of resources necessary to produce one unit of fecundity (or one unit of viability).  #@NEW_LINE#@#  The relationship between the optimal fitness and the parameters  and  is more complex.  #@NEW_LINE#@#  It is obtained by taking the following derivative:  #@NEW_LINE#@#  
(9)  #@NEW_LINE#@#  
So, we can conclude that the optimal fitness is an increasing function of the importance of fecundity if and only if  #@NEW_LINE#@#  
(10)  #@NEW_LINE#@#  
In other words, the optimal fitness increases as the importance of fecundity increases if and only if the relative importance of fecundity is high and the amount of recourses necessary to produce one unit of fecundity, expressed in terms of all available resources, is low (i.e., it is not very expensive to produce a unit of fecundity and the importance of fecundity is high).  #@NEW_LINE#@#  
Let us now consider the solutions of our problem, i.e., the set A.  #@NEW_LINE#@#  It has the following structure: the set A consists of a number of subsets; each of these subsets is a connected set; any two of these subsets have no intersection.  #@NEW_LINE#@#  The model is robust within each optimal subset, and the colony under study has more opportunities for adaptation because some of its cells can change slightly their optimal contributions to viability and fecundity without loss in fitness.  #@NEW_LINE#@#  In all optimal subsets, the levels of fecundity and viability of each cell are located in limited ranges, specific to each cell.  #@NEW_LINE#@#  This result reflects the fact that some cells in the colony may lose the potential ability to achieve, for example, a high level of fecundity, but they do not lose their capacity to perform a reproductive function.  #@NEW_LINE#@#  This case corresponds to an intermediate state between unspecialized colonies and full-specialized multicellular organisms.  #@NEW_LINE#@#  
Case 3.  #@NEW_LINE#@#  The third case implies that the resource constraint influences the colonys well-being and the set A is empty.  #@NEW_LINE#@#  Here the mathematical solution becomes more complex and depends on the parameters of the model (for more details, see Appendix B in S1 Appendix).  #@NEW_LINE#@#  Further we show that this case provides the strongest incentives for the emergence of specialization in small-sized colonies and damages specialized structures in large-sized colonies.  #@NEW_LINE#@#  
In the next sections we will describe how our model can be applied in the context of different curvatures of trade-off functions.  #@NEW_LINE#@#  Moreover, we will present the set of all solutions of our mathematical programming problem using 3-D plots.  #@NEW_LINE#@#  In these plots we assume that we have three groups of cells within the colony such that all cells from each group contribute to the same levels of fecundity and to the same levels of viability (in other words, we have three aggregate cells in the colony).  #@NEW_LINE#@#  This assumption is used to illustrate our general results graphically.  #@NEW_LINE#@#  
It is worth noting that our general results presented in this sub-section also hold for non-additive forms of the viability function.  #@NEW_LINE#@#  In Appendix B in S1 Appendix we provide a general proof of these results, which works for both additive and non-additive viability functions.  #@NEW_LINE#@#  Moreover, following Michod et al.  #@NEW_LINE#@#  [14], we can conclude that all theoretical results regarding the convex form of the viability function presented in this paper hold as well without the assumption of additivity (for more details see the sub-section Convex trade-off).  #@NEW_LINE#@#  

Convex_trade-off  #@NEW_LINE#@#  
Assume that the trade-off function (b) is strictly convex on its domain.  #@NEW_LINE#@#  
Case 1.  #@NEW_LINE#@#  In this case an optimal strategy b* implies that all cells (or all cells but one) should be specialized.  #@NEW_LINE#@#  According to the model introduced by Michod et al.  #@NEW_LINE#@#  [14], with  =  = 1, a half of the cells should specialize in germ and a half in soma.  #@NEW_LINE#@#  Thus, our model can be viewed as a generalization of the model formulated in [14].  #@NEW_LINE#@#  In our model, the number of cells specialized in germ (soma) depends on the ratio (/).  #@NEW_LINE#@#  For the colonies with a high relative importance of fecundity, the ratio (/) is high and, hence, reproductive cells are beneficial.  #@NEW_LINE#@#  For the colonies with a low relative importance of fecundity, the ratio (/) is low and, hence, somatic cells are beneficial.  #@NEW_LINE#@#  This theoretical observation is supported by the empirical fact that in still environment (i.e., when viability is more important than fecundity) the number of somatic cells is generally higher than in mixed environment [26].  #@NEW_LINE#@#  
This case is illustrated in Fig 1.  #@NEW_LINE#@#  We will show how the solutions of the problem change in response to decreasing the ratio /.  #@NEW_LINE#@#  To do so, we assume that all other parameters of our model are fixed.  #@NEW_LINE#@#  In Fig 1 (panel a) fecundity is more important than viability, and in Fig 1 (panel b) viability is more important than fecundity.  #@NEW_LINE#@#  In each panel of Fig 1 the domain of the corresponding sub-problem of Problem (6) is plotted in the (b1, b2, b3) space and the corresponding solution is depicted.  #@NEW_LINE#@#  Here each axis represents a reproductive effort of some aggregate cells of the colony.  #@NEW_LINE#@#  Since we are in Case 1, the resource constraint does not influence the colonys well-being.  #@NEW_LINE#@#  Consequently, only the trade-off constraints determine the domain of Problem (6).  #@NEW_LINE#@#  In the selected space these constraints form the cube [0, bmax]3.  #@NEW_LINE#@#  We can see that in both panels of Fig 1 there exist three optimal strategies and within each of these strategies the colonies are full-specialized.  #@NEW_LINE#@#  The difference in the value of the (/) ratio leads to the difference in the number of aggregate cells specialized in a specific fitness component.  #@NEW_LINE#@#  Thus, in Fig 1A with a large value of the ratio (/), each optimal strategy implies that two aggregate cells should specialize in germ, and one in soma.  #@NEW_LINE#@#  On the opposite, in Fig 1B with a small value of the ratio (/), each optimal strategy implies that only one aggregate cell should specialize in germ, and two in soma.  #@NEW_LINE#@#  
Case 2.  #@NEW_LINE#@#  Fig 2 illustrates this case.  #@NEW_LINE#@#  In this case the set A represents the solution of the problem under study.  #@NEW_LINE#@#  Clearly, the geometry of A depends on the value of the ratio (/).  #@NEW_LINE#@#  Since we are in Case 2, the resource constraint defines the domain of Problem (6) along with the trade-off constraints.  #@NEW_LINE#@#  Graphically, it means that the resource constraint truncates the trade-off cube so that the domain of Problem (6) is a truncated cube whose corners are cut out.  #@NEW_LINE#@#  The case presented in Fig 2 can be derived from the case presented in Fig 1 by reducing the amount of available resources.  #@NEW_LINE#@#  Thus, in Fig 2B viability is more important than in Fig 2A.  #@NEW_LINE#@#  In both cases, the set of optimal solutions (set A) consists of three disconnected subsets (they are colored in red).  #@NEW_LINE#@#  The difference between Fig 2A and 2B is that the optimal contribution of the colony to viability in Fig 2B is higher than in Fig 2A (i.e., in Fig 2B more cells are predisposed to the soma specialization than in Fig 2A).  #@NEW_LINE#@#  It is worth noting that at most one aggregate cell can be specialized here.  #@NEW_LINE#@#  
Case 3.  #@NEW_LINE#@#  Fig 3 illustrates this case.  #@NEW_LINE#@#  We will show that Case 3 emerges either in a good environment and is then characterized by a non-zero level of specialization at the optimum or in a bad environment and is then characterized by an unspecialized optimal strategy.  #@NEW_LINE#@#  Since we are in Case 3, the domain of Problem (6) is still a truncated trade-off cube in the space (b1, b2, b3).  #@NEW_LINE#@#  
First of all, consider the case presented in Fig 3A.  #@NEW_LINE#@#  It can be derived from the case presented in Fig 2B in the following way.  #@NEW_LINE#@#  Consider the case illustrated in Fig 2B.  #@NEW_LINE#@#  Suppose that the importance of viability increases in a way that the set A becomes empty.  #@NEW_LINE#@#  In this case, the optimal strategies of the colony include the points from the set of all available strategies of the resource constraint surface, such that they are the closest to the following set: (this set is depicted in Fig 3A; geometrically, it represents a simplex inside the truncated cube; this simplex has no intersections with the boundary of the truncated cube formed by the resource constraint).  #@NEW_LINE#@#  On one hand, this leads to a loss in fitness, but on the other hand, to an increase in specialization.  #@NEW_LINE#@#  We can see that there are three optimal strategies here.  #@NEW_LINE#@#  Each of them requires exactly two aggregate cells to specialize in soma.  #@NEW_LINE#@#  Thus, the level of specialization of the colony increases.  #@NEW_LINE#@#  This case can occur during the evolution of Volvocalean green algae, when soma has to evolve first [15].  #@NEW_LINE#@#  Hence, the functional specialization in Volvocalean green algae has the following form: GS (unspecialized colonies)GS/S (specialization in soma only)G/S (fully specialized colonies).  #@NEW_LINE#@#  Moreover, this case shows that the evidence that the process of transition goes through the path GSGS/S can be explained not only in terms of enhancing the colony size [15].  #@NEW_LINE#@#  Consider the following fitness function, originally studied in [15], which is a special case of the fitness function (3),  #@NEW_LINE#@#  
(11)  #@NEW_LINE#@#  
Let us now assume that initially we had a low generation time (T) and a resource constraint similar to that presented in Fig 2B.  #@NEW_LINE#@#  Furthermore, we suppose that the structural complexity of the colony evolves (without changes in its size).  #@NEW_LINE#@#  It requires colony to reproduce the structure that becomes more complex and, consequently, can lead to an increase in generation time.  #@NEW_LINE#@#  Therefore, we get the case illustrated in Fig 3A, when soma has to evolve first.  #@NEW_LINE#@#  
The case presented in Fig 3B can be derived from the case presented in Fig 3A in the following way.  #@NEW_LINE#@#  Let us consider the case illustrated in Fig 3A.  #@NEW_LINE#@#  We assume that the amount of available resources C decreases significantly so that the resource constraint becomes so strong that it is now the only factor that influences the domain of Problem (6).  #@NEW_LINE#@#  Geometrically, it means that the truncated cube formed by the intersection of the trade-off and resource constraints is transformed into a ball determined by the resource constraint only.  #@NEW_LINE#@#  In this case, the beneficial soma-specialized strategies become unreachable to the colony, which becomes unspecialized.  #@NEW_LINE#@#  This means that the changes in structural complexity in unspecialized large-sized colonies can lead to the emergence of soma specialization (Fig 3A) as well as to unspecialized states in the case of environmental quality degradation (Fig 3B).  #@NEW_LINE#@#  

Linear_trade-off  #@NEW_LINE#@#  
Let us now assume that the trade-off function (b) is linear and has the following form:  #@NEW_LINE#@#  
(12)  #@NEW_LINE#@#  
A linear function is the simplest type of trade-off function which can be considered.  #@NEW_LINE#@#  Due to its simplicity, there are fewer effects that occur for this curvature of the trade-off function.  #@NEW_LINE#@#  For instance, Case 2 discussed in the previous sub-section does not take place here for most of the parameter values.  #@NEW_LINE#@#  Moreover, the resource constraint (5) can be represented under the following form  #@NEW_LINE#@#  
(13)  #@NEW_LINE#@#  
Case 1.  #@NEW_LINE#@#  The colony of cells behaves as a single cell as in [14].  #@NEW_LINE#@#  The maximum fitness is obtained for all strategies b*, 0  bi*  bmax, such that:  #@NEW_LINE#@#  
(14)  #@NEW_LINE#@#  
The maximum fitness is equal to  #@NEW_LINE#@#  
(15)  #@NEW_LINE#@#  
The necessary and sufficient condition for the emergence of this case is the following  #@NEW_LINE#@#  
(16)  #@NEW_LINE#@#  
This inequality suggests that the resource constraint does not influence the colonys well-being if and only if the amount of available resources is sufficient to produce some fractions of the maximal possible values of the colonys fecundity and viability.  #@NEW_LINE#@#  These fractions are proportional to the importance of fecundity and viability, respectively.  #@NEW_LINE#@#  
This situation is illustrated in Fig 4A.  #@NEW_LINE#@#  Since we consider Case 1, the domain of Problem (6) is the trade-off cube.  #@NEW_LINE#@#  The solutions of this problem can be found using Eq (14).  #@NEW_LINE#@#  Geometrically, the solutions are located on the intersection of the trade-off cube and a plane determined using Eq (14).  #@NEW_LINE#@#  This intersection forms a simplex inside the cube.  #@NEW_LINE#@#  Each strategy from this simplex will be optimal.  #@NEW_LINE#@#  We can see that in this case the specialized states are optimal as well as unspecialized ones.  #@NEW_LINE#@#  
Case 3.  #@NEW_LINE#@#  The colony of cells behaves as if it was a single cell too.  #@NEW_LINE#@#  The maximum fitness is obtained for all strategies b*, 0  bi*  bmax, such that:  #@NEW_LINE#@#  
(17)  #@NEW_LINE#@#  
The maximum fitness here is as follows:  #@NEW_LINE#@#  
(18)  #@NEW_LINE#@#  
The necessary and sufficient condition for the emergence of this case is the following:  #@NEW_LINE#@#  
(19)  #@NEW_LINE#@#  
It is worth noting that if the left-hand side of this inequality does not hold, the colony has no possibility to survive.  #@NEW_LINE#@#  Also, if k1bmax = k2vmax, Inequality (19) does not hold hence Case 3 does not occur here.  #@NEW_LINE#@#  
Case 3 is illustrated in Fig 4B.  #@NEW_LINE#@#  In the linear case the resource constraint is represented by a plane (see Eq 13).  #@NEW_LINE#@#  This plain cuts out a part of the trade-off cube thereby forming the domain of Problem (6).  #@NEW_LINE#@#  Moreover, all the states from the intersection of the trade-off cube, and the resource plane are optimal.  #@NEW_LINE#@#  As in Case 1, the colony can be unspecialized in some optimal states and some level of specialization can occur in the other optimal states.  #@NEW_LINE#@#  Thus, we can conclude that the solution structures of a linear trade-off model do not alter with the changes in the model's parameters and that there is no major difference between Cases 13 here.  #@NEW_LINE#@#  

Concave_trade-off  #@NEW_LINE#@#  
Let us assume that the trade-off function (b) is strictly concave on its domain.  #@NEW_LINE#@#  
Case 1.  #@NEW_LINE#@#  Here we consider the strategy that implies that each cell in the colony has the same level of fecundity (i.e., the same level of viability) b*, such that:  #@NEW_LINE#@#  
(20)  #@NEW_LINE#@#  
It is easy to show that there is a single point b* satisfying Eq (20), such that 0 less_than b* less_than bmax.  #@NEW_LINE#@#  Moreover, this point represents the single optimal strategy of the colony at hand.  #@NEW_LINE#@#  Eq (20) can be rewritten in the following way:  #@NEW_LINE#@#  
(21)  #@NEW_LINE#@#  
The parameter VB is the elasticity of the groups viability relative to fecundity.  #@NEW_LINE#@#  Thus, the optimal strategy for the colony requires the elasticity of the group to be equal to the relative importance of viability to fecundity.  #@NEW_LINE#@#  This means that at the optimum, in order to increase the groups viability by one percent, it is necessary to decrease the groups fecundity by the relative importance of viability to fecundity percent.  #@NEW_LINE#@#  
Let us now consider Fig 5.  #@NEW_LINE#@#  The two panels of this figure show how the model's solution vary with respect to the changes in the (/) ratio.  #@NEW_LINE#@#  Since we are in Case 1, the domain of Problem 6 is a trade-off cube.  #@NEW_LINE#@#  According to Eq (20), the problem's solution should be located on the main diagonal of the cube.  #@NEW_LINE#@#  In panel (a) of Fig 5 fecundity is more important than in panel (b).  #@NEW_LINE#@#  Thus, Fig 5A illustrates a case where, at the optimum, cells invest more in fecundity than in Fig 5B.  #@NEW_LINE#@#  
Case 2.  #@NEW_LINE#@#  The set A represents the solution of the problem under study.  #@NEW_LINE#@#  Fig 6 shows how the solution of the problem varies in response to the changes in the parameters.  #@NEW_LINE#@#  Consider panel (a) first.  #@NEW_LINE#@#  The resource constraint truncates the trade-off cube, thereby forming the domain of Problem (6).  #@NEW_LINE#@#  In this case viability is less important than fecundity.  #@NEW_LINE#@#  Also, more resources for producing one unit of fecundity than for producing one unit of viability are required (due to this fact the truncated cube is asymmetrical and only one of its corners is cut out).  #@NEW_LINE#@#  We can see that the optimal solutions here form a connected set of unspecialized states (set A).  #@NEW_LINE#@#  Graphically, this set is located on the intersection of a part of the domain boundary defined by the resource constraint and the plane that provides the optimum of the fecundity function.  #@NEW_LINE#@#  The set A embodies the opportunities for adaptation for the colony at hand.  #@NEW_LINE#@#  If the relative importance of fecundity to viability grows (when the amount of available resources decreases slightly), we have the case shown in Fig 6B, where the specialization occurs.  #@NEW_LINE#@#  This is an extreme sub-case of Case 2, where the set A corresponds to a three-point set.  #@NEW_LINE#@#  The case presented in Fig 6B can be characterized by the two following properties.  #@NEW_LINE#@#  On one hand, the fecundity production requires more resources than the production of viability.  #@NEW_LINE#@#  On the other hand, fecundity yields significantly more benefits than viability.  #@NEW_LINE#@#  The emergence of specialization here is a consequence of the trade-off between the production difficulties and the fitness benefits of fecundity.  #@NEW_LINE#@#  
Case 3.  #@NEW_LINE#@#  We describe a general principle of finding solutions here: optimal strategies are the available strategies from the resource constraint surface such they yield the same level of total fecundity, and this level is the closest one to the total fecundity plane surface for the set A: , among all available strategies belonging to the resource constraint surface defined by the equation k1B+k2V = C. Fig 7 illustrates this case and shows that unspecialized states can be optimal as well as strategies with some level of specialization.  #@NEW_LINE#@#  Here the domain of Problem (6) is an intersection of the trade-off cube and the resource constraint surface.  #@NEW_LINE#@#  Also, in Fig 7 we show the total fecundity plane of the set A in order to illustrate the general principle of finding optimal solutions in this case.  #@NEW_LINE#@#  The case presented in Fig 7A can be derived from the case presented in Fig 6A in the following way.  #@NEW_LINE#@#  Let us consider the case illustrated in Fig 6A.  #@NEW_LINE#@#  We suppose that the importance of viability increases in a way that viability becomes more important than fecundity and the amount of available resources decreases slightly, as in the case illustrated in Fig 6B.  #@NEW_LINE#@#  Because the fecundity production requires more resources than the production of viability, and viability yields more benefits than fecundity, there is no trade-off between the production complexity and the fitness benefits of fecundity or viability.  #@NEW_LINE#@#  It implies that the colony has no incentive to reorganize the optimal structure of its contributions to the fitness components (i.e., the colony remains unspecialized).  #@NEW_LINE#@#  In Fig 7B another way of emergence of specialization is illustrated.  #@NEW_LINE#@#  Here we have the case where k1 = k2 = 1 and  =  = 1.  #@NEW_LINE#@#  This means that fecundity and viability have the same contribution to fitness and require the same amount of resources for production.  #@NEW_LINE#@#  Also, here we have a very low level of resources available (geometrically, it means that the resource constraint is so strong that only the eight corners of the trade-off cube constitute the problem domain).  #@NEW_LINE#@#  In this case the specialization occurs in response to a bad environmental quality.  #@NEW_LINE#@#  In order to survive and adapt, cells within the colony have to redistribute their efforts in a way that some of them become specialized.  #@NEW_LINE#@#  


Optimization_model_for_the_colony_of_cells_of_different_types  #@NEW_LINE#@#  
The_model  #@NEW_LINE#@#  
In this section we will show how Optimization Problem (6) can be further generalized.  #@NEW_LINE#@#  In Problem (6) only identical cells are considered.  #@NEW_LINE#@#  Here we assume that some cells of the colony are not equivalent with respect to a given function (viability or fecundity) due to mutations, a specific developmental program or positional effects.  #@NEW_LINE#@#  This non-equivalence of cells can be expressed via the difference in the trade-off functions among cells of the same colony:  #@NEW_LINE#@#  
(22)  #@NEW_LINE#@#  
Thus, each cell of the colony will have its own trade-off function, such that ,  and .  #@NEW_LINE#@#  As previously, we assume that all functions i are continuous on , twice continuously-differentiable on ,  for all , and  ,  and .  #@NEW_LINE#@#  We say that two cells have different types if and only if they have different trade-off functions.  #@NEW_LINE#@#  Thus, we can formulate the fitness optimization problem for the colony of cells of different types by replacing the trade-off functions of form (1) by those of form (22).  #@NEW_LINE#@#  
By solving Problem (6) with different types of trade-offs, we determine how positional effects, the importance of tasks and the resource constraint influence the optimal strategy of the colony and its incentives to specialization.  #@NEW_LINE#@#  It is worth noting that the results provided in the sub-section General statements of the previous section are generic and hold for the optimization model with different types of cells too (see Appendix B in S1 Appendix for more details).  #@NEW_LINE#@#  Below, we describe how these general statements can be illustrated under different curvatures of trade-off functions which are due to the presence of positional effects.  #@NEW_LINE#@#  More precisely, we will discuss Case 1 only for each curvature, because all other cases (except Case 2 for linear trade-offs) preserve all qualitative results and properties of the model presented in the previous section.  #@NEW_LINE#@#  In other words, there are some factors that favor the evolution of division of labor.  #@NEW_LINE#@#  These factors emerge due to the resource constraint and different importances of viability and fecundity (we described them in the previous section).  #@NEW_LINE#@#  Here we show only the specific effects of different trade-off functions (but still with different importances of viability and fecundity).  #@NEW_LINE#@#  Cases 2 and 3 of the current model combine the properties of Cases 2 and 3 of the model presented in the previous section and those of Case 1 described in the next sub-section.  #@NEW_LINE#@#  

Convex_trade-offs  #@NEW_LINE#@#  
Let us assume that all trade-off functions are strictly convex on their domains.  #@NEW_LINE#@#  
Case 1.  #@NEW_LINE#@#  In this case an optimal strategy b* implies that all cells, or all cells except one, should be specialized and that the number of cells specialized in germ (or soma) depends on cells positional effect and on the ratio (/).  #@NEW_LINE#@#  To show it, we follow the elegant and simple arguments provided in [14].  #@NEW_LINE#@#  Consider an arbitrary strategy b = (b1,,bi,,bj,,bN), where two cells, i and j, have intermediate fecundities,  and .  #@NEW_LINE#@#  For any positive real number , such that , we consider two new strategies b1 = (b1,,bi,,bj+,bN) and b2 = (b1,,bi+,,bj,bN).  #@NEW_LINE#@#  We can see that B(b) = B(b1) = B(b2), and due to the strict convexity of V, we can conclude that 2V(b)less_thanV(b1)+V(b2).  #@NEW_LINE#@#  Thus, either V(b)less_thanV(b2) or V(b)less_thanV(b2).  #@NEW_LINE#@#  It means that either W(b)less_thanW(b1) or W(b)less_thanW(b2).  #@NEW_LINE#@#  Therefore, we showed that the strategy b is not optimal.  #@NEW_LINE#@#  Importantly, we did not specify the form of V in this proof, but required only the strict convexity of all trade-off functions.  #@NEW_LINE#@#  It means that this result holds for non-additive viability functions as well.  #@NEW_LINE#@#  
This case is illustrated in Fig 8A and 8B.  #@NEW_LINE#@#  In Fig 8A, viability is more important than fecundity and the third aggregate cell is more predisposed to fecundity-performing.  #@NEW_LINE#@#  Therefore, an optimal strategy for the first and the second aggregate cells consists in the soma specialization, while the third cell should be specialized in germ.  #@NEW_LINE#@#  If the importance of viability decreases so that fecundity becomes more important than viability, then we get the case illustrated in Fig 8B.  #@NEW_LINE#@#  Here the third cell remains specialized in germ due to positional effects.  #@NEW_LINE#@#  The increase in the importance of viability forces the first, or the second, aggregate cell to switch its specialization from viability to fecundity.  #@NEW_LINE#@#  

Linear_trade-offs  #@NEW_LINE#@#  
Let us assume that all trade-off functions are linear.  #@NEW_LINE#@#  Thus, they have the following form:  #@NEW_LINE#@#  
(23)  #@NEW_LINE#@#  
Case 1.  #@NEW_LINE#@#  We assume that all parameters i (i = 1,,N) are different.  #@NEW_LINE#@#  We call this property the assumption of strong differentiation of types.  #@NEW_LINE#@#  In this case an optimal strategy b* implies that all cells, or all cells except one cell, are specialized.  #@NEW_LINE#@#  Moreover, this optimal strategy is unique, and the cells that specialize in germ are those with the lowest i, while the cells that specialize in soma are those with the highest i.  #@NEW_LINE#@#  To show this, we follow the approach provided in [14].  #@NEW_LINE#@#  First of all, we can reformulate Problem (6) with different types of trade-offs, by replacing the original objective function: W = BV, by the following function: .  #@NEW_LINE#@#  Now we can consider an equivalent mathematical programming problem, in which for all feasible fecundity strategies b and b1, we have W(b1)W(b)0 if and only if W'(b1)W'(b)0.  #@NEW_LINE#@#  Let us consider an arbitrary strategy b = (b1,,bi,,bj,,bN), where two cells, i and j, such that i less_than j, have fecundities,  and , respectively.  #@NEW_LINE#@#  Let us now select a real number , such that .  #@NEW_LINE#@#  If cell i increases its fecundity, while cell j decreases its fecundity, by the same amount , then the total fecundity of the colony does not change.  #@NEW_LINE#@#  However, the viability of the colony increases, and as a result, its fitness increases as well.  #@NEW_LINE#@#  More formally, we consider a new strategy b1 = (b1,,bi+,,bj,,bN).  #@NEW_LINE#@#  Because , we obtain: .  #@NEW_LINE#@#  It means that W(b1)W(b)0.  #@NEW_LINE#@#  Consequently, the strategy b is not optimal.  #@NEW_LINE#@#  Using similar arguments, we can prove that the solution of this problem is unique.  #@NEW_LINE#@#  
Furthermore, let us assume that there are cells i1,,ik in the colony, such that .  #@NEW_LINE#@#  We can reduce this problem to the problem with the assumption of strong differentiation of types, by combining all cells i1,,ik into a single composite cell with fecundity  and viability .  #@NEW_LINE#@#  
This case is illustrated in Fig 8C and 8D).  #@NEW_LINE#@#  In Fig 8C, viability is more important than fecundity and the third aggregate cell is more predisposed to fecundity performing.  #@NEW_LINE#@#  Therefore, the optimal strategy for the first and the second aggregate cells is to be specialized in soma, and to be specialized in germ for the third cell.  #@NEW_LINE#@#  This means that positional effects here lead the colony to specialization.  #@NEW_LINE#@#  Without these effects in the linear case, the colony sees no difference between some unspecialized states and the states where some cells can be specialized (see the sub-section Linear trade-off in the previous section).  #@NEW_LINE#@#  If the importance of viability decreases in a way that fecundity becomes more important than viability, we get the case illustrated in Fig 8D.  #@NEW_LINE#@#  Here we conclude that the third cell should remain specialized in germ due to positional effects.  #@NEW_LINE#@#  The first and the second cells behave as if they were one cell.  #@NEW_LINE#@#  This example suggests that there is a non-trivial interaction between positional effects and the importance of the fitness components.  #@NEW_LINE#@#  If they act as one, as shown in Fig 8C, the specialization in the colony occurs.  #@NEW_LINE#@#  Otherwise, they compensate each other and the specialization occurs only partially, as shown in Fig 8D.  #@NEW_LINE#@#  
Case 2.  #@NEW_LINE#@#  In the sub-section Linear trade-off of the previous section we showed that in the linear case without positional effects, only Cases 1 and 3 can occur.  #@NEW_LINE#@#  However, if we introduce positional effects into the model with linear trade-offs, all three cases (Cases 1 to 3) become possible.  #@NEW_LINE#@#  

Concave_trade-offs  #@NEW_LINE#@#  
Let us assume that all trade-off functions are strictly concave on their domains.  #@NEW_LINE#@#  
Case 1.  #@NEW_LINE#@#  We consider the strategy implying that each cell in the colony has the level of fecundity bi*, such that:  #@NEW_LINE#@#  
(24)  #@NEW_LINE#@#  
If there exists a point b*, satisfying Eq (24), such that 0 less_than bi* less_than bimax for all i = 1,, N, then this point represents the unique optimal strategy of the colony under study, i.e., all cells in the colony remain unspecialized.  #@NEW_LINE#@#  However, the case when no points satisfy Eq (24), such that 0 less_than bi* less_than bimax for all i = 1N, can also occur.  #@NEW_LINE#@#  This case occurs when the relative importance of viability to fecundity is high (low) enough or when the differentiation of types is strong.  #@NEW_LINE#@#  In these cases some cells of the colony should be specialized, whereas the other cells should have the level of fecundity bi* satisfying the condition similar to that of Eq (24) (see Appendix A in S1 Appendix).  #@NEW_LINE#@#  Note also, that high (low) relative importance of viability to fecundity can pushes the colony to specialization only in the presence of positional effects, because without these effects (see the sub-section Concave trade-off in the previous section) the concave curvatures of trade-off functions do not lead to specialization in the colony.  #@NEW_LINE#@#  This case is shown in Fig 8E, where there is no specialization at the optimum.  #@NEW_LINE#@#  Then, we can also assume that the importance of viability decreases in a way that viability becomes less important than fecundity (see Fig 8F).  #@NEW_LINE#@#  The optimal strategy for the second cell in this figure is to specialize in germ.  #@NEW_LINE#@#  On one hand, the second cell is predisposed to specialization in germ due to positional effects.  #@NEW_LINE#@#  On the other hand, this predisposition by itself has no impact on specialization in the colony (see Fig 8E).  #@NEW_LINE#@#  Fig 8F accounts for the case when the change in the relative importance of viability to fecundity, combined with the presence of positional effects, causes the emergence of specialization.  #@NEW_LINE#@#  Consequently, we can say that positional effects influence the development of specialization in the colony directly (through predispositions of some cells to some tasks) or indirectly (through a high or low relative importance of viability to fecundity supported by the presence of positional effects).  #@NEW_LINE#@#  In other words, positional effects and mutations in small-sized colonies can lead to the emergence of specialization without changes in size and/or in resource restrictions.  #@NEW_LINE#@#  Moreover, together with positional effects, the increase in the generation time or changes in the environment (from mixed to still) can lead to the emergence of soma specialization without changes in the size of the colony.  #@NEW_LINE#@#  Hence, we have shown that the GSGS/S transition process during the evolution of Volvocalean green algae can be explained not only in terms of enhancing the colony size.  #@NEW_LINE#@#  Obviously, the size of the colony and the corresponding initial costs of reproduction are essential, but they are not the only factors causing the emergence of specialization.  #@NEW_LINE#@#  


Generalization_of_the_original_model__Considering_inequalities_in_trade-offs  #@NEW_LINE#@#  
Here we consider Problem 6 with different types of trade-offs, assuming that the trade-off relationships have the form (1), i.e., they are represented by inequalities.  #@NEW_LINE#@#  First of all, we need to point out that this problem has a nonempty domain, because the point (b,v) = (0,0) belongs to its domain for all possible values of parameters in the resource constraint.  #@NEW_LINE#@#  Further, we provide general results to describe the solutions of this problem and compare them to the results from the sub-section General statements of the previous section, where the trade-off relationships were represented by equalities.  #@NEW_LINE#@#  Here we also have three possible cases which are as follows:  #@NEW_LINE#@#  
Case 1'.  #@NEW_LINE#@#  Consider Problem (6) with different types of trade-offs represented by inequalities.  #@NEW_LINE#@#  First, we assume that there is no any resource constraint in the model, and identify the set of optimal strategies of the colony, {(b*, v*)}.  #@NEW_LINE#@#  These optimal strategies require the binding of all trade-off constraints.  #@NEW_LINE#@#  Let us now add the resource constraint to the model.  #@NEW_LINE#@#  Case 1' requires that at least one strategy from {(b*, v*)} would remain optimal.  #@NEW_LINE#@#  This case corresponds to the situation in which the resource constraint does not influence the colony's well-being.  #@NEW_LINE#@#  In other words, Case 1' occurs in environments of good quality.  #@NEW_LINE#@#  
Case 2'.  #@NEW_LINE#@#  This case implies that the resource constraint influences the colonys well-being.  #@NEW_LINE#@#  Consider the following set of strategies:  #@NEW_LINE#@#  
(25)  #@NEW_LINE#@#  
Case 2' assumes that the set A' is not empty.  #@NEW_LINE#@#  This set includes the solutions of Problem (6) with different types of trade-offs represented by inequalities and the binding resource constraint.  #@NEW_LINE#@#  The set A' is similar to the set A described in the sub-section General statements of the previous section.  #@NEW_LINE#@#  In Appendix C in S1 Appendix we show that the elements of A' (and only these elements) are the solutions of Problem (6) with different types of trade-offs represented by inequalities.  #@NEW_LINE#@#  The maximum fitness that the colony can reach (i.e., the optimal fitness that the colony can reach by choosing any strategy from A') can be calculated using Eq (8).  #@NEW_LINE#@#  
Case 3'.  #@NEW_LINE#@#  This case implies that the resource constraint influences the colonys well-being and that the set A' is empty.  #@NEW_LINE#@#  Here, the mathematical solution becomes more complex and depends on the parameters of the model (see Appendix C in S1 Appendix).  #@NEW_LINE#@#  If all trade-off functions are concave or linear, then the set of optimal strategies can be found as follows.  #@NEW_LINE#@#  We should find strategies that maximize or minimize (depending of the model's parameters) the total fecundity of the colony subject to all trade-off constraints and under the assumption that all available resources are consumed by the colony (i.e., subject to the resource constraint, assuming that this constraint is binding).  #@NEW_LINE#@#  
Let us now consider Problem (6) with different types of trade-off functions (i.e., Original problem).  #@NEW_LINE#@#  We wonder how the solutions of Original problem change after replacing equalities by inequalities in trade-offs (after these changes we get Problem (6) with different types of trade-off functions and trade-offs inequalities, i.e., Modified problem).  #@NEW_LINE#@#  
- First, we assume that initially we had Case 1.  #@NEW_LINE#@#  The change of equalities by inequalities in the trade-off constraints does not change the problem's solutions.  #@NEW_LINE#@#  After this change, we get Case 1' in Modified problem.  #@NEW_LINE#@#  Indeed, assume that the strategy (b*,v*) is a solution of Original problem.  #@NEW_LINE#@#  This strategy remains feasible in the corresponding Modified problem.  #@NEW_LINE#@#  Let us now consider the strategy (b,v) in Modified problem, such that there exists a subset of cells, M, in the colony, such that for any cell i of M, we have: vi less_than i(bi).  #@NEW_LINE#@#  The strategy (b,v) is not optimal.  #@NEW_LINE#@#  To prove this statement, we consider a strategy (b1,v1), such that bi = bi1 for each cell i of the colony, and vi = vi1 for each cell i that is not in M, and vi1 = i(bi) for each cell i in M. We can see that B(b,v) = B(b1,v1) and V(b,v) less_than V(b1,v1), and so W(b, v) less_than W(b1, v1).  #@NEW_LINE#@#  If the strategy (b1,v1) is in the domain of Modified problem, the statement is proved.  #@NEW_LINE#@#  If not, we have to prove that W(b1,v1)  W(b*,v*).  #@NEW_LINE#@#  Indeed, let us consider the strategy (b*,v*)a solution of Original problem in Case 1.  #@NEW_LINE#@#  It means that (b*,v*) is a solution of Original problem in the absence of the resource constraint.  #@NEW_LINE#@#  Because (b1,v1) belongs to the domain of this problem, we can conclude that W(b1, v1)  W(b*, v*).  #@NEW_LINE#@#  Taking into account that the strategy (b*,v*) is feasible in Modified problem, we can also conclude that (b,v) is not optimal.  #@NEW_LINE#@#  Therefore, the solution of Modified problem belongs to the domain of Original problem.  #@NEW_LINE#@#  Furthermore, the domain of Original problem is a subset of the domain of Modified problem.  #@NEW_LINE#@#  Thus, we conclude that (b*,v*) is a solution of Modified problem in Case 1'.  #@NEW_LINE#@#  
- Second, we assume that initially we had Case 2.  #@NEW_LINE#@#  Thus, the set A represents the solution of Original problem.  #@NEW_LINE#@#  After changing the trade-off constraints (from equalities to inequalities), all points of the set A becomes points of the set A'.  #@NEW_LINE#@#  It means that we get Case 2' in Modified problem and all solutions of Original problem become solutions of Modified problem.  #@NEW_LINE#@#  More precisely, the set A' of all solutions of Modified problem contains all strategies from A as well as possible additional solutions, (b*,v*), for which some trade-off constraints are not binding.  #@NEW_LINE#@#  
- Third, we assume that initially we had Case 3.  #@NEW_LINE#@#  It means that the resource constraint matters and the set A is empty.  #@NEW_LINE#@#  As mentioned above, after changing the trade-off constraints (from = to ), all points of A becomes points of A'.  #@NEW_LINE#@#  Even though the set A is empty, the set A' can be nonempty.  #@NEW_LINE#@#  It leads to two different cases.  #@NEW_LINE#@#  The first case implies that the set A' is nonempty, and we get Case 2' of Modified problem.  #@NEW_LINE#@#  Here all optimal strategies require the existence of at least one cell in the colony, such that viability of this cell is smaller than the maximal possible viability that this cell can attain for a fixed level of fecundity (under the assumption that the only constraint that matters is the trade-off constraint).  #@NEW_LINE#@#  The second case implies that the set A' is empty.  #@NEW_LINE#@#  It means that we get Case 3' of Modified problem.  #@NEW_LINE#@#  
To complete our analysis, we consider the case of an empty domain in Original problem (denoted here as Case 0).  #@NEW_LINE#@#  Assume that we have an environment, such that the domain in Original problem is empty.  #@NEW_LINE#@#  After changing the trade-off constraints (from equalities to inequalities), we get Modified problem.  #@NEW_LINE#@#  In this case, we state that we get Case 2 in Modified problem.  #@NEW_LINE#@#  To prove this statement, we need to show that the set A' in Modified problem is non-empty.  #@NEW_LINE#@#  Because we are in Case 0 in Original problem, , and thus .  #@NEW_LINE#@#  Therefore, there exists b from RN, such that  for all i and .  #@NEW_LINE#@#  Because we are in Case 0, we have .  #@NEW_LINE#@#  Because  and , we get: .  #@NEW_LINE#@#  Therefore, there exists v from RN such that 0vii(bi) for all i and .  #@NEW_LINE#@#  It means that the point (b, v) is in A'.  #@NEW_LINE#@#  Thus, we are in Case 2 of Modified problem.  #@NEW_LINE#@#  
Case 0 can occur here only with equalities in the trade-off relationships.  #@NEW_LINE#@#  This case arises with a very low level of available resources and implies that the colony has no feasible strategies.  #@NEW_LINE#@#  In other words, if the environment is very poor, the colony dies in this environment.  #@NEW_LINE#@#  It looks reasonable from a biological point of view, that there exists a certain resource threshold, C#, such that if the amount of resources available to the colony becomes smaller than C#, then the colony dies.  #@NEW_LINE#@#  In our opinion, the existence of Case 0 is an advantage of the model with trade-offs in the form of equalities.  #@NEW_LINE#@#  Conversely, for each positive value of C, there is a feasible strategy for the colony in the model with trade-offs in the form of inequalities.  #@NEW_LINE#@#  Of course, the fitness of the colony tends to zero as the quality of environmental conditions tends to zero.  #@NEW_LINE#@#  So, formally, the colony has a feasible strategy and a positive, but a very low, fitness even though the amount of available resources is close to zero, i.e., the colony can survive in such an environment.  #@NEW_LINE#@#  Therefore, we should artificially introduce the threshold value of fitness, W#, into the model with trade-offs in the form of inequalities, such that the colony dies in an environment in which the highest attainable fitness is smaller than W#.  #@NEW_LINE#@#  Thus, we showed that the replacement of the trade-off functions vi = i(bi) by vi less_than i(bi) leads to a different analysis in Cases 3 and 0.  #@NEW_LINE#@#  It is worth noting that these results hold as well for non-additive forms of the viability function.  #@NEW_LINE#@#  
In addition, we will show that for Problem (6) with different types of trade-offs represented by inequalities, there is a direct link between the quality of the environment and the Case of solution obtained for this environment.  #@NEW_LINE#@#  Precisely, Case 1' occurs with large values of C, Case 2' with small values of C, and Case 3', if any, with intermediate values of C. This conclusion stems from the two following observations:  #@NEW_LINE#@#  
- Let us consider Problem (6) with different types of trade-offs represented by inequalities, but without the resource constraint.  #@NEW_LINE#@#  We will determine the set S of all solutions of this problem.  #@NEW_LINE#@#  This set is compact, so we can identify the minimal possible value, C*, of , such that there exists a solution (b*,v*) in S satisfying the following inequality: .  #@NEW_LINE#@#  Let us now consider Problem (6) with different types of trade-offs represented by inequalities and the resource constraint.  #@NEW_LINE#@#  For all C C*, Case 1' should occur here.  #@NEW_LINE#@#  
- Let us assume that there exists a level of available resources, C**  0, such that the set A'(C**) is nonempty.  #@NEW_LINE#@#  It means that Case 2' occurs in Problem (6) with different types of trade-offs represented by inequalities when C** is the amount of available resources.  #@NEW_LINE#@#  Let (b**,v**) be a solution belonging to A'(C**).  #@NEW_LINE#@#  We need to show that for all positive C less_than C**, Case 2' occurs in the considered version of Problem (6).  #@NEW_LINE#@#  In other words, we have to prove that A'(C) is nonempty for all positive C less_than C**.  #@NEW_LINE#@#  First of all, that each value of , such that 0    C**, can be represented as  = C**, where 0    1.  #@NEW_LINE#@#  We need to show that the strategy (b**,v**) belongs to A'().  #@NEW_LINE#@#  Indeed, bi**  0 and vi**  0 for all cells of a given colony, and .  #@NEW_LINE#@#  Moreover, for all cells of the colony we also have:  where the last inequality results from the assumption of a strictly decreasing form of trade-off functions.  #@NEW_LINE#@#  Thus, we showed that for the trade-off relationships of the form vi  i(bi), Case 3' takes place in environments of intermediate quality, Case 1' in environments of good quality, and Case 2' in environments of bad quality.  #@NEW_LINE#@#  In general, this is not true for the trade-off relationships of the form vi = i(bi).  #@NEW_LINE#@#  Here, Case 1 takes place in environments of good quality too, and Case 0 in environments of bad quality, but the situation with Cases 2 and 3 is more sophisticated.  #@NEW_LINE#@#  To show this, we consider the following numerical example which involves three cells with the following trade-off functions: v1 = 6  3b12, v2 = 4 b22 and v3 = 5  2b32.  #@NEW_LINE#@#  These trade-off functions are concave because we consider a small-sized colony.  #@NEW_LINE#@#  Let  =  = 1, k1 = 2 and k2 = 3.  #@NEW_LINE#@#  We will vary the level of available resources, C, in order to determine the Case of solution corresponding to it.  #@NEW_LINE#@#  First of all, assume that all trade-off relationships have the form of inequalities.  #@NEW_LINE#@#  For all values of C that are larger than C1 (C1  36.055), Case 1' takes place, so all cells are unspecialized.  #@NEW_LINE#@#  For all values of C that are smaller than C1 and larger than C2 (C2  18.3), Case 3' takes place.  #@NEW_LINE#@#  Here, the solution of the problem is a single point.  #@NEW_LINE#@#  Moreover, for all values of C that are smaller than C3 (C3  30.3) and larger than C2, the optimal strategy implies that the second cell specializes in reproductive function.  #@NEW_LINE#@#  For all values of C that are slightly larger than C2, the optimal strategy implies that b3*  b3max, i.e., we can say that at the optimum, cells 2 and 3 should specialize in reproductive function, while cell 1 remains unspecialized.  #@NEW_LINE#@#  For all positive values of C that are smaller than C2, Case 2' takes place and the solution represents a set of states.  #@NEW_LINE#@#  Furthermore, the decrease in the value of C directs the colony to unspecialized states.  #@NEW_LINE#@#  Thus, this example confirms that Case 3' takes place in environments of intermediate quality, Case 1' in environments of good quality and Case 2' in environments of bad quality when trade-offs are represented by inequalities.  #@NEW_LINE#@#  Now we replace now inequalities by equalities in trade-offs.  #@NEW_LINE#@#  Following our theory, for all values of C that are larger than C1, Case 1 takes place and for all values of C that are smaller than C1 and larger than C2, Case 3 takes place.  #@NEW_LINE#@#  Moreover, for these values of C, the solution does not change.  #@NEW_LINE#@#  However, for the values of C that are smaller than C2, some changes occur.  #@NEW_LINE#@#  Precisely, for all values of C that are smaller than C2 and larger than C4 (C4  16.5), Case 2 with unspecialized optimal states takes place, but for all values of C that are smaller than C4 and larger than C5 (C5  9.9), Case 3 occurs again.  #@NEW_LINE#@#  In the latter situation, cells 1 and 3 specialize in germ, while cell 2 remains unspecialized.  #@NEW_LINE#@#  For all values of C that are smaller than C5, Case 0 takes place.  #@NEW_LINE#@#  It means that the amount of resources available to the colony is smaller than the amount of resources sufficient for the colonys existence.  #@NEW_LINE#@#  
In this example, considering trade-offs in the form of inequalities, specialization occurs when the resource constraint influences the colonys well-being, but the amount of available resources is rather high.  #@NEW_LINE#@#  For trade-offs in the form of equalities, specialization occurs when the resource constraint influences the colonys well-being, whereas the amount of available resources can be rather high or rather small, but sufficient for the colonys survival.  #@NEW_LINE#@#  This case arises because the resource constraint prohibits the second cell from being specialized in germ.  #@NEW_LINE#@#  Thus, the second cell remains unspecialized.  #@NEW_LINE#@#  Moreover, in this example fecundity is cheaper than viability.  #@NEW_LINE#@#  Consequently, the first and the third cells should be specialized in germ.  #@NEW_LINE#@#  If we replace trade-offs in the form of equalities by those in the form of inequalities, each cell would have the opportunity to reduce its viability when its fecundity is fixed.  #@NEW_LINE#@#  Thus, in this case, the colony will be able to choose strategies that yield better fitness, and the unspecialized strategy becomes optimal.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
We have presented and analyzed a new general mathematical model for studying the emergence of germ-soma specialization.  #@NEW_LINE#@#  We have examined how the division of labor in a cell colony depends on the shape of trade-off functions, a resource constraint and different fecundity and viability rates.  #@NEW_LINE#@#  Thus, here we have generalized the popular fitness model introduced by Michod et al.  #@NEW_LINE#@#  [14].  #@NEW_LINE#@#  We have described the set of all possible solutions of the formulated mathematical programming problem and have depicted some interesting examples of optimal solutions found using our fitness function.  #@NEW_LINE#@#  We have shown that the changes in structural complexity in unspecialized large-sized colonies can lead to the emergence of specialization as well as to unspecialized optimal states in the case of environmental quality degradation (i.e., the lack of available environmental resources).  #@NEW_LINE#@#  This means that the process of functional specialization of Volvocalean green algae (GSGS/S) can be explained not only in terms of increasing the colony size [15].  #@NEW_LINE#@#  Moreover, we argue that significant resource restrictions and a trade-off between the production difficulties and the fitness benefits of fecundity can cause the emergence of specialization in small-sized colonies.  #@NEW_LINE#@#  We have also considered the case of different trade-off functions for different cells of the colony.  #@NEW_LINE#@#  Thus, we have assumed that some cells of the colony may not be equivalent with respect to viability or fecundity.  #@NEW_LINE#@#  We have explored several factors that can lead to the emergence of this non-equivalence, such as mutations, a specific developmental program, and positional effects.  #@NEW_LINE#@#  We have shown that positional effects and mutations in small-sized colonies can lead to the emergence of soma specialization without changes in size or in resource restrictions.  #@NEW_LINE#@#  
To conclude, we have described some cases in which the colony specialization can emerge.  #@NEW_LINE#@#  The existence of these cases is supported by a variety of experimental work [13], [26] and [27], but it would be certainly reasonable to provide more detailed quantitative analysis for testing the predictions of our models.  #@NEW_LINE#@#  Thus, it would be interesting to test our model in practice.  #@NEW_LINE#@#  One possible test of our model is to evolve Volvocalean green algae (small-sized and large-sized colonies) under different resource constraints and environmental conditions.  #@NEW_LINE#@#  Moreover, in this kind of experiment we should keep in mind that the generation time, or the time for growth, can change during the evolutionary process, and take it into account in the model.  #@NEW_LINE#@#  It is worth noting that different positional effects can occur during the experiment.  #@NEW_LINE#@#  Consequently, we should divide cells into different relevant groups.  #@NEW_LINE#@#  Such a division will allow testing the model with different types of cells.  #@NEW_LINE#@#  
Another interesting issue is the model's specification.  #@NEW_LINE#@#  In particular, this issue concerns the form of trade-off relationships.  #@NEW_LINE#@#  We have considered two versions of our model: with trade-offs of the form vi = i(bi) and those of the form vi  i (bi).  #@NEW_LINE#@#  In the previous section, we have described all possible situations where the solutions of the related problems have the same structure, or even coincide, as well as where they have different structures.  #@NEW_LINE#@#  We have discussed different specialization effects that can take place in different instances of our model.  #@NEW_LINE#@#  Clearly, focusing on a specific type of organisms would allow a better understanding of the true specialization effects and, consequently, would indicate the best way of modeling the trade-off constraints.  #@NEW_LINE#@#  Moreover, it is worth noting that clarifying the best way of modeling the environmental impact is an essential issue as well.  #@NEW_LINE#@#  Here, we have considered the resource constraint of the form (5).  #@NEW_LINE#@#  However, some questions concerning the parameters of this constraint remain open.  #@NEW_LINE#@#  For example, should the cost, in terms of resources necessary to produce a unit of fecundity or a unit of viability, depend on the size of the colony, i.e., should the parameters k1 and k2 be functions of N?  #@NEW_LINE#@#  Or, should the cost, in terms of resources necessary to produce a unit of fecundity, be the same when this fecundity is produced by a single germ cell or two generalist cells, i.e., should the parameter k1 be a function of B and V?  #@NEW_LINE#@#  Or, should the quantity of resources necessary to produce a unit of viability depend on positional effects, i.e., should the parameter k2 be a function of the variables v1,..,vN?  #@NEW_LINE#@#  There are also some interesting questions concerning the best way of modeling the effect of a limiting environment.  #@NEW_LINE#@#  For example, instead of the resource constraint of the form (5), one could consider a parameterized family of trade-off functions, such that vi = i(bi,C) (see for example [14] or [32]).  #@NEW_LINE#@#  Such a model would be different from that described in our paper, though possibly, some equivalence between the two models could be found at some optimal states.  #@NEW_LINE#@#  One important advantage of the resource constraint of the form (5) is that all parameters of this constraint can be measured directly.  #@NEW_LINE#@#  In the case of a parameterized family, vi = i(bi,C), the parameter estimation process seems to be much more complicated.  #@NEW_LINE#@#  
Another important issue is the robustness of our model.  #@NEW_LINE#@#  On one hand, our model is robust because its qualitative results do not depend on the specific form of trade-off functions.  #@NEW_LINE#@#  They depend only on the curvature of these functions (i.e., convex, linear or concave), which is determined by the size of the colony.  #@NEW_LINE#@#  On the other hand, we have mentioned that the assumption of additivity is rather questionable for the viability function.  #@NEW_LINE#@#  We have shown that in many instances of our model the property of additivity is not necessary for the viability functions.  #@NEW_LINE#@#  However, some of our results are based on the additivity assumption.  #@NEW_LINE#@#  It would be interesting to investigate how these results would change in the case of a non-additive form of the viability function.  #@NEW_LINE#@#  For example in this work, as well as in the studies of Michod et al.  #@NEW_LINE#@#  and Solari et al.  #@NEW_LINE#@#  [1415], it is assumed that all cells of the colony have trade-offs with the same type of curvature.  #@NEW_LINE#@#  It would be also interesting to analyze the case where some cells of the colony have convex trade-offs and the other have concave trade-offs.  #@NEW_LINE#@#  According to a recent study of Leslie et al.  #@NEW_LINE#@#  [33], it is natural to assume that such a case can occur in an intermediate-sized colony in which we have cell generation times such that the colony's trade-off functions are linear, on average, but due to within-colony variation some of them can be slightly convex or concave.  #@NEW_LINE#@#  Moreover, some cells can have neither convex nor concave trade-off functions that correspond to intermediate initial costs of reproduction [14].  #@NEW_LINE#@#  It is clear that in such a situation Case 2 described here does not change, but the analysis of Cases 1 and 3 becomes more complicated because some additional parameters, including the numbers of convex and concave cells in the colony, will be added to the model.  #@NEW_LINE#@#  An extensive additional analysis would be required to find optimal specialization patterns in these instances.  #@NEW_LINE#@#  If both convex and concave trade-offs are allowed in the model, Case 1 of this model should represent a kind of average between Case 1 in the strictly convex and Case 1 in the strictly concave trade-off models in terms of the number of specialized cells in the colony.  #@NEW_LINE#@#  Also, we can anticipate that the general principle of finding solutions in Case 3 with concave and linear trade-offs would not change here: the optimal reproductive strategies would be the available strategies from the resource surface such that they have the same total fecundity and the value of this total fecundity is the closest one (among all available strategies from the resource surface) to the unavailable total fecundity calculated according to Eq (7).  #@NEW_LINE#@#  Nevertheless, the detailed structure and the geometry of these solutions seem to be much more diverse and complex than the solution structure of Case 3 presented in this paper.  #@NEW_LINE#@#  
Another challenging question is the investigation of the role of positional effects in our model.  #@NEW_LINE#@#  We can incorporate into the model the information about the form of the colony (e.g., sphere or line) and consider the impact of positional effects in each case.  #@NEW_LINE#@#  Such a development will enable us to gain more insight into the structure and properties of trade-off functions.  #@NEW_LINE#@#  
It is worth noting that the proposed model can be generalized to address a number of relevant biological issues, including the evolution of specialized enzymes or the emergence of complex organs.  #@NEW_LINE#@#  Importantly, the presented fitness model is of a general nature and could be also applied to address a number of parallel issues in different fields, such as economics, where fitness could be associated with the production volume, or education, where fitness could be associated with the effectiveness of the process of education, or health care, where fitness could be associated with life expectancy or life quality.  #@NEW_LINE#@#  

Supporting_information  #@NEW_LINE#@#  
S1_Appendix_The_proofs_of_main_results  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0201446.s001  #@NEW_LINE#@#  
(DOCX)  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
The authors thank two anonymous reviewers and Dr Sergey Gavrilets for helpful comments and suggestions.  #@NEW_LINE#@#  

References  #@NEW_LINE#@#  


