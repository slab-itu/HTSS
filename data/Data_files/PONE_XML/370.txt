article id="http://dx.doi.org/10.1371/journal.pone.0162428"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
A Liver-Centric Multiscale Modeling Framework for Xenobiotics  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
We describe a multi-scale, liver-centric in silico modeling framework for acetaminophen pharmacology and metabolism.  #@NEW_LINE#@#  We focus on a computational model to characterize whole body uptake and clearance, liver transport and phase I and phase II metabolism.  #@NEW_LINE#@#  We do this by incorporating sub-models that span three scales; Physiologically Based Pharmacokinetic (PBPK) modeling of acetaminophen uptake and distribution at the whole body level, cell and blood flow modeling at the tissue/organ level and metabolism at the sub-cellular level.  #@NEW_LINE#@#  We have used standard modeling modalities at each of the three scales.  #@NEW_LINE#@#  In particular, we have used the Systems Biology Markup Language (SBML) to create both the whole-body and sub-cellular scales.  #@NEW_LINE#@#  Our modeling approach allows us to run the individual sub-models separately and allows us to easily exchange models at a particular scale without the need to extensively rework the sub-models at other scales.  #@NEW_LINE#@#  In addition, the use of SBML greatly facilitates the inclusion of biological annotations directly in the model code.  #@NEW_LINE#@#  The model was calibrated using human in vivo data for acetaminophen and its sulfate and glucuronate metabolites.  #@NEW_LINE#@#  We then carried out extensive parameter sensitivity studies including the pairwise interaction of parameters.  #@NEW_LINE#@#  We also simulated population variation of exposure and sensitivity to acetaminophen.  #@NEW_LINE#@#  Our modeling framework can be extended to the prediction of liver toxicity following acetaminophen overdose, or used as a general purpose pharmacokinetic model for xenobiotics.  #@NEW_LINE#@#  

Introduction  #@NEW_LINE#@#  
Pharmacological and toxicological processes occur across a wide range of spatial and temporal scales and include multiple organ systems.  #@NEW_LINE#@#  An in silico pharmacological model must include sub models that cover these multiple scales and multiple tissues relevant to human medicine and toxicology.  #@NEW_LINE#@#  We have developed a liver-centered, mechanism based, multiscale in silico simulation framework for xenobiotic toxicity and metabolism that incorporates four key biological scales: (1) Population variation scale, (2) Physiologically Based Pharmacokinetic (PBPK) whole body scale, (3) Tissue and multicellular scale, and (4) Sub-cellular signaling and metabolic pathways scale.  #@NEW_LINE#@#  Our multiscale in silico framework focuses on the liver, a critical organ in many toxicological, pharmacological, normal and disease processes.  #@NEW_LINE#@#  As an example of linking these models, from the whole body to the sub-cellular, we present a model of acetaminophen (APAP, paracetamol in most of the world) Absorption, Distribution, Metabolism and Excretion (ADME).  #@NEW_LINE#@#  We link existing open source tools into an aggregate model instead of building a single monolithic model.  #@NEW_LINE#@#  This approach allows us to leverage not only pre-existing tools but also pre-existing models at the individual scales.  #@NEW_LINE#@#  
The liver is the primary metabolizing organ of the body and is the first line of defense against toxicants.  #@NEW_LINE#@#  The liver is a massively parallel device that presents unique challenges and opportunities for modeling not present in other organs.  #@NEW_LINE#@#  The livers central role in metabolism places it at the center of many pharmacological and toxicological processes.  #@NEW_LINE#@#  In addition, the liver is a key player in both the bodys homeostatic control processes and in a number of important human diseases such as hypercholesterolemia, obesity and Type II diabetes.  #@NEW_LINE#@#  Our choice of APAP as the reference compound was based on the extensive literature on its pharmacology and toxicology, including extensive data in both humans and laboratory animals.  #@NEW_LINE#@#  APAP is a widely used over the counter analgesic and fever reducer.  #@NEW_LINE#@#  APAPs therapeutic index (ratio of toxic dose to therapeutic dose) is unusually small for an over the counter medication.  #@NEW_LINE#@#  Overdose results in rapid centrilobular necrosis (cell death in the vicinity of the smallest draining veins) of the liver, which can lead to liver failure and death.  #@NEW_LINE#@#  APAP is the leading cause of acute liver failure in the Western world [1].  #@NEW_LINE#@#  
The liver is a critical organ with essential functions in uptake, storage and metabolism of amino acids, lipids, carbohydrates, and vitamins [2].  #@NEW_LINE#@#  The liver also plays a central role in metabolism and elimination of xenobiotics.  #@NEW_LINE#@#  Its anatomical position in the blood flow between the gastro-intestinal (GI) tract and systematic circulation allows the liver to act as a gateway linking the GI system with the rest of the body [3].  #@NEW_LINE#@#  The liver is composed of millions of functional units, termed hepatic lobules, that are plumbed by the liver vasculature in a highly parallel layout.  #@NEW_LINE#@#  When a portion of blood (e.g., a red blood cell) transits the liver it passes through exactly one lobule.  #@NEW_LINE#@#  Blood enters the lobule via portal triads, consisting of an arteriole, venule and bile duct, and after passing through the sinusoid network drains into the lobules central vein.  #@NEW_LINE#@#  Each hepatic lobule consists of several cell types.  #@NEW_LINE#@#  Hepatocytes, the parenchymal cell of the liver, constitute the majority of livers mass and carry out the majority of the metabolism of nutrients and toxins.  #@NEW_LINE#@#  Non-parenchymal cells, including Kupffer cells, liver stellate (Ito) cells and sinusoidal endothelial cells, make up the remainder of the livers mass and also contribute to the livers functions.  #@NEW_LINE#@#  Kupffer cells are resident macrophages of the liver that contribute to normal physiology and homeostasis as well as participating in immune responses to liver injury [4, 5].  #@NEW_LINE#@#  Stellate cells contribute to flow sensing and regulatory functions and become activated in response to liver damage [6] (see [7] for a comprehensive review).  #@NEW_LINE#@#  Fenestrated (porous) endothelial cells form the linings of the capillary vessel walls, the liver sinusoids, and dynamically regulate vessel size and blood flow in response to mechanical and chemical signals.  #@NEW_LINE#@#  The endothelial cell lined sinusoids are separated from the hepatocytes by the perisinusoidal space (Space of Disse) that contains blood plasma and microvilli from the hepatocytes, which facilitates rapid transfer of compounds between the blood and the parenchyma of the lobule.  #@NEW_LINE#@#  In addition to the sinusoids the lobule contains a second flow path, the bile canaliculi, that transport bile from the hepatocytes back to the portal triad where it is collected into the bile ducts.  #@NEW_LINE#@#  
Each lobule displays heterogeneous capabilities both in terms of blood flow and hepatocyte activity.  #@NEW_LINE#@#  In each lobule, hepatocytes radiate from the center to the periphery separated by a network of sinusoids.  #@NEW_LINE#@#  Blood flow enters the hepatic lobule via the hepatic artery and hepatic portal vein, flows through the network of sinusoids past the hepatocytes, and empties into the lobules central vein.  #@NEW_LINE#@#  Hepatocytes situated in different regions of the hepatic lobule have different expression levels of transporter proteins and different metabolic enzymes profiles resulting in regional differences in metabolism across the lobule and sinusoid [8].  #@NEW_LINE#@#  In addition, the highly interconnected network of sinusoids results in complex blood flow within each lobule [9].  #@NEW_LINE#@#  
APAP is extensively metabolized in the liver via both Phase I and Phase II pathways [10].  #@NEW_LINE#@#  Phase II pathways convert APAP into sulfate and glucuronide conjugates.  #@NEW_LINE#@#  Phase I metabolism, primarily via Cytochrome P450s (CYP) 2E1 and 1A2, generates N-acetyl-p-benzoquinone imine (NAPQI), an alkylating agent capable of covalently modifying a number of cellular components.  #@NEW_LINE#@#  The majority of NAPQI reacts with cellular glutathione (GSH) giving a thiol adduct NAPQI-GSH.  #@NEW_LINE#@#  In cases of APAP overdose, depletion of cellular GSH is thought to be causative in hepatocyte death (necrosis).  #@NEW_LINE#@#  Acute overdose of APAP results in extensive necrosis of hepatocytes in the centrilobular regions of the liver [11].  #@NEW_LINE#@#  Although it is not fully understood how the depletion of GSH progresses to necrosis, its believed that reactive oxygen species play a significant role [12].  #@NEW_LINE#@#  The combination of Phase I and II metabolism is a common feature of xenobiotic metabolism and applies, to varying degrees, to most xenobiotics.  #@NEW_LINE#@#  
Computational models of liver function and toxicity: Modeling a toxicological or pharmacological event requires the integration of processes that spread across different spatial and temporal scales as shown in Fig 1.  #@NEW_LINE#@#  At the whole body level, compounds are absorbed from the GI tract, distributed among the tissues and organs, and filtered and excreted by the kidneys.  #@NEW_LINE#@#  The compound diffuses within the blood, and partitions between the serum, serum proteins (such as albumin) and blood cells.  #@NEW_LINE#@#  At the liver tissue level, compounds enter the liver via the hepatic artery and portal vein, flow through the network of sinusoids within the hepatic lobules, and empties into the hepatic central vein.  #@NEW_LINE#@#  The compound transports, generally via both passive (diffusive) and active transport pathways, into and out of the hepatocytes lining the sinusoids.  #@NEW_LINE#@#  At the sub-cellular level, metabolic pathways within the hepatocytes convert the compound into metabolites.  #@NEW_LINE#@#  The metabolites are transported (either actively or passively) back into the blood circulation or into the bile pathway.  #@NEW_LINE#@#  Hepatocytes may proliferate, migrate or die, in response to the compound or its metabolites.  #@NEW_LINE#@#  Gene expression patterns orchestrate the spatial distribution of the metabolic processes within the lobule.  #@NEW_LINE#@#  To computationally model the multiple scales as well as their interactions we must integrate temporally and spatially across the relevant tissues.  #@NEW_LINE#@#  
Length scales (left) of biological processes (center) and the corresponding modeling modalities (right).  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.g001  #@NEW_LINE#@#  
Many studies have used whole-body PBPK models to describe APAP ADME [1319].  #@NEW_LINE#@#  These models are able to reproduce the ADME data for APAP and its metabolites and are validate against in vivo data.  #@NEW_LINE#@#  Some of these models elaborate the description of APAP metabolism and toxicity through integration of a more detailed subcellular genome-scale flux balance metabolism model [14] or kinetic model of GSH depletion [15, 18].  #@NEW_LINE#@#  Other studies focused on systems biology models of APAP metabolism and GSH homeostasis, such as [20].  #@NEW_LINE#@#  Ben-Shachar et.  #@NEW_LINE#@#  al [19] developed an extended PBPK model of APAP metabolism in humans.  #@NEW_LINE#@#  Their model includes transport and metabolism of APAP, to the glucuronide and sulfate metabolites, as well as GSH metabolism.  #@NEW_LINE#@#  This model was calibrated using in vitro human data for APAP and the two major metabolites and models the toxicity of APAP as well as the effectiveness of clinical interventions for APAP overdoses.  #@NEW_LINE#@#  
One important aspect missing from these models is the spatial architecture of the metabolizing organ and the spatial distribution of metabolic enzymes such as CYP450 2E1 at different lobular locations.  #@NEW_LINE#@#  A model of APAP metabolism that treats the liver as a well stirred compartment may miss or underestimate the heterogeneity of the livers responses.  #@NEW_LINE#@#  With advancement of imaging techniques, recent modeling studies increasingly incorporate organ-specific structural and spatial features, in addition to biochemical properties of endogenous or exogenous compounds, into their representation of the liver and in understanding metabolism and toxicity [2123].  #@NEW_LINE#@#  Perhaps the most complete attempt at reconstructing the complex microvasculature of a liver lobule was accomplished by Hoehme et.  #@NEW_LINE#@#  al [21].  #@NEW_LINE#@#  To our knowledge, this reconstructed lobule has not been used to model blood flow within the lobule, or microdosimetry of individual hepatocytes.  #@NEW_LINE#@#  The reconstructed lobule has also been combined with a whole-body PBPK model and a two or three compartment ODE based lobule model, giving a multiscale model that couples from the whole-body to liver-lobule zone [22, 23].  #@NEW_LINE#@#  
Additional models of the complex blood flow within a liver lobule have been created using advection-diffusion models in which the liver lobule is treated as a homogeneous, though perhaps anisotropic, medium [24].  #@NEW_LINE#@#  These models make predictions on qualities such as the blood flow rate and pressure drop across a lobule but do not model discrete sinusoids or hepatocytes.  #@NEW_LINE#@#  Additional advection-diffusion models have been developed that combine the lobule scale with a whole body scale [25] and that include cellular signaling and metabolic pathways [26].  #@NEW_LINE#@#  These later models have been applied to a selection of compounds, such as caffeine and insulin, but have not been applied to APAP.  #@NEW_LINE#@#  Several of these projects are part of the German Virtual Liver Network (VLN) (http://www.virtual-liver.de), which has made progress in constructing multiscale, liver-centric modeling frameworks (e.g.  #@NEW_LINE#@#  [2628]).  #@NEW_LINE#@#  The VLN project is attempting to incorporate submodels that span the entire range of biological scales.  #@NEW_LINE#@#  
Hunt and coworkers developed a physiologically based object-oriented in silico liver (ISL) model that characterizes hepatic disposition of compounds via geometrical representations of liver structure and function.  #@NEW_LINE#@#  This model included a blood flow network at the lobular level, small molecule transport and metabolism within individual simulated hepatocytes at the cellular level, all embedded in a whole-body PBPK model [29, 30].  #@NEW_LINE#@#  The model was calibrated using human in vitro data and functional responses of ISL agents were mapped back to the in vitro data.  #@NEW_LINE#@#  
Wambaugh and Shah constructed a spatially heterogeneous sinusoidal network representing a hepatic lobule, and used the virtual lobule as a replacement for the liver compartment in a whole-body PBPK model.  #@NEW_LINE#@#  They then used this aggregate model to calculate tissue microdosimetry [31].  #@NEW_LINE#@#  
Diaz Ochoa and coworkers developed a multiscale model of the toxic effects of APAP [32].  #@NEW_LINE#@#  In their model, the liver lobule was represented as a set of unbranched sinusoids and surrounding hepatocytes.  #@NEW_LINE#@#  Individual hepatocytes contained instances of the subcellular metabolic pathways.  #@NEW_LINE#@#  This liver lobule was then embedded in a whole-body PBPK.  #@NEW_LINE#@#  Movement of blood born APAP within the sinusoids was modeled using an advection-diffusion equation.  #@NEW_LINE#@#  
Most of the models described above suffer from an important limitation; it is difficult to reproduce or reuse the models since the source codes were not published.  #@NEW_LINE#@#  Even when source code is published it is often difficult to map biological concepts (e.g., chemical species, biological processes, etc.)  #@NEW_LINE#@#  in the publication to variables in the source code.  #@NEW_LINE#@#  To effectively make a model reusable requires that the model is encoded in a standard syntax.  #@NEW_LINE#@#  The standard syntax should be able to describe both the computation and the biology that the model represents.  #@NEW_LINE#@#  
Scientific Goals: We set out to develop a first attempt at a general purpose xenobiotic modeling framework capable of integrating three key biological scales in a shareable and well documented way.  #@NEW_LINE#@#  The scales range form the whole-body to the sub-cellular.  #@NEW_LINE#@#  Integration across these scales allows for the coupling of experimental data obtained at a variety of scales, ranging from ADME data describing uptake, distribution and clearance, to tissue and cell level microdosimetry in a key organ (liver), to subcellular reaction kinetics models describing metabolism.  #@NEW_LINE#@#  The framework is meant to be shareable and reusable, in whole or part, by other workers and in other biological modeling applications.  #@NEW_LINE#@#  Finally, the framework is meant to demonstrate annotation of the included biological concepts within the model files to the extent currently possible.  #@NEW_LINE#@#  
Design Goals for a MultiscaleMultimodal Model: We set out to build a multi-scale model of xenobiotic metabolism that conforms to the following design principles:  #@NEW_LINE#@#  
Reuse of existing models, and adherence to modeling standards at the particular scales, is a key aspect of the Responsible Conduct of Research.  #@NEW_LINE#@#  (http://www.nsf.gov/bfa/dias/policy/rcr.jsp)  #@NEW_LINE#@#  
Model framework: We introduce a multiscale modeling framework for small molecule, liver-centric, multiscale ADME modeling that bridges different temporal and spatial scales (Fig 1) and is built and executed using standard open-source software packages.  #@NEW_LINE#@#  At the whole-body level, we take advantage of PBPK modeling to characterize the disposition (i.e., absorption, distribution, metabolism and excretion) of APAP (Fig 2:1b).  #@NEW_LINE#@#  The PBPK model allows us to couple the tissue and lower scale models to the common routes of whole-body uptake and clearance, which is of critical importance [27].  #@NEW_LINE#@#  In addition, the majority of in vivo data for xenobiotics in humans consists of xenobiotic concentrations measured in the blood or serum, which is well modeled by PBPK.  #@NEW_LINE#@#  At the organ and tissue levels, we construct a virtual liver based on parallel tube simplification and simulate blood flow within a sinusoid using the Cellular Potts Model [33, 34] (Fig 2:2b).  #@NEW_LINE#@#  At the sub-cellular level, we describe GSH synthesis and APAP metabolism (both Phase I and Phase II) within each hepatocyte using reaction kinetic models (Fig 2:3b).  #@NEW_LINE#@#  The composite model is flexible and adaptable and can be modified to represent different species, populations or xenobiotics.  #@NEW_LINE#@#  Each module in our framework is sufficiently complete to run in the absence of the other modules, which makes it easier to explore different modules and computational modalities at the individual scales.  #@NEW_LINE#@#  Our framework is a step towards developing defensible, annotated, shareable and reusable models of small molecule ADME and liver based metabolism and toxicity.  #@NEW_LINE#@#  
Whole body uptake, distribution and clearance (1a) is represented as a PBPK model (1b) in SBML.  #@NEW_LINE#@#  The rectangular compartments represent tissues or blood compartments with blood flows between compartments indicated by black arrows.  #@NEW_LINE#@#  The compartment labeled Rest is the remainder of the body.  #@NEW_LINE#@#  The blue arrows and ovals represent non-blood borne transfer between compartments and organ lumens or, in the case of liver metabolism, an unspecified location external to the PBPK model.  #@NEW_LINE#@#  The tissue scale model of the liver (2a) is represented in CC3D as a single sinusoid modeled as a linear pipe lined with hepatocytes (green) (2b).  #@NEW_LINE#@#  Blood flow within the sinusoid consists of RBCs (red) and portions of serum (blue).  #@NEW_LINE#@#  Portions of serum are modeled as generalized cells.  #@NEW_LINE#@#  The hepatocyte (3a) metabolic pathways (3b) are model as a set of chemical reactions expressed in SBML.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.g002  #@NEW_LINE#@#  
As a proof of concept drug for our multiscale framework we choose APAP.  #@NEW_LINE#@#  APAP is rapidly absorbed from GI tract following an oral dose, distributed across organs via the systemic circulation, metabolized by the liver and other tissues, and excreted by the kidneys.  #@NEW_LINE#@#  In humans, there are three primary metabolic pathways for APAP (Fig 2:3b).  #@NEW_LINE#@#  At therapeutic doses the majority of APAP is metabolized by the liver to form glucuronide and sulfate conjugates (APAPG and APAPS), both are non-toxic, non-therapeutic and rapidly cleared.  #@NEW_LINE#@#  55% to 60% of the dose recovered in the urine is present as APAPG, and APAPS accounts for 30% to 35% [35, 36].  #@NEW_LINE#@#  Only a small amount of unchanged APAP is detected in the urine.  #@NEW_LINE#@#  In the liver APAP also undergoes Phase I metabolism, mediated by CYP enzymes, to form the reactive moiety N-acetyl-p-benzoquinone imine (NAPQI).  #@NEW_LINE#@#  For pharmacological doses of APAP, NAPQI is effectively detoxified through conjugation with cellular Glutathione (GSH).  #@NEW_LINE#@#  However, high doses of APAP lead to overproduction of NAPQI and consequently depletion of hepatic GSH, which leads to necrosis.  #@NEW_LINE#@#  
In this work, we model a pharmacological doses of APAP and leave the modeling of APAP overdose and hepatocyte necrosis for future study.  #@NEW_LINE#@#  A simulated therapeutic dose of 20 mg/Kg orally administered to a 70 Kg (1.4g total dose) in silico male patient is used as the standard model.  #@NEW_LINE#@#  We are particularly interested in predicting the serum concentrations (ADME curves) of APAP, APAPG and APAPS for the 8 hours following the single oral dose.  #@NEW_LINE#@#  

Models  #@NEW_LINE#@#  
Our workflow for developing a computational model includes three types of model definitions.  #@NEW_LINE#@#  The first model definition is of a Biological Model (also known as a conceptual model) that is typically created with the help of a biological domain expert.  #@NEW_LINE#@#  This model is often graphical in nature (for example Fig 2:1b, 2b and 3b) and describes what is known about the system and what is thought to be relevant to a particular problem.  #@NEW_LINE#@#  This level of modeling detail is familiar to biologists and typically includes a list of the parts and their interactions.  #@NEW_LINE#@#  
The second model definition is a of Mathematical Model where the components and processes of the biological model are expressed in mathematical forms that implement the physical and chemical interpretations of the biological components (as in Table 1).  #@NEW_LINE#@#  At this stage of model development rigorous definitions of the mathematical forms, the parameters and measurables of the model are defined.  #@NEW_LINE#@#  Here the modeler is forced to make significant assumptions about the behavior of the system and these assumptions challenge and add value to the starting biological model.  #@NEW_LINE#@#  The mathematical model is the point where the modeling workflow migrates from the biological domain to the physics, chemistry or engineering domains.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.t001  #@NEW_LINE#@#  
The third level of model definition is the conversion of the mathematical model into a Computational Model where the components of the mathematical model are implemented in computational code.  #@NEW_LINE#@#  There may be implementation-dependent uncertainties introduced at this step if the computational representation does not adequately represent the mathematical model.  #@NEW_LINE#@#  Therefore, there is a verification step needed to insure that the computational model adequately represents the mathematical model.  #@NEW_LINE#@#  If the computational model uses an excepted compute platform then some of the verification effort can be avoided.  #@NEW_LINE#@#  For example, for a mathematical model consisting of a set of coupled ODEs the modeler could (1) create a solver from scratch, or they could (2) use a preexisting ODE solver package (e.g., MATLABs dsolve package), or if the ODEs represent a set of chemical reactions, they could (3) use a standard modeling platform like COPASI [37] (www.copasi.org) or CellDesigner [38] (www.celldesigner.org) specifically designed for that type of problem.  #@NEW_LINE#@#  In the first case it is difficult for a third party to verify the code since they would need access to both the code and to the computing environment.  #@NEW_LINE#@#  In addition, the linkage between biological concepts and the code may be obscure.  #@NEW_LINE#@#  In the second case third-party verification is somewhat easier since the reliability of the ODE solver package may have already been confirmed by other workers.  #@NEW_LINE#@#  Verification is also easier in the third case.  #@NEW_LINE#@#  The third case also has an important advantage over the first two in that it is often possible to annotate the source code by identifying the biological concepts that particular computational constructs, such as variables and subroutines, represent.  #@NEW_LINE#@#  It is only in the third case where it is practical to directly link the computational model back to the biological model.  #@NEW_LINE#@#  
For each of the three biological scales that we represent there are biological, mathematical and computational models, which we will describe in detail below.  #@NEW_LINE#@#  
Biological_models  #@NEW_LINE#@#  
A multi-scale in silico model is expected to characterize processes taking place at each scale, and to integrate the processes and scales in an appropriate manner.  #@NEW_LINE#@#  In our modeling framework, three different biological scales are taken into account.  #@NEW_LINE#@#  
In addition to the three scales described above we can also simulate a population as a set of model replicates, each with individualized parameters.  #@NEW_LINE#@#  

Mathematical_and_Computational_models  #@NEW_LINE#@#  
We have used standard modeling modalities for each of the three scales introduced above.  #@NEW_LINE#@#  Subcellular reaction kinetics are modeled as a set of coupled ordinary differential equations (ODEs) using the Systems Biology Markup Language (SBML) [41, 42], which was specifically developed for reaction kinetic models such as this.  #@NEW_LINE#@#  The multicell sinusoid tissue model was modeled in two dimensions using Compucell3D (CC3D), an implementation of the Cellular Potts model.  #@NEW_LINE#@#  CC3D implements the flowing blood (RBCs and serum) within the sinusoid along with the fixed hepatocytes.  #@NEW_LINE#@#  CC3D also implements the diffusive and active transport processes between the components of the blood and the hepatocytes.  #@NEW_LINE#@#  For the whole-body PBPK scale there is currently no accepted standard modeling modality.  #@NEW_LINE#@#  Since PBPK models are typically sets of coupled ODEs we have used SBML to model this scale as well.  #@NEW_LINE#@#  We use the SBMLcompartment concept to represent the PBPK tissue compartments.  #@NEW_LINE#@#  
A key advantage of developing models in SBML is the ability to directly annotate biological components within the model.  #@NEW_LINE#@#  For example, in SBML a chemical species can be annotated by reference to the Chemical Entities of Biological Interest ontology (https://www.ebi.ac.uk/chebi/), compartments by reference to cell (e.g., http://obofoundry.org/ontology/cl.html) or tissue (http://sig.biostr.washington.edu/projects/fm/) ontologies and reactions and biological processes to, for example, the Gene Ontology (http://geneontology.org/).  #@NEW_LINE#@#  
Whole-body PBPK Module: We use a standard PBPK compartment model approach to model the uptake, distribution and clearance of APAP following oral dosing (Fig 2:1b).  #@NEW_LINE#@#  In this model, boxes represent the quantity of APAP in an organ or blood compartment.  #@NEW_LINE#@#  Compartments are modeled as well stirred so that no concentration gradients exist within a compartment.  #@NEW_LINE#@#  Arrows represent the movement of drug-bearing blood between different compartments of the body.  #@NEW_LINE#@#  Typical parameters in PBPK models include the volumetric flow rates between compartments (e.g., organs), compartment perfusable volumes, partition coefficients, unbound fraction of xenobiotic in plasma and the hematocrit (RBC to blood volume ratio).  #@NEW_LINE#@#  The equations for the transfer rates are given in Table 1 and the base set of parameters are given in Table 2.  #@NEW_LINE#@#  The parameters for a typical PBPK model can be divided into two subsets: parameters that are independent of the compound being modeled, such as tissue volumes and blood flow rates, and parameters that are compound dependent, such as partition coefficients and uptake rates.  #@NEW_LINE#@#  These two types of parameters are listed separately in Table 2.  #@NEW_LINE#@#  Since there is no accepted standard for the specification of PBPK models we have used SBML as the specification language for the PBPK ODEs.  #@NEW_LINE#@#  The PBPK model of Wambaugh and Shah [31] was translated into SBML using SBW tools, particularly Jarnac [43] and JDesigner [44].  #@NEW_LINE#@#  (The Systems Biology Workbench, including Jarnac, is available at http://sys-bio.org/.)  #@NEW_LINE#@#  Annotation was carried out using SBMLeditor [45] (http://www.ebi.ac.uk/compneur-srv/SBMLeditor.html) and the resulting SBML validated, including the units [46] (http://sbml.org/Facilities/Validator/).  #@NEW_LINE#@#  We paid particular attention to annotating the compounds (e.g., APAP and metabolites) and compartments (organs), and ensured that all parameters had SBML compliant unit definitions.  #@NEW_LINE#@#  Compartment volumes and blood flow rates used standard PBPK values [47] that were allometrically scaled to a 70 Kg human male.  #@NEW_LINE#@#  In this PBPK model the metabolism of APAP in the liver is represented by a single ODE representing removal (metabolism) of APAP.  #@NEW_LINE#@#  APAP is known to be extensively reabsorbed from the kidney tubules [36], in our model we represent this by modifying the glomerular filtration rate (Qgfr).  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.t002  #@NEW_LINE#@#  
Replicates of this APAP PBPK model, with differing compound specific parameters and initial conditions, was used to model the distribution and clearance of the two APAP phase II metabolites, APAPG and APAPS, in the complete multiscale model.  #@NEW_LINE#@#  This whole-body PBPK model has been deposited in the BioModels Database [63] (http://www.ebi.ac.uk/biomodels-main/) as MODEL1509230010.  #@NEW_LINE#@#  
Tissue Module: The tissue module describes the behavior of blood flow within a simplified hepatic sinusoid as well as the transport of xenobiotic between the blood components and hepatocytes.  #@NEW_LINE#@#  We used the open-source multicell modeling package CompuCell3D (CC3D) [53] to model the blood components and flow, the hepatocytes and transfer of APAP (and metabolites) between the blood and hepatocytes.  #@NEW_LINE#@#  CC3D, an implementation of the Cellular Potts Model [54], is a lattice based description of systems of generalized biological cells where each individual cell (or portion of an amorphous region like extracellular matrix or bone) is treated as a collection of pixels (2D) or voxels (3D).  #@NEW_LINE#@#  Each cell is characterized by an energy function designed to reproduce typical qualities and behaviors of cells including volume and surface area, cell-cell adhesion, chemotaxis etc.  #@NEW_LINE#@#  CC3D does not attempt to minimize the energy of the system but instead simulates a dynamics trajectory where the system evolves over time by passing through energetically feasible configurations.  #@NEW_LINE#@#  The feasibility of a particular state depends on the deviations from the target qualities (volume, surface area, ) of the cells.  #@NEW_LINE#@#  A Boltzmann function and a factor (roughly analogous to a temperature) controls the probability of visiting higher energy states.  #@NEW_LINE#@#  CC3D has been used to model many cell scale biological phenomena such as embryonic development [55], tumor growth with angiogenesis [56] and the retina [57].  #@NEW_LINE#@#  
Here we model the structure of a liver lobule as a simple sinusoid tube connecting the portal triad at the periportal region to the central vein at the centrilobular region with hepatocytes lining the sinusoidal pipe (Fig 2-2b).  #@NEW_LINE#@#  We do not explicitly model the endothelial cells lining the sinusoid nor the space of Disse.  #@NEW_LINE#@#  This simple 2-dimensional model is taken to be representative of all liver sinusoids.  #@NEW_LINE#@#  Blood, including red blood cells (RBCs) and serum portions, are modeled within this sinusoidal pipe.  #@NEW_LINE#@#  Blood flow simulated using CC3D includes the two components (RBCs and serum portions) and both components are created at the periportal end through division of pseudo-cells of type blood source cell.  #@NEW_LINE#@#  A constant force is exerted on both blood components to induce blood flow through the simulated sinusoid.  #@NEW_LINE#@#  When a blood component reaches the central vein end of the simulated sinusoid they are deleted from the model.  #@NEW_LINE#@#  The temporal scale was adjusted so that blood speed in the simulation is equivalent to 200 m/s, giving a transit time of a blood component through the sinusoid of one second.  #@NEW_LINE#@#  
APAP, carried by RBCs and plasma, enters this system from the periportal end and is forced to move towards the pericentral end.  #@NEW_LINE#@#  During transit, drug molecules diffuse between adjacent serum portions, RBCs and hepatocytes.  #@NEW_LINE#@#  These transfers are modeled as reversible first order mass action transfers and the transfer flux is scaled by the number of neighbors (RBCs, serum portions or hepatocytes)(Fig 3).  #@NEW_LINE#@#  In addition, inwardly rectified active transport between serum and hepatocytes is modeled as a separate Michaelis-Menten (saturable) process.  #@NEW_LINE#@#  The transfer rate constants are given in Table 3 and the parameters in Table 4.  #@NEW_LINE#@#  This tissue model is a mix of well stirred and explicit gradients; individual cells or serum portions are treated as well stirred, but transfer between individual cells and/or serum portions is explicitly modeled giving concentration gradients across the simulated sinusoid.  #@NEW_LINE#@#  
Transfer between each of the three cell, or pseudo-cell, types is described by this transfer map.  #@NEW_LINE#@#  Subscripts indicate that there are multiple cells of each of the types and transfer is calculated between all pairs of cells that are in contact at a particular instant.  #@NEW_LINE#@#  The paired arrows represent passive transport that equilibrates across pairs of cell types if they are in contact.  #@NEW_LINE#@#  Looped arrows represent passive transport between adjacent cells of the same type.  #@NEW_LINE#@#  The single arrow labeled Active Transport represents the Michaelis-Menten modeled import of APAP from the serum into hepatocytes.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.g003  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.t003  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.t004  #@NEW_LINE#@#  
During a simulation the hepatocytes are fixed in space and do not move.  #@NEW_LINE#@#  The CC3D model creates serum portions and RBCs representing venous and arterial flow at the periportal end of the sinusoid.  #@NEW_LINE#@#  Scaling of blood flow from the PBPK module to the sinusoid model uses the volumetric blood flow and liver volume from the PBPK module, the fraction of the liver volume that is sinusoid lumen, 7.4% [21], and the volume of the simulated sinusoid.  #@NEW_LINE#@#  The ratio of RBC to serum portions is based on the hematocrit value (typically 0.40.45 in humans), which is also used by the whole-body PBPK model.  #@NEW_LINE#@#  The ratio of arterial versus venous flow is taken as 1:3 [9].  #@NEW_LINE#@#  When an RBC or serum portion is created it is loaded with an amount of APAP based on the concentration of APAP in the inflow streams (from the whole-body PBPK model) taking into account both the venous and arterial inflow concentrations.  #@NEW_LINE#@#  As the blood moves through the sinusoid the diffusion into and out of the blood is calculated as described above.  #@NEW_LINE#@#  As the blood reaches the pericentral end of the sinusoid the remaining load of APAP is collected into an integrator and the RBC or serum portion is deleted.  #@NEW_LINE#@#  The integrated load is then transferred back to the whole-body PBPK model as the output from the liver compartment.  #@NEW_LINE#@#  
Subcellular Module: Phase I and Phase II metabolism of APAP within individual hepatocytes (Fig 2-3b) is modeled using Michaelis-Menten kinetics and the ODEs are given in Table 5 and the parameters are given in Table 6.  #@NEW_LINE#@#  In addition, glutathione (GSH) synthesis and NAPQI-GSH formation are included in the subcellular module.  #@NEW_LINE#@#  Each hepatocyte is treated as a well stirred container.  #@NEW_LINE#@#  The subcell reaction network was defined in SBML and, as was the case for the whole-body PBPK model, the species, reactants and units were extensively annotated and the final SBML validated.  #@NEW_LINE#@#  Each simulated hepatocyte has an independent copy of the subcellular reaction model.  #@NEW_LINE#@#  This SBML model has been deposited in the BioModels Database as MODEL1509230011.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.t005  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.t006  #@NEW_LINE#@#  
Module Integration: The complete multi-scale model uses Python CC3D code as the marshaling point.  #@NEW_LINE#@#  CC3D runs the multi-cellular model (including blood flow and APAP transfer between components), time steps the sub-cellular SBML and whole body PBPK/SBML models, and transfers quantities between scales.  #@NEW_LINE#@#  We choose the blood concentration of APAP as a scale-insensitive variable to connect the models.  #@NEW_LINE#@#  We use the LibRoadRunner [60] package, a cross-platform, open-source, high performance C++ library for running SBML-compliant models.  #@NEW_LINE#@#  LibRoadRunners Python API allows the CC3D Python script to load the SBML models (including independent replicates of the same model coupled to each simulated hepatocyte), adjust parameters, time step the SBML models and set and retrieve variables.  #@NEW_LINE#@#  We use independent replicates of the base PBPK SBML model for APAP, APAPG and APAPS, each with compound specific parameters.  #@NEW_LINE#@#  Replicates of the subcellular metabolic SBML model are linked to each individual hepatocyte in the tissue model.  #@NEW_LINE#@#  In total, the complete model includes of 23 linked SBML models; 20 copies of the sub-cellular reaction kinetic model (one for each of the simulated hepatocytes) and three copies of the whole body PBPK/SBML model for APAP, APAPG and APAPS.  #@NEW_LINE#@#  
Zonation of the CYPs is imposed in the CC3D model by scaling the Vmax for CYP metabolism as a function of the hepatocytes location along the sinusoid axis; values increase along the periportalpericentral axis from 80% to 100% of the sc_Vmax_2E1_APAP value (Table 6).  #@NEW_LINE#@#  
When CC3D loads an SBML model any process(es) in the SBML model that are not needed in the context of the complete multiscale model are disabled.  #@NEW_LINE#@#  For example, the whole-body PBPK model for APAP includes a single ODE representing liver metabolism that is not needed in the complete model since that process is represented by the subcellular model.  #@NEW_LINE#@#  To disable that particular ODE the rate constant in the SBML model is simply set to zero by the CC3D script.  #@NEW_LINE#@#  In addition to disabling selected ODEs, the CC3D script can overwrite initial conditions within the imported SBML files.  #@NEW_LINE#@#  For example, replicates of the APAP-PBPK model are used to model the APAPG and APAPS distribution so the initial concentration of APAP in the gut lumen compartment of those replicate models is set to zero.  #@NEW_LINE#@#  
In a simulation step, the CC3D script sequences both the calculations it carries out directly as well as time stepping the linked SBML models.  #@NEW_LINE#@#  Computationally, we integrate and update each of the three modules sequentially with the same time step.  #@NEW_LINE#@#  A single computational time step cycle consists of:  #@NEW_LINE#@#  

Model_Outputs  #@NEW_LINE#@#  
The complete multiscale model makes predictions of the time evolution of a number of concentrations.  #@NEW_LINE#@#  These range from subcellular concentrations of APAP and metabolites, as well as GSH, in each of the individual hepatocytes to blood concentrations by compartment for APAP and the metabolites.  #@NEW_LINE#@#  To directly compare model outputs with available in vivo data we focus on APAP, APAPG and APAPS in the serum.  #@NEW_LINE#@#  The time course of these species can be described by typical ADME descriptors including the time to maximum serum concentration (Tmax), the maximum serum concentration (Cmax) and the area under the curve (AUC) for all three compounds of interest in the blood; APAP, APAPG and APAPS.  #@NEW_LINE#@#  To quantify the goodness of fit for the entire time course data set we use the Root-Mean-Square Error (RMSEi) defined as:  #@NEW_LINE#@#  
(1)  #@NEW_LINE#@#  
Where y is the model output of interest, N is number of data points in the in vivo ADME dataset; i refers to APAP, APAPG or APAPS giving RMSEa, RMSEg and RMSEs, respectively.  #@NEW_LINE#@#  In addition, we calculate the sum of the three RMSEs giving RMSEsum.  #@NEW_LINE#@#  An additional model output is the excreted metabolic ratio (metabRatio) defined as:  #@NEW_LINE#@#  
(2)  #@NEW_LINE#@#  
Where the concentrations are those in the kidney tubules (Tubules compartment in Fig 2:1b).  #@NEW_LINE#@#  

Model_Parameterization  #@NEW_LINE#@#  
Initial values of the parameters (Tables 2, 4 and 6) in our simulations are based on previous studies [31, 32] or, if no previous studies included a particular parameter value then it was estimated.  #@NEW_LINE#@#  In this study, we specifically focus on fitting the serum level of APAP and its Phase II metabolites to in vivo experiments [58].  #@NEW_LINE#@#  Our target is to minimize the summation RMSEsum, the sum of the errors for the three ADME curves in our simulation.  #@NEW_LINE#@#  Multiple preliminary simulations were run with small changes in the parameter set and the set that best reproduced the in vivo ADME for a 1.4g APAP dose in humans, including APAP, APAPG and APAPS, was selected as the starting parameter set (see Results).  #@NEW_LINE#@#  For further details see S1 File.  #@NEW_LINE#@#  

Sensitivity_Analysis  #@NEW_LINE#@#  
Because of the large number of parameters in the complete model, as well as the use of different modeling modalities at the various scales, we examined the sensitivities of the model outputs to the parameters.  #@NEW_LINE#@#  This examination can help to identify parameters that the model is most sensitive to, and therefore, need to be known as accurately as possible.  #@NEW_LINE#@#  In addition, the sensitivity analysis can identify those parameters that have minimal affect on the models output and that perhaps identify places where the model can be simplified.  #@NEW_LINE#@#  
The sensitivity analysis consisted of the following rounds.  #@NEW_LINE#@#  The first round of sensitivity analysis used the reference parameter set we determined via preliminary investigation (above) and included single-parameter-variation simulations where in each simulation one parameter is changed 25% from its original value.  #@NEW_LINE#@#  The second round, also starting from the reference parameter set, changed all parameters simultaneously by rescaling the individual parameters using a normal distribution on logarithmic scale, which distributes the parameters across orders of magnitudes of their original values.  #@NEW_LINE#@#  This approach was used to ensure that the initial choice of parameters did not bias our ability to find better combinations of parameters by searching a much wider region of parameter space.  #@NEW_LINE#@#  From these simulations we selected several good and bad parameter sets and treated each of them as new base parameter sets with their own subgroup of simulations.  #@NEW_LINE#@#  Single-parameter-variation simulations were carried out with these new models.  #@NEW_LINE#@#  Sensitivity coefficient Jk(xi), which captures the influence of model parameter xi on kth model output (Jk), was calculated for each parameter in each group.  #@NEW_LINE#@#  The sensitivity is defined as:  #@NEW_LINE#@#  
(3)  #@NEW_LINE#@#  
where  = 25%  xi in our case.  #@NEW_LINE#@#  Jk(xi) is an approximation of the Jacobian matrix term on a logarithmic scale:  #@NEW_LINE#@#  
(4)  #@NEW_LINE#@#  
We have also explored the pairwise interactions between model parameters.  #@NEW_LINE#@#  A pair of parameters interact if the simultaneous influence of the parameters on a model output is not additive.  #@NEW_LINE#@#  Pairwise interaction analysis, like parameter sensitivity analysis, helps to identity parameters, in this case pairs of parameters, that have the largest affects on the models output.  #@NEW_LINE#@#  In addition, a laboratory measurement that defines one of the two parameters in a pair will often greatly reduce the possible domain of the paired parameter.  #@NEW_LINE#@#  The procedures are similar to single-parameter-variation simulations except that in each simulation a pair of parameters is varied simultaneously.  #@NEW_LINE#@#  If the effects of a particular pair of parameters are independent from each other then the observed variation in the model output should consists of the linear addition of the variation of model output from the two individual single-parameter-variation simulations.  #@NEW_LINE#@#  Any discrepancy between the former and latter suggest nonlinear interactions between a pair of model parameters.  #@NEW_LINE#@#  

Population_Variability  #@NEW_LINE#@#  
Human populations show great variation in sensitivity to xenobiotics.  #@NEW_LINE#@#  The inter-individual variability is often large enough to give significantly different biological responses between individuals given the same dose.  #@NEW_LINE#@#  To test the feasibility of using our modeling framework to simulate populations we ran simulations in which all model parameters were simultaneously varied by a small amount (25%) around the reference simulations parameter values.  #@NEW_LINE#@#  The average serum concentration of APAP, APAPG and APAPS monitored for 1000 simulated individuals plausibly reproduced the in vivo ADME data.  #@NEW_LINE#@#  
Population analysis was carried out by choosing multipliers for each of the 38 parameters in the complete model.  #@NEW_LINE#@#  The multipliers were chosen from a normal distribution with a mean of 1 and a coefficient of variation of 25%.  #@NEW_LINE#@#  Note that this is similar to performing a parameter sensitivity analysis.  #@NEW_LINE#@#  We used 1000 randomly generated parameter sets to represent a population of individuals.  #@NEW_LINE#@#  For further details see section 4.2 in the S1 File.  #@NEW_LINE#@#  


Results  #@NEW_LINE#@#  
Standalone_simulations  #@NEW_LINE#@#  
All three sub-models are standalone models that can be run without the framework of the complete multiscale model.  #@NEW_LINE#@#  Results for each of the three sub-models are described below.  #@NEW_LINE#@#  The ability to individually run the sub-models greatly facilitated their development and verification.  #@NEW_LINE#@#  
Whole-body PBPK Module: Standalone simulation results for the whole-body module are shown in Fig 4 using the parameter set REFSIM.  #@NEW_LINE#@#  This modules SBML model was run directly in COPASI [37] (http://www.copasi.org/), an SBML compliant ODE modeling package.  #@NEW_LINE#@#  
This simulation is for a 1.4g oral APAP dose in a 70Kg male.  #@NEW_LINE#@#  The open symbols are in vivo data [58] and the line is the model output.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.g004  #@NEW_LINE#@#  
Multicell Liver Lobule Module: Standalone simulation results for the multi-cell liver sinusoid module are shown in Fig 5 using the parameter set REFSIM.  #@NEW_LINE#@#  For the standalone simulation a square pulse of APAP was pushed into the sinusoid lumen for three seconds starting one second into the simulation as shown in Fig 5.  #@NEW_LINE#@#  During these 3 seconds, the APAP flux from blood to cells is dominant and APAP accumulates in the hepatocytes.  #@NEW_LINE#@#  This transfer is by both passive diffusion and active uptake of APAP.  #@NEW_LINE#@#  At later stages, when the APAP pulse has ended, intracellular APAP passively diffuses back out of the hepatocytes and into the blood flow.  #@NEW_LINE#@#  This reverse process is slower than the forward process since the forward process includes both passive diffusion and active import whereas the reverse process is passive diffusion only.  #@NEW_LINE#@#  An animation of this simulation is included (S1 Video).  #@NEW_LINE#@#  
A simulated 3 second square pulse of APAP was pushed into the left end of the vessel lumen for three seconds starting one second into the simulation.  #@NEW_LINE#@#  The concentration of APAP in the blood and hepatocytes is given by the heat map scale at left and time progresses from top to bottom.  #@NEW_LINE#@#  Blood components are created at the periportal (left) end and a constant force is exerted on the blood components to induce blood flow through the simulated sinusoid.  #@NEW_LINE#@#  The temporal scales was adjusted so that the blood speed in the simulation was equivalent to 200 m/s, giving a transit time of a blood component through the sinusoid of one second.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.g005  #@NEW_LINE#@#  
Subcellular Reaction Module: Standalone simulation results for the sub-cellular metabolic reactions are shown in Fig 6.  #@NEW_LINE#@#  This SBML model was run directly in COPASI.  #@NEW_LINE#@#  The parameters were adjusted to reproduce the in vivo ratio of APAPG and APAPS.  #@NEW_LINE#@#  
Results of the standalone run of the sub-cellular model using parameter set REFSIM and an initial concentration of APAP of 0.1mM (15g/ml).  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.g006  #@NEW_LINE#@#  
Both the whole-body and sub-cellular SBML models can be easily replaced with more sophisticated models if additional data on the metabolic, uptake or clearance pathways becomes available.  #@NEW_LINE#@#  In addition, the SBML models can be changed to represent different species, or different chemical entities, without extensive modification of the complete multiscale model.  #@NEW_LINE#@#  

Multiscale_simulations  #@NEW_LINE#@#  
Linking the modules together for the three scales creates the complete in silico simulation framework providing a mechanism based model that incorporates effects at the various scales.  #@NEW_LINE#@#  In this study we used this framework to predict serum concentrations of APAP and the phase II metabolites following a therapeutic dose.  #@NEW_LINE#@#  This is as a first step in developing ADME and toxicity prediction simulations that may ultimately lead to improved techniques for prediction of toxicity of therapeutic agents and environmental toxicants while simultaneously reducing the need for animal toxicity studies.  #@NEW_LINE#@#  
We modeled APAP distribution following an oral dose of 20 mg/Kg in a normal male of 70 Kg body weight.  #@NEW_LINE#@#  To estimate an appropriate set of parameters, we validated the plasma concentrations of APAP, APAPG and APAPS against experimentally observed values [36, 58].  #@NEW_LINE#@#  As described in the experimental section, we used RMSEi as our primary metric to guide our selection of parameters by fitting our model to the experimental data in Critchley et al.  #@NEW_LINE#@#  [58].  #@NEW_LINE#@#  We also used the maximum concentration (Cmax), time to arrive at maximum concentration (Tmax) and area under the curve (AUC) as model outputs for both comparison to the in vivo results and in the sensitivity analysis.  #@NEW_LINE#@#  
A single multiscale simulation requires 18 hours on a typical desktop machine using a two core, double threaded processor, e.g., an i3 level machine (CC3D is multicore and multithread capable).  #@NEW_LINE#@#  The majority of the compute times is taken up by the multicell model of blood flow through the simulated sinusoid.  #@NEW_LINE#@#  In addition, we made extensive use of Big Red II (BR2), Indiana Universitys Cray XE6/XK7 supercomputer that has 21,824 processor cores.  #@NEW_LINE#@#  BR2 allowed us to run hundreds of simultaneous simulations, which was particular useful for parameter scanning and sensitivity analyses.  #@NEW_LINE#@#  
The whole-body and subcellular reaction kinetic models are deterministic when run on their own, whereas the multicell model has a stochastic component.  #@NEW_LINE#@#  The complete model therefore has a stochastic component.  #@NEW_LINE#@#  To explore the degree to which the stochasticity affects the model outputs (e.g.  #@NEW_LINE#@#  serum concentration versus time over a simulated 8 hour time period) we ran 50 simulations with the same parameter set and compared the results.  #@NEW_LINE#@#  Across all the model outputs (RMSEi, Cmaxi, Tmaxi, AUCi) the standard deviations were extremely small, in the range of part per billion (see S1 File).  #@NEW_LINE#@#  
With the initial parameter set (labeled REFSIM, see Tables 26), we obtained the plasma concentration curves for APAP, APAPG and APAPS in a simulated 8-hour time course as shown in Fig 7.  #@NEW_LINE#@#  An animation of a typical run, including data from all three modeling scales, is included (S2 Video).  #@NEW_LINE#@#  With minor changes (+/- 25%) of a portion of parameters, we generated another parameter set (labeled HMPCsim6) that gave a better fit with experimental data (Fig 8).  #@NEW_LINE#@#  The various named parameter sets are include in the S1 File.  #@NEW_LINE#@#  Despite the plausibly good fitting of the simulation result, HMPCsim6 had notably weak performance in reproducing the peak of APAP curve, whereas the REFSIM parameter set had weak performance in reproducing the tails of all three concentration profiles.  #@NEW_LINE#@#  
Plasma concentrations versus time for APAP and metabolites simulated with the complete multiscale model using parameter set REFSIM (lines).  #@NEW_LINE#@#  Open symbols are in vivo average values from nine Caucasian subjects given a 1.4g oral dose of APAP [58].  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.g007  #@NEW_LINE#@#  
Plasma concentrations versus time for APAP and metabolites simulated with the complete multiscale model using the best fit parameter set HMPCsim6.  #@NEW_LINE#@#  Symbols are as described in Fig 7.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.g008  #@NEW_LINE#@#  
To explore the numerical stability of our modeling framework across a larger parameter space, and to explore the parameter sensitivities as a function of the parameter space, we selected two other parameter sets (named LNsim8 and LNsim23) whose ADME profiles are significantly different than the in vivo APAP data (see Figs 9 and 10).  #@NEW_LINE#@#  These two parameter sets can be thought of as representing chemical species with radically different ADME profiles compared to APAP.  #@NEW_LINE#@#  Both the LNsim8 and LNsim23 parameter sets are characterized by shifting of the equilibrium from the blood towards the rest of the body (pbpk_Kr2p).  #@NEW_LINE#@#  The LNsim8 is also characterized by low active transport of APAP from the blood into the hepatocytes (cc3d_Vmax_AT_APAP) and faster formation of APAPG (sc_Vmax_GLUC).  #@NEW_LINE#@#  The LNsim23 is further characterized by a slow rate of absorption in the gut (pbpk_kGutabs) and low kidney clearance rate for the glucuronide metabolite (pbpk_QgfrG).  #@NEW_LINE#@#  These two diverse parameter sets were also subjected to sensitivity analyses allowing us to compare the models parameter sensitivities across a range of ADME profiles.  #@NEW_LINE#@#  A table listing the complete set of parameters and sensitivities for all four fixed points is given in the S1 File.  #@NEW_LINE#@#  
This parameter set represents a hypothetical chemical species with ADME behavior significantly different than APAP.  #@NEW_LINE#@#  Symbols are as described in Fig 7 and the APAP in vivo data is included for comparison.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.g009  #@NEW_LINE#@#  
This parameter set represents a hypothetical chemical species with ADME behavior significantly different than APAP or the hypothetical species in Fig 9.  #@NEW_LINE#@#  Symbols are as described in Fig 7 and the APAP in vivo data is included for comparison.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.g010  #@NEW_LINE#@#  
Examination of the results for the complete model using either REFSIM or HMPCsim6 shows that the subcellular concentration of APAP, APAPG and APAPS vary little along the sinusoid (Fig 11).  #@NEW_LINE#@#  However, NAPQI concentration is higher in pericentral hepatocytes than in periportal hepatocytes as shown in Fig 11.  #@NEW_LINE#@#  Largely due to the imposed zonation of CYP2E1 concentration, hepatocytes with higher Phase I metabolic capability at the centrilobular region had slightly greater consumption of cellular GSH and greater formation of NAPQI-GSH.  #@NEW_LINE#@#  Unlike the pattern of Phase I metabolites, the Phase II metabolites (APAPG and APAPS) were higher in the periportal region, due to the higher uptake of APAP in this region (Fig 11F and 11G).  #@NEW_LINE#@#  The subcellular concentrations of APAP, APAPG and APAPS across the simulated sinusoid were also visualized at several time points as shown in Fig 12.  #@NEW_LINE#@#  The lateral (top to bottom) asymmetry in the APAP concentration at 0.17 hours is due to the different concentrations of APAP in the arterial versus venous inflows to the sinusoid.  #@NEW_LINE#@#  
Four cells were monitored in each of the three regions; (A), periportal (PP), midzonal (MZ) and perivenous (PV), and the average concentration in each group is plotted.  #@NEW_LINE#@#  (B) APAP, (C) GSH, (D) NAPQI, (E) NAPQI-GSH, (E) APAP-Glucuronide, and (E) APAP-Sulfate.  #@NEW_LINE#@#  Error bars are the standard deviation of the four cells in a region.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.g011  #@NEW_LINE#@#  
Time course snapshots of the chemical field for the multi-cell scale of the complete model using parameter set REFSIM.  #@NEW_LINE#@#  Concentrations of APAP (left), APAPG (middle) and APAPS (right) are indicated by the color scale.  #@NEW_LINE#@#  This time course spans 8 simulated hours top to bottom.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.g012  #@NEW_LINE#@#  

Sensitivity_analysis  #@NEW_LINE#@#  
Single-parameter variation: We performed sensitivity analyses around the fixed points (base parameter sets) REFSIM, HMPCsim6, LNsim8 and LNsim23.  #@NEW_LINE#@#  First, single-parameter-variation simulations were carried out around those nominal parameter values, and sensitivity indices were derived from the simulation results.  #@NEW_LINE#@#  The heat maps in Fig 13 reflects the extent to which the various model outputs change in response to single parameter changes about these four fixed points.  #@NEW_LINE#@#  Brighter regions indicate greater sensitivity of model outputs to individual parameters.  #@NEW_LINE#@#  As the most global measurement, RMSEsum captures the parameters influence on the serum profiles for all three compounds (APAP, APAPG, APAPS) when trying to reproduce the human ADME for APAP.  #@NEW_LINE#@#  As shown in the heat map, approximately half of the parameters contribute significantly to the RMSEsum value.  #@NEW_LINE#@#  
The horizontal axis lists the models parameters grouped by the sub-model.  #@NEW_LINE#@#  Parameters for the PBPK model start with pbpk_, the sinusoid models with cc3d_ and the subcellular model with sc_.  #@NEW_LINE#@#  The vertical axis lists the models outputs duplicated for each of the input parameter sets.  #@NEW_LINE#@#  The Average row is the average of all the sensitivities in the column for the particular parameter set.  #@NEW_LINE#@#  Each square in the heat map is the relative change of a model output divided by the relative change of the model parameter in single-parameter-variation simulation.  #@NEW_LINE#@#  Dark space indicates little influence of a parameter on the model outputs, bright regions reflect strong influence of a parameter and white regions represent sensitivities greater than one.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.g013  #@NEW_LINE#@#  
Whole-body scale sensitivities: Not surprisingly, two of the most influential parameters are body weight (pbpk_bw) and hematocrit (pbpk_hemat).  #@NEW_LINE#@#  Body weight affects many aspects in the model, such as organ size and blood flows, and accordingly directly affects the APAP distribution and concentration.  #@NEW_LINE#@#  The hematocrit is the ratio of RBC volume to blood volume, which directly affects the effective blood concentration and the uptake rate of APAP in both the liver and kidney compartments.  #@NEW_LINE#@#  The rate of gut absorption (pbpk_kGutabs), the three Qgfr (pbpk_Qgfr, pbpk_QgfrG, pbpk_QgfrS) values, and the parameters that control the partitioning of APAP and metabolites between the blood components (pbpk_Fup, pbpk_FupG, pbpk_FupS, pbpk_Kr2p) all significantly impact RMSEsum.  #@NEW_LINE#@#  
Tissue scale sensitivities: At the multicell/tissue scale the two Michaelis-Menten parameters  #@NEW_LINE#@#  
(cc3d_Km_AT_APAP, cc3d_Vmax_AT_APAP) controlling the active uptake of APAP by the hepatocytes are most influential, and they strongly affect not only the RMSEsum but RMSE for the three individual compounds.  #@NEW_LINE#@#  In addition, the forward rate constant for transfer of APAP out of the hepatocytes and back into the blood flow (cc3D_k_PD_H2S) appreciably affects the models outputs.  #@NEW_LINE#@#  Interestingly, the rest of the rate constants for transfer between the tissue scale components  #@NEW_LINE#@#  
(Fig 3) have minimal affects on the models outputs.  #@NEW_LINE#@#  This may indicate that the blood flow model can be simplified, perhaps by increasing the size of the serum portions and/or aggregating the serum and RBCs into a single component.  #@NEW_LINE#@#  
Subcellular metabolism scale sensitivities: Surprisingly, the model is relative insensitive to the rate of CYP metabolism as controlled by the two Michaelis-Menten parameters sc_Km_2E1_APAP and sc_Vmax_2E1_APAP.  #@NEW_LINE#@#  The RMSEs are much more sensitive to the parameters controlling the two Phase II reactions.  #@NEW_LINE#@#  The parameter sensitivities for parameters that directly control the Phase II reactions show output sensitivities that partition to the respective metabolites.  #@NEW_LINE#@#  For example, the parameters controlling sulfation strongly control RMSEapaps, CmaxS, TmaxS and AUCS and, by competition, the corresponding model outputs for APAPG.  #@NEW_LINE#@#  
In addition to the group of parameters that influence all the RMSEs, there are also sets of parameters that show a modular pattern of importance.  #@NEW_LINE#@#  These subsets of parameters further falls into two classifications.  #@NEW_LINE#@#  The first classification shows strict compound-specific grouping of heat blocks, and most of the PBPK module parameters belong to this group.  #@NEW_LINE#@#  For instance, model measurements RMSEapapg, CmaxG, AUCG are highly sensitive to parameters FupG, QgfrG and Rb2pG, while indifferent to corresponding parameters related to APAPS, and vice versa.  #@NEW_LINE#@#  In contrast, the second classification shows cross-compound influence in the heat map.  #@NEW_LINE#@#  The Michaelis-Menten constants describing the Phase II metabolism of APAP are in this group.  #@NEW_LINE#@#  This indicates a competition between the two pathways to process APAP.  #@NEW_LINE#@#  For example, a perturbation in a parameter controlling glucuronidation (APAPG) results in an opposite effect on the production of Sulfate conjugates (APAPS).  #@NEW_LINE#@#  
Insensitive Parameters: 17 out of 38 parameters (45%) examined have minimal impact on the models outputs for the REFSIM fixed point.  #@NEW_LINE#@#  Most of these parameters are for passive transfers, though the rate constant for CYP metabolism (mentioned above) and the rate constants for GSH synthesis and the conjugation of NAPQI with GSH are also in this group.  #@NEW_LINE#@#  These later parameter insensitivities may reflect the relatively low importance of Phase I metabolism on the ADME of APAP at pharmacological doses and these sensitivities might not be the same for overdoses of APAP.  #@NEW_LINE#@#  
The sensitivity heat maps for different base parameter sets (different fixed points) show generally similar sensitivity patterns  #@NEW_LINE#@#  
(Fig 13).  #@NEW_LINE#@#  The observations outlined above, in general, were observed in all four maps.  #@NEW_LINE#@#  Two of the fixed point parameter sets (REFSIM, HMPCsim6) are for parameter sets that adequately reproduce the APAP in vivo ADME data.  #@NEW_LINE#@#  The other two parameter sets (LNsim8 and LNsim23) were purposely chosen to represent hypothetical compounds with ADME profiles radically different from APAP.  #@NEW_LINE#@#  Though there are differences between the sensitivities of these different compounds parameter sensitivities and the APAP specific parameter sets, the differences are generally minor.  #@NEW_LINE#@#  The major differences are in reproducing the highly compound-specific model outputs related to the RMSEi values.  #@NEW_LINE#@#  
Correlations between sensitivities across different fixed points: To explore the similarity between the parameter sensitivities across the four fixed points we calculated the correlation coefficients between the sensitivity matrices.  #@NEW_LINE#@#  We calculated correlations for the entire tables (All), just using the Average sensitivity row (which omits the RMSEsum and metabRatio rows) and just using the rows excluding all the RMSEs and Average.  #@NEW_LINE#@#  In the last case, the correlation is done without taking into account how well the particular parameter set reproduces the APAP ADME data, and therefore represent the sensitivity of the models response regardless of how well it reproduces the APAP ADME data.  #@NEW_LINE#@#  As shown in Table 7, the Average sensitivities correlate well, as does the third set of correlations (which omit the sensitivity to the APAP ADME data), across all four parameter sets even though the LNsim8 and LNsim23 sets represents compounds with significantly different ADME profiles than APAP.  #@NEW_LINE#@#  Across All model outputs the REFSIM and HMPCsim6 parameter sets correlate very well with each other while the LNsim8 and LNsim23 sets correlate much less with both the APAP like parameter sets and with each other.  #@NEW_LINE#@#  These results suggests that, for these four fixed points, the model sensitivities for outputs that are not calculated relative to a particular compounds in vivo ADME profile (RMSEs) are similar across a range of ADME behaviors.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.t007  #@NEW_LINE#@#  
Sensitivities for the compound independent parameters in the PBPK model: The whole-Body PBPK models contain a number of parameters that depend on the individual being modeled and are independent of the chemical species (Table 2).  #@NEW_LINE#@#  The sensitivity results for the PBPK blood flow rates and compartment volumes are shown in Fig 14.  #@NEW_LINE#@#  By far the most influential parameter is the cardiac output (pbpk_QCardiac), which strongly affects most of the models outputs.  #@NEW_LINE#@#  The model is insensitive to the compartment volumes, over the range of +/-25%, with the exception of the volume of the liver (pbpk_VLiver).  #@NEW_LINE#@#  
Comparison of the sensitivities for the compound-independent parameters in the whole-body PBPK model about the fixed point REFSIM.  #@NEW_LINE#@#  Axis are as described in Fig 13.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.g014  #@NEW_LINE#@#  
NAPQI Conjugation Sensitivities: Though our model was not specifically designed nor calibrated for toxic doses of APAP it does include the Phase I metabolic pathway leading to NAPQI and subsequent formation of NAPQI-GSH.  #@NEW_LINE#@#  Fig 15 shows a comparison of the parameter sensitivities between the total amount of NAPQI-GSH formed (the sum across all the simulated hepatocytes) and the average sensitivity across all the other model outputs.  #@NEW_LINE#@#  As expected, the Michaelis-Menten parameters for the CYP2E1 conversion of APAP to NAPQI are the most important parameters controlling the amount of NAPQI-GSH formed.  #@NEW_LINE#@#  The other sensitive parameters are related to the two Phase II reactions (which are in competition with the Phase I reaction), the rate of uptake of APAP from the blood, and the body weight.  #@NEW_LINE#@#  
Comparison of the sensitivities for the formation of NAPQI-GSH (NAPQIGSH_Sum) versus the average parameter sensitivities about the fixed point REFSIM.  #@NEW_LINE#@#  Axis are as described in Fig 13.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.g015  #@NEW_LINE#@#  
Pairwise-parameter-variation (PPV): PPV simulations were carried out for parameter set REFSIM (Fig 16).  #@NEW_LINE#@#  Because of the large number of permutations of PPV coupled with the multiple model outputs we show here just the sensitivities of the RMSEsum.  #@NEW_LINE#@#  Each PPV interaction term is calculated by subtracting the observed relative variation of RMSEsum in the PPV simulations from the relative variation of RMSEsum in two single parameter variation simulations.  #@NEW_LINE#@#  If two parameters do not interact (that is, the two parameters effects are independent) then the PPV value is zero.  #@NEW_LINE#@#  If the two parameters do interact then the PPV value is non-zero and the sign indicates the relative direction of the interaction.  #@NEW_LINE#@#  As shown in Fig 16 less than half of the PPV displayed strong interactions.  #@NEW_LINE#@#  As an example of a strong parameter interaction, near the center of Fig 16, the cross interaction of the Michaelis-Menten parameters for the active transport of APAP from the blood into the hepatocytes (cc3d_Km_AT_APAP and cc3d_Vmax_AT_APAP) was of the strongest negative PPV coefficient.  #@NEW_LINE#@#  Since these two parameters occur in the same rate equation, but have opposite effects on the rate, they strongly interact over the range of parameters explored, giving the observed negative interaction coefficient.  #@NEW_LINE#@#  
Pairwise parameter interactions for model output RMSEsum.  #@NEW_LINE#@#  Each square in the heat map is the difference between the relative changes in model output (RMSEsum) for two individual single-parameter-variation simulations compared with the pairwise-parameter-variation simulation.  #@NEW_LINE#@#  White space indicates little interaction between a pair of parameters, red or blue regions reflect strong, non-linear parameter interactions.  #@NEW_LINE#@#  Horizontal and vertical lines separate the parameters of the three model scales with rectangular regions showing interactions that cross model scales and triangular regions for interactions within a model scale.  #@NEW_LINE#@#  Parameter variations are about the fixed point REFSIM.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.g016  #@NEW_LINE#@#  
An additional example of strong term interaction, in this case positive, is the interaction between the body weight  #@NEW_LINE#@#  
(pbpk_bw) and both the hematocrit and rate of gut absorption (pbpk_hemat and pbpk_kGutabs).  #@NEW_LINE#@#  
Finally, there is a strong interactions between the PBPK modules Fup and the partition coefficient between the rest of the body and the plasma (Kr2p) and in the ratio of blood concentration to plasma concentration  #@NEW_LINE#@#  
(Rb2p) parameters.  #@NEW_LINE#@#  Examination of the PBPK ODEs shows that those three parameters are indeed related by nonlinear relationship.  #@NEW_LINE#@#  
In the above cases of strong interactions in PPVs, the nature of the interaction, and indeed the ability to predict the interaction, is often obvious from the particular modules structure.  #@NEW_LINE#@#  For example, Michaelis-Menten Vmax and Km values will generally be strongly coupled.  #@NEW_LINE#@#  Perhaps the more interesting interactions are those that occur across modules, and hence, across scales.  #@NEW_LINE#@#  These interactions between modeling scales are much less obvious de novo.  #@NEW_LINE#@#  In Fig 16 triangular regions along the diagonal are interactions between parameters within the same module whereas rectangular regions are interactions between parameters of different modules.  #@NEW_LINE#@#  In our model we see large cross-module PPV coefficients for the interaction of the transport rate from the serum to hepatocytes (cc3d_Vmax_at_APAP), and to a lesser extent the related Km, with several parameters in the PBPK module (Fup, blood binding and tissue partition coefficients) and subcellular module  #@NEW_LINE#@#  
(the Michaelis-Menten Vmax and Km for the Phase II reactions).  #@NEW_LINE#@#  In general, de novo prediction of inter-module parameter interactions is much less straightforward than intra-module.  #@NEW_LINE#@#  

Population_Variability  #@NEW_LINE#@#  
Human populations show great variation in both exposure and sensitivity to APAP [58].  #@NEW_LINE#@#  To extend our framework from modeling an individual to modeling a population, we ran simulations in which all model parameters were simultaneously varied by a small amount (25%) around the reference simulations parameter values.  #@NEW_LINE#@#  The average serum concentration of APAP, APAPG and APAPS monitored for 1000 simulated individuals plausibly reproduced the in vivo ADME data (Fig 17A).  #@NEW_LINE#@#  We also found that, on average, nearly 60% of APAP dose ends up as APAPG, more than 30% APAPS, and less than 10% as APAP (Fig 17B), which is consistent with the metabolic ratios seen in vivo.  #@NEW_LINE#@#  We also monitored the subcellular NAPQI-GSH concentration to explore the zonal extent of toxicity across the simulated population.  #@NEW_LINE#@#  The subcellular NAPQI-GSH level increased along the portal to central vein axis, though the difference is mild when compared to the population standard deviation (Fig 17C).  #@NEW_LINE#@#  The zonal difference of NAPQI concentration is partly due to the imposed zonation of CYP2E1 expression and partly due to the APAP gradient along the sinusoid.  #@NEW_LINE#@#  
The population was generated by assuming that for each in silico individual, each parameter was within a truncated normal distribution with coefficient of variation of 25% around the base parameter from the parameter set REFSIM.  #@NEW_LINE#@#  (A) Average serum concentrations of APAP and Phase II metabolites for the simulated population.  #@NEW_LINE#@#  Open symbols are human in vivo data, closed symbols simulation results.  #@NEW_LINE#@#  (B) Average urinary excretion of APAP and Phase II metabolites for the simulated population.  #@NEW_LINE#@#  (C) Average cellular NAPQI-GSH for the population (zones as defined in Fig 11A).  #@NEW_LINE#@#  (D) Comparison of the average response (closed symbols with error bars) of the simulated population with the simulated individuals that deviate the most, high and low, from the population average (symbols without error bars).  #@NEW_LINE#@#  Error bars are standard deviations.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0162428.g017  #@NEW_LINE#@#  
In our simulated population the standard deviations are fairly large (Fig 17A), though the resulting variability in, for example, the serum concentration versus time for APAP is similar to what is typically seen clinically in ADME studies with a diverse population.  #@NEW_LINE#@#  However, the variability in Fig 17A is considerably larger than in the data of [58].  #@NEW_LINE#@#  The data we used is from a population with fairly small diversity: Caucasian, n = 9, ages 2344, body weight 5597 Kg and malefemale ratio of 6:3 [58].  #@NEW_LINE#@#  Inclusion of the other population in the study (Hong Kong Chinese, n = 11, ages 2132, body weight 4671 Kg, malefemale ratio 5:6) gives standard deviations approaching what we see for our simulated population [58].  #@NEW_LINE#@#  This observation suggests that our simplistic method of generating a population gives inter-individual variabilities that are similar to a highly diverse population.  #@NEW_LINE#@#  
It is interesting to examine the most extreme outliers in our simulated population.  #@NEW_LINE#@#  Fig 17D shows a plot of serum levels for the entire population compared to the simulated individuals with the largest deviations from the population mean in terms of serum level of APAP versus time.  #@NEW_LINE#@#  These one in a thousand individuals have peak serum levels and AUCs that are significantly different than the population average.  #@NEW_LINE#@#  The simulated individual with the highest peak APAP serum concentration has a level nearly twice that of the population average whereas the simulated individual with the lowest level has half the peak level.  #@NEW_LINE#@#  These particular simulated individuals would be expected to respond to both therapeutic and toxic doses of APAP significantly different than the average individual.  #@NEW_LINE#@#  However, neither of these two simulated individuals has any single parameter that is outside a reasonable range of inter-individual variability.  #@NEW_LINE#@#  The most notable differences between the two outliers and the rest of the population is their body weights.  #@NEW_LINE#@#  The simulated individual with the highest APAP serum levels has a body weight of 57 Kg and the simulated individual with the lowest serum levels a body weight of 86Kg.  #@NEW_LINE#@#  

Advantages_of_Separate_Models_for_the_Biological_Scales  #@NEW_LINE#@#  
A significant advantage to our approach of using standard modeling modalities for each scale of the multi-scale model is the ease of exploring changes in parameters or model structure at a particular scale without needing to run the entire multiscale model.  #@NEW_LINE#@#  For example, calibration of the subcellular metabolic reactions using data from in vitro studies, such as metabolism in isolated hepatocytes, provides a partial route for in vitro to in vivo extrapolation (IVIVE) [61].  #@NEW_LINE#@#  In addition, our approach allows us to leverage existing tools for tasks such as parameter estimation.  #@NEW_LINE#@#  As an example of this we have re-examined the initial step of the APAP PBPK model; the rate of absorption of APAP from the gut lumen.  #@NEW_LINE#@#  Our PBPK model is based upon published models [19, 31, 32] and assumes that the rate of absorption of APAP from the gut lumen follows simple first order kinetics.  #@NEW_LINE#@#  Close examination of published ADME data for therapeutic oral doses of APAP in humans determined by Prescott [36] strongly suggest that the uptake of APAP from the gut lumen is a transporter mediated process and not a first order process.  #@NEW_LINE#@#  In addition, it appear that at therapeutic doses the gut uptake transporters are saturated.  #@NEW_LINE#@#  From the data in [36] it appears that there is a 9 minute delay, presumably due to gastric emptying, followed by a linear increase in serum concentration giving a constant rate of uptake.  #@NEW_LINE#@#  Zeroth order kinetics can be modeled using Michaelis Menten kinetics with Vmax equal to the observed slope and Km set to a value small compared to the initial concentration.  #@NEW_LINE#@#  We have modified the PBPK model and estimated the Vmax and km by fitting the Prescott data using COPASI.  #@NEW_LINE#@#  The zeroth order model gives a much better fit to the experimental data than does the first order model used previously.  #@NEW_LINE#@#  Significant involvement of a saturable transporter in the gut for APAP has not generally been recognized [10].  #@NEW_LINE#@#  The presence of a saturable transporter in the gut will significantly affect the serum levels of APAP in overdose cases.  #@NEW_LINE#@#  
This is a clear example where mathematical modeling of biological processes can extend our understanding of the underlying biology.  #@NEW_LINE#@#  In addition, this clearly demonstrates the power of having sub-models that can be run on their own since that allows simple tuning of one sub-model prior to incorporating the changes into the complete multi-scale model.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
We have developed a multiscale modeling framework for xenobiotics.  #@NEW_LINE#@#  We focused on modeling the disposition of pharmacological doses of APAP in humans.  #@NEW_LINE#@#  However, this framework can be extended to other xenobiotics and species.  #@NEW_LINE#@#  Our multiscale framework is built upon open-source software packages.  #@NEW_LINE#@#  The use of open-source software facilitates the transparent use, distribution and reuse of multiscale models.  #@NEW_LINE#@#  In addition, we have separated the three main biological scales (whole-body, tissue, and subcellular) and modeled those scales in appropriate modeling platforms that leverages existing modeling modalities and tools.  #@NEW_LINE#@#  In particular, both the whole-body and subcellular reaction kinetic schemes are modeled in SBML, which allows us to leverage the extensive suite of SBML tools and allowed us to incorporate biological annotations directly in the SBML source code.  #@NEW_LINE#@#  
Blood flow simulation using Cellular Potts Model: At the tissue level we simulate blood flow using the Cellular Potts Model implemented in CC3D.  #@NEW_LINE#@#  Compared to other modeling approaches, that use advection-diffusion equations to model flow through a porous medium [24], or through pipe lined with a small number of compartments [32], our approach includes explicit RBC and serum portions and couples the local blood concentration to individual, explicitly modeled hepatocytes, lining a simulated sinusoid.  #@NEW_LINE#@#  Blood is a biphasic fluid containing both RBCs (with diameters similar to the diameter of a sinusoid blood vessel) and blood plasma whose biophysical properties differ.  #@NEW_LINE#@#  RBCs tends to travel at the center of blood vessel [62], which produces a cell-free layer near the vessel wall.  #@NEW_LINE#@#  In addition, small molecules typically have different partitioning and protein affinities within RBCs vs. blood plasma.  #@NEW_LINE#@#  This presents a challenge to using advection-diffusion equations to describe blood-borne small molecules, particular at the level of distribution into individual hepatocytes.  #@NEW_LINE#@#  Our simulated blood flow is composed of simulated cells representing RBCs and serum portions.  #@NEW_LINE#@#  Adhesive energies between RBCs, serum portions and hepatocytes influence the behavior of the blood flow.  #@NEW_LINE#@#  In our simulation, RBCs are less adhesive to hepatocytes and travel primarily at the center of the simulated sinusoid (see S1 Video).  #@NEW_LINE#@#  Both the initial concentrations within RBCs and serum portions, as well as the transfer from one to another, are tunable according to the biochemical properties of the compound being modeled, which together with RBC-plasma patterning, affects the concentration profile of molecules within the sinusoid.  #@NEW_LINE#@#  
The representation of all sinusoids in the liver by a single linear pipe is a gross, though often used, simplification of the complexity of blood flow in the liver.  #@NEW_LINE#@#  In the future this blood flow module will be extended and refined to better represent the complex structure of the liver microvasculature.  #@NEW_LINE#@#  Our modular approach will allow us to refine the sinusoid model without needing to rework the subcellular or whole-body modules.  #@NEW_LINE#@#  
Model parameterization and sensitivity analysis: We applied the multiscale framework of xenobiotics to modeling of APAP ADME at pharmacological doses and validated the model against experiment data for oral dosing in humans.  #@NEW_LINE#@#  Our initial parameter set was based on literature values and estimation.  #@NEW_LINE#@#  Refinement of the parameter set was achieved through large-scale screening of parameter values and fitting of the simulated ADME profiles with human data.  #@NEW_LINE#@#  We chose normal distributions on a logarithmic scale to perturb and explore parameter changes over several orders of magnitudes.  #@NEW_LINE#@#  
The sensitivity analyses revealed that a significant portion of the parameters (40%) have relatively little affect on the predicted ADME profiles.  #@NEW_LINE#@#  Interestingly, similarthough not identicalsensitivity patterns were observed for parameter sets characteristic of compounds with ADME profiles significantly different than APAPs.  #@NEW_LINE#@#  This suggests that the parameter sensitivity pattern might be relatively independent of the exact xenobiotic being modeled.  #@NEW_LINE#@#  If we assume that these different ADME profiles correspond to models of other compounds, and all parameter sets coming out of a parameter screening procedure would map to a compound or group of compounds, then this suggests that the parameter sensitivity is an intrinsic property of the model, largely independent of the compound being studied.  #@NEW_LINE#@#  This observation would be quite useful since it reduces the parameter space.  #@NEW_LINE#@#  
Population variability of model responses: Using the assumption that a population of individuals can be represented as a set of parameter sets, in which each parameter is perturbed by sampling from a normal distribution with a 25% standard deviation, yields a population model that is consistent with the range of variability seen in typical ADME studies in humans.  #@NEW_LINE#@#  In addition, this approach provides insight into idiosyncratic responses that arise in rare individuals that are within the normal range for all parameters but interactions among the entire set of parameters gives rise to unexpected (idiosyncratic) behavior.  #@NEW_LINE#@#  
Advantages of using standard modeling modalities: Using standard modeling languages and tools to create models of biological processes has several critical advantages over ad hoc and one-of coding approaches.  #@NEW_LINE#@#  Use of standard tools reduces the need for verification, particularly between the mathematical model and the computational model, since many aspects of the tool can be verified independently, leaving only the need to verify the implementation of the characteristic parts of a model.  #@NEW_LINE#@#  Our use of CC3D is an example of using available software to model a particular scale that leverages a significant software development effort.  #@NEW_LINE#@#  The SBML models, both the PBPK and subcellular metabolic models, have several additional features that differentiate models in SBML from ad hoc modeling approaches.  #@NEW_LINE#@#  These features include the ability to include biological annotations directly in the SBML model (thus retaining a strong linkage between biological, mathematical and computational models), the ability to define and validate units directly in the model, the ease with which the model can be understood and reused by others, the ability to make the model accessible to others via a web search or in central database.  #@NEW_LINE#@#  
Limitations and future extensions: Currently, our representation of the liver as a single straight sinusoidal pipe representative of all sinusoids is obviously an oversimplification.  #@NEW_LINE#@#  This simplification results in the loss of the lobule sinusoidal network information and ignores the lobular distribution of blood flow velocity, which presumably is a contributing factor to zonal xenobiotic uptake and metabolism.  #@NEW_LINE#@#  We are exploring more complex lobule models ranging from using a set of sinusoids with various lengths and blood velocities to models consisting of much more complex sinusoidal anastomotic networks based on detailed histological examination of liver tissue.  #@NEW_LINE#@#  
We are currently extending the sub-cellular metabolic model to include necrosis caused by APAP overdose based on existing models [31, 32].  #@NEW_LINE#@#  Once necrosis is included in the model, we can add the release of serum markers of necrosis (e.g., clinical measurements), such as alanine aminotransferase (ALT) and aspartate aminotransferase (AST), into all three modeling scales to couple necrosis to standard clinical markers of liver function.  #@NEW_LINE#@#  Our approach of separating the model into three scales will greatly facilitate refining, validating and extending the model at all scales leading to a defensible model for APAP in particular, and a reusable framework for xenobiotics in general.  #@NEW_LINE#@#  

Supporting_Information  #@NEW_LINE#@#  
S1_File_Supporting_Information  #@NEW_LINE#@#  
Supplemental information on the model development pathway, computational details, additional model parameters and output analysis.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0162428.s001  #@NEW_LINE#@#  
(PDF)  #@NEW_LINE#@#  

S2_File_Source_Code  #@NEW_LINE#@#  
The CC3D, and SBML model files are included in this zip file.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0162428.s002  #@NEW_LINE#@#  
(ZIP)  #@NEW_LINE#@#  

S3_File_Analysis_Script  #@NEW_LINE#@#  
Python code for generating job files for parameter scanning and output analysis.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0162428.s003  #@NEW_LINE#@#  
(ZIP)  #@NEW_LINE#@#  

S1_Video_APAP_pulse_10sec  #@NEW_LINE#@#  
Video file of the standalone multi-cell lobule simulation in CC3D.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0162428.s004  #@NEW_LINE#@#  
(MP4)  #@NEW_LINE#@#  

S2_Video_Complete_8hr  #@NEW_LINE#@#  
Video file of the complete eight hour multi-scale simulation.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0162428.s005  #@NEW_LINE#@#  
(AVI)  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
The assistance of Dr. Imran Shah, of the US-EPA, in creation of the initial PBPK model was greatly appreciated.  #@NEW_LINE#@#  Dr. Herbert Sauros assistance in the use of the Systems Biology Workbench tools greatly facilitated the creation of both the PBPK and sub-cellular reaction kinetic models in SBML.  #@NEW_LINE#@#  We thank the entire SBML community for the development of standards, tools and simulators that greatly facilitate the creation of annotated and reusable ODE based models.  #@NEW_LINE#@#  
Disclaimer: The views expressed in this publication are those of the authors and do not necessarily represent the views or policies of the U.S. Environmental Protection Agency.  #@NEW_LINE#@#  Reference to commercial products or services does not constitute endorsement.  #@NEW_LINE#@#  

Author_Contributions  #@NEW_LINE#@#  


Conceptualization: JPS MS AC JAG.  #@NEW_LINE#@#  
Data curation: JPS XF SGC.  #@NEW_LINE#@#  
Formal analysis: JPS XF SGC JAG.  #@NEW_LINE#@#  
Funding acquisition: JPS JAG.  #@NEW_LINE#@#  
Investigation: JPS XF MS JMB AC.  #@NEW_LINE#@#  
Methodology: JPS XF MS JMB AC JFW.  #@NEW_LINE#@#  
Project administration: JPS JAG.  #@NEW_LINE#@#  
Resources: JPS SGC JFW JAG.  #@NEW_LINE#@#  
Software: JPS XF MS JMB AC JFW.  #@NEW_LINE#@#  
Supervision: JPS JAG.  #@NEW_LINE#@#  
Validation: JPS XF SGC.  #@NEW_LINE#@#  
Visualization: JPS XF.  #@NEW_LINE#@#  
Writing  original draft: JPS XF.  #@NEW_LINE#@#  
Writing  review & editing: JPS XF SGC JFW JAG.  #@NEW_LINE#@#  


References  #@NEW_LINE#@#  


