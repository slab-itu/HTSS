article id="http://dx.doi.org/10.1371/journal.pone.0179989"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Interactive locomotion: Investigation and modeling of physically-paired humans while walking  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
In spite of extensive studies on human walking, less research has been conducted on human walking gait adaptation during interaction with another human.  #@NEW_LINE#@#  In this paper, we study a particular case of interactive locomotion where two humans carry a rigid object together.  #@NEW_LINE#@#  Experimental data from two persons walking together, one in front of the other, while carrying a stretcher-like object is presented, and the adaptation of their walking gaits and coordination of the foot-fall patterns are analyzed.  #@NEW_LINE#@#  It is observed that in more than 70% of the experiments the subjects synchronize their walking gaits; it is shown that these walking gaits can be associated to quadrupedal gaits.  #@NEW_LINE#@#  Moreover, in order to understand the extent by which the passive dynamics can explain this synchronization behaviour, a simple 2D model, made of two-coupled spring-loaded inverted pendulums, is developed, and a comparison between the experiments and simulations with this model is presented, showing that with this simple model we are able to reproduce some aspects of human walking behaviour when paired with another human.  #@NEW_LINE#@#  

1_Introduction  #@NEW_LINE#@#  
Extensive studies have investigated the effect of sensory feedback on human walking gait.  #@NEW_LINE#@#  Zivotofsky et al.  #@NEW_LINE#@#  [1, 2] have studied different types of sensory feedback, including tactile (e.g., holding hands) and have shown that different types of sensory feedback, such as visual, acoustic, and tactile cause synchronous walking; the tactile feedback was found to be the most effective in causing synchronization.  #@NEW_LINE#@#  Also, in [3] the interpersonal synchronization between pairs of subjects walking side-by-side (without holding hands) on a treadmill was shown to have spells of attraction to certain phase relations, but no strict phase locking was found, implying that the interlimb coupling without haptic feedback is weaker.  #@NEW_LINE#@#  
Moreover, biomechanical properties of partners, such as leg length, influence the strength of synchronization during unintentional gait entrainment.  #@NEW_LINE#@#  Nessler et al.  #@NEW_LINE#@#  [4] found that among all the pairs walking side-by-side on two treadmills under different sensory feedback conditions, those ones who exhibited unilateral step frequency locking (a.k.a.  #@NEW_LINE#@#  entrainment) had significantly lower leg length differences between the partners.  #@NEW_LINE#@#  Moreover, a significant correlation was found between leg length difference and both difference in stepping frequency and frequency locking.  #@NEW_LINE#@#  
Even though, as presented in some of the work above, side-by-side walking has been well analyzed by considering different sensory feedbacks and anthropometric parameters, to the best of our knowledge the effect of the haptic interaction through an object between two people, one walking in front of the other, on their walking gaits has not been investigated yet.  #@NEW_LINE#@#  
In this paper, we will present a particular case of interpersonal coordination that occurs when two persons walk while physically paired by carrying an object together (see Fig 1).  #@NEW_LINE#@#  This configuration may be associated to quadrupedal locomotion.  #@NEW_LINE#@#  
Two subjects were asked to walk while mechanically paired through a stretcher-like object.  #@NEW_LINE#@#  Each subject was equipped by 34 reflective markers that were used in combination with a motion capture system (VICON) to track the kinematic movements.  #@NEW_LINE#@#  A computer, placed on the center of the stretcher-like object, was used to record the force data from four 3D force sensors integrated in each handle.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0179989.g001  #@NEW_LINE#@#  
The aim of this work is to investigate the implication of the coupling on the walking gaits of each human subject and understand the mechanism of gait synchronization by studying a simple model consisting of two bipedal agents connected with a spring-damper.  #@NEW_LINE#@#  Through such a study the following questions will be investigated:  #@NEW_LINE#@#  
The rest of this paper is organized as follows.  #@NEW_LINE#@#  In Section 2 the results of human experiments will be presented: Center of Mass (CoM) displacement, CoM velocity, Gait Cycle Time (GCT), and step length in unconstrained walking and mechanically paired walking with another subject will be compared, and gait foot-fall patterns of the two paired bipeds will be analyzed.  #@NEW_LINE#@#  In Section 3 a simple model of mechanically paired bipeds will be presented.  #@NEW_LINE#@#  The systematic parameter search for finding periodic orbits of this mechanical model will be described in Section 4.  #@NEW_LINE#@#  Finally, in Section 5 a comparison between the experimental data and simulation results will be presented.  #@NEW_LINE#@#  

2_Human-human_interactive_locomotion__Experiments  #@NEW_LINE#@#  
In this section, we present and analyze the kinematic data collected in the paired-walking experiments, where two subjects carry a stretcher-like object together (see Fig 1).  #@NEW_LINE#@#  
21_Methods  #@NEW_LINE#@#  
The experiments were conducted at gait laboratory of the Centre Hospitalier Universitaire Vaudois (CHUV), Lausanne, Switzerland, according to the principles expressed in the Declaration of Helsinki.  #@NEW_LINE#@#  Participants provided their written consent on the experiment protocol approved by the EPFL human research ethics committee (HREC No 004-2015) (see S1 Ethic Statement).  #@NEW_LINE#@#  Six healthy subjects with a mean age of 27 participated in the experiments.  #@NEW_LINE#@#  More details about the subjects anthropometrics data can be found in Table 1.  #@NEW_LINE#@#  
Leg length was measured between the marker placed on the hip and the one placed on the ankle.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0179989.t001  #@NEW_LINE#@#  
As Table 2 shows, the same subjects were used to compose different pairs and perform different roles (i.e., walking in front (A) or behind (B) the object).  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0179989.t002  #@NEW_LINE#@#  
Each experiment consisted of two trials:  #@NEW_LINE#@#  
The average number of steps for a subject changes depending on the type of trial: on average, a solo trial consists of 8.8 ± 1.06 number of steps per subject per trial, while the average number of steps in a paired trial is 8.12 ± 0.49.  #@NEW_LINE#@#  
Overall, 7 pairs, made by a combination of 6 different subjects, performed the trials.  #@NEW_LINE#@#  A motion capture system (VICON) was used to track the kinematic movements of each subject with 34 markers placed on the subjects body according to the Plug-In-Gait convention [5].  #@NEW_LINE#@#  For the off-line data processing we used two commercial software packages: the Vicon Nexus software and MATLAB (The MathWorks Inc.).  #@NEW_LINE#@#  Nexus software was used to label markers, detect gaps in the data and filter them through a low-pass digital Butterworth filter that filters out signal noise above 300 Hz.  #@NEW_LINE#@#  Finally, MATLAB scripts were used to compute all the gait parameters of interest, described below:  #@NEW_LINE#@#  
Subjects__CoM_trajectories  #@NEW_LINE#@#  
Anthropometric tables [6] are used to compute the CoM position over time for each subject.  #@NEW_LINE#@#  In this way we can analyze the motion of the CoM along the vertical direction for each subject in each pair and such a motion is compared between the solo and paired trials.  #@NEW_LINE#@#  

Subjects__GCT  #@NEW_LINE#@#  
GCT is defined as the time interval between the same walking event, such as two consecutive contact events of the same foot (e.g., right or left) on the ground.  #@NEW_LINE#@#  Finding the local minima of the heel trajectory, we estimate the times at which the heel strike happens, and thus, we can compute the time difference between two consecutive heel strikes of the same foot.  #@NEW_LINE#@#  For each subject the mean GCT and the standard deviation are computed for all the solo and paired trials, and GCT variation among solo trials, paired trials in position A (front) and paired trials in position B (back) is investigated.  #@NEW_LINE#@#  

Subjects__step_length  #@NEW_LINE#@#  
Step length is defined as the distance between the heel position of one foot and that of the other foot at the heel strike moment.  #@NEW_LINE#@#  For each subject the mean step length is extracted from all the solo and paired trials.  #@NEW_LINE#@#  Subjects step length variation among solo trials, paired trials in position A (front) and paired trials in position B (back) is investigated.  #@NEW_LINE#@#  

Subjects__CoM_velocity  #@NEW_LINE#@#  
By differentiating the CoM trajectory with respect to time, we obtain the CoM forward velocity for each subject.  #@NEW_LINE#@#  For all subjects CoM forward velocity variation among solo trials, paired trials in position A (front) and paired trials in position B (back) is investigated.  #@NEW_LINE#@#  Neither vertical nor lateral velocity has been analyzed.  #@NEW_LINE#@#  

Gait_synchronization  #@NEW_LINE#@#  
A pair is considered to have a synchronized gait when  #@NEW_LINE#@#  
We assume that the first condition (i.e., same stride duration) is satisfied when the absolute difference between stride durations of the two subjects within a pair is less then 4% of their mean stride duration.  #@NEW_LINE#@#  Such a threshold was chosen to be comparable with the coefficient of variation of a healthy subject during a 9-min walk, as presented in [7].  #@NEW_LINE#@#  Regarding the second condition for synchronization, in order to find the phase lag between the subjects, for each trial the heel trajectories are first cut into n time windows, where n is the number of strides.  #@NEW_LINE#@#  Then, the cross-correlation between the heel trajectory x(t) of Subject A and y(t) of Subject B in each time window (of length N) is computed according to the following formula:  #@NEW_LINE#@#  

where  #@NEW_LINE#@#  

Once the maximum cross-correlation is found, the corresponding lag scaled to [0°, 360°] is denoted as the phase lag, .  #@NEW_LINE#@#  Intuitively,  determines the shift between the two heel trajectories that maximizes the correlation between the signals.  #@NEW_LINE#@#  The phase lag is considered to be constant as long as its variation is within a tolerance of ±10°.  #@NEW_LINE#@#  

Interlimb_coordination  #@NEW_LINE#@#  
Six markers are placed on the stretcher-like object in order to analyze its position over time.  #@NEW_LINE#@#  Moreover, in order to have a measure of the upper limb motion, we compute the relative displacement between the CoM of the stretcher-like object and the CoM of each subject in the forward direction.  #@NEW_LINE#@#  Finally, we try to find a correlation between this relative displacement and the step duration.  #@NEW_LINE#@#  
Repeated measures ANOVA is performed for each of the three dependent variables (GCT, step length, and forward velocity) with three different conditions (solo trial, paired trial in position A (front), and paired trial in position B (back)).  #@NEW_LINE#@#  A post-hoc multiple comparison (Tukeys HSD test with alpha = 0.05) is then applied to all the significant results.  #@NEW_LINE#@#  
Moreover, a statistical shape analysis (Procrustes analysis [810]) is performed in order to compare the mean CoM trajectories in the vertical direction of the paired trials and those of the solo trials.  #@NEW_LINE#@#  Procrustes analysis is based on the evaluation of the difference between the shape of two curves (in our case, the CoM trajectory of the solo trial in the vertical direction and that of the paired trial, normalized to percent gait cycle and interpolated at 1000 points).  #@NEW_LINE#@#  After computing the sum of the squared distances (SSD) between the corresponding points of the two curves, the square root of such SSD can be used as a statistical measure of the difference in shape, called Dissimilarity Measure (DM) (Eq (1)),  #@NEW_LINE#@#  
(1)  #@NEW_LINE#@#  
where , i = 1, , n is the coordinate of one point on the first curve while zi, i = 1, , n is the coordinate of the corresponding point on the second curve.  #@NEW_LINE#@#  
Finally, Pearson correlation coefficient between arms oscillations period and step period is calculated in order to analyze the interlimb coordination.  #@NEW_LINE#@#  


22_Main_results  #@NEW_LINE#@#  
In this subsection we will present the main results that were obtained from the experiments using the methodologies explained in Subsection 2.1.  #@NEW_LINE#@#  
221_Subjects__CoM_trajectories  #@NEW_LINE#@#  

Fig 2 shows Procrustes analysis results for the mean CoM trajectories in the vertical direction of the solo and paired trials for each pair.  #@NEW_LINE#@#  According to the DM value (see Eq (1)), we define the closest match result as the one for which the DM is lowest and the furthest match result as the one with the highest DM value.  #@NEW_LINE#@#  The furthest match results between the CoM vertical displacement of the solo trial and paired trial are reported in Fig 2, on the right.  #@NEW_LINE#@#  
As shown in Fig 2, the vertical CoM displacement of each subject is not affected by the mechanical coupling (at least for the 8 kg object used for the experiments).  #@NEW_LINE#@#  

222_Subjects__GCT  #@NEW_LINE#@#  
On the top-left of Fig 3 it is shown that there is a significant tendency (p = 0.02) for each subject to increase the GCT when paired compared to the solo case; this increase on average is 0.12 s. Moreover, once paired, there is a statistically negligible difference of GCT when the subject is in position A (e.g., in front of the stretcher like object) or in position B (e.g., behind the stretcher like object).  #@NEW_LINE#@#  These results are summarized in Table 3, which reports Tukey HSD test results.  #@NEW_LINE#@#  Moreover, on the top-right of Fig 3, the overall GCTs mean and standard deviation for each subject within a pair during the solo and paired trials are presented.  #@NEW_LINE#@#  From the previous plot it is also possible to notice that during the paired trials, subjects within a pair have almost the same GCT; in particular, on average, the GCT difference between subjects A and subjects B is 0.024 ± 0.068 s, which is less than 2% of the average GCT in all trials.  #@NEW_LINE#@#  

223_Subjects__step_length  #@NEW_LINE#@#  
In the middle-left of Fig 3 it is shown that, compared to the solo case, once paired, the step length decreases by 7.62 cm on average (p = 0.0174).  #@NEW_LINE#@#  Moreover, the difference between step lengths of each subject in position A (front) and position B (back) are statistically negligible.  #@NEW_LINE#@#  These results are summarized in Table 3, which reports Tukey HSD test results.  #@NEW_LINE#@#  An overall evaluation of the step length mean and standard deviation during the solo and paired trials is also reported on the middle-right of Fig 3.  #@NEW_LINE#@#  The latter plot can be used to evaluate how the step lengths of subjects within a pair converge to similar values; on average, the step length difference between subjects A and subjects B is 0.023 ± 0.035 m which is 4% of the average step length in all trials.  #@NEW_LINE#@#  

224_Subjects__CoM_velocity  #@NEW_LINE#@#  
The previous results in terms of the increase in the GCT and reduction of the stride length, when paired, were also supported by the CoM velocity analysis.  #@NEW_LINE#@#  
From the bottom-left of Fig 3, we notice a statistically significant (p = 0.0149) reduction (by 0.24 m/s on average) in the forward walking speed as a consequence of the coupling.  #@NEW_LINE#@#  Also in this case subjects have statistically negligible different velocities when they are in position A (front) or position B (back).These results are summarized in Table 3, which reports Tukey HSD test results.  #@NEW_LINE#@#  Moreover, for each subject within a pair, the overall mean and standard deviation of the forward velocity are shown, both for solo and paired trials (see Fig 3, on the bottom-right).  #@NEW_LINE#@#  From the previous plot it is possible to evaluate how subjects within a pair agree in terms of the forward velocity: the average difference between the CoM forward velocities of subjects A and subjects B is very small ().  #@NEW_LINE#@#  

225_Gait_synchronization  #@NEW_LINE#@#  
Subjects within a pair tend to converge to the same GCT, as explained in Subsection 2.2.2.  #@NEW_LINE#@#  Therefore, by definition of a synchronized gait as presented in Subsection 2.1, in order to examine synchronization, phase lag needs to be analyzed.  #@NEW_LINE#@#  Based on our phase lag estimation, as shown on the top left of Fig 4, on average, the subjects exhibit a synchronized gait in 72.5 ± 19.9% of each trial.  #@NEW_LINE#@#  
Moreover, if we consider the original system, which is made up of an object and two subjects connected, as a single body with four legs, we observe that some patterns, which can be generally associated to quadrupedal gaits, such as Diagonal-Sequence, Pace, or Trot [11], can be associated with the emerging synchronized gaits (see Fig 4, on the right).  #@NEW_LINE#@#  
In Diagonal-Sequence gait, two limbs alternate with three limbs in supporting the weight of the system.  #@NEW_LINE#@#  Thus, eight different combinations of limb support occur during one stride: four combinations of three-leg support interspersed with four combinations of alternating two-leg support (right/left diagonal and right/left lateral support).  #@NEW_LINE#@#  In the Pace gait the two lateral limbs are used alternately for weight support.  #@NEW_LINE#@#  For the Trot gait, right and left diagonals alternate in supporting the weight.  #@NEW_LINE#@#  
The phase lag , as defined in Subsection 2.1, can be used to classify the quadrupedal-like gaits.  #@NEW_LINE#@#  More specifically, if   0° the two subjects converge to a pace-like gait while if   180°, the two subjects converge to a trot-like gait, and finally if   225° a diagonal sequence-like gait appears.  #@NEW_LINE#@#  
With the above definitions, among all the synchronized gaits pace gait (40.9%), trot gait (36.4%) and diagonal-sequence (D-S) (22.7%) can be identified (see the bottom-left of Fig 4).  #@NEW_LINE#@#  

226_Interlimb_coordination  #@NEW_LINE#@#  
The interlimb coordination is presented here as the correlation between subjects step periods and the arms oscillation periods during paired trials.  #@NEW_LINE#@#  Arms oscillation is defined as the relative displacement over time between each subjects CoM and the objects CoM, computed along the forward direction.  #@NEW_LINE#@#  From such a displacement, which is almost periodic (see Fig 5, plot on the right), it is possible to extract the oscillation period for Subject A and B in each pair as the time difference between two local maxima (or two local minima) of the horizontal relative displacement between one subjects and objects CoM.  #@NEW_LINE#@#  The plot on the left in Fig 5 shows that the period of arms oscillation is almost equal to the step period.  #@NEW_LINE#@#  In this plot each point represents a pair step period-arms oscillation period for each Subject A and Subject B within a pair during paired trials.  #@NEW_LINE#@#  For Subjects on the back there is a larger dispersion of points that can be associated to the greater range of arms motions in the forward direction compared to the backward direction.  #@NEW_LINE#@#  



3_The_model  #@NEW_LINE#@#  
Several models can be used for bipedal locomotion, however, perhaps the simplest model that can explain some key features of human walking, such as CoM displacement and Ground Reaction Forces (GRF), is the SLIP model, initially designed to model running but then extended to model walking as well [12, 13].  #@NEW_LINE#@#  Because of its simplicity and explanatory power we decided to use such a model as a constituent unit to describe two bipedal agents walking together while mechanically paired.  #@NEW_LINE#@#  
As shown in Fig 6, in our model, two SLIP models are linked together with a spring-mass-damper connection, where the following assumptions are made:  #@NEW_LINE#@#  
On the left one SLIP is in the single support phase (the swing leg is not represented), while the SLIP on the right is in the double support phase.  #@NEW_LINE#@#  In the middle a mass is connected to the CoM of each pendulum through a spring and damper system representing the arms impedance.  #@NEW_LINE#@#  We indicate the center of mass of each SLIP by mi for i = 1, 2, while li,  and i represent the SLIPs initial leg length, the leg stiffness, and the angles of attack, respectively; ki, bi and  are the impedance parameters and the equilibrium lengths of each connection between the SLIPs CoM and the CoM of the object, which has a total length of Lt and its relative position with respect to the first SLIP is indicated as xt.  #@NEW_LINE#@#  Finally, xi and zi indicate each SLIPs CoM horizontal and vertical position while d is the distance between the foot point of the first pendulums stance spring and that of the second pendulum.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0179989.g006  #@NEW_LINE#@#  
The first three points are directly related to the choice of using the SLIP model as a constituent unit, while the final two points refer to the coupling between the two bipedal agents.  #@NEW_LINE#@#  The assumption of using a spring and damper system to model the coupling can be associated on one side to the mechanical characteristics of human muscles and on the other side to the arms oscillatory behaviour observed from the experimental data.  #@NEW_LINE#@#  Finally, the last assumption is related to a qualitative analysis of the interaction force data, where in the experiments, by using Optoforce sensors integrated in each handle of the stretcher-like object, we observed that the variations of the force in the forward direction result to be greater than the vertical ones (see for example S2 Fig).  #@NEW_LINE#@#  
31_SLIP_model  #@NEW_LINE#@#  
The SLIP model is one of the simplest models that yields human-like results in terms of walking behaviour [13].  #@NEW_LINE#@#  The SLIP model can be used to model both walking and running [12, 13].  #@NEW_LINE#@#  As previously mentioned, with the SLIP model it is possible to reproduce the GRFs that point towards the CoM and depend only on the leg length and stiffness.  #@NEW_LINE#@#  In such a model, in order to be able to replicate human data, it is necessary to set appropriate values for the parameters such as spring stiffness, angle of attack, and mass.  #@NEW_LINE#@#  Moreover, the only variables of the model that have to be initialized with appropriate values are the CoM position at the apex (that is, the point where the height of the CoM reaches its maximum value) and the CoM velocity or, alternatively, the initial energy of the system.  #@NEW_LINE#@#  To avoid dependency of the vertical position on the leg length, the vertical position of the apex is always defined with respect to the one reached by the CoM when the legs spring is at rest.  #@NEW_LINE#@#  The horizontal position at the apex is computed with respect to the support point.  #@NEW_LINE#@#  

32_Paired_SLIPs_model  #@NEW_LINE#@#  
The paired model is made up of two SLIPs connected together by a parallel mass, spring and damper system, as shown in Fig 6.  #@NEW_LINE#@#  This system can be described by the following equations of motion  #@NEW_LINE#@#  
(2)  #@NEW_LINE#@#  
(3)  #@NEW_LINE#@#  
(4)  #@NEW_LINE#@#  
(5)  #@NEW_LINE#@#  
(6)  #@NEW_LINE#@#  
where  #@NEW_LINE#@#  
For this model, the initial conditions are crucial; in particular, it is necessary to define  #@NEW_LINE#@#  
Furthermore, in order to better replicate human gait, we choose the range of the following parameters according to [6, 13]:  #@NEW_LINE#@#  

Table 4 shows the mechanical range of these parameters.  #@NEW_LINE#@#  
The masses range, both for the table and the pendulums, and the length of the object and the pendulums legs can be easily set according to the experimental parameters (see Table 1).  #@NEW_LINE#@#  Legs stiffness, angle of attack and initial energy can be set as described in [13].  #@NEW_LINE#@#  Finally, arms impedance range has been selected according to [14].  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0179989.t004  #@NEW_LINE#@#  
Regarding the arm equilibrium lengths (L01 and L02), we note that since we always assume that at the beginning of the simulations the arms lengths (L1(0) and L2(0)) are equal to their equilibrium lengths, and the only way L01 and L02 appear in the equations of motion is in the form of (L1  L01) and (L2  L02), the specific values of L01 and L02 will not effect the results.  #@NEW_LINE#@#  
Since the paired-SLIPs model described above has no means of injection of energy, but has dissipation of energy, it generally does not possess periodic solutions.  #@NEW_LINE#@#  However, as we can see in Section 4 and 5, it is possible to find approximate periodic orbits up to a very small threshold (e.g., state values that vary less than 0.1% from step to step) in a relatively large window of time (100 s).  #@NEW_LINE#@#  With this definition of an approximate periodic orbit, we are still able to study the role of passive mechanism in achieving synchronized periodic solutions in paired walking.  #@NEW_LINE#@#  
To obtain periodic solutions as defined above, for given mi, li, and initial conditions , and initial energy, , by a systematic search (Subsection 4.1), we find legs stiffness (), angle of attack (i), arms stiffness (ki), and damping (bi) such that the paired SLIP model reaches a periodic walking gait as previously defined.  #@NEW_LINE#@#  


4_Periodic_solutions_of_the_model  #@NEW_LINE#@#  
41_Systematic_search  #@NEW_LINE#@#  
In this section we present a method to find the system parameters (arms/legs stiffness and angles of attack) which lead to solutions that respect the approximate periodic condition.  #@NEW_LINE#@#  Because of the complexity of the model and the high dimensionality of the search grid (NP, where P is the number of parameters to analyze), the analysis is completed in three steps such that in each step we only search for two parameters.  #@NEW_LINE#@#  
In each step of the systematic search we evaluate the following Periodicity Score (SP) function:  #@NEW_LINE#@#  

where  (103) is the maximum variation between two consecutive apexes, that is,  #@NEW_LINE#@#  

for k = 1, 2.  #@NEW_LINE#@#  The value of the tolerance  has been set according to the variation of the apex height of the subjects during the experiments.  #@NEW_LINE#@#  Finally, , where RMSk, with k = 1, 2, is the root mean square of the norm of the difference between subsequent apex positions of pendulum k; that is,  #@NEW_LINE#@#  

In this formula,  #@NEW_LINE#@#  
The periodicity score described above is defined based on the notion of the return map, which sends the horizontal and vertical positions of each pendulum at the apex in the current step to the ones in the next step.  #@NEW_LINE#@#  Intuitively, the higher the periodicity score is, the closer is the apex to its value in the previous steps.  #@NEW_LINE#@#  In this way we are able to define a score that is capable of measuring the periodicity of the solutions for our system.  #@NEW_LINE#@#  
The three steps of the systematic search are explained in details in the following:  #@NEW_LINE#@#  
An alternative approach could be searching for all four parameters (i.e., leg stiffness and angle of attack, arm stiffness and damping) at the same time, however, with the above systematic search, at each stage only two parameters are searched for; this approach greatly reduces the computation time.  #@NEW_LINE#@#  
We note that the first two steps of the systematic search are important to find the legs and arms impedance able to guarantee a periodic walking behaviour of the paired system as defined in Subsection 3.2: at the beginning, the two pendulums are unpaired, and we look for individual locomotion periodicity by testing different leg stiffnesses and angles of attack; then the paired system is analyzed by fixing the legs stiffness and angles of attack and testing the walking gait for different arms impedance.  #@NEW_LINE#@#  Finally, Step 3 is necessary to better adjust legs stiffness and angles of attack of each pendulum while paired compared to the values found in Step 1, which were optimized for the unpaired system.  #@NEW_LINE#@#  

Fig 7 presents the results of the three steps of the algorithm.  #@NEW_LINE#@#  It turns out that the system has a higher periodicity score for higher stiffness values.  #@NEW_LINE#@#  
The figure shows the three main steps of the systematic search: in the first step (plot on the top-left) the best angle of attack () and leg stiffness (kl) for each pendulum separately (no coupling) are found.  #@NEW_LINE#@#  In the step 2 (plot on the top-right) the best arms stiffness parameters (spring stiffness k and damping parameter, b) for each pendulum in the paired system are found.  #@NEW_LINE#@#  Finally, in step 3 (plot on the bottom) the best angle of attack () and leg stiffness (kl) for each pendulum while paired are found.  #@NEW_LINE#@#  Here, the arms stiffness and damping are fixed (k = 3.5  103 N/m, b = 320 Ns/m) according to the best solution found in the previous step of the systematic search.  #@NEW_LINE#@#  In all cases yellow regions indicate pairs of parameters that guarantee a high periodicity score while the blue regions represent pairs of parameters that result in a low periodicity score.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0179989.g007  #@NEW_LINE#@#  

42_An_example_of_a_synchronized_gait  #@NEW_LINE#@#  
Since in a periodic gait, as defined in Subsection 3.2, the trajectories and the velocities of the two pendulums are almost identical (with a tolerance of 103), the periodic gaits found by the systematic search are necessarily synchronized gaits as defined in Section 2.  #@NEW_LINE#@#  Here, we present an example of such a synchronized gait found by the systematic search algorithm (see Fig 8 and S1 Video).  #@NEW_LINE#@#  In this simulation, the mass and leg length are assumed to be the same for both pendulums (m1 = m2 = 80 kg, l1 = l2 = 1 m).  #@NEW_LINE#@#  With the initial conditions shown in Table 5, the parameters are found using the systematic search method, the outcome of which is shown in Table 6.  #@NEW_LINE#@#  
Contrary to Step 1 and Step 3, different initial conditions are selected in Step 2, where the two SLIPs are paired, and we look for arms impedance that maximizes SP.  #@NEW_LINE#@#  Such a choice is important since we can allow the system to have dynamic interactions and to check whether, when starting with different conditions, the two modeled agents can reach a synchronized gait.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0179989.t005  #@NEW_LINE#@#  
Such parameters guarantee periodicity of the solution of the paired-SLIPs model.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0179989.t006  #@NEW_LINE#@#  
Results obtained through the systematic search are shown.  #@NEW_LINE#@#  In the top-left graph, the relative displacement, in the forward direction, between the two CoMs is presented.  #@NEW_LINE#@#  In the bottom-left graph, the yellow curve refers to the first pendulums CoM displacement in the forward direction while the black curve represents the other pendulums CoM displacement.  #@NEW_LINE#@#  In the top-right graph, the black curve refers to the forward velocity of the first pendulum while the yellow curve refers to that of the second pendulum.  #@NEW_LINE#@#  Finally, in the bottom-left graph, the CoM vertical displacement is presented for both pendulums.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0179989.g008  #@NEW_LINE#@#  
As expected from the systematic search, the convergence of the system to a synchronized gait strongly depends on the right choice of parameters.  #@NEW_LINE#@#  By choosing a wrong set of parameters, the two SLIPs that start with different initial conditions will fall after a few steps (see S2 Video).  #@NEW_LINE#@#  This could suggest that once coupled, each simulated bipedal agent has to properly adjust its arms impedance and legs stiffness according to the behaviour of the other agent.  #@NEW_LINE#@#  


5_Data_comparison  #@NEW_LINE#@#  
As explained in the Section 1, we would like to understand whether the behaviour of two subjects walking together while mechanically paired could be explained just by the passive mechanics of the overall system.  #@NEW_LINE#@#  To this end, the paired SLIPs model which is introduced in Section 3, is used in this section to replicate and predict the human experimental data.  #@NEW_LINE#@#  For each bipedal agent we use anthropometric data to set the mass and leg length for data comparison.  #@NEW_LINE#@#  With this comparison two main questions have to be addressed:  #@NEW_LINE#@#  
There is a slight difference between these two questions.  #@NEW_LINE#@#  In the first one, we want to force the model to capture the experimental data from the paired trials, while in the second one, just by using the knowledge of the preferred walking gait parameters of each subject in solo trial, we would like to check whether the model can predict the paired behaviour.  #@NEW_LINE#@#  To answer both aforementioned questions, two different data fitting analyses are proposed in Subsections 5.1 and 5.2.  #@NEW_LINE#@#  
51_Simulation_of_the_paired_behaviour_by_fitting_the_experimental_paired_trial_data  #@NEW_LINE#@#  
In this subsection we present a method to examine whether the model is capable of reproducing the behaviour of the real paired system.  #@NEW_LINE#@#  To this end, we search for sets of model parameters that allow the system to reach a periodic walking gait as defined in Subsection 3.2 which is, at the same time, consistent with the experimental paired data; such a search for model parameters is referred to as paired trial fitting.  #@NEW_LINE#@#  To implement the paired trial fitting, it is necessary to introduce a new systematic search that is slightly different from the one described in Subsection 4.1.  #@NEW_LINE#@#  In particular, the three main steps of the systematic search in Subsection 4.1 remain the same, as well as the parameters we search for.  #@NEW_LINE#@#  However, since we want to constrain the model to fit the experimental paired trial data, a new score, called Global Score (SG), which will be evaluated at the end of each search step, is defined as follows:  #@NEW_LINE#@#  

where SR is the Real Conditions Score and is used to evaluate how close are the apex position and velocity of the modeled system to the experimental one, SS, is the Synchronization Score, which is defined based on the ratio of the GCT of Subject A to that of Subject B by which we measure how well synchronized the gaits are, and finally SP is the score defined in Subsection 4.1.  #@NEW_LINE#@#  Exact definitions of SR and SS can be found in S1 Appendix.  #@NEW_LINE#@#  
In the simulations, the mass and leg length of each pendulum are set to be the same as those of the corresponding subject in the pair, while the mass of the object in between is set to be the same as that of the stretcher-like object from the experiments.  #@NEW_LINE#@#  

52_Simulation_of_the_paired_behaviour_by_fitting_the_experimental_solo_trial_data  #@NEW_LINE#@#  
In order to evaluate the predictive power of the model presented in Section 3, the approach adopted here is to fit each modeled agent (that is, each SLIP) to each subjects features, such as mass, leg length, initial velocity, apex height, etc.  #@NEW_LINE#@#  during the solo trial.  #@NEW_LINE#@#  We then search for sets of parameters (angle of attack, arms impedance, and legs stiffness) as described in Subsection 4.1; we call this search for the model parameters solo trial fitting.  #@NEW_LINE#@#  Unlike Subsection 5.1, no optimization for matching the simulations with the experimental data of the paired trial has been taken into account.  #@NEW_LINE#@#  The score used for the systematic search in this case is the one introduced in Subsection 4.1.  #@NEW_LINE#@#  

53_Methods_and_results  #@NEW_LINE#@#  
The implementations of the solo trial fitting and the paired trial fitting show that there exist solutions which respect the periodicity condition introduced in Subsection 3.2 for a specific set of impedance parameters.  #@NEW_LINE#@#  Several walking parameters of the paired model are compared with the experimental results in order to evaluate whether the model is able to replicate and/or predict humans behaviour.  #@NEW_LINE#@#  
In particular, the main evaluated variables are:  #@NEW_LINE#@#  
We did not analyze the interlimb coordination since in the presented model the synchronized gait is obtained so that the interactions between the modeled agents and the object reduce over time in order to reduce energy dissipation.  #@NEW_LINE#@#  
With respect to the first parameter analyzed, the CoM vertical displacement of each modeled agent is compared with that of the corresponding subject.  #@NEW_LINE#@#  Moreover, the CoM displacement of each modeled agent is compared between the solo and paired trials through Procrustes analysis [10].  #@NEW_LINE#@#  Fig 9 shows that in both solo and paired trial fittings the model is able to reproduce CoM vertical displacement of the subjects during paired trials.  #@NEW_LINE#@#  Moreover, in the solo trial fitting the model is able to reproduce humans behaviour of keeping the same vertical CoM displacement between the solo and paired trials.  #@NEW_LINE#@#  Indeed, by applying Procrustes analysis [10] between each modeled agents CoM vertical displacement during the paired and solo trials, we obtained a dissimilarity measure close to zero in all the cases.  #@NEW_LINE#@#  
Procrustes analysis results are shown on the left for comparing CoM displacement of each human subject and the corresponding modeled agent in solo and paired trial fittings.  #@NEW_LINE#@#  An example of such a comparison is reported on the right for Pair02.  #@NEW_LINE#@#  The mean CoM vertical displacements of the real subjects are reported in black while the magenta curves represent the CoM vertical diplacements of the modeled agents.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0179989.g009  #@NEW_LINE#@#  
For the GCT, step length, and forward velocity, we performed repeated measure ANOVA with three different conditions, namely, solo trial, paired trial in position A (front), and paired trial in position B (back), as evaluated for the experiments (see Subsections 2.1).  #@NEW_LINE#@#  
The graphs in Fig 10 show that, in contrast to humans behaviour, in the solo trial fitting results there is not a significant tendency for each modeled agent to either increase the GCT or decrease the step length and the forward velocity when paired compared to the solo trial.  #@NEW_LINE#@#  
On the left the output of a post-hoc multiple comparison analysis (Tukeys HSD test with alpha = 0.05) is reported in order to clearly show the results of repeated measure ANOVA performed for three dependent variables (GCT on top, step length in the middle, and forward velocity on the bottom) with three conditions: solo trial (blue bars), paired trial when the modeled agent is in front (violet bars) and back (pink bars).  #@NEW_LINE#@#  The graphs on the right side show the means forward velocities and corresponding standard deviations for each pair for 4 different cases: paired trial fitting (dark blue bars), solo trial fitting (dark pink bars), experimental paired trial (light blue bars), and finally experimental solo trial (pink bars).  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0179989.g010  #@NEW_LINE#@#  
On the right side of Fig 10, we report the means and standard deviations of the forward velocities in four different cases: paired and solo trial fitting results and experimental solo and paired trials.  #@NEW_LINE#@#  We can observe that the forward velocity in the solo trial fitting is always higher than the one expected in the experimental paired trials.  #@NEW_LINE#@#  Indeed, the value of the forward velocity in solo trial fitting remains close to those of the experimental solo trials of each subject.  #@NEW_LINE#@#  
A final comparison between the behaviour of the paired SLIPs model and the experimental data is realized in terms of the gait foot-fall pattern.  #@NEW_LINE#@#  To perform such a comparison, just a short window of time of the experimental foot-fall pattern data can be evaluated because of the limitated size of the room where the experiments took place.  #@NEW_LINE#@#  As a consequence, the same time window will be considered in the comparison of the gait foot-fall pattern between the experiments and the simulations.  #@NEW_LINE#@#  
As an example, the foot-fall patterns in the experiments and the simulations are presented in Fig 11 for Pair 02 (similar results are obtained for other pairs), where we can observe Trot like gait (on the left) and Pace like gait (on the right).  #@NEW_LINE#@#  Since the model is 2-dimensional, we cannot distinguish between the trot and the pace gait.  #@NEW_LINE#@#  The distinction reported is based on the initial configuration of the two SLIPs: by assuming, for example, that the two pendulums start with the same leg (indicated as right), one can monitor such a leg with respect to the other (indicated as left).  #@NEW_LINE#@#  In this way if the two SLIPs reach a periodic gait while moving forward the same leg (right or left) at the same time, we can associate the resultant gait to a pace-like gait and otherwise to a trot-like gait.  #@NEW_LINE#@#  In Fig 11 the foot-fall pattern results of the paired trial fitting are presented.  #@NEW_LINE#@#  With the paired trial fitting we are able to reproduce trot and pace gaits observed in the experimental data with the same stepping frequency of the analyzed subject.  #@NEW_LINE#@#  To visualize how well the paired trial fitting can predict the experimental data, snapshots of the simulations versus the experimental data for Trial 4 of Pair 02 are presented in Fig 12 (see also S3 Video).  #@NEW_LINE#@#  With the solo trial fitting we are still able to reproduce the coordinated gaits (in particular, pace and trot gaits), but with a different stepping frequency compared to the one observed in the experimental data.  #@NEW_LINE#@#  Such a discrepancy is due to the model limitation in reproducing the reduction in forward velocity, as explained before for Fig 10.  #@NEW_LINE#@#  
Simulation results obtained by paired trial fitting: In each plot yellow segments refer to the right foot of Subject A/pendulum in front, while black segments refer to the right foot of Subject B/pendulum behind.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0179989.g011  #@NEW_LINE#@#  
From the top to the bottom, the first and second columns represent the temporal sequence of movements of a paired trial (from frame a to frame f).  #@NEW_LINE#@#  The pictures show the results both from the experimental data and model data obtained by implementing the paired trial fitting (see Subsection 5.1).  #@NEW_LINE#@#  Red dots refer to the modeled CoMs, the pivot points and the carried mass, and they are all connected with single red lines.  #@NEW_LINE#@#  Blue dots represent the CoMs of each subject and that of the table.  #@NEW_LINE#@#  Finally, grey dots represent subjects markers recorded during the experiments (dark grey is used to show the right side of the subject while light grey indicates the left side).  #@NEW_LINE#@#  Only the lower limb grey dots have been connected to better represents subjects legs and feet.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0179989.g012  #@NEW_LINE#@#  


6_Discussion  #@NEW_LINE#@#  
The presented work investigates the effects of a mechanical connection between two bipedal agents on their walking gaits, aiming to answer the following questions:  #@NEW_LINE#@#  
To answer the above questions, we present human-human interactive locomotion experiments showing how the mechanical coupling causes changes in the human walking gait; in particular, we observe that such a mechanical coupling causes a statistically significant reduction in the preferred forward speed (p = 0.015), step length (p = 0.017), and a significant increase of the GCT (p = 0.02).  #@NEW_LINE#@#  This adaptation of the gait through reduction of speed and increase of GCT could be due to the fact that each subject tries to accomodate to the motion of the other subject which is detected by interaction forces, visual and acoustic information.  #@NEW_LINE#@#  
The vertical component of the CoM trajectory of each subject does not significantly change when paired (the worst dissimilarity measure value is d = 5.3  106).  #@NEW_LINE#@#  Moreover, we observe coordination in the foot-fall patterns of the paired subject in 72.5 ± 19.9% of each trial, on average.  #@NEW_LINE#@#  That is, on average in 72.5 ± 19.9% of each trial the subjects paired together through a mechanical link while walking for few steps have the same stride frequency and establish a constant phase lag between homologous legs.  #@NEW_LINE#@#  Indeed, the subjects reproduce some foot-fall patterns generally associated to quadrupedal type gaits (e.g.  #@NEW_LINE#@#  pace, trot, and diagonal-sequence).  #@NEW_LINE#@#  This inter-subject coordination can be considered as a starting point for further investigation through longer trials.  #@NEW_LINE#@#  
We also present a simplified model for the mechanical analysis of the interactive locomotion.  #@NEW_LINE#@#  The model can be used to infer some properties of the real system and to evaluate whether some human behaviours can be associated to passive mechanical properties.  #@NEW_LINE#@#  Performing the systematic search presented in Subsection 4.1, it is observed that the region of periodic behaviour as defined in Subsection 3.2 presented in terms of angles of attack and legs stiffness, enlarges once the two pendulums are paired compared to the case of solo walking (i.e., without any mechanical connections).  #@NEW_LINE#@#  This observation suggests that the mechanical link may be used by the bipedal agents as a way to make the system more robust.  #@NEW_LINE#@#  
Moreover, the simulation results show that the paired-SLIPs model can predict some characteristics of the gaits during the interactive locomotion.  #@NEW_LINE#@#  In particular, it is able to:  #@NEW_LINE#@#  
However, the change in the forward velocity once the two subjects are paired, even for the ones with similar preferred speed during the solo trials, cannot be explained just by a mechanical effect with our simple model.  #@NEW_LINE#@#  As discussed before, according to the experiments, mechanical coupling the system has the effect of reducing the mean forward velocity for at least one subject within each pair.  #@NEW_LINE#@#  With the first algorithm, in which we optimize the system for the paired system parameters, we obtain a very good match between the experimental data and the simulation results even in terms of the forward velocity.  #@NEW_LINE#@#  However, when we do not optimize for experimental paired data, we cannot match the level of reduction in the forward velocity found in the experimental data for most of the subjects once paired with another one, and the forward velocity remains close to its value in the solo experimental trial, which was chosen to be the initial condition of the simulated paired system.  #@NEW_LINE#@#  
Moreover, the model does not demonstrate the D-S gait mainly because the two SLIP models must have the same motion due to dissipation.  #@NEW_LINE#@#  
These results suggest that some behavior of humans while carrying objects with other humans seem to be only due to the passive mechanical properties rather than high-level control strategies such as foot-placement.  #@NEW_LINE#@#  However, some other features of the emerging paired walking gait might be related to cognitive and/or psychological effects, that in the model may be represented by addition or subtraction of energy according to a specific control architecture.  #@NEW_LINE#@#  Probably, more complex motor control actions have to be considered in order to better understand this phenomenon.  #@NEW_LINE#@#  

Supporting_information  #@NEW_LINE#@#  
S1_Appendix_Real_conditions_score_and_synchronization_score_description  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0179989.s001  #@NEW_LINE#@#  
(TEX)  #@NEW_LINE#@#  

S1_Video_Paired-SLIPs_model_with_periodic_walking_gait  #@NEW_LINE#@#  
The video shows a simulation of the paired-SLIPs model where the right choice of parameters allow the system to converge a periodic walking gait.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0179989.s002  #@NEW_LINE#@#  
(MP4)  #@NEW_LINE#@#  

S2_Video_Paired-SLIPs_model_with_unstable_walking_gait  #@NEW_LINE#@#  
The video shows a simulation of the paired-SLIPs model where the wrong choice of parameters does not allow the system to converge a periodic walking gait.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0179989.s003  #@NEW_LINE#@#  
(MP4)  #@NEW_LINE#@#  

S3_Video_Comparison_between_paired-SLIPs_model_and_experimental_data  #@NEW_LINE#@#  
The video shows the results both from the experimental data and model data obtained by implementing the paired trial fitting (see Subsection 5.1).  #@NEW_LINE#@#  Red dots refer to the modeled CoMs, the pivot points and the carried mass, which are all connected with single red lines.  #@NEW_LINE#@#  Blue dots represent the CoMs of each subject and that of the table.  #@NEW_LINE#@#  Finally, grey dots represent the markers placed on the subjects recorded during the experiments (dark grey is used to show the right side of the subject while light grey indicates the left side).  #@NEW_LINE#@#  In this case only the lower limb grey dots have been connected to better represent the subjects legs and feet.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0179989.s004  #@NEW_LINE#@#  
(MP4)  #@NEW_LINE#@#  

S1_Fig_Percentage_of_gait_types  #@NEW_LINE#@#  
Relationship among the percentages of the different types of gait (pace gait in light blue, trot gait in blue and diagonal-sequence in grey) and three walking gait parameters: forward velocity (on the top), gait cycle time (in the middle) and step length (on the bottom).  #@NEW_LINE#@#  Such a relationship is evaluated for each pair (from Pair01, indicated with one star, to Pair07, indicated with seven stars).  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0179989.s005  #@NEW_LINE#@#  
(EPS)  #@NEW_LINE#@#  

S2_Fig_Vertical_and_forward_interaction_forces  #@NEW_LINE#@#  
In this figure an evaluation of the vertical and forward interaction forces for Pair01 is shown.  #@NEW_LINE#@#  The four plots refer to four force sensors (Optoforce, OMD-30-FE-450N) placed in each handle of the strecher-like object that was used for the experiments.  #@NEW_LINE#@#  Sensor 1 and 3 were placed at the Subject A side (Sensor 1 on the right and Sensor 3 on the left), while Sensor 2 and 4 were placed at the Subject B side (Sensor 2 on the right and Sensor 4 on the left).  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0179989.s006  #@NEW_LINE#@#  
(EPS)  #@NEW_LINE#@#  

S1_Ethic_Statement_Ethic_statement_approved_by_the_EPFL_human_research_ethics_committee_(HREC_No_004-2015)  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0179989.s007  #@NEW_LINE#@#  
(PDF)  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
The authors thank Amy Wu, Ionescu Anisoara and Cole Simpson for the suggestions and discussions.  #@NEW_LINE#@#  

Author_Contributions  #@NEW_LINE#@#  


Conceptualization: JL AD HR AJI.  #@NEW_LINE#@#  
Data curation: JL CLG.  #@NEW_LINE#@#  
Formal analysis: JL AD.  #@NEW_LINE#@#  
Funding acquisition: AJI.  #@NEW_LINE#@#  
Investigation: JL.  #@NEW_LINE#@#  
Methodology: JL AD CLG.  #@NEW_LINE#@#  
Project administration: JL AJI.  #@NEW_LINE#@#  
Resources: AJI CLG.  #@NEW_LINE#@#  
Software: JL AD CLG.  #@NEW_LINE#@#  
Supervision: HR AJI.  #@NEW_LINE#@#  
Validation: JL AD HR.  #@NEW_LINE#@#  
Visualization: JL HR AJI.  #@NEW_LINE#@#  
Writing  original draft: JL.  #@NEW_LINE#@#  
Writing  review & editing: HR AJI JL.  #@NEW_LINE#@#  



References  #@NEW_LINE#@#  


