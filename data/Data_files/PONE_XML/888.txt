article id="http://dx.doi.org/10.1371/journal.pone.0198503"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
A novel mathematical method for disclosing oscillations in gene transcription: A comparative study  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Circadian rhythmicity, the 24-hour cycle responsive to light and dark, is determined by periodic oscillations in gene transcription.  #@NEW_LINE#@#  This phenomenon has broad ramifications in physiologic function.  #@NEW_LINE#@#  Recent work has disclosed more cycles in gene transcription, and to the uncovering of these we apply a novel signal processing methodology known as the pencil method and compare it to conventional parametric, nonparametric, and statistical methods.  #@NEW_LINE#@#  Methods: In order to assess periodicity of gene expression over time, we analyzed a database derived from livers of mice entrained to a 12-hour light/12-hour dark cycle.  #@NEW_LINE#@#  We also analyzed artificially generated signals to identify differences between the pencil decomposition and other alternative methods.  #@NEW_LINE#@#  Results: The pencil decomposition revealed hitherto-unsuspected oscillations in gene transcription with 12-hour periodicity.  #@NEW_LINE#@#  The pencil method was robust in detecting the 24-hour circadian cycle that was known to exist, as well as confirming the existence of shorter-period oscillations.  #@NEW_LINE#@#  A key consequence of this approach is that orthogonality of the different oscillatory components can be demonstrated.  #@NEW_LINE#@#  thus indicating a biological independence of these oscillations, that has been subsequently confirmed empirically by knocking out the gene responsible for the 24-hour clock.  #@NEW_LINE#@#  Conclusion: System identification techniques can be applied to biological systems and can uncover important characteristics that may elude visual inspection of the data.  #@NEW_LINE#@#  Significance: The pencil method provides new insights on the essence of gene expression and discloses a wide variety of oscillations in addition to the well-studied circadian pattern.  #@NEW_LINE#@#  This insight opens the door to the study of novel mechanisms by which oscillatory gene expression signals exert their regulatory effect on cells to influence human diseases.  #@NEW_LINE#@#  

Introduction  #@NEW_LINE#@#  
Gene transcription is the process by which the genetic code residing in DNA is transferred to RNA in the nucleus as the inauguration of protein synthesis.  #@NEW_LINE#@#  The latter process is called translation and occurs in the cytoplasm of the cell.  #@NEW_LINE#@#  Circadian rhythm, the 24-hour cycle that governs many functions of the cell, is the result of a complex interaction of transcriptional and translational processes.  #@NEW_LINE#@#  The importance of circadian rhythm to physiologic processes has been underscored in 2017 by the awarding of the Nobel Prize in Physiology or Medicine to the investigators who described the molecular mechanisms controlling it.  #@NEW_LINE#@#  However, in addition to the circadian oscillation driven by light and dark, other so-called infradian and ultradian rhythms have clear biologic import.  #@NEW_LINE#@#  Blood pressure, some circulating hormones, and some physiological functions appear to have 12-hour periodicity whereas other processes such as the menstrual cycle more closely follow a lunar cycle.  #@NEW_LINE#@#  
Accordingly, we sought to uncover novel 12-hour oscillations in gene expression.  #@NEW_LINE#@#  In many cases, the 12-hour gene oscillation is superimposed on the 24-hour cycle; thus it is hidden in conventional analysis.  #@NEW_LINE#@#  Additionally, experiments designed to elucidate the 24-hour circadian often do not have the granularity required to reveal an interval of less than 24 hours as they are constrained by the Shannon-Nyquist Sampling Theorem [1].  #@NEW_LINE#@#  
To reveal periodicities in gene expression other than the 24-hour circadian cycle, we applied digital signal processing methodology to this biologic phenomenon.  #@NEW_LINE#@#  Although this approach is, to our knowledge, less commonly used in the biological field, it is justified because the transcription of DNA to RNA is indeed a signal, packed with information for making the enormous repertoire of proteins.  #@NEW_LINE#@#  
To extract the fundamental oscillations (amplitude and period) present in the data, we utilized publicly available time-series microarray datasets on circadian gene expression in mouse liver (under constant darkness) [2] and analyzed over 18,000 genes spanning a variety of cellular process ranging from core clock control, metabolism, and cell cycle to the unfolded protein responses (UPR), a measure of cell stress.  #@NEW_LINE#@#  In addition, one set of measurements of RER (respiratory exchange ratio) from wild-type mice (generated by us) was also performed.  #@NEW_LINE#@#  We constructed linear, discrete-time, time-invariant models of low order, driven by initial conditions, which approximately fit the data and thus reveal the fundamental oscillations present in each data set.  #@NEW_LINE#@#  In addition to the 24-hour (circadian) cycle known to be present, other fundamental oscillations have been revealed using our approach.  #@NEW_LINE#@#  

Methods  #@NEW_LINE#@#  
We searched for 12-hour oscillations in several biological systems.  #@NEW_LINE#@#  Systems were chosen that represented not only gene transcription but also phenotype; they represent the way in which these biological systems are expressed in the whole organism.  #@NEW_LINE#@#  The reasoning was that if the 12-hour oscillation in transcription was biologically significant, it would be represented in some measurable function of the cell.  #@NEW_LINE#@#  
Initially, we analyzed a set of transcription data [2] that was collected in mouse liver obtained from animals in constant darkness after being entrained in a 12-hour light/12-hour dark environment.  #@NEW_LINE#@#  Mice were sacrificed at 1-hour intervals for 48 hours, thus providing enough data points to analyze the signal.  #@NEW_LINE#@#  The dataset thus obtained contains RNA values for all coding genes.  #@NEW_LINE#@#  The RNA data were generated using a standard microarray methodology.  #@NEW_LINE#@#  In addition, RER (respiratory exchange ratio) measurements in mice were also measured and analyzed.  #@NEW_LINE#@#  The novelty in our analysis consists in using the so-called matrix-pencil method [3].  #@NEW_LINE#@#  This is a data-driven system-identification method.  #@NEW_LINE#@#  It constructs dynamical systems based on time-series data and finds the dominant oscillations present in the ultradian or infradian rhythms.  #@NEW_LINE#@#  Our purpose here is to compare this method with other established strategies for spectral estimation, including both parametric spectrum estimation methods like MUSIC (MUltiple Signal Classification), ESPRIT (Estimation of Signal Parameters via Rotational Invariance Techniques), and Pronys (least squares) as well as classical nonparametric models like wavelet transforms and statistical methods like RAIN.  #@NEW_LINE#@#  These are compared with each other using both artificial and measured data.  #@NEW_LINE#@#  
Basic_signal_processing_methods  #@NEW_LINE#@#  
Goal.  #@NEW_LINE#@#  Discover the fundamental oscillations inherent in the gene data, using these models and reduced versions thereof.  #@NEW_LINE#@#  
Processing_of_the_data_with_the_pencil_method  #@NEW_LINE#@#  
The data y1, y2, , yN, are used to form the Hankel matrix:  #@NEW_LINE#@#  

where for simplicity it is assumed that N = 2k.  #@NEW_LINE#@#  Then we define the quadruple (E, A, B, C):  #@NEW_LINE#@#  
(4)  #@NEW_LINE#@#  
This quadruple constitutes the raw model of the data.  #@NEW_LINE#@#  This model is linear, time-invariant and discrete-time with a non-zero initial condition:  #@NEW_LINE#@#  
(5)  #@NEW_LINE#@#  
Reduced models and fundamental oscillations.  #@NEW_LINE#@#  The dominant part of the raw system is determined using a model reduction approach [4], [5], [6], [3].  #@NEW_LINE#@#  The procedure is as follows.  #@NEW_LINE#@#  
Pencil procedure for obtaining dominant sub-models.  #@NEW_LINE#@#  
The associated reduced model of size r is then:  #@NEW_LINE#@#  

Assuming (as is usually the case) that Er is invertible, the approximated data can be expressed as:  #@NEW_LINE#@#  

Estimating r. Important byproducts of the pencil method are the singular values s1 and s2 mentioned above.  #@NEW_LINE#@#  The accuracy of the approximation is determined by the first neglected singular singular value r+1, as the resulting approximation error is proportional to this singular value.  #@NEW_LINE#@#  This implies the following rule.  #@NEW_LINE#@#  
Rule: choose r so that , where  is a tolerance which depends on the data at hand.  #@NEW_LINE#@#  For instance  = 0.01, implies roughly speaking that data contributing less than 1% to the overall result are discarded.  #@NEW_LINE#@#  In this regard the following remark is in order.  #@NEW_LINE#@#  The data considered in this paper are rather short-duration and therefore in many cases we have not truncated the data.  #@NEW_LINE#@#  
Partial fraction expansion of the associated transfer function.  #@NEW_LINE#@#  Hr(z) = Cr(z Er  Ar)1 Br.  #@NEW_LINE#@#  This involves the eigenvalue decomposition (EVD) of the matrix pencil (Ar, Er), or equivalently of ; let  #@NEW_LINE#@#  

where the columns of Vr = [v1, , vr] are the eigenvectors, r = diag[1, , r] are the eigenvalues of the reduced system (poles of Hr(z)), and  are the rows of .  #@NEW_LINE#@#  The approximate data can be expressed as:  #@NEW_LINE#@#  

where , is the complex amplitude of the ith, oscillation; expressing this in polar form , i is the real amplitude and i the phase.  #@NEW_LINE#@#  Finally, if we express the eigenvalues as , i is the decay (growth) rate, and i the frequency, of the ith oscillation.  #@NEW_LINE#@#  
Poles and oscillations.  #@NEW_LINE#@#  Often in (digital) system theory, the quantity  is referred to as pole of the associated system.  #@NEW_LINE#@#  Oscillatory signals result when i = 0, which it turn implies that the magnitude of the pole i is equal to one: i = 1, and the period of oscillation is .  #@NEW_LINE#@#  
For instance a signal with i = 1, represents a constant (step), while signals with ,  (which are both on the unit circle with angles 15°, 30° degrees) represent pure oscillatory signals with periods 24, 12 hours respectively.  #@NEW_LINE#@#  
Angle between signals and orthogonality.  #@NEW_LINE#@#  In the sequel we will make use of angles between signals.  #@NEW_LINE#@#  Here we briefly define these concepts.  #@NEW_LINE#@#  Given discrete-time finite duration signals (vectors)  #@NEW_LINE#@#  

their inner product is defined as  #@NEW_LINE#@#  

where ()* denotes complex conjugation and transposition; the angle between these signals is defined as  #@NEW_LINE#@#  
(6)  #@NEW_LINE#@#  
where  denotes the Euclidean 2-norm.  #@NEW_LINE#@#  Orthogonality means that the angle between the two signals is , or equivalently that their inner product is zero; this is sometimes denoted by a  b.  #@NEW_LINE#@#  In the sequel we also make use of the symbol  to indicate approximate orthogonality, i.e.  #@NEW_LINE#@#  an angle between signals close to  radians or 90° degrees.  #@NEW_LINE#@#  


Other_methods  #@NEW_LINE#@#  
To complete the picture, we briefly list other methods which can be used to analyze the gene data.  #@NEW_LINE#@#  
MUSIC  #@NEW_LINE#@#  
The MUSIC algorithm [7], [8], is a parametric spectral estimation method based on eigenvalue analysis of a correlation matrix.  #@NEW_LINE#@#  It uses the orthogonality of the signal subspace and the noise subspace to estimate the frequency of each oscillation.  #@NEW_LINE#@#  It assumes that a set of data can be modeled as Y = a + n, where , is a set of gene transcription data,  = [e(1) e(2)  e(K)] is the transpose of a Vandermonde matrix, K is the number of dominant frequencies, and , a = [a1 a2  aK]T contains the amplitudes of the dominant K frequencies, , is white noise.  #@NEW_LINE#@#  The autocorrelation matrix is  #@NEW_LINE#@#  

where  = diag(i) and M is the number of columns in the Hankel matrix.  #@NEW_LINE#@#  We can see that the rank of matrix 2 H equals K where the nonzero eigenvalues are .  #@NEW_LINE#@#  Then the sorted eigenvalues of the autocorrelation matrix Rxx can be expressed as  #@NEW_LINE#@#  

It follows that the noise subspace contains the eigenvectors of the autocorrelation matrix Rxx corresponding to the N  K smallest eigenvalues.  #@NEW_LINE#@#  Then  #@NEW_LINE#@#  

so H G = 0, and the frequency values  are the only solutions of e()H GGH e() = 0.  #@NEW_LINE#@#  The MUSIC algorithm seeks the peaks of the function 1/[e()H GGH e()], where   [0, 2].  #@NEW_LINE#@#  The Root MUSIC algorithm seeks the roots of pH(z1)GGHp(z) that is the Z-transform of e()HGGHe() where z = ej  C.  #@NEW_LINE#@#  
The MUSIC algorithm can only provide the frequency information of the signal.  #@NEW_LINE#@#  To obtain the amplitude of each oscillation, we need to apply least squares fitting, where the amplitudes of dominant oscillations satisfy a = (H )1 H x.  #@NEW_LINE#@#  It should mentioned that in contrast with the pencil method, MUSIC cannot provide the decay (growth) rate of the oscillations.  #@NEW_LINE#@#  

ESPRIT  #@NEW_LINE#@#  
This is another parametric spectral estimation algorithm [7], [8].  #@NEW_LINE#@#  It analyzes the subspaces of the correlation matrix.  #@NEW_LINE#@#  It estimates the poles relying on rotational transformation.  #@NEW_LINE#@#  As in MUSIC: , j = 1, , K, i = 1, , N, where zj are the poles.  #@NEW_LINE#@#  We can construct 1 = (1: N  1,:), and 2 = (2: N,:).  #@NEW_LINE#@#  The relationship between these two quantities is 2 = 1 , where  = diag [z1, z2, , zK], is the phase shift matrix that represents a rotation.  #@NEW_LINE#@#  Now we construct a similar structure applying on signal subspace S that contains the eigenvectors of the autocorrelation matrix Rxx corresponding to the K largest eigenvalues.  #@NEW_LINE#@#  Let  #@NEW_LINE#@#  

Note that the relationship between S1 and S2 is S2 = S1 .  #@NEW_LINE#@#  Because  and S have the same column space (see [7, 8]), we have that  = ST, where T is an invertible subspace rotation matrix.  #@NEW_LINE#@#  So we have  = T-1 T. Therefore the poles are the eigenvalues of .  #@NEW_LINE#@#  Finally least square (LS) to obtain  The eigenvalues of , are the poles .  #@NEW_LINE#@#  Thus ESPRIT can estimate both the frequency and the decay (growth) rate of the oscillations.  #@NEW_LINE#@#  However, as with MUSIC, we need to use LS to obtain the amplitude of each oscillation.  #@NEW_LINE#@#  

Wavelet_transform  #@NEW_LINE#@#  
Wavelet transforms can be divided into two categories, the continuous (CWT) and the discrete (DWT) versions.  #@NEW_LINE#@#  CWT is more suitable for analyzing biologic rhythms because of the associated heat maps are two-dimensional.  #@NEW_LINE#@#  
In CWT a time signal x(t) is convolved with a wavelet function.  #@NEW_LINE#@#  This leads to a time-frequency representation which provides spectrum information in a local time window.  #@NEW_LINE#@#  This transform can be expressed as , where s is the frequency scale, *(t) is the wavelet function.  #@NEW_LINE#@#  Since the signal data is obtained by sampling, we can approximately rewrite the equation as .  #@NEW_LINE#@#  It follows that the integral or sum is applied on the range  to  that means the domain of signal x(t) or x(n) should be the range from  to .  #@NEW_LINE#@#  But the signals considered have finite length, in which case the edge effects become obvious, especially in the low-frequencies.  #@NEW_LINE#@#  
In practice, there are many wavelet functions that can be chosen, both real- and complex-valued.  #@NEW_LINE#@#  Real-valued wavelets are useful for treating peaks and discontinuities of signals while complex-valued wavelets yield the information of amplitude and phase simultaneously [9].  #@NEW_LINE#@#  

Statistical_methods  #@NEW_LINE#@#  
In this section three statistical methods, namely ARSER, JTK_CYCLE and RAIN, will be investigated and their ability to detect biological rhythms evaluated.  #@NEW_LINE#@#  Those methods focus on the (one) most dominant oscillation in the data, especial JTK_CYCLE and RAIN.  #@NEW_LINE#@#  These constitute statistical tests that calculate the p-value to determine whether a certain rhythm exists in the data [1012].  #@NEW_LINE#@#  

ARSER  #@NEW_LINE#@#  
ARSER uses the autoregressive (AR) model to obtain the period of oscillation.  #@NEW_LINE#@#  It then uses linear regression (harmonic) to determine the amplitude and the phase of the oscillation.  #@NEW_LINE#@#  Finally applying the F-test to pre-processed data and regressive data determines whether an oscillation exists.  #@NEW_LINE#@#  
Pre-processing the data.  #@NEW_LINE#@#  Because the data may not be stable, ARSER applies linear detrending to the raw data.  #@NEW_LINE#@#  It then uses linear regression to fit the data as a straight line.  #@NEW_LINE#@#  Subsequently ARSER uses a fourth-order Savizky-Golay algorithm to smooth the data.  #@NEW_LINE#@#  This low-pass filter removes the pseudo-peaks in the spectrum.  #@NEW_LINE#@#  
Finding the period.  #@NEW_LINE#@#  ARSER uses an autoregressive model to get the period of the oscillation.  #@NEW_LINE#@#  Given a pre-processed dataset  with period interval .  #@NEW_LINE#@#  

where t is white noise, i are AR coefficients, n is the order of model (we choose n = length-of-data/).  #@NEW_LINE#@#  To calculate the coefficients, ARSER uses the Yule-Walker method, maximum likelihood estimation and the Burg algorithm.  #@NEW_LINE#@#  After AR modeling, ARSER can calculate the spectrum:  #@NEW_LINE#@#  

where  is the variance of white noise.  #@NEW_LINE#@#  ARSER finds the peaks in time window t  [20, 28] as the periods {Ti} the oscillation (the optimal periods are determined by Akaikes information criterion).  #@NEW_LINE#@#  
Harmonic Regression.  #@NEW_LINE#@#  Now we can express the pre-processed data as:  #@NEW_LINE#@#  

where i1 and i2 are the amplitudes.  #@NEW_LINE#@#  ARSER calculates those amplitude through linear regression.  #@NEW_LINE#@#  
F-test.  #@NEW_LINE#@#  Using the F-test compares the approximation data  and pre-processed data {xt}.  #@NEW_LINE#@#  The null and the alternative hypotheses are respectively  #@NEW_LINE#@#  

where Ai are the amplitudes which are calculated using linear regression, and r is the number of coefficients obtained by linear regression.  #@NEW_LINE#@#  We can calculate the F coefficient by:  #@NEW_LINE#@#  

Then we can calculate the p value using the F-distribution p = P(F, r  1, N  r), where P() is the probability function used to calculate the p value based on F-distribution.  #@NEW_LINE#@#  

JTK_CYCLE_and_RAIN  #@NEW_LINE#@#  
JTK_CYCLE and RAIN use statistical method to detect the trend in data.  #@NEW_LINE#@#  The former can find the increasing or decreasing trend in data and RAIN is a development of JTK_CYCLE which can combine these two.  #@NEW_LINE#@#  
A periodic waveform should start from the trough and increase to the peak following a decreasing part to a new trough.  #@NEW_LINE#@#  Because our data is sampling from the waveform, we can regard every time sampling data point as a variable.  #@NEW_LINE#@#  Thus we can get n variables  for the waveform such that T = n (T is the period of the waveform,  is the time interval of sampling point).  #@NEW_LINE#@#  We assume the variances of those variables are the same.  #@NEW_LINE#@#  And they have the same mean value only when the data only have noise without periodic oscillation.  #@NEW_LINE#@#  So the null and the alternative hypotheses are  #@NEW_LINE#@#  

The alternative hypotheses for RAIN is  #@NEW_LINE#@#  

Calculating the statistical coefficient of trend.  #@NEW_LINE#@#  Every variable Fi, corresponds to a sampling dataset , where mi is the number of sampling data point of the ith variable ().  #@NEW_LINE#@#  Let  if Xik  Xjl, and 0 otherwise; and , which is the Mann-Whitney U-statistic for comparison of two variables.  #@NEW_LINE#@#  For JTK_CYCLE, the statistical coefficient of trend is  #@NEW_LINE#@#  

For RAIN, the statistical coefficient of trend is  #@NEW_LINE#@#  

Calculating the p-value.  #@NEW_LINE#@#  For the test, the p-value .  #@NEW_LINE#@#  In order to calculate the p-value, we should make clear the distribution f(i) of statistical coefficient s when the null hypotheses H0 is true.  #@NEW_LINE#@#  Furthermore the distribution f(i) is computed, using a generating function .  #@NEW_LINE#@#  For JTK_CYCLE and RAIN we have respectively:  #@NEW_LINE#@#  

Thus G(z) for JTK_CYCLE and RAIN are both polynomials.  #@NEW_LINE#@#  We can get the distribution f(i) by calculating the coefficients of G(z), which can be used in the p-value equation.  #@NEW_LINE#@#  


Experimental_results__Artificial_data  #@NEW_LINE#@#  
In this section we test the performance of different methods using artificially generated signals.  #@NEW_LINE#@#  For the continuous wavelet transform, we chose the complex morlet wavelet because it allows changes to the resolution in frequency and time domain.  #@NEW_LINE#@#  For simulation data, we assume the data has the form  #@NEW_LINE#@#  

where w is white noise with zero mean and variance 2 and fi is the ith oscillation, where:  #@NEW_LINE#@#  
(7)  #@NEW_LINE#@#  
where Ai is the amplitude, i is the decay (growth) rate, i is the phase and Ti is the period.  #@NEW_LINE#@#  At first we assume that the samples are collected in unit time intervals.  #@NEW_LINE#@#  The parameters are defined in the table below; the first oscillation is almost constant with small decay; the other three oscillations have a period of approximately 24- 12- and 8-hours (see Table 1).  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0198503.t001  #@NEW_LINE#@#  
The experiment has the following parts.  #@NEW_LINE#@#  First, the sensitivity to noise is investigated.  #@NEW_LINE#@#  Here, the variance of noise is changed and the performance of each of the different methods is examined.  #@NEW_LINE#@#  Second, the impact of the length of the data is investigated.  #@NEW_LINE#@#  Finally, the frequency of data collection (can be referred to as sampling frequency) will be examined.  #@NEW_LINE#@#  
Recall that the Nyquist sampling theorem provides the lower bound for the sampling frequency in order to prevent aliasing.  #@NEW_LINE#@#  This can be used to determine appropriate sampling frequencies for continuous-time signals.  #@NEW_LINE#@#  
Sensitivity_to_noise  #@NEW_LINE#@#  
To test the sensitivity of these various methods to noise, we set the standard deviation of w as  = [0, 0.03, 0.1, 0.3].  #@NEW_LINE#@#  
Fig 1 shows curves of different methods and simulation data (length 50) with  as stated.  #@NEW_LINE#@#  The red points are simulation data, blue, green and magenta are the curves of the pencil, ESPRIT and MUSIC methods respectively.  #@NEW_LINE#@#  This figure shows that the pencil and ESPRIT methods yield a perfect fit in all situations.  #@NEW_LINE#@#  The MUSIC algorithm gives a good fit only for small amounts of noise.  #@NEW_LINE#@#  In Table 2, we display the poles obtained by using each method.  #@NEW_LINE#@#  
In Fig 2, the heat map of the wavelet transform is shown.  #@NEW_LINE#@#  It follows that yellow region is such that we cannot distinguish two oscillations with close periods.  #@NEW_LINE#@#  We can recognize 12h and 8h oscillations when the noise is weak.  #@NEW_LINE#@#  However when the noise is strong ( = 0.3), only the strongest oscillation can be determined.  #@NEW_LINE#@#  The edge effect is obvious and there are ghost lines e.g.  #@NEW_LINE#@#  around 15h, that may lead to false estimation.  #@NEW_LINE#@#  
From these considerations, we conclude that the pencil and ESPRIT methods are robust to noise.  #@NEW_LINE#@#  This is not the case for MUSIC and CWT.  #@NEW_LINE#@#  

Impact_of_data_length  #@NEW_LINE#@#  
The left-hand side plot of Fig 3 shows fit curves using different methods and simulation data (noise standard deviation 0.05) with duration L = [30, 50, 100, 200].  #@NEW_LINE#@#  The time interval for data collection is 1.  #@NEW_LINE#@#  Red points indicate simulation data, blue, green and magenta are the fit curves of pencil, ESPRIT and MUSIC algorithms, respectively.  #@NEW_LINE#@#  
The right-hand side plot shows poles of oscillations estimated with different methods (noise standard deviation 0.05) with duration L = [30, 50, 100, 200].  #@NEW_LINE#@#  The time interval for data collection is 1.  #@NEW_LINE#@#  Black * indicates the original poles of the simulation data, blue, green and magenta are the estimated poles using the pencil, ESPRIT and MUSIC algorithm, respectively.  #@NEW_LINE#@#  For more accuracy, the poles are also listed in Table 3.  #@NEW_LINE#@#  

Rate_of_data_collection_(sampling_frequency)  #@NEW_LINE#@#  
To investigate the impact of sampling of the underlying continuous-time signal, we generate artificial data with L = 50.  #@NEW_LINE#@#  Then we apply all methods to the original dataset, the half-data set (time collection interval I = 2) and third-data set (that is 1, 4, 7, 10  with time collection interval I = 3).  #@NEW_LINE#@#  In Fig 4, the left-hand side plot below shows heat maps (Y-axis is frequency domain, X-axis is time domain) of simulation data (noise standard deviation 0.05) with duration L = [30, 50, 100, 200].  #@NEW_LINE#@#  The right-hand side plot shows data fit for the various methods.  #@NEW_LINE#@#  
Conclusion.  #@NEW_LINE#@#  From the above considerations it follows that decreasing the sampling frequency does not affect the estimation significantly.  #@NEW_LINE#@#  This means that the data rate collection (sampling frequency) is not an important factor.  #@NEW_LINE#@#  In contrast, the data length is a crucial factor for all methods.  #@NEW_LINE#@#  


Experimental_results__The_pencil_method_applied_to_gene_data  #@NEW_LINE#@#  
In this section we analyze a small part of the measured data in order to validata some of the aspects of the pencil method and its comparison with the other methods.  #@NEW_LINE#@#  
Batch consisting of 171 measurements every 40min The results in this case are summarized in Table 4 and Fig 5 (S1 File.  #@NEW_LINE#@#  DATA 171 is a 10 x 171 matrix; the first row contains time; the remaining rows contain the measurements taken from 9 mice.)  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0198503.t004  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0198503.g005  #@NEW_LINE#@#  
Batch consisting of RER for restrictively fed mice (218 meas.  #@NEW_LINE#@#  every 40min) (see Table 5 and S2 File.  #@NEW_LINE#@#  DATA 218 is a 10 x 218 matrix; the first row contains time; the remaining rows the measurements taken from 9 mice.  #@NEW_LINE#@#  ).  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0198503.t005  #@NEW_LINE#@#  
Fig 6 shows the approximation by 1, 2 and 3 oscillations (upper pane) and the first four fundamental oscillations (lower pane).  #@NEW_LINE#@#  Table 6 shows the error and the angles (S3 File.  #@NEW_LINE#@#  DATA 15 is a 15 x 48 matrix; each row corresponds to a different gene; time runs from 1 to 48 hours).  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0198503.g006  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0198503.t006  #@NEW_LINE#@#  
We analyze the relationship among the decomposed oscillations, by calculating the angle among these oscillations for 10 different genes.  #@NEW_LINE#@#  We set r = 9, i.e.  #@NEW_LINE#@#  the gene signals contain four oscillations fi, i = 1, , 4.  #@NEW_LINE#@#  The approximant is thus .  #@NEW_LINE#@#  See also Table 7 (S4 File.  #@NEW_LINE#@#  DATA 10 is a 10 x 48 matrix; each row corresponds to a different gene; time runs from 1 to 48 hours.)  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0198503.t007  #@NEW_LINE#@#  
From the above tables, we can see that the angle between oscillations is around 90° in most situations.  #@NEW_LINE#@#  So oscillations are nearly orthogonal:  #@NEW_LINE#@#  

It has actually been shown in [13] that these oscillations are independent of each other.  #@NEW_LINE#@#  
Batch consisting of various measurements using mice38 min intervals (see Table 8 (S4) and Table 9 as well as Fig 7 (S5 File.  #@NEW_LINE#@#  DATA 186 is a 6 x 186 matrix; the first row contains time; the rest represent: food intake, ambulatory activity, total activity, ZTOT and heat.)  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0198503.t008  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0198503.t009  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0198503.g007  #@NEW_LINE#@#  
Variation_of_data_collection_rate  #@NEW_LINE#@#  
We compare the oscillations using all data (AD), the first half of the data (FHD), the second half of the data (SHD), odd-position data (OD), and even-position data (ED).  #@NEW_LINE#@#  This is done for a particular set of measurements, but the results are indicative of what happens in general.  #@NEW_LINE#@#  
Table 10 shows the estimated periods using different part of the data.  #@NEW_LINE#@#  It follows that the estimation of periods is consistent using AD, FHD, SHD.  #@NEW_LINE#@#  



Discussion_and_comments  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0198503.t011  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0198503.t012  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0198503.t013  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0198503.g008  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0198503.t014  #@NEW_LINE#@#  
Final_result  #@NEW_LINE#@#  
We considered a dataset consisting of 18484 genes; transcription is analyzed using the pencil method [3], the ESPRIT method, Pronys method and the three statistical methods.  #@NEW_LINE#@#  The distribution of the poles follow; recall that the poles of ideal oscillations have magnitude equal to 1.  #@NEW_LINE#@#  
Furthermore the DFT and wavelet methods are also not competitive.  #@NEW_LINE#@#  
Fig 9 shows that the pencil method has uncovered real oscillations, since the mean of the magnitude of all poles is 1.0058 and the standard deviation is 0.0010.  #@NEW_LINE#@#  The ESPRIT method follows in terms of discovering oscillations, while the Prony or LS (least squares) method and the three statistical methods give weak results.  #@NEW_LINE#@#  As explained above the main drawback of the ESPRIT method is that it has nothing to say about the orthogonality of the oscillations, which proves to be a key outcome of the pencil method.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0198503.g009  #@NEW_LINE#@#  


Concluding_remarks_and_outlook  #@NEW_LINE#@#  
The matrix pencil method allows the consistent determination of the dominant reduced-order models, thus revealing the fundamental oscillations present in the data.  #@NEW_LINE#@#  The essence of the matrix pencil method is that it provides a continuous-time tool for treating a discrete-time (sampled-data) problem.  #@NEW_LINE#@#  The DFT, in contrast, is only a discrete-time tool for treating a discrete-time problem; hence its failure in this setting.  #@NEW_LINE#@#  
A key consequence of the matrix-pencil approach is the demonstration of orthogonality of the different oscillatory components, in particular the 24-hour and the 12-hour cycles.  #@NEW_LINE#@#  This points to an independence of these oscillations.  #@NEW_LINE#@#  This assertion has been subsequently confirmed in the laboratory experiments reported in [13].  #@NEW_LINE#@#  
This analysis demonstrates the applicability of signal processing methodologies to biological systems and further shows the ability of the matrix pencil decomposition to demonstrate independence of biological rhythms.  #@NEW_LINE#@#  

Supporting_information  #@NEW_LINE#@#  
S1_File_DATA_171_is_a_10_x_171_matrix;_the_first_row_contains_time;_the_remaining_rows_contain_the_measurements_taken_from_9_mice  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0198503.s001  #@NEW_LINE#@#  
(MAT)  #@NEW_LINE#@#  

S2_File_DATA_218_is_a_10_x_218_matrix;_the_first_row_contains_time;_the_remaining_rows_the_measurements_taken_from_9_mice  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0198503.s002  #@NEW_LINE#@#  
(MAT)  #@NEW_LINE#@#  

S3_File_DATA_15_is_a_15_x_48_matrix;_each_row_corresponds_to_a_different_gene;_time_runs_from_1_to_48_hours  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0198503.s003  #@NEW_LINE#@#  
(MAT)  #@NEW_LINE#@#  

S4_File_DATA_10_is_a_10_x_48_matrix;_each_row_corresponds_to_a_different_gene;_time_runs_from_1_to_48_hours  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0198503.s004  #@NEW_LINE#@#  
(MAT)  #@NEW_LINE#@#  

S5_File_DATA_186_is_a_6_x_186_matrix;_the_first_row_contains_time;_the_rest_represent__Food_intake__ambulatory_activity__total_activity__ZTOT_and_heat  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0198503.s005  #@NEW_LINE#@#  
(MAT)  #@NEW_LINE#@#  


References  #@NEW_LINE#@#  


