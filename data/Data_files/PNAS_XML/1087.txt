article id="http://dx.doi.org/10.1073/pnas.1717765115"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Fitness landscape of the human immunodeficiency virus envelope protein that is targeted by antibodies  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
An effective vaccine for HIV is still not available, although recent hope has emerged through the discovery of antibodies capable of neutralizing diverse HIV strains.  #@NEW_LINE#@#  Nonetheless, there exist mutational pathways through which HIV can evade known broadly neutralizing antibody responses.  #@NEW_LINE#@#  An ideal vaccine would elicit broadly neutralizing antibodies that target parts of the viruss spike proteins where mutations severely compromise the viruss fitness.  #@NEW_LINE#@#  Here, we employ a computational approach that allows estimation of the fitness landscape (fitness as a function of sequence) of the polyprotein that comprises HIVs spike.  #@NEW_LINE#@#  We validate the inferred landscape through comparisons with diverse experimental measurements.  #@NEW_LINE#@#  The availability of this fitness landscape will aid the rational design of immunogens for effective vaccines.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
HIV is a highly mutable virus, and over 30 years after its discovery, a vaccine or cure is still not available.  #@NEW_LINE#@#  The isolation of broadly neutralizing antibodies (bnAbs) from HIV-infected patients has led to renewed hope for a prophylactic vaccine capable of combating the scourge of HIV.  #@NEW_LINE#@#  A major challenge is the design of immunogens and vaccination protocols that can elicit bnAbs that target regions of the viruss spike proteins where the likelihood of mutational escape is low due to the high fitness cost of mutations.  #@NEW_LINE#@#  Related challenges include the choice of combinations of bnAbs for therapy.  #@NEW_LINE#@#  An accurate representation of viral fitness as a function of its protein sequences (a fitness landscape), with explicit accounting of the effects of coupling between mutations, could help address these challenges.  #@NEW_LINE#@#  We describe a computational approach that has allowed us to infer a fitness landscape for gp160, the HIV polyprotein that comprises the viral spike that is targeted by antibodies.  #@NEW_LINE#@#  We validate the inferred landscape through comparisons with experimental fitness measurements, and various other metrics.  #@NEW_LINE#@#  We show that an effective antibody that prevents immune escape must selectively bind to high escape cost residues that are surrounded by those where mutations incur a low fitness cost, motivating future applications of our landscape for immunogen design.  #@NEW_LINE#@#  

For different HIV proteins, the number of parameters, average site entropy, and protein length are shown.  #@NEW_LINE#@#  gp160 has orders of magnitude more parameters than the majority of the other HIV proteins, the longest length, and one of the largest average site entropy.  #@NEW_LINE#@#  Note that, to obtain a landscape purely based on experiments, the number of required in vitro experimental fitness values is proportional to the number of parameters.  #@NEW_LINE#@#  The amino acid MSA for each protein was downloaded from the Los Alamos National Laboratory (LANL) HIV sequence database (https://www.hiv.lanl.gov/).  #@NEW_LINE#@#  
(A) The general framework used for inferring a fitness landscape for gp160.  #@NEW_LINE#@#  Protein sequence data, in the form of a multiple sequence alignment (MSA), is used to infer a maximum-entropy, or least-biased, probability distribution of sequences, subject to recapitulating the observed one- and two-point mutation probabilities.  #@NEW_LINE#@#  This distribution is termed the sequence prevalence landscape (SI Appendix, Text 2.1).  #@NEW_LINE#@#  Based on past work on other HIV proteins, we assume that protein fitness is directly proportional to sequence prevalence.  #@NEW_LINE#@#  As shown in a schematic depiction (Right), the fitness landscape traces out fitness values over the space of possible protein sequences and highlights several features expected of the gp160 landscape: HIV often escapes even in the presence of bnAbs, suggesting that many mutational pathways may have small fitness costs (i); other escape pathways may lead to a large decrease in fitness (ii); but compensatory mutations can restore fitness (iii).  #@NEW_LINE#@#  (B) Our computational framework includes three steps to solve the maximum-entropy problem.  #@NEW_LINE#@#  Step 1 involves reducing the number of mutants from the original MSA (SI Appendix, Text 2.3).  #@NEW_LINE#@#  The bar chart shows the single-mutant probabilities for one particular residue (highlighted in gray in the MSA depicted in A).  #@NEW_LINE#@#  Infrequent amino acids are combined together and treated as a single mutant (post-combined).  #@NEW_LINE#@#  Step 2 involves solving a modified minimum probability flow (MPF) objective function involving the KL divergence between the empirical distribution and a short-time evolved distribution (Eq.  #@NEW_LINE#@#  3), to include regularization and arbitrary number of mutants (SI Appendix, Text 2.3).  #@NEW_LINE#@#  Step 3 involves refining the parameters from step 2 using a Boltzmann machine-learning (BML) algorithm (SI Appendix, Text 2.3), which produces the field (hf) and coupling (Jf) parameters of the landscape.  #@NEW_LINE#@#  
Computational_Method  #@NEW_LINE#@#  
The fitness landscape is specified as a probabilistic model, chosen as the model having the maximum entropy (i.e., the model least biased by intuition), subject to the constraint of reproducing the single- and double-mutant probabilities observed in the MSA (SI Appendix, Eq.  #@NEW_LINE#@#  S5).  #@NEW_LINE#@#  For a given length-L amino acid sequence x=[x1,x2,,xL], where xi can take on any of the 20 naturally occurring amino acids or gap in the MSA, this maximum-entropy model assigns the probability (22):ph,J(x)=exp[E(x)]xexp[E(x)],E(x)=i=1Lhi(xi)+i=1Lj=i+1LJij(xi,xj),[1]where, in analogy with statistical mechanics, we refer to E(x) as the energy of sequence x.  #@NEW_LINE#@#  The parameters hi(xi) and Jij(xi,xj), referred to as fields and couplings, respectively, can be obtained by solving the following convex optimization problem (SI Appendix, Text 2.1):(h,J)=argminh,JKL(p0ph,J),[2]subject to the single- and double-mutant probabilities matching those in the MSA (SI Appendix, Eq.  #@NEW_LINE#@#  S5).  #@NEW_LINE#@#  Here, p0 denotes the patient-weighted sequence probability distribution from the MSA (SI Appendix, Text 2.1), and KL(p0ph,J) denotes the KullbackLeibler divergence between p0 and ph,J (SI Appendix, Eq.  #@NEW_LINE#@#  S7).  #@NEW_LINE#@#  This problem can be solved in principle by BML algorithms; however, such algorithms require computing a gradient function that involves an exponential number of terms in L, thereby making direct computation infeasible for the gp160 protein.  #@NEW_LINE#@#  A solution to this challenge is provided for other HIV proteins by use of a cluster expansion approach along with BML (24, 29, 30).  #@NEW_LINE#@#  However, achieving reliable statistical inference for gp160 is difficult due to the large parameter space (Fig 1) and the relatively small number of sequences available for gp160 (SI Appendix, Text 1).  #@NEW_LINE#@#  The method described here addresses these issues via three main steps (Fig 2B and SI Appendix, Text 2).  #@NEW_LINE#@#  The most important of these is the introduction of a computationally efficient algorithm that produces accurate initial estimates of the fields and couplings.  #@NEW_LINE#@#  This method is augmented by the refinement of these estimates using BML, which, due to the accuracy of the initialization, converges quickly, and the application of a variable-combining method for reducing the effective number of parameters, which is more systematic than past such approaches.  #@NEW_LINE#@#  
Our approach for providing an initial estimate of the field and coupling parameters is based on the principle of minimum probability flow (MPF) (31), which was successfully applied to different applications such as deep belief networks and independent component analysis (31), although to our knowledge it has yet to be used for the analysis of protein sequence data.  #@NEW_LINE#@#  We first describe the general idea of MPF as applied to our maximum-entropy problem, and then discuss some distinctions with related work.  #@NEW_LINE#@#  The MPF principle leads to replacing ph,J in the optimization problem (Eq.  #@NEW_LINE#@#  2) with an alternate (related) distribution that is simpler to optimize, and which is expected to yield an accurate approximation to the desired maximum-entropy solution.  #@NEW_LINE#@#  Specifically, the maximum-entropy form (Eq.  #@NEW_LINE#@#  1) is viewed as the equilibrium distribution of a Markov process with appropriately specified deterministic dynamics (SI Appendix, Text 2.3) that evolves the empirical data distribution p0 toward ph,J.  #@NEW_LINE#@#  Based on these dynamics, the original optimization problem (Eq.  #@NEW_LINE#@#  2) is replaced with the alternative problem:(hMPF,JMPF)=argminh,JKL(p0ph,J;t),[3]where ph,J;t (SI Appendix, Eq.  #@NEW_LINE#@#  S13) represents the distribution obtained by running the dynamics for time t. While this distribution, as well as the associated KL divergence in Eq.  #@NEW_LINE#@#  3, is still quite complicated, it is greatly simplified for small values of t. Specifically, for small t, the KL divergence is well approximated by a linear function of t (SI Appendix, Text 2.3):KL(p0ph,J;t)tKh,J,where Kh,J is a simple function of the field and coupling parameters h, J (see SI Appendix, Eq.  #@NEW_LINE#@#  S16 for the explicit formula).  #@NEW_LINE#@#  The parameters that minimize this function can then be easily found using a standard gradient descent algorithm.  #@NEW_LINE#@#  Importantly, choosing small t to facilitate an expansion of the KL divergence (Eq.  #@NEW_LINE#@#  3) results in an efficient objective function Kh,J, which involves only a quadratic number of terms in L (SI Appendix, Eq.  #@NEW_LINE#@#  S15), as opposed to the original problem (Eq.  #@NEW_LINE#@#  2), which was exponential in L. The estimates obtained by minimizing Kh,J are also statistically consistent (31): if the data are drawn from the maximum-entropy model (Eq.  #@NEW_LINE#@#  1), then the parameter estimates become arbitrarily accurate given a sufficiently large number of samples.  #@NEW_LINE#@#  
Of direct relevance to our problem, the MPF procedure was previously applied to learn Ising spin-glass models (31), which have the form of the maximum-entropy distribution (Eq.  #@NEW_LINE#@#  1), but restricted to modeling only two amino acids per residue.  #@NEW_LINE#@#  Our approach (SI Appendix, Text 2.3) extends that procedure to make it suitable for the gp160 problem.  #@NEW_LINE#@#  First, we allow for arbitrary numbers of amino acids per residue, which is essential due to the large sitewise amino acid variability observed in the MSA.  #@NEW_LINE#@#  Second, we introduce regularization to control sampling noise (SI Appendix, Eq.  #@NEW_LINE#@#  S17 and Text 2.3), which is required due to the large number of parameters and limited sequence data for gp160.  #@NEW_LINE#@#  The regularization parameters are chosen such that the model parameters yield a suitable balance between statistical overfitting and underfitting, based on a previously defined metric (32).  #@NEW_LINE#@#  This is achieved by appropriately biasing the estimated single- and double-mutant probabilities through regularization, to faithfully capture real mutational variability and ignore variability resulting from finite sampling (SI Appendix, Eq.  #@NEW_LINE#@#  S18 and Text 2.4).  #@NEW_LINE#@#  
By solving a proxy optimization problem, the MPF inference procedure yields a set of inferred model parameters that serve as approximations to the desired optimal maximum-entropy parameters (Eq.  #@NEW_LINE#@#  2).  #@NEW_LINE#@#  These parameters are then refined using a gradient descent-based BML algorithm, referred to as RPROP (33), with an additional regularization term (SI Appendix, Text 2.4).  #@NEW_LINE#@#  While BML algorithms are intractable when applied to the gp160 maximum-entropy problem with arbitrary initialization (Eq.  #@NEW_LINE#@#  2), such algorithms can converge quickly when accurate initial parameters resulting from the MPF-based inference procedure are provided.  #@NEW_LINE#@#  
Multiple amino acids are observed at each residue of gp160 in the MSA.  #@NEW_LINE#@#  Here, we restrict the number of amino acids explicitly modeled in the inference procedure to decrease the computational burden (30).  #@NEW_LINE#@#  We propose a general data-driven approach to combine the least frequent mutants (nonconsensus amino acids) together.  #@NEW_LINE#@#  Combining such mutants also makes sense statistically since the low-frequency mutants are particularly sensitive to sampling noise, and their corresponding parameters are more challenging to meaningfully estimate.  #@NEW_LINE#@#  This approach, applicable to any protein, can substantially decrease the number of parameters to be estimated.  #@NEW_LINE#@#  To achieve this, as in the past (30), for residue i we model only the ki most frequent mutants, while grouping the remaining qi  ki + 1 mutants together, where qi denotes the number of mutants at residue i as observed in the MSA.  #@NEW_LINE#@#  Here, ki is chosen such that, upon grouping, the entropy at residue i is at least a certain fraction  of the corresponding entropy without grouping.  #@NEW_LINE#@#  The design question is to choose an appropriate value of .  #@NEW_LINE#@#  In previous work (19, 22, 30), this factor was chosen arbitrarily.  #@NEW_LINE#@#  However, for a protein like gp160, which has a significantly larger number of parameters than the other HIV proteins (Fig 1), a more judicious choice of  may have considerable benefits.  #@NEW_LINE#@#  A lower value will combine more mutants together, thus decreasing the number of parameters to be estimated and reducing the computational burden.  #@NEW_LINE#@#  However, combining too many mutants can result in a loss of useful information regarding amino acid identities.  #@NEW_LINE#@#  These quantities can be quantified in the form of a statistical bias (SI Appendix, Text 2.2).  #@NEW_LINE#@#  
To balance these competing issues systematically, we introduce a method for selecting  based on the sequence data (SI Appendix, Text 2.2).  #@NEW_LINE#@#  It is described briefly as follows.  #@NEW_LINE#@#  For any given , for each residue i we can specify ki as indicated above.  #@NEW_LINE#@#  Letting fi(a) denote the frequency of amino acid a at residue i, this leads to a modified (sparsified) model in which the frequencies of the modified model are now as follows:fi¯(a)={fi(a)ifaless_thanki+1fi¯ifa=ki+10ifaki+1,[4]where fi¯=a=ki+1qifi(a) represents the frequency of the coarse-grained amino acid.  #@NEW_LINE#@#  The squared error/bias of this model (i.e., for the specific ) at residue i is then estimated as a=1qi[fi(a)fi¯(a)]2, while the total variance of the amino acid frequencies at residue i is estimated as a=1qifi(a)[1fi(a)]/P.  #@NEW_LINE#@#  Our aim is to select a level of coarse-graining that corresponds to the fractional entropy captured, , such that these quantities are commensurate.  #@NEW_LINE#@#  Intuitively, this approach seeks to select the sparsest model (i.e., choosing  giving the most coarse-grained combining) such that the resulting errors caused by combining do not generally exceed the statistical fluctuations in the estimated amino acid frequencies from the MSA.  #@NEW_LINE#@#  A significant advantage of such variable selection approach is that it can substantially reduce the number of maximum-entropy parameters to infer (i.e., reducing the number of fields and couplings in Eq.  #@NEW_LINE#@#  1), thereby simplifying the parameter estimation problem, but without sacrificing the predictive power of the inferred model.  #@NEW_LINE#@#  
To this end, denoting the ratio of fractional error to variance in the amino acid frequencies in the data (see above) as i() and letting i() be the average of i() taken over all residues i, we select  by numerically searching for a value that yields i() close to 1.  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
We applied the computational framework to a MSA of HIV-1 clade B gp160 amino acid sequences downloaded from the Los Alamos National Laboratory (LANL) HIV sequence database (https://www.hiv.lanl.gov/).  #@NEW_LINE#@#  The MSA was processed to ensure both sequence and residue quality (SI Appendix, Text 2.1), resulting in L = 815 residues and 20,043 sequences belonging to 1,918 patients.  #@NEW_LINE#@#  These sequences were highly variable, involving an average pairwise Hamming distance of 0.1824, normalized by L.  #@NEW_LINE#@#  
The_Computational_Method_Is_Fast_and_Accurately_Captures_the_Observed_Sequence_Statistics  #@NEW_LINE#@#  
When applied to the MSA of gp160, our computational framework took only 2.5 d of CPU time (12 h for MPF, 2 d for convergence of the subsequent BML) on a 16-core node with 128-GB RAM and 2.7-GHz processing speed.  #@NEW_LINE#@#  This is significant given the large number of parameters that needed to be estimated (4.4 million).  #@NEW_LINE#@#  The computational efficiency was aided by the initial variable selection phase, which reduced the number of parameters by a factor of 6.  #@NEW_LINE#@#  The inferred model accurately reproduced the single- and double-mutant probabilities observed in the MSA (Fig 3 A and B), as required.  #@NEW_LINE#@#  The fast convergence of the BML algorithm in our framework was due both to the significant reduction in parameters achieved with the initial selection phase, as well as the high accuracy of the initialization parameters estimated by MPF (Fig 3 A and B).  #@NEW_LINE#@#  Nonetheless, the BML refinement led to a better fit of the single- and double-mutant probabilities, while also yielding a clear improvement in terms of connected correlations (Fig 3C).  #@NEW_LINE#@#  Finally, while the model was designed to explicitly reproduce single- and double-mutant probabilities, the inferred parameters also captured higher order statistics (Fig 3D).  #@NEW_LINE#@#  This information was not reflected by the model produced by MPF, emphasizing the importance of the subsequent BML estimation phase.  #@NEW_LINE#@#  

Inferred_Fitness_Landscape_Accurately_Predicts_in_Vitro_Replicative_Fitness_Measurements  #@NEW_LINE#@#  
To assess the ability of the inferred model to capture the fitness of different strains of gp160, we compared predictions based on this model to in vitro measurements of HIV fitness.  #@NEW_LINE#@#  We compiled 98 fitness measurements from in vitro experiments using competition (16, 17, 34, 35) or infectivity assays (18, 36).  #@NEW_LINE#@#  Strains used in these experiments were constructed by engineering single, double, or higher order mutations on a CCR5-tropic strain.  #@NEW_LINE#@#  However, there was no explicit consideration given to choosing higher order mutants that exhibit epistatic coupling, known to be important in vivo (Discussion).  #@NEW_LINE#@#  The metric of fitness in our model is the energy, E in Eq.  #@NEW_LINE#@#  1.  #@NEW_LINE#@#  Larger values of E correspond to less-fit strains.  #@NEW_LINE#@#  Based on the values of E computed using our fitness landscape, we predicted the relative fitness of the experimentally tested strains.  #@NEW_LINE#@#  We then determined the rank correlation [based on a weighted Spearman correlation measure (SI Appendix, Eq.  #@NEW_LINE#@#  S19 and Text 3)] between these values of E and the measured fitness values (Fig 4A).  #@NEW_LINE#@#  As anticipated, we found a strong weighted negative correlation (SI Appendix, Eq.  #@NEW_LINE#@#  S19), given by ¯=0.74 between model energies and viral fitness (see SI Appendix, Fig S1 and Text 3 for results for each individual experiment).  #@NEW_LINE#@#  These results demonstrate the ability of the inferred landscape to discriminate the relative intrinsic fitness of different HIV strains with mutations in gp160.  #@NEW_LINE#@#  We note that the predicted combining factor  = 0.95, established at the initial variable combining phase, produced a landscape that achieved the strongest correlation with fitness values compared with other values of  (SI Appendix, Table S3).  #@NEW_LINE#@#  

Inferred_Couplings_Predict_Contact_Residues  #@NEW_LINE#@#  
We expect that strongly interacting pairs of residues should be associated with strong couplings.  #@NEW_LINE#@#  For example, we previously showed in other HIV proteins that strong couplings are associated with compensatory mutations or those that interact synergistically to make the double mutant especially unfit (22, 24, 25).  #@NEW_LINE#@#  We used the couplings inferred for gp160 to predict residues that are likely to be in contact in the proteins native state, which can be determined from crystal structures.  #@NEW_LINE#@#  The rationale is that residues that are in close spatial proximity in the proteins native state should have a greater influence on each other, and this effect can be quantified by a measure dependent on the corresponding couplings (37, 38).  #@NEW_LINE#@#  Similar approaches were originally developed to predict residues in contact in the 3D protein structure on the basis of their inferred interactions, and have recently been extended to identify sets of interacting proteins on the basis of strong inferred couplings (39, 40).  #@NEW_LINE#@#  As our model is inferred from in vivo data, we anticipate that the model should capture contacts in the gp160 trimer that constitutes the functionally important HIV spike, not just contacts between residues in monomers of gp120 or gp41.  #@NEW_LINE#@#  To test this, we compared the top predicted contacts (a function of our model couplings) with known contacts based on a crystal structure of SOSIP (41), a synthetic mimic of the native gp160 trimer [Protein Data Bank (PDB) ID code 5D9Q].  #@NEW_LINE#@#  The results (Fig 4B) demonstrate that the couplings in our inferred model are predictive of protein contacts for the gp160 trimeric spike of HIV.  #@NEW_LINE#@#  We found similar results for nine other crystal structures (SI Appendix, Fig S3).  #@NEW_LINE#@#  
Although our inferred couplings can predict contacts well, apparent false positives are still observed.  #@NEW_LINE#@#  To examine this further, we considered the top 20 residue pairs that have the largest average product correctiondirect information (APC-DI) scores, in which 8 of these are not predicted to be in contact (SI Appendix, Table S4).  #@NEW_LINE#@#  With the exception of one residue pair, these residues are located in the V2 or V4 loop, or are CD4 contacts.  #@NEW_LINE#@#  For the residues in the V2 loop or those that are CD4 contacts, a possible reason for these residue pairs having a high APC-DI score is due to the conformational changes that occur when gp160 interacts with CD4 and other coreceptors, which is not captured in the protein structures.  #@NEW_LINE#@#  Indeed, conformational changes due to gp160CD4 interaction have been well documented for the V2 loop (42).  #@NEW_LINE#@#  These conformational changes may favor or disfavor certain pairs of mutations.  #@NEW_LINE#@#  For the 389417 residue pair in the V4 loop, it is not clear why this pair has a high APC-DI score, although we note that these residues are located near the base of the loop.  #@NEW_LINE#@#  

Observed_Mutations_in_Footprints_of_CD4_Binding_Site_bnAbs_Have_Low_Fitness_Costs  #@NEW_LINE#@#  
As further validation of our landscape, we investigated whether its predictions explain why certain mutations that change the binding of bnAbs are observed in circulating virus strains, and others are not.  #@NEW_LINE#@#  Based on crystal structures, we first determined the residues on gp160 that were in contact with a number of CD4 binding-site bnAbs (listed in SI Appendix, Text 8).  #@NEW_LINE#@#  The CATNAP online tool (43) is a database of experimental IC-50 measurements between panels of bnAbvirus pairs.  #@NEW_LINE#@#  To determine whether mutations in gp160 residues that were in contact with the bnAbs affected binding, we used a feature in CATNAP that uses Fishers exact test to identify viral amino acids that are statistically associated (P less_than 0.05) with either high or low IC-50 scores.  #@NEW_LINE#@#  This analysis allowed us to determine a set of residues in gp160 contained in the footprints of CD4 binding-site antibodies that are statistically associated with a change in IC-50 for at least one mutant amino acid.  #@NEW_LINE#@#  These residues have at least one amino acid substitution pathway that changes the binding affinity to bnAbs.  #@NEW_LINE#@#  We analyzed only viral strains observed in the MSA that correspond to viable viruses.  #@NEW_LINE#@#  
At the identified set of residues, we further classify specific amino acid mutations as either observed, defined as those mutations associated with a change in binding to bnAbs in the CATNAP data and observed in the MSA, or unobserved, defined as mutations that are not in the CATNAP data (irrespective of whether they are observed in the MSA).  #@NEW_LINE#@#  We found that roughly 90% of these unobserved mutations are absent from the MSA (SI Appendix, Fig S5A), and therefore are likely to be unviable.  #@NEW_LINE#@#  Furthermore, the largest frequency for an amino acid mutation present in the MSA but absent from CATNAP is small [i.e., less than 5% (SI Appendix, Fig S5B)], while the amino acid mutations observed in the CATNAP data are representative of those observed in the MSA (SI Appendix, Fig S5C).  #@NEW_LINE#@#  We expect, therefore, that observed mutations would be associated with lower fitness costs than unobserved mutations, since they are associated with viable viruses, and hence they are expected to escape the immune pressure with the least effect on the ability to propagate infection.  #@NEW_LINE#@#  
To assess whether the predictions of our fitness landscape are consistent with these expectations, we employed a measure that has been used before to predict the fitness cost of a mutation averaged over all sequence backgrounds (24).  #@NEW_LINE#@#  Specifically, we compute the change in energy associated with the mutation averaged over a Monte Carlo sample of diverse sequence backgrounds obtained using our fitness landscape to approximate:Ei,hf,Jf(a)=x,xi=0[Ehf,Jf(x)Ehf,Jf(x)]phf,Jf(x),[5]where hf and Jf represent the final parameters after BML refinement, and the summation is over all sequences x having the consensus amino acid (0) at the ith residue.  #@NEW_LINE#@#  Here, x is identical to x, except with the amino acid at residue i replaced by a.  #@NEW_LINE#@#  This measure quantifies the typical change in fitness upon introducing this mutation at the residue across various sequence backgrounds in circulating viruses.  #@NEW_LINE#@#  A positive fitness cost implies a decrease in fitness (22, 24).  #@NEW_LINE#@#  As predicted, the observed mutations at the residues that affect IC-50 are predicted to incur a lower average fitness cost compared with amino acid mutations that were not observed (Fig 5A).  #@NEW_LINE#@#  
The difference in mean fitness cost between observed and unobserved mutations is due to the presence of some observed mutations with very low fitness costs, coupled with high fitness costs for many unobserved mutations.  #@NEW_LINE#@#  The existence of the low-fitness cost pathways that also likely abrogate binding implies that even canonically broad and potent bnAbs are imperfect.  #@NEW_LINE#@#  In patients who develop bnAbs upon natural infection, the viral quasispecies readily evolves escape mutations (1); escape mutations also eventually arise when bnAbs are administered passively (44), even when multiple bnAbs are used in concert (44, 45).  #@NEW_LINE#@#  
To further test our fitness landscape, we next focused on the gp160 residues in CD4 binding site antibody footprints that are not statistically associated with changes in IC-50 according to the analysis using CATNAP.  #@NEW_LINE#@#  We first examined whether the amino acid mutations at these residues that are observed are biochemically similar to each other and to the consensus amino acid at the residue.  #@NEW_LINE#@#  To determine this, for each residue, we calculated the biochemical similarity between the nonconsensus amino acid and the respective consensus amino acid, averaged over all sequences in the panels with nonconsensus amino acid at that residue (SI Appendix, Eq.  #@NEW_LINE#@#  S25).  #@NEW_LINE#@#  The similarity matrix (46) assigns to each pair of amino acids a similarity score ranging from 0 to 6, with matching amino acids assigned a value of either 5 or 6, where 6 is assigned to the more rare, unique amino acids (F, M, Y, H, C, W, R, and G) to reflect this.  #@NEW_LINE#@#  Mismatched amino acids are assigned values from 3 to 0 based on their polarity, hydrophobicity, shape, and charge (47).  #@NEW_LINE#@#  For each residue, the average biochemical similarity calculated above was compared with a simulated null model in which the nonconsensus amino acids observed in the bnAbvirus panels were randomly selected from all nonconsensus amino acids at that residue (SI Appendix, Fig S5D).  #@NEW_LINE#@#  The average similarity was above the fifth percentile of the respective null model for 53% of the residues (SI Appendix, Fig S5D), indicating that, on average, the amino acids sampled at these residues are more biochemically similar to the consensus amino acid than a uniformly selected random sample.  #@NEW_LINE#@#  The fact that the observed mutations are biochemically similar may explain why they did not significantly alter binding characteristics of the bnAbs.  #@NEW_LINE#@#  We then computed the fitness cost for the observed mutations at these residues and compared them with the mutations that were not observed as before.  #@NEW_LINE#@#  We expect that the latter mutations to biochemically different amino acids may have affected IC-50, but did not arise in viable viruses because of their high fitness costs; that is, the fitness cost associated with evolving escape mutations was prohibitive.  #@NEW_LINE#@#  Consistent with this expectation, our fitness landscape predicts that the fitness cost for the observed mutations are lower than those for the unobserved mutations (Fig 5B).  #@NEW_LINE#@#  

bnAbs_That_Target_the_CD4_Binding_Site_Contact_Select_Residues_That_Are_Predicted_to_Be_Associated_with_a_High_Fitness_Cost_upon_Mutation  #@NEW_LINE#@#  
We computed the fitness cost associated with making mutations at all gp160 residues by carrying out Monte Carlo simulations to obtain an ensemble of sequences, all of which contained the consensus amino acid at a chosen residue.  #@NEW_LINE#@#  This ensemble of sequences was used to estimate the fitness cost for each particular mutation from consensus to a nonconsensus residue, as in Eq.  #@NEW_LINE#@#  5 above.  #@NEW_LINE#@#  The results were then averaged over the mutant amino acids (24) to weight more likely mutations more highly as shown below:Ei¯=a=1qiEi,hf,Jf(a)exp[Ei,hf,Jf(a)]a=1qiexp[Ei,hf,Jf(a)][6]where qi is the number of mutants at residue i after mutant combining (SI Appendix, Text 2).  #@NEW_LINE#@#  Eq.  #@NEW_LINE#@#  6 provides us with an average fitness cost of evolving mutations at a particular residue, i, averaged over all sequence backgrounds in which the mutation might arise and over all mutant amino acids.  #@NEW_LINE#@#  We then superimposed this predicted residue-level fitness costs onto the SOSIP crystal structure.  #@NEW_LINE#@#  This can be visualized in a heat map depicting the fitness costs of residues that we determined to be accessible on the surface of SOSIP (Fig 6A) (SI Appendix, Text 6).  #@NEW_LINE#@#  These results show that the map is very rugged, composed of a mixture of closely spaced low- and high-fitness cost residues.  #@NEW_LINE#@#  To obtain a clearer picture of whether low-fitness cost residues are predominant in any region of the size of a typical antibody footprint, we calculated the fitness cost (SI Appendix, Eq.  #@NEW_LINE#@#  S24) averaged over all surface residues within 12.5 Å of the chosen residue (the radius of a typical antibody footprint, as estimated from analyzing various bnAbgp160 crystal structures).  #@NEW_LINE#@#  The corresponding heat map shows that fitness costs averaged over the antibody footprint are smooth over the entire surface on this scale (Fig 6B).  #@NEW_LINE#@#  Ab-footprintsized regions are typically dominated by low-fitness cost residues.  #@NEW_LINE#@#  Thus, most Ab responses that arise may be escaped via mutations.  #@NEW_LINE#@#  Even though the CD4 binding site has one of the largest fitness costs when averaged over a typical antibody footprint size (Fig 6B), there still exist several residues associated with low fitness costs for mutations.  #@NEW_LINE#@#  Hence, if mutations at these residues lead to abrogation of Ab binding, then they present relatively easy escape pathways for the virus, consistent with the previous observation based on CATNAP data.  #@NEW_LINE#@#  We note that two other regions in Fig 6A appear to have large numbers of high-escape cost residues: (i) the 0 and 1¯ motifs of the C1 region of gp120, located in the trimer core near the intertrimer interfaces as well as the gp120gp41 interface (48), and (ii) a region of gp41 containing portions of the H2 and membrane-proximal external region (MPER) motifs (4952), although much of the MPER region is truncated in the 5D9Q crystal structure, including the epitopes for MPER-directed bnAbs 2F5 and 4E10 (51).  #@NEW_LINE#@#  However, the first region is sterically inaccessible to antibodies, while the second region contains a few highly variable residues that dominate the averaging in Eq.  #@NEW_LINE#@#  6, and thus on the scale of a footprint it is not very conserved.  #@NEW_LINE#@#  
We next examined the residues in the CD4 binding site region that are most strongly associated with the binding of the VRC01 class of antibodies.  #@NEW_LINE#@#  Li et al.  #@NEW_LINE#@#  (53) created an extensive set of alanine scanning mutants on a background of JRCSF, a CCR5-tropic clade B gp160 strain.  #@NEW_LINE#@#  For each alanine mutant, the authors measured binding affinity of full-length gp120 monomer to VRC01 relative to the wild-type virus.  #@NEW_LINE#@#  This assay led to the identification of residues where mutation to alanine led to significant decrease in VRC01gp120 binding.  #@NEW_LINE#@#  The authors additionally conducted a neutralization assay in which whole mutant pseudoviruses are incubated with live target cells, and loss of infectivity is measured as a function of concentration of added CD4Ig, a synthetic construct in which the CD4 domains 1 and 2 are fused to human IgG1 Fc domain.  #@NEW_LINE#@#  CD4Ig competes with target cells to bind to the CD4 binding site of the pseudovirus, thus hindering infection of target cells.  #@NEW_LINE#@#  In this assay, if lower concentrations of CD4Ig are required to inhibit infection, a decreased ability of the alanine mutant to infect via CD4-mediated interactions is indicated.  #@NEW_LINE#@#  In other words, a viral strain with a low CD4Ig value has a low replicative fitness.  #@NEW_LINE#@#  The portion of these data corresponding to the gp160 residues in contact with VRC01 can be determined from crystal structures (SI Appendix, Table S5).  #@NEW_LINE#@#  
Of the residues on gp160 that were determined to be important for binding to VRC01, seven of these result in significant loss of binding (less_than33%) to gp120 upon mutation to alanine.  #@NEW_LINE#@#  While three of these seven (367, 368, and 457) are predicted by our landscape to have high fitness cost upon mutation, the remaining four (279, 371, 467, and 474) have much lower predicted fitness cost.  #@NEW_LINE#@#  This is seemingly at odds with the apparent high fitness cost of mutation to alanine for all seven residues, as measured experimentally (loss in sensitivity to CD4Ig neutralization).  #@NEW_LINE#@#  This discrepancy can likely be explained by examining these residues at the amino acid level.  #@NEW_LINE#@#  For the four residues in question, the most common nonconsensus amino acid accounts for a large fraction of sequences in the MSA (SI Appendix, Fig S6), and it is not alanine.  #@NEW_LINE#@#  Thus, mutation to the most common nonconsensus amino acid is unlikely to result in a high fitness cost.  #@NEW_LINE#@#  Furthermore, in the CATNAP panel described in the previous section, neither the consensus nor the most common mutant amino acid is significantly associated with change in IC-50.  #@NEW_LINE#@#  Rather, the distributions of IC-50s for sequences containing either the consensus or the most common mutant amino acid are indistinguishable by two-tailed t test (SI Appendix, Fig S6).  #@NEW_LINE#@#  This evidence suggests that mutation to the most common mutant amino acid may be insufficient to abrogate binding to VRC01.  #@NEW_LINE#@#  Our predicted fitness costs are likely artificially low, since Eq.  #@NEW_LINE#@#  6 tends to weight low-fitness cost amino acid mutations highly during the averaging procedure and we infer that mutation to the most common nonconsensus amino acid does not incur a high fitness cost.  #@NEW_LINE#@#  If we instead calculate the fitness costs for these residues specifically to alanine, we predict much higher values (3.7, 4.2, 2.7, and 4.7, for residues 279, 371, 467, and 474, respectively).  #@NEW_LINE#@#  In contrast, for the three residues with high predicted fitness cost, the frequency of the most-common mutant amino acid was at most 0.2% in the MSA.  #@NEW_LINE#@#  Thus, although alanine was not the most-common mutant, the experimental fitness measurements made using alanine mutants were representative of typical escape costs at these residues.  #@NEW_LINE#@#  Most convincingly, 9 out of the top 10 residues with largest predicted fitness cost had an undetectable CD4Ig value (SI Appendix, Table S5), further suggesting that our landscape provides an accurate measure of intrinsic fitness.  #@NEW_LINE#@#  
These results show that, consistent with observations regarding the VRCO1 class of antibodies, our fitness landscape predicts that bnAbs that target the CD4 binding-site region selectively bind to those residues associated with the largest fitness costs.  #@NEW_LINE#@#  They furthermore highlight the importance of describing fitness at the amino acid level of detail, not just residuesa fact that further highlights the importance of the fitness landscape that we have inferred.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
HIV is a highly mutable virus, and the design of both T cell and antibody arms of an effective vaccine would benefit from a knowledge of its mutational vulnerabilities as this would identify targets on the HIV proteome and viral spike where potent immune responses should be directed.  #@NEW_LINE#@#  Determining the fitness of the virus (ability to assemble, replicate, and propagate infection) as a function of the sequence of its proteins would help in this regard.  #@NEW_LINE#@#  Because of the significance of compensatory or deleterious coupling between mutations at multiple residues, in determining such a fitness landscape, it is important to account for the effects of coupling between mutations.  #@NEW_LINE#@#  Past work has been reasonably successful in determining such a fitness landscape for diverse HIV polyproteins by inferring the same from sequence data and testing predictions against in vitro experiments and clinical data (19, 2225).  #@NEW_LINE#@#  This has not been true for the gp160 Envelope polyprotein that forms the viruss spike and is targeted by antibodies.  #@NEW_LINE#@#  This is due to the large diversity and size of gp160 (Fig 1).  #@NEW_LINE#@#  We have reported a computational approach, based on the maximum-entropy method (19, 22), which includes a data-driven parameter reduction method, an initial estimation of the prevalence landscape parameters based on the principle of MPF, followed by a BML procedure to refine the parameters (Fig 2).  #@NEW_LINE#@#  We applied this framework to infer the fitness landscape of gp160 from available sequence data.  #@NEW_LINE#@#  Predictions of the resulting model compare very well with published experimental data, including intrinsic fitness measurements, protein contacts in the SOSIP trimer, and known escape mutations that arise to evade antibodies that target the CD4 binding site.  #@NEW_LINE#@#  
A natural question, equally valid for any viral protein, is why one may see a strong relation between prevalence and fitness, and what are the fundamental processes underpinning this relationship.  #@NEW_LINE#@#  Motivated by this question, for internal HIV proteins that are targeted by cytotoxic T lymphocytes (CTLs), a mechanistic explanation has been proposed on the basis of simulation studies of HIV evolution and associated theory (22, 23, 26).  #@NEW_LINE#@#  Three key factors were identified for HIV proteins: (i) Because of the huge diversity of HLA genes in the population, very few regions of the HIV proteome are targeted by a significant fraction of humans.  #@NEW_LINE#@#  (ii) If a mutation is forced by the immune response of a particular individual and it incurs a fitness cost, then upon infection of a new patient who does not target the same region, during chronic infection the first mutation will revert.  #@NEW_LINE#@#  (iii) Unlike influenza, the HIV population has not been subjected to a few effective classes of natural or vaccine-induced immune responses by a significant fraction of humans across the world.  #@NEW_LINE#@#  Therefore, it has not evolved in narrowly directed ways to evade effective herd memory responses.  #@NEW_LINE#@#  (iv) Furthermore, the effects of phylogeny are ameliorated due to high rates of recombination (54).  #@NEW_LINE#@#  For these reasons, over reasonable mutational distances, HIV proteins are in a steady state and so amenable to inference of fitness landscapes using maximum-entropy approaches applied to sequence data.  #@NEW_LINE#@#  This is decidedly not true for the influenza population, which is driven far out of equilibrium (55, 56).  #@NEW_LINE#@#  The first of the above arguments, however, does not translate directly to gp160, which is primarily targeted by antibodies (57).  #@NEW_LINE#@#  While it is tempting to draw high-level analogies with the CTL-based phenomena on the basis that the diversity of antibodies generated against HIV is large, there are clear distinctions.  #@NEW_LINE#@#  For example, it is known that the V2 loop of gp160 is estimated to be immunogenic in 2040% of infected patients, while the V3 loop induces antibodies in essentially all infected patients (58).  #@NEW_LINE#@#  This would seem to promote more directed evolution compared with the internal proteins under CTL pressure.  #@NEW_LINE#@#  However, it is possible that different individuals evolve antibodies that target different residues in the V2 and V3 loops.  #@NEW_LINE#@#  It is also true that peptides derived from gp160 are targeted by CTLs, and that antibody responses are often directed toward debris from the fragile HIV spike.  #@NEW_LINE#@#  These reasons may underlie why we see excellent correspondence between our inferred model for gp160 and experimental measurements.  #@NEW_LINE#@#  Nonetheless, the mechanistic reasons remain unclear for gp160.  #@NEW_LINE#@#  Resolving these basic principles governing the strong prevalencefitness correspondences identified in this paper for gp160 is worthy of future study.  #@NEW_LINE#@#  
We also considered an optimized model using the fields only, obtained by fitting only the single-mutant probabilities.  #@NEW_LINE#@#  We observe a modest gain in using the model with couplings, compared with the fields model; that is, the fields model has a correlation of ¯=0.69 compared with the correlation of ¯=0.74 using our computational framework.  #@NEW_LINE#@#  
The reason the comparison with in vitro fitness measurements is not much worse for the model with fields only is because the coupling matrix is relatively sparse, and so unless fitness measurements are carried out with only the subset of mutants with large couplings, the fields are dominant.  #@NEW_LINE#@#  No such preselection was done in the data on in vitro fitness that we compared our predictions against.  #@NEW_LINE#@#  The value of the coupling parameters is seen in several contexts.  #@NEW_LINE#@#  For example, protein contacts simply cannot be predicted without the couplings because the physical interactions between these residues induce a correlated mutation structure.  #@NEW_LINE#@#  More importantly, the fitness consequences of the couplings can be very significant for the evolution of HIV in vivo (the situation of ultimate interest), as described below.  #@NEW_LINE#@#  
Barton et al.  #@NEW_LINE#@#  (24) studied a cohort of HIV-infected individuals and used the inferred fitness landscapes of HIV proteins (other than gp120) to predict how long it took for the virus to escape from the initial T cell immune pressure in individual patients.  #@NEW_LINE#@#  When using single-residue entropy alone (i.e., fields only), there was only a 15% correlation between single-residue conservation and escape time.  #@NEW_LINE#@#  However, when they carried out dynamic simulations of the evolution using the fitness landscape that includes coupling parameters, this correlation was 72% and statistically significant.  #@NEW_LINE#@#  The reason for this dramatic increase in performance upon including the couplings is that evolutionary trajectories in vivo can sample many potential compensatory pathways that may aid escape due to the high rate of replication and mutation of HIV.  #@NEW_LINE#@#  Therefore, pathways characterized by particularly strong compensatory couplings can be accessed.  #@NEW_LINE#@#  Similarly, Barton et al.  #@NEW_LINE#@#  (24) showed that dramatic differences in escape time for patients targeting the same epitope could be explained by differences in the background mutations contained in the sequence of the virus strains that infected these patients.  #@NEW_LINE#@#  For example, if the background mutations had strong negative couplings with the ultimate escape mutation, the escape mutation took much longer to evolve and take over the population.  #@NEW_LINE#@#  Therefore, in the context of the real in vivo situation of interest, including the couplings is very significant.  #@NEW_LINE#@#  This point has also been emphasized in other contexts where compensatory mutations have been observed (1618, 59, 60).  #@NEW_LINE#@#  
While our method was developed to address the specific challenges posed by the gp160 protein, the approach is general and may be applied to other high-dimensional maximum-entropy inference problems.  #@NEW_LINE#@#  For example, it may be directly applied to estimate the prevalence landscape of other HIV proteins, or proteins of other viruses.  #@NEW_LINE#@#  As an example, we applied the framework to p24, a relatively conserved internal protein of HIV.  #@NEW_LINE#@#  The landscape with 80,000 parameters was inferred very quickly (2.3 h for MPF and 1.2 h for the subsequent BML), and predictions from this landscape compared favorably with experimental fitness values (19), returning a strong Spearman correlation of 0.8 (SI Appendix, Fig S2).  #@NEW_LINE#@#  For p24, along with other HIV proteins, similar correspondences between prevalence and fitness have been obtained through other maximum-entropy inference methods (19, 2224).  #@NEW_LINE#@#  
We showed that the fitness landscape of the surface-accessible parts of the ENV trimer is very rugged where a few residues that incur a large fitness cost upon mutation (including the effects of couplings between mutations) are surrounded by residues with a low fitness cost upon mutation (Fig 6).  #@NEW_LINE#@#  Even for the relatively conserved CD4 binding-site region, only mutations at some residues are predicted to incur large fitness costs upon mutations.  #@NEW_LINE#@#  This is consistent with the coarse-grained models of antibodyvirus binding employed in models of affinity maturation with variant antigens by Wang et al.  #@NEW_LINE#@#  (61) and Shaffer et al.  #@NEW_LINE#@#  (62).  #@NEW_LINE#@#  In contrast, in a related study, Luo and Perelson (62, 63) assumed that variant antigens contain epitopes composed of only conserved or only variable residues.  #@NEW_LINE#@#  Our observation about the spatial distribution of escape costs on the surface of HIV envelope suggests that antibody footprints will in general contain both conserved and variable residues.  #@NEW_LINE#@#  It is likely that these conserved residues need to be the principal targets of effective antibody responses that are difficult for the virus to evade.  #@NEW_LINE#@#  For this reason, the availability of our fitness landscape of HIVs envelope proteins is expected to aid the rational design of immunogens that could potentially induce bnAbs upon vaccination (17), as well as guide the choice of combination of known bnAbs that would prevent escape in humans undergoing passive antibody therapy (10).  #@NEW_LINE#@#  
Specifically, our fitness landscape can be clinically useful in the future for the selection of combination bnAb therapy.  #@NEW_LINE#@#  Much like in the realm of antiretroviral drugs, the use of multiple different bnAbs has the potential to prevent or delay escape mutations, as the viruses in the host must evolve escape mutations in combinations of binding sites of the bnAbs administered.  #@NEW_LINE#@#  Two bnAbs with epitopes that have many detrimental couplings between them in all possible sequence backgrounds are likely to delay escape in diverse patients with different virus strains due to the added difficulty of introducing simultaneous escape mutations in both epitopes.  #@NEW_LINE#@#  Furthermore, bnAbs that target epitopes containing residues wherein escape mutations can be easily compensated by other mutations should be avoided.  #@NEW_LINE#@#  The importance of considering the fitness landscape in an analogous context of antiretroviral drugs has been previously shown for protease by Butler et al.  #@NEW_LINE#@#  (25).  #@NEW_LINE#@#  
An additional application that is clinically relevant is the selection of variant antigens (e.g., variants of SOSIP) for use in a candidate HIV vaccine designed to elicit bnAbs.  #@NEW_LINE#@#  The induction of bnAbs via vaccination will likely require immunization with multiple variant antigens that share some conserved residues, but whose variable regions contain distinct mutations compared with each other.  #@NEW_LINE#@#  The fitness landscape inferred in this work can provide insight into which residues within these antigens should be mutated within candidate immunogens such that the induced bnAbs are cross-reactive to diverse circulating viral strains with different sequences.  #@NEW_LINE#@#  

Materials_and_Methods  #@NEW_LINE#@#  
SI Appendix, Text includes detailed descriptions of the data preprocessing (SI Appendix, Text 1), computational framework (SI Appendix, Text 2), fitness verification (SI Appendix, Text 3), residue contact prediction (SI Appendix, Text 4), comparison with other methods (SI Appendix, Text 5), and application of the landscape for characterizing the fitness cost of escape mutations from bnAbs (SI Appendix, Text 68).  #@NEW_LINE#@#  The landscape, processed MSA, and implementation of the computational framework are freely available on the following website: https://github.com/raymondlouie/MPF-BML.  #@NEW_LINE#@#  

Acknowledgments  #@NEW_LINE#@#  
This research was funded by the Ragon Institute of Massachusetts General Hospital, Massachusetts Institute of Technology, and Harvard (to K.J.K., J.P.B., and A.K.C.  #@NEW_LINE#@#  ), the Hong Kong Research Grant Council General Research Fund with Project 16207915 (to R.H.Y.L.  #@NEW_LINE#@#  and M.R.M.  #@NEW_LINE#@#  ), and a Harilela endowment (to M.R.M.  #@NEW_LINE#@#  ).  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  

This open access article is distributed under Creative Commons Attribution-NonCommercial-NoDerivatives License 4.0 (CC BY-NC-ND).  #@NEW_LINE#@#  

