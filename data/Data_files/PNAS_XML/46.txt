article id="http://dx.doi.org/10.1073/pnas.1506407112"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Clique topology reveals intrinsic geometric structure in neural correlations  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
Detecting structure in neural activity is critical for understanding the function of neural circuits.  #@NEW_LINE#@#  The coding properties of neurons are typically investigated by correlating their responses to external stimuli.  #@NEW_LINE#@#  It is not clear, however, if the structure of neural activity can be inferred intrinsically, without a priori knowledge of the relevant stimuli.  #@NEW_LINE#@#  We introduce a novel method, called clique topology, that detects intrinsic structure in neural activity that is invariant under nonlinear monotone transformations.  #@NEW_LINE#@#  Using pairwise correlations of neurons in the hippocampus, we demonstrate that our method is capable of detecting geometric structure from neural activity alone, without appealing to external stimuli or receptive fields.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Detecting meaningful structure in neural activity and connectivity data is challenging in the presence of hidden nonlinearities, where traditional eigenvalue-based methods may be misleading.  #@NEW_LINE#@#  We introduce a novel approach to matrix analysis, called clique topology, that extracts features of the data invariant under nonlinear monotone transformations.  #@NEW_LINE#@#  These features can be used to detect both random and geometric structure, and depend only on the relative ordering of matrix entries.  #@NEW_LINE#@#  We then analyzed the activity of pyramidal neurons in rat hippocampus, recorded while the animal was exploring a 2D environment, and confirmed that our method is able to detect geometric organization using only the intrinsic pattern of neural correlations.  #@NEW_LINE#@#  Remarkably, we found similar results during nonspatial behaviors such as wheel running and rapid eye movement (REM) sleep.  #@NEW_LINE#@#  This suggests that the geometric structure of correlations is shaped by the underlying hippocampal circuits and is not merely a consequence of position coding.  #@NEW_LINE#@#  We propose that clique topology is a powerful new tool for matrix analysis in biological settings, where the relationship of observed quantities to more meaningful variables is often nonlinear and unknown.  #@NEW_LINE#@#  

Order-based analysis of symmetric matrices.  #@NEW_LINE#@#  (A) A symmetric matrix A is related to another matrix C via a nonlinear monotonically increasing function f(x), applied entrywise.  #@NEW_LINE#@#  (B, Left) Distribution of eigenvalues for a random symmetric N×N matrix A, whose entries were drawn independently from the normal distribution with zero mean and variance 1/N (N=500).  #@NEW_LINE#@#  (Right) Distribution of eigenvalues for the transformed matrix with entries Cij=f(Aij), for f(x)=1e30x.  #@NEW_LINE#@#  Red curves show Wigners semicircle distribution with matching mean and variance.  #@NEW_LINE#@#  (C, Top) The order complex of A is represented as a sequence of binary adjacency matrices, indexed by the density  of nonzero entries.  #@NEW_LINE#@#  (Bottom) Graphs corresponding to the adjacency matrices.  #@NEW_LINE#@#  Minimal examples of a 1-cycle (yellow square), a 2-cycle (red octahedron), and a 3-cycle (blue orthoplex) appear at =0.1,0.25, and 0.45, respectively.  #@NEW_LINE#@#  (D) At edge density 0, there are no cycles.  #@NEW_LINE#@#  Cliques of size 3 and 4 are depicted with light and dark gray shading.  #@NEW_LINE#@#  As the edge density increases, a new 1-cycle (yellow) is created, persists, and is eventually destroyed at densities 1,2, and 3, respectively.  #@NEW_LINE#@#  (E) For a distribution of 1,000 random N×N symmetric matrices (N=88), average Betti curves 1(),2(), and 3() are shown (yellow, red, and blue dashed curves), together with 95% confidence intervals (shaded areas).  #@NEW_LINE#@#  
Results  #@NEW_LINE#@#  
The only feature of a matrix that is preserved under the transformations (Eq.  #@NEW_LINE#@#  1), for monotonically increasing f, is the relative ordering of its entries, as Cijless_thanCk whenever Aijless_thanAk (SI Appendix, Supplementary Text).  #@NEW_LINE#@#  We refer to this combinatorial information as the order complex, ord(C).  #@NEW_LINE#@#  It is convenient to represent the order complex as a nested sequence of graphs, where each subsequent graph includes an additional edge (ij) corresponding to the next-largest matrix entry Cij (Fig 1C).  #@NEW_LINE#@#  Any quantity computed from the order complex is automatically invariant under the transformations (Eq.  #@NEW_LINE#@#  1), because ord(A)=ord(C).  #@NEW_LINE#@#  We found that the arrangement of cliques (all-to-all connected subgraphs) in the order complex of a matrix can be used in lieu of eigenvalues to detect random or geometric structure.  #@NEW_LINE#@#  
Clique topology provides a systematic measure of how cliques fit together and overlap across the entire order complex.  #@NEW_LINE#@#  The topological structure of cliques in a graph can be quantified by first filling in all cliques, and then counting noncontractible cycles, i.e., arrangements of cliques which bound holes.  #@NEW_LINE#@#  Minimal examples of 1-, 2-, and 3-cycles are shown in Fig 1C (Inset).  #@NEW_LINE#@#  A 1-cycle bounds a 2D area, a 2-cycle bounds a 3D volume, and a 3-cycle bounds a 4D region (SI Appendix, Supplementary Text).  #@NEW_LINE#@#  As the edge density  increases, new cycles are created, modified, and eventually destroyed (Fig 1D).  #@NEW_LINE#@#  One can track these changes by computing a set of Betti numbers (6, 7), m, which count the independent m-cycles in each graph after all cliques have been filled in.  #@NEW_LINE#@#  The Betti numbers across all graphs in an order complex yield Betti curves, m() (Materials and Methods and SI Appendix, Supplementary Text).  #@NEW_LINE#@#  
Detection_of_Random_Organization  #@NEW_LINE#@#  
Although the details of individual graphs in the order complex may be sensitive to noise in the matrix entries, we found that clique topology provides robust signatures that can be used to distinguish structure from randomness.  #@NEW_LINE#@#  In the case of a random symmetric matrix with i.i.d.  #@NEW_LINE#@#  entries, the corresponding order complex is a sequence of ErdsRényi random graphs.  #@NEW_LINE#@#  We found that the Betti curves m() are remarkably reliable for such matrices (Fig 1E), and display a characteristic unimodal shape with peak values that increase with m (mN).  #@NEW_LINE#@#  This reliability has been theoretically predicted (8, 9) and makes it possible to robustly distinguish random from nonrandom structure in the presence of a monotone nonlinearity (Eq.  #@NEW_LINE#@#  1).  #@NEW_LINE#@#  Unsurprisingly, correlation matrices obtained from finite samples of N independent random variables display the same characteristic Betti curves as random symmetric N×N matrices (SI Appendix, Fig S2).  #@NEW_LINE#@#  Note that computing low-dimensional (m3) Betti curves for matrices of size N  100 is numerically tractable due to recent advances in computational topology (7, 10, 11).  #@NEW_LINE#@#  

Detection_of_Geometric_Organization  #@NEW_LINE#@#  
If a correlation or connectivity matrix is not random, what kind of structure can one detect?  #@NEW_LINE#@#  Uncovering geometric structure is especially important in neuroscience, because it indicates that neurons encode geometrically organized stimuli.  #@NEW_LINE#@#  For example, orientation-tuned neurons (12) and hippocampal place cells (1) have correlations that decrease with distance between represented angles or locations in the environment, respectively.  #@NEW_LINE#@#  This is easy to see by correlating neural responses directly to the relevant stimuli.  #@NEW_LINE#@#  However, it is unclear whether it is even possible to detect such an organization from pairwise correlations among neurons alonewithout a priori knowledge of the represented stimulus space.  #@NEW_LINE#@#  A further difficulty is to detect geometric organization that is invariant under nonlinear monotone transformations of the matrix entries.  #@NEW_LINE#@#  
To our surprise, we found that the ordering of matrix entries encodes geometric features, such as dimension (Fig 2A).  #@NEW_LINE#@#  For larger matrices, the precise dimension may be difficult to discern in the presence of noise.  #@NEW_LINE#@#  Nevertheless, the organization of cliques in the order complex carries signatures of an underlying Euclidean geometry, irrespective of dimension.  #@NEW_LINE#@#  For example, the triangle inequality, xzxy+yz, implies that if two edges of a triangle are present in the order complex at some edge density , there is a higher probability of the third edge also being present.  #@NEW_LINE#@#  Intuitively, this means that cliques in the order complex will be more prominent for geometric compared with random matrices, and cycles will be comparatively short-lived, as cliques cause holes to be more readily filled in (13).  #@NEW_LINE#@#  
To see whether clique topology can provide reliable signatures of geometric organization, we computed Betti curves for distributions of geometric matrices (N=88), generated from random points uniformly sampled from unit cubes of dimensions d=5,10,16,24, and 88, and having entries that decrease with distance (Materials and Methods).  #@NEW_LINE#@#  We then computed average Betti curves 1(),2(), and 3() for each d, and found that they are stratified by dimension but retain characteristic features that are independent of dimension.  #@NEW_LINE#@#  In particular, the peak values of geometric Betti curves are considerably smaller than those of random symmetric matrices with matching parameters (pless_than0.001), and decrease with increasing m (Fig 2B).  #@NEW_LINE#@#  This pattern remains over the full range of tested dimensions (Fig 2B, Inset).  #@NEW_LINE#@#  We conclude that Betti curves can, in principle, be used to distinguish geometric from random structure.  #@NEW_LINE#@#  

Signatures_of_Intrinsic_Geometric_Structure_in_Neural_Activity  #@NEW_LINE#@#  
Can clique topology be used to detect geometric organization from pairwise correlations in noisy neural data?  #@NEW_LINE#@#  To answer this question, we examined correlations of hippocampal place cells in rodents during spatial navigation in a 2D open field environment.  #@NEW_LINE#@#  In this context, geometric structure is expected due to the existence of spatially localized receptive fields [place fields (1)] but has not previously been detected intrinsically using only the pattern of correlations.  #@NEW_LINE#@#  
We computed correlations from spike trains of simultaneously recorded neurons in area CA1 of dorsal hippocampus (Materials and Methods).  #@NEW_LINE#@#  Each pairwise correlation, Cij, was obtained from the mean of a cross-correlogram on a timescale of max=1 s (SI Appendix, Supplementary Methods, and Fig S3).  #@NEW_LINE#@#  The resulting matrix was then analyzed using clique topology (Fig 3A).  #@NEW_LINE#@#  As expected, the Betti curves from place cell data were in close agreement to those of geometric matrices (Fig 3B, Top), up to a small rightward shift that is likely due to noise (SI Appendix, Fig S4A).  #@NEW_LINE#@#  
Although we found that qualitative geometric structure is robustly detectable, the precise dimension is sensitive to noise and currently difficult to estimate, even for low dimensions.  #@NEW_LINE#@#  For example, a geometric matrix in dimension d=2 exhibits higher-dimensional nonzero Betti curves if a fraction of the neurons have nongeometric correlations with the rest (SI Appendix, Fig S4B).  #@NEW_LINE#@#  A post hoc analysis of the recorded place cells showed that 510% exhibited nonconvex place fields; this alone could account for the higher dimensions we observed.  #@NEW_LINE#@#  On the other hand, Betti curves of d=2 geometric matrices with up to 10% of the neurons having random correlations still lie in the dN geometric regime (SI Appendix, Fig S4B).  #@NEW_LINE#@#  
We next compared the data Betti curves to shuffled controls, obtained by randomly permuting the matrix entries (SI Appendix, Fig S5 A and B).  #@NEW_LINE#@#  Shuffling completely destroys any structure in the order complex, yielding distributions of Betti curves identical to those of random matrices (Fig 1E).  #@NEW_LINE#@#  We found that the Betti curves from place cell data were an order of magnitude smaller than the mean Betti curves of the shuffled matrices, and well outside the 95% confidence intervals (Fig 3B, Bottom).  #@NEW_LINE#@#  To quantify the significance of nonrandom structure, we used integrated Betti values as follows:¯m=01m()d,and verified that they were significantly smaller than those obtained from 1,000 trials of the shuffled controls (P less_than 0.001), but well within the confidence intervals for geometric controls (Fig 3C).  #@NEW_LINE#@#  
To test whether the observed geometric organization was consistent across animals and recording sessions, we repeated these analyses for eight additional datasets from three different animals during spatial navigation (SI Appendix, Fig S6).  #@NEW_LINE#@#  All but one of the nine datasets were consistent with the corresponding geometric controls, suggesting that geometric structure of correlations is a robust phenomenon during spatial navigation.  #@NEW_LINE#@#  We also repeated the analyses for different choices of the correlation timescale, max, ranging from 10 ms to 2 s, and observed similar results (Fig 3D).  #@NEW_LINE#@#  As a further test of geometric organization, we computed the distribution of persistence lifetimes from the order complex of the open field correlation matrix (SI Appendix, Supplementary Text).  #@NEW_LINE#@#  The lifetime measures how long a hole persists as it evolves from one graph to the next in the order complex (Fig 1D).  #@NEW_LINE#@#  Again, the data exhibited topological signatures that were far from random, but consistent with geometric organization (SI Appendix, Fig S7).  #@NEW_LINE#@#  
To ensure that the observed correlation structure could not be explained by the differences in interactions of individual neurons with the mean field activity of the network, we performed an additional random control that preserves row and column sums of pairwise correlation matrices.  #@NEW_LINE#@#  Specifically, we computed Betti curves for matrices drawn from a weighted maximum entropy (WME) distribution, subject to the constraint that expected row sums match the original pairwise correlation matrix (SI Appendix, Fig S5 C and D).  #@NEW_LINE#@#  The Betti curves and persistence lifetimes of the WME controls were similar to those of random symmetric matrices (SI Appendix, Fig S8), showing that the nonrandom structure in the data does not arise from the fact that some neurons have higher levels of correlation with the population as a whole.  #@NEW_LINE#@#  

Scrambled_Place_Fields_Yield_Nongeometric_Correlations  #@NEW_LINE#@#  
Are the spatial coding properties of place cells sufficient to account for the observed geometric organization of correlations during spatial navigation?  #@NEW_LINE#@#  Or, alternatively, does this structure reflect finer features of the correlations, beyond what is expected from place fields alone?  #@NEW_LINE#@#  To address this question, we computed place fields Fi(x) for each place cell from the same data used in Fig 3A, together with the animals 2D spatial trajectory x(t) (SI Appendix, Supplementary Methods).  #@NEW_LINE#@#  We then generated synthetic spike trains for each neuron as inhomogeneous Poisson processes, with rate functions ri(t) given by the simple place field model as follows:ri(t)=Fi(x(t)),[2]where x(t) is the animals actual trajectory (Fig 3E).  #@NEW_LINE#@#  By design, the synthetic spike trains preserved the influence of place fields, but discarded all other features of the data, including precise spike timing and any nonspatial correlates.  #@NEW_LINE#@#  Perhaps unsurprisingly, Betti curves derived from the place field model reproduced all of the signatures of geometric organization (Fig 3E and SI Appendix, Fig S9 B and C), indicating that place fields alone could account for the results observed in the open field data.  #@NEW_LINE#@#  
We next asked whether the geometry of place fields was necessary, or whether the Betti curves during spatial navigation could be attributed to an even more basic feature of the data, which is that each neuron is driven by the same global signal, x(t), filtered by a cell-specific function Fi(x).  #@NEW_LINE#@#  To answer this question, we scrambled each place field by permuting the values of Fi(x) inside pixels of a 100×100 grid, creating nongeometric receptive fields Fi(x) (SI Appendix, Fig S9D; a 10×10 scrambling is shown in Fig 3F for clarity).  #@NEW_LINE#@#  We then generated spike trains from the actual trajectory, as in Eq.  #@NEW_LINE#@#  2, but using the scrambled place fields Fi(x).  #@NEW_LINE#@#  For this model, we found that the second and third Betti curves were far outside of the geometric regime, whereas the first Betti curve 1() was insufficient to rule out geometric organization (Fig 3F and SI Appendix, Fig S9 EH).  #@NEW_LINE#@#  We obtained similar results after scrambling on a 10×10 grid (SI Appendix, Fig S10).  #@NEW_LINE#@#  We conclude that the geometric signatures observed during spatial navigation reflect the geometry of place fields and are not simply a consequence of neurons being driven by the same global signal, x(t).  #@NEW_LINE#@#  Nevertheless, each of the Betti curves for the scrambled place field model was also significantly smaller than those of random controls (Fig 3F; P less_than 0.001), suggesting that neurons controlled by a global signal via nongeometric receptive fields do exhibit nonrandom structure in their pairwise correlations.  #@NEW_LINE#@#  

Evidence_of_Geometric_Organization_During_Nonspatial_Behaviors  #@NEW_LINE#@#  
The above results suggest that geometric structure in place cell correlations is a consequence of position coding and is not necessarily expected during nonspatial behaviors.  #@NEW_LINE#@#  To see whether this is true, we repeated our analyses on neural activity recorded during two nonspatial conditions: wheel running and rapid eye movement (REM) sleep.  #@NEW_LINE#@#  Surprisingly, we found that the Betti curves were again highly nonrandom (SI Appendix, Fig S11), and consistent with geometric organization across all five wheel running recordings and three out of four sleep recordings (Fig 4).  #@NEW_LINE#@#  These findings suggest that geometric organization on a timescale of max1 s is a property of the underlying hippocampal network, and not merely a byproduct of spatially structured inputs.  #@NEW_LINE#@#  At much finer timescales, however, geometric features appear to deteriorate in both REM sleep and wheel-running conditions (SI Appendix, Fig S12), in contrast to the open-field data (SI Appendix, Fig S13).  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
We have developed a novel tool for detecting structural features of symmetric matrices that are invariant under the transformations most commonly observed in neural systems.  #@NEW_LINE#@#  We have shown that this method can reliably detect both geometric and random structure in the presence of an unknown nonlinearity.  #@NEW_LINE#@#  Our approach exploits the little-known fact that the ordering of matrix entries, irrespective of their actual values, carries significant information about the underlying matrix organization.  #@NEW_LINE#@#  Unlike eigenvalues, which can be badly distorted by monotone nonlinearities, the information encoded in the order complex is invariant.  #@NEW_LINE#@#  
Applying techniques from computational topology, relevant features can be extracted from the order complex that enable robust detection of geometric (or random) structure.  #@NEW_LINE#@#  In contrast to previous instances of topological data analysis (1420), our method relies on the statistical properties of cycles, as captured by Betti curves and persistence lifetime distributions, and is used as a generic tool for matrix analysis, rather than the analysis of point cloud data.  #@NEW_LINE#@#  Although the precise dimension associated to geometric data is currently difficult to estimate, this situation should improve once we gain a better understanding of how Betti curves and persistent cycles are distorted by different types of noise.  #@NEW_LINE#@#  
In this work, we have emphasized two extremes: geometric vs. random.  #@NEW_LINE#@#  In many cases, however, correlations may be structured in a nonrandom, but also nongeometric, manner.  #@NEW_LINE#@#  One example of this is the scrambled place field model.  #@NEW_LINE#@#  Here, the existence of a global signal controlling the firing of all neurons introduced nonrandom relationships among the entries of the pairwise correlation matrix, and the Betti curves were able to distinguish this case from both the geometric and random controls.  #@NEW_LINE#@#  It is likely that many kinds of structure leave their fingerprints on the ordering of matrix elements and can thus in principle be detected with our methods.  #@NEW_LINE#@#  
In summary, we found that geometric organization of hippocampal place cell activitya prerequisite for the existence of spatial receptive fieldscan be detected from pairwise correlations alone, without any a priori knowledge about the nature of receptive fields.  #@NEW_LINE#@#  Using simulated data from a model, we confirmed that such geometric structure would be observed as a result of realistic place fields, but would not arise from nongeometric (scrambled) place fields.  #@NEW_LINE#@#  Perhaps surprisingly, we also found geometric organization in correlations during wheel running and REM sleep.  #@NEW_LINE#@#  We suggest that clique topology is a powerful new tool for matrix analysis, and one that is especially useful in biological settings, to detect relevant structure in the presence of unknown nonlinearities.  #@NEW_LINE#@#  

Materials_and_Methods  #@NEW_LINE#@#  
Experimental_Data  #@NEW_LINE#@#  
All procedures were approved by the Janelia Research Campus Institutional Animal Care and Use Committee.  #@NEW_LINE#@#  Spike trains of neurons in area CA1 of rodent hippocampus were recorded during three behavioral conditions: (i) spatial navigation in a familiar, 2D, 1.5 m × 1.5-m square box environment; (ii) wheel running in the context of a delayed alternation task, as described in refs.  #@NEW_LINE#@#  21 and 22; and (iii) REM sleep.  #@NEW_LINE#@#  Experimental procedures have been previously described in refs.  #@NEW_LINE#@#  21 and 23.  #@NEW_LINE#@#  SI Appendix, Supplementary Methods, contains further details related to the data, the computation of pairwise correlations, and the place field (PF) and scrambled PF models.  #@NEW_LINE#@#  

Clique_Topology  #@NEW_LINE#@#  
We performed topological data analysis on pairwise correlation matrices (SI Appendix, Supplementary Methods) as well as random and geometric control matrices (below).  #@NEW_LINE#@#  Here, we describe the general procedure; for more detailed explanations, see SI Appendix, Supplementary Text.  #@NEW_LINE#@#  

Random_and_Geometric_Matrices  #@NEW_LINE#@#  
For each symmetric matrix C we considered three types of controls: shuffled (or random) control matrices, WME control matrices, and geometric matrices.  #@NEW_LINE#@#  Shuffled matrices were created by randomly permuting the (N2) off-diagonal elements of C. Because only the ordering of matrix elements is considered in the subsequent topological analyses, this is equivalent to considering random symmetric matrices with i.i.d.  #@NEW_LINE#@#  entries, whose corresponding order complex is a sequence of nested ErdsRényi random graphs.  #@NEW_LINE#@#  WME matrices were obtained by sampling the maximum entropy distribution on weighted graphs with constrained mean degree sequence induced by C. This distribution was previously described in ref.  #@NEW_LINE#@#  24 (SI Appendix, Fig S5).  #@NEW_LINE#@#  
Geometric matrices were obtained by sampling a set of N i.i.d.  #@NEW_LINE#@#  points uniformly distributed in the d-dimensional unit cube [0,1]dd, for dN.  #@NEW_LINE#@#  The matrix entries were then given by Cij=pipj, where the minus sign ensures that they monotonically decrease with distance, as expected for geometrically organized correlations.  #@NEW_LINE#@#  

Order_Complex  #@NEW_LINE#@#  
For any N×N symmetric matrix A with distinct entries, the order complex ord(A) is a sequence of graphs:G0G1···G(N2),  #@NEW_LINE#@#  
where G0 is the graph having N vertices and no edges, G1 has a single edge (ij) corresponding to the highest off-diagonal matrix value Aij, and each subsequent graph has an additional edge for the next-highest off-diagonal matrix entry.  #@NEW_LINE#@#  The graphs {Gk} can also be indexed by the edge density, =k/(N2)[0,1], where k is the number of edges in the graph Gk.  #@NEW_LINE#@#  

Betti_Curves  #@NEW_LINE#@#  
A clique in a graph is an all-to-all connected set of vertices.  #@NEW_LINE#@#  For each graph G in the order complex ord(A), we compute simplicial homology groups Hm(X(G),2) for m=1,2, and 3, where X(G) is the clique complex of G. We call this the clique topology of G, to distinguish it from the usual graph topology.  #@NEW_LINE#@#  The dimensions of the homology groups Hm(X(G),2), yield the Betti numbers m. Indexing the graphs by edge density , we organize the Betti numbers across all graphs in the order complex into Betti curves 1(),2(), and 3().  #@NEW_LINE#@#  The Betti curves provide a summary of the topological features of the matrix A.  #@NEW_LINE#@#  

Computations  #@NEW_LINE#@#  
All software for computing clique topology is freely available in our Matlab package CliqueTop (26).  #@NEW_LINE#@#  To compute Betti curves for a matrix A, we begin by finding all maximal cliques of up to five vertices (those are needed to compute 3) for each graph G, with 0.6.  #@NEW_LINE#@#  The resulting lists are then input into Perseus, a computational topology software package implemented by Vidit Nanda (27); this software builds on work by Mischaikow and Nanda (28) using discrete Morse theory to reduce the sizes of simplicial complexes before performing persistent homology computations.  #@NEW_LINE#@#  

Integrated_Betti_Values  #@NEW_LINE#@#  
To facilitate the comparison of Betti curves to control matrices, we integrate the Betti curves with respect to graph density: ¯m=01m()d. The values ¯1, ¯2, and ¯3 were computed for each dataset.  #@NEW_LINE#@#  For distributions of shuffled and geometric control Betti curves, the resulting integrated Betti values are summarized in box-and-whisker plots.  #@NEW_LINE#@#  We used standard box plots in Matlab, with bottom, middle, and top horizontal lines on the boxes denoting first quartile (Q1, 25th percentile), median (50th percentile), and third quartile (Q3, 75th percentile) boundaries in the distributions of integrated Betti values; whereas the bottom and top whiskers denote Q11.5(Q3Q1) and Q3+1.5(Q3Q1), respectively.  #@NEW_LINE#@#  

Significance_Threshold  #@NEW_LINE#@#  
Our threshold for rejecting the geometric hypothesis for a given integrated Betti value was obtained from the box-and-whisker plot for a distribution of 100 geometric matrices with matching N and dimension d=N.  #@NEW_LINE#@#  Specifically, we used the top whisker value, Q3+1.5(Q3Q1), as the significance threshold.  #@NEW_LINE#@#  The bottom whisker was not used, as Betti values lower than this are consistent with geometric matrices with smaller dimension d. In a normal distribution, 99.3% of the data lie within the whiskers, so that less than 0.4% of data points lie above the top whisker.  #@NEW_LINE#@#  Our integrated Betti values ¯m for geometric controls, however, are not normally distributed.  #@NEW_LINE#@#  In the case of ¯1 and ¯2, the top whisker corresponds, on average, to the 98th percentile of the distribution.  #@NEW_LINE#@#  In the case of ¯3, the top whisker is just under the 97th percentile value.  #@NEW_LINE#@#  A data point above the top whisker is thus inconsistent with geometric controls with P less_than 0.05.  #@NEW_LINE#@#  For comparisons against shuffled/random control distributions, we computed the P value directly from the distribution, as in these cases we built the distributions from 1,000 trials, rather than just 100.  #@NEW_LINE#@#  Note that clique topology computations are much faster for matrices with random structure than for geometric matrices, because of differences in the statistics of the cliques.  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
The authors would like to thank Dima Burago and Anton Petrunin for suggesting a simple proof for the d3 example in Fig 2A.  #@NEW_LINE#@#  We thank the Holland Computing Center (University of NebraskaLincoln) and the Institute for Mathematics and its Applications (University of Minnesota) for providing resources that supported this work.  #@NEW_LINE#@#  This work was supported by National Science Foundation Grants DMS 1122519 (to V.I.)  #@NEW_LINE#@#  and DMS 1225666/1537228 (to C.C.  #@NEW_LINE#@#  ), a Sloan Research Fellowship (to C.C.  #@NEW_LINE#@#  ), Defense Advanced Research Projects Agency Young Faculty Award W911NF-15-1-0084 (to V.I.  #@NEW_LINE#@#  ), and the Howard Hughes Medical Institute (E.P.  #@NEW_LINE#@#  ).  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  



