article id="http://dx.doi.org/10.1073/pnas.1513417112"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
The structure of tropical forests and sphere packings  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
Explaining the tree size structure of tropical forests is of crucial importance because other important forest attributes can be derived from this.  #@NEW_LINE#@#  The tree diameter distribution, for example, determines the amount of carbon stored in a forest.  #@NEW_LINE#@#  Here we present a simple and powerful approach based on stochastic geometry and tree allometries that can be used to predict tree diameter distributions.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
The search for simple principles underlying the complex architecture of ecological communities such as forests still challenges ecological theorists.  #@NEW_LINE#@#  We use tree diameter distributionsfundamental for deriving other forest attributesto describe the structure of tropical forests.  #@NEW_LINE#@#  Here we argue that tree diameter distributions of natural tropical forests can be explained by stochastic packing of tree crowns representing a forest crown packing system: a method usually used in physics or chemistry.  #@NEW_LINE#@#  We demonstrate that tree diameter distributions emerge accurately from a surprisingly simple set of principles that include site-specific tree allometries, random placement of trees, competition for space, and mortality.  #@NEW_LINE#@#  The simple static model also successfully predicted the canopy structure, revealing that most trees in our two studied forests grow up to 3050 m in height and that the highest packing density of about 60% is reached between the 25- and 40-m height layer.  #@NEW_LINE#@#  Our approach is an important step toward identifying a minimal set of processes responsible for generating the spatial structure of tropical forests.  #@NEW_LINE#@#  

Representations of a tropical forest on BCI as a sphere packing system.  #@NEW_LINE#@#  Comparison of the sphere packing systems predicted by the model (A and B) and derived from the field data (C and D).  #@NEW_LINE#@#  We show 1-ha plots (A and C) and corresponding 100 × 10-m plot-transects (B and D) through the simulated and observed BCI forest.  #@NEW_LINE#@#  The higher canopy is only sparsely filled with tree crowns (B and D).  #@NEW_LINE#@#  
Comparison of the modeled geometry of trees in different static and dynamic models.  #@NEW_LINE#@#  (A) Our approach of a packing of tree crowns in forests.  #@NEW_LINE#@#  (B) Macroecological models (27) that assume equal space filling (and resource use) across growth classes.  #@NEW_LINE#@#  (C) The perfect plasticity approximation including phototropism where tree crowns can shape differently and aside from their stem location (20, 24).  #@NEW_LINE#@#  (D) Thinning in crowded stands as simulated in dynamic forest gap models (11).  #@NEW_LINE#@#  
Sensitivity of the chosen height discretization (A and B) for the leaf area distribution on BCI (50 ha).  #@NEW_LINE#@#  (A) Logarithmic binning with exponentially increasing height class widths.  #@NEW_LINE#@#  (B) Linear binning with constant height class widths of 1 m. (C) Sensitivity concerning crown geometry, i.e., a comparison of the original spherical crown and a cylindrical crown is shown.  #@NEW_LINE#@#  (D) Sensitivity of leaf area distribution dependent on the assumed individual trees leaf area within its crown (leaf area homogenous in full sphere vs. upper semisphere).  #@NEW_LINE#@#  
Sensitivity of regional leaf area and tree diameter distribution concerning tree sizes.  #@NEW_LINE#@#  (A) Minimum (i.e., hmin) and (B) maximum tree height (i.e., hmax) are varied for BCI (50 ha).  #@NEW_LINE#@#  Simulation results show a single run of the forest packing model.  #@NEW_LINE#@#  
Analysis of structural attributes for the BCI forest (based on inventory data).  #@NEW_LINE#@#  (A) Frequency distribution of the local crown packing density  (in %) where  is the proportion of space occupied by tree crowns (analysis of 20 × 20-m subplots, n = 1,250; using 2% class widths).  #@NEW_LINE#@#  (B) Frequency distribution of local forest height (in % of assumed maximum tree height) estimated for 20 × 20-m subplots (using 4% class widths).  #@NEW_LINE#@#  Green solid vertical lines represent mean values.  #@NEW_LINE#@#  (C) The average local packing density (dots) and SD (gray horizontal lines), estimated for different height layers (20 × 20-m subplots, using 1-m layer widths).  #@NEW_LINE#@#  (D) Same as C, but for the estimated leaf area distribution.  #@NEW_LINE#@#  (E) Leaf area distribution at different heights (using 1-m layer widths) estimated for the entire 50-ha forest.  #@NEW_LINE#@#  
Results  #@NEW_LINE#@#  
On average only 15% of the available space is occupied by tree crowns at BCI (Fig 2A) and 20% at Sinharaja (Fig S4E; analysis of packing density  at the local scale of 0.04 ha for 1,250 subplots at BCI and 625 subplots in Sinharaja).  #@NEW_LINE#@#  Nevertheless, in some plots, we observe higher densities, and in other plots, lower densities (e.g., due to former gaps of large fallen trees).  #@NEW_LINE#@#  For example, in the BCI forest, the crown packing density at the local scale ranges from 3% to 53% (Fig 2A).  #@NEW_LINE#@#  The local packing densities are much smaller than the optimized regular packing of monosized spheres and below its irregular counterparts, which are known from stochastic geometry theory (see below) (14).  #@NEW_LINE#@#  Clearly, this is because tree crowns can only be located in their associated height layer and because we assumed a maximum tree height of 60 m, which is rarely attained (Figs.  #@NEW_LINE#@#  1 and 2B).  #@NEW_LINE#@#  A reduced maximum tree height of 45 m would increase the overall packing density for BCI only from 15% to 18%.  #@NEW_LINE#@#  Ecologically more meaningful measures are therefore the crown packing density across different height layers (Fig 2C) and the associated distribution of leaf area density (Fig 2D).  #@NEW_LINE#@#  Essentially, we find a unimodal local crown packing distribution (Fig 2C).  #@NEW_LINE#@#  
The densest layer in the BCI forest is reached at a height of about 25 m (40% of forest height) and yields a local mean leaf area density of lmax = 0.6 m2/m3 (Fig 2D, Fig S5 G and H, and Table S1).  #@NEW_LINE#@#  Interestingly, the densest height layer is close to maximal stochastic packing densities (i.e., 60%; jammed packing), for which the filled space ranges from random loose (55%) to random close (64%) sphere packings (14).  #@NEW_LINE#@#  Note that lmax and the corresponding height also vary locally (Fig S5 G and H).  #@NEW_LINE#@#  We obtained similar results for the Sinharaja forest (Figs.  #@NEW_LINE#@#  S4 G and H and S6B and Table S1).  #@NEW_LINE#@#  The packing density and leaf area distributions were unimodal at the Sinharaja forest (Fig 3E), but that of BCI showed a small additional peak at about 17% (11 m) of forest height (Fig 2D and Fig S5H).  #@NEW_LINE#@#  We suspect that this is caused either by differences in soil quality or by former treefall gaps at the BCI forest.  #@NEW_LINE#@#  On a larger scale, the leaf area distribution is increasingly influenced by topography.  #@NEW_LINE#@#  We suspect that the small additional peaks in Fig 2E are caused by the specific tree allometries for the BCI forest producing a relatively high number of mid- to large-size trees, which then allow only much smaller trees to be placed below (Fig 1).  #@NEW_LINE#@#  
The forest packing model without mortality (i.e., m = 0) substantially overestimated the leaf area density at larger heights and the number of large trees (Fig 3 A and B and Table S2) and can therefore be ruled out.  #@NEW_LINE#@#  In Sinharaja, this overestimation also holds but to a much lesser extent (Fig S7 and Table S2).  #@NEW_LINE#@#  However, the model using the observed mean mortality and growth rates successfully reproduced the observed size structures of the tropical forest in BCI (Fig 3D), the leaf area distribution (Fig 3C), and the local scale variation of the packing density (0.04 ha; Fig 4A and Table S1).  #@NEW_LINE#@#  We found at BCI slight differences in maximum leaf area density (Fig S5G) and in the densest height layer at which this maximum is reached (Fig S5H).  #@NEW_LINE#@#  This difference could be caused by canopy gaps in the data due to fallen larger trees, which are not considered in the model.  #@NEW_LINE#@#  The results for the Sinharaja forest are similar (Figs.  #@NEW_LINE#@#  3 E and F and 4B, Fig S4 G and H, and Table S1), but here our model slightly underestimates leaf area density at heights below 20% of forest height (Fig 3E), and the observed local packing density at 20 × 20-m subplots is somewhat wider than the model prediction (Fig 4B).  #@NEW_LINE#@#  We suspect that the mismatch for the Sinharaja data (especially for the local packing density; Fig 4B) was caused by our assumed tree allometries, which are only approximations.  #@NEW_LINE#@#  Finally, the posterior tree diameter distributions emerging from our simulation (Fig 3 D and F) are largely different from the prior p(d) used to propose tentative trees in the sphere packing algorithm (rule 2).  #@NEW_LINE#@#  This difference outlines the importance of the additional rule 5 of stochastic geometry to selectively accept proposed trees depending on their size.  #@NEW_LINE#@#  

Discussion  #@NEW_LINE#@#  
Our tree crown packing simulations showed that simple principles of stochastic geometry combined with site-specific tree allometries and tree mortality are sufficient for accurately predicting important attributes of tropical forests such as tree diameter distribution and leaf area distribution (Fig 3).  #@NEW_LINE#@#  Our static model is built around four major structural constraints of spatial architecture and dynamics of forests.  #@NEW_LINE#@#  First, the allometric relationships (rule 3) incorporate the essence of tree geometry found at each site that reflects local environmental conditions (16, 17) and physical constraints on canopies (21, 22).  #@NEW_LINE#@#  Second, rule 2 considers average tree growth and mortality of trees in the most basic way and therefore incorporates the essence of tree dynamics like recruitment, growth, and mortality.  #@NEW_LINE#@#  Third, rule 5 that prohibits overlap of crowns captures the essence of spatial tree competition in a structural way.  #@NEW_LINE#@#  Finally, random placement of trees (rule 4) introduces the important element of stochasticity that prevents the two tropical forests from being optimally packed.  #@NEW_LINE#@#  Notably, the interplay of these four structural constraints of spatial architecture generates the observed tree diameter distributions.  #@NEW_LINE#@#  Changes in tree geometry and mortality reflect the uniqueness of this interplay (Figs.  #@NEW_LINE#@#  S3, S8, and S9).  #@NEW_LINE#@#  We did here a first step in presenting a novel and simple hypothesis for explaining tree diameter distributions.  #@NEW_LINE#@#  Application of our approach to more forest sites will show if the simple mechanisms proposed here need to be modified and if additional rules are required.  #@NEW_LINE#@#  
Application of stochastic packing theory opens an inspiring new perspective on the architecture of space filling in forests, but this approach is embedded within a long tradition of modeling studies on forest dynamics and self-thinning.  #@NEW_LINE#@#  For example, the classical 3/2 power rule of self-thinning for even-aged forest stands has also been derived from simple geometric models of space filling together with tree allometries relating diameter to average height, average mass, or average crown radius (23).  #@NEW_LINE#@#  Forest simulation models also make assumptions about the geometry and space filling in forests.  #@NEW_LINE#@#  For example, several forest models include thinning of the forest in crowded stands (11).  #@NEW_LINE#@#  Other studies noted crown plasticity with different crown shapes of canopy trees, which are not anymore positioned above their stem location as trees grew toward light gaps in the forest canopy (20, 24) (Fig S1C).  #@NEW_LINE#@#  Surprisingly, our study suggests that competition for light does not play a direct role in shaping tree diameter distributions, although this is also a central component of models designed to describe the dynamics of vegetation (25, 26).  #@NEW_LINE#@#  However, rule 5, which does not allow for overlap among tree crowns, and rule 2, which includes mortality effects, can be reinterpreted as considering indirect light effects on tree survival (Fig 1 B and D).  #@NEW_LINE#@#  
Although irregular sphere packing models in physics maximize the packing density by rejecting objects (in case of overlapping with existing ones), the forest crown packing observed is a static view of forests where trees continuously die and grow.  #@NEW_LINE#@#  This approach leads to nonoptimal packing where often somewhat taller trees would fit below a large tree (Fig 1B).  #@NEW_LINE#@#  Our sphere packing model is static.  #@NEW_LINE#@#  However, stochastic placement together with competition for space (rule 5) captures the outcome of this well because a newly placed tree will in general not have the optimal size that could be squeezed in but will be smaller (Fig 1B).  #@NEW_LINE#@#  The effects of mortality and retarded regrowth are reflected in the packing density across height (Fig 2C) and in the leaf area distribution (Fig 2 D and E), which contrasts to approaches that assume equal space filling across tree size classes (27) (Fig S1).  #@NEW_LINE#@#  However, our model cannot describe effects of the mortality of large trees that create canopy gaps that are then colonized by small trees.  #@NEW_LINE#@#  Fig 4A shows that this leads only to a slight underestimation of 20 × 20-m subplots at BCI with low packing density.  #@NEW_LINE#@#  
Our tree allometries include the geometric constraint that trees of a given size can only be filled into a given height layer and that large tree crowns cannot occur near the forest floor.  #@NEW_LINE#@#  This geometric constraint explains partly the low crown packing density of the two analyzed forests compared with physical packing systems.  #@NEW_LINE#@#  Additionally, more than half of the nonoccupied space (57%) is found above 30-m height on BCI.  #@NEW_LINE#@#  This large proportion is because the majority of trees in the forests, whether simulated by our packing model or derived from inventory data, are much smaller than our assumed maximum tree height (of 60 m; Fig 2B) and only a small number of emergent trees exceed heights of 3050 m (1, 28).  #@NEW_LINE#@#  This finding also contributes to the old debate on stratifications and layers in tropical forests (29, 30).  #@NEW_LINE#@#  
Our findings provide important insights into the heterogeneous structure of forests that might be useful also for remote sensing of forests (28, 31).  #@NEW_LINE#@#  Lidar scanning technologies send beams through the canopy and measure the forest structure (e.g., leaf and branch density as the emitted beams interact with them) (32).  #@NEW_LINE#@#  Hereby, the density of signals returned at a specific height may be comparable to the observed pattern of leaf area density across height (31).  #@NEW_LINE#@#  Knowledge on the heterogeneous crown structure of forests derived from this study can potentially enhance the interpretation of such remote sensing measurements.  #@NEW_LINE#@#  

Methods  #@NEW_LINE#@#  
Study_Areas  #@NEW_LINE#@#  
For this study, we use forest inventory data on two tropical forests: one in Panama (BCI; 50 ha) (3335) and one in Sri Lanka (Sinharaja; 25 ha) (36).  #@NEW_LINE#@#  The plot on BCI is located within the Panama Canal and represents a lowland tropical forest with an annual rainfall of 2,570 mm (1).  #@NEW_LINE#@#  The plot in Sinharaja is located in Sri Lanka and constitutes an everwet lowland forest with an annual rainfall of 5,016 mm on average (1, 36).  #@NEW_LINE#@#  
The 50-ha plot on BCI hosts 230,000 trees at least 1 cm in diameter at breast height, belonging to more than 300 species (1).  #@NEW_LINE#@#  The size of the forest plot in Sri Lanka is half that of the forest plot in Panama (i.e., 25 ha), with 180,000 trees and 209 species (1).  #@NEW_LINE#@#  Each tree has been identified to species and tagged, and its location on the forest plot and stem diameter measured.  #@NEW_LINE#@#  For both forest plots, the topography is recorded at discrete 5-m steps.  #@NEW_LINE#@#  

Creating_Crown_Packings_from_Forest_Inventories  #@NEW_LINE#@#  
Forest inventories traditionally include information on stem diameter and species, but are increasingly supplemented by the location of trees (3336).  #@NEW_LINE#@#  In this study, we reconstruct the packing of tree crowns by using data on stem location and stem diameter at breast height.  #@NEW_LINE#@#  Additionally, relationships between stem diameter d (cm) and other tree characteristics [like tree height h (m) or crown radius c (m)] are used (18, 19).  #@NEW_LINE#@#  
We analyzed forest inventories at BCI (census 2010) in Panama and Sinharaja (census 2001) in Sri Lanka.  #@NEW_LINE#@#  For both forests, we exclude tree measurements if (i) the position of a tree is not within the forest area, (ii) the measured stem diameter is missing or zero, or (iii) a tree has been declared dead.  #@NEW_LINE#@#  Stem diameter measurements, which were not taken at breast height (1.30 m above the forest floor), are not corrected (i.e., we assume cylindrical stems for simplification).  #@NEW_LINE#@#  We assume a maximum tree height of 60 m (1).  #@NEW_LINE#@#  The few trees whose height exceeded the assumed maximum height have been excluded (tree height is derived from the stem diameter measurements).  #@NEW_LINE#@#  
As allometric relationships between tree height h(d) (m), as well as crown radius c(d) (m) and stem diameter d (cm), we used for Panama, relationships from the literature [i.e., c(d) = 0.37d0.67 and h(d) = 2.74d0.6] (18).  #@NEW_LINE#@#  Site-specific allometric relationships for tree geometry are not available for the Sinharaja forest.  #@NEW_LINE#@#  We therefore use allometric relationships for the Dipterocarpaceae family [i.e., c(d) = 0.4d0.66 and h(d) = 2.78d0.69] (19).  #@NEW_LINE#@#  This family shows the highest abundance of individuals, number of tree species, and basal area at Sinharaja (1, 36).  #@NEW_LINE#@#  

Parameterization_of_the_Forest_Packing_Model  #@NEW_LINE#@#  
For BCI, tree diameters between dmin = 1 cm (the minimal size in the census) and a maximal dmax = 1.7 m has been considered in the forest packing model (for Sinharaja, we used dmin = 1 cm and dmax = 0.86 m).  #@NEW_LINE#@#  Average tree mortality rates of mBCI = 2.2%/y (for BCI) and mS = 1.3%/y (for Sinharaja) were both determined on the basis of the most recent census data (BCI, 2005 and 2010; Sinharaja, 1996 and 2001).  #@NEW_LINE#@#  To keep the model simple, we assumed constant growth rates typical for tropical forests (37) of 0.5 (BCI) (1) and 0.3 cm/y (Sinharaja) (38).  #@NEW_LINE#@#  

Analysis_Tools_for_Crown_Packed_Forests  #@NEW_LINE#@#  
Based on the crown packing system, either created from forest inventory data or simulated using the forest packing model, we calculated how much space is filled (crown packing density ).  #@NEW_LINE#@#  For this purpose, a cuboid representing the border of the analyzed forest is used.  #@NEW_LINE#@#  This cuboid is defined by the ground area and the maximum possible tree height of 60 m (for both forests; SI Methods).  #@NEW_LINE#@#  
We further divided the forest into distinct height layers to calculate the crown packing density and the leaf area distribution.  #@NEW_LINE#@#  We presumed linear binning (using 1-m layer widths).  #@NEW_LINE#@#  Logarithmic binned height layers are also possible, but our results are independent of the chosen discretization for the height layers (Fig S2 A and B).  #@NEW_LINE#@#  For each height layer, the leaf area of each tree crown part reaching that height layer is summed up and divided by the volume of the specific layer (whereby we assume 1 m2 of leaf area per 1 m3 of tree crown volume).  #@NEW_LINE#@#  

Sensitivity_Analyses  #@NEW_LINE#@#  
We investigated whether the congruence of simulated forests (using the forest packing model) and the observed forest inventories (exemplary for BCI) would change if the assumed input parameters vary: (i) in minimum and maximum tree sizes (Fig S3), (ii) in tree geometry relationships (i.e., allometries; Fig S8), (iii) in the mortality of trees (Fig S9A), and (iv) in the stopping rule of the forest packing model (Fig S9B).  #@NEW_LINE#@#  
Assumptions concerning (i) the crown shape (e.g., spheres or cylinder; Fig S2C) and (ii) the distribution of leaf area within the tree crown (e.g., full sphere vs. upper semisphere; Fig S2D) were additionally examined.  #@NEW_LINE#@#  


SI_Methods  #@NEW_LINE#@#  
Details_on_the_Analysis_Tools_for_Crown_Packed_Forests  #@NEW_LINE#@#  


SI_Results  #@NEW_LINE#@#  
Sensitivity_Analysis  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
We thank especially two anonymous reviewers, R. D. Holt, J.  #@NEW_LINE#@#  Brown, and D. Coomes for their helpful comments.  #@NEW_LINE#@#  We thank N. Gunatilleke and S. Gunatilleke for their support and cooperation concerning the Ecological Research Project at Sinharaja World Heritage Site.  #@NEW_LINE#@#  The 25-ha Long-Term Ecological Research Project at Sinharaja World Heritage Site is a collaborative project of the University of Peradeniya, the Center for Tropical Forest Science of the Smithsonian Tropical Research Institute, and the Arnold Arboretum of Harvard University, with supplementary funding received from the John D. and Catherine T. MacArthur Foundation, the National Institute for Environmental Science, Japan, and the Helmholtz Centre for Environmental Research-UFZ for past censuses.  #@NEW_LINE#@#  The principal investigators of the Research Project at Sinharaja World Heritage Site gratefully acknowledge the Forest Department and the Post-Graduate Institute of Science at the University of Peradeniya for supporting the project, and the local field and laboratory staff who tirelessly contributed in the repeated censuses of the plot.  #@NEW_LINE#@#  The Barro Colorado Island forest dynamics research project was founded by S. P. Hubbell and R. B.  #@NEW_LINE#@#  Foster and is now managed by R. Condit, S. Lao, and R. Perez under the Center for Tropical Forest Science and the Smithsonian Tropical Research in Panama.  #@NEW_LINE#@#  Numerous organizations have provided funding, principally the US National Science Foundation, and hundreds of field workers have contributed.  #@NEW_LINE#@#  A.H., T.W., and F.T.  #@NEW_LINE#@#  were supported by an Advanced Grant of the European Research Council (ERC) (233066) and by the Helmholtz Allianz Remote Sensing and Earth System Dynamics.  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  



