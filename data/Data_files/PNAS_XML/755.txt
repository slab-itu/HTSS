article id="http://dx.doi.org/10.1073/pnas.1704856114"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Simulating tactile signals from the whole hand with millisecond precision  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
When we grasp an object, thousands of tactile nerve fibers become activated and inform us about its physical properties (e.g., shape, size, and texture).  #@NEW_LINE#@#  Although the properties of individual fibers have been described, our understanding of how object information is encoded in populations of fibers remains primitive.  #@NEW_LINE#@#  To fill this gap, we have developed a simulation of tactile fibers that incorporates much of what is known about skin mechanics and tactile nerve fibers.  #@NEW_LINE#@#  We show that simulated fibers match biological ones across a wide range of conditions sampled from the literature.  #@NEW_LINE#@#  We then show how this simulation can reveal previously unknown ways in which populations of nerve fibers cooperate to convey sensory information and discuss the implications for bionic hands.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
When we grasp and manipulate an object, populations of tactile nerve fibers become activated and convey information about the shape, size, and texture of the object and its motion across the skin.  #@NEW_LINE#@#  The response properties of tactile fibers have been extensively characterized in single-unit recordings, yielding important insights into how individual fibers encode tactile information.  #@NEW_LINE#@#  A recurring finding in this extensive body of work is that stimulus information is distributed over many fibers.  #@NEW_LINE#@#  However, our understanding of population-level representations remains primitive.  #@NEW_LINE#@#  To fill this gap, we have developed a model to simulate the responses of all tactile fibers innervating the glabrous skin of the hand to any spatiotemporal stimulus applied to the skin.  #@NEW_LINE#@#  The model first reconstructs the stresses experienced by mechanoreceptors when the skin is deformed and then simulates the spiking response that would be produced in the nerve fiber innervating that receptor.  #@NEW_LINE#@#  By simulating skin deformations across the palmar surface of the hand and tiling it with receptors at their known densities, we reconstruct the responses of entire populations of nerve fibers.  #@NEW_LINE#@#  We show that the simulated responses closely match their measured counterparts, down to the precise timing of the evoked spikes, across a wide variety of experimental conditions sampled from the literature.  #@NEW_LINE#@#  We then conduct three virtual experiments to illustrate how the simulation can provide powerful insights into population coding in touch.  #@NEW_LINE#@#  Finally, we discuss how the model provides a means to establish naturalistic artificial touch in bionic hands.  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
The objective is to simulate the responses of tactile afferents across the glabrous skin of the hand to arbitrary spatiotemporal deformations of the skin.  #@NEW_LINE#@#  To this end, we randomly terminate SA1, RA, and PC afferents over the palmar surface of the hand according to their respective innervation densities, which vary across locations (14) (Fig 1A).  #@NEW_LINE#@#  When a given stimulus is applied passively to the hand, the model estimates the spiking response of those afferents through two sequential stages, mimicking the mechanotransduction process (Methods): a skin mechanics stage and a spike generation stage.  #@NEW_LINE#@#  In the first stage, the stresses resulting from the stimulus are estimated at the receptor location as two distinct components: a quasistatic component caused by the redistribution of pressure applied to the surface of the skin and a dynamic component resulting from the variations of this pressure with time (Fig 1 B and C).  #@NEW_LINE#@#  The quasistatic component confers to tactile fibers response properties resulting from contact mechanics, such as edge enhancement and surround suppression (15, 16).  #@NEW_LINE#@#  The dynamic component propagates through the skin surface as a wave and confers to afferents the ability to respond to vibration at a distance from the contact point (5).  #@NEW_LINE#@#  In the second stage, the resulting stresses are used as inputs to integrate-and-fire (IF) models (Fig 1D)with parameters separately derived for each afferentthat produce as output the spiking responses of individual afferents to the stimulus (Fig 1E).  #@NEW_LINE#@#  Each spiking model comprises up to 13 free parameters (Methods) and is fit to each fiber individually, so that the population simulations incorporate within-class differences in response properties, which play a role in neural coding (17).  #@NEW_LINE#@#  We extensively tested the model architecture to verify that each component and free parameter was required to achieve accurate and precise response predictions and avoid overfitting (Methods).  #@NEW_LINE#@#  
Model_Fitting_and_Validation  #@NEW_LINE#@#  
Three neurophysiological datasets (from ref.  #@NEW_LINE#@#  18) were used to fit and validate the model, each consisting of afferent responses (recorded from rhesus macaques) to a different class of vibrations imposed on the skin: sinusoidal, bandpass noise, and diharmonic vibrations.  #@NEW_LINE#@#  First, responses to sinusoids and bandpass noise, spanning the tangible range of frequencies (11,000 Hz), were used as the training data to find the best fitting parameters for each afferent (Methods).  #@NEW_LINE#@#  The fitted parameters for individual IF models were clustered by afferent class, reflecting differences in the response properties of the different classes (Fig S1).  #@NEW_LINE#@#  Second, responses to diharmonic stimuli (with components spanning a wide range of frequencies), simulated using the previously fitted parameters, were compared with their measured counterparts to validate the models.  #@NEW_LINE#@#  To this end, we compared both the firing rates and precise spike timing of the measured and simulated responses.  #@NEW_LINE#@#  In total, four SA1, nine RA, and four PC provided sufficiently complete and reliable training and validation data to be used as a basis for model fitting.  #@NEW_LINE#@#  

Response_Properties_Captured_by_the_Model  #@NEW_LINE#@#  
In the following section, we systematically compare simulated afferent responses with published data from the literature across a variety of well-established response properties and examine the extent to which the model, fit to measured responses to vibrations, accounts for afferent responses observed in various other experimental contexts.  #@NEW_LINE#@#  Although some response properties are built into the modelsuch as edge enhancement, which falls out of the mechanics modeland others are specifically targeted in the fitting processsuch as phase-locking to sinusoidal stimuliwe also test a number of properties that are not explicitly built in.  #@NEW_LINE#@#  These properties include receptive field (RF) size, response to ramp-and-hold stimuli, and responses to spatial patterns (such as letters or dots) scanned across the skin.  #@NEW_LINE#@#  The extent to which the model captures these properties is indicative of how well it captures the underlying mechanisms and thereby, generalizes to new stimulus spaces.  #@NEW_LINE#@#  

Insights_from_Simulated_Populations  #@NEW_LINE#@#  
As summarized above, simulated tactile fibers exhibit many response properties that have been documented over the last half-century (we did not test them all).  #@NEW_LINE#@#  Indeed, the match between simulated and measured responses is nearly perfect, down to millisecond spike timing.  #@NEW_LINE#@#  Next, we wished to simulate entire populations of afferents and examine their responses to a few classes of stimuli.  #@NEW_LINE#@#  Indeed, unlike electrophysiological experiments, which are limited to recording from a single mechanoreceptive fiber or tiny fractions of all fibers at a time, this stimulation allows for detailed view of the entirety of the sensory signals that the hand sends the brain.  #@NEW_LINE#@#  In the model, the palmar surface of the hand is innervated by around 12,500 afferents with measured densities that depend on location and afferent type.  #@NEW_LINE#@#  Overall, SA1 fibers outnumber PC fibers by a factor of two, and RA fibers, in turn, outnumber SA1 fibers by a factor of two.  #@NEW_LINE#@#  Furthermore, each fingertip contains just under 1,000 fibers, whereas the much more expansive palm contains only 4,000 in total.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
Limitations_of_the_Model  #@NEW_LINE#@#  
Although the model faithfully reproduces key response properties of tactile afferents, it is also subject to a number of limitations.  #@NEW_LINE#@#  First, we are able to simulate SA1, RA, and PC but not slowly adapting type II (SA2) fibers.  #@NEW_LINE#@#  Indeed, the models are based on electrophysiological data obtained from rhesus macaques, which are devoid of SA2 afferents (43).  #@NEW_LINE#@#  
Second, the models were derived from responses to stimuli that were indented into the skin and therefore, do not incorporate lateral sliding and the concomitant shear forces.  #@NEW_LINE#@#  Rather, scanning is mimicked by moving an image of the indentation pattern across the skin frame by frame.  #@NEW_LINE#@#  Note, however, that tangential forces are often highly correlated with normal ones during sliding (44), and therefore, this approximation is sufficient under most circumstances.  #@NEW_LINE#@#  The model also does not incorporate the effect of fingerprints on texture responses (7) or the onset of slip (45).  #@NEW_LINE#@#  Tangential sliding and its onset are governed by the friction between the skin and object surface, which is a complex mechanical problem that is not yet fully understood (46).  #@NEW_LINE#@#  As our understanding of how tangential forces shape afferent responses improves, this aspect can be incorporated into the model.  #@NEW_LINE#@#  
Third, the skin mechanics model treats the skin as a flat surface, when in reality, it is not.  #@NEW_LINE#@#  The 3D shape of the skin matters during large deformations of the fingertip.  #@NEW_LINE#@#  For example, pressing the fingerpad on a flat surface causes the skin on the side of the fingertip to bulge out, which in turn, causes receptors located there to respond (47, 48).  #@NEW_LINE#@#  Such complicated mechanical effects can be replicated using finite element mechanical models (49) but not using the continuum mechanics (CM) model adopted here.  #@NEW_LINE#@#  To the extent that friction is a critical feature of a stimulusfor example, when sliding a finger across a smooth, sticky surfaceor that the finger geometry plays a critical role in the interaction between skin and stimulusas in the example of high-force loading described abovethe accuracy is compromised.  #@NEW_LINE#@#  Under most circumstances, the model will capture the essential elements of the nerves response.  #@NEW_LINE#@#  
Fourth, SA1 and RA afferents have been shown to exhibit complex RFs with multiple hotspots (24, 50), because single afferents innervate multiple mechanoreceptors (43, 51).  #@NEW_LINE#@#  Afferent branching is not currently implemented in the model; rather, RFs comprise a single hotspot and are isotropic.  #@NEW_LINE#@#  However, the model can be readily elaborated to accommodate afferent branching, particularly when we better understand the mechanisms by which input from the various mechanoreceptors is integrated to drive the afferent response (52).  #@NEW_LINE#@#  

Applications  #@NEW_LINE#@#  
The proposed model can be a powerful tool to investigate the sense of touch.  #@NEW_LINE#@#  Indeed, recording the responses of human or monkey afferents is technically challenging and only yields responses from a single fiber at a time.  #@NEW_LINE#@#  Even multielectrode arrays only yield responses from a sparse sample of afferents (53) or the aggregate activity of a large number of fibers (54, 55).  #@NEW_LINE#@#  The model allows us to simulate the responses of entire populations of afferents to arbitrarily complex stimuli.  #@NEW_LINE#@#  These simulated responses can be used to (i) test peripheral neural codes (as illustrated above with the two simulated experiments), (ii) assess the degree to which the results from psychophysical experiments can be accounted for based on population response (56), and (ii) investigate how sensory representations are transformed as one ascends the somatosensory neuraxis (cf.  #@NEW_LINE#@#  ref.  #@NEW_LINE#@#  57).  #@NEW_LINE#@#  
Also, the model will be valuable in neuroprosthetic applications that aim to restore the sense of touch through peripheral nerve interfaces (5860).  #@NEW_LINE#@#  Indeed, the output of sensors on the prosthesis during object contact can be used as input to the simulated afferents, which then provide an accurate representation of how the nerve from an intact hand would respond to object contact.  #@NEW_LINE#@#  This biomimetic pattern can then be effected in the residual nerve of an amputee by delivering spatially and temporally patterned stimulation pulse trains designed to evoke the desired nerve activation (11, 12, 17).  #@NEW_LINE#@#  The implementation is computationally efficient and can run in real time (SI Methods).  #@NEW_LINE#@#  In the context of neuroprosthetics, the model can also be used as a benchmark against which to compare simpler encoding algorithms and determine the circumstances under which their behavior diverges from that of nerves in an intact arm.  #@NEW_LINE#@#  


Methods  #@NEW_LINE#@#  
The model of peripheral afferents is structured in two distinct sequential stages to capture the structure of the mechanotransduction process (Fig 1).  #@NEW_LINE#@#  In the first stage, we compute the deformations experienced by individual receptors given a stimulus applied to the surface of the skin.  #@NEW_LINE#@#  In the second stage, we compute based on this receptor deformation the spiking response of the nerve fiber using an IF mechanism.  #@NEW_LINE#@#  
Stimulus  #@NEW_LINE#@#  
A stimulus is defined as the time-varying positions of a set of pins indented into the skin in the direction orthogonal to the skin surface.  #@NEW_LINE#@#  Each pin makes contact with the skin over a circular area of adjustable radius and can move up and down independent of the other pins.  #@NEW_LINE#@#  The location of a pin with respect to where it will touch the hand is fixed over time using a coordinate system centered on the fingertip of the index finger (Fig S6A).  #@NEW_LINE#@#  A stimulus can be defined by a single pin (corresponding to a circular probe indented into the skin) or multiple pins, which together form a shape (say an edge, a letter, or a curved surface).  #@NEW_LINE#@#  Pin indentations are independent of each other and can, therefore, form arbitrary spatiotemporal patterns of indentation.  #@NEW_LINE#@#  

Skin_Mechanics  #@NEW_LINE#@#  
The skin of the fingers and palm is known to have complex, nonlinear mechanics (6163), with properties that vary widely over different spatial and temporal scales (64, 65).  #@NEW_LINE#@#  Modeling the precise skin deformation resulting from a given stimulus requires advanced models (66, 67), measurements of individual skin properties (68), many parameters, and considerable computing power.  #@NEW_LINE#@#  Because we aimed to simulate the responses of whole populations of afferents in quasireal time, we did not attempt to estimate the exact deformation state of the finger but instead, simplified the problem by evaluating mechanical quantities that have been shown to be highly predictive of afferent responses.  #@NEW_LINE#@#  Accordingly, we focused on two quantities that are strongly associated with neural responses but over different frequency ranges: (i) the local vertical stress based on a quasistatic elastic model of the skin, mainly affecting receptor responses at low frequencies (less_than100 Hz) (16) and (ii) dynamic variations in pressure propagated across the skin as surface waves, mainly affecting receptor responses at higher frequencies (5, 6).  #@NEW_LINE#@#  These two quantities are then combined in the spiking model and differentially weighted depending on afferent type.  #@NEW_LINE#@#  For instance, SA1 afferents are most sensitive to statically indented spatial patterns, and therefore, the quasistatic component is strongly weighted in SA1 models.  #@NEW_LINE#@#  Conversely, PC afferents do not respond to static indentations but are extremely sensitive to high-frequency vibrations even far away from the center of their RF; therefore, PC models will feature a strong dynamic component.  #@NEW_LINE#@#  

IF_Model  #@NEW_LINE#@#  
The output of the skin mechanics model at all receptor locations is fed into IF models that generate spiking responses for each afferent.  #@NEW_LINE#@#  We fit the parameters of these models on electrophysiological recordings obtained previously (18).  #@NEW_LINE#@#  These models were similar to earlier ones (57, 70, 71), with some key differences.  #@NEW_LINE#@#  First, rather than simply using skin indentation depth (along with derivatives) as IF model input, we used the static and dynamic pressure as calculated from the skin mechanics model.  #@NEW_LINE#@#  This choice of input allowed us to reproduce response properties driven by skin mechanics, such as edge enhancement and surround suppression (Results), as well as effects caused by the propagation of dynamic pressure waves.  #@NEW_LINE#@#  Second, the models were fit on a wide variety of vibrotactile frequencies, ranging from 1 to 1,000 Hz, in contrast to earlier models, which were fit on much narrower stimulus sets (i.e., either low or high frequencies).  #@NEW_LINE#@#  
Each IF model works as follows (Fig 1D).  #@NEW_LINE#@#  The mechanical input (both quasistatic and dynamic) is passed through a low-pass filter (parameter 1) (Fig 1D) to accommodate the fact that afferents become nonresponsive above a certain (afferent type-specific) stimulation frequency.  #@NEW_LINE#@#  Then, the dynamic component is differentiated to obtain three signals (quasistatic, dynamic, and differentiated dynamic).  #@NEW_LINE#@#  Those three inputs can be interpreted as the three terms of a lumped massspringdamper model, with the quasistatic term being associated with the elastic stress, the dynamic term being associated with the damping, and the differentiated dynamic term being associated with the mass.  #@NEW_LINE#@#  Next, the three signals are split into positive and negative contributions and rectified, yielding six time-varying inputs (Fig 1D), which are each multiplied by a weight (parameters 27) and summed.  #@NEW_LINE#@#  Then, the resulting time-varying trace is passed through a saturating nonlinearity, reflecting the fact that afferents responses saturate at high intensities (parameter 8).  #@NEW_LINE#@#  Next, Gaussian noise is added (parameter 9) to mimic the observed stochasticity in afferent responses, which is particularly evident for perithreshold stimuli (72).  #@NEW_LINE#@#  The resulting trace constitutes the input to a leaky IF model, with membrane potential that decays to zero with a characteristic time constant (parameter 10).  #@NEW_LINE#@#  When the potential hits one, a spike is triggered, the membrane potential is reset, and a postspike inhibitory kernel is added to the potential to build in refractoriness (parameters 11 and 12).  #@NEW_LINE#@#  The kernel consists of two parts: a fast component, which decays completely within 4 ms, and a slow component, which contributes maximally 8 ms after a spike is triggered and decays within 36 ms (a similar model is shown in ref.  #@NEW_LINE#@#  71).  #@NEW_LINE#@#  In all fitted models, the first component was weighted more heavily than the second component, leading to initially strong but lingering weak inhibition after each spike.  #@NEW_LINE#@#  Finally, spikes are shifted in time by a small amount to mimic conduction delays (parameter 13), which are largely determined by where the recording was made (proximal vs. distal).  #@NEW_LINE#@#  An individual IF model, therefore, possesses 13 parameters: the low-pass cutoff frequency, the six weights, the saturation parameter, the noise term, the membrane leak time constant, two parameters to determine postspike inhibition, and the conduction delay.  #@NEW_LINE#@#  Not all parameters were required for all afferent models.  #@NEW_LINE#@#  SA1 models did not include a weight for the derivative of the dynamic pressure, because these afferents do not respond to high frequencies.  #@NEW_LINE#@#  SA1 models also did not include a saturation parameter.  #@NEW_LINE#@#  RA and PC models did not include weights for the static stress component, because these afferent types do not respond to constant indentations.  #@NEW_LINE#@#  Thus, SA1 models used 10 parameters, whereas RA and PC models were fit using 11 parameters each.  #@NEW_LINE#@#  

Fitting_Procedure  #@NEW_LINE#@#  
For model fitting, we used as a cost function the van Rossum spike distance (73), which yielded a measure of difference between the recorded and model-predicted spiking responses at a given temporal resolution (set by a time constant).  #@NEW_LINE#@#  We then optimized the model parameters (apart from the noise term, parameter 9; see below) using the patternsearch function in Matlab (The Mathworks, Inc.) using different starting positions.  #@NEW_LINE#@#  We used a time constant of 50 ms for the computation of the cost for SA1 and RA afferents and 20 ms for PC afferents.  #@NEW_LINE#@#  The parameters were both fit on responses to sinusoidal stimuli and bandpass noise traces (18).  #@NEW_LINE#@#  PC models were fit on all frequencies used in the stimulus set (ranging from 1 to 1,000 Hz).  #@NEW_LINE#@#  SA1 and RA models were only fit on frequencies between 1 and 150 Hz.  #@NEW_LINE#@#  After we had zeroed in on good parameter values, we further optimized the parameters using genetic algorithms (ga in Matlab) until they did not improve further.  #@NEW_LINE#@#  To fit the noise parameter, we first calculated the average spike distance between all pairwise combinations of the five recorded trials for each stimulus in the training data.  #@NEW_LINE#@#  We then adjusted the noise parameter, such that five simulated runs of the model on the same inputs resulted in the same average pairwise spike distance.  #@NEW_LINE#@#  In total, we fit single-afferent models to four SA1, nine RA, and four PC afferents.  #@NEW_LINE#@#  

Model_Architecture_Validation  #@NEW_LINE#@#  
Our goal was to create a model that could recreate most afferent response properties described in the literature but that was simple enough to allow for fast computation.  #@NEW_LINE#@#  Furthermore, we wished to avoid overfitting and ensure that the parameters contributed to prediction accuracy.  #@NEW_LINE#@#  We, therefore, tested a number of simpler models, and we examined which response properties they could successfully recreate and where they failed.  #@NEW_LINE#@#  Additionally, these tests provide insights about which specific afferent response properties are driven by which model component.  #@NEW_LINE#@#  

Spike_Timing  #@NEW_LINE#@#  

Simulated_Experiments  #@NEW_LINE#@#  


SI_Methods  #@NEW_LINE#@#  
LNP_Model  #@NEW_LINE#@#  
To test whether an IF mechanism was required to reproduce afferent responses, we implemented LNP models and compared them with the full model.  #@NEW_LINE#@#  The six components from the IF model (rectified quasistatic, dynamic, and dynamic derivative) served as inputs to these models.  #@NEW_LINE#@#  The same procedure was followed as that described for the IF model (in the text): models were fitted on two datasets (sines plus noise) and then tested on a third (diharmonic).  #@NEW_LINE#@#  We used a standard sequential method to fit the models.  #@NEW_LINE#@#  First, a set of six linear filters was obtained using the spike-triggered average computed over a 25-ms window.  #@NEW_LINE#@#  Second, the linear estimate obtained by filtering and summing six components was passed through a nonlinearity to best fit the actual firing rate (obtained by convolving the spike trains with a 40-ms Gaussian kernel).  #@NEW_LINE#@#  We found that a nonlinearity of the form axbc (with  denoting rectification) gave the best results.  #@NEW_LINE#@#  Third, Poisson spikes were generated and then binned at 5 kHz.  #@NEW_LINE#@#  We used the same metric space analysis as described in Methods to compare the distance between the measured spike trains and the simulated spike train (IF or LNP) at different timescales ranging from 0.1 ms to 1 s. The results are shown in Fig S7 A and B.  #@NEW_LINE#@#  

Validation_of_Individual_IF_Parameters  #@NEW_LINE#@#  
To avoid overfitting and ensure robust parameter estimates, we verified that individual IF model parametersspecifically, the low-pass cutoff (parameter 1), the saturation level (parameter 8), the time constant/decay (parameter 10), and the postspike inhibition (parameters 11 and 12)were necessary to improve model accuracy.  #@NEW_LINE#@#  We removed or clamped individual parameters and then refit the IF models.  #@NEW_LINE#@#  For this analysis, we focused on PC afferents, because these fibers have the widest frequency sensitivity.  #@NEW_LINE#@#  The results are shown in Fig S7 CE.  #@NEW_LINE#@#  

Benchmarks  #@NEW_LINE#@#  
The model is computationally efficient enough that a simplified version can be run in real time.  #@NEW_LINE#@#  Fast runtime is especially important in neuroprosthetic applications, where tactile feedback from a sensorized prosthetic hand would need to be converted into realistic spike trains in quasireal time to be useful to the user.  #@NEW_LINE#@#  How many pins (defining the complexity of the stimulus) and how many afferents (defining the complexity of the feedback) the model can support in real time depends on the chosen sampling rate for the afferent models.  #@NEW_LINE#@#  On an Intel i5 quad core running at 3.50 GHz using Matlab 2015b, the model runs in real time with 30 pins and 30 receptors at a sampling rate of 10 kHz, 100 pins and 100 receptors at a sampling rate of 3 kHz, and 300 pins and 300 receptors at a rate of 300 Hz.  #@NEW_LINE#@#  The model can thus support hundreds of pins and receptors at relatively high temporal resolution in real time.  #@NEW_LINE#@#  

Stresses_at_the_Receptor_Caused_by_a_Circular_Probe  #@NEW_LINE#@#  
This section adapts equations from ref.  #@NEW_LINE#@#  69.  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
We thank Ezra Zigmund for programing help on an earlier version of the model.  #@NEW_LINE#@#  This work was supported by National Science Foundation Grant IOS 1150209 and the Kimberly Clark Corporation.  #@NEW_LINE#@#  B.C.R.  #@NEW_LINE#@#  was supported, in part, by the Conte Center for Computational Neuropsychiatric Genomics (NIH Grant P50MH94267) and the Chicago Biomedical Consortium (L004).  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  




