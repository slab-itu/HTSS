article id="http://dx.doi.org/10.1073/pnas.1619993114"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
A null model for microbial diversification  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
When evolutionary histories of closely related microorganisms are reconstructed, the lineages often cluster into visibly recognizable groups.  #@NEW_LINE#@#  However, we do not know if these clusters represent fundamental units of bacterial diversity, such as species, nor do we know the nature of evolutionary and ecological forces that are responsible for cluster formation.  #@NEW_LINE#@#  Addressing these questions is crucial, both for describing biodiversity and for rapid and unambiguous identification of microorganisms, including pathogens.  #@NEW_LINE#@#  Multiple competing scenarios of ecological diversification have been previously proposed.  #@NEW_LINE#@#  Here we show that simple cell death and division over time could also explain the observed clustering.  #@NEW_LINE#@#  We argue that testing for the signatures of such neutral patterns should be considered a null hypothesis in any microbial classification analysis.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Whether prokaryotes (Bacteria and Archaea) are naturally organized into phenotypically and genetically cohesive units comparable to animal or plant species remains contested, frustrating attempts to estimate how many such units there might be, or to identify the ecological roles they play.  #@NEW_LINE#@#  Analyses of gene sequences in various closely related prokaryotic groups reveal that sequence diversity is typically organized into distinct clusters, and processes such as periodic selection and extensive recombination are understood to be drivers of cluster formation (speciation).  #@NEW_LINE#@#  However, observed patterns are rarely compared with those obtainable with simple null models of diversification under stochastic lineage birth and death and random genetic drift.  #@NEW_LINE#@#  Via a combination of simulations and analyses of core and phylogenetic marker genes, we show that patterns of diversity for the genera Escherichia, Neisseria, and Borrelia are generally indistinguishable from patterns arising under a null model.  #@NEW_LINE#@#  We suggest that caution should thus be taken in interpreting observed clustering as a result of selective evolutionary forces.  #@NEW_LINE#@#  Unknown forces do, however, appear to play a role in Helicobacter pylori, and some individual genes in all groups fail to conform to the null model.  #@NEW_LINE#@#  Taken together, we recommend the presented birthdeath model as a null hypothesis in prokaryotic speciation studies.  #@NEW_LINE#@#  It is only when the real data are statistically different from the expectations under the null model that some speciation process should be invoked.  #@NEW_LINE#@#  

Results_and_Discussion  #@NEW_LINE#@#  
A_Null_Model_of_Microbial_Diversification  #@NEW_LINE#@#  
As a null model, we propose a diversification scenario in which a bacterial group does not experience evolutionary and ecological forces that either purge or promote diversity.  #@NEW_LINE#@#  Under the proposed model, the genealogy of diversifying bacterial populations (hereafter referred to as lineages) is influenced only by a random process of extinction (death) or divergence into two new lineages (birth).  #@NEW_LINE#@#  The net birthdeath rate is constant, and recombination is absent.  #@NEW_LINE#@#  Additionally, the DNA sequences of the genomes of these lineages are assumed to accumulate substitutions at a constant rate.  #@NEW_LINE#@#  In population genetics terminology, the genes within the genomes of the simulated lineages experience only genetic drift.  #@NEW_LINE#@#  To simulate evolution of such gene families, we implemented a two-step procedure (Methods for detailed description).  #@NEW_LINE#@#  First, the evolutionary history (genealogy) of a gene family was simulated under the stochastic lineage birthdeath model until all extant lineages could be traced back to one common ancestor.  #@NEW_LINE#@#  This resulted in a phylogenetic tree relating the extant lineages that contain the gene.  #@NEW_LINE#@#  Second, the DNA sequences of the gene in these extant lineages were established by evolving the DNA sequence of the common ancestor along the obtained genealogy under one of the simplest nucleotide substitution models [the F81 substitution model (19)].  #@NEW_LINE#@#  The F81 model does not distinguish synonymous and nonsynonymous substitutions, which, given the likely strong constraints on the amino acid sequences of the protein-coding gene families to maintain protein function, may appear overly simplistic.  #@NEW_LINE#@#  However, at the examined level of divergence, the majority of the selected gene families are expected to be strongly conserved, and therefore a substantial fraction of their nucleotide substitutions are projected to be synonymous.  #@NEW_LINE#@#  For gene families that do deviate from this expectation, we expect the null model to be rejected (discussed in Framework for Comparison of Divergence Patterns in Real and Simulated Gene Families).  #@NEW_LINE#@#  Because, in the real bacterial groups, even conserved gene families exhibit a range of divergence (from hyperconserved to faster evolving), each simulated phylogenetic tree was scaled to a randomly selected value drawn from the distribution of the divergences observed for the real gene families of the analyzed bacterial group.  #@NEW_LINE#@#  Similarly, the composition and length of the DNA sequence of the common ancestor in each gene family simulation was informed by the respective parameters observed in the real data (Methods for details).  #@NEW_LINE#@#  To simulate evolution of multiple gene families, the procedure was repeated 1,000 times.  #@NEW_LINE#@#  

Selection_of_Bacterial_Groups_and_Compilation_of_Gene_Families  #@NEW_LINE#@#  
To test the null hypothesis, we examined four bacterial groups (Escherichia spp., Neisseria spp., Borrelia spp., and Helicobacter pylori) that had at least 100 genomes in public access (to ensure statistical power) and represented a range of lifestyles (to capture potentially different selective pressures that could have affected their diversification) (Table 1 and Dataset S1).  #@NEW_LINE#@#  Escherichia is a -proteobacterial genus comprised of six described species and a few yet unclassified strains (2024).  #@NEW_LINE#@#  The analyzed 620 Escherichia genomes span representatives from environmental isolates to commensals and disease-causing strains of Escherichia coli, Escherichia albertii, Escherichia fergusonii, Escherichia hermanii, and the unclassified Escherichia spp.  #@NEW_LINE#@#  Members of -proteobacterial genus Neisseria colonize the mucosal and dental surfaces of many animals, and two of its 21 currently named species (25), Neisseria meningitidis and Neisseria gonorrhoeae, cause disease in humans (26).  #@NEW_LINE#@#  Neisseria cluster into species groups that do not match perfectly to named species (27), and the relationships between the species groups are unclear (2, 27, 28), perhaps as a result of Neisserias natural propensity for DNA uptake and recombination (29).  #@NEW_LINE#@#  The analyzed 232 Neisseria genomes represent 15 named species, although the majority are from N. meningitidis and N. gonorrhoeae.  #@NEW_LINE#@#  Named species of the spirochete Borrelia (30, 31) form two distinct groups associated with Lyme disease and relapsing fever, respectively (32), and, within Lyme disease group, named species typically form distinct clusters (33).  #@NEW_LINE#@#  The 107 Borrelia genomes in our dataset are dominated by the Lyme disease-causing B. burgdorferi and B. garnii but overall represent 16 named species and include a few relapsing fever isolates.  #@NEW_LINE#@#  Finally, human-associated -proteobacterium Helicobacter pylori (34, 35) is known for its unexpectedly high genomic diversity (36) and extensive recombination (37, 38), likely due to its natural competence.  #@NEW_LINE#@#  Thus, in contrast to the other three bacterial groups, we limited our analyses to 233 genomes within H. pylori and did not expand the analyses to the rest of the genus Helicobacter.  #@NEW_LINE#@#  
To assess genetic diversity patterns within each group, we selected markers frequently used for this purpose: the 16S rRNA gene; several genes known as MLSA loci (39, 40); and a subset of protein-coding genes hereafter referred to, for brevity, as gene families.  #@NEW_LINE#@#  For the last, many comparative bacterial genomic studies aiming at characterization of diversity and structure of a microbial community use single-copy universally or nearly universally present genes, so-called core genes (41).  #@NEW_LINE#@#  The relaxation of universality is needed to account for the substantial gene content variation even among closely related bacteria (42, 43), as well as for the variable quality and completeness of the genomes.  #@NEW_LINE#@#  We focused our analyses on a similar, relaxed core single copy subset of protein-coding gene families within each of the four groups (Table 1; see Methods for details).  #@NEW_LINE#@#  The relaxation of the requirement of a gene to be present in all members of the group by allowing it to be absent in up to 10% of genomes ensured that a sufficiently large number of gene families were available for analyses.  #@NEW_LINE#@#  Additionally, keeping only single-copy genes eliminated gene families expanded via gene duplication and/or horizontal gene transfer and therefore likely to have their evolutionary histories deviate from the assumptions of the null birthdeath model.  #@NEW_LINE#@#  

Framework_for_Comparison_of_Divergence_Patterns_in_Real_and_Simulated_Gene_Families  #@NEW_LINE#@#  
Divergence patterns presented as phylogenetic trees are difficult to compare, especially in large-scale analyses.  #@NEW_LINE#@#  Instead, for each gene family, we calculated the number of clusters at a specific level of divergence using furthest-neighbor hierarchical clustering (44) and summarized the data as a clusterdivergence (CD) curve (Fig 1) (inspired by ref.  #@NEW_LINE#@#  5).  #@NEW_LINE#@#  If a special process, like recombination or periodic selection, influences diversification of real gene families, the shapes of their CD curves are expected to differ from those of the simulated gene families.  #@NEW_LINE#@#  If no difference is detected, then it is inappropriate to conclude that such processes delimit the observed discrete groups.  #@NEW_LINE#@#  Because the focus of the study is on examination of bacterial microdiversity and biological inferences drawn therefrom, we have limited our analyses to evaluation of the divergence patterns that correspond to 0.01 to 0.05 nucleotide substitutions per gene family.  #@NEW_LINE#@#  The range was chosen because the clusters of prokaryotic sequences thought to mark species exhibit, on average, less than 5% and 3% of nucleotide substitutions per genome (45) and 16S rRNA gene (46), respectively.  #@NEW_LINE#@#  
To assess whether the differences in CD curve shapes between real and simulated data are significant, we developed a statistical test reminiscent of the widely used KolmogorovSmirnov (KS) test (47).  #@NEW_LINE#@#  The deviations in shapes of two CD curves are captured in a distance metric Dmax, which measures how maximally far apart the CD curves are in a specified interval of divergence (Methods for details).  #@NEW_LINE#@#  When Dmax between a real gene family and the median of the simulated gene families is compared with the distribution of Dmax among simulated gene families, the former distance metric can be classified as either falling within 95% of the values for the simulated gene families (i.e., indistinguishable from the diversification patterns under the null model; referred as category D=) or significantly differing from the null model by being in the upper (D+) or lower (D) 2.5 percentile.  #@NEW_LINE#@#  The comparisons of the KS to our test show that ours is less conservative (Fig S1), and thus is less likely to generate false matches to the null model.  #@NEW_LINE#@#  

Diversification_Patterns_Observed_in_Gene_Families_of_Bacterial_Groups_Are_Often_Indistinguishable_from_Those_Generated_Under_the_Null_Model  #@NEW_LINE#@#  
Similarity of 16S rRNA gene sequences is one of the widely used approaches implemented to circumscribe OTUs, which are often used in lieu of species to describe microbial diversity within a group of microorganisms or in a microbial community (16).  #@NEW_LINE#@#  However, we found that, for all four analyzed groups, the clustering observed in the real 16S rRNA genes is indistinguishable from the simulations under the null model (Fig 2A and Fig S2).  #@NEW_LINE#@#  Ubiquitous housekeeping genes are also commonly used to identify clustering on species or clonal complex levels (e.g., for pathogen typing) via MLSA (48), and most of these loci are among the identified gene families.  #@NEW_LINE#@#  The majority of the MLSA loci-corresponding gene families of Escherichia, Borrelia, and Neisseria were classified as D= (Fig 2B, Fig S3, and Table S1), and therefore their diversification patterns are also indistinguishable from those simulated under the null model.  #@NEW_LINE#@#  
Similar to the clustering patterns of their 16S rRNA and MLSA gene families, 89.3% of Escherichia and 99.7% of Borrelia relaxed core protein-coding gene families are classified as D= (Table 1, Fig S4, and Fig 3).  #@NEW_LINE#@#  This result is surprising, given that our gene family identification likely disproportionally selected very conserved gene families expected to be under purifying selection.  #@NEW_LINE#@#  Taken together, our observations imply that, for Escherichia and Borrelia, the evolutionary histories of the majority of gene families, including 16S rRNA and the MLSA loci, are statistically indistinguishable from the genes simulated to evolve under genetic drift.  #@NEW_LINE#@#  If recombination or periodic selection impacts these groups (49), they are not sufficiently strong or constrained by phylogeny to produce sequence clusters that are different from the simple model of random turnover of lineages over time.  #@NEW_LINE#@#  
However, the results were somewhat different for H. pylori and Neisseria.  #@NEW_LINE#@#  In stark contrast to Escherichia and Borrelia, 98.8% of H. pylori gene families, including all MLSA loci, were not D= (Fig 4, Fig S3, Table 1 and Table S1).  #@NEW_LINE#@#  In addition to such a dramatic number of H. pylori non-D= gene families, all but one were D+ (Fig 4D).  #@NEW_LINE#@#  Therefore, it is likely that the H. pylori lineage experiences evolutionary forces that violate at least some of the null model assumptions of constant diversity, constant rate of lineage birth/death, and absence of recombination.  #@NEW_LINE#@#  Such patterns of diversification could result from longer terminal branches than expected under the pure birthdeath process.  #@NEW_LINE#@#  Longer terminal branches can be, for example, a result of the variable net rate of birth and death, or due to niche expansion (50) or ecological diversification (51).  #@NEW_LINE#@#  Consistent with the latter possibility, the phylogenetic trees of H. pylori strains and human mitochondrial DNA from various geographic regions are congruent (35).  #@NEW_LINE#@#  High levels of recombination are also shown to result in phylogenetic trees that have longer terminal branches and shorter internal branches (9, 52).  #@NEW_LINE#@#  Given that H. pylori is one of the most mutagenic and recombinogenic bacterium known (53), with the recombination rate being at least an order of magnitude higher than the substitution rate (54), the observed long terminal branches may, in addition, reflect the combination of elevated substitution and recombination rates.  #@NEW_LINE#@#  
Members of Neisseria genus are also known to be highly recombinogenic, albeit to a lesser degree than H. pylori (55).  #@NEW_LINE#@#  Although the majority of Neisseria gene families were classified as D= (Fig S4E and Table 1), the fraction (67.1%) was much smaller than for Borrelia and Escherichia.  #@NEW_LINE#@#  Also, unlike in H. pylori comparisons, most of the non-D= gene families were D (Fig S4F and Table 1).  #@NEW_LINE#@#  These observations suggest that processes shaping diversification of Neisseria are different from those of H. pylori, Escherichia, and Borrelia.  #@NEW_LINE#@#  Although all known Neisseria strains have a natural propensity for DNA uptake, there are barriers to successful between-strain gene exchange (29), which is probably why there are recognizable (albeit fuzzy) clusters on phylogenetic networks of marker genes (25).  #@NEW_LINE#@#  In particular, a genetically uniform group of N. gonorrhoeae forms a clearly isolated cluster (25), which may be explained by N. gonorrhoeae's restriction to urogenital tract, an ecological niche distinct from the oral and nasal cavities colonized by most known Neisseria spp.  #@NEW_LINE#@#  (25).  #@NEW_LINE#@#  Suspecting that such distinct patterns of N. gonorrhoeae diversification and geographic isolation may have impacted shapes of CD curves of its gene families, we reanalyzed the Neisseria group without N. gonorrhoeae genomes.  #@NEW_LINE#@#  In this reduced dataset, 82.7% of Neisseria gene families became statistically indistinguishable from the simulated gene families (Table 1 and Fig S4H), making the overall results comparable to those of Escherichia and Borrelia.  #@NEW_LINE#@#  However, Neisseria are more recombinogenic than Escherichia (55) and Borrelia (32), suggesting that, even in presence of substantial amounts of recombination, the null model cannot be easily rejected.  #@NEW_LINE#@#  

Effects_of_Sampling_on_the_Inferred_Divergence_Patterns  #@NEW_LINE#@#  
Incomplete and biased sampling (for example, of only pathogenic or drug-resistant strains within a species) can influence clustering independently of any speciation-like processes (22, 56) and, as a result, can affect measurements of clade diversifications (57).  #@NEW_LINE#@#  Even though hundreds to thousands of gene families were analyzed for hundreds of genomes within each group, within a gene family, some homologs have identical nucleotide sequences and, as a result, may contain fewer than 100 nonidentical (unique) nucleotide sequences per gene family.  #@NEW_LINE#@#  Therefore, our limited datasets likely miss some of the microdiversity that exists in real, fully sampled bacterial populations.  #@NEW_LINE#@#  If undersampling influences the apparent diversification patterns, the calculations of the values of Dmax for a given null distribution could be affected, which, subsequently, will result in false assignment of gene families into D+, D, and D= categories.  #@NEW_LINE#@#  However, when simulated gene families were randomly subsampled at 25%, 50%, and 75% levels, the patterns of diversification of the subsampled datasets were not significantly different from each other and from the 100% sampled set (One-way ANOVA; F3,396 = 0.115; P = 0.951; Fig S5).  #@NEW_LINE#@#  Thus, the observed diversification patterns and the summary statistic Dmax appear to be robust to incomplete random sampling of a microbial community, consistent with findings of ref.  #@NEW_LINE#@#  50.  #@NEW_LINE#@#  
However, isolates with available genomes may not represent random sampling of both cultured strains and overall microbial community diversity.  #@NEW_LINE#@#  These nonrandom sampling biases are difficult to pinpoint and simulate.  #@NEW_LINE#@#  To investigate the impact of such potential biases empirically, we compared diversification patterns observed in the detected gene families to those in the much more extensive collection of the MLSA database records (refs.  #@NEW_LINE#@#  39, and 40 and Table S1).  #@NEW_LINE#@#  Although these records are likely to have skewed sampling due to their bias for pathogenic strains, when corrected for the difference in the absolute number of nonidentical sequences between the two datasets, the overall shapes of CD curves of the MLSA loci were qualitatively comparable to those of the real gene families (Fig S3 DG).  #@NEW_LINE#@#  Future analyses of genomic sets of a substantially larger size will allow testing of the null hypothesis at precisions higher than used in this study.  #@NEW_LINE#@#  

Dmax_as_a_Metric_for_Identifying_Gene_Families_Under_Selection_and_Those_Suitable_as_Phylogenetic_Markers_of_Microdiversity  #@NEW_LINE#@#  
Are there any common properties of non-D= gene families that may hint at the evolutionary and ecological forces that shape their evolutionary history?  #@NEW_LINE#@#  Compared with D= gene families, D and D+ gene families had significantly smaller and larger tree heights (i.e., the sum of all branch lengths of a phylogenetic tree), respectively (Fig S6A).  #@NEW_LINE#@#  This relation was not due to elevated substitution rates in just a few taxa within a gene family: In many cases, the overall substitution rates for gene families in D+, D=, and D categories differed by an order of magnitude, as reflected in the significantly higher and lower number of nonidentical sequences in D+ and D gene families, respectively (Fig S6B), and as exemplified by trees of selected gene families (Fig S7).  #@NEW_LINE#@#  Taken together, these observations suggest that, in general, D+ gene families represent faster-evolving genes, whereas D gene families are very conserved.  #@NEW_LINE#@#  
Consistent with this hypothesis, 291 D gene families of Escherichia are significantly enriched in genes encoding translation machinery and significantly depleted for several categories of metabolic genes (Fig S8), a functional bias expected for conserved genes (58).  #@NEW_LINE#@#  Additionally, the only D gene families in Borrelia and H. pylori (acpP and rps19, respectively; Fig S4C and Fig 4C) exhibit strong purifying selection in 95% and 98% of their codons (Table 2).  #@NEW_LINE#@#  (Among Neisseria's D gene families, no significant depletion or enrichment of functional categories was detected after correction for multiple testing, possibly reflecting the lack of power to detect statistical significance from the smaller dataset.)  #@NEW_LINE#@#  
Among the identified D+ gene families, fliC of Escherichia exhibits a notably elevated rate of nonsynonymous substitutions, with 18% and 43% of the gene's sites inferred to be under positive and neutral selection, respectively (Table 2).  #@NEW_LINE#@#  The fliC gene encodes flagellin, the flagellar filament protein.  #@NEW_LINE#@#  FliC is known to be a highly polymorphic gene, the evolutionary history of which is shaped by both fixation of mutations and horizontal gene transfer, not only in Escherichia/Salmonella (59) but also in other bacterial pathogens (60, 61).  #@NEW_LINE#@#  Given that fliC protein serves as an antigen (known as an H antigen of Gram-negative bacteria) and an important factor in animal innate immune response (62), generation of fliC allelic diversity via mutation and recombination is one of the strategies for antigenic variation necessary for the arms race against host immune responses (59, 63).  #@NEW_LINE#@#  Similarly, among the numerous H. pyloris D+ gene families, mod-1 and omp3 exhibit notably elevated substitution rates (Table 2).  #@NEW_LINE#@#  In many pathogens, mod genes are hypothesized to function as regulators that control gene expression of surface antigens (64, 65).  #@NEW_LINE#@#  Interestingly, H. pylori exhibits a very high level of variability in its methyltransferase-encoding genes even in isolates from a restricted geographic region (66), highlighting the importance of diversifying selection on these loci in this pathogen.  #@NEW_LINE#@#  H. pylori also carries an unusually large and diverse family of outer membrane proteins (including omp3), and this gene family diversity is hypothesized to be adaptive (67) and to influence the pathogenic success of this bacterium (68).  #@NEW_LINE#@#  
Not all D+ gene families exhibit signatures of positive selection, as exemplified by pilS and mutL gene families in Neisseria (Table 2).  #@NEW_LINE#@#  The pilS gene is part of the two-component signal transduction system PilR/PilS that regulates transcription of the pilin gene in Pseudomonas (69), a component of type IV pili present in Neisseria (70).  #@NEW_LINE#@#  Although it is not clear why pilS in Neisseria has the observed elevated substitution rates, notably, in N. gonorrhoeae, it no longer controls piliation but is still expressed, suggesting the recruitment for some other function (71).  #@NEW_LINE#@#  Such neofunctionalization, if occurring in Neisseria, may underlie observed relaxation of selection on the pilS nucleotide sequence.  #@NEW_LINE#@#  MutL, a gene encoding a component of the mismatch repair (MMR) system, is known to be frequently horizontally transferred (72, 73) and shows evidence for extensive intragenic recombination (72).  #@NEW_LINE#@#  In agreement with our analyses (Table 2), most of the nucleotide variation observed in mutL homologs does not cause a change in amino acid (72), and horizontal acquisition of the mutL gene is hypothesized to be a mechanism for functional restoration of the MMR system in hyperrecombinogenic mutants (72).  #@NEW_LINE#@#  
Combined with the observation that most of the highly recombinogenic H. pylori gene families are in the D+ category, D+ gene families may be enriched in genes that have undergone strong diversifying selection of the corresponding amino acid sequence and/or experienced extensive horizontal gene transfer.  #@NEW_LINE#@#  Regardless of the underlying evolutionary forces, D+ gene families promise to be useful phylogenetic markers for delineating microdiversity within a group of closely related bacteria.  #@NEW_LINE#@#  Some of the identified D+ gene families have already been either shown to be efficacious markers for typing of pathogenic isolates [e.g., porB (74) and lip (75) for Neisseria, and the above-discussed fliC (76, 77) for E. coli] or identified to have a potential to be such markers [e.g., E. coli housekeeping genes ugd and galF that often flank frequently horizontally exchanged genes involved in the O antigen biosynthesis (78, 79)].  #@NEW_LINE#@#  Therefore, the presented framework could help identify loci promising for describing bacterial genotypic variation that is driven by ecological forces.  #@NEW_LINE#@#  

Concluding_Remarks__Implications_for_the_Search_for_the_Biological_Process_Underlying_Bacterial_Speciation  #@NEW_LINE#@#  
Our analysis shows that many of the diversification patterns observed in 16S rRNA genes, MLSA markers, and core genes families are indistinguishable from a random process of lineage birthdeath and, therefore, could be a result of neutral lineage turnover.  #@NEW_LINE#@#  Hence, for these markers, the observed genotypic clustering alone cannot be used as evidence for existence of selection-driven ecological processes behind its formation, as is often done (6, 14, 42, 43, 80), even if the patterns are compatible with such models.  #@NEW_LINE#@#  Taken together with the recent finding that patterns of diversification arising from distinct processes of periodic selection and recombination also mimic each other in appearance (10), our analysis highlights yet another challenge to identifying a single biological process that defines bacterial species (81).  #@NEW_LINE#@#  Moreover, distinct evolutionary patterns of divergence in most gene families of the H. pylori group and many gene families of Neisseria group hint that clustering patterns observed in bacterial groups are not formed by one universal process, and the answer to the question How do bacteria diverge?  #@NEW_LINE#@#  is likely to be group-specific and not generalizable, as has been hypothesized (49).  #@NEW_LINE#@#  We recommend neutral birthdeath models such as that used here as null hypotheses in future prokaryotic speciation studies.  #@NEW_LINE#@#  


Methods  #@NEW_LINE#@#  
Sources_for_the_Bacterial_Datasets  #@NEW_LINE#@#  
Nucleotide and amino acid sequences of the protein-coding genes from the genomes of Escherichia spp., Neisseria spp., Borrelia spp., and Helicobacter pylori (Dataset S1) were obtained from the Pathosystems Resource Integration Center (PATRIC) database (82) between June 2014 and April 2015.  #@NEW_LINE#@#  Nucleotide sequences of 16S rRNA and MLSA genes were extracted from the same PATRIC records.  #@NEW_LINE#@#  Additional nucleotide sequences from MLSA loci for E. coli (40), B. burgdorferi (33), Neisseria (39), and H. pylori (39) (Table S1) were obtained in April 2015 from the MLST databases hosted at https://pubmlst.org/ and mlst.warwick.ac.uk/mlst/dbs/Ecoli.  #@NEW_LINE#@#  

Identification_of_Relaxed_Single-Copy_Core_Gene_Families  #@NEW_LINE#@#  
Amino acid sequences of protein-coding genes in the Escherichia spp., Neisseria spp., Borrelia spp., and Helicobacter pylori groups (analyzed separately) were used as an input in all-versus-all sequence similarity searches, which were conducted using Afree v2.0beta (83) with a word size of five and a minimum Sørensen-Dice (SD) similarity index (84, 85) of 10.  #@NEW_LINE#@#  The obtained SD index-based similarity relationships among the genes were used to determine the gene families using the Markov Cluster Algorithm v14-137 (86, 87) with an inflation parameter of 1.2.  #@NEW_LINE#@#  
The acquired gene families were consequently filtered to identify relaxed core gene families by requiring the genes in a gene family to be present in most (but not all) genomes of the analyzed group.  #@NEW_LINE#@#  Because the four analyzed bacterial groups have different numbers of genomes (Table 1), this requirement translated into a constraint for the gene family homologs to be present in 90% (Borrelia), 95% (Neisseria and H. pylori), and 99% (Escherichia) of genomes, with less stringency imposed on bacterial groups with a smaller number of genomes.  #@NEW_LINE#@#  The relaxed core gene families were further filtered for single-copy relaxed core gene families, defined as those with less than an average of 1.1 gene copies per genome across all genomes in a group.  #@NEW_LINE#@#  Finally, to avoid inclusion of homologs that only shared a protein domain, sequences that were 2 standard deviations outside of the mean amino sequence length of the gene family were removed.  #@NEW_LINE#@#  For brevity, we refer to the resulting single-copy relaxed core gene families simply as gene families throughout the manuscript.  #@NEW_LINE#@#  All further analyses were performed on the nucleotide sequences of the gene families, which are available via FigShare (https://dx.doi.org/10.6084/m9.figshare.4731946).  #@NEW_LINE#@#  

Modeling_Genealogies_of_Gene_Families_That_Evolve_Under_the_Null_Model  #@NEW_LINE#@#  
To simulate evolutionary history of a gene family that is not affected by ecological and evolutionary forces (our null model), we implemented a simple birthdeath process known as the Hey/Moran model (88, 89).  #@NEW_LINE#@#  Under this model, at each generation, a constant-size population of n gene family-containing lineages experiences only an extinction of one randomly chosen lineage (death) and a duplication of a different, also randomly chosen, lineage (birth).  #@NEW_LINE#@#  The birthdeath process is repeated until all n lineages in the population, when tracked back in time, coalesce to a single common ancestor (18).  #@NEW_LINE#@#  The resulting genealogical relationships among n extant lineages can be summarized in a phylogenetic tree.  #@NEW_LINE#@#  To do so, we first define a distance between two extant lineages as a value proportional to the number of generations to their last common ancestor, then calculate pairwise distances for all extant lineages, and, finally, transform the resulting distance matrix into a phylogenetic tree using the neighbor-joining method (90), as implemented in Biopython v1.64 (91).  #@NEW_LINE#@#  The Python source code of the birthdeath model is available at https://github.com/ecg-lab/microdiversity/.  #@NEW_LINE#@#  
The simulations were independently repeated 1,000 times to obtain evolutionary histories of 1,000 gene families, and the procedure was repeated separately for each bacterial group.  #@NEW_LINE#@#  Given that the real gene families varied in size, the size of each simulated gene family (i.e., the number of lineages n) was drawn from the distribution of the observed real gene family sizes in the respective bacterial group.  #@NEW_LINE#@#  

Simulation_of_Nucleotide_Sequences_of_Neutrally_Evolving_Gene_Families  #@NEW_LINE#@#  
Among the gene families of real bacterial groups, we expect to observe a gamut of gene lengths, variable nucleotide composition, and level of sequence conservation (which can be measured by tree height) that ranges from ultraconserved to quickly evolving gene families.  #@NEW_LINE#@#  This variation was captured as distributions of the parameters observed within each analyzed bacterial group.  #@NEW_LINE#@#  The distributions were used to mimic variation among the simulated gene families.  #@NEW_LINE#@#  Specifically, the genealogical history of each simulated gene family was scaled with a tree height randomly drawn from the observed range of tree heights.  #@NEW_LINE#@#  The length of the gene in a simulated gene family was drawn from the distribution of observed gene lengths.  #@NEW_LINE#@#  Lastly, the nucleotide sequence of the last common ancestor (i.e., the sequence at the root node of the simulated gene family's genealogy) was generated randomly, but with nucleotide composition drawn from the distribution of observed nucleotide frequencies in real gene families.  #@NEW_LINE#@#  Using the ancestral sequence and the scaled simulated genealogical history as an input tree, nucleotide sequences of a simulated gene family were evolved in Seq-Gen v1.3.3 (92) under the F81 substitution model (19).  #@NEW_LINE#@#  This model takes into account empirical nucleotide frequencies but, otherwise, does not make any additional assumptions about how nucleotide changes occur over time, and therefore represents neutral accumulation of the substitutions over time.  #@NEW_LINE#@#  No insertions or deletions were simulated.  #@NEW_LINE#@#  

Adjustments_for_the_Analyses_of_16S_rRNA_Gene  #@NEW_LINE#@#  
Due to presence of multiple, often nonidentical copies of 16S rRNA genes (93, 94) in many of the genomes in the four analyzed groups, and much higher nucleotide conservation of 16S rRNA gene, a slightly different methodology was used for both the assembly of 16S rRNA gene family from the analyzed genomes and the simulation of 16S rRNA-like sequences.  #@NEW_LINE#@#  Specifically, 16S rRNA-like gene genealogies were simulated 100 times, using the number of unique rRNA sequences in the real bacterial group as a value of n. For the corresponding nucleotide sequence simulations, these genealogies were scaled with respect to the maximum divergence observed for the real 16S rRNA gene family, and the length of the ancestral nucleotide sequence was set to 1,500 bp.  #@NEW_LINE#@#  The nucleotide sequences were evolved in Seq-Gen v1.3.3 (92) under the F81 substitution model (19).  #@NEW_LINE#@#  
Because presence of multiple nonidentical copies of a 16S rRNA gene per genome may affect the inferred clustering patterns, we also constructed an additional 16S rRNA gene family that included only one, randomly selected, full-length, 16S rRNA gene copy per genome, and we investigated the differences in observed clustering in the full and subsampled 16S rRNA gene families (Fig S2A).  #@NEW_LINE#@#  As expected, such data subsampling underestimated the amount of observed microdiversity, but the overall shapes of the two CD curves remained similar (Fig S2A).  #@NEW_LINE#@#  Given that our simulations assume one gene copy per lineage, we used subsampled 16S rRNA gene family in the comparisons of real and simulated data.  #@NEW_LINE#@#  

Alignments_of_Gene_Families  #@NEW_LINE#@#  
Nucleotide sequences of each real gene family, as well as of the MLSA loci, were aligned using the MUSCLE v3.8.31 program (95) with a maximum number of iterations set to 16.  #@NEW_LINE#@#  Sequences with fewer than 50 nucleotides aligned to all other sequences were removed.  #@NEW_LINE#@#  Alignments of 16S rRNA genes were calculated using the SINA program (96), which incorporates structural information of the rRNA.  #@NEW_LINE#@#  Alignment was unnecessary for simulated gene families, as simulations did not incorporate insertions or deletions of nucleotides.  #@NEW_LINE#@#  

Quantification_of_Divergence_Patterns  #@NEW_LINE#@#  
For each gene family, pairwise nucleotide distances were calculated from the gene family alignment using the Mothur v1.32.1 program (44).  #@NEW_LINE#@#  These distances were not corrected for multiple substitutions, because we assumed that genomes within analyzed groups have recently diverged and therefore are not expected to accumulate many multiple substitutions, and, additionally, we analyzed only distances between 0.01 and 0.05 (i.e., divergence of 1 to 5%).  #@NEW_LINE#@#  The calculated distances were used to group taxa into clusters at various distance cutoffs using furthest-neighbor algorithm with a precision parameter of 1,000, as implemented in Mothur v1.32.1 (44).  #@NEW_LINE#@#  The resulting patterns of divergence were captured in a CD curve, in which the number of clusters in a gene family (y axis) is a function of genetic divergence (x axis) (Fig 1).  #@NEW_LINE#@#  The shape of the CD curve is expected to reflect the evolutionary processes (e.g., selective sweeps, recombination) that influence the history of the gene family.  #@NEW_LINE#@#  

Assignment_of_Statistical_Significance_to_Differences_in_Divergence_Patterns  #@NEW_LINE#@#  
To determine if the shape of a given gene family's CD curve is significantly different from that of the simulated neutrally evolving gene families (the null distribution of CD curves), we developed a statistical method inspired by an application of the KS test (47) to the comparison of evolutionary histories (97).  #@NEW_LINE#@#  Although our test resembles the KS test, we introduced improvements that allowed us to assess differences in specific parts of two curves, to take into account how variable the null distribution is, and to discriminate between two classes of significantly different CD curves (that we designate as D+ and D; see below).  #@NEW_LINE#@#  
Specifically, in our method, the distance D(x) between a CD curve Y of a real gene family and a distribution of CD curves of the simulated gene families N = {N1,N2, ..., N1000} (the null distribution) at a particular divergence x is defined asD(x)=Y(x)median(N(x)),ifMAD(N(x))1,D(x)=Y(x)median(N(x))MAD(N(x)),ifMAD(N(x)) greater than 1,  #@NEW_LINE#@#  
where Y(x) is the number of clusters in the given gene family at divergence x, median(N(x)) is the median number of clusters of the null distribution N at divergence x, and MAD (N(x)) = median (|Ni(x) - median (N(x))|) is the median absolute deviation of the null distribution at divergence x.  #@NEW_LINE#@#  As a robust measure of variability among a set of measurements, MAD is used here to take into account the spread of the null distribution N at a specific divergence x.  #@NEW_LINE#@#  When the simulations produced a variable distribution [i.e., MAD(N(x))  greater than  1], D(x) was normalized by MAD(N(x)) to avoid an inflation of D(x).  #@NEW_LINE#@#  When simulations were less variable [i.e., MAD(N(x))  1], the normalization was not used.  #@NEW_LINE#@#  
Each real gene family was then associated with a single value Dmax defined asDmax=maxx|D(x)|,  #@NEW_LINE#@#  
where x varies across a specified divergence range (in our case, between 0.01 and 0.05, at 0.01 intervals; the clusters at divergence of 0.00 were excluded to reduce the impact of biased sampling).  #@NEW_LINE#@#  Using the same procedure, each simulated gene family was compared with all simulated gene families to obtain the set of Dmax values of the null distribution.  #@NEW_LINE#@#  
Based on the Dmax metric, real gene families were classified into three categories, D+, D, and D=, which correspond to sets of gene families with Dmax values greater than the top 2.5%, less than the bottom 2.5%, or within the middle 95%, respectively, of the Dmax values of the null distribution.  #@NEW_LINE#@#  Patterns of diversification of a given gene family were designated as significantly different from the null distribution in a given divergence range if the family was classified into the D+ or D category; this corresponds to a P value less_than 0.05, because the expectation of seeing the specific Dmax value due to chance is less than 5%.  #@NEW_LINE#@#  

Assessment_of_Incomplete_Sampling_on_CD_Curve_Shape  #@NEW_LINE#@#  
To investigate the effects of random subsampling from a larger population, four different population sizes100, 133, 200, and 400 lineageswere simulated 100 times each.  #@NEW_LINE#@#  From each population size, 100 random genes were subsampled without replacement, which corresponds to 100% (100 out of 100), 75% (100 out of 133), 50% (100 out of 200), and 25% (100 out of 400) sampling rates.  #@NEW_LINE#@#  Distance Dmax was calculated for each gene family in both the full simulation and each subsample.  #@NEW_LINE#@#  The distributions of Dmax were compared by one-way ANOVA (98).  #@NEW_LINE#@#  

Assignment_and_Analysis_of_Gene_Families'_Functional_Annotations  #@NEW_LINE#@#  
A randomly selected amino acid sequence from each gene family was used as a query in a protein BLAST (99) search (database size 107, e value less_than 105, low-complexity filter on) against the Clusters of Orthologous Groups (COG) database (2014 update; accessed at ftp://ftp.ncbi.nih.gov/pub/COG/COG2014/data) (100).  #@NEW_LINE#@#  Each gene family was assigned a functional annotation of the top-scoring BLASTP match.  #@NEW_LINE#@#  If a gene family had no homologs in the COG database, it was excluded from further analysis.  #@NEW_LINE#@#  Underrepresentation and overrepresentation of specific functional categories among the gene families classified as either D+ or D was evaluated using Fishers exact test (101).  #@NEW_LINE#@#  

Inference_of_Selection_Regimes_in_Gene_Families_with_the_Elevated_Dmax  #@NEW_LINE#@#  
From each of the four analyzed bacterial groups, gene families with the largest values of Dmax in [0.01; 0.05] divergence interval in both D+ and D categories were examined for evidence of selection (Table 2).  #@NEW_LINE#@#  For these gene families, the codon nucleotide alignments were created using translatorX v1.1 (102) from the amino acid sequence alignment generated in MUSCLE v3.8.31 (95).  #@NEW_LINE#@#  Maximum likelihood phylogenetic trees were reconstructed in the RAxML program v7.3.6 (103) under the GTR+ substitution model [general time-reversible (GTR) substitution model with among-site rate variation accomodated using  distribution] and with 100 rapid bootstraps.  #@NEW_LINE#@#  Using these trees and corresponding codon alignments as an input, the fraction of sites under selection, as well as estimates of dN and dS, were inferred under the M2a model (104), as implemented in the PAML program v4.8 (105).  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
We thank Dr. W. Ford Doolittle for numerous stimulating discussions of the project and for comments on the manuscript.  #@NEW_LINE#@#  We also thank Drs.  #@NEW_LINE#@#  Deborah Hogan, Phillip Honenberger, Mark McPeek, and Camilla Nesbø for critical reading of the manuscript drafts, and two anonymous reviewers for the constructive and insightful feedback.  #@NEW_LINE#@#  This work was supported by the Simons Foundation Investigator in Mathematical Modeling of Living Systems award (to O.Z.)  #@NEW_LINE#@#  and Dartmouth start-up funds (to O.Z.  #@NEW_LINE#@#  ).  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  


