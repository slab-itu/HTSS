article id="http://dx.doi.org/10.1073/pnas.1710936115"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Windowed Granger causal inference strategy improves discovery of gene regulatory networks  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
Discovery of gene regulatory networks (GRNs) is crucial for gaining insights into biological processes involved in development or disease.  #@NEW_LINE#@#  Although time-resolved, high-throughput data are increasingly available, many algorithms do not account for temporal delays underlying regulatory systemssuch as protein synthesis and posttranslational modificationsleading to inaccurate network inference.  #@NEW_LINE#@#  To overcome this challenge, we introduce Sliding Window Inference for Network Generation (SWING), which uniquely accounts for temporal information.  #@NEW_LINE#@#  We validate SWING in both in silico and in vitro experimental systems, highlighting improved performance in identifying time-delayed edges and illuminating network structure.  #@NEW_LINE#@#  SWING performance is robust to user-defined parameters, enabling identification of regulatory mechanisms from time-series gene expression data.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Accurate inference of regulatory networks from experimental data facilitates the rapid characterization and understanding of biological systems.  #@NEW_LINE#@#  High-throughput technologies can provide a wealth of time-series data to better interrogate the complex regulatory dynamics inherent to organisms, but many network inference strategies do not effectively use temporal information.  #@NEW_LINE#@#  We address this limitation by introducing Sliding Window Inference for Network Generation (SWING), a generalized framework that incorporates multivariate Granger causality to infer network structure from time-series data.  #@NEW_LINE#@#  SWING moves beyond existing Granger methods by generating windowed models that simultaneously evaluate multiple upstream regulators at several potential time delays.  #@NEW_LINE#@#  We demonstrate that SWING elucidates network structure with greater accuracy in both in silico and experimentally validated in vitro systems.  #@NEW_LINE#@#  We estimate the apparent time delays present in each system and demonstrate that SWING infers time-delayed, genegene interactions that are distinct from baseline methods.  #@NEW_LINE#@#  By providing a temporal framework to infer the underlying directed network topology, SWING generates testable hypotheses for genegene influences.  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
SWING integrates multivariate Granger causality and ensemble learning to infer interactions from gene expression data.  #@NEW_LINE#@#  First, SWING subdivides time-series data into several temporally spaced windows based on user-specified parameters (Fig 1A).  #@NEW_LINE#@#  For each window, edges are inferred from the selected window and previous windows, representing interactions with specific delays.  #@NEW_LINE#@#  This inference results in a ranked list of time-delayed genegene interactions for each window (Fig 1B).  #@NEW_LINE#@#  The ensemble of models is aggregated based on edge rank into a static GRN (Fig 1C).  #@NEW_LINE#@#  In silico and in vitro validation confirmed notable performance improvements.  #@NEW_LINE#@#  
SWING_Improves_the_Inference_of_in_Silico_GRNs  #@NEW_LINE#@#  
We applied SWING to reconstruct in silico GRNs simulated by GeneNetWeaver (GNW) (24).  #@NEW_LINE#@#  A total of 20 subnetworks with 10 nodes and nonisomorphic topologies were extracted from E. coli and S. cerevisiae networks included in GNW to use as gold standards.  #@NEW_LINE#@#  Networks were inferred from the generated time-series data by using existing multivariate methods as a basis for comparison.  #@NEW_LINE#@#  We used RandomForest (RF), least absolute shrinkage and selection operator (LASSO), and partial least-squares regression (PLSR) (11, 12, 25), which represent the areas of sparse, nonlinear, and PLS-based regression.  #@NEW_LINE#@#  We implemented the SWING chassis and compared the performance of each SWING frontline method with its base method: SWING-RF vs. RF, SWING-LASSO vs. LASSO, and SWING-PLSR vs. PLSR.  #@NEW_LINE#@#  
To capture short-term dynamics consistent with simulated perturbations, we set the window size to approximately half the duration of the time series.  #@NEW_LINE#@#  The minimum and maximum lags were set to kmin=1 and kmax=3, which correspond to 50 and 100 min.  #@NEW_LINE#@#  We compared the group of inferred networks by calculating the mean increase in the area under the precision-recall (AUPR) and area under the receiver operating characteristic (AUROC) curves of 40 in silico networks.  #@NEW_LINE#@#  Compared with respective baseline methods, SWING showed a statistically significant increase in AUROC and AUPR for many of the 10-node networks (Fig 2A and SI Appendix, Table S1) and across all of the 100-node networks (SI Appendix, Fig S1 and Table S1).  #@NEW_LINE#@#  In particular, RF received the most notable benefit from SWING; SWING-RF outperformed RF in 39 out of 40 in silico networks, and application of SWING-RF resulted in the highest mean AUROC and AUPR for in silico networks among tested methods.  #@NEW_LINE#@#  

SWING_Infers_Distinct_Edges_in_Networks  #@NEW_LINE#@#  
No single method performs optimally across all datasets, partially due to biases in predicting different network topologies.  #@NEW_LINE#@#  For example, E. coli-derived networks predominately feature fan-out motifs, which RF infers with greater sensitivity.  #@NEW_LINE#@#  In contrast, S. cerevisiae-derived networks contain more cascade motifs, which are inferred with greater sensitivity by linear methods (14).  #@NEW_LINE#@#  
To determine if SWING methods provide distinct information from RF, LASSO, and PLSR (R/L/P), we ran principal component analysis (PCA) on ranked edge lists predicted by SWING and the corresponding base methods (Fig 2B).  #@NEW_LINE#@#  We discarded PC1 because it largely explains the overall performance of each inference method (58% variance explained; SI Appendix, Fig S2).  #@NEW_LINE#@#  Clustering of results in PC2 and PC3 seemed to explain biases toward specific network motifs (14).  #@NEW_LINE#@#  Along PC2, edge rankings appeared to separate based on the internal base method (15% variance explained), while along PC3, SWING edge rankings appeared to separate from those of their base methods (5% variance explained).  #@NEW_LINE#@#  These results suggest that SWING recovered connectivities that were distinct from those recovered from R/L/P.  #@NEW_LINE#@#  
Given that it is difficult to determine a priori which methods perform optimally in different contexts, deriving a community network is a good strategy for robustly improving predictions (14).  #@NEW_LINE#@#  We evaluated the performance of SWING-Community, which combines SWING-RF, -LASSO, and -PLSR predictions by calculating the mean rank across all methods for each possible edge.  #@NEW_LINE#@#  We note that SWING-Community outperformed RF, resulting in a 52% and 8% mean increase in AUPR and AUROC, respectively, suggesting that SWING infers distinct and complementary networks (SI Appendix, Fig S3).  #@NEW_LINE#@#  

SWING_Improves_Network_Inference_by_Promoting_Time-Delayed_Edges  #@NEW_LINE#@#  
Endogenous reactions, such as protein translation, posttranslational modifications, translocation, or oligomerization, are often not accounted for in GRNs.  #@NEW_LINE#@#  However, even if underlying network kinetics are linear (or approximately linear), the resulting dynamics can appear delayed when not all nodes are observed (SI Appendix, Fig S4A).  #@NEW_LINE#@#  Delayed behavior in gene expression and protein translation has been established in several studies (26, 27).  #@NEW_LINE#@#  
We estimated the apparent time delay of each interaction in a 10-node GNW network by calculating the pairwise peak cross-correlation between time series of all true regulator and target combinations.  #@NEW_LINE#@#  The majority of true interactions within GNW networks had a time delay between 0 and 150 min (SI Appendix, Fig S4B).  #@NEW_LINE#@#  We observed that SWING was more likely to promote edges with an identifiable delay within the range of user-specified parameters (SI Appendix, Fig S5A).  #@NEW_LINE#@#  Across all in silico networks, SWING-RF promoted 65.8% of true edges with a delay vs. 55.4% of true edges without a delay (P = 0.018), and SWING-PLSR promoted 67.0% of true edges with a delay vs. 47.1% of true edges without a delay (P = 6.00e-6) (SI Appendix, Fig S5B).  #@NEW_LINE#@#  
Many of the promoted edges with an identifiable delay were highly ranked by base methods RF and PLSR.  #@NEW_LINE#@#  In general, delayed true edges ranked in the first quartile by the base method were likely to be promoted, while those ranked lower were no more likely to be promoted than nondelayed true edges (SI Appendix, Fig S5B).  #@NEW_LINE#@#  While SWING was more likely to promote true edges with a delay, the magnitude of this promotion was not consistent across the different base methods or networks.  #@NEW_LINE#@#  SWING-RF promoted true edges with an apparent time delay by an average of 7.50 ranks relative to true edges without an apparent time delay (P = 4.75e-3) for S. cerevisiae-derived networks.  #@NEW_LINE#@#  In contrast, SWING-PLSR promoted true edges with an apparent delay by an average of 7.78 ranks relative to true edges without an apparent time delay (P = 6.89e-5) for E. coli-derived networks (SI Appendix, Fig S5B).  #@NEW_LINE#@#  In one example, S. cerevisiae network 12, SWING-RF improved the AUROC from 0.539 to 0.872, a 61.7% increase relative to the base method.  #@NEW_LINE#@#  Compared with RF, the edge ranking for SWING-RF promoted many true edges, and all of the true edges with a delay were promoted by SWING (SI Appendix, Fig S6A).  #@NEW_LINE#@#  
To demonstrate how SWING promoted delayed edges, we highlighted the true edge between gene 2 (G2) and gene 1 (G1) in S. cerevisiae network 12.  #@NEW_LINE#@#  G2 is the only node upstream of G1, and the input data included an experiment where only G2 was perturbed; thus, the delay between G2 stimulation and G1 response was unambiguously isolated (SI Appendix, Fig S7A).  #@NEW_LINE#@#  We estimated the delay between G2 and G1 as two time points, or 100 min.  #@NEW_LINE#@#  We shifted the G1 time series by two time points to show that the Pearson correlation of the resulting time series notably increases (SI Appendix, Fig S6B).  #@NEW_LINE#@#  

SWING_Infers_Apparent_Time-Delayed_Edges_with_Greater_Sensitivity_in_the_E_coli_SOS_Network  #@NEW_LINE#@#  
We applied SWING to an in vitro eight-node E. coli GRN that activates with DNA damage (20, 28).  #@NEW_LINE#@#  The SOS network contains several complex interactions, including multiple cascades and feedback loops generated by a combination of transcriptional activators and repressors.  #@NEW_LINE#@#  We computed the mean of three replicates for each time point following DNA damage induced by norfloxacin treatment (29).  #@NEW_LINE#@#  
The sampling strategy for the in vitro SOS data are different from that of the in silico GNW data.  #@NEW_LINE#@#  Due to fewer time points, we were restricted to assessing interactions with shorter possible time delays.  #@NEW_LINE#@#  Using w=0.5T=7, kmin=0, and kmax=1, SWING-RF inferred the network more accurately than other reported inference algorithms including RF, LASSO, TSNI (29), and BANJO (30).  #@NEW_LINE#@#  Because RF is a stochastic method, we ran both RF and SWING-RF 50 times on the SOS network.  #@NEW_LINE#@#  On average, SWING-RF increased the AUPR from 0.286 to 0.356 (24.6%, P = 1.41e-13) and the AUROC from 0.756 to 0.819 (8.3%, P = 5.28e-34).  #@NEW_LINE#@#  To assess promotion of time-delayed edges, we calculated the mean edge ranks across all 50 runs and compared the resulting lists.  #@NEW_LINE#@#  Although SWING-RF demoted some true edges, it promoted all three edges that exhibited a time delay (Fig 3A).  #@NEW_LINE#@#  We highlighted the edge between lexA and umuDC (SI Appendix, Fig S7B), which had an estimated lag of 6 min.  #@NEW_LINE#@#  When the umuDC time series was shifted by this amount, the correlation between lexA and umuDC increased from 0.709 to 0.928 (Fig 3B).  #@NEW_LINE#@#  These findings reaffirmed that SWING improves network inference, in part, by promoting edges with identifiable delays.  #@NEW_LINE#@#  

SWING_Accurately_Infers_RegulonDB_Modules_with_Time-Delayed_Edges  #@NEW_LINE#@#  
We curated microarray data to infer time-delayed edges from experimentally validated GRNs in E. coli (Fig 4A) and S. cerevisiae (SI Appendix, Fig S8).  #@NEW_LINE#@#  This curated data were aggregated across 18 datasets for E. coli and 8 datasets for S. cerevisiae, where data were unevenly sampled for time intervals that ranged from 5 to 120 min (SI Appendix, Table S2).  #@NEW_LINE#@#  To assess the landscape of apparent time delays present in these gene expression data, we performed pairwise cross-correlation lag selection between experimentally confirmed edges (31).  #@NEW_LINE#@#  We reveal that of 2,870 experimentally confirmed edges, only 23.7% exhibited an apparent time delay of 0, and 13.7% exhibited a time delay of at least 10 min.  #@NEW_LINE#@#  Surprisingly, only 37.4% of confirmed edges exhibited pairwise correlation (R  0.7, P less_than 1e-5; Fig 4A).  #@NEW_LINE#@#  
To determine whether lag is associated with modularity and function, we clustered the E. coli and S. cerevisiae network into smaller modules using MCODE (32) and performed gene ontology enrichment analysis.  #@NEW_LINE#@#  Several modules, such as those associated with catabolic processes and metal ion binding, were enriched with time-delayed edges of at least 10 min (SI Appendix, Tables S3 and S4).  #@NEW_LINE#@#  Transcription factors known to regulate genes on a global or combinatorial scale tend to exhibit similar time delays (SI Appendix, Table S5).  #@NEW_LINE#@#  
To determine if SWING more accurately infers network structure in diverse contexts, we performed cubic spline interpolation to generate evenly sampled time-series gene expression at 10-min intervals and benchmarked SWING-Community performance against an ensemble model of R/L/P base for each clustered module using this dataset.  #@NEW_LINE#@#  SWING-Community outperformed R/L/P in subnetworks in which 10% of edges were time-delayed (n = 26 clusters, 9 clusters with less_than10 genes, or less_than3 transcription factors were removed from analysis, P = 0.031; Fig 4B).  #@NEW_LINE#@#  As an example, we identified time-delayed properties of key regulators of the tdcABC E. coli operon that are responsible for the transport of threonine and serine during anaerobic growth (33).  #@NEW_LINE#@#  In particular, our analysis identified two global transcription factors that bind combinatorially to induce activity in the tdcABC operon.  #@NEW_LINE#@#  Crp and fnr are global regulators that respond to glucose starvation and anaerobic growth, respectively (34, 35).  #@NEW_LINE#@#  
Interestingly, lag analysis identified 10- and 20-min time delays between crp and target genes in the E. coli tdcABC operon.  #@NEW_LINE#@#  While the precise delay identified by our analysis was not consistent with that observed in experiments, studies confirmed that a delay existed between crp induction and the induction of several target genes (36).  #@NEW_LINE#@#  This delay can possibly be attributed to posttranslational modification of crp (37).  #@NEW_LINE#@#  Of 32 edges in the gold standard, SWING identified 27 true-positive (TP) edges and 5 false-positive (FP) edges (85% TP), while the ensemble model predicted 24 TP edges and 8 FP edges (75% TP).  #@NEW_LINE#@#  In this example, SWING-Community inferred both time-delayed and non-time-delayed edges more sensitively than the R/L/P ensemble model.  #@NEW_LINE#@#  The FP edges inferred by SWING-Community were also within the subset of FP edges inferred by the base community method.  #@NEW_LINE#@#  

SWING_Performance_Is_Robust_Across_Parameters  #@NEW_LINE#@#  
SWING adds user-defined parameters to baseline methods, which are necessary for window creation and time-delay inference.  #@NEW_LINE#@#  The selection of these parameters was both context- and data-specific.  #@NEW_LINE#@#  We conducted parametric sensitivity analysis of SWING as a function of window size, combinations of kmin and kmax, and experimental sampling interval in context of the in silico networks and the E. coli SOS network (SI Appendix, Figs.  #@NEW_LINE#@#  S9S14).  #@NEW_LINE#@#  While SWING outperformed baseline methods over a wide range of window sizes (SI Appendix, Fig S9), the performance of a single network may differ from other networks, suggesting that the optimal window size is partially dependent on the underlying inference method and network structure.  #@NEW_LINE#@#  Therefore, user-specified SWING parameterskmin, kmax, and wshould be chosen based on the data and are discussed in detail in SI Appendix, Sensitivity Analysis.  #@NEW_LINE#@#  Overall SWING outperforms baseline methods for a wide range of possible parameters (SI Appendix, Figs.  #@NEW_LINE#@#  S9S13).  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
Tight regulation of gene expression is critical to maintaining robust responses to perturbations and environmental disturbances, and misregulation of intracellular signaling dynamics can lead to a wide variety of diseases.  #@NEW_LINE#@#  For this reason, uncovering the topology of GRNs is of fundamental interest to the scientific community, since the resulting maps can be used to identify interventions to control cellular phenotypes.  #@NEW_LINE#@#  Many current methods disregard temporal information and are limited in their ability to accurately infer network topology.  #@NEW_LINE#@#  Indifference to time delays will be the Achilles heel of many systems biology strategies.  #@NEW_LINE#@#  We developed a general temporal framework for network inference that accurately uncovers the regulatory structures governing complex biological systems by accounting for these fundamental delays.  #@NEW_LINE#@#  SWING improves upon existing Granger methods by generating an ensemble of windowed models that simultaneously evaluate multiple upstream regulators at several potential time delays.  #@NEW_LINE#@#  We validated its utility and performance in several in silico (Fig 2A) and in vitro (Figs.  #@NEW_LINE#@#  3 and 4B) systems.  #@NEW_LINE#@#  
Consideration_of_Time_Delays_Improves_SWING_Performance_and_Should_Be_Integrated_in_Experimental_Design  #@NEW_LINE#@#  
Our in silico and in vitro results demonstrate that promoted edges were enriched for those with apparent time delays (SI Appendix, Fig S5B), suggesting that network inference was improved, in part, by accounting for temporal information.  #@NEW_LINE#@#  We supported this finding by demonstrating that SWING-RF promotes an edge with a distinct and singular delay (SI Appendix, Fig S6A).  #@NEW_LINE#@#  We also used SWING to predict directed edges of several E. coli subnetworks using cubic spline interpolated microarray datasets.  #@NEW_LINE#@#  Through cross-correlation analysis, we estimated time-delayed interactions in in silico, E. coli, and S. cerevisiae networks, and showed that SWING performed better than baseline methods in modules with more frequent time-delayed edges, such as the tdcABC regulon.  #@NEW_LINE#@#  
Interestingly, the apparent time delay only partially explained improved performance, as SWING also promoted edges without apparent time delays in in silico and in vitro networks.  #@NEW_LINE#@#  This discrepancy may have arisen from our conservative approach for identifying time delays; a more liberal approach could assign time delays to a greater fraction of the promoted edges.  #@NEW_LINE#@#  However, it is particularly challenging to estimate time delays for genes with multiple regulators by using cross-correlation.  #@NEW_LINE#@#  More complex algorithms that incorporate additional information (i.e., nonlinearity and partial correlation) could improve time-delay estimation between regulators and targets (38).  #@NEW_LINE#@#  
An additional consideration involves interactions that occur faster than the sampling interval.  #@NEW_LINE#@#  These interactions will not exhibit a delay in the time series and will resist inference and estimation of time delay regardless of methodology.  #@NEW_LINE#@#  This bottleneck can be managed by designing experiments with shorter sampling intervals.  #@NEW_LINE#@#  The choice of sampling interval is context-specific, and we recommend sampling with sufficient frequency to capture dynamics of interest.  #@NEW_LINE#@#  

SWING_Outperforms_Common_Network_Inference_Algorithms_Across_Scales  #@NEW_LINE#@#  
SWING outperforms common network inference algorithmsR/L/Pbut is limited by computational expense.  #@NEW_LINE#@#  Since SWING constructs a larger explanatory matrix and executes multivariate comparisons between multiple time delays, it is more expensive than the aforementioned methods.  #@NEW_LINE#@#  Fortunately, SWING is trivially parallelizable and can be implemented on any multicore processing system.  #@NEW_LINE#@#  We conducted similarly derived 100-node in silico networks and found that SWING increased the AUPR and AUROC for all three methods (SI Appendix, Fig S1), including SWING-LASSO, which had no significant difference for the 10-node networks (Fig 2A).  #@NEW_LINE#@#  Remarkably, every single network was inferred with greater accuracy, indicating that SWING has notable benefits for larger inference tasks (SI Appendix, Fig S1 and Table S1).  #@NEW_LINE#@#  

SWING_Is_an_Extensible_Framework  #@NEW_LINE#@#  
Compared with other time-delayed inference algorithms, SWING is a flexible and extensible framework that is not limited to using a single statistical method.  #@NEW_LINE#@#  The SWING framework was implemented with R/L/P; it can be easily expanded to use other multivariate inference algorithms, including those that use prior information and heterogeneous data types (39).  #@NEW_LINE#@#  Additional improvements can be made by incorporating complex weighting of methods for consensus analysis that leverage known weaknesses and biases of inference methods.  #@NEW_LINE#@#  Methods that involve empirical optimization of combination weights, such as those assessed in the DREAM challenge, are expected to substantially improve SWING performance (40).  #@NEW_LINE#@#  
Although we implemented SWING to infer interactions from gene expression data, the same Granger causality principles can be applied to a wide variety of contexts with temporal dynamics.  #@NEW_LINE#@#  Provided sufficient time-series data, we expect SWING to identify regulatory relationships in related intracellular signaling pathways, as well as broader fields such as ecology, social sciences, and economics.  #@NEW_LINE#@#  As the sensitivity/specificity of experimental tools increases and the cost of implementation decreases, we expect longer and higher-resolution time-series data to become widely available.  #@NEW_LINE#@#  We expect this increase in time resolution to further improve the accuracy of SWING-based network inference, especially as the community continues to build on the SWING chassis.  #@NEW_LINE#@#  The SWING framework, with currently implemented methods, is available on GitHub (https://github.com/bagherilab/SWING).  #@NEW_LINE#@#  


Materials_and_Methods  #@NEW_LINE#@#  
The SWING algorithm is described in detail in SI Appendix, SI Materials and Methods, including parameter selection, management of time-series data and window creation, model aggregation, and graph generation.  #@NEW_LINE#@#  In silico simulations and in vitro data aggregation are also described in SI Appendix, SI Materials and Methods.  #@NEW_LINE#@#  The sensitivity of SWING performance as a function of user-defined parameters is described in SI Appendix, SI Sensitivity Analysis.  #@NEW_LINE#@#  

Acknowledgments  #@NEW_LINE#@#  
This research was supported, in part, by Biotechnology Training Program Grant T32 GM008449 (to J.D.F.  #@NEW_LINE#@#  ), NIH National Heart, Lung, and Blood Institute Award F31HL134331-02 (to J.J.W.  #@NEW_LINE#@#  ), NSF CAREER Award CBET-1653315 (to N.B.  #@NEW_LINE#@#  ), the Quest high performance computing facility, and the McCormick School of Engineering at Northwestern University.  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  

Published under the PNAS license.  #@NEW_LINE#@#  

