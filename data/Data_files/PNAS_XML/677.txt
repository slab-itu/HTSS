article id="http://dx.doi.org/10.1073/pnas.1619320114"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
CYCLOPS reveals human transcriptional rhythms in health and disease  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
Circadian rhythms influence most aspects of physiology and behavior.  #@NEW_LINE#@#  However, how do we apply this knowledge in medicine?  #@NEW_LINE#@#  Identifying molecular mechanisms in humans is challenging as existing large-scale datasets rarely include time of day.  #@NEW_LINE#@#  To address this problem, we combine understanding of periodic structure, evolutionary conservation, and unsupervised machine learning to order unordered human biopsy data along a periodic cycle.  #@NEW_LINE#@#  We show this works using ordered mouse and human data and that it gives consistent results when applied to populations on different continents.  #@NEW_LINE#@#  Then, we investigate molecular rhythms in normal human lung and liver and cancerous liver.  #@NEW_LINE#@#  Finally, we demonstrate proof of concept by finding the best time to administer a chemotherapeutic drug in an animal model.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Circadian rhythms modulate many aspects of physiology.  #@NEW_LINE#@#  Knowledge of the molecular basis of these rhythms has exploded in the last 20 years.  #@NEW_LINE#@#  However, most of these data are from model organisms, and translation to clinical practice has been limited.  #@NEW_LINE#@#  Here, we present an approach to identify molecular rhythms in humans from thousands of unordered expression measurements.  #@NEW_LINE#@#  Our algorithm, cyclic ordering by periodic structure (CYCLOPS), uses evolutionary conservation and machine learning to identify elliptical structure in high-dimensional data.  #@NEW_LINE#@#  From this structure, CYCLOPS estimates the phase of each sample.  #@NEW_LINE#@#  We validated CYCLOPS using temporally ordered mouse and human data and demonstrated its consistency on human data from two independent research sites.  #@NEW_LINE#@#  We used this approach to identify rhythmic transcripts in human liver and lung, including hundreds of drug targets and disease genes.  #@NEW_LINE#@#  Importantly, for many genes, the circadian variation in expression exceeded variation from genetic and other environmental factors.  #@NEW_LINE#@#  We also analyzed hepatocellular carcinoma samples and show these solid tumors maintain circadian function but with aberrant output.  #@NEW_LINE#@#  Finally, to show how this method can catalyze medical translation, we show that dosage time can temporally segregate efficacy from dose-limiting toxicity of streptozocin, a chemotherapeutic drug.  #@NEW_LINE#@#  In sum, these data show the power of CYCLOPS and temporal reconstruction in bridging basic circadian research and clinical medicine.  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
Data generated by a common periodic process have a defined structure.  #@NEW_LINE#@#  Analyzing the yeast cell cycle, Alter, Brown, and Botstein (13) used singular value decomposition to reduce the dimensionality of the data and identify eigengenes, characteristic expression patterns, that span the global expression profiles.  #@NEW_LINE#@#  Alter et al.  #@NEW_LINE#@#  recognized the first eigengenes as out-of-phase sinusoidal oscillations.  #@NEW_LINE#@#  When plotted in expression space, they form an ellipse.  #@NEW_LINE#@#  Importantly, this result is independent of the annotated collection time and can be used to determine the relative order of samples in the dataset (Fig S1).  #@NEW_LINE#@#  
With human data, confounds such as genetic differences, age, gender, exercise, diet, etc., all add significant noise and limit this approach.  #@NEW_LINE#@#  Circadian and noncircadian patterns can be mixed and distributed among the various eigengenes.  #@NEW_LINE#@#  CYCLOPS optimally weights and combines the eigengenes patterns to reveal underlying elliptical structure, and then uses this structure to order the data.  #@NEW_LINE#@#  CYCLOPS couples our prior knowledge of rhythms in model organisms with use of a circular node autoencoder (Fig S1D).  #@NEW_LINE#@#  Autoencoders are feedforward neural networks trained so that the networks output reproduces its input (14).  #@NEW_LINE#@#  By constraining the size of the intervening bottleneck layer, the network is forced to encode the data in a reduced number of dimensions.  #@NEW_LINE#@#  Here, we combine linear encoding and decoding neurons with a circular bottleneck node (15).  #@NEW_LINE#@#  The outputs of the two coupled circular bottleneck nodes represent a single angular phase.  #@NEW_LINE#@#  CYCLOPS linearly projects the data and encodes it on a simple elliptical curve (15).  #@NEW_LINE#@#  In this way, CYCLOPS identifies a closed curve that best represents the characteristic expression patterns.  #@NEW_LINE#@#  An angular phase represents the position of each sample on the ellipse and its temporal phase in the reconstructed periodic cycle.  #@NEW_LINE#@#  Circular autoencoders have been used to generate nonlinear models of periodic processes in nature (16, 17).  #@NEW_LINE#@#  To our knowledge, their use in ordering these data are novel.  #@NEW_LINE#@#  
We first applied CYCLOPS to mouse time course expression data (1, 18).  #@NEW_LINE#@#  With no prior knowledge, CYCLOPS correctly ordered the samples from mouse liver (Fig 1A).  #@NEW_LINE#@#  The circular correlation (c) (19) and the circular rank correlation(c) (19) between the CYCLOPS-estimated phases and true circadian times were both greater than 0.9.  #@NEW_LINE#@#  CYCLOPS also ordered data from other highly rhythmic organs (e.g., lung, kidney, and adrenals) but failed to correctly order data from tissues with weaker circadian signals (e.g., skeletal muscle, cerebellum, and brainstem; Fig S2).  #@NEW_LINE#@#  Reasoning that prior biological knowledge could increase the signal-to-noise ratio and improve ordering, we restricted the analysis to either a list of transcripts that cycled in that tissue or a list of transcripts found to cycle in  greater than 75% of other tissues.  #@NEW_LINE#@#  With this method, CYCLOPS was able to correctly order samples for all mouse tissues (Fig S2).  #@NEW_LINE#@#  
CYCLOPS was developed to analyze data without an annotated order.  #@NEW_LINE#@#  Thus, assessing the quality of CYCLOPS orderings when the true order is unknown is important.  #@NEW_LINE#@#  CYCLOPS computes a quickly interpretable smoothness metric, Metsmooth, and a more computationally intensive error statistic, Staterr, the significance of which is assessed by bootstrap.  #@NEW_LINE#@#  Metsmooth compares the smoothness of the reconstructed circular trajectory in expression space to the smoothness of a linear ordering based on the first principal component.  #@NEW_LINE#@#  Staterr describes the improvement in the residual sum of squares error when encoding the data onto a closed, one-dimensional elliptical manifold compared with the residual error when encoding the data onto a one-dimensional linear manifold.  #@NEW_LINE#@#  In the cases where Metsmooth less_than 1 and Staterr differed from background (P less_than 0.05), the ordering was generally well correlated to ground truth (Fig S2).  #@NEW_LINE#@#  
Next, we applied CYCLOPS to expression data derived from human prefrontal cortex samples obtained at autopsy (10).  #@NEW_LINE#@#  Following the CYCLOPS methodology, we used evolutionary conservation and knowledge of murine rhythms to sharpen the expected circadian signature.  #@NEW_LINE#@#  We restricted the list of transcripts used for temporal reconstruction to human homologs of genes found to cycle in  greater than 75% of mouse tissues.  #@NEW_LINE#@#  CYCLOPS produced a high-quality ordering (Metsmooth less_than 1, P less_than 0.05) that provides an excellent estimate of time of death (TOD) (c = 0.68, c = 0.55, median absolute error = 1.69 h) (Fig 1B).  #@NEW_LINE#@#  When the expression of individual transcripts is plotted as a function of either CYCLOPS phase or TOD (Fig 1C), CHRONO (20) was found to have the strongest circadian cycling.  #@NEW_LINE#@#  Known clock genes NR1D1 and PER3 also showed clear rhythms.  #@NEW_LINE#@#  More generally, transcripts that cycled as a function of TOD also cycled as a function of CYCLOPS phase, whereas nonrhythmic transcripts by TOD were also nonrhythmic by CYCLOPS phase.  #@NEW_LINE#@#  Sinusoidal fits to CYCLOPS phase were slightly better than sinusoidal fits to TOD (Fig 1C).  #@NEW_LINE#@#  We hypothesize that CYCLOPS better accounts for interindividual differences in circadian entrainment to the terrestrial day, for example, due to shift work, biological variation, or the poor entraining conditions of hospitals.  #@NEW_LINE#@#  
Then we applied CYCLOPS to biopsy data describing the normal human pulmonary transcriptome (21).  #@NEW_LINE#@#  Human pulmonary physiology demonstrates clear circadian rhythms.  #@NEW_LINE#@#  However, to our knowledge, molecular rhythms in the human lung remain unexamined.  #@NEW_LINE#@#  We confined the CYCLOPS reconstruction to human homologs of genes that cycle in the mouse lung.  #@NEW_LINE#@#  We independently analyzed data from Groningen and Quebec City (22) and used modified cosinor regression to identify transcripts well described by a sinusoidal function of CYCLOPS phase in both datasets (23) (Dataset S1).  #@NEW_LINE#@#  The phase of peak expression of each transcript was remarkably consistent between research sites (c = 0.66, median absolute discrepancy = 0.32 radians 1.2 h) (Fig 2A).  #@NEW_LINE#@#  Known circadian genes, including CLOCK, CRY1, and CRY2 were periodic with phase relationships similar to those seen in mouse (Fig 2B).  #@NEW_LINE#@#  
Clinically important transcripts also showed strong cycling (Fig 2B and Fig S3).  #@NEW_LINE#@#  For example, ADAM9 is implicated in lung cancer and is a risk marker for distant metastases (24).  #@NEW_LINE#@#  EFNB2, a receptor tyrosine kinase (TK), also cycled strongly and may have prognostic significance in both small cell lung cancer and nonpulmonary cancers (25).  #@NEW_LINE#@#  We used the Drug Signatures Database to identify rhythms in drug targets (Dataset S2) (26).  #@NEW_LINE#@#  Several drug target classes in asthma treatment were rhythmic, including -adrenergic receptors (targeted by -agonists) and glucocorticoid receptors (targeted by inhaled and systemic steroids).  #@NEW_LINE#@#  Various TKs cycled (e.g., MAP4K1, MAP4k3, SLK, FYN, KDR, PKN2, TAOK, and TAOK2).  #@NEW_LINE#@#  Several of these are targeted in the treatment of nonsmall-cell lung cancer and pulmonary fibrosis (22, 27).  #@NEW_LINE#@#  
Drugs used for nonrespiratory conditions that act via the pulmonary system also target rhythmic molecules.  #@NEW_LINE#@#  Angiotensin-converting enzyme (ACE) inhibitors are used in the treatment of hypertension and heart failure.  #@NEW_LINE#@#  Inhibiting ACE reduces the production of the potent vasoconstrictor Angiotensin II (28).  #@NEW_LINE#@#  ACE is predominantly localized to the pulmonary and renal vasculatures and, per CYCLOPS, demonstrates a marked diurnal fluctuation in human lung.  #@NEW_LINE#@#  Night-time dosing of ACE inhibitors improves nocturnal blood pressure control without sacrificing daytime efficacy (29).  #@NEW_LINE#@#  The cycling of pulmonary ACE may provide the underlying molecular mechanism for this findings.  #@NEW_LINE#@#  
To identify biological pathways and processes that show circadian coordination in the human lung, we applied phase set enrichment analysis (PSEA) (30).  #@NEW_LINE#@#  As in the mouse (30), pathways describing cell cycle regulation, adaptive immune function, and channel-mediated transport demonstrate phase-synchronized expression (Fig S4).  #@NEW_LINE#@#  These data are consistent with clinical evidence demonstrating diurnal variation in the symptoms of asthma (31) and the efficacy of cell cycle-targeting chemotherapeutic agents (32).  #@NEW_LINE#@#  The SMAD and TGF- pathways were among those that demonstrated the strongest phase clustering.  #@NEW_LINE#@#  Both have recently been highlighted in the pathogenesis of pulmonary fibrosis and nonsmall cell lung cancer (33, 34).  #@NEW_LINE#@#  
Of note, temporal reconstruction with CYCLOPS did not uniformly distribute samples across the circadian cycle (Fig S5).  #@NEW_LINE#@#  Biopsies are obtained during surgical working hours (6:00 AM to 6:00 PM).  #@NEW_LINE#@#  However, samples obtained from shift workers during the terrestrial day likely provide data describing the circadian night (sleep period).  #@NEW_LINE#@#  The phase distribution of samples is consistent with US data that 1520% of the population are shift workers (35).  #@NEW_LINE#@#  Of course, the effect of shift work on local tissue clocks remains incompletely understood.  #@NEW_LINE#@#  It is possible that circadian perturbations alter local molecular timekeeping in a tissue-dependent manner, resulting in intertissue (36) or intratissue (30) desynchrony.  #@NEW_LINE#@#  
Next, we wanted to examine circadian rhythms in a cancerous and paired normal organ.  #@NEW_LINE#@#  We applied CYCLOPS to expression data from 249 patient biopsies of noncancerous (NC) liver tissue (37).  #@NEW_LINE#@#  The vast majority (n = 243) were of the normal margin adjacent to tumor.  #@NEW_LINE#@#  Using homologs of the transcripts that cycle in the mouse liver (1), CYCLOPS was able to order the samples (Metsmooth less_than 1, P less_than 0.05).  #@NEW_LINE#@#  Core clock components showed similar phase relationships to those observed in mouse (Fig 3A).  #@NEW_LINE#@#  A full list of transcripts and pathways found to cycle in NC human liver are presented in (Datasets S3 and S4).  #@NEW_LINE#@#  Pathways describing metabolism, lipid and cholesterol processing, and cell cycle regulation all demonstrated strong circadian cycling.  #@NEW_LINE#@#  
We used data from biopsies of HCC to explore transcriptional rhythms in an intact solid human tumor (37).  #@NEW_LINE#@#  HCC is the most common primary liver cancer.  #@NEW_LINE#@#  We initially analyzed the HCC data as we did the normal margin data, seeding the ordering on the human homologs of mouse cycling genes (1).  #@NEW_LINE#@#  However, we were not able to generate a quality ordering in this way.  #@NEW_LINE#@#  We reasoned that HCC might compromise clock function or that the increased interindividual variation between neoplastic samples may have confounded CYCLOPS.  #@NEW_LINE#@#  To reduce the influence of neoplastic variability and emphasize circadian variation, HCC expression data were projected onto the eigenvectors established by the NC samples.  #@NEW_LINE#@#  Applying CYCLOPS to these data produced a high-quality fit (P less_than 0.05).  #@NEW_LINE#@#  We then used cosinor regression analysis to identify cycling transcripts.  #@NEW_LINE#@#  
Surprisingly, most core clock components continued to cycle in HCC samples.  #@NEW_LINE#@#  Notable exceptions were PER1 and CRY1 (Fig S6).  #@NEW_LINE#@#  Nearly one-half of the genes cycling in NC samples were not well fit by cosinor regression in the HCC data.  #@NEW_LINE#@#  Again, we wondered whether this might reflect increased noise among HCC samples rather than a true change in circadian expression.  #@NEW_LINE#@#  We used a nested modeling approach to better distinguish these possibilities.  #@NEW_LINE#@#  Pooled, ordered expression data from both HCC and NC samples were first fit with a single (sinusoidal) model.  #@NEW_LINE#@#  We then tested whether adding additional sinusoidal terms dependent on histological status significantly improved fit.  #@NEW_LINE#@#  The combined modeling framework allowed us to identify transcripts that cycled in NC samples but (i) were not well fit by a sinusoidal function when HCC samples were fit in isolation, (ii) were significantly better fit by a nested model with different circadian parameters for HCC and NC samples, and (iii) had at least a twofold reduction in amplitude among HCC samples in the pooled model (Fig 3 B and C).  #@NEW_LINE#@#  Based on these combined criteria, we estimate that 15% of the transcripts that cycled in NC samples lost rhythmic expression in HCC.  #@NEW_LINE#@#  
Using DAVID (38), we identified pathways overrepresented among genes that lost rhythmicity in HCC.  #@NEW_LINE#@#  In a related analysis, we ranked all circadian genes in NC samples by the reduction of their amplitude in HCC.  #@NEW_LINE#@#  The ranked list was analyzed with gene set enrichment analysis (GSEA) (39).  #@NEW_LINE#@#  Reassuringly, these analyses yielded overlapping results (Table S1).  #@NEW_LINE#@#  There was temporal deregulation of key circadian outputs including overlapping apoptotic pathways and JAKSTAT signaling.  #@NEW_LINE#@#  We also find evidence for reduced cycling among transcripts related to hypoxia and redox metabolism.  #@NEW_LINE#@#  Of note was loss of rhythmicity in TKs targeted by several latest-generation antineoplastic agents.  #@NEW_LINE#@#  Also notable was a loss of cycling in ARNTL2, which has been implicated in several neoplastic diseases (40, 41).  #@NEW_LINE#@#  
Chronotherapy is an immediate area of interest for clinical translation.  #@NEW_LINE#@#  Earlier, we proposed that drugs that target rhythmic, high-amplitude gene products represent a path for mechanism-driven chronotherapy.  #@NEW_LINE#@#  With CYCLOPS, we can now identify drug targets that oscillate in humans.  #@NEW_LINE#@#  Among the many transcripts with high-amplitude oscillations in normal human liver was SLC2A2 (Fig 4A).  #@NEW_LINE#@#  Murine Slc2a2 cycles with similar temporal phasing in both the liver and kidney (1).  #@NEW_LINE#@#  SLC2A2 encodes GLUT2, a glucose transporter highly expressed in pancreas, liver, and kidney.  #@NEW_LINE#@#  STZ is a GLUT2 substrate and is standard of care in patients with locally advanced pancreatic neuroendocrine tumors (pNETs) (42).  #@NEW_LINE#@#  Although pNETS are rare, the incidence has nearly doubled in the last decades (43).  #@NEW_LINE#@#  STZ is cytotoxic to GLUT2-expressing cells, including islet cells and pNETS, with renal and hepatic toxicity being dose-limiting and potentially lethal (42).  #@NEW_LINE#@#  
As STZ has a remarkably short half-life (less_than15 min), it is an excellent candidate for chronotherapy.  #@NEW_LINE#@#  We reasoned dosing STZ during the nadir of hepatic SLC2A2 abundance could preserve STZ efficacy while minimizing renal and hepatic toxicity.  #@NEW_LINE#@#  The same dose of STZ was administered in the morning [Zeitgeber time (ZT) 0] or evening (ZT 12) to DBA/2J mice (44) for 5 consecutive days.  #@NEW_LINE#@#  We measured blood glucose levels as a surrogate marker for the efficacy of STZ in killing islet cells.  #@NEW_LINE#@#  Body weight was used as a simple measure of animal health and gross toxicity.  #@NEW_LINE#@#  Mice treated with STZ at either time were equally susceptible to hyperglycemia (Fig 4B).  #@NEW_LINE#@#  However, mice administered STZ in the morning, when Slc2a2 transcript expression is low and GLUT2 protein abundance is high (1, 45), had a much greater loss in body mass compared with mice receiving STZ in the evening (19.8 g vs. 12.9 g, P = 0.015).  #@NEW_LINE#@#  Thus, we temporally separated apparent efficacy (hyperglycemia) from toxicity (loss of body weight).  #@NEW_LINE#@#  

Discussion  #@NEW_LINE#@#  
Much of the molecular mechanics underlying circadian rhythms has been revealed in the last two decades.  #@NEW_LINE#@#  Much less progress has been made in converting these findings into actionable clinical knowledge.  #@NEW_LINE#@#  The lack of human time course data has presented a key barrier to translation.  #@NEW_LINE#@#  CYCLOPS aims to address this deficiency, using global descriptors of gene expression, evolutionary conservation, and machine learning to order unordered data within a periodic cycle.  #@NEW_LINE#@#  CYCLOPS builds on the foundation of Alter et al.  #@NEW_LINE#@#  (13) and the computational structure of Kirby and Miranda (15) to order high-throughput data and identify latent periodic oscillations in transcription.  #@NEW_LINE#@#  We validated CYCLOPS using ordered mouse and human data.  #@NEW_LINE#@#  We also demonstrated the consistency of CYCLOPS using human lung data from two distinct patient populations on separate continents.  #@NEW_LINE#@#  
CYCLOPS has advantages and disadvantages compared with existing methods.  #@NEW_LINE#@#  Supervised methods (e.g., ZeitZeiger) continue to improve but require time course training data.  #@NEW_LINE#@#  Obtaining blood and skin samples is straightforward.  #@NEW_LINE#@#  Serial biopsies of internal human organs are not practical.  #@NEW_LINE#@#  Unsupervised methods, like Oscope, have recovered cell cycle rhythms from unordered single-cell data.  #@NEW_LINE#@#  However, Oscope works on the single transcript level and requires thousands more computations than does CYCLOPS.  #@NEW_LINE#@#  Furthermore, Oscope is highly sensitive to the intersubject variability inherent to human data.  #@NEW_LINE#@#  Supervised methods are tissue specific and are similarly sensitive to biologic variability (as might be expected in cancer), as they have been optimized to use only a small number of highly informative transcripts.  #@NEW_LINE#@#  CYCLOPS uses global descriptors of expression structure, making it both robust and efficient for population-based human data.  #@NEW_LINE#@#  However, as with other high-dimensional bioinformatics methods, the particular data normalization scheme and descriptors of expression structure used can influence the final results.  #@NEW_LINE#@#  
CYCLOPS also has several limitations.  #@NEW_LINE#@#  It requires data from the entire periodic cycle to form an ellipse.  #@NEW_LINE#@#  Biopsies are almost exclusively obtained during the day.  #@NEW_LINE#@#  A large patient population, including shift workers, is necessary to fill in underrepresented times of day.  #@NEW_LINE#@#  Our experience suggests that  greater than 250 samples are required to order biopsy samples (Table S2).  #@NEW_LINE#@#  We also leveraged evolutionary conservation and mouse data to focus the genes used for human temporal reconstruction.  #@NEW_LINE#@#  CYCLOPS does not require that rhythms in mice and men are identical but does assume that the human homologs of mouse cycling genes are more likely to cycle.  #@NEW_LINE#@#  Importantly, CYCLOPS identifies features that are consistent with oscillations with respect to a latent variable, assumed to be time.  #@NEW_LINE#@#  Several findings lend confidence to our reconstructions.  #@NEW_LINE#@#  First, we recovered oscillations consistent with known circadian biology (e.g., phase relationships of core clock genes).  #@NEW_LINE#@#  We also recovered sample collection phases consistent with biopsy collection times and smooth orderings that well explain the data.  #@NEW_LINE#@#  CYCLOPS orderings are also relative.  #@NEW_LINE#@#  Additional information is needed to assign a circadian time to any particular CYCLOPS phase.  #@NEW_LINE#@#  In ordering the human lung and liver transcriptomes, we used the average acrophase of the PAR bZip transcription factors to fix time .  #@NEW_LINE#@#  In the lung and liver of nocturnal mice, these factors show peak expression near ZT12 (1), the beginning of the peak activity period.  #@NEW_LINE#@#  
Circadian rhythms persist in the absence of environmental cues.  #@NEW_LINE#@#  The observation of rhythms under normal conditions is not sufficient to classify a rhythm as circadian.  #@NEW_LINE#@#  Pending further study, the human transcriptional oscillations identified by CYCLOPS are more properly labeled as diurnal.  #@NEW_LINE#@#  
A final caveat lies in the identification of periodic transcripts from CYCLOPS-ordered data.  #@NEW_LINE#@#  Regression and other rhythm detection methods are predicated on time as a variable independent of expression.  #@NEW_LINE#@#  CYCLOPS phases are derived from gene expression.  #@NEW_LINE#@#  As a result, standard statistical significance tests tend to be too liberal.  #@NEW_LINE#@#  To mitigate this concern, we have imposed an unusually strict numerical cutoff for statistical significance.  #@NEW_LINE#@#  We also require cycling with sufficient amplitude to suggest physiologic importance.  #@NEW_LINE#@#  
Despite these limitations, we have successfully used CYCLOPS to explore diurnal rhythms in human lung, liver, and HCC.  #@NEW_LINE#@#  Our analyses of normal lung and liver present clear translational opportunities.  #@NEW_LINE#@#  We found strong circadian cycling of the cell cycle and immune pathways in human lung.  #@NEW_LINE#@#  ACE, well expressed in the pulmonary vasculature and a key drug target for hypertension, appeared rhythmic.  #@NEW_LINE#@#  We also found cycling in members of the SMADs and the JAKSTAT pathways along with various TKs, many of which are important targets in idiopathic pulmonary fibrosis.  #@NEW_LINE#@#  
In liver, PPARA, DDC, and XDH, targets of the fibrates, dopamine decarboxylase inhibitors, and xanthine oxidase inhibitors, respectively, all display high-amplitude rhythms (Fig S7).  #@NEW_LINE#@#  SLC2A2, the target of STZ, also displayed strong cycling in human liver.  #@NEW_LINE#@#  In a proof-of-concept experiment, we leveraged these data to time STZ administration and segregate gross toxicity from efficacy.  #@NEW_LINE#@#  In sum, this approach presents a straightforward path from genome-scale human data to hypothesis-driven opportunities in chronotherapy.  #@NEW_LINE#@#  
An important aspect of chronotherapy is the accurate circadian assessment or phasing individual patients.  #@NEW_LINE#@#  However, how accurate must this be?  #@NEW_LINE#@#  The answer likely depends on the kinetics of the drug and the dynamics of its target.  #@NEW_LINE#@#  For STZ and other fast-acting drugs that target molecules with high-amplitude rhythms, there may be a broad window of acceptable dosing times.  #@NEW_LINE#@#  For other drugs, more temporal precision might be required.  #@NEW_LINE#@#  
CYCLOPS is an algorithm that temporally reconstructs population-based human organ data.  #@NEW_LINE#@#  Applying CYCLOPS to over 2,000 human samples, we observe clear, high-amplitude molecular rhythms in lung, liver, brain, and HCC.  #@NEW_LINE#@#  Despite disparities in patient age, gender, genetics, diet, and environment, CYCLOPS extracted significant periodic signatures.  #@NEW_LINE#@#  For a large subset of genes, circadian variability in expression was larger than the variability attributable to these aggregated genetic and environmental variables.  #@NEW_LINE#@#  By implication, circadian control may offer a powerful tool for precision medicine.  #@NEW_LINE#@#  
Finally, we investigated the state of circadian rhythms in a human cancer, HCC.  #@NEW_LINE#@#  The circadian clock is believed to gate the cell cycle.  #@NEW_LINE#@#  In HCC, we find that, despite continued oscillator function, there is circadian deregulation of JAKSTAT, apoptotic, and metabolic pathways.  #@NEW_LINE#@#  To catalyze the further pursuit of translational chronobiology, we have posted the CYCLOPS program and associated scripts on GitHub.  #@NEW_LINE#@#  We hope this and related approaches will propel investigation into the role of circadian biology in clinical medicine.  #@NEW_LINE#@#  

Methods  #@NEW_LINE#@#  
All animal studies were done under Charles River Laboratories study number 20091523 under Institutional Animal Care and Use Committee protocol P01182016A.  #@NEW_LINE#@#  
Microarray_Processing  #@NEW_LINE#@#  
CEL files containing raw data were downloaded from NIH GEO and processed with RMA in R (version 3.2.3) Bioconductor.  #@NEW_LINE#@#  

Computational_Methods  #@NEW_LINE#@#  
The CYCLOPS autoencoder and downstream analysis were implemented in Julia 0.3.10.  #@NEW_LINE#@#  The associated files are available for download on GitHub.  #@NEW_LINE#@#  

Data_Scaling_and_Normalization  #@NEW_LINE#@#  
For temporal reconstruction, we first restricted the list of probes used to the top 10,000 highest expressed probes (as sorted by mean probe value).  #@NEW_LINE#@#  For each probe, we impute extreme expression values at the top/bottom 2.5th percentile.  #@NEW_LINE#@#  The expression Xi,j of each probe i in sample j was scaled as follows:Si,j=(Xi,jMi,j)Mi,  #@NEW_LINE#@#  
where Mi is the mean expression of probe i across samples: Mi=(1/Nj)jXi,j.  #@NEW_LINE#@#  
The Si,j data were expressed in eigengene coordinates Ei,j following the methods of Alter et al.  #@NEW_LINE#@#  The number of eigengenes NE (singular values) retained was set so as to preserve 85% of the variance of the data.  #@NEW_LINE#@#  The autoencoder was applied to these characteristic expression patterns for the purposes of temporal reconstruction.  #@NEW_LINE#@#  

CYCLOPS_Autoencoder  #@NEW_LINE#@#  
The activated value of neuron j in layer l is denoted by ajl and for linear neurons is given by ajl=kwj,klakl1+bjl, where weight from the kth neuron in layer l  1 to the jth neuron in layer l is represented by wj,kl.  #@NEW_LINE#@#  The bias in jth neuron in layer l is denoted bjl (46).  #@NEW_LINE#@#  
A single, circular node was used in the bottleneck layer.  #@NEW_LINE#@#  The single circular neuron was implemented as two coupled neurons (15).  #@NEW_LINE#@#  The preactivation values of these neurons ojl and oj*l are given by the following:ojl=kwj,klakl1+bjloj*l=kwj*,klakl1+bj*l.  #@NEW_LINE#@#  
Activated values are obtained by mapping these onto the unit circle:ajl=ojl(ojl)2+(oj*l)2aj*l=oj*l(ojl)2+(oj*l)2,  #@NEW_LINE#@#  
with phasej=tan1(aj*lajl).  #@NEW_LINE#@#  
NE linear neurons were used in both the encoding and decoding steps.  #@NEW_LINE#@#  The autoencoder was trained by backpropagation using stochastic batch gradient descent with momentum (46).  #@NEW_LINE#@#  Default training parameters were set as set batch size = 10, rate = 0.3, and momentum = 0.5.  #@NEW_LINE#@#  
Training is repeated multiple times (default = 40) starting at different, randomly set initial weighting conditions.  #@NEW_LINE#@#  The result with minimal sum of squares output error is used.  #@NEW_LINE#@#  
The fully trained autoencoder was used to encode the characteristic expression data Ei,j.  #@NEW_LINE#@#  The value of the circular node assigned each sample j (j) was the phase assigned to that sample.  #@NEW_LINE#@#  
The same autoencoder training parameters were used for all reconstructions.  #@NEW_LINE#@#  
Additional methodological details can be found in SI Methods.  #@NEW_LINE#@#  


SI_Methods  #@NEW_LINE#@#  
CYCLOPS_Quality_Metrics  #@NEW_LINE#@#  
Two metrics were used to assess the quality of the CYCLOPS ordering.  #@NEW_LINE#@#  
Staterr compares the total sum of squares error of the circular autoencoder in reconstructing characteristic expression patterns with the residual variance/error unexplained by the first principal component.  #@NEW_LINE#@#  The first principal component analytically reproduces the results of a fully linear autoencoder with a single bottleneck node (47).  #@NEW_LINE#@#  Thus, Staterr compares the improvement in model fit when a circular rather than linear bottleneck node is used.  #@NEW_LINE#@#  Staterr mirrors the definition of the F statistic in nested regression models used to evaluate the inclusion of additional parameters with increasing model complexity.  #@NEW_LINE#@#  Defining Circerr as the autoencoder reconstruction error and Linerr as the variance remaining unexplained by the first principal component:Circerr=j=1NSampi=1NE(Ei,jaioutput)2,Staterr=(LinerrCircerr)/Circerr.Metsmooth is a measure of the smoothness of the ordered expression trajectory.  #@NEW_LINE#@#  It compares the mean distance, in expression space, between sequential samples when using a circular ordering to the distance between sequential samples assuming a linear ordering.  #@NEW_LINE#@#  Given the samples j and associated CYCLOPS phases (0j2), we create circular ordering c, which is a permutation of the indexes j such that cless_thanc+1 for all c. Similarly, we define a linear ordering l based on the magnitude of the first eigengene so that E1,lless_thanE1,l+1 for all l. Denoting  as the Euclidean norm and the Ej as the eigengenes expression profile of sample j:Circsmooth=1/Nsamp(c=1Nsamp1Ec+1Ec+ENE1),Linsmooth=1(Nsamp1)l=1Nsamp1El+1El,Metsmooth=Circsmooth/Linsmooth.  #@NEW_LINE#@#  

Evaluating_Significance_of_Error_Metric  #@NEW_LINE#@#  
The significance of Staterr was assessed by bootstrap.  #@NEW_LINE#@#  To create a background distribution for Staterr, each row i of Si,j was independently permuted.  #@NEW_LINE#@#  This removed any fixed phase relationship between the probes while maintaining their marginal distributions.  #@NEW_LINE#@#  These data were then expressed NE eigengenes and the CYCLOPS autoencoder was retrained and the error metric recomputed.  #@NEW_LINE#@#  This process is repeated to create a background distribution used to assess the significance of Staterr.  #@NEW_LINE#@#  

Identification_of_Seed_Genes_by_Homology  #@NEW_LINE#@#  
To identify genes that are more likely to cycle in a specified human tissue, we use the data of Zhang et al.  #@NEW_LINE#@#  (1) and identified genes with cycling expression using JTK-Cycle (48) (value of q less_than 0.05).  #@NEW_LINE#@#  The gene identifiers were matched to their human homolog using Homologene.  #@NEW_LINE#@#  

Modified_Cosinor_Regression  #@NEW_LINE#@#  
Cosinor regression has long been used to identify circadian processes (23).  #@NEW_LINE#@#  The datasets typically analyzed in this way include more than a single cycle so that monotonic expression patterns are not misidentified as circadian.  #@NEW_LINE#@#  CYCLOPS, however, assigns each sample a phase along a single reconstructed cycle (0j2).  #@NEW_LINE#@#  
To better exclude monotonic trends, we compared the fit of a best-fit line with the fit of nested model including both that line and sinusoidal functions of CYCLOPS phase.  #@NEW_LINE#@#  
For each probe (i), we fit the data to two models:Xi,j=li(ji)+ci+i,[M1]Xi,j=li(ji)+aicos(j)+bisin(j)+ci+i.  #@NEW_LINE#@#  [M2]The i are first optimized in M1 by a brute-force search.  #@NEW_LINE#@#  The F test is used to evaluate the null hypothesis ai=bi= 0.  #@NEW_LINE#@#  
The amplitude and acrophase of each probe are given by (ai2+bi2) and tan1(bi/ai) using the standard regression model Xi,j=aicos(i)+bisin(i)+ci+i.  #@NEW_LINE#@#  

Identification_of_Probes_That_Lost_Cycling_in_HCC  #@NEW_LINE#@#  
Given the CYCLOPS-ordered expression data from NC and HCC samples, we first used modified cosinor regression to identify the set of probes that appeared to cycle in NC data (Bonferroni-corrected P value less_than 0.05, amplitude  greater than  33% mean expression) but not in HCC data.  #@NEW_LINE#@#  
We then sought to identify probes for which there appeared to be a change in circadian expression rather than an increase in noncircadian noise.  #@NEW_LINE#@#  For each probe identified above, we then pooled the NC and HCC data and corresponding phase assignments and fit the data with two nested models:Xi,jpool=aicos(j)+bisin(j)+ci+Ici+i,[MPool1]Xi,jpool=aicos(j)+bisin(j)+ci+Ici+Iaicos(j)+Ibisin(j)+i,[MPool2]where I is an indicator variable equal to 0 for NC sample and 1 for HCC samples.  #@NEW_LINE#@#  
An F test is used to evaluate the null hypothesis ai=bi= 0.  #@NEW_LINE#@#  We restricted our results to probes for which the Bonferroni-corrected P value less_than 0.05.  #@NEW_LINE#@#  
Finally, we compared the amplitude for NC samples (ai2+bi2) and HCC samples (ai+ai)2+(bi+bi)2 from Eq.  #@NEW_LINE#@#  MPool2 and further restricted our list to those probes that had a more than twofold reduction in normalized amplitude.  #@NEW_LINE#@#  

Set_Pathway_Level_Analysis  #@NEW_LINE#@#  
PSEA was applied to reconstructed pulmonary and liver expression data as previously described (30).  #@NEW_LINE#@#  The JAVA application was downloaded from GitHub and default application settings were used.  #@NEW_LINE#@#  The Canonical Pathways Gene sets (CP) were downloaded from the molecular signatures database (49).  #@NEW_LINE#@#  
GSEA was used to identify pathways enriched for amplitude loss in HCC (39).  #@NEW_LINE#@#  We analyzed all probes that were found to cycle in NC samples (as described above) and ranked them by the change in amplitude in HCC compared with NC samples as assessed by Eq.  #@NEW_LINE#@#  MPool2.  #@NEW_LINE#@#  The JAVA version of GSEA (version 1.0) was used to test the Hallmark Pathways using the Pre-ranked analysis function and the classic enrichment statistic.  #@NEW_LINE#@#  
The NIH David web application (version 6.8) was used to evaluate the list of probes that lost cycling as described above (38).  #@NEW_LINE#@#  To mirror GSEA and PSEA results, the search for overrepresented pathways was limited to KEGG, REACTOME, and Gene Ontology (GO) Biological Process (BP) gene sets.  #@NEW_LINE#@#  This full list of genes that cycled in the NC liver were used as a custom background.  #@NEW_LINE#@#  

STZ_Experiments  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
We thank Gang Wu, Robert Schmidt, and Marc Ruben for their critical reading of the manuscript and testing of the CYCLOPS program.  #@NEW_LINE#@#  We are grateful to researchers who generated the original datasets.  #@NEW_LINE#@#  This work is supported by Defense Advanced Research Projects Agency Grants D17AP00003 (to R.C.A.)  #@NEW_LINE#@#  and in part by D12AP00025, National Institute of Neurological Disorders and Stroke Grant 5R01NS054794-08 (to J.B.H.  #@NEW_LINE#@#  ), in part by National Institute on Aging Grant 2P01AG017628-11, and the Penn Genome Frontiers Institute under a Health Research Formula Fund grant with the Pennsylvania Department of Health.  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  




