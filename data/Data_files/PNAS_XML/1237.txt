article id="http://dx.doi.org/10.1073/pnas.1721628115"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Digitizing omics profiles by divergence from a baseline  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
Technological advances enable increasingly comprehensive profiling of the molecular landscapes of cells, and these data can inform the personalized treatment of complex diseases.  #@NEW_LINE#@#  Two major obstacles are the complexity of these data and the high degree of person-to-person heterogeneity.  #@NEW_LINE#@#  We develop a highly simplified, personalized data representation by comparing the profile of an individual to the range of landscapes in a baseline population, thereby mimicking basic clinical diagnostic testing for departures of selected variables from normal levels.  #@NEW_LINE#@#  Moreover, our method can be applied to any data modality and at any level of granularity, from single features to any subset of features treated as a single entity, for example the gene expression levels in a pathway.  #@NEW_LINE#@#  Experiments involve both healthy human tissues and various cancer subtypes.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Data collected from omics technologies have revealed pervasive heterogeneity and stochasticity of molecular states within and between phenotypes.  #@NEW_LINE#@#  A prominent example of such heterogeneity occurs between genome-wide mRNA, microRNA, and methylation profiles from one individual tumor to another, even within a cancer subtype.  #@NEW_LINE#@#  However, current methods in bioinformatics, such as detecting differentially expressed genes or CpG sites, are population-based and therefore do not effectively model intersample diversity.  #@NEW_LINE#@#  Here we introduce a unified theory to quantify sample-level heterogeneity that is applicable to a single omics profile.  #@NEW_LINE#@#  Specifically, we simplify an omics profile to a digital representation based on the omics profiles from a set of samples from a reference or baseline population (e.g., normal tissues).  #@NEW_LINE#@#  The state of any subprofile (e.g., expression vector for a subset of genes) is said to be divergent if it lies outside the estimated support of the baseline distribution and is consequently interpreted as dysregulated relative to that baseline.  #@NEW_LINE#@#  We focus on two cases: single features (e.g., individual genes) and distinguished subsets (e.g., regulatory pathways).  #@NEW_LINE#@#  Notably, since the divergence analysis is at the individual sample level, dysregulation can be analyzed probabilistically; for example, one can estimate the probability that a gene or pathway is divergent in some population.  #@NEW_LINE#@#  Finally, the reduction in complexity facilitates a more personalized and biologically interpretable analysis of variation, as illustrated by experiments involving tissue characterization, disease detection and progression, and diseasepathway associations.  #@NEW_LINE#@#  

Methods  #@NEW_LINE#@#  
The notion of divergence is general: Let U be a random variable assuming values in a space U and let P0 be a reference or baseline distribution on U with support (P0)U.  #@NEW_LINE#@#  Then a value uU is divergent if (P0).  #@NEW_LINE#@#  By definition, if U has distribution P0, then the probability of observing a divergent value is zero; the interest is in quantizing U when it follows alternative distributions and to compare quantized values among alternatives.  #@NEW_LINE#@#  We are going to apply this to functions U constructed from rank-normalized individual omics profiles.  #@NEW_LINE#@#  The supports will be estimated from data.  #@NEW_LINE#@#  
An omics profile is a vector X=(Xj,jJ) where the index set J and the values assumed by individual features Xj depend on the particular data modality determined by the measurement technology.  #@NEW_LINE#@#  Typically, the features are states, counts, or concentrations of biomolecular species.  #@NEW_LINE#@#  In this paper, we consider gene expression (microarray and RNA-sequencing) and DNA methylation (microarray).  #@NEW_LINE#@#  This framework is directly applicable to other types of measurements, including single-cell data and other omics modalities (e.g., microRNA and protein expression).  #@NEW_LINE#@#  Here, for gene expression, J is the set of genes and Xj is either a microarray value or RNA-seq count for gene j (bulk mRNA); in the case of methylation, J is a set of CpG sites and Xj is the  value (see SI Appendix).  #@NEW_LINE#@#  
Quantiles  #@NEW_LINE#@#  
In our experiments, each individual profile is transformed into quantile space: Each element of the profile is replaced by its normalized rank with respect to the other elements in the same profile.  #@NEW_LINE#@#  DefineQj=Qj(X)=|{iJ:0less_thanXiXj}||{iJ:0less_thanXi}|.  #@NEW_LINE#@#  [1]This definition returns a value 0Qj1 and implies a separate treatment of ties at 0 (e.g., nonexpressed genes).  #@NEW_LINE#@#  If Xj=0, then Qj=0, and positive quantiles are accrued only from positive Xjs.  #@NEW_LINE#@#  This is important for some data modalities, especially gene expression from RNA-seq, for which the many ties that typically occur at 0 may offset standard definitions of quantiles, assigning large quantile values to possibly small, nonzero, expression numbers.  #@NEW_LINE#@#  Importantly, this definition of quantiles is sample-based (i.e., they are computed across variables measured for a single subject), not population- or cohort-based.  #@NEW_LINE#@#  

Divergence  #@NEW_LINE#@#  
Suppose we are given a reference joint probability distribution P0 of (Xj,jJ) associated with some baseline phenotype.  #@NEW_LINE#@#  Of course, in practice, we only observe samples from this distribution where each sample is an omics profile from a single data modality, and the choice of reference phenotype depends on the particular study and data modality.  #@NEW_LINE#@#  As will be seen in Results, the baseline phenotype need not be a single tissue type or a disease-free phenotype and can be any population that is meaningful under the analysis carried out.  #@NEW_LINE#@#  
Given an omics profile X and a subset SJ, we will apply the definition of divergence to the random vector US=QS(X)=(Qj(X),jS).  #@NEW_LINE#@#  We will focus on single features S={j} (e.g., single genes) and on sets S with 1|S||J| (e.g., gene pathways).  #@NEW_LINE#@#  Let m=|S|, so that US takes values in [0,1]m. We describe below how the support U0S[0,1]m of US can be estimated from the data, resulting in a set U^0S that is explicitly defined.  #@NEW_LINE#@#  When presented with a new sample X, we define a binary variable byZ={1ifQS(X)U^0S,0otherwise.We will then say that the set S is divergent (for the considered sample) if and only if Z=1.  #@NEW_LINE#@#  

Support_Estimation  #@NEW_LINE#@#  
The support of the random vector US=QS(X) under P0 is estimated by a covering of the observed baseline samples.  #@NEW_LINE#@#  Covering methods for the estimation of the support of a multivariate density were introduced in ref.  #@NEW_LINE#@#  13, with a goal similar to ours of detecting abnormal behavior.  #@NEW_LINE#@#  The estimator U^0S that we propose is a variation of the one proposed in that paper.  #@NEW_LINE#@#  Let d be a metric on [0,1]m (we will use the Euclidean distance).  #@NEW_LINE#@#  Assume that n0 independent and identically distributed (i.i.d.)  #@NEW_LINE#@#  samples of X are observed under P0, resulting in i.i.d.  #@NEW_LINE#@#  samples US(1),,US(n0); these are now n0 points in [0,1]m. We will define an increasing sequence of empirical supports indexed by a smoothing parameter [0,1]; the determination of  is described later.  #@NEW_LINE#@#  Let l=l()=[n0], the greatest integer less than or equal to n0.  #@NEW_LINE#@#  For each k{1,,n0}, let rk denote the distance between US(k) and its lth nearest neighbor.  #@NEW_LINE#@#  We defineU^0S=[0,1]mk=1n0B(US(k),rk),[2]where B(US(k),rk) denotes the closed ball of center US(k) and radius rk.  #@NEW_LINE#@#  In other terms, a point u[0,1]m belongs to U^0S if and only if there exists k{1,,n0} such that US(k) is closer to u than to its lth nearest neighbor.  #@NEW_LINE#@#  The smoothing parameter  corresponds to the bandwidth in multivariate density estimation (14), and our estimator, based on nearest neighbor distances, implements what is commonly referred as an adaptive bandwidth method in this literature.  #@NEW_LINE#@#  
The estimate of the support in Eq.  #@NEW_LINE#@#  2 is very conservative: Every subprofile S is nondivergent for every sample from the baseline population.  #@NEW_LINE#@#  This is unrealistic, not only in view of possible outliers among the baseline samples, but also because these baseline samples may in fact contain a small proportion of nonbaseline cell types.  #@NEW_LINE#@#  Another drawback is that  is yet to be specified.  #@NEW_LINE#@#  We address these two issues simultaneously.  #@NEW_LINE#@#  Again, let r1,,rn0 be the radii of the balls centered at baseline samples.  #@NEW_LINE#@#  Now let r¯ be the 95th percentile of these radii.  #@NEW_LINE#@#  Instead of covering all of the baseline samples, we remove the 5% for which rkr¯ before computing the support.  #@NEW_LINE#@#  That is, the support is constructed as in Eq.  #@NEW_LINE#@#  2 but with the union over all k=1,,n0 replaced by the union over {k:rkr¯}.  #@NEW_LINE#@#  Notice that some left-out samples may still lie in the support, but in general some will not, and therefore, some features will be declared divergent for some baseline samples.  #@NEW_LINE#@#  The smaller is , the more baseline divergence.  #@NEW_LINE#@#  
For m=1, say S={j}, the estimated support is simply a union of intervals centered at the quantile values of a subset of baseline samples with interval lengths determined by .  #@NEW_LINE#@#  In nearly all cases of interest, this union is itself an interval; that is, there are no gaps.  #@NEW_LINE#@#  Making this assumption (or replacing the support by its convex hull), it suffices to compute its upper and lower bounds.  #@NEW_LINE#@#  This can be done by first computing the smallest and largest values among the (retained) baseline samples Uj(k) for rkr¯, denoted respectively by mj and Mj, and then estimating the baseline support of feature j by U^0j=[lj0,uj0][0,1], where lj0=max(0,mjd1) [respectively, uj0=min(1,Mj+d2)] and d1 (respectively, d2) is the distance from the smallest sample (respectively, the largest) to its lth nearest neighbor among the retained baseline samples.  #@NEW_LINE#@#  
An example of the estimated support for two genes (|S|=2) and =.1 is shown in Fig 1.  #@NEW_LINE#@#  The data are gene expression values for 50 samples of normal breast tissue, and the two genesERP1 and BIRC5are clearly correlated.  #@NEW_LINE#@#  Since there are n0=50 normal samples, the estimated support is the union of 47 disks, where the radius of the disk centered at each pair of quantile values is the Euclidean distance to its fifth nearest neighbor ([.1(50)]=5).  #@NEW_LINE#@#  The extent of coverage obviously depends on .  #@NEW_LINE#@#  
We will apply the definition of divergence in two scenarios: (i) All single features are considered, so divergence is determined for S={j} for every jJ; (ii) divergence is applied to collections of sets S1,,SNfor example, pathways or functional gene sets (FGSs)where the sets may be overlapping and of different dimensions.  #@NEW_LINE#@#  In our experiments, we use FGSs retrieved from the Broad Institute Molecular Signature Database (MSigDB) (15).  #@NEW_LINE#@#  The divergent set is denoted by (X)={j:Zj0}, where J in case i and {1,,N} in case ii.  #@NEW_LINE#@#  In all cases,  is a random setthat is, is sample-dependent.  #@NEW_LINE#@#  For single features, where the supports are intervals [lj0,uj0], the definition can be refined:Zj={1,ifQj(X)less_thanlj01,ifQj(X)uj00,otherwise.We will then say that j is lower divergent if Zj=1 and upper divergent if Zj=1, and let l(X)={j:Zj=1} and u(X)={j:Zj=1} denote the set of lower divergent and upper divergent features.  #@NEW_LINE#@#  

Parameters  #@NEW_LINE#@#  
Returning to the choice of , a natural way to control the level of baseline divergence is to limit on the average fraction  of divergent features in the baseline population, namely E0(||M), where M=|J| for single features and M=N for a family of N subsets.  #@NEW_LINE#@#  We then select the smallest , which achieves this fraction , where the same  is used for every support estimator.  #@NEW_LINE#@#  Therefore, once  is fixed, there are no other parameters to specify.  #@NEW_LINE#@#  This is because  determines  and  determines the radii r1,,rn0, which in turn determine the estimated supports.  #@NEW_LINE#@#  In our experiments with single-feature divergence, we select .01; with functional gene sets, we take either =.01 or =.001 (see Results).  #@NEW_LINE#@#  


Results  #@NEW_LINE#@#  
Divergence_of_Tumor_Profiles_from_a_Normal_Baseline  #@NEW_LINE#@#  
We measured ||, the degree of divergence, for single features in gene expression (microarray and RNA-seq) and DNA methylation profiles of tumor samples from various tissues, using the corresponding normal counterpart as the baseline.  #@NEW_LINE#@#  We also measured || at the gene set level using data from The Cancer Genome Atlas (TCGA) (16) and the MSigDB Hallmark FGS collection; again, the baseline is normal tissue.  #@NEW_LINE#@#  As described in Methods, for any given sample profile, a set of features S is defined as divergent if the assumed quantile value(s) fall outside the estimated baseline support.  #@NEW_LINE#@#  
In measuring the extent of divergence in tumor samples, for each tissue and omics data type, half of the available normal samples were randomly selected to estimate the baseline support.  #@NEW_LINE#@#  Then divergence was determined for the left-out normal and all tumor samples (see SI Appendix, Methods for details).  #@NEW_LINE#@#  
Overall, for single features, typically thousands are divergent in tumors for both gene expression and DNA methylation, irrespective of the platform used to generate the data and the tissue type.  #@NEW_LINE#@#  In all cases, the difference in the level of divergence between normal and tumor samples in each tissue and platform cohort is highly significant (Wilcoxon P value less_than 106; see Fig 2).  #@NEW_LINE#@#  In fact, the differences in || are sufficiently large to allow for near-perfect separation without even taking into consideration the identity of the features in .  #@NEW_LINE#@#  Similar results were also obtained for additional tumor types, as measured by RNA-seq in TCGA or using other microarray platforms (see SI Appendix, Fig S1 AC).  #@NEW_LINE#@#  The same pattern persisted when the divergent set  was replaced by the upper and lower divergent sets u and l.  #@NEW_LINE#@#  
Turning to the divergence of gene sets, the divergent set  is now a sample-specific set of pathways.  #@NEW_LINE#@#  For the breast cancer subtypes, the sizes || for our TCGA samples are shown in Fig 2B.  #@NEW_LINE#@#  As with single features, this sample statistic appears to be highly discriminating in separating normal and tumor samples.  #@NEW_LINE#@#  In fact, training a linear support vector machine (SVM) classifier (effectively just thresholding the size of ) on half the data from each group and testing on the other half yields test accuracies 99.2%,100%,100%,100%,98.3%,99.5%, respectively, for normal vs. luminal A, luminal B, basal-like, HER2-enriched, ER+, and ER tumors.  #@NEW_LINE#@#  

Probabilities_of_Divergence_Across_Populations  #@NEW_LINE#@#  
We estimated the probability P(Zj=1|Y=y)=P(j|Y=y) that a sample from phenotype y is divergent.  #@NEW_LINE#@#  We did this both for single features j and for gene sets Sj, and for both breast cancer molecular subtypes in TCGA and a large variety of normal samples from distinct tissue types obtained from the GTEx project (17).  #@NEW_LINE#@#  All probability estimates are relative frequencies in training data.  #@NEW_LINE#@#  
For single features, we compared ternary feature-level divergence profiles between luminal A and luminal B breast cancer.  #@NEW_LINE#@#  For most genes, luminal B samples are more likely to be divergent than luminal A tumors.  #@NEW_LINE#@#  In particular, almost all of the genes identified as significantly differentially divergent (2 test, Bonferroni corrected P value 0.05) and had higher probabilities of divergence in luminal B (see Fig 3A).  #@NEW_LINE#@#  Of note, our finding of a greater degree of dysregulation (i.e., greater divergence from the baseline) associated with luminal B is consistent with the more aggressive behavior of this subtype compared with luminal A, characterized by multiple factors portending a poorer prognosis, including higher grade, larger size, and spreading to lymph nodes (1820).  #@NEW_LINE#@#  
We also analyzed RNA-Seq data from GTEx to identify genes showing highly tissue-specific expression patterns.  #@NEW_LINE#@#  To this end, we compared divergence probabilities between a given normal tissue of interest, say T, and the remaining ones.  #@NEW_LINE#@#  First, we computed a multitissue baseline profile from 50% of available non-T samples, and then, estimated divergence probabilities separately from all of the T samples and the remaining half of non-T samples.  #@NEW_LINE#@#  For example, to identify prostate-specific genes, we used half of nonprostate samples pooled together to estimate a nonprostate baseline.  #@NEW_LINE#@#  This analysis yielded 433 prostate-specific significant genes (Bonferroni-adjusted P value 0.05), encompassing many known prostate markers including KLK3 (a.k.a.  #@NEW_LINE#@#  the prostate specific antigen; see Fig 3B).  #@NEW_LINE#@#  Then, we reversed the roles: We took tissue T as the baseline, with support estimated from 50% of the T samples and probabilities estimated as described above.  #@NEW_LINE#@#  This reverse approach also identified phenotype-specific genes (see SI Appendix, Figs.  #@NEW_LINE#@#  S2 and S3).  #@NEW_LINE#@#  
For gene sets, we considered the breast cancer subtypes and the 50 Hallmark gene sets.  #@NEW_LINE#@#  Since we are estimating only a limited number of supports, we imposed virtually zero normal divergence by selecting =.001, with the risk of underestimating cancer subtype divergence probabilities if in fact the normal breast samples are contaminated.  #@NEW_LINE#@#  Fig 4 shows a heat map of the probabilities of divergence for each of the 50 pathways.  #@NEW_LINE#@#  The full table of values is in SI Appendix, Table S1.  #@NEW_LINE#@#  
In addition, given the large differences in divergent probabilities observed among subtypes for certain pathways, we built a single decision tree to distinguish between luminal A and luminal B subtypes using half the samples for learning the tree and the other half for estimating the accuracy.  #@NEW_LINE#@#  Each question in the tree is of the form Is pathway X divergent?, where X can be any of the 50 hallmark pathways.  #@NEW_LINE#@#  This experiment in classification is merely an illustration of the different types of analysis that can be performed within our framework; more accurate trees could be induced by regarding  as a parameter to be optimized in cross-validation.  #@NEW_LINE#@#  Notice the considerable gain in interpretability that can be achieved with multidimensional divergence relative to black box predictors: Even using only three pathways, the test accuracy is 81% (see Fig 5).  #@NEW_LINE#@#  

Comparing_Divergence_Profiles_Across_Tissue_Types  #@NEW_LINE#@#  
We also used the GTEx data to compare normal samples across tissue types.  #@NEW_LINE#@#  For each tissue, we randomly selected half of the samples as the baseline and then computed the divergence sets for the left-out samples from the same tissue as well as all of the samples from other tissues.  #@NEW_LINE#@#  Fig 6 shows the results obtained for two tissue subtypes used as the baseline (breast and skin) on a selection of seven tissue subtypes.  #@NEW_LINE#@#  As expected, in all cases, the remaining samples of the tissue subtype declared as the baseline showed the least divergence, while the samples from the different subtypes displayed varying degrees of divergence; SI Appendix, Fig S4 shows additional results with the full list of available GTEx tissues.  #@NEW_LINE#@#  
The relative degrees of divergence depend on how related the tissue types are Samples from other tissues that share common cell types with the baseline have fewer divergent features (e.g., breast and adipose tissue in Fig 6A) than those that do not (e.g., skin and brain in Fig 6B).  #@NEW_LINE#@#  This suggests that tissue-specific gene expression baselines could be used to predict the tissue type of samples of unknown type.  #@NEW_LINE#@#  To test this hypothesis, we analyzed 48 tissue types in GTEx, deriving tissue-specific baselines using 50 randomly selected samples from each tissue type and then classifying the tissue-type of the remaining samples.  #@NEW_LINE#@#  A sample is classified as the tissue type that provides the smallest number of divergent genes.  #@NEW_LINE#@#  In general, accuracies above 90% were observed.  #@NEW_LINE#@#  Moreover, incorrect predictions of tissue type always reflected cell type composition and tissue origin.  #@NEW_LINE#@#  For instance, the fact that virtually all misclassified breast samples were labeled as adipose tissue might be expected since the mammary glands contain substantial amounts of adipose cells.  #@NEW_LINE#@#  Similarly, different regions of the brain share the same embryological origin and cellular types (see SI Appendix, Fig S5).  #@NEW_LINE#@#  

Comparison_of_Divergence_Profiles_Between_Disease_Phenotypes  #@NEW_LINE#@#  
Next, we considered the effect of the divergence transform on unsupervised learning.  #@NEW_LINE#@#  In particular, we compared the results of spectral clustering for the quantile data and the ternary data.  #@NEW_LINE#@#  As above, all normal (baseline) and tumor samples were taken from TCGA, and the mean fraction of normal divergence was controlled at =.01 relative to the entire transcriptome.  #@NEW_LINE#@#  Samples were randomly and evenly divided into training and test.  #@NEW_LINE#@#  Based on the training data, we determined the 100 most differentially expressed genes for the four breast cancer subtypes (luminal A, luminal B, HER2-enriched, and basal-like); we used the KruskalWallis test for the quantile data and the 2 test for the ternary data.  #@NEW_LINE#@#  We applied spectral clustering to the aggregated training data, both quantile and ternary.  #@NEW_LINE#@#  In both cases, we obtain two major, well-separated clusters, one dominated by basal-like samples and the other by nonbasal-like samples (see Fig 7).  #@NEW_LINE#@#  Clearly, by this criterion, the discriminating information is retained in the divergence profiles.  #@NEW_LINE#@#  
Furthermore, we compared divergence profiles across multiple clinically relevant, and progressively more pathogenic, cancer phenotypes.  #@NEW_LINE#@#  This revealed an increasing trend in average divergence from the normal baseline, strongly suggesting that divergence analysis can efficiently capture the global dysregulation associated with cancer progression or risk factor exposure.  #@NEW_LINE#@#  For instance, gene expression divergence increased in prostate cancer with increasing Gleason grade: the average size of the divergent set was 883 for tumors with a primary Gleason grade of 3, 1241 for a primary Gleason grade of 4, and 1490 for a primary Gleason grade of 5.  #@NEW_LINE#@#  Similar results were also observed in breast cancer with increasing grade, in the progression from colon adenoma to carcinoma, and for DNA CpG methylation divergence in lung cancer, which increased with tobacco-smoke exposure (see SI Appendix, Fig S6 AD).  #@NEW_LINE#@#  Notably, the level of deviation from the normal baseline is strongly correlated between distinct omics modalities derived from the same biological samples, suggesting global genome-wide dysregulation in both DNA and RNA in cancer; see, for example, the case of prostate cancer gene expression and methylation in SI Appendix, Fig S7A (Spearman correlation 0.59).  #@NEW_LINE#@#  Repeating this analysis with breast cancer data yielded a Spearman correlation of 0.51 (SI Appendix, Fig S7B).  #@NEW_LINE#@#  Overall, these results suggest that the divergence framework is capturing a sparse yet biologically meaningful snapshot of an omics sample and its dysregulation from a healthy state, which can be observed across distinct omics data modalities.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
Combing through large datasets to make meaningful biological inferences has become the raison dêtre for much of the current work in bioinformatics.  #@NEW_LINE#@#  Often the goal is the discovery of biomarkers or molecular signatures (e.g., gene sets) of clinical utility, and a great many of these based primarily on gene expression have been proposed over the last 15 years.  #@NEW_LINE#@#  However, many high-throughput omics classifiers are learned from relatively small cohorts of samples using population-level estimates that are highly sensitive to variability, and therefore, the resulting biomarkers are often difficult to reproduce and validate (2123).  #@NEW_LINE#@#  As a result, leveraging such gene signatures has proven difficult; in fact, the majority of such biomarkers are unable to meet the rigorous criteria required to be admitted to clinical use.  #@NEW_LINE#@#  The work here is aimed at ameliorating some of these barriers.  #@NEW_LINE#@#  
Sensitivity to platform and preprocessing is one important barrier.  #@NEW_LINE#@#  Divergence coding begins with the initial conversion of raw feature values to within-sample ranks to minimize preprocessing and batch effects.  #@NEW_LINE#@#  This is also the first step in quantile normalization (24) and in the work on relative expression analysis.  #@NEW_LINE#@#  The latter includes the top scoring pair (TSP) and k-TSP algorithms for distinguishing between two disease phenotypes based on the expression ordering between two genes (25) and between k pairs of genes (26, 27), as well as the RankComp approach (28), which aims at identifying dysregulated gene pairs starting from a pool of stable pairs precompiled using normal samples.  #@NEW_LINE#@#  Within-profile rank normalization was extended to differential variation between pathways using Hamming distance to a phenotype-specific rank template (29) and using the Kendall-tau or swap distance between rank vectors (30, 31).  #@NEW_LINE#@#  
Concerning outliers in omics data, an early example is Cancer Outlier Profile Analysis (COPA) (6, 7) for gene expression: First, each gene is standardized across samples from a phenotype of interest, and then those genes that display an outlier profile over a subset of samples are selected.  #@NEW_LINE#@#  This COPA framework can also be extended to model heterogeneity in integrated data modalities, and separate gene set statistics can be applied to determine whether outliers are enriched in multidimensional gene sets (11).  #@NEW_LINE#@#  
All of the current methods to quantify dysregulation require prior knowledge of the sample phenotypes and a population of samples from each phenotype.  #@NEW_LINE#@#  Divergence is a sample-level property that can be applied to a single sample without knowledge of phenotype and thus is not directly comparable to these methods.  #@NEW_LINE#@#  The approach perhaps most closely related to divergence is the Anti-Profiles method introduced in refs.  #@NEW_LINE#@#  10, 32 and applied to cancer diagnosis; genes that deviate from a normal profile are identified after standardization across samples and after prefiltering for hypervariability with respect to normal samples.  #@NEW_LINE#@#  In contrast, our method requires no across-sample standardization or prefiltering, making it amenable to the analysis of individual samples prospectively collected.  #@NEW_LINE#@#  Moreover, similar to outlier analysis, the antiprofile approach requires subsequent set statistics for pathway analysis.  #@NEW_LINE#@#  Divergence applies to any subset of features treated as a single entity using the same statistical theory.  #@NEW_LINE#@#  Both of these differences further limit direct comparison of divergence to the antiprofile approach.  #@NEW_LINE#@#  
Enormous biological variation is another barrier.  #@NEW_LINE#@#  It has been consistently observed that in many disease conditions there is a high degree of variation in the omics profiles from sample to sample.  #@NEW_LINE#@#  Observations of individual samples and genomic features at high-resolution may obscure patterns of dysregulation.  #@NEW_LINE#@#  Furthermore, omics studies usually focus on population-level statistics derived from samples from two or more classes.  #@NEW_LINE#@#  The features measured (e.g., transcript levels, CpG methylation) are treated as random variables, and properties of their distributions are estimated from the data and compared between classes of interest.  #@NEW_LINE#@#  For instance, statistical testing is used to identify a set of genes for which the marginal distribution is significantly altered from one phenotype to another.  #@NEW_LINE#@#  In contrast, in the work here, differential expression is a sample property.  #@NEW_LINE#@#  
Estimating of the support of a distribution in high dimensions with unions of balls is a complex problem; in particular, the accuracy will depend heavily on the effective number of dimensions.  #@NEW_LINE#@#  When the data are supported by a neighborhood of a small-dimensional manifold of a large-dimensional space, our support estimator will be much more likely to resemble the ground truth.  #@NEW_LINE#@#  Preliminary experiments suggest that this is indeed the case, but this topic requires further study.  #@NEW_LINE#@#  
When using a small number of baseline samples, our definition of divergence will definitely lack precision and, because of large interpoint distances, will probably err on the side of being overconservative, with a corresponding loss of power.  #@NEW_LINE#@#  However, our results show that the divergence signal is so strong in cancer that even being overconservative allows for a large number of out-of-support samples.  #@NEW_LINE#@#  A loss of power might also result from analyzing high-dimensional subsets of features.  #@NEW_LINE#@#  A related issue is the complexity of the baseline distribution, especially how to accommodate heterogeneous baseline populations.  #@NEW_LINE#@#  Such populations may require refinements such as linking divergence to covariates.  #@NEW_LINE#@#  This issue will also be the subject of future research.  #@NEW_LINE#@#  
Finally, the complexity and black box nature of many bioinformatics methods often prevents reconciling the statistical findings and decision rules with any underlying biological mechanism.  #@NEW_LINE#@#  In contrast, capturing and quantifying the deviation of a disease sample from the normal, physiologic state is directly meaningful, inherently interpretable, and well-suited for applications to precision and personal medicine, including clinical risk assessment and therapy selection.  #@NEW_LINE#@#  

Conclusion  #@NEW_LINE#@#  
The concept of divergence from a baseline requires making robust and meaningful comparisons from profile to profile.  #@NEW_LINE#@#  Here, we begin by converting every raw profile of interest to a quantile space by normalizing within-sample ranks.  #@NEW_LINE#@#  Then, given sufficiently many samples from a suitable baseline population, defining divergence boils down to the ability to estimate the support of the underlying baseline probability distribution.  #@NEW_LINE#@#  Importantly, divergence labeling of any given sample requires no further standardization with respect to other samples of the same class.  #@NEW_LINE#@#  Estimation of the baseline support is straightforward for scalar random variables such as individual omics features (e.g., the expression of a single gene) since the baseline support is simply an interval; for random vectors assuming values in an m-dimensional space (e.g., the expression of all genes in a pathway), we have estimated the support using a metric-based covering argument.  #@NEW_LINE#@#  In both cases, by construction, the divergence transform provides a massive reduction in complexity.  #@NEW_LINE#@#  We have demonstrated that, nonetheless, a great deal of important biological information is preserved.  #@NEW_LINE#@#  
We have focused on applications to human disease, primarily cancer.  #@NEW_LINE#@#  The emphasis on patient-level molecular dysregulation is in line with many accepted paradigms of pathogenesis.  #@NEW_LINE#@#  Cancer is particularly subject to such molecular heterogeneity.  #@NEW_LINE#@#  Stimulating cell proliferation, inducing abnormality in metabolic pathways, and genome instability are considered to be hallmarks of cancer progression and can collectively, along with many of the remaining hallmarks, be considered dysregulation of normal cell behavior.  #@NEW_LINE#@#  Therefore, a method that can quantify the presence of dysregulation in a disease sample is directly meaningful and appropriate for assessing risk.  #@NEW_LINE#@#  
The analytical framework presented here could be applied to the study of other complex human diseases that display high levels of interpersonal heterogeneity.  #@NEW_LINE#@#  As shown here with cancer, we expect that genomic and epigenomic divergence are pervasive and that the extent of divergence is often associated with relative gravity.  #@NEW_LINE#@#  Future work will center on the major challenge of adapting a patient-level divergence profile to individualized patient care.  #@NEW_LINE#@#  

Data_and_Code_Availability  #@NEW_LINE#@#  
All data analyzed here are available from luigimarchionni.org/divergence.html, and the necessary packages and code can be obtained from github.com/wikum/DivergenceAnalysis.  #@NEW_LINE#@#  

Acknowledgments  #@NEW_LINE#@#  
We thank Krastan Blagoev, Eddie Luidy-Imada, and Francisco Pereira-Lobo for helpful discussions.  #@NEW_LINE#@#  This research was supported by NIH National Cancer Institute Grant R01CA200859.  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  

This open access article is distributed under Creative Commons Attribution-NonCommercial-NoDerivatives License 4.0 (CC BY-NC-ND).  #@NEW_LINE#@#  

