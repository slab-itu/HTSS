article id="http://dx.doi.org/10.1073/pnas.1518830113"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
The effect of gene interactions on the long-term response to selection  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
The role of gene interactions in the response to selection has long been a controversial subject; whereas some have claimed they are not relevant for adaptation, others have argued that their long-term effects are of high significance.  #@NEW_LINE#@#  In this manuscript, we derive simple and general predictions for the effect of gene interactions on the long-term response to selection in two extreme regimes.  #@NEW_LINE#@#  We show that, when the dynamics of allele frequencies are dominated by genetic drift, the long-term response is surprisingly simple, depending only on the initial components of the trait variance, regardless of the detailed genetic architecture.  #@NEW_LINE#@#  In the opposite regime, when selection dominates the dynamics of allele frequencies, the long-term response depends only on the genotypephenotype.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
The role of gene interactions in the evolutionary process has long been controversial.  #@NEW_LINE#@#  Although some argue that they are not of importance, because most variation is additive, others claim that their effect in the long term can be substantial.  #@NEW_LINE#@#  Here, we focus on the long-term effects of genetic interactions under directional selection assuming no mutation or dominance, and that epistasis is symmetrical overall.  #@NEW_LINE#@#  We ask by how much the mean of a complex trait can be increased by selection and analyze two extreme regimes, in which either drift or selection dominate the dynamics of allele frequencies.  #@NEW_LINE#@#  In both scenarios, epistatic interactions affect the long-term response to selection by modulating the additive genetic variance.  #@NEW_LINE#@#  When drift dominates, we extend Robertsons [Robertson A (1960) Proc R Soc Lond B Biol Sci 153(951):234249] argument to show that, for any form of epistasis, the total response of a haploid population is proportional to the initial total genotypic variance.  #@NEW_LINE#@#  In contrast, the total response of a diploid population is increased by epistasis, for a given initial genotypic variance.  #@NEW_LINE#@#  When selection dominates, we show that the total selection response can only be increased by epistasis when some initially deleterious alleles become favored as the genetic background changes.  #@NEW_LINE#@#  We find a simple approximation for this effect and show that, in this regime, it is the structure of the genotypephenotype map that matters and not the variance components of the population.  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
The_Interaction_Between_Epistasis_and_Random_Drift  #@NEW_LINE#@#  
Robertson (17) showed that, in the weak selection limit (Nes1), where Ne is the effective population size and s is the selection coefficient at a single locus, the total response of an additive trait in a finite diploid population is simply proportional to the additive variance initially present, provided there is no dominance.  #@NEW_LINE#@#  He used the fact that the probability of fixation of an allele can be written as u(p0)=(1exp(4Nesp0))/(1exp(4Nes)) = p0+2p0(1p0)Nes+O((Nes)2).  #@NEW_LINE#@#  The total expected response, summed over all generations until every allele is lost or fixed, is R=ii(u(p0)p0), where i is the additive effect of each allele on the trait.  #@NEW_LINE#@#  When selection is weak relative to random drift, this can be approximated as R 2iip0(1p0)Nesi.  #@NEW_LINE#@#  If the selection gradient on the trait is , the selection favoring an allele with effect i is si=i, and so R2ii2p0(1p0)Ne=2NeVA=2NeR0, where VA0=ii2p0(1p0) is the initial additive genetic variance, and R0=VA0 is the response in the first generation.  #@NEW_LINE#@#  
This calculation is valid in the limit of weak selection at every locus, reflected in the fact that the probability of fixation is approximated by the first-order perturbation to neutrality.  #@NEW_LINE#@#  It is also only strictly valid when the trait is additive, excluding any form of interaction between genes.  #@NEW_LINE#@#  Indeed, it seems very hard to generalize to allow for epistasis, because, then, the calculation of the fixation probability of an allele depends on the trajectories of the alleles at all other loci it interacts with.  #@NEW_LINE#@#  
An alternative derivation is possible, which focuses on the change in variance components due to drift.  #@NEW_LINE#@#  Consider an additive trait that is determined by very many loci, each under negligibly weak selection.  #@NEW_LINE#@#  Drift will disperse allele frequencies, decreasing the additive variance by a factor (11/2Ne) per generation.  #@NEW_LINE#@#  Therefore, the total selection response is just R=t=0VA0(11/2Ne)t = 2NeVA0, as before.  #@NEW_LINE#@#  Both arguments show that the total response is proportional to the initial additive variance in the population (which, for an additive genetic architecture with no dominance, where heterozygotes display the mean phenotype of the homozygotes, corresponds to the total initial genetic variance).  #@NEW_LINE#@#  This is to be expected, because both assume weak selection at individual loci, so that the variance declines primarily through random drift.  #@NEW_LINE#@#  
What is the effect of epistasis on the total response of the population?  #@NEW_LINE#@#  Classical quantitative genetics (e.g., ref.  #@NEW_LINE#@#  18) uses statistical arguments to derive expressions for the expected components of genetic variance in an inbred population.  #@NEW_LINE#@#  Barton and Turelli (19) derive these using an explicit population genetic model, assuming two alleles per locus; Hill et al.  #@NEW_LINE#@#  (20) show how these are related to the classical expressions, and that they apply without any constraint on the distribution of allelic effects at each locus.  #@NEW_LINE#@#  In the following, we make use of these results to derive expressions for the expected long-term response of populations with arbitrary genetic architectures.  #@NEW_LINE#@#  We first focus on haploid populations and then extend our results to diploid populations.  #@NEW_LINE#@#  

The_Long-Term_Response_for_Haploids  #@NEW_LINE#@#  
Suppose that a haploid population initially has additive genetic variance VA, pairwise epistatic variance VAA, and so on for higher-order epistatic components; it is convenient to denote the kth order variance component as VA(k).  #@NEW_LINE#@#  Throughout, we will assume that the population is always at linkage equilibrium (such that pit+1pjt+1=pit+1pjt+1, where the expectation  is taken over multiple realizations of the process).  #@NEW_LINE#@#  If the expected change in allele frequency due to selection at any locus (pi=Aipitqit, where  is the selection gradient and Ai is the effect of locus i on the trait) is small compared with its variance (Var(pit+1)=(pit+1)2pit+12=piqi/N; according to the WrightFisher model), we can assume that the dynamics of the variance components are dominated by drift.  #@NEW_LINE#@#  This does not necessarily mean that selection is weak on the trait; if the trait is affected by many loci, these conditions can be met at any individual locus even with strong selection on the trait (the infinitesimal model).  #@NEW_LINE#@#  Under these conditions, after an arbitrary period of inbreeding, the expected additive variance of a haploid population isVAt=(1Ft)(VA0+2FtVAA0+3Ft2VAAA0)=(1Ft)k=1kFtk1VA(k)0where Ft is the probability of identity between two genes at a locus (equation 29 of ref.  #@NEW_LINE#@#  19, but see also Dynamics of Variance Components Under Genetic Drift).  #@NEW_LINE#@#  Assuming a uniform rate of inbreeding, so that 1Ft=(11/Ne)t, the total response to directional selection  isR=t=0VAt=t=0(1Ft)k=1kFtk1VA(k)0=Nek=1VA(k)0=NeVG0.  #@NEW_LINE#@#  [1]Remarkably, the total response to directional selection is proportional to the initial total genotypic variance, VG0=k=1VA(k)0a simple extension of Robertsons (17) result.  #@NEW_LINE#@#  The change in mean can thus be very much greater than the change in the first generation, if Ne is large (Fig 1).  #@NEW_LINE#@#  For a given initial total genetic variance, VG0, the initial response is slower with epistasis, because it is proportional only to the additive component, VA0.  #@NEW_LINE#@#  However, as allele frequencies fluctuate randomly, epistasis generates additional additive variance, such that the total selection response is the same.  #@NEW_LINE#@#  For a given initial genotypic variance, epistasis slows the initial response, but does not affect its final value, whereas, for a given initial additive variance, epistasis increases the final response by VG0/VA0, compared with an additive genetic architecture.  #@NEW_LINE#@#  
Our result is based on the dynamics of genetic variances, but Robertsons (17) result (reproduced at the beginning of the section) suggests an alternative view: As alleles fluctuate in frequency, they change the average effects of alleles at other loci, thereby changing their probability of fixation.  #@NEW_LINE#@#  In particular, as we show in The Interaction Between Strong Directional Selection and Epistasis, alleles that are initially deleterious but become beneficial as the response unfolds should contribute to this increase in long-term response.  #@NEW_LINE#@#  This view predicts that an increase in long-term response should be correlated with an increase in the number of alleles that are beneficial at the end of the response, which we confirmed through simulations (Fig S1).  #@NEW_LINE#@#  

The_Long-Term_Response_for_Diploids  #@NEW_LINE#@#  
For a diploid population, with no dominance (meaning that the phenotype of the heterozygote is simply the mean of the homozygous phenotypes), epistasis has a stronger effect.  #@NEW_LINE#@#  From equation 45 of Barton and Turelli (19),VAt=(1Ft)(VA0+2(2Ft)VAA0+3(2Ft)2VAAA0)=(1Ft)k=1k(2Ft)k1VA(k)0.Assuming that 1Ft=(11/2Ne)t, the total response to directional selection  isR=t=0VA=t=0(1Ft)k=1k(2Ft)k1VA(k)0=2Nek=12k1VA(k)02NeVG0.Now, epistasis can increase the total response disproportionately.  #@NEW_LINE#@#  This is because we are calculating the contribution of epistatic components to the variance of a population that will ultimately be completely inbredwhich amplifies the genetic variance contributed by each locus by a factor of 2 per order of interaction.  #@NEW_LINE#@#  (To see this, compare the variance of the trait in a diploid population at HardyWeinberg proportions, q2:2pq:p2, with that after complete inbreeding, q:0:p).  #@NEW_LINE#@#  However, it is unlikely that higher-order components will be large enough for this effect to be substantial (6).  #@NEW_LINE#@#  With two alleles per locus, the kth order variance is proportional to (pq)k, the product of allele frequencies across the interacting loci.  #@NEW_LINE#@#  Because pqless_than1/4, this decreases at least as 22k.  #@NEW_LINE#@#  
We have assumed constant directional selection, , on the trait.  #@NEW_LINE#@#  However, the result readily extends to more complex forms of selection.  #@NEW_LINE#@#  Assuming that fitness increases monotonically with the trait value, we can transform to a scale on which log fitness depends linearly on the trait.  #@NEW_LINE#@#  On this new scale, the variance components will be different, but our general results show how the total response depends on these components, when measured on the appropriate scale.  #@NEW_LINE#@#  

The_Interaction_Between_Strong_Directional_Selection_and_Epistasis  #@NEW_LINE#@#  
We now turn to the deterministic case, where selection is the predominant process.  #@NEW_LINE#@#  Imagine that, in the initial haploid population, alleles at n loci have marginal effects i, so that, with a selection gradient , they have selective advantage i.  #@NEW_LINE#@#  We label the alleles by their initial effect, so that i0.  #@NEW_LINE#@#  If the trait is additive, and the population infinitely large, then, if selection remains constant, the fittest genotype {1,1,} will eventually fix, and the mean will increase by R=iiqi0, where qi=1pi.  #@NEW_LINE#@#  However, with epistasis, the marginal effect of alleles will change through time.  #@NEW_LINE#@#  If these effects retain the same sign, the same final state will be reached, but it will have a different trait value.  #@NEW_LINE#@#  If some effects change sign, then a different genotype may be reached.  #@NEW_LINE#@#  There may still be a single global fitness peak, or there may be multiple peaks, so that the outcome is sensitive to the initial allele frequencies.  #@NEW_LINE#@#  However, we avoid considering this complication by simply comparing the final state of populations with and without epistasis.  #@NEW_LINE#@#  More precisely, we compare the total change in mean of an epistatic trait with the total change in mean of an additive trait, starting with the same allele frequencies and marginal effects.  #@NEW_LINE#@#  
Typically, the initial distribution of allele frequencies will be U-shaped, as expected for a population in a stationary distribution with low mutation rates per site (Ne less_than 1 for haploids).  #@NEW_LINE#@#  Thus, an enormous range of variation can be released as initially rare alleles increase, and are brought together by recombination.  #@NEW_LINE#@#  We will assume that the population is so large that alleles that are initially deleterious, but will ultimately be favored, will not be lost from the population.  #@NEW_LINE#@#  This is not realistic, but it is equivalent to assuming a low rate of recurrent mutation, such that alleles are continually reintroduced, so that, if they are favored, they will become common enough to increase deterministically.  #@NEW_LINE#@#  We assume that epistasis is not so strong that the marginal effects of alleles fluctuate more rapidly than the timescale needed for them to establish.  #@NEW_LINE#@#  
If most alleles are very rare or very common, they will spend a relatively short time passing from low to high frequency.  #@NEW_LINE#@#  Thus, we can caricature the process as a series of separate substitutions; at each substitution, the marginal effects of all of the other alleles change.  #@NEW_LINE#@#  This will change the time at which favorable alleles substitute, and may cause them to lose their advantage entirely.  #@NEW_LINE#@#  This caricature is not quite the same as the Strong Selection Weak Mutation approximation (21), in which populations are assumed to be fixed for a single genotype, and to evolve by fixation of new mutations, because rare alleles still follow a complex dynamic.  #@NEW_LINE#@#  In reality, substitutions may overlap, and their effects change continuously.  #@NEW_LINE#@#  This limiting scenario is helpful in understanding the following argument, but, because we focus on the final outcome, we do not need to assume that alleles substitute one by one.  #@NEW_LINE#@#  All we need to know is what is the difference between the final and initial effects of an allele.  #@NEW_LINE#@#  
Assuming only pairwise interactions, two alleles per locus, and linkage equilibrium throughout (see Materials and Methods), the ultimate change in mean isR=ii(pipi0)+12ijij(pipjpi0pj0).At any time, allele i has selective advantage si=Ai, where Ai=i+jijpj is the average effect of locus i on the trait mean that changes linearly with the frequencies of all of the other alleles (see Materials and Methods).  #@NEW_LINE#@#  Recall that we labeled alleles such that, initially, Ai0 for all alleles.  #@NEW_LINE#@#  For simplicity, assume that the set S0 of alleles starts at low frequency, and a set S1 starts at high frequency.  #@NEW_LINE#@#  Therefore, n0 alleles are expected to sweep from low to high frequency, thereby perturbing the selection on all other alleles.  #@NEW_LINE#@#  Provided that epistasis is sufficiently weak that no selection coefficients change sign, this set will sweep to fixation, and the difference between the response of an additive trait with the same initial effects (and therefore necessarily with the same initial additive variance) will be R=ijS0ij.  #@NEW_LINE#@#  Therefore, as long as epistasis is not directional, epistasis will, on average, make no difference to the total response.  #@NEW_LINE#@#  More precisely, provided that the total pairwise epistasis, summed over all pairs of alleles that sweep from low to high frequency, is zero, epistasis will have no net effect on the selection response.  #@NEW_LINE#@#  
This calculation is based on the assumption that additive effects cannot change sign; if interactions are strong enough to turn an initially beneficial allele, k, into a deleterious one as frequencies at other loci change, the long-term response can be different, because the difference between the two architectures is now R=k+jkkj.  #@NEW_LINE#@#  By assuming that the epistatic coefficients are independent random variables, we can approximate the probability that epistasis will change the ultimate genotype, and the expected change in trait mean that results.  #@NEW_LINE#@#  
The probability that an allele switches sign as the remaining favorable alleles increase is simply the probability that the sum of all interactions is less than the negative of its main effect: pflip=J(k)=kP(x)dx, where J is the cumulative probability distribution and P is the probability density of the sum of all epistatic interactions with the ith locus, and the n0 loci that are sweeping from low to high frequency.  #@NEW_LINE#@#  We assume that the number of interactions is large enough, and that they are sufficiently independent, that this is approximately Gaussian:  = ijS0ijN(0,n0), where  is the standard deviation (SD) of the ij.  #@NEW_LINE#@#  Note that we only need to assume that the ij are drawn independently from a distribution with finite variance, so that their sum approaches a Gaussian.  #@NEW_LINE#@#  Note also that one of the n1 alleles that is at high frequency will interact with all of the n0 alleles that sweep from low to high frequency, whereas one of the n0 sweeping alleles will only interact with the n01 other alleles that are also sweeping.  #@NEW_LINE#@#  However, we assume that n01, and so approximate n01 by n0 throughout.  #@NEW_LINE#@#  
We can now calculate the average probability of an allelic reversal by integrating over the distribution of the main effects, P[],pflip=0J()P()d.[2]This can be calculated explicitly for specific choices for P,pflip=1tan1()(halfGaussian)pflip=12(1e2erfc[])(Exponential)where =n0/ is the ratio of the SDs of the strength of genetic interactions versus the main effects, the relative strength of genetic interactions.  #@NEW_LINE#@#  These two functions necessarily increase linearly from zero for small , and saturate at 1/2 for large ; they differ by, at most, 4.4%.  #@NEW_LINE#@#  Comparing with numerical simulations, we see that this calculation captures the expected number of alleles that would be deleterious, compared with the original ultimate genotype (in which alleles remain positive throughout the evolutionary response) (Fig 2).  #@NEW_LINE#@#  However, it assumes that all loci respond independently to the changing genetic background.  #@NEW_LINE#@#  In reality, as alleles switch sign and go extinct, other loci will be affected as well.  #@NEW_LINE#@#  When comparing to the actual global peak of the fitness landscape, we see that the actual number of alleles that change sign is less than predicted by our approximation of independence (Eq.  #@NEW_LINE#@#  2).  #@NEW_LINE#@#  This is because, for each allele that reverses its sign, an interaction is effectively removed, thereby reducing pflip for the remaining loci.  #@NEW_LINE#@#  Numerically, we found that a good approximation to the expected number of allelic reversals is 1pflip(1pflip) of that assuming independence, independently of number of loci (Fig 2A).  #@NEW_LINE#@#  This expression should converge to the one assuming independence at low values of pflip, which we confirmed through simulations (Fig 2A).  #@NEW_LINE#@#  Each of these allelic reversals (or flips) will translate into some change in trait value compared with an additive population.  #@NEW_LINE#@#  For each allele, this increase will be zi=jiij, and so the average contribution of each allele that switches sign will bezi=1J()00P()P()dd.  #@NEW_LINE#@#  [3]For specific distributions of main effects,zi=1pflip221+2(halfGaussian)[4]zi=1pflipe2erfc[]22(Exponential).  #@NEW_LINE#@#  [5]These functions are again very similar, tending to zero for weak epistasis, and to c+2/n0 for large , where c=0.505 for the half-Gausssian, and 0.444 for the exponential.  #@NEW_LINE#@#  Finally, the total trait increase due to allelic reversals is simply the expected number of alleles that reverse times the increase due to each of those,R=npflipzi.  #@NEW_LINE#@#  [6]Substituting from Eqs.  #@NEW_LINE#@#  2 and 4, we see that R increases close to linearly with , as n2/n0 (Fig 2B).  #@NEW_LINE#@#  Note that, whereas only the n0 loci that sweep from low to high frequency contribute (via epistasis) to changes in marginal effects, all n=n0+n1 loci may be affected by these changes.  #@NEW_LINE#@#  An initially favorable allele that is still at low frequency when it loses its advantage will never appear, whereas one that is already at high frequency will sweep back down to low frequency (recall that we assume either an extremely large population or recurrent mutation, so that deleterious alleles never get fixed).  #@NEW_LINE#@#  Either way, any of the n initially favored alleles that lose their advantage will be eliminated.  #@NEW_LINE#@#  The previous calculations are upper bounds for the effect of epistasis on the long-term response of a population, because we considered that n0 loci have low initial allele frequencies.  #@NEW_LINE#@#  If initial allele frequencies are appreciable, part of the interaction effect is absorbed by the initial average effect of the loci, and alleles may not reverse their sign, but this can be seen as a reduction in n0.  #@NEW_LINE#@#  
When drift dominates, the ultimate response depends only on initial variance components.  #@NEW_LINE#@#  When selection dominates, the effect of epistasis on the ultimate response depends on reversals in selection on individual alleles, so that a different genotype is reached; this depends on the ratio of SDs of epistatic versus main effects, multiplied by the square root of the number of interacting alleles that sweep from low to high frequency (=n0/), as we showed above.  #@NEW_LINE#@#  The transition between the two regimes depends only on the selection strength each locus experiences (Fig 3); the trait can be under high selection strength, but, as long as it is highly polygenic, the prediction derived for the drift-dominated regime will hold (Fig 3) because, for the same initial genetic variance, the selection coefficients scale as n1/2 with the number of loci.  #@NEW_LINE#@#  In the limit of infinite numbers of genes, this prediction would hold regardless of the selection gradient on the trait.  #@NEW_LINE#@#  In the selection-dominated regime, the distribution of allele frequencies is mostly irrelevant because the ultimate response depends on alleles that are initially vanishingly rare (or absent if we allow mutation).  #@NEW_LINE#@#  The key parameter is =n0/, which is not constrained by the initial variance components: If alleles are at extreme frequency, the epistatic variance must be small, even if  is large.  #@NEW_LINE#@#  However, we can relate this parameter to variance components in the F2 population formed by crossing the ancestral with the derived population (see Measuring Strength of Interactions from F2 Crosses and Fig S2).  #@NEW_LINE#@#  This implies that the initial epistatic variance does not predict the long-term response of the population, because the population may contain strong interactions (large ) that are not manifested as epistatic variance (which depends on allele frequencies) but can contribute to the long-term response as allele frequencies reach appreciable levels.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
The role of epistasis in evolution has long been controversial.  #@NEW_LINE#@#  Wright (1) argued that epistasis would cause populations to become trapped at local adaptive peaks and proposed that a shifting balance between selection and random drift could allow them to explore alternative peaks, so as to move toward the global optimum.  #@NEW_LINE#@#  This theory motivated much work on the structure of natural populations, yet it remains unclear whether adaptation is significantly slowed by trapping on local peaks (1, 22).  #@NEW_LINE#@#  Mayr (23) criticized the supposed neglect of epistasis by bean-bag genetics, provoking a robust defense by Haldane (24).  #@NEW_LINE#@#  More recently, it has been proposed that epistatic variance can be converted into additive variance following a bottleneck, aiding adaptation (25).  #@NEW_LINE#@#  The failure of large genome-wide association studies to assign much heritable variance to specific loci (the so-called missing heritability) has been attributed to epistasis (26, 27), although this explanation is unnecessary (28).  #@NEW_LINE#@#  Overall, the practical success of the additive model in quantitative genetics appears hard to reconcile with the strong molecular interactions between genes.  #@NEW_LINE#@#  
We investigate how epistasis affects the response to selection, by asking a simple and clearly defined question: By how much does epistasis influence the ultimate change in the mean of a selected trait?  #@NEW_LINE#@#  We compare the effects of directional selection on two populations that initially have the same genetic variance for a trait; in one, inheritance is strictly additive, whereas, in the other, there can be strong gene interactions.  #@NEW_LINE#@#  We find simple results in the two extreme cases, where either drift or selection dominate.  #@NEW_LINE#@#  
In the first case, where drift is stronger than selection on individual alleles, the outcome can be predicted from the initial variance components.  #@NEW_LINE#@#  This seems remarkable but can be understood as a perturbation to neutrality: When selection is spread over very many loci, its effect on any one locus is weak relative to drift, and so the variance components are hardly perturbed by selection.  #@NEW_LINE#@#  This is an extension of the infinitesimal model to nonadditive inheritance (29).  #@NEW_LINE#@#  For haploids, the total selection response is proportional to the initial genotypic variance (including both additive and nonadditive components).  #@NEW_LINE#@#  For diploids, kth-order components of variance have effect multiplied by 2k.  #@NEW_LINE#@#  Nevertheless, it is extremely difficult to find plausible models in which such higher-order variance components are significant (10).  #@NEW_LINE#@#  One way to see this is to imagine a population in which all additive effects are zeroas would be the case at an equilibrium under balancing selection.  #@NEW_LINE#@#  However, any change in allele frequencies will necessarily generate nonzero additive effects, and, consequently, substantial additive variance.  #@NEW_LINE#@#  Higher-order epistatic variance is also likely to be small if alleles are at extreme frequencies: the kth-order epistasis is proportional to the product of pq across k loci, and so cannot be large (10).  #@NEW_LINE#@#  
In contrast, when selection is strong relative to drift (Ns1), the population will fix at an adaptive peak.  #@NEW_LINE#@#  This requires strong selection on each allele (Ns1), but also recurrent mutation, so any allele that is favored will eventually succeed.  #@NEW_LINE#@#  Thus, the issue is primarily about the genotypephenotype map rather than any population genetic process.  #@NEW_LINE#@#  We show that, unless epistasis is systematically biased, the ultimate response is increased, on average, only if the fittest peak is changed, because epistasis changes some alleles from being favored to being deleterious.  #@NEW_LINE#@#  The expected response can be predicted by a simple argument, which assumes that the net effect of the changing background is a normally distributed perturbation, and that the chance that selection on an allele changes sign is simply the chance that this random epistatic perturbation exceeds the main effect of the allele.  #@NEW_LINE#@#  
When drift dominates, our conclusions follow simply from the variance components, without further assumptions.  #@NEW_LINE#@#  When selection dominates, we assume that epistasis is not systematically biased toward (or against) interactions between favorable alleles.  #@NEW_LINE#@#  If a systematic bias is allowed, then epistasis can have an arbitrarily large effect.  #@NEW_LINE#@#  To see this, imagine a trait that is some function g[z] of an additive trait, z.  #@NEW_LINE#@#  If g[z] curves upward, then the selection response will accelerate, and can become much larger than the corresponding additive model with the same initial additive variance.  #@NEW_LINE#@#  Indeed, if we are allowed to assign trait values to genotypes arbitrarily, we can construct paths that follow any pattern of change through time.  #@NEW_LINE#@#  Our conclusions about the ultimate effects of selection depend on the assumption that epistasis adds a random perturbation, without any definite bias.  #@NEW_LINE#@#  Empirically, this seems to be the consensus: Epistasis is pervasive between genetic loci but is generally nondirectional in the sense that there is no prevalent pattern of either positive or negative interactions (30).  #@NEW_LINE#@#  
Throughout this paper, we assumed that the populations remained at linkage equilibrium.  #@NEW_LINE#@#  However, linkage disequilibrium (LD) will be generated in a number of ways.  #@NEW_LINE#@#  Drift alone will produce some LD, although this should be symmetric around no disequilibrium and so should not, on average, have strong effects.  #@NEW_LINE#@#  In the selection-dominated regime, however, LD should be generated consistently in a directional fashion.  #@NEW_LINE#@#  Nagylakis theorem (31) states that, under weak selection, as we assume here, the population is guaranteed to approach and remain close to linkage equilibrium.  #@NEW_LINE#@#  Furthermore, the fact that we assume that interactions have no preferred direction should further hinder the buildup of LD.  #@NEW_LINE#@#  Nevertheless, LD will affect the response: A truly infinite population with no recombination (full linkage) is guaranteed to find the global peak, and linkage can only affect the rate at which this is approached.  #@NEW_LINE#@#  In this sense, linkage can help because recombining populations can get trapped at local peaks.  #@NEW_LINE#@#  
Do gene interactions and epistasis affect the long-term response?  #@NEW_LINE#@#  In the drift-dominated regime, which can apply even when selection on the trait is strong for polygenic traits, the long-term response is merely proportional to the initial genetic variance.  #@NEW_LINE#@#  Epistatic architectures can reach higher trait values compared with additive populations of the same additive variance, because the former necessarily harbor more genetic variance.  #@NEW_LINE#@#  However, this effect will be small and the response slower because epistatic variance typically represents a small fraction of the total genetic variance.  #@NEW_LINE#@#  In the selection-dominated regime, it is the specifics of the interaction structure that matter.  #@NEW_LINE#@#  Substantial increases of the long-term response can be reached when interactions are strong and induce allelic reversals, but the initial epistatic variance of the population is not predictive of this (see Deterministic Limits as a Function of Allele Frequency Distribution and Figs.  #@NEW_LINE#@#  S3 and S4).  #@NEW_LINE#@#  These results set expectations for the effect of epistasis on the long-term response under directional selection and help reconcile the success of the infinitesimal additive model (11) with the biological fact that genetic interactions are pervasive in nature.  #@NEW_LINE#@#  

Materials_and_Methods  #@NEW_LINE#@#  
Simulations  #@NEW_LINE#@#  
Except where noted, we assume a haploid population of effective size Ne; similar results can be obtained for a diploid population with 2Ne copies of each gene, provided there is no dominance.  #@NEW_LINE#@#  We also assume that the trait is under weak directional selection, with selection gradient , and that the population is close to linkage equilibrium.  #@NEW_LINE#@#  We ignore the environmental component of variance, because this does not affect the response to directional selection.  #@NEW_LINE#@#  Our results for finite populations under weak selection are independent of the trait architecture.  #@NEW_LINE#@#  However, for simulations, we assume that the trait of a diallelic haploid genotype of n loci X¯=(X1,,Xn) is given by z(X¯)=i=1niXi+1/2ij=1nijXiXj.  #@NEW_LINE#@#  Assuming that the population is at linkage equilibrium, one can write, for the mean trait value, z¯=iipi+1/2ijijpipj.  #@NEW_LINE#@#  The effect of a particular locus on the trait mean is then Ai=z¯/pi=i+jijpj.  #@NEW_LINE#@#  We typically assume that main effects i and epistatic coefficients ij are randomly sampled from Gaussian distributions N(0, and N(0,), respectively.  #@NEW_LINE#@#  
We assume directional selection for increased trait values such that the fitness of a particular genotype X¯ is w(X¯)=1+z(X¯).  #@NEW_LINE#@#  At linkage equilibrium, the mean fitness of the population can then be written as w¯=1+z¯.  #@NEW_LINE#@#  The change in allele frequency at any locus is then pi=piqi(dlnw¯)/dpi=w¯Aipiqi.  #@NEW_LINE#@#  The dynamics of macroscopic variables, such as trait mean, variance, etc., can be derived from this expression.  #@NEW_LINE#@#  

Finite_Population_Simulations  #@NEW_LINE#@#  
The simulations were performed by keeping track only of allele frequencies, thereby abolishing LD.  #@NEW_LINE#@#  Every generation, allele frequencies are updated according to the deterministic expectation, pi=Aipi(1pi), where Ai=ijijpj.  #@NEW_LINE#@#  A binomial sample of N copies is then sampled with this probability of success for each locus, and the allele frequencies are updated according to this sample.  #@NEW_LINE#@#  We repeat this procedure until no genetic variation exists at any locus, i.e., the population is fixed for one genotype.  #@NEW_LINE#@#  

Deterministic_Numerical_Simulations  #@NEW_LINE#@#  
Every iteration, we iterate the deterministic recursion pi=Aipi(1pi)/w¯, where Ai=i+jiijpj.  #@NEW_LINE#@#  The recursion is iterated for a set number of generations chosen so that the remaining variance in the population is vanishingly small.  #@NEW_LINE#@#  

Fitness_Landscape_Analysis  #@NEW_LINE#@#  
To find the absolute maximum trait increase, we associate a trait value z=i=1niXi+1/2ijijXiXj to every genotype (X1,,Xn) and exhaustively search for the maximum of the landscape.  #@NEW_LINE#@#  


Dynamics_of_Variance_Components_Under_Genetic_Drift  #@NEW_LINE#@#  
For a haploid population with n biallelic loci, any trait can be defined asz(X¯)=iiXi+ijijXiXj+ijkijkXiXjXk+.Under linkage equilibrium, the mean and variance of the trait distribution over the population can be written asz¯=iipi+ijijpipj+ijkijkpipjpk+Var(z)=VA+VAA++VA(k)=i(Ai(1))2Vi+ij(Aij(2))2ViVj+whereAi(1)=z¯pi=i+jijpj+jkijkpjpk+Aij(2)=2z¯pipj=ij+kijkpk+Aijn(n)=nz¯pipjpn.  #@NEW_LINE#@#  
If binomial sampling (genetic drift) is the main force determining dynamics at every locus, and the population is random mating and at linkage equilibrium, we can write, for the expectation at the next generation (for multiple realizations of the same process) under the Wright-Fisher model,pt+1=ptVar(pt+1)=1Npt(1pt).Using these expressions, we can calculate the expectation of the genetic variance at each locus in the next generation,Vt+1=pt+1pt+12=pt+1Var(pt+1)pt+12=pt(1pt)1Npt(1pt)=(11N)Vtor,conversely,pt+12=pt2+Var(pt+1)=pt2+1Npt(1pt)=pt2+1NVt.  #@NEW_LINE#@#  [S1]  #@NEW_LINE#@#  
Because z¯ does not contain terms in higher powers of each of the allele frequencies (that is, it does not contain terms in pi2), every Aik does not depend on the allele frequencies of any of the ik loci.  #@NEW_LINE#@#  This means that the expectation (Aik)2ViVk=(Aik)2ViVk.  #@NEW_LINE#@#  
Each of the Ai2 is of the formAi2=i2+jiij2pj2+kjiijk2pj2pk2++crossterms.The cross-terms are all linear on the allele frequencies pj,,pk and so, in expectation, remain the same in the next generation because pit+1=pit.  #@NEW_LINE#@#  The terms of Ai2 that are quadratic in pi are changed in the next generation, in expectation, as in Eq.  #@NEW_LINE#@#  S1.  #@NEW_LINE#@#  With a bit of algebra (cumbersome using this notation, but see ref.  #@NEW_LINE#@#  19), we can see that the expectation for Ai2t+1 is inflated by a fraction of how much the locus i contributes to all of the higher-order components of variance (VAA, etc.  #@NEW_LINE#@#  ).  #@NEW_LINE#@#  
For example, for a genetic architecture involving only pairwise interactions, the contribution of a locus to additive variance is(VA)i=(i+jijpj)2Vi=(i2+jij2pj2+2ijijpj+(jijpj)(kjikpk))Vi.This contribution will be in expectation in the next generation,(VA)it+1=(i2+jij2pj2t+1+2ijijpjt+1+(jijpjt+1)(kjikpkt+1))Vit+1=(i2+jij2((pjt)2+Var(pjt))+2ijijpjt+(jijpjt)(kjikpkt))(11N)Vit=(Ait)2(11N)Vit+jij2Var(pjt+1)(11N)Vit=(Ait)2(11N)Vit+jij2(1N)pjt(1pjt)(11N)Vit=(11N)(VAt)i+1N(11N)jij2VjtVitThelocuscontributiontoVAA.In general, for arbitrary orders of interactions, one obtainsVA(j)t+1=(11N)jk=0nj(kjj)(1N)kVA(j+k)tand, in particular, for the additive variance,VAt+1=(11N)k=1k(1N)k1VA(k)t.  #@NEW_LINE#@#  

Calculating_Expectations_for_the_Initial_Components_of_Variance_over_the_Allele_Frequency_Distribution  #@NEW_LINE#@#  
The initial epistatic variance present in a population can be written asVepi=12ijpiqipjqjij2Vepi=ijpiqipjqjij2=ij(pi,pj)ij2.If we assume that the initial allele frequencies are independently distributed, we can average over the allele frequencies and writeV¯epi=p¯(1p¯)(p¯(1p¯)2VpVp2)ijij2V¯epi=¯(p)ijij2,where p¯ and Vp=p2¯p¯2 are the mean and variance of the distribution of allele frequencies.  #@NEW_LINE#@#  In the same manner, if we assume that epistatic interactions are much stronger than the background independent effects i, the initial additive variance can be written asV¯A=(p¯2Vp)(p¯(1p¯)Vp)ijij2+2p¯2(p¯(1p¯)Vp)i(j,kjijik).VA¯=¯(p)ijij2+¯(p)i(j,kjijik)where (pi,pj)=piqipjqj, (pi,pj)=piqipj2 and (pi,pj,pk)=piqipjpk.V¯A=i(p¯(1p¯)Vp)i2+p¯(p¯(1p¯)Vp)jij2+2p¯(p¯(1p¯)Vp)jiij+2p¯1(p¯(1p¯)Vp)×jkjijik.Using ¯=[p¯(1p¯)(Vp)]2, ¯=(Vp+p¯2)[p¯(1p¯)Vp], and ¯=p¯2[p¯(1p¯)Vp], the average total genetic variance can then be written asV¯G=(¯+¯)ijij2+¯ij,kjijikV¯G=i(p¯(1p¯)Vp)i2+p¯[p¯(1p¯)Vp]ijij2+p¯2[p¯(1p¯)Vp]ij,kjijik+2p¯(p¯(1p¯)Vp)jiijand, realizing that, because all of the ij are independent and identically distributed, all terms ij2 are identical and all terms ijik=0 and iij=0, we can write, for the initial fraction of epistatic variance,V¯epiV¯G=¯¯+¯=p¯(1p¯)Vpp¯(1+p¯)+VpV¯epiV¯G=(n1)epi2(p2p+Vp)(n1)epi2(p2+p+Vp)+4add2.This allows us to quantify the amount of epistatic variance initially present in the population, as a function only of the mean and variance of the initial allele distribution.  #@NEW_LINE#@#  In the limit of strong epistasis or many loci, this expression reduces to a limit that depends only on the initial allele frequency distribution,V¯epiV¯G|n=V¯epiV¯G|epiadd=p¯(1p¯)Vpp¯(1+p¯)+Vp.  #@NEW_LINE#@#  

Deterministic_Limits_as_a_Function_of_Allele_Frequency_Distribution  #@NEW_LINE#@#  
The long-term response of a population in the deterministic regime is mostly determined by the fitness landscape the population evolves on (see The Interaction Between Strong Directional Selection and Epistasis).  #@NEW_LINE#@#  When initial allele frequencies are not vanishingly rare, the long-term response will be below the limits we show in The Interaction Between Strong Directional Selection and Epistasis, because the population starts at a higher trait value.  #@NEW_LINE#@#  Fig S3 shows the long-term response as a function of the allele frequency distribution for strong .  #@NEW_LINE#@#  

Measuring_Strength_of_Interactions_from_F2_Crosses  #@NEW_LINE#@#  
One can measure the critical parameter  by crossing ancestral populations with derived populations.  #@NEW_LINE#@#  These differ at n0 loci, which will be at pi=1/2 in the hybrid population.  #@NEW_LINE#@#  Therefore, VAH=i(Ai+i)2(1/4)=(n0/4)(2+n02)=(n02/4)(1+2),VAAH=(1/2)ijij2(1/4)2=[n0(n01)/32]2n022/32.  #@NEW_LINE#@#  Therefore, VAAH/VAH(n0/8)[2/(1+2)].  #@NEW_LINE#@#  We also have that Rn0, so that VAH/R2(1/4n0)(1+2)which is just a haploid version of the WrightCastleLande estimator.  #@NEW_LINE#@#  We see that, if the ratio of epistatic to additive variance in the hybrid population is  1, then 8/n0, which is small.  #@NEW_LINE#@#  

Acknowledgments  #@NEW_LINE#@#  
The authors thank Jitka Polechová and Michael Turelli for helpful comments.  #@NEW_LINE#@#  This work was supported by European Research Council Advanced Grant ERC-2009-AdG-250152.  #@NEW_LINE#@#  This project has received funding from the European Unions Seventh Framework Programme for research, technological development and demonstration under Grant Agreement 618091 Speed of Adaptation in Population Genetics and Evolutionary Computation (SAGE).  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  




