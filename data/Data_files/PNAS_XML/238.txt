article id="http://dx.doi.org/10.1073/pnas.1522200113"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Algorithmic handwriting analysis of Judahs military correspondence sheds light on composition of biblical texts  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
Scholars debate whether the first major phase of compilation of biblical texts took place before or after the destruction of Jerusalem in 586 BCE.  #@NEW_LINE#@#  Proliferation of literacy is considered a precondition for the creation of such texts.  #@NEW_LINE#@#  Ancient inscriptions provide important evidence of the proliferation of literacy.  #@NEW_LINE#@#  This paper focuses on 16 ink inscriptions found in the desert fortress of Arad, written ca.  #@NEW_LINE#@#  600 BCE.  #@NEW_LINE#@#  By using novel image processing and machine learning algorithms we deduce the presence of at least six authors in this corpus.  #@NEW_LINE#@#  This indicates a high degree of literacy in the Judahite administrative apparatus and provides a possible stage setting for compilation of biblical texts.  #@NEW_LINE#@#  After the kingdoms demise, a similar literacy level reemerges only ca.  #@NEW_LINE#@#  200 BCE.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
The relationship between the expansion of literacy in Judah and composition of biblical texts has attracted scholarly attention for over a century.  #@NEW_LINE#@#  Information on this issue can be deduced from Hebrew inscriptions from the final phase of the first Temple period.  #@NEW_LINE#@#  We report our investigation of 16 inscriptions from the Judahite desert fortress of Arad, dated ca.  #@NEW_LINE#@#  600 BCEthe eve of Nebuchadnezzars destruction of Jerusalem.  #@NEW_LINE#@#  The inquiry is based on new methods for image processing and document analysis, as well as machine learning algorithms.  #@NEW_LINE#@#  These techniques enable identification of the minimal number of authors in a given group of inscriptions.  #@NEW_LINE#@#  Our algorithmic analysis, complemented by the textual information, reveals a minimum of six authors within the examined inscriptions.  #@NEW_LINE#@#  The results indicate that in this remote fort literacy had spread throughout the military hierarchy, down to the quartermaster and probably even below that rank.  #@NEW_LINE#@#  This implies that an educational infrastructure that could support the composition of literary texts in Judah already existed before the destruction of the first Temple.  #@NEW_LINE#@#  A similar level of literacy in this area is attested again only 400 y later, ca.  #@NEW_LINE#@#  200 BCE.  #@NEW_LINE#@#  

Main towns in Judah and sites in the Beer Sheba Valley mentioned in the article.  #@NEW_LINE#@#  
Algorithmic_Apparatus  #@NEW_LINE#@#  
One might try to use existing computerized algorithms for automatic handwriting comparison purposes.  #@NEW_LINE#@#  However, an algorithmic analysis of the Arad corpus via readily available means is hampered by several factors.  #@NEW_LINE#@#  First, the poor state of preservation of the ostraca (Fig 2) could not be remedied by existing image acquisition methods (9, 10).  #@NEW_LINE#@#  Second, the imperfect digital images present a challenge for image segmentation and enhancement methods (11, 12).  #@NEW_LINE#@#  Finally, recognizing hands via document analysis algorithms is a tantalizing problem even in a modern writing setting (13).  #@NEW_LINE#@#  Consequently, we developed new methods for image processing and document analysis, as well as machine learning algorithms.  #@NEW_LINE#@#  These techniques allow us to identify the minimal number of authors represented in a given group of ostraca.  #@NEW_LINE#@#  
Our algorithmic sequence consisted of three consecutive stages, operating on digital images of the ostraca (see Supporting Information).  #@NEW_LINE#@#  All of the stages are fully automatic, with the exception of the first, which is a semiautomatic step.  #@NEW_LINE#@#  
The end product is a table containing the P for a comparison of each pair of ostraca.  #@NEW_LINE#@#  Before implementing our methodology on the Arad corpus, it was thoroughly tested on modern Hebrew handwritings and found solid (see Supporting Information for details).  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
Using this computerized procedure we analyzed 16 inscriptions from the Arad fortress (namely, ostraca 1, 2, 3, 5, 7, 8, 16, 17, 18, 21, 24, 31, 38, 39, 40, and 111), which are relatively legible and have a sufficient number of characters for examination.  #@NEW_LINE#@#  Two of the inscriptions (ostraca 17 and 39) are inscribed on both sides of the sherd, bringing the number of texts under investigation to 18.  #@NEW_LINE#@#  The results are summarized in Table 1.  #@NEW_LINE#@#  The ostraca numbers head the rows and columns of the table, with the intersection cells providing the comparisons P. The cells with P  0.2 are marked in red, indicating that the two ostraca are considered to be written by different authors.  #@NEW_LINE#@#  We reiterate that when P  0.2 we cannot claim that they were written by a single author.  #@NEW_LINE#@#  
The results allow us to estimate the minimal number of writers in the tested inscriptions.  #@NEW_LINE#@#  For example, the examination of ostraca 7, 18, 24, and 40 reveals that their authors are pairwise distinct; in fact, six such quadruplets can be identified in Table 1, rendering the existence of at least four authors as highly likely; see Supporting Information for details.  #@NEW_LINE#@#  Therefore, based on the statistical analysis, it can be deduced that there are at least four unique hands in the tested corpus.  #@NEW_LINE#@#  Our algorithmic observations can be further supplemented by the textual and archaeological context of the ostraca, deliberately avoided until this point.  #@NEW_LINE#@#  In particular, the prosaic lists of names in ostraca 31 and 39* were most likely composed at Arad, as opposed to ostraca 7, 18, 24, and 40, which were probably dispatched from other locations.  #@NEW_LINE#@#  As per the table, ostracon 31 differs from both sides of ostracon 39; we can thus conjecture an existence of two additional authors, totaling at least six distinct writers.  #@NEW_LINE#@#  

Discussion  #@NEW_LINE#@#  
Identifying the military ranks of the authors can provide information regarding the spread of literacy within the Judahite army.  #@NEW_LINE#@#  Our proposed reconstruction of the hierarchical relations between the signees and the addressees of the examined inscriptions is as follows (see Fig 4):  #@NEW_LINE#@#  
Following this reconstruction, it is reasonable to deduce the proliferation of literacy among the Judahite army ranks ca.  #@NEW_LINE#@#  600 BCE.  #@NEW_LINE#@#  A contending claim that the ostraca were written by professional scribes can be dismissed with two arguments: the existence of two distinct writers in the tiny fortress of Arad (authors of ostraca 31 and 39) and the textual content of the inscriptions: Ostracon 1 orders the recipient (Eliashib) write the name of the day, ostracon 7 commands and write it before you, and in ostracon 40 (reconstructions in refs.  #@NEW_LINE#@#  6 and 18) the author mentions that he had written the letter.  #@NEW_LINE#@#  Thus, rather than implying the existence of scribes accompanying every Judahite official, the written evidence suggests a high degree of literacy in the entire Judahite chain of command.  #@NEW_LINE#@#  
The dissemination of writing within the Judahite army around 600 BCE is also confirmed by the existence of other military-related corpora of ostraca, at Horvat Uza (19) and Tel Malata (20) in the vicinity of Arad, and at Lachish¶ in the Shephelah (summary in ref.  #@NEW_LINE#@#  3)all located on the borders of Judah (Fig 1).  #@NEW_LINE#@#  We assume that in all these locations the situation was similar to Arad, with even the most mundane orders written down occasionally.  #@NEW_LINE#@#  In other words, the entire army apparatus, from high-ranking officials to humble vice-quartermasters of small desert outposts far from the center, was literate, in the sense of the ability to communicate in writing.  #@NEW_LINE#@#  
To support this bureaucratic apparatus, an appropriate educational system must have existed in Judah at the end of the first Temple period (2, 2123).  #@NEW_LINE#@#  Additional evidence supporting writing awareness by the lowest echelons of society seems to come from the Mead Hashavyahu ostracon (24), which contains a complaint by a corvée worker against one of his overseers (most scholars agree that it was composed with the aid of a scribe).  #@NEW_LINE#@#  
Extrapolating the minimum of six authors in 16 Arad ostraca to the entire Arad corpus, to the whole military system in the southern Judahite frontier, to military posts in other sectors of the kingdom, to central administration towns such as Lachish, and to the capital, Jerusalem, a significant number of literate individuals can be assumed to have lived in Judah ca.  #@NEW_LINE#@#  600 BCE.  #@NEW_LINE#@#  
The spread of literacy in late-monarchic Judah provides a possible stage setting for the compilation of literary works.  #@NEW_LINE#@#  True, biblical texts could have been written by a few and kept in seclusion in the Jerusalem Temple, and the illiterate populace could have been informed about them in public readings and verbal messages by these few (e.g., 2 Kings 23:2, referring to the period discussed here).  #@NEW_LINE#@#  However, widespread literacy offers a better background for the composition of ambitious works such as the Book of Deuteronomy and the history of Ancient Israel in the Books of Joshua to Kings (known as the Deuteronomistic History), which formed the platform for Judahite ideology and theology (e.g., ref.  #@NEW_LINE#@#  25).  #@NEW_LINE#@#  Ideally, to deduce from literacy on the composition of literary (to differ from mundane) texts, we should have conducted comparative research on the centuries after the destruction of Jerusalem, a period when other biblical texts were written in both Jerusalem and Babylonia according to current textual research (e.g., refs.  #@NEW_LINE#@#  1 and 26).  #@NEW_LINE#@#  However, in the Babylonian, Persian, and early Hellenistic periods, Jerusalem and the southern highlands show almost no evidence in the form of Hebrew inscriptions.  #@NEW_LINE#@#  In fact, not a single securely dated Hebrew inscription has been found in this territory for the period between 586 and ca.  #@NEW_LINE#@#  350 BCE#not an ostracon or a seal, a seal impression, or a bulla [the little that we know of this period is in Aramaic, the script of the newly present Persian empire (27)].  #@NEW_LINE#@#  This should come as no surprise, because the destruction of Judah brought about the collapse of the kingdoms bureaucracy and deportation of many of the literati.  #@NEW_LINE#@#  Still, for the centuries between ca.  #@NEW_LINE#@#  600 and 200 BCE, the tension between current biblical exegesis (arguing for massive composition of texts) and the negative archaeological evidence remains unresolved.  #@NEW_LINE#@#  

Materials_and_Methods  #@NEW_LINE#@#  
This research was conducted on two datasets of written material.  #@NEW_LINE#@#  The main document assemblage was a corpus of 16 Hebrew ostraca inscriptions found at the Arad fortress (ca.  #@NEW_LINE#@#  600 BCE).  #@NEW_LINE#@#  The research was performed on digital images of these inscriptions.  #@NEW_LINE#@#  A second dataset, used to validate the algorithm, contained handwriting samples collected from 18 present-day writers of Modern Hebrew.  #@NEW_LINE#@#  
The aim of our main algorithm was to differentiate between writers in a given set of texts.  #@NEW_LINE#@#  This algorithm consisted of several stages.  #@NEW_LINE#@#  In the first step, character restoration, the image of the inscription was segmented into (often noisy) characters that were restored via a semiautomatic reconstruction procedure.  #@NEW_LINE#@#  The method was based on the representation of a character as a union of individual strokes that were treated independently and later recombined.  #@NEW_LINE#@#  The purpose of stroke restoration was to imitate a reed pens movement using several manually sampled key points.  #@NEW_LINE#@#  An optimization of the pens trajectory was performed for all intermediate sampled points.  #@NEW_LINE#@#  The restoration was conducted via the minimization of image energy functional, which took into account the adherence to the original image, the smoothness of the stroke, as well as certain properties of the reed radius.  #@NEW_LINE#@#  The minimization problem was solved by performing gradient descent iterations on a cubic-spline representation of the stroke.  #@NEW_LINE#@#  The end product of the reconstruction was a binary image of the character, incorporating all its strokes (see Figs.  #@NEW_LINE#@#  S1 and S2).  #@NEW_LINE#@#  
The second stage of the algorithm, letter comparison, relied on features extracted from the characters binary images, used to automatically compare characters from different texts.  #@NEW_LINE#@#  Several features were adapted, referring to aspects such as the characters overall shape, the angles between strokes, the characters center of gravity, as well as its horizontal and vertical projections.  #@NEW_LINE#@#  The features in use were SIFT (28), Zernike (29), DCT, Kd-tree (30), Image projections (31), L1, and CMI (32).  #@NEW_LINE#@#  Additionally, for each feature, a respective distance was defined.  #@NEW_LINE#@#  Later on, all these distances were combined into a single, generalized feature vector.  #@NEW_LINE#@#  This vector described each character by the degree of its proximity to all of the characters, using all of the features.  #@NEW_LINE#@#  Finally, a distance between any two characters was calculated according to the Euclidean distance between their generalized feature vectors (see Table S1 for details concerning various features in use).  #@NEW_LINE#@#  
The final stage of the algorithm addressed the main question, What is the probability that two given texts were written by the same author?  #@NEW_LINE#@#  This was achieved by posing an alternative null hypothesis H0 (both texts were written by the same author) and attempting to reject it by conducting a relevant experiment.  #@NEW_LINE#@#  If its outcome was unlikely (P  0.2), we rejected the H0 and concluded that the documents were written by two individuals.  #@NEW_LINE#@#  Alternatively, if the occurrence of H0 was probable (P  0.2), we remained agnostic.  #@NEW_LINE#@#  The experiment testing the H0 performed a clustering on a set of letters from the two tested inscriptions (of specific type, e.g., alep||), disregarding their affiliation to either of the inscriptions.  #@NEW_LINE#@#  The clustering results should have resembled the original inscriptions if two different writers were present, while being random if this was not the case.  #@NEW_LINE#@#  Although this kind of test could have been performed on one specific letter, we could gain additional statistical significance if several different letters (e.g., alep, he, waw, etc.)  #@NEW_LINE#@#  were present in the compared documents.  #@NEW_LINE#@#  Subsequently, several independent experiments were conducted (one for each letter), and their P values were combined via the well-established Fishers method (33).  #@NEW_LINE#@#  The combination represented the probability that H0 was true based on all of the evidence at our disposal (see Fig S3 for an illustration of the procedures flow).  #@NEW_LINE#@#  
See Supporting Information for additional details regarding the methods in use and their results on both Ancient and Modern Hebrew datasets (available at www-nuclear.tau.ac.il/eip/ostraca/DataSets/Arad_Ancient_Hebrew.zip and www-nuclear.tau.ac.il/eip/ostraca/DataSets/Modern_Hebrew.zip, respectively).  #@NEW_LINE#@#  In particular, see Figs.  #@NEW_LINE#@#  S4 and S5 for samples taken from Modern and Ancient Hebrew datasets, respectively.  #@NEW_LINE#@#  Additionally, Table S2 summarizes the results of the Modern Hebrew experiment, while Table S3 provides statistics regarding the characters utilized in the Ancient Hebrew experiment.  #@NEW_LINE#@#  

Introduction  #@NEW_LINE#@#  
The main goal of the current research was to estimate the minimal number of authors involved in the scripting of the Arad corpus.  #@NEW_LINE#@#  To deal with this issue, we had to differentiate between authors of different inscriptions.  #@NEW_LINE#@#  Although relevant algorithms have been proposed in the past (e.g., ref.  #@NEW_LINE#@#  34 for incised lapidary texts), our experience shows that most of the solutions are tailor-made for specific corpora.  #@NEW_LINE#@#  The poor state of preservation of the Arad First Temple period ostraca, and the high variance of their cursive texts of mundane nature, presented difficulties that none of the available methods could overcome (see Fig 2).  #@NEW_LINE#@#  Therefore, novel image processing and machine learning tools had to be developed.  #@NEW_LINE#@#  
The input for our system is the digital images of the inscriptions.  #@NEW_LINE#@#  The algorithm involves two preparatory stages, leading to a third step that estimates the probability that two given inscriptions were written by the same author.  #@NEW_LINE#@#  All of the stages are fully automatic, with the exception of the first, semiautomatic, preparatory step.  #@NEW_LINE#@#  The basic steps of the algorithm are as follow:  #@NEW_LINE#@#  
The next section will present an in-depth description of each of the stages.  #@NEW_LINE#@#  This will be followed by an experimental section that describes the application of our algorithm to both modern and ancient texts.  #@NEW_LINE#@#  We verify the validity of our approach by applying the algorithm to modern texts (with a number of contemporary texts written by individuals known to us).  #@NEW_LINE#@#  

Description_of_the_Algorithm  #@NEW_LINE#@#  
Character_Restoration  #@NEW_LINE#@#  
The state of preservation of most ostraca is poor at best.  #@NEW_LINE#@#  After more than two and a half millennia buried in the ground, the inscriptions are often blurry, partially erased, cracked, and stained.  #@NEW_LINE#@#  However, to analyze the script, clear black and white (binary) images are required.  #@NEW_LINE#@#  Theoretically, such depictions of the inscriptions do exist, in the form of manually created facsimiles (drawings of the ostraca), created by epigraphic experts.  #@NEW_LINE#@#  However, these have been shown to be influenced by the prior knowledge and assumptions of the epigrapher (32).  #@NEW_LINE#@#  A potential solution for this problem could have been provided by automatic binarization procedures from the domain of image processing.  #@NEW_LINE#@#  Unfortunately, in our experimentations, various binarization methods produced unsatisfactory results (12).  #@NEW_LINE#@#  
We finally substituted these initial attempts with a semiautomatic approach of individual character restoration.  #@NEW_LINE#@#  Restoring a character is equivalent to reconstructing its strokes, which are the characters building blocks, and then combining them.  #@NEW_LINE#@#  Accordingly, henceforth we will discuss the problem of stroke restoration rather than complete character reconstruction.  #@NEW_LINE#@#  Stroke restoration aims at imitating the reed pens movement using several manually sampled key points.  #@NEW_LINE#@#  An optimization of the pens trajectory is performed for all intermediate sampled points, taking into account information from the noisy character image.  #@NEW_LINE#@#  A short mathematical description of the procedure follows; for more details and analysis see ref.  #@NEW_LINE#@#  14.  #@NEW_LINE#@#  
A stroke could be referred to as a 2D piecewise smooth curve (x(t),y(t)), depending on the parameter t[a,b].  #@NEW_LINE#@#  However, such a representation ignores the strokes thickness, which is related to the stance of the writing pen toward the document (in our case, a potshard) and to the characteristics of the pen itself.  #@NEW_LINE#@#  In the case of Iron Age Hebrew, it is well accepted that the scribes used reed pens, which have a flat, rather than pointed, top.  #@NEW_LINE#@#  This fact makes the writing thickness even more essential to the process of stroke restoration.  #@NEW_LINE#@#  Therefore, we denote the stroke as a set-valued function:S(t)={(p,q)|(px(t))2+(qy(t))2r(t)2}t[a,b],where x(t) and y(t) represent the coordinates of the center of the pen at t, and r(t) stands for the radius of the pen at t (Fig S1).  #@NEW_LINE#@#  The corresponding stroke curve is thus(t)=(x(t),y(t),r(t))t[a,b],whereas the skeleton of the stroke will accordingly be the curve(t)=(x(t),y(t))t[a,b].We note that our model of a written stroke is an approximation, because in reality the top of the reed pen was not necessarily a perfect circle.  #@NEW_LINE#@#  
Borrowing the idea of minimizing an energy functional (35, 36), we produce an analytic reconstruction of a stroke with respect to a given image I(p,q) ((p,q)[1,N]×[1,M]).  #@NEW_LINE#@#  This reconstructed stroke S(t) is defined as corresponding to the stroke curve (t), minimizing the following functional:F[(t)]=c1abGI(t)r(t)2dt+c2ab1r(t)dt+c3j=0J1tj+tj+1|K(x,y,x¨,y¨)|dt(t)=argmin(t)F[(t)],where GI(t)=(p,q)S(t)I(p,q) is the sum of the gray level values of the image I inside the disk S(t); (tj)=(x(tj),y(tj),r(tj))j=0,...,J are manually sampled points on the stroke curve (t), with respect to the natural parameter t; x, x¨ and y, y¨ denote the first and second derivatives of x and y; K(x,y,x¨,y¨)=(xy¨yx¨)/(x2+y2)32 stands for the curvature of the skeleton of the stroke (t); 0less_thanc1,c2,c3, are parameters, set to c1=2,c2=2,000,c3=50,=0.01 in our experiments.  #@NEW_LINE#@#  
The reconstruction is subject to initial and boundary conditions at (a) the beginning and end of strokes; (b) intersections of strokes; (c) significant extremal points of the curvature; and (d) points with no traces of ink.  #@NEW_LINE#@#  These conditions are supplied by manual sampling.  #@NEW_LINE#@#  
The energy minimization problem described above is solved by performing gradient descent iterations on a cubic-spline representation of the stroke (for more details see ref.  #@NEW_LINE#@#  14).  #@NEW_LINE#@#  The end product of the reconstruction is a binary image of the character, incorporating all its strokes.  #@NEW_LINE#@#  
Fig S2 presents a restoration of an entire character, stroke by stroke.  #@NEW_LINE#@#  It can be seen that although the original character image contains several erosions (Fig S2A), the reconstructed strokes (Fig S2C) look both smooth and complete, and their union results in a clear letter, adhering to the character image (Fig S2D).  #@NEW_LINE#@#  

Feature_Extraction_and_Distance_Calculation  #@NEW_LINE#@#  
Commonly, automatic comparison of characters relies upon features extracted from the characters binary images.  #@NEW_LINE#@#  In this study, we adapted several well-established features from the domains of computer vision and document analysis.  #@NEW_LINE#@#  These features refer to aspects such as the characters overall shape, the angles between strokes, the characters center of gravity, as well as its horizontal and vertical projections.  #@NEW_LINE#@#  Some of these features correspond to characteristics commonly used in traditional paleography (21).  #@NEW_LINE#@#  
The feature extraction process includes a preliminary step of the characters standardization.  #@NEW_LINE#@#  The steps involve rotating the characters according to their line inclination, resizing them according to a predefined scale, and fitting the results into a padded (at least 10% on each side) square of size aL×aL (with L=1,...,22 the index of the alphabet letter under consideration).  #@NEW_LINE#@#  On average, the resized characters were 300 × 300 pixels.  #@NEW_LINE#@#  
Subsequently, the proximity of two characters can be measured using each of the extracted features, representing various aspects of the characters.  #@NEW_LINE#@#  For each feature, a different distance function is defined (to be combined at a later stage; discussed below).  #@NEW_LINE#@#  
Table S1 provides a list of the features and distances we use, along with a description of their implementation details.  #@NEW_LINE#@#  Some of the adjustments (e.g., replacement of the L2 norm with the L1 norm) were required due to the large amount of noise present in our medium.  #@NEW_LINE#@#  
After the features are extracted, and the distances between the features are measured, there arises a challenge of combining the various distances.  #@NEW_LINE#@#  Several combination techniques [e.g., AdaBoost (37) and Bag of Features (38)] were considered.  #@NEW_LINE#@#  Unfortunately, boosting-related methods are unsuitable due to the lack of training statistics, and the Bag of Features performed poorly in preliminary experiments using a modern handwritten character dataset (details regarding this dataset are given below).  #@NEW_LINE#@#  Hence, we developed a different approach for combining the distances.  #@NEW_LINE#@#  
Our main idea was to consider the distances of a given character from all of the other characters, with respect to all of the features under consideration (i.e., two characters closely resembling each other ought to have similar distances from all other characters).  #@NEW_LINE#@#  Namely, they will both have small distances from similar characters and large distances from dissimilar characters.  #@NEW_LINE#@#  This observation leads to a notion of a generalized feature vector (defined here for the first time to our knowledge).  #@NEW_LINE#@#  
The generalized feature vector is defined by the following procedure (for each letter L=1,...,22 in the alphabet).  #@NEW_LINE#@#  First, we define a distance matrix for each feature.  #@NEW_LINE#@#  For example, the SIFT distance matrix isUSIFT=(DSIFT(1,1)DSIFT(1,JL)DSIFT(JL,1)DSIFT(JL,JL))=(uSIFT1uSIFTJL),where JL represents the total number of characters, DSIFT(i,j) is the SIFT distance between characters i and j, and uSIFTi=(DSIFT(i,1)DSIFT(i,JL)) is the vector of SIFT distances between the character i and all of the others.  #@NEW_LINE#@#  
In addition, we denote the SD of the elements of the matrix USIFT by SIFT=std{DSIFT(i,j)|(i,j){1,...,JL}×{1,...,JL}}.  #@NEW_LINE#@#  Matrices of all of the other features (UZernike,UDCT, and so forth) and their respective SDs (Zernike, DCT, etc.)  #@NEW_LINE#@#  are calculated in a similar fashion.  #@NEW_LINE#@#  
Therefore, each character k is represented by the following vector (of size 7JL), concatenating the respective normalized row vectors of the distance matrices:uk=(uSIFTkSIFT||uZernikekZernike||uDCTkDCT||uKdtreekKdtree||uProjkProj||uL1kL1||uCMIkCMI)7JL.In this fashion, each character is described by the degree of its kinship to all of the characters, using all of the various features.  #@NEW_LINE#@#  
Finally, the distance between characters i and j is calculated according to the Euclidean distance between their generalized feature vectors:chardist(i,j)=uiuj2.The main purpose of this distance is to serve as a basis for clustering at the next stage of the analysis.  #@NEW_LINE#@#  

Hypothesis_Testing  #@NEW_LINE#@#  
At this stage we address the main question raised above: What is the probability that two given texts were written by the same author?  #@NEW_LINE#@#  Commonly, similar questions are addressed by posing an alternative null hypothesis H0 and attempting to reject it.  #@NEW_LINE#@#  In our case, for each pair of ostraca, the H0 is both texts were written by the same author.  #@NEW_LINE#@#  This is performed by conducting an experiment (detailed below) and calculating the probability (P[0,1]) of an affirmative answer to H0.  #@NEW_LINE#@#  If this event is unlikely (P0.2), we conclude that the documents were written by two different individuals (i.e., reject H0).  #@NEW_LINE#@#  However, if the occurrence of H0 is probable (P0.2), we remain agnostic.  #@NEW_LINE#@#  We reiterate that in the latter case we cannot conclude that the two texts were in fact written by a single author.  #@NEW_LINE#@#  
The experiment, which is designed to test H0, is composed of several substeps (illustrated in Fig S3):  #@NEW_LINE#@#  
P=|{i|MPiMPI}|NC.That is, P is the proportion of valid combinations with at least the same observational MP.  #@NEW_LINE#@#  This is analogous to integrating over a tail of a probability density function.  #@NEW_LINE#@#  
The rationale behind this calculation is based on the scenario of two authors (negation of H0).  #@NEW_LINE#@#  In such a case, we expect the k-means clustering to provide a sound separation of their characters (Fig S3D), that is, I and II would closely resemble A and B (or B and A).  #@NEW_LINE#@#  This would result in MPI being close to 1.  #@NEW_LINE#@#  Furthermore, the proportion of valid combinations with MPiMPI will be meager, resulting in a low P. In such a case, the H0 hypothesis would be justifiably rejected.  #@NEW_LINE#@#  
In the opposite scenario of a single author:  #@NEW_LINE#@#  
Either way, in this scenario, we will not be able to reject the H0 hypothesis.  #@NEW_LINE#@#  
Notes:  #@NEW_LINE#@#  
As specified, substeps ivi are applied to one specific letter of the alphabet (e.g., alep) present (in sufficient quantities) in the pair of texts under comparison.  #@NEW_LINE#@#  However, we can often gain additional statistical significance if several different letters (e.g., alep, he, waw, etc.)  #@NEW_LINE#@#  are present in the compared documents.  #@NEW_LINE#@#  In such circumstances, several independent experiments are conducted (one for each letter), resulting in corresponding Ps.  #@NEW_LINE#@#  We combine the different values into a single P via the well-established Fisher method (ref.  #@NEW_LINE#@#  33; in case no comparison can be conducted for any letter in the alphabet, we assign P = 1).  #@NEW_LINE#@#  This end product represents the probability that H0 is true based on all of the evidence at our disposal.  #@NEW_LINE#@#  


Experiment_Details_and_Results  #@NEW_LINE#@#  
Our experiments were conducted on two large datasets.  #@NEW_LINE#@#  The first is a set of samples collected from contemporary writers of Modern Hebrew (www-nuclear.tau.ac.il/eip/ostraca/DataSets/Modern_Hebrew.zip).  #@NEW_LINE#@#  This dataset allowed us to test the soundness of our algorithm.  #@NEW_LINE#@#  It was not used for parameter-tuning purposes, however, because the algorithm was kept as parameter-free as possible.  #@NEW_LINE#@#  The second dataset contained information from various Arad Ancient Hebrew ostraca, dated to ca.  #@NEW_LINE#@#  600 BCE, described in detail in the main text (www-nuclear.tau.ac.il/eip/ostraca/DataSets/Arad_Ancient_Hebrew.zip).  #@NEW_LINE#@#  Following are the specifications and the results of our experiments for both datasets.  #@NEW_LINE#@#  
Modern_Hebrew_Experiment  #@NEW_LINE#@#  
The handwritings of 18 individuals i=1,...,18 were sampled.  #@NEW_LINE#@#  Each individual filled in a Modern Hebrew alphabet table consisting of 10 occurrences of each letter, out of the 22 letters in the alphabet (the number of letters and their names are the same as in Ancient Hebrew; see Fig S4 for a table example).  #@NEW_LINE#@#  These tables were scanned and their characters were segmented.  #@NEW_LINE#@#  For a complete dataset of the characters, see www-nuclear.tau.ac.il/eip/ostraca/DataSets/Modern_Hebrew.zip.  #@NEW_LINE#@#  
From this raw data, a series of simulated inscriptions were created.  #@NEW_LINE#@#  Owing to the need to test both same-writer and different-writer scenarios, the data for each writer were split.  #@NEW_LINE#@#  Furthermore, to imitate a common situation in the Arad corpus, where the scarcity of data is prevalent (Table S3), each simulated inscription used only three letters (i.e., 15 characters, 5 characters for each letter).  #@NEW_LINE#@#  In total, 252 inscriptions were simulated in the following manner:  #@NEW_LINE#@#  
In this fashion, for constant i and g, we can test whether our algorithm arrives at wrong rejection of H0 for Si,g,1 and Si,g,2 (FP indicates false-positive error; 18 writers and 7 groups producing 126 tests in total).  #@NEW_LINE#@#  Additionally, for constant g, 1ij18, and b,c{1,2}, we can test whether our algorithm fails to correctly reject H0 for Si,g,b and Sj,g,c (FN indicates false-negative error [(18 × 17)/2] × 7 × 2 × 2 = 4,284 tests in total).  #@NEW_LINE#@#  
The results of the Modern Hebrew experiment are summarized in Table S2.  #@NEW_LINE#@#  It can be seen that in modern context the algorithm yields reliable results in 98% of the cases (about 2% of both FP and FN errors).  #@NEW_LINE#@#  These results signify the soundness of our algorithmic sequence.  #@NEW_LINE#@#  The successful and significant results on the Modern Hebrew dataset paved the way for the algorithms application on the Arad Ancient Hebrew corpus.  #@NEW_LINE#@#  

Arad_Ancient_Hebrew_Experiment  #@NEW_LINE#@#  
As specified in the main text, the core experiment addresses ostraca from the Arad fortress, located on the southern frontier of the kingdom of Judah.  #@NEW_LINE#@#  These inscriptions belong to a short time span of a few years, ca.  #@NEW_LINE#@#  600 BCE, and are composed of army correspondence and documentation.  #@NEW_LINE#@#  
The texts under examination are 16 ostraca: 1, 2, 3, 5, 7, 8, 16, 17, 18, 21, 24, 31, 38, 39, 40, and 111.  #@NEW_LINE#@#  Ostraca 17 and 39 contain writing on both sides of the potshard and were treated as separate texts (17a and 17b and 39a and 39b), resulting in 18 texts under examination.  #@NEW_LINE#@#  As stated in the algorithm description, we assume that each text was written by a single author.  #@NEW_LINE#@#  A short summary of the content of the texts can be seen in Table 1.  #@NEW_LINE#@#  
The seven letters we used were alep, he, waw, yod, lamed, shin, and taw, because they were the most prominent and simple to restore.  #@NEW_LINE#@#  In the abovementioned ostraca, out of the 670 deciphered characters of these types in the original publication (6), 501 legible characters were restored, based upon computerized images of the inscriptions.  #@NEW_LINE#@#  These images were obtained by scanning the negatives taken by the Arad expedition (courtesy of the Israel Antiquities Authority and the Institute of Archaeology of Tel Aviv University).  #@NEW_LINE#@#  After performing a manual quality assurance procedure (verifying the adherence of the restored characters to the original image; Fig S2D), 427 restored characters remained.  #@NEW_LINE#@#  The resulting letters statistics for each text are summarized in Table S3.  #@NEW_LINE#@#  For a complete dataset of the characters, see www-nuclear.tau.ac.il/eip/ostraca/DataSets/Arad_Ancient_Hebrew.zip.  #@NEW_LINE#@#  In addition, a comparison between several specimens of the letter lamed is provided in Fig S5.  #@NEW_LINE#@#  
We reiterate that our algorithm requires a minimal number of characters to compare a pair of texts.  #@NEW_LINE#@#  For example, when we compared ostraca 31 and 38, the letters in use were he (7:1 characters), waw (6:2 characters), and yod (4:2 characters).  #@NEW_LINE#@#  The three independent tests respectively yielded P=0.125, P=0.25, and P=1.  #@NEW_LINE#@#  Their combination through Fishers method resulted in the final value of P=0.327, not passing the preestablished threshold.  #@NEW_LINE#@#  Therefore, in this case, we remain agnostic with respect to the question of common authorship.  #@NEW_LINE#@#  However, the comparison of texts 1 and 24 used all possible letters, alep, he, waw, yod, lamed, shin, and taw, resulting in Ps of 0.559, 0.00366, 0.375, 0.119, 0.0286, 0.429, and 0.0769, respectively.  #@NEW_LINE#@#  The combined result was P=0.003, passing the threshold of 0.2.  #@NEW_LINE#@#  Therefore, in the latter case, we reject the H0 hypothesis and conclude that these texts were written by two different individuals.  #@NEW_LINE#@#  
The complete comparison results are summarized in Table 1.  #@NEW_LINE#@#  We can observe six pairwise distinct quadruplets of texts: (i) 7, 17a, 24, and 40; (ii) 5, 17a, 24, and 40; (iii) 7, 18, 24, and 40; (iv) 5, 18, 24, and 40; (v) 7, 18, 24, and 31; and (vi) 5, 18, 24, and 31.  #@NEW_LINE#@#  The existence of no less than six such combinations indicates the high probability that the corpus indeed contains at least four different authors.  #@NEW_LINE#@#  As specified in the main text, additional (contextual) considerations can raise this number up to at least six distinct writers.  #@NEW_LINE#@#  Among these, the different authors of the prosaic lists of names in ostraca 31 and 39 were most likely located at the tiny fort of Arad, implying the composition by authors who were not professional scribes.  #@NEW_LINE#@#  For the full implications of our results, see the main text.  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
This research was made possible by the dedicated work of Ms. Maayan Mor.  #@NEW_LINE#@#  The kind assistance of Dr. Shirly Ben-Dor Evian, Ms. Sivan Einhorn, Ms. Noa Evron, Dr. Anat Mendel, Ms. Myrna Pollak, Mr. Michael Cordonsky, and Mr. Assaf Kleiman is greatly appreciated.  #@NEW_LINE#@#  We also thank the PNAS editor and the reviewers for their helpful comments and suggestions.  #@NEW_LINE#@#  A.S. thanks the Azrieli Foundation for the award of an Azrieli Fellowship.  #@NEW_LINE#@#  Ostracon images are courtesy of the Institute of Archaeology, Tel Aviv University, and of the Israel Antiquities Authority.  #@NEW_LINE#@#  The research reported here received initial funding from the Israel Science Foundation  F.I.R.S.T.  #@NEW_LINE#@#  (Bikura) Individual Grant 644/08, as well as Israel Science Foundation Grant 1457/13.  #@NEW_LINE#@#  The research was also funded by the European Research Council under the European Communitys Seventh Framework Programme (FP7/2007-2013)/ERC Grant Agreement 229418, and by an Early Israel grant (New Horizons project), Tel Aviv University.  #@NEW_LINE#@#  This study was also supported by a generous donation from Mr. Jacques Chahine, made through the French Friends of Tel Aviv University.  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  


