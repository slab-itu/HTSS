article id="http://dx.doi.org/10.1073/pnas.1617252114"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Quantifying the driving factors for language shift in a bilingual region  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
Languages are an important part of our culturally diverse world, yet many of todays languages are in danger of dying out.  #@NEW_LINE#@#  To save endangered languages, one must first understand the dynamics behind language shift: what are the driving factors of people giving up one language for another?  #@NEW_LINE#@#  Here, we model language dynamics in time and space starting from empirical data.  #@NEW_LINE#@#  We show that it is the interaction with speakers of the same language that fundamentally determines spread and retreat of a language.  #@NEW_LINE#@#  This means that a minimum-sized neighborhood of speakers interacting with each other is essential to preserve the language.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Many of the worlds around 6,000 languages are in danger of disappearing as people give up use of a minority language in favor of the majority language in a process called language shift.  #@NEW_LINE#@#  Language shift can be monitored on a large scale through the use of mathematical models by way of differential equations, for example, reactiondiffusion equations.  #@NEW_LINE#@#  Here, we use a different approach: we propose a model for language dynamics based on the principles of cellular automata/agent-based modeling and combine it with very detailed empirical data.  #@NEW_LINE#@#  Our model makes it possible to follow language dynamics over space and time, whereas existing models based on differential equations average over space and consequently provide no information on local changes in language use.  #@NEW_LINE#@#  Additionally, cellular automata models can be used even in cases where models based on differential equations are not applicable, for example, in situations where one language has become dispersed and retreated to language islands.  #@NEW_LINE#@#  Using data from a bilingual region in Austria, we show that the most important factor in determining the spread and retreat of a language is the interaction with speakers of the same language.  #@NEW_LINE#@#  External factors like bilingual schools or parish language have only a minor influence.  #@NEW_LINE#@#  

Percentage of Slovenian speakers in southern Carinthia according to census results.  #@NEW_LINE#@#  (A) Geographic location of southern Carinthia.  #@NEW_LINE#@#  The study area is indicated by the orange rectangle in the map at Bottom Left.  #@NEW_LINE#@#  (B) Census results for 1880.  #@NEW_LINE#@#  (C) Census results for 2001.  #@NEW_LINE#@#  Cells without any Slovenian speakers (0%) are shown in white.  #@NEW_LINE#@#  Each square marks a 1 × 1-km cell.  #@NEW_LINE#@#  Contour lines are in brown, and rivers and lakes are in gray.  #@NEW_LINE#@#  The two biggest Carinthian towns, Villach and the capital Klagenfurt, are encircled according to present administration.  #@NEW_LINE#@#  
Limits_of_the_Classic_Macroscopic_ReactionDiffusion_Approach  #@NEW_LINE#@#  
In the past, language spread and retreat were mostly investigated on a macroscale using differential equations.  #@NEW_LINE#@#  Macroscopic approaches gained popularity after Abrams and Strogatz (12) published a short seminal paper in 2003 describing the retreat of languages with what they called lower status by differential equations.  #@NEW_LINE#@#  Their differential equation system considered only temporal and no spatial development, but the paper has drawn a tail of publications in its wake, many of them including spatial development.  #@NEW_LINE#@#  Spatial and temporal development of languages are usually combined in reactiondiffusion equations (1319) of the form u/t = D·2u/x2 + f(u).  #@NEW_LINE#@#  These types of equation are also used in other fields, for example, biology or chemistry, to describe all kinds of spread phenomena (20).  #@NEW_LINE#@#  
Considering a language with higher status, for example, German vs. Slovenian in Carinthia, the development of the fraction uG(x,t) of German speakers in the total population can be written as a reactiondiffusion equation following Fishers equation for advantageous genes (21):uG/t=DG2uG/x2+kuG(1uG).  #@NEW_LINE#@#  [1]Here, DG is the diffusivity of German language and k is the conversion rate from Slovenian to German.  #@NEW_LINE#@#  The fraction of Slovenian speakers is given by uS = 1  uG.  #@NEW_LINE#@#  
In Carinthia, the language front between German and Slovenian essentially advances only southward motivating a one-dimensional treatment.  #@NEW_LINE#@#  Eq.  #@NEW_LINE#@#  1 then results in a traveling front of the higher status language (in this case German) with velocity v:v=2DGk.  #@NEW_LINE#@#  [2]We defined the front as the line bordering all cells with more than 50% Slovenian speakers each without including outlier cells detached from the contiguous language area (Fig 2A).  #@NEW_LINE#@#  
From the data, the velocity of the language front can be derived (Table S1) and the product of diffusivity and conversion rate DG·k can be determined (Supporting Information).  #@NEW_LINE#@#  If data on the conversion rate are available, the diffusivity of the majority language can be estimated.  #@NEW_LINE#@#  
In the period 19712001, no contiguous language area exists due to the large decrease in the number of Slovenian speakers (Fig 2B).  #@NEW_LINE#@#  The cells with significant fractions of minority language have become dispersed and the minority language has retreated to language islands.  #@NEW_LINE#@#  Hence there is no continuous language front that clearly separates the two language areas of Slovenian and German.  #@NEW_LINE#@#  From this, it is evident that the concept of a language front fails when the minority language no longer covers a contiguous area, and reactiondiffusion equations and the resulting language front are not applicable in this case.  #@NEW_LINE#@#  
Noting the limits of treatment by reactiondiffusion equations, we take a different approach.  #@NEW_LINE#@#  We simulate the microdevelopment on the basis of the smallest registered population units, hence providing a spatially much more detailed description of language spread and retreat than the macroscale description by reactiondiffusion equations.  #@NEW_LINE#@#  As a result, we can follow not only global development over time and space but also local processes such as the deviating dynamics in urban areas.  #@NEW_LINE#@#  

Materials_and_Methods  #@NEW_LINE#@#  
We start by taking the data of the censuses in the former Austro-Hungarian Empire that were held in 10-y intervals beginning from 1880 until 1910.  #@NEW_LINE#@#  Such censuses were continued in the Federal Republic of Austria from 1971 until 2001.  #@NEW_LINE#@#  In between, the two world wars and the after-war turbulences prevented consistent censuses and data with the same level of detail is not available.  #@NEW_LINE#@#  In the censuses together with several other items, the vernacular language of each person was asked for and registered.  #@NEW_LINE#@#  In the censuses until 1910, only one language could be recorded in the questionnaire, whereas in the censuses after 1971 also bilingualism could be indicated.  #@NEW_LINE#@#  For the sake of simplicity and consistency and data with the same level of detail is not available, we included bilingual SlovenianGerman speakers in the minority group, that is, Slovenian speakers.  #@NEW_LINE#@#  In this paper, we do not consider bilingualism as a separate speaker state.  #@NEW_LINE#@#  We neither consider the different Slovenian and German dialects that are not encoded in the census data.  #@NEW_LINE#@#  From the census results, we read the number of German and Slovenian speakers in each of the 1,500 population units (hamlets, villages, and towns) in southern Carinthia.  #@NEW_LINE#@#  
Mapping_the_Data  #@NEW_LINE#@#  
For our study of language dynamics in Carinthia, the area investigated is subdivided into a quadratic grid with cells sized 1 × 1 km.  #@NEW_LINE#@#  Carinthia spans 2.4° of longitude or 184 km (east border to west border) and 0.8° of latitude or 84 km (north border to south border).  #@NEW_LINE#@#  We thus cover the total area of Carinthia with a regular grid of 84 × 184 = 15,456 cells of 1 × 1 km each.  #@NEW_LINE#@#  Of these 15,456 cells, 9,549 comprise the actual area of Carinthia.  #@NEW_LINE#@#  A total of 1,170 of the cells inside the Carinthian borders is populated by data for speakers in southern Carinthia.  #@NEW_LINE#@#  Data for the number of speakers was extracted from census records for the period from 1880 to 1910 (2225) and the raw dataset for 19712001 (special evaluation commissioned from Statistics Austria).  #@NEW_LINE#@#  Digitized data can be accessed on figshare (https://figshare.com/articles/Language_use_in_Carinthia/4535399).  #@NEW_LINE#@#  Speaker data are assigned to cells based on the geographic coordinates of the population unit.  #@NEW_LINE#@#  Geographic coordinates (WGS 84) were obtained from KAGIS Kärnten Atlas (https://gis.ktn.gv.at/).  #@NEW_LINE#@#  The 10-y periods between the censuses are divided into 1-y time steps for the simulation.  #@NEW_LINE#@#  

Language_Shift_Model  #@NEW_LINE#@#  
As a first basic model, we assume that in each cell after 1 ys time the probability p(r, t + 1) to speak a language  will be proportional to the local number of speakers of that language in the preceding year n(r, t) plus an increase through interaction F(r, t) with speakers of the same language in the neighborhood cells.  #@NEW_LINE#@#  p(r, t + 1) is normalized to the total number of speakers and the total interaction in that cell.  #@NEW_LINE#@#  We obtain Eq.  #@NEW_LINE#@#  3 for the probability p(r, t + 1) to speak language  (where  = G or S, German or Slovenian) in the cell located at position r at time t + 1p(r,t+1)=n(r,t)+F(r,t)nS(r,t)+FS(r,t)+nG(r,t)+FG(r,t).  #@NEW_LINE#@#  [3]  #@NEW_LINE#@#  
To calculate p for the first year of the simulation, F and n are calculated from the initial census data.  #@NEW_LINE#@#  Afterward, F and n are calculated for each year from the result of the preceding year as follows.  #@NEW_LINE#@#  
The number of speakers of a language  at position r at time t, n(r, t), is given by Eq.  #@NEW_LINE#@#  4: the probability p(r, t) to speak the language  at time t multiplied by the total number of people in the cell ntotal(r, t), which for each time step and cell is given by linear interpolation between censuses:n(r,t)=ntotal(r,t)p(r,t).  #@NEW_LINE#@#  [4]  #@NEW_LINE#@#  
Each interaction term F(r, t) is a sum over the contributions of all other cells surrounding the initial cell at position r. The interaction F with speakers of the same language  in the neighboring cells at rj is as follows:F(r,t):=F(r,n,t)=rjrc(r,rj,n,t).  #@NEW_LINE#@#  [5]  #@NEW_LINE#@#  
The contributions c(r, rj, n, t) of all other cells positioned at rj surrounding the initial cell at position r are modeled by Gaussian functions identical to distributions describing the diffusion of particles in physics or chemistry:c(r,rj,n,t)=n(rj,t)4Dtexp(|rrj|24Dt),[6]  #@NEW_LINE#@#  
where D are the diffusivities of each language, that is, measures for their spread.  #@NEW_LINE#@#  The diffusivities can also be seen as a measure for the region of influence of a language.  #@NEW_LINE#@#  We set t = 1 y because c is calculated individually for each year from the result of the preceding year.  #@NEW_LINE#@#  
The Gaussian function is a simple choice to model the interaction with neighboring cells and provides a good fit with the census data.  #@NEW_LINE#@#  In an extension of our model, this interaction could be modeled by other functions such as leptokurtic (long-tail) distributions or combinations of functions to describe more complex interaction patterns, for example, both long-range and short-range interaction.  #@NEW_LINE#@#  

Evaluation_Procedure  #@NEW_LINE#@#  
Simulations were performed using GNU Octave 4.0.0.  #@NEW_LINE#@#  The data from the first census in each period (1880 and 1971) were set as the initial state from which the number of speakers in each cell changes according to Eqs.  #@NEW_LINE#@#  3 and 4, assuming a linear population development between censuses.  #@NEW_LINE#@#  To evaluate the goodness of fit between simulated data and census data, we use ordinary least squares (OLS) to minimize the squared sum of errors:OLS=t=1m1i=1n(OiEi)2,[7]  #@NEW_LINE#@#  
where Oi is an observed data point (census data) and Ei is an estimated data point (simulated data).  #@NEW_LINE#@#  t is the number of times the observed data can be compared with the estimated data.  #@NEW_LINE#@#  t runs from 1 to m  1, where m is the number of censuses within the period.  #@NEW_LINE#@#  The data from the first census in each period are excluded as they are equivalent to the initial state of the system; hence there is no error for the initial state and we sum only over the remaining censuses.  #@NEW_LINE#@#  Optimization was done using the NelderMead method (26).  #@NEW_LINE#@#  Additionally, we used least absolute errors (LAE) as follows:LAE=t=1m1i=1n|OiEi|,[8]  #@NEW_LINE#@#  
that is, minimizing the sum of the absolute errors to check the reliability of the fit.  #@NEW_LINE#@#  General model performance is evaluated by comparison with a baseline.  #@NEW_LINE#@#  Comparison values can be found in Table S2.  #@NEW_LINE#@#  


Results  #@NEW_LINE#@#  
Language_Shift_in_the_Period_18801910  #@NEW_LINE#@#  
The widths of both Gaussians, and hence the diffusivities for German and Slovenian, are fitted to the number of speakers in each cell as given by the census data.  #@NEW_LINE#@#  Fits to the census data were performed for the period from 1880 to 1910.  #@NEW_LINE#@#  The best solution was achieved with the values given in Table 1.  #@NEW_LINE#@#  
Fig 3 shows the increase (red) and decrease (blue) of the number of Slovenian speakers in southern Carinthia for census data and simulated data.  #@NEW_LINE#@#  We obtain satisfactory agreement between the empirical data and the predicted data on a microscopic scale.  #@NEW_LINE#@#  In detail, this can be seen in Fig S1 where the model's errors are shown for cells with different numbers of Slovenian speakers.  #@NEW_LINE#@#  The total number of Slovenian speakers as predicted by the simulation also agrees with the census data (Fig S2).  #@NEW_LINE#@#  Fig S3 shows the residuals (census data minus simulated data).  #@NEW_LINE#@#  Thus, our model is able to follow how either language has spread and retreated in the time period 18801910.  #@NEW_LINE#@#  

Extension_of_the_Model_Through_Habitat_Parameters  #@NEW_LINE#@#  
In a second step, for the period from 1880 to 1910, the influence of habitat conditions, such as the influence of urban areas, that is, major towns, the language of schools, and language in parishes, was investigated.  #@NEW_LINE#@#  To this end, we introduced a habitat parameter hi into Eq.  #@NEW_LINE#@#  3, which modifies the effect of local speakers by an exponential function with the argument (±Hhi).  #@NEW_LINE#@#  The multiplicative factor H indicates the presence (H = 1) or absence (H = 0) of a local habitat condition, that is, H = 1 for the two largest towns Klagenfurt and Villach or if a bilingual school or Slovenian parish existed.  #@NEW_LINE#@#  Otherwise, H is set to zero.  #@NEW_LINE#@#  The exponential function was chosen as a modifier because it is a simple function, which for small hi adds nhi to the speaker effect if H = 1, while recovering the basic model (Eq.  #@NEW_LINE#@#  3) if H = 0.  #@NEW_LINE#@#  We obtain the following equation for the probability p(r, t + 1) of speaking a language  at position r and time t + 1:p(r,t+1)=n(r,t)exp(±Hhi)+F(r,t)nS(r,t)exp(+Hhi)+FS(r,t)+nG(r,t)exp(Hhi)+FG(r,t).  #@NEW_LINE#@#  [9]Optimization was performed as before.  #@NEW_LINE#@#  Of the three investigated parameters (urban areas, bilingual schools, and parish language), only that of bilingual schools showed a small influence (Supporting Information).  #@NEW_LINE#@#  However, the influence is so small that Fig 3B does not visibly change with the introduction of the bilingual-schools habitat parameter.  #@NEW_LINE#@#  

Language_Shift_in_the_Period_19712001  #@NEW_LINE#@#  
After simulating the language dynamics during the Austro-Hungarian Empire, we now turn to language development in the second period after the two world wars.  #@NEW_LINE#@#  The development from 1971 to 2001 was first pursued using the same basic model (Eqs.  #@NEW_LINE#@#  3 and 4).  #@NEW_LINE#@#  Table 1 shows the numerical results and Fig 4 A and B shows the increase (red) and decrease (blue) of the number of Slovenian speakers in southern Carinthia for census data and simulation.  #@NEW_LINE#@#  We also investigated the influence of two habitat parameters for this period: urban areas and parish language.  #@NEW_LINE#@#  Only the urban habitat parameter resulted in a noticeable difference in goodness of fit (Fig 4C and Supporting Information).  #@NEW_LINE#@#  Errors depending on the number of Slovenian speakers present are shown as before in Fig S1.  #@NEW_LINE#@#  

Local_Differences_in_the_Language_Diffusivities  #@NEW_LINE#@#  
We have cut out three regions in the districts of Völkermarkt, Klagenfurt, and Villach to search for local differences in the diffusion behavior: is there a difference between rural and urban regions?  #@NEW_LINE#@#  
In all three regions in the districts of Völkermarkt, Klagenfurt, and Villach, the diffusivity of the Slovenian language DS is between 25 and 50% lower than the diffusivity of the German language DG, with the largest difference (factor of 2) for the urban region of Klagenfurt.  #@NEW_LINE#@#  We suppose that the discrepancies between the different regions are due to local differences in language spread and retreat because of differences in geography and population distribution: faster diffusion in urban areas, German diffusing particularly faster than Slovenian in urban region of Klagenfurt.  #@NEW_LINE#@#  


Conclusion_and_Discussion  #@NEW_LINE#@#  
Macroscopic_vs_Microscopic_Models  #@NEW_LINE#@#  
In the past, language dynamics have been commonly described on a macroscopic scale by reactiondiffusion equations that model the fraction of speakers of a language in the population.  #@NEW_LINE#@#  However, this treatment breaks down when the spread of one language and the retreat of the other one no longer follows a traveling front because one language has become dispersed and has retreated to language islands (Fig 2B).  #@NEW_LINE#@#  Additionally, reactiondiffusion equations are not applicable at all in areas without any language front movement such as behind mountain chains (green arrows in Fig 2A).  #@NEW_LINE#@#  In contrast, the development can still be followed and predicted in both cases with our microscopic model.  #@NEW_LINE#@#  The microscopic model also takes into account the interaction with all neighboring cells, whereas in the case of a macroscopic language front the interaction only comes from one direction.  #@NEW_LINE#@#  Thus, microscopic models yield a more detailed and complete description of language spread and retreat than macroscopic treatment by reactiondiffusion equations.  #@NEW_LINE#@#  
A challenge for microscopic models on a realistic basis is obviously the need for empirical detailed data (as were at hand for this work) from which to determine the diffusivities.  #@NEW_LINE#@#  For this reason, language censuses have to be conducted in regular intervals and with fine-grained spatial resolution.  #@NEW_LINE#@#  

What_Drives_Language_Shift?  #@NEW_LINE#@#  
We have shown that the data predicted by our basic model (Eqs.  #@NEW_LINE#@#  3 and 4) show satisfactory agreement with the historical data for the period between 1880 and 1910.  #@NEW_LINE#@#  Even in different socioeconomic conditions (the second period between 1971 and 2001), the predicted data still match the empirical data.  #@NEW_LINE#@#  This means that the basic model can reliably reproduce language dynamics of the studied language competition between Slovenian and German.  #@NEW_LINE#@#  
The model is also able to reveal similarities between physical phenomena like atomic diffusion and social phenomena like language shift: by modeling linguistic interaction as a Gaussian function as in models of physical diffusion, we obtain good agreement between the predicted and the empirical data.  #@NEW_LINE#@#  Thus, we have illustrated that it is possible to use physical models to simulate social dynamics on a large scale over time and space.  #@NEW_LINE#@#  
The basic model uses only two parameters to calculate the probability of speaking a language: the number of speakers in the preceding year and interaction between speakers.  #@NEW_LINE#@#  Both of these can be directly calculated from census data, ensuring our model is applicable even in situations where data on other factors influencing language use (e.g., perceived status of a language) is not available or even possible to obtain.  #@NEW_LINE#@#  Without interaction (i.e., using only the number of speakers), the probability of speaking a language (Eq.  #@NEW_LINE#@#  3) remains constant.  #@NEW_LINE#@#  Consequently, interaction with other speakers is an essential drive for the linguistic change in each cell.  #@NEW_LINE#@#  This point has been argued by linguists (27) and is validated by our simulation.  #@NEW_LINE#@#  The number of speakers of a language in the population units (hamlets, villages, towns) neighboring the given cell is therefore an important influence on language dynamics.  #@NEW_LINE#@#  This means that a minimum-sized neighborhood of speakers of the minority language interacting with each other is necessary to preserve the language.  #@NEW_LINE#@#  
In addition, the simulation shows that other habitat conditions (the language of schools, and in parishes) are of minor influence.  #@NEW_LINE#@#  There is, however, a noticeable effect of urban areas, which have their own dynamics: between 1880 and 1910, Slovenian decays slightly faster in the larger towns than predicted by the basic model; between 1971 and 2001, the development is reversed, that is, the number of Slovenian speakers increases at a higher rate in large towns than predicted by the basic model (Supporting Information).  #@NEW_LINE#@#  This reverse in development might be attributed to language playing a larger role in peoples identity in an increasingly mobile society (after 1971) compared with a largely rural society (as between 1880 and 1910).  #@NEW_LINE#@#  When language makes up a larger part of ones identity, there might be a higher tendency to preserve or revive it.  #@NEW_LINE#@#  This preservation happens, for example, through language associations and cultural clubs, which commonly originate in large towns and consequently have their largest impact there (3).  #@NEW_LINE#@#  With our model, it is possible to follow these different local developments and quantify the strength of their influence.  #@NEW_LINE#@#  
As interaction is the driving force for linguistic change in our model, it also offers a tool for possible future work on how interaction shapes language use: what happens when the interaction with speakers of the same language is considerably higher than the interaction with speakers of a different language?  #@NEW_LINE#@#  How much interaction with the same language (vs. interaction with a different language) is needed for the preservation of the minority language?  #@NEW_LINE#@#  


Language_Front_Velocity  #@NEW_LINE#@#  
To measure front velocity per year for the period 1880 (t1) to 1910 (t2) directly from the census data (Fig 2A), we horizontally divide the language front into n points.  #@NEW_LINE#@#  For each point Pi of the language front, we then determine the northsouth difference between its two positions Pi(t1) and Pi(t2).  #@NEW_LINE#@#  The difference between points is divided by the number of years between 1880 and 1910:v=i=1nPi(t2)Pi(t1)30n.  #@NEW_LINE#@#  [S1]This measured velocity can then be compared with the velocity of the traveling front (Eq.  #@NEW_LINE#@#  2) resulting from the reactiondiffusion equation (Eq.  #@NEW_LINE#@#  1).  #@NEW_LINE#@#  For calculating the velocity from Eq.  #@NEW_LINE#@#  2, we use the diffusivity DG deduced from the fits (Table 1) and the language conversion rate k derived from the original census data.  #@NEW_LINE#@#  
To obtain the language conversion rate k, we use census data from 1880 (t1) and 1910 (t2) and calculate the fraction uG of German speakers in the population.  #@NEW_LINE#@#  For pure growth (diffusion term in Eq.  #@NEW_LINE#@#  1 neglected) and dividing by the number of years between 1880 and 1910, k becomes the following:k=uG(t2)uG(t1)uG¯(1uG¯)/30,[S2]where uG¯ is the average between uG(t1) and uG(t2).  #@NEW_LINE#@#  In 1880, there were 102,314 German and 85,369 Slovenian speakers in southern Carinthia.  #@NEW_LINE#@#  In 1910, there were 154,361 German and 65,352 Slovenian speakers in southern Carinthia.  #@NEW_LINE#@#  Assuming the error in census data to be 10%, we obtain k = 0.0224 ± 0.0065/y.  #@NEW_LINE#@#  
Results are given in Table S1.  #@NEW_LINE#@#  We see that the velocity calculated from the reactiondiffusion equation (Eq.  #@NEW_LINE#@#  2) is considerably higher than the velocity derived from the census data.  #@NEW_LINE#@#  This is due to the fact that the velocity derived from census data averages over the whole area.  #@NEW_LINE#@#  However, there is no movement of the language front where the minority region borders unpopulated areas as is the case in large parts of the minority region (Fig 2A), whereas reactiondiffusion equations assume that there is a moving language front everywhere.  #@NEW_LINE#@#  This shows an important limitation of treatment by reactiondiffusion equations: reactiondiffusion equations are not applicable in the absence of pressure from a region consisting mainly of speakers of the majority language, which leads to front movement.  #@NEW_LINE#@#  

Extension_of_the_Model_Through_Habitat_Parameters  #@NEW_LINE#@#  
To describe external influences such as larger towns, schools, or parishes, we introduced a habitat parameter hi into Eq.  #@NEW_LINE#@#  3 (see Eq.  #@NEW_LINE#@#  9), which modifies the effect of local speakers as follows:n(r,t)n(r,t)exp(±Hhi).  #@NEW_LINE#@#  [S3]We assume that the effect is symmetrical, that is, if the effect on Slovenian speakers is given by nSexp(+Hhi), then the effect on German speakers is given by nGexp(Hhi).  #@NEW_LINE#@#  In the presence of an external influence i, H is set to 1 and the coefficient hi gives the strength of influence.  #@NEW_LINE#@#  In cells without an external influence, H = 0 and Eq.  #@NEW_LINE#@#  3 is recovered.  #@NEW_LINE#@#  The exponential function was chosen as a modifier because it is a simple function that for small hi adds nhi to the speaker effect if H = 1, while recovering the basic model (Eq.  #@NEW_LINE#@#  3) if H = 0.  #@NEW_LINE#@#  

Urban_Centers  #@NEW_LINE#@#  
Language change patterns differ depending on whether the environment is rural or urban.  #@NEW_LINE#@#  Fishman (28) argues that speakers in an urban area are typically more likely to shift from the minority to the majority language, whereas the inhabitants of isolated rural areas resist language shift.  #@NEW_LINE#@#  Movement to larger urban agglomerations therefore increases the risk of giving up the minority language in favor of the majority language.  #@NEW_LINE#@#  
This development is marginally noticeable in the period from 1880 to 1910 for the two largest towns Klagenfurt and Villach.  #@NEW_LINE#@#  In these two towns, the number of Slovenian speakers decreases slightly faster than the basic model (Eqs.  #@NEW_LINE#@#  3 and 4) predicts.  #@NEW_LINE#@#  An interesting phenomenon appears between 1971 and 2001 when loss of minority language by moving to urban centers is reversed: the number of Slovenian speakers now definitely increases faster in urban centers than predicted by the basic model.  #@NEW_LINE#@#  These localized developments can be captured by our model by introducing a parameter h1 and setting H = 1 in the largest towns for each period (Klagenfurt and Villach).  #@NEW_LINE#@#  
Best fit for the period from 1971 to 2001 is provided by h1 = 0.025 ± 0.005. h1 is positive for this period, which means that Slovenian speakers have more impact (Eq.  #@NEW_LINE#@#  S3).  #@NEW_LINE#@#  The model with this urban habitat parameter better describes the actual data in these urban centers in the sense that it better reproduces the direction of change, that is, decrease or increase.  #@NEW_LINE#@#  
The difference in Fig 4C between the outskirts and inner cells of the city of Klagenfurt is a result of the model dynamics: The outer cells have populated neighbor cells only on one side whereas the inner cells are completely surrounded by populated cells.  #@NEW_LINE#@#  Introducing a habitat condition h increases the probability of speaking Slovenian in the outer cells compared to the model without habitat.  #@NEW_LINE#@#  On the contrary, in the inner cells the effect of h is compensated by interaction (F) with German speakers in the neighboring cells and the increase in Slovenian speakers is not as strong.  #@NEW_LINE#@#  This color difference would vanish for larger values of h.  #@NEW_LINE#@#  

Bilingual_Schools  #@NEW_LINE#@#  
Between 1880 and 1910, so-called utraquistic elementary schools were meant to teach pupils in both languages (29).  #@NEW_LINE#@#  In 1880, these schools existed in 83 population units (villages and towns) in the bilingual region of southern Carinthia (30).  #@NEW_LINE#@#  We examined whether in these villages and towns (H = 1) the Slovenian language was preferentially preserved compared with localities where no such school existed.  #@NEW_LINE#@#  
Best fit for the period between 1880 and 1910 was achieved with h2 = 0.0224 ± 0.0050.  #@NEW_LINE#@#  From Eq.  #@NEW_LINE#@#  S3, it follows that the presence of an utraquistic school decreases the impact of existing Slovenian speakers.  #@NEW_LINE#@#  
After World War II the bilingual instruction system in the elementary schools was repeatedly changed and unfortunately no detailed data are available on how many pupils attended classes in Slovenian language.  #@NEW_LINE#@#  

Parishes  #@NEW_LINE#@#  
In villages with a Slovenian majority from 1880 to 1910, mostly Slovenian native-language speakers were hired as priests (31).  #@NEW_LINE#@#  They read the mass in Slovenian language.  #@NEW_LINE#@#  Altogether, there were 98 Slovenian-language parishes in the bilingual region in southern Carinthia in 1880 (32).  #@NEW_LINE#@#  We examined the influence of these parishes on the development of Slovenian by applying the same procedure as for the schools: H = 1 in villages or towns with masses in Slovenian, else H = 0.  #@NEW_LINE#@#  Neither in the first nor in the second period we could find a substantial influence of Slovenian-language parishes on the probability of speaking Slovenian.  #@NEW_LINE#@#  

Evaluating_Model_Performance  #@NEW_LINE#@#  
To evaluate model performance, a baseline for comparison is helpful.  #@NEW_LINE#@#  As a baseline, we use an interaction free model (F = 0), which means that the fraction of speakers of either language remains constant, speakers being lost or gained only through changing population size.  #@NEW_LINE#@#  To check if our model is better than the baseline, we use three metrics:  #@NEW_LINE#@#  
RMSE=1ni=1n(OiEi)2,[S4]  #@NEW_LINE#@#  
MAE=1ni=1n|OiEi|.  #@NEW_LINE#@#  [S5]For both errors, the result of the simulation after 30 y is compared with the census data at the end of each 30-y period.  #@NEW_LINE#@#  Results are given in Table S2, indicating that the model with interaction (and optionally with habitat parameters) consistently leads to a better fit than the baseline.  #@NEW_LINE#@#  Note that RMSE and MAE average over all cells.  #@NEW_LINE#@#  A more detailed look into the models error per category/number of speakers in a cell is given below.  #@NEW_LINE#@#  

Reliability_of_the_Model_per_Category  #@NEW_LINE#@#  
Fig S1 shows two measures of the models reliability: the MAE (Eq.  #@NEW_LINE#@#  S5) per category and grid cell and the relative error per category.  #@NEW_LINE#@#  To gain insight into where the model works best, we show the error per category to differentiate between cells with different numbers of Slovenian speakers.  #@NEW_LINE#@#  Both errors are given per 30 y, that is, the error in the result of the simulation after 30 y compared with the census data at the end of each 30-y period.  #@NEW_LINE#@#  
The relative error is given by the sum of absolute errors divided by the sum of the number of Slovenian speakers in this category:relativeerror=i=1n|OiEi|/i=1nSi,[S6]where Si is the number of Slovenian speakers per grid cell, summed over the n grid cells in this category.  #@NEW_LINE#@#  

Total_Sum_of_Slovenian_Speakers  #@NEW_LINE#@#  
Fig S2 shows the total sum of speakers of either language according to all eight censuses in both periods (1880, 1890, 1900, 1910, and 1971, 1981, 1991, 2001) in comparison with the simulated data.  #@NEW_LINE#@#  The agreement is satisfactory.  #@NEW_LINE#@#  

Deviation_of_Simulated_Data_from_Census_Data_over_Space  #@NEW_LINE#@#  
Fig S3 shows the residuals for the two periods (census data minus simulated data).  #@NEW_LINE#@#  Evident deviations in period 1 find their explanation in extraordinary outliers in the census data: some villages switched from a strong German-speaking majority to a strong Slovenian-speaking majority.  #@NEW_LINE#@#  The same also happened in the opposite direction.  #@NEW_LINE#@#  Both of these developments are very different from the average trend in southern Carinthia, which was a moderate transformation from Slovenian speaking to German speaking.  #@NEW_LINE#@#  In addition, several villages flip-flopped from one census to the next, changing from a German-speaking majority to a Slovenian-speaking majority and then back to a German-speaking majority and back again to a Slovenian-speaking majority in the last census of the period.  #@NEW_LINE#@#  This behavior, which seemed to be influenced by local politics rather than actual language use changes, cannot be captured by our model.  #@NEW_LINE#@#  The residuals thus show where language spread and retreat deviates from average development and open up possibilities for further research: what were the reasons for these deviations?  #@NEW_LINE#@#  Can these reasonswhich might be identified only by sociologically focused researchbe integrated into the model as a habitat factor?  #@NEW_LINE#@#  

Acknowledgments  #@NEW_LINE#@#  
We thank A. Gehart and W. Zöllner as well as A. Bauer (Statistics Austria) and P. Ibounig (Department of Statistics, Government of the State of Carinthia) for providing census data.  #@NEW_LINE#@#  We also thank the Klagenfurt University Library and the Archive of the Roman Catholic Diocese of Gurk-Klagenfurt for access to data about bilingual schools and parish language.  #@NEW_LINE#@#  Discussions with M. Glauninger (Department of German Studies, University of Vienna/Austrian Centre for Digital Humanities, Austrian Academy of Sciences) are gratefully acknowledged.  #@NEW_LINE#@#  We thank C. Dellago for critical comments on the manuscript.  #@NEW_LINE#@#  The geographical data (shapefiles) used for the figure backgrounds and contour lines are provided by Land Kärnten (https://www.data.gv.at/auftritte/?organisation=land-kaernten) under a CC-BY-3.0 license.  #@NEW_LINE#@#  Diverging color scale is based on www.ColorBrewer.org.  #@NEW_LINE#@#  K.P.  #@NEW_LINE#@#  is supported by a uni:docs fellowship from the University of Vienna.  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  


