article id="http://dx.doi.org/10.1073/pnas.1603929113"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Proteinprotein docking by fast generalized Fourier transforms on 5D rotational manifolds  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
Expressing the interaction energy as sum of correlation functions, fast Fourier transform (FFT) based methods speed the calculation, enabling the sampling of billions of putative proteinprotein complex conformations.  #@NEW_LINE#@#  However, such acceleration is currently achieved only on a 3D subspace of the full 6D rotational/translational space, and the remaining dimensions must be sampled using conventional slow calculations.  #@NEW_LINE#@#  Here we present an algorithm that employs FFT-based sampling on the 5D rotational space, and only the 1D translations are sampled conventionally.  #@NEW_LINE#@#  The accuracy of the results is the same as those of earlier methods, but the calculation is an order of magnitude faster.  #@NEW_LINE#@#  Also, it is inexpensive computationally to add more correlation function terms to the scoring function compared with classical approaches.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Energy evaluation using fast Fourier transforms (FFTs) enables sampling billions of putative complex structures and hence revolutionized rigid proteinprotein docking.  #@NEW_LINE#@#  However, in current methods, efficient acceleration is achieved only in either the translational or the rotational subspace.  #@NEW_LINE#@#  Developing an efficient and accurate docking method that expands FFT-based sampling to five rotational coordinates is an extensively studied but still unsolved problem.  #@NEW_LINE#@#  The algorithm presented here retains the accuracy of earlier methods but yields at least 10-fold speedup.  #@NEW_LINE#@#  The improvement is due to two innovations.  #@NEW_LINE#@#  First, the search space is treated as the product manifold SO(3)×(SO(3)S1), where SO(3) is the rotation group representing the space of the rotating ligand, and (SO(3)S1) is the space spanned by the two Euler angles that define the orientation of the vector from the center of the fixed receptor toward the center of the ligand.  #@NEW_LINE#@#  This representation enables the use of efficient FFT methods developed for SO(3).  #@NEW_LINE#@#  Second, we select the centers of highly populated clusters of docked structures, rather than the lowest energy conformations, as predictions of the complex, and hence there is no need for very high accuracy in energy evaluation.  #@NEW_LINE#@#  Therefore, it is sufficient to use a limited number of spherical basis functions in the Fourier space, which increases the efficiency of sampling while retaining the accuracy of docking results.  #@NEW_LINE#@#  A major advantage of the method is that, in contrast to classical approaches, increasing the number of correlation function terms is computationally inexpensive, which enables using complex energy functions for scoring.  #@NEW_LINE#@#  

Schematic representation of FFT-based docking methods.  #@NEW_LINE#@#  In Cartesian FFT sampling (upper path), the ligand protein is translated along three Cartesian coordinates in Fourier space using the translational operator T. The translation must be repeated for each rotation of the ligand.  #@NEW_LINE#@#  In 5D FMFT docking (lower path), the direction of the vector from the center of the receptor to the center of the ligand is defined by two Euler angles, and the ligand is rotated around its center, resulting in the search space (SO(3)S)×SO(3).  #@NEW_LINE#@#  All rotations are performed in generalized Fourier space, where D denotes the rotational operator.  #@NEW_LINE#@#  The only traditional search is the 1D translation along the vector between the centers of the two proteins.  #@NEW_LINE#@#  
(A) Matching of a pair of patterns via rotation around two different points.  #@NEW_LINE#@#  The patterns can be regarded as printed on the surfaces of two rotatable spheres with centers coinciding with the points of rotation.  #@NEW_LINE#@#  (B) A pair of spherical coordinate systems that are used for representation of functions f and g describing the patterns to be superimposed.  #@NEW_LINE#@#  
Speedup of the FMFT appproach over PIPER as a function of the number of correlations.  #@NEW_LINE#@#  Although FMFT is generally faster than PIPER by an order of magnitude, the difference further increases with the increasing number of correlation terms, allowing for routine use of much more complex correlation-based energy functions.  #@NEW_LINE#@#  All execution times were measured on the E2A-HPr system and averaged over three runs.  #@NEW_LINE#@#  Additional correlation terms used were extra-repulsive van der Waals energy components, reweighted to provide a constant repulsive van der Waals contribution.  #@NEW_LINE#@#  
Results_and_Discussion  #@NEW_LINE#@#  
FFT-Based_Docking_on_5D_Rotational_Manifolds  #@NEW_LINE#@#  
Here we demonstrate that, by taking advantage of the special geometry of the space characterizing molecular movement upon proteinprotein association, it is possible to construct an extremely efficient FFT-based docking algorithm.  #@NEW_LINE#@#  We present the basic idea of this algorithm as the generalization of the translational FFT method described in the Introduction.  #@NEW_LINE#@#  Because we plan to work in the rotational space, we change the Cartesian coordinates to polar coordinates (x,y,z)(r,,), and consider the generalization of the Fourier transform on the sphereR(r,,)=nlmNr(n,l,m)Rnl(r)dlm(cos)eim[4]where Rnl(r) are radial basis functions, r(n,l,m) are generalized Fourier coefficients, dlm(cos) are Legendre polynomials (22), and N is the order of expansion used.  #@NEW_LINE#@#  Eq.  #@NEW_LINE#@#  4 looks like a Fourier transform, but eim is replaced by dlm(cos)eim, which shows the non-Cartesian properties of the sphere (23).  #@NEW_LINE#@#  
Consider again the derivation of the convolution theorem (Eq.  #@NEW_LINE#@#  1) but, this time, on the manifold (SO(3)S)×SO(3) shown in the lower path of Fig 1.  #@NEW_LINE#@#  The translation of the ligand can be represented as the rotation of the receptor, followed by the translation of the ligand along the z axis,E(z,,,,,)=p=1PT^(z)D^(0,,)Rp(,,)×D^(,,)Lp(,,)dV.  #@NEW_LINE#@#  [5]Rotations of the receptor can be expressed as follows:D(,,)R(r,,)=nlmRnl(r)Ylm(,)m1Dmm1l(,,)r(n,l,m1),[6]where Ylm(,) denotes spherical harmonics, andDmml(,,)=eimdmml()eim[7]are Wigner rotation matrices with dmm1l() denoting Wigner d functions, related to Jacobi polynomials (19).  #@NEW_LINE#@#  Eqs.  #@NEW_LINE#@#  6 and 7 show that the rotational operator in the rotational group SO(3) acts on generalized Fourier coefficients the same way as the translation operator acts on Fourier coefficients in the Cartesian space (Eq.  #@NEW_LINE#@#  2), apart from the asymmetry of the middle angle , which requires special treatment.  #@NEW_LINE#@#  Describing the translation of the ligand along the z axis in the Fourier space is far from simple, and requires updating a set of coefficients.  #@NEW_LINE#@#  However, it is only 1 degree of freedom (as opposed to 3 degrees in the Cartesian space), and hence it can be accomplished relatively efficiently (24).  #@NEW_LINE#@#  Now we apply the translation operator and the rotation operator (Eq.  #@NEW_LINE#@#  7) to the integral in Eq.  #@NEW_LINE#@#  5.  #@NEW_LINE#@#  Based on the orthonormality of the generalized Fourier basis functions, interchanging the order of integration and summation yieldsE(z,,,,,)==mm1m2ll1(nn1prp(n1,l1,m1)¯lp(n,l,m2)Tnln1l1|m|(z))×dmm1l1()dmm2l()ei(m+m1+m2).  #@NEW_LINE#@#  [8]Note that Eq.  #@NEW_LINE#@#  8 is similar to Eq.  #@NEW_LINE#@#  3 in Cartesian coordinates, with the difference that, instead of a 3D inverse Fourier transform, we have a generalized FMFT, which involves the Wigner d functions dmm1l().  #@NEW_LINE#@#  However, the really important difference is in the order of the transforms and the summation of correlation functions.  #@NEW_LINE#@#  In Eq.  #@NEW_LINE#@#  3, for each rotation of the ligand, we have to calculate the Fourier transforms lp(,,,n,l,m) for each of the P components of the ligand energy function separately, form the product with the transform rp(n,m,l) of the pth component of the receptor energy function, sum all terms, and take the inverse transform.  #@NEW_LINE#@#  In contrast, according to Eq.  #@NEW_LINE#@#  8, we calculate the sum of initial precalculated generalized Fourier coefficients in the internal loop only once, and perform all rotations in Fourier space rather than calculating an FFT for each rotation.  #@NEW_LINE#@#  This allows us to calculate multiple energy terms using a single FMFT for each translation.  #@NEW_LINE#@#  Thus, as already emphasized, the computational efforts are essentially independent of the number P of the correlation function terms in the energy expression.  #@NEW_LINE#@#  Because inverse manifold Fourier transforms can be efficiently calculated by methods due to ref.  #@NEW_LINE#@#  19, this approach provides substantial computational advantage, particularly if P is high.  #@NEW_LINE#@#  

Execution_Times  #@NEW_LINE#@#  
Execution times of the FMFT sampling algorithm were measured by docking unbound structures of component proteins in 51 enzymeinhibitor pairs from the established Protein Docking Benchmark (25) (Table S1).  #@NEW_LINE#@#  The times were compared with those required for docking the same proteins using PIPER, a protein docking program based on the Cartesian FFT approach (8).  #@NEW_LINE#@#  The FFTW (Fastest Fourier Transform in the West) library (26) was used for FFT calculations.  #@NEW_LINE#@#  All runs were performed using the standard PIPER scoring function, consisting of eight correlation function terms.  #@NEW_LINE#@#  Execution times were measured on one or several Intel Xeon E5-2680 processors.  #@NEW_LINE#@#  Using the FMFT algorithm, the average execution time was 15.39 min.  #@NEW_LINE#@#  In comparison, the average execution time for the same set of proteins using PIPER was 232.15 min, indicating that FMFT speeds up the calculations 15-fold.  #@NEW_LINE#@#  Using parallel versions of the algorithms on 16 CPU cores, the average execution times measured were 2.67 min and 20.19 min for FMFT and PIPER, respectively, which shows about a 7.5-fold speedup.  #@NEW_LINE#@#  

Application_1__Constructing_EnzymeInhibitor_Complexes  #@NEW_LINE#@#  
The quality of FMFT and PIPER results was determined by docking the same 51 enzymeinhibitor pairs that we have used for comparing execution times (Table S2).  #@NEW_LINE#@#  In both cases, the scoring function was the same one normally used in PIPER for docking enzymeinhibitor pairs, and it consisted of attractive and repulsive van der Waals, Coulombic electrostatics, generalized Born, and knowledge-based Decoys As the Reference State terms, the latter representing nonpolar solvation (27).  #@NEW_LINE#@#  The docking procedure for these cases was the one normally used by PIPER (20).  #@NEW_LINE#@#  First, the conformational space was sampled using either the FMFT or the PIPER protocol.  #@NEW_LINE#@#  After docking, the 1,000 lowest energy poses were retained and clustered using interface C rms deviation (RMSD) as the distance metrics with a fixed 9 Å clustering radius.  #@NEW_LINE#@#  The clusters were ranked according to cluster populations (i.e., number of poses in the cluster), and the centers of up to 30 largest clusters were reported as putative models of the complex (Table S2).  #@NEW_LINE#@#  
Fig 2 AC shows the results of docking.  #@NEW_LINE#@#  The number of hits shown in Fig 2A is the number of near-native poses, defined as having less than 10 Å C interface RMSD (IRMSD) from the native complex, generated by each of the two algorithms.  #@NEW_LINE#@#  Note that IRMSD is calculated for the backbone atoms of the ligand that are within 10 Å of any receptor atom after superimposing the receptors in the X-ray and docked complex structures.  #@NEW_LINE#@#  We found that the number of poses with less than 10 Å IRMSD is a good measure of the quality of sampling of the energy landscape in the vicinity of the native structure.  #@NEW_LINE#@#  Fig 2 B and C shows the properties of models obtained by clustering low-energy poses using pairwise IRMSD as a distance metric.  #@NEW_LINE#@#  A large number of low-energy poses typically yields a well-populated and thus highly ranked near-native cluster, reported as one of the final models.  #@NEW_LINE#@#  Based on all these results, FMFT and PIPER show comparable docking performance, both in terms of the number of near-native structures (Fig 2A), the ranks of the clusters that define the final near-native models (Fig 2B), and the IRMSD (Fig 2C) of these models.  #@NEW_LINE#@#  

Application_2__Docking_Interacting_Protein_Domains  #@NEW_LINE#@#  
We further compared FMFT and PIPER by docking interacting domains extracted from proteins that are defined as Other type in the Protein Docking Benchmark (25) (Tables S3 and S4).  #@NEW_LINE#@#  This problem is generally more challenging than docking inhibitors to enzymes because the Other category includes complexes with highly variable properties.  #@NEW_LINE#@#  Restricting consideration to individual domains eliminates the additional problem that the domains in multidomain proteins may shift relative to each other, affecting the docking results.  #@NEW_LINE#@#  Thirty cases representing domaindomain binding were selected from the Others section of the Protein Docking Benchmark (Table S4).  #@NEW_LINE#@#  Nineteen cases from this set represent binding of single-domain proteins (or single domains taken from larger proteins), and thus full protein structures were used for docking.  #@NEW_LINE#@#  In another 11 cases, receptor and/or ligand are composed of several domains, so reduced representations of protein structures were prepared: Only the binding domains were retained for docking, and the rest of the structure was cleaved.  #@NEW_LINE#@#  Residue ranges for binding domains were assigned according to structural classification of proteins (SCOP) domain classification (28).  #@NEW_LINE#@#  To prevent possible association at intraprotein domaindomain binding interfaces exposed by the cleavage, additional repulsion grids were used in the docking procedure.  #@NEW_LINE#@#  These were constructed by taking the backbone atoms of the original structure lying within 10 Å (but not closer than 5 Å) of the binding domain and placing repulsive spheres with 0.5-Å radius at the positions of those atoms.  #@NEW_LINE#@#  The 5-Å lower bound to the distance range specifying the thickness of this repulsive padding was introduced to ensure that additional repulsion doesnt affect binding to the relevant portion of protein surface.  #@NEW_LINE#@#  During the docking process, such repulsive padding grid was correlated with the standard repulsive van der Waals grid of the binding partner.  #@NEW_LINE#@#  The docking procedure overall was the same as that used for enzymeinhibitor targets, except that 1,500 low-energy poses were used for clustering, generated from three docking runs (500 poses from each) performed with differently weighted components of the scoring function (20).  #@NEW_LINE#@#  Similarly to the results obtained for enzymeinhibitor complexes, FMFT and PIPER show comparable performance (Fig 2 DF and Table S3).  #@NEW_LINE#@#  Although PIPER generates large numbers ( greater than 200) of near-native structures for more complexes than FMFT, the number of complexes with very few (less_than10) such near-native structures is substantially smaller using FMFT than using PIPER.  #@NEW_LINE#@#  Thus, FMFT shows better performance for the more difficult-to-dock complexes (Fig 2D).  #@NEW_LINE#@#  In addition, using PIPER, the number of models that are not ranked in the top 10 is much higher than using FMFT (Fig 2E).  #@NEW_LINE#@#  Based on these results, FMFT performs as well as PIPER.  #@NEW_LINE#@#  

Application_3__Accounting_for_Pairwise_Distance_Restraints  #@NEW_LINE#@#  
An important consideration for selecting a docking method is the maximum complexity of the scoring function that still allows for solving problems with reasonable execution times.  #@NEW_LINE#@#  As mentioned, all FFT-based approaches require the use of scoring functions that can be written as sums of correlation functions.  #@NEW_LINE#@#  This is not a major limitation, because such functions may include many commonly used physics-based energy terms, such as steric repulsion, van der Waals interaction, and Coulombic electrostatics.  #@NEW_LINE#@#  It has also been shown that some energy terms that are not inherently correlation-based, such as the widely used pairwise interaction potentials, can be efficiently approximated by a sum of several correlation functions (27).  #@NEW_LINE#@#  Altogether, this makes the number of correlations a crucial parameter, because this number effectively defines the complexity of the scoring function in the particular sampling run.  #@NEW_LINE#@#  
One important task, especially demanding in terms of scoring function complexity, is incorporating pairwise distance restraints, based on known interactions between residue pairs, into the docking procedure.  #@NEW_LINE#@#  Such restraints can be derived in a variety of experiments, including NMR, cross-linking, and mutagenesis assays (29).  #@NEW_LINE#@#  The restraints can be implemented as short-distance attractive terms in the scoring function, but each will add a correlation function term.  #@NEW_LINE#@#  As emphasized, in Cartesian FFT, the number of transforms required is proportional to the number P of correlation functions (Eq.  #@NEW_LINE#@#  3), whereas, in FMFT, the number of transforms is independent of P. To demonstrate this difference, we determined the structure of the glucose-specific enzyme IIA (E2A)-histidine-containing phosphocarrier protein (HPr) complex [Protein Data Bank (PDB) entry 1GGR] (30) from the structures of its constituents in their unbound form (PDB entries 1F3G and 1POH) and 20 ambiguous interaction restraints (AIRs) based on NMR titration data (29).  #@NEW_LINE#@#  The docking procedure was the one used for docking enzymeinhibitor pairs, but with 20 additional correlations terms in the scoring function due to the restraints (29).  #@NEW_LINE#@#  Each restraint is specified as a residue in one of the proteins, and a set of residues on the partner protein that are in contact with the first residue, where contact means 3 Å distance between any two atoms of the residue pair.  #@NEW_LINE#@#  To represent these restraints, receptor and ligand correlation components were constructed by placing 3-Å radius attractive spheres on the atoms of the particular residue on the first protein and the attracted point charges on the atoms of the interacting residues on the partner protein.  #@NEW_LINE#@#  Docking was performed using both FMFT and PIPER.  #@NEW_LINE#@#  Incorporation of restraints increased the population of the near-native cluster from 201 to 410, which became the most populated cluster and thus provided the putative model of the complex (Fig 3 and Table S5) without any significant change in the IRMSD of the cluster center (5.25 Å for the unrestrained case versus 5.15 Å for the restrained).  #@NEW_LINE#@#  Adding the restraints increased the number of correlation function terms in the scoring function from 8 to 28.  #@NEW_LINE#@#  For PIPER, this resulted in a proportional increase in execution time (from 96.15 min to 373.80 min).  #@NEW_LINE#@#  In contrast, running FMFT, the execution time barely changed, from 12.32 min to 15.30 min.  #@NEW_LINE#@#  This result demonstrates that FMFT can be used with very complex scoring functions (Fig S2).  #@NEW_LINE#@#  

Application_4__Docking_Ensembles_of_NMR_Models  #@NEW_LINE#@#  
Multiple docking runs may be required when one or both component proteins are given as ensembles of structures, obtained by NMR experiments or by extracting snapshots from molecular dynamics simulations.  #@NEW_LINE#@#  Because accounting for multiple structures may substantially improve docking results, the high efficiency of the FMFT method is particularly useful.  #@NEW_LINE#@#  As an example, we considered calculating the complex formed by the Escherichia coli Colicin E9 DNase domain and its cognate immunity protein IM9.  #@NEW_LINE#@#  Four different X-ray structures of the unbound E9 DNase domain (chains B, C, D, and E of PDB entry 1FSJ) were docked in a pairwise manner to 20 NMR models of the IM9 protein (PDB entry 1E0H), thus performing 80 docking calculations.  #@NEW_LINE#@#  Unstructured termini of the receptor were masked and didnt contribute to the calculated energy scores.  #@NEW_LINE#@#  The 50 lowest energy poses were extracted from each of the 80 docking runs and merged, yielding a total of 4,000 poses that were then clustered as usual in PIPER.  #@NEW_LINE#@#  Fig 4 AC shows the docking results.  #@NEW_LINE#@#  In short, merging the 50 lowest energy poses from each docking run, followed by clustering, provided a 2.94-Å IRMSD model of the complex ranked fifth, where the 1IBX structure of the native complex was used for comparison when evaluating the accuracy of results.  #@NEW_LINE#@#  To emphasize the advantage of ensemble docking, we also docked a single pair of structures, chain B of 1FSJ and the first NMR model of the ligand from the PDB file 1E0H.  #@NEW_LINE#@#  The standard docking protocol was used, and we retained the 1,000 lowest energy poses for clustering.  #@NEW_LINE#@#  Docking the single pair, the best near-native model obtained was ranked 13, and had the IRMSD value of 3.45 Å.  #@NEW_LINE#@#  Thus, in the case of structural uncertainty of the component proteins, ensemble docking can substantially improve the results, and, in this type of application, the higher speed of FMFT is a major advantage.  #@NEW_LINE#@#  Computational efficiency will be particularly important for genome-wide analyses of proteinprotein interactions, but we think that, for such applications, it will be necessary to better understand the docking of homology models (see Application 5: Identification of Binding Sites by Docking Homology Models), because, generally, structures are not available for a substantial fraction of proteins.  #@NEW_LINE#@#  

Application_5__Identification_of_Binding_Sites_by_Docking_Homology_Models  #@NEW_LINE#@#  
It has been shown that proteinprotein interaction sites can be found by determining the highly populated interfaces in the ensemble of structures generated by global docking (31, 32).  #@NEW_LINE#@#  We implemented this approach by clustering the interfacial atoms in the low-energy docked poses.  #@NEW_LINE#@#  Although this method usually requires structures of the component proteins, we extended the approach to proteins with yet undetermined structures by docking multiple homology models.  #@NEW_LINE#@#  The extended method was applied to determining the interface in the NefFyn(R96I)SH3 complex (PDB entry 1EFN).  #@NEW_LINE#@#  Ten models of the receptor (SH3 domain) and 2 models of the ligand (HIV-1 Nef protein) were constructed using the MODELLER program (33) and based on homologous templates with 3060% sequence identity (see Table S6 for the list of templates used).  #@NEW_LINE#@#  All possible receptorligand model pairs were docked using the approach developed for Other type of complexes (20).  #@NEW_LINE#@#  From each of the 20 docking runs, we selected the 1,500/20 = 75 lowest energy poses that were merged and clustered using RMSD as the distance metrics.  #@NEW_LINE#@#  The structures at the centers of these clusters were used to define interface atoms as atoms located within 5 Å of any atom of the partner protein.  #@NEW_LINE#@#  These interfacial atoms were then subjected to bottom-up hierarchial clustering using the Euclidian distance as the metrics.  #@NEW_LINE#@#  Clustering was terminated, i.e., neighboring clusters were not merged, if the minimal distance between a pair of their atoms was larger than the value of a separation parameter.  #@NEW_LINE#@#  The resulting clusters were ranked according to cluster population (i.e., the number of atoms in each cluster), and the largest cluster was considered to be the most probable prediction of the proteinprotein interaction site.  #@NEW_LINE#@#  For comparison, we also predicted the interaction site by docking a single pair of homology models based on the templates with the highest sequence identity.  #@NEW_LINE#@#  In this case, a slightly larger value of the clustering separation parameter was used (1.35 Å rather than 1.30 Å).  #@NEW_LINE#@#  This change was due to the fact that a single docking run provided fewer interfacial atoms for hierarchical clustering, resulting in clusters that were too small.  #@NEW_LINE#@#  Therefore, the value of the cutoff parameter was increased to ensure that the relative population of the largest cluster was comparable to that obtained by merging the results from 20 docking runs.  #@NEW_LINE#@#  As shown in Fig 4 D and E, docking of multiple homology models of the component proteins increased the accuracy of binding site prediction, compared with the result of using the maximum sequence identity models alone.  #@NEW_LINE#@#  

Application_6__Docking_Flexible_Peptides  #@NEW_LINE#@#  
The difficulty in docking short linear peptides is that their structure in solution is generally unknown and may be ill-defined.  #@NEW_LINE#@#  One possible solution is to dock a variety of peptide conformations, thus requiring multiple docking runs.  #@NEW_LINE#@#  We have recently developed an algorithm based on the use of structural templates extracted from the PDB with sequences that matched the known sequence motif in the peptide.  #@NEW_LINE#@#  These templates were docked individually using the FMFT algorithm.  #@NEW_LINE#@#  From each run, a number of low-energy poses were retained, the pooled peptide structures were clustered, and the highly populated cluster centers were reported as final models as in all applications of our docking algorithm.  #@NEW_LINE#@#  
Here we demonstrate this algorithm by docking the ace-PQQATDD peptide to the tumor necrosis factor receptor-associated factor 2 (TRAF2).  #@NEW_LINE#@#  For this peptide, the PXQ motif sequence known from the literature was extended to length 7 (PXQXXDD) and used to extract 316 structural templates from the PDB database.  #@NEW_LINE#@#  These templates were then used to model the target peptide.  #@NEW_LINE#@#  The models were aligned and clustered using the backbone RMSD as the distance measure, with 0.5 Å as the fixed clustering radius.  #@NEW_LINE#@#  Peptide structures corresponding to the centers of the 25 most-populated clusters were docked to the unbound receptor structure (chain A of PDB entry 1CA4).  #@NEW_LINE#@#  
The 250 lowest energy poses were retained from each docking run.  #@NEW_LINE#@#  The poses were merged and clustered using backbone RMSD as a distance measure with 3.5 Å as the fixed clustering radius.  #@NEW_LINE#@#  Cluster centers were ranked according to cluster populations and reported as final models.  #@NEW_LINE#@#  Docking results were evaluated using the backbone RMSD from the structure of the peptide in the native complex (chain A of PDB entry 1CZY).  #@NEW_LINE#@#  A near-native model of the proteinpeptide complex was ranked fourth and had the backbone RMSD of 3.3 Å from the conformation in the X-ray structure (Table S7 and Fig 5A).  #@NEW_LINE#@#  Note that docking only the most frequently occurring structural template provides less accurate models, as demonstrated in Fig 5 B and C.  #@NEW_LINE#@#  


Conclusions  #@NEW_LINE#@#  
Extending the classical 3D Cartesian implementation of the FFT correlation approach to perform rotations in Fourier space without the need for recalculating the transforms has been a long-outstanding and extensively studied problem.  #@NEW_LINE#@#  The main difficulty in developing such methods is that, to achieve numerical efficiency, one can use only a moderate number of spherical basis functions to span the search space, and this may reduce the accuracy of energy evaluation.  #@NEW_LINE#@#  However, because we base model selection on the population of low-energy clusters rather than on energy values, minor deviations in energy generally do not affect the accuracy of final models.  #@NEW_LINE#@#  Here we present an elegant manifold FFT implementation of 5D search that is more than 10-fold faster than the traditional 3D approach.  #@NEW_LINE#@#  A major advantage of the method is that adding correlation function terms in the scoring function is computationally inexpensive, and hence the method works efficiently with very complex energy evaluation models, possibly including pairwise distance restraints that are difficult to deal with in traditional FFT-based docking.  #@NEW_LINE#@#  The improved efficiency implies that we can solve new classes of docking problems, including the docking of large ensembles of proteins rather than just a single protein pair, docking homology models, and flexible peptides that may have a large number of potential conformations.  #@NEW_LINE#@#  We note that the beta version of a code implementing the FMFT algorithm can be downloaded from https://bitbucket.org/abcgroup_midas/fmft_dock/, thus providing an opportunity for testing and using the method.  #@NEW_LINE#@#  In addition, we are in the process of adding FMFT as a new option to the server.  #@NEW_LINE#@#  

Materials_and_Methods  #@NEW_LINE#@#  
This section summarizes the implementation of the FMFT approach.  #@NEW_LINE#@#  For the mathematical details of the algorithm, see SI Materials and Methods.  #@NEW_LINE#@#  
The procedure starts with receptor- and ligand-associated components of each correlation term of the energy function being represented as sets of coefficients r(n,l,m), l(n,l,m) that appear in the expansion shown as Eq.  #@NEW_LINE#@#  4.  #@NEW_LINE#@#  Here 1nN, 0ln1, and lm+l, where N governs the order at which the series is truncated.  #@NEW_LINE#@#  These coefficients, together with the translation range to be sampled (i.e., minimal and maximal distances between protein centers, calculated from the geometrical properties of the proteins), are submitted as input parameters to the program performing the FMFT-based sampling.  #@NEW_LINE#@#  To improve efficiency, two stages of FMFT sampling are being executed: The first one, performed with a maximal coefficient order N=20 on a small FFT grid, is computationally inexpensive and provides a crude approximation of the energy landscape, which is then used to focus the search to the translation range potentially containing the energy minima, whereas the second one is executed with N=30 on a full-sized FFT grid but performs the sampling only in the refined translation range, thus saving computational resources.  #@NEW_LINE#@#  
The actual sampling stage can be described as follows: After loading the input parameters, the program starts to iterate the allowed translation range in steps of 1 Å.  #@NEW_LINE#@#  For each translation step, the nn1prp(n1,l1,m1)lp(n,l,m2)Tnln1l1|m|(z) product of coefficients and translation matrix elements is calculated, followed by a manifold FFT, which provides the values of energy score for all receptorligand orientations corresponding to a fixed distance between the centers of the two proteins.  #@NEW_LINE#@#  The resulting samples are located on the (,,,,) Euler angle grid with dimensions of 30 × 59 × 59 × 30 × 59 (or 16 × 30 × 30 × 16 × 30 for the low-order scan).  #@NEW_LINE#@#  K (on the order of 1,000 for a typical sampling run) lowest energy samples are retained for each translation step.  #@NEW_LINE#@#  After the entire translation range is processed, the low-energy samples from individual translation steps are merged and resorted by energy value to select the K lowest energy samples that are presented as the final results.  #@NEW_LINE#@#  
It is important to note here that the sampling of the S2×SO(3) manifold [in practice probed as (SO(3)S1)×SO(3)], provided by the equispaced sampling of Euler angles, is inherently nonuniform.  #@NEW_LINE#@#  This becomes a significant problem if one seeks to obtain statistical information about the energy landscape of protein interaction, for example, to construct the partition function of the system.  #@NEW_LINE#@#  To battle this nonuniformity, a special procedure is used for the selection of low-energy scores.  #@NEW_LINE#@#  Specifically, once the 5D array of energy scores for a single translation step is acquired, the program starts selecting lowest-scoring conformations and excluding the samples corresponding to the surrounding region from further consideration.  #@NEW_LINE#@#  Here the surrounding region is defined as the subset of elements {(x,y)|x(,)S2,y(,,,,)SO(3)} of the S2×SO(3) manifold, for which (distS2(x,xmin)less_than)(distSO(3)(y,ymin)less_than), where  is a cutoff parameter chosen to be 6.0°, which is slightly less than the grid step of 360°/59=6.1°.  #@NEW_LINE#@#  This procedure ensures that the sampling explores a substantial fraction of the conformational space rather than producing structures very close to each other.  #@NEW_LINE#@#  

SI_Materials_and_Methods  #@NEW_LINE#@#  
FFT-Based_Sampling_on_Manifolds  #@NEW_LINE#@#  

Application_to_Protein_Docking  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
This work was supported by National Science Foundation (NSF) Grants AF 1527292 and DBI 1458509, NIH, National Institute of General Medical Sciences, Grants R35 GM118078 and R01 GM093147, Russian Scientific Foundation Grant 14-11-00877, and US Israel Binational Science Foundation Grant 2009418.  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  


