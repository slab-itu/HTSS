article id="http://dx.doi.org/10.1073/pnas.1518922113"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Geomorphic controls on elevational gradients of species richness  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
How biodiversity changes with elevation has long attracted the interest of researchers because it provides key clues to how biota respond to geophysical drivers.  #@NEW_LINE#@#  Experimental evidence reveals that biodiversity often peaks at intermediate elevations, and yet a clear explanation is still elusive.  #@NEW_LINE#@#  Here, we investigate a factor that has been overlooked to date: Mountainous landscapes hold fractal properties with elevational bands forming habitat patches that are characterized by different areal extent and connectivity, well-known drivers of biodiversity.  #@NEW_LINE#@#  When the geometry of real landscapes is taken into account, ecological dynamics naturally produce mid-peak elevational gradients of species richness.  #@NEW_LINE#@#  These results further biodiversity theory and our understanding of the distribution of life on Earth.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Elevational gradients of biodiversity have been widely investigated, and yet a clear interpretation of the biotic and abiotic factors that determine how species richness varies with elevation is still elusive.  #@NEW_LINE#@#  In mountainous landscapes, habitats at different elevations are characterized by different areal extent and connectivity properties, key drivers of biodiversity, as predicted by metacommunity theory.  #@NEW_LINE#@#  However, most previous studies directly correlated species richness to elevational gradients of potential drivers, thus neglecting the interplay between such gradients and the environmental matrix.  #@NEW_LINE#@#  Here, we investigate the role of geomorphology in shaping patterns of species richness.  #@NEW_LINE#@#  We develop a spatially explicit zero-sum metacommunity model where species have an elevation-dependent fitness and otherwise neutral traits.  #@NEW_LINE#@#  Results show that ecological dynamics over complex terrains lead to the null expectation of a hump-shaped elevational gradient of species richness, a pattern widely observed empirically.  #@NEW_LINE#@#  Local species richness is found to be related to the landscape elevational connectivity, as quantified by a newly proposed metric that applies tools of complex network theory to measure the closeness of a site to others with similar habitat.  #@NEW_LINE#@#  Our theoretical results suggest clear geomorphic controls on elevational gradients of species richness and support the use of the landscape elevational connectivity as a null model for the analysis of the distribution of biodiversity.  #@NEW_LINE#@#  

Comparison between a real-life elevation field (a fluvial landscape in the Swiss Alps, 50×50 km2) (A) and an oversimplified, 1D elevation field (B).  #@NEW_LINE#@#  (C) Frequency distributions of elevation of the two landscapes.  #@NEW_LINE#@#  Fig S1 reports other examples.  #@NEW_LINE#@#  
Habitat maps as a function of elevation.  #@NEW_LINE#@#  (A) A real fluvial landscape (same of Fig 1A).  #@NEW_LINE#@#  (B) Fitness of three different species as a function of elevation.  #@NEW_LINE#@#  (CE) Fitness maps of the three species shown in B. Darker pixels indicate higher fitness.  #@NEW_LINE#@#  
Results  #@NEW_LINE#@#  
Fig 3 shows elevational gradients of local species richness (-diversity) resulting from the simulation of the metacommunity model in real mountainous landscapes at two different scales of analysis.  #@NEW_LINE#@#  Patterns emerging from a landscape derived from an OCN are reported in Fig 4.  #@NEW_LINE#@#  Remarkably, species interacting in an elevation field that embeds the complexity of a real fluvial landscape naturally produce a hump-shaped elevational gradient of species richness (Figs.  #@NEW_LINE#@#  3 and 4D) even in the absence of gradients of productivity or habitat capacity.  #@NEW_LINE#@#  
Figs.  #@NEW_LINE#@#  3 and 4D also reveal that sites at the same elevation can host quite a different number of species depending on their connectivity.  #@NEW_LINE#@#  Such an effect is further highlighted by analyzing local subplots (Fig 4E).  #@NEW_LINE#@#  The two quadrants cover very different elevation ranges, and yet they both exhibit similar well-defined midpeak gradients of elevational diversity.  #@NEW_LINE#@#  Sites at the upper end of the elevational range of the first plot host few species, whereas -diversity at similar elevation is much higher in the second plot.  #@NEW_LINE#@#  This difference can be explained by the different connectivity.  #@NEW_LINE#@#  Sites at the same elevation represent a local mountain top in the first plot, thus poorly connected with sites characterized by similar elevation, whereas in the second plot, the sites lay in the middle of the elevation range, with multiple connections with similar elevations.  #@NEW_LINE#@#  Therefore, in such systems elevation alone is a poor predictor of species richness, which is instead controlled by the geomorphic organization of the surrounding habitat.  #@NEW_LINE#@#  
We have sought a measure to quantify the combined effect of the three geomorphic controls on elevational gradients of species richness without resorting to any particular modeling assumptions.  #@NEW_LINE#@#  To that end, we apply concepts of complex network theory applied to ecology (35, 3840, 47).  #@NEW_LINE#@#  The proposed measure, which we term landscape elevational connectivity (LEC) (Materials and Methods and Fig 5), quantifies the closeness of a site to all others with similar elevation.  #@NEW_LINE#@#  Such closeness is computed over a graph whose edges represent connections among sites and whose weights are proportional to the cost of spreading through patches at different elevation.  #@NEW_LINE#@#  Although LEC simply depends on the elevation field and on the niche width, LEC predicts well (Spearmans correlation, r = 0.79) the -diversity simulated by the full metacommunity model (Fig 4).  #@NEW_LINE#@#  In particular, LEC is able to capture the variability of diversity hosted at the same elevation, as opposed to a simpler predictor like the elevation frequency (r = 0.60; Fig 4F).  #@NEW_LINE#@#  Simulations over different landscapes and with different parameter sets confirm the main results presented herein (Supporting Information).  #@NEW_LINE#@#  

Discussion  #@NEW_LINE#@#  
Fluvial networks in runoff-generating areas are naturally fractal (25, 26), owing to the similarity of the networks parts with the whole.  #@NEW_LINE#@#  The networks self-similarity leads to self-affine invariance of the elevation fields owing to the relation between slope and cumulative drainage area, a well-known proxy of landscape-forming hydrological events (Supporting Information).  #@NEW_LINE#@#  Fluvial landforms thus show deep similarities across many orders of magnitude despite great diversity of their drivers and controls (e.g., relief, exposed lithology, geology, vegetation, or climate) (25).  #@NEW_LINE#@#  The universality of the main attributes of the fluvial landscape naturally lends itself to the quest for general patterns of the ecological dynamics that such landscapes host (41, 42, 4854).  #@NEW_LINE#@#  
The -diversity map shown in Fig 4B reveals a clear spatial pattern with valleys and mountain tops characterized by lower species richness.  #@NEW_LINE#@#  All three geomorphic factors described before simultaneously concur to the formation of such pattern.  #@NEW_LINE#@#  The first factor is related to the finiteness of the landscape elevational range: sites at midelevation can potentially be colonized by species that live at (and are fit for) higher and lower elevations, whereas sites at the lowest (highest) extreme are only subject to the colonizing pressure from higher (lower) elevations.  #@NEW_LINE#@#  In addition to this boundary effect, the geomorphic structure of fluvial landscapes results in a midelevation peak in both area and connectivity across the landscape, both of which can promote diversity.  #@NEW_LINE#@#  We have specifically designed a set of simulations to disentangle the role of these three factors (Supporting Information).  #@NEW_LINE#@#  Results show that without any of these effects, the model predicts no gradients of diversity.  #@NEW_LINE#@#  Each geomorphic factor produces, independently or in combination with others, a hump-shaped pattern of species richness.  #@NEW_LINE#@#  Moreover, the differential elevational connectivity characteristic of fluvial landscapes results in a marked variability of diversity for the same elevation.  #@NEW_LINE#@#  
The results shown in Figs.  #@NEW_LINE#@#  3 and 4 reveal that similar mid-peak elevational gradients of diversity can be observed at different scales of observation even if the domains span different elevational ranges.  #@NEW_LINE#@#  This pattern is a direct consequence of the self-affine fractal structure of fluvial landscapes that reproduces statistically similar elevational fields (properly rescaled) at every scale of observation.  #@NEW_LINE#@#  Results also show that, when the scale of observation is enlarged, different hump-shaped patterns are blended together, possibly producing a confounding effect (Fig 4E), especially if the analysis is limited to the average diversity as a function of elevation.  #@NEW_LINE#@#  This feature might help in understanding why elevational diversity is often found to be dependent on the scale of observation (10, 11, 15).  #@NEW_LINE#@#  
As a proof of concept, we have presented results based on nearest-neighbor dispersal to highlight the role of elevational connectivity.  #@NEW_LINE#@#  Indeed the effect of elevational isolation is expected to be reduced as dispersal limitation decreases because species can overcome elevational constraints with long-distance dispersal (e.g., dispersing from one mountain top to another without going through unfavorable lower elevation habitats).  #@NEW_LINE#@#  Moreover, we have assumed that the landscape can be uniformly colonized, whereas real-life habitats are often composed by patches with different spatial connectivity and size (33).  #@NEW_LINE#@#  Spatial and elevational connectivities can interact in a complex ways to shape diversity patterns.  #@NEW_LINE#@#  The modeling framework proposed can be easily generalized to accommodate both fragmented habitats and generic dispersal kernels, and the framework has the potential to effectively describe how spatial and elevational connectivities shape diversity in complex 3D landscapes.  #@NEW_LINE#@#  
Our exploration of metacommunity patterns suggests that the specific spatial arrangement of sites at different elevation in fluvial landscapes suffices in inducing mid-peak elevational gradients of species richness without invoking specific assumptions, except that each species is fit for a specific elevation.  #@NEW_LINE#@#  In this framework, an elevation-dependent fitness applied to a real-life landscape translates into a fragmented habitat map (Fig 2).  #@NEW_LINE#@#  Such conceptualization lends itself to the application of classic concepts of metacommunity dynamics (33, 55), according to which habitat size and connectivity are key drivers of biodiversity.  #@NEW_LINE#@#  We thus expect different metacommunity models to produce similar results.  #@NEW_LINE#@#  For this reason, we have developed a measure, LEC, that subsumes the geomorphic controls on elevational diversity without resorting to any particular biodiversity model.  #@NEW_LINE#@#  
Intermediate elevations hold, on average, higher LEC (Fig S6), and this statistical property might explain the hump-shaped elevational gradients of mean species richness widely observed in nature.  #@NEW_LINE#@#  We do not dismiss as negligible other potential drivers of diversity, including those that often covary with elevation (e.g., habitat capacity, productivity, human disturbance).  #@NEW_LINE#@#  However, we argue that these drivers may act on top of the unavoidable effects provided by the geomorphic controls.  #@NEW_LINE#@#  A general consensus has been achieved on the fact that the analysis of elevational diversity should not seek one single overriding force but rather understand how different factors covariate to synergistically shape the observed patterns (4, 5).  #@NEW_LINE#@#  Our results strongly suggest that fluvial geomorphology likely has an important, yet thus far overlooked, role in driving emergent diversity elevational patterns.  #@NEW_LINE#@#  

Materials_and_Methods  #@NEW_LINE#@#  
Zero-Sum_Metacommunity_Model  #@NEW_LINE#@#  
The model assumes a system of N local communities, organized in an equally spaced 2D lattice in which each cell is characterized by its elevation.  #@NEW_LINE#@#  Each local community assembles n individuals.  #@NEW_LINE#@#  The system is assumed to be at saturation [zero-sum assumption (43)].  #@NEW_LINE#@#  Thus, at any time, the system is populated by Nn individuals belonging to S different species.  #@NEW_LINE#@#  Each species is characterized by a specific elevational niche that expresses, in this context, how the species competitive ability varies with elevation.  #@NEW_LINE#@#  This relationship is modeled by a Gaussian suitability function (30):fi(z)=fmaxie(zzopti)22i2,  #@NEW_LINE#@#  
where fi(z) reflects the competitive ability of the individuals of species i at elevation z, zopti is the niche position (30) of species i [i.e., the elevation where fi(z) equals its maximum fmaxi (Fig 2B)], and i controls the dispersion of the Gaussian function.  #@NEW_LINE#@#  A neutral approach is adopted (43), save for the effects of elevation on fitness, in that the analysis is limited to the case where all species have the same parameters i= and fmaxi=fmax, as well as the same fertility, death, and dispersal rates.  #@NEW_LINE#@#  Ecological interactions among individuals are simulated as follows.  #@NEW_LINE#@#  At each time step, a randomly selected individual dies and is replaced by an offspring of one of the individuals living in either the same community or one of the four nearest-neighbor communities (von Neumann neighborhood) or by the offspring of an additional individual, belonging to a species not currently present in the system.  #@NEW_LINE#@#  This additional competitor is added with probability  at every time step.  #@NEW_LINE#@#  zopti of the new competitor is drawn from a uniform distribution spanning twice the relief of the system to avoid edge effects (Fig S7A).  #@NEW_LINE#@#  The introduction of new species is aimed at modeling both speciation and immigration from external communities (43, 56).  #@NEW_LINE#@#  The offspring replacing the dead individual is randomly selected with a probability proportional to the scores fi(z) of all of the candidate colonizing offsprings evaluated at the elevation z of the local community of the dead individual.  #@NEW_LINE#@#  The system is initially populated by one single species and is simulated until a statistically steady state is reached (104 generations, where a generation is Nn time steps).  #@NEW_LINE#@#  Periodic boundaries conditions are prescribed.  #@NEW_LINE#@#  Model results do not depend on the actual elevation range ([zmin,zmax]) but only on the ratio /(zmaxzmin).  #@NEW_LINE#@#  Moreover, fmax does not affect the simulated dynamics, and it has thus been set to 1.  #@NEW_LINE#@#  

LEC  #@NEW_LINE#@#  
The LEC LECi of site i can be expressed asLECi=j=1NCji,[1]  #@NEW_LINE#@#  
with Cji being a measure of the closeness of site j to i in terms of elevational connectivity.  #@NEW_LINE#@#  Such a measure should quantify how easily a species living in patch j can spread and colonize patch i.  #@NEW_LINE#@#  Because the fitness is assumed to be elevation-dependent, Cji depends on how often a species, assumed to be adapted to the elevation of j, zj, needs to travel outside its optimal fitness range in the path from j to i. Cji thus depends on the elevation field but also on the width of the species niche, here described by the parameter .  #@NEW_LINE#@#  Indeed, for high , species are free to spread throughout the system regardless of elevational constraints.  #@NEW_LINE#@#  Conversely, for low , species are constrained to spread following paths with similar elevation without the ability to cross elevational barriers.  #@NEW_LINE#@#  LEC subsumes the combined effect of the three geomorphic factors: bounded elevational range, frequency distribution of areal extent at different elevation, and differential elevational connectivity.  #@NEW_LINE#@#  
The closeness Cji can be expressed asCji=maxp{ji}Cji,p,[2]  #@NEW_LINE#@#  
where Cji,p is a measure of the closeness of community j to i along path p. The overall closeness Cji is defined as the maximum value of Cji,p along all of the possible paths p form j to i (see the graphical representation in Fig 5).  #@NEW_LINE#@#  Cji,p is assumed to be proportional to the product of the probabilities of making each step of the path p. Let p=[k1,k2,,kL], k1=j, kL=i be the sites comprised in a path p form j to i. Cji,p can be expressed asCji,p=r=2Le(zkrzj)222.  #@NEW_LINE#@#  [3]  #@NEW_LINE#@#  
In Eq.  #@NEW_LINE#@#  3, the exponential form is proportional to the fitness that species adapted to site j have in site kr.  #@NEW_LINE#@#  
From an operational viewpoint, Cji is computed by focusing on the quantitylnCji=122minp{ji}r=2L(zkrzj)2,[4]  #@NEW_LINE#@#  
where the log-transformation maintains extremal properties.  #@NEW_LINE#@#  For each site j, a graph is built with edges representing all possible nearest-neighbor connections among sites and weights equal to the square of the difference between the site elevation and zj.  #@NEW_LINE#@#  The Dijkstra algorithm (57) is then used to find the shortest path from j to all other sites.  #@NEW_LINE#@#  


Elevation_Distribution_of_Mountainous_Landscapes  #@NEW_LINE#@#  
Fig S1 shows the frequency distributions of the elevation fields of 25 quadrants randomly placed within the Swiss alpine region.  #@NEW_LINE#@#  In landscapes shaped by fluvial processes, the prevailing pattern is a hump-shaped frequency distribution of elevation.  #@NEW_LINE#@#  Such a pattern is not found only when very small quadrants are considered (e.g., quadrants 23 and 24) or when large portions of plain are included in the domain (e.g., quadrants 3 and 4).  #@NEW_LINE#@#  

OCNs  #@NEW_LINE#@#  
We consider, to no loss of generality, landscapes formed by square lattices with side L with N=L×L pixels (nodes).  #@NEW_LINE#@#  Each node has a link to one of its eight nearest neighbors forming spanning trees with a single rootthe outlets of the systems.  #@NEW_LINE#@#  Total contributing area Ai to each pixel i of the tree (the number of upstream pixels connected to i through flow directions) is expressed in pixel units asAi=jWjiAj+1,[S1]where Wji is the arbitrary element of the connectivity matrix W (i.e., Wji=1 if j is connected to i and 0 otherwise), and 1 represents the unit area of the pixel.  #@NEW_LINE#@#  Ai provides a proxy of the flow Qi at point i as the sum of the injections over all connected sites upstream of site i (included): Qi=jWjiQj+ri (where ri is the distributed injection).  #@NEW_LINE#@#  In the case of uniform injection ri for landscape-forming events, one has QiAi, a commonly accepted hydrologic assumption whose robustness has been tested (25).  #@NEW_LINE#@#  The system configuration is uniquely determined by the set of total contributing areas s=(A1,A2,,AN)T at any of the N sites making up the landscape.  #@NEW_LINE#@#  From Eq.  #@NEW_LINE#@#  S1 one has s=(UWT)1u (with U being the identity matrix and u being a column vector of ones).  #@NEW_LINE#@#  A necessary condition for the existence of s is that matrix (UWT) can be inverted.  #@NEW_LINE#@#  In turn, this condition corresponds to specific spectral properties of the connectivity matrix W, implying uniqueness of the paths from any site to the outlet [i.e., s must be a set of trees (58)].  #@NEW_LINE#@#  
OCNs are spanning trees minimizing a functional describing total energy dissipation H(s) of the system configuration s. At a local level, say, along the ith link of the network, energy dissipation is HiQizi, which makes use of suitable landscape-forming discharges (QiAi) and of the drop in elevation zi along the drainage direction.  #@NEW_LINE#@#  Theory and field evidence indicate ziAi1 with =0.5 (25, 59).  #@NEW_LINE#@#  Spanning, loopless network configurations characterized by minimum energy dissipation are thus obtained by selecting the configuration s that minimizes the functional (5860):H(s)=i=1NHii=1NAi.  #@NEW_LINE#@#  [S2]In the selection process, one needs to choose tree-like configurations consistently.  #@NEW_LINE#@#  This condition, in turn, is exactly admissible because every tree is a local minimum of total energy expenditure (46) whenever one has less_than1 directly from the physics of the problem recapitulated by a deterministic slopearea relation (45, 61).  #@NEW_LINE#@#  Details on the optimization algorithm can be found elsewhere (54, 58).  #@NEW_LINE#@#  
To construct the landscape associated to an OCN, we follow the procedure described by Rigon et al.  #@NEW_LINE#@#  (62).  #@NEW_LINE#@#  Specifically, the algorithm starts from the outlets (sites at the lowest elevation) and travels upstream assigning at each step an elevation gain ziAi1, as predicted by the slopearea relation.  #@NEW_LINE#@#  Fig S2 shows the OCN used to derive the fluvial landscape used in Fig 4.  #@NEW_LINE#@#  

Elevational_Gradients_of_Diversity  #@NEW_LINE#@#  
Here, we elaborate on the results presented in Figs.  #@NEW_LINE#@#  3 and 4 exploring patterns resulting from different parameter sets and landscapes.  #@NEW_LINE#@#  As argued in the Discussion, the hump-shaped pattern of species richness along elevational gradients of fluvial landscapes can be attributed to three concurring factors: (i) finiteness of the landscape elevational range; (ii) mid-peak frequency distribution of elevation; and (iii) differential elevational connectivity featured by fluvial landscapes.  #@NEW_LINE#@#  
To disentangle the role of these three factors, we run simulations of the zero-sum metacommunity model over the four landscapes illustrated in Fig S3 AD.  #@NEW_LINE#@#  The first landscape (Fig S3A) is a 1D elevation field with a uniform distribution of elevation.  #@NEW_LINE#@#  The last landscape (Fig S3D) represents a realistic mountainous elevation field derived from an OCN.  #@NEW_LINE#@#  The second elevation field (Fig S3B) mimics the 1D gradient (Fig S3A) but has been modified to feature the same distribution of elevation of the fluvial landscape (Fig S3D).  #@NEW_LINE#@#  Finally, the third landscape (Fig S3C) retains the complexity of the fluvial landscape (Fig S3D) but has been stretched to obtain a uniform distribution of elevation.  #@NEW_LINE#@#  The first set of simulations (Fig S3 EH) is run assuming that fitness is periodic along the elevational gradient (Fig S7B) (i.e., species fit to live at the bottom end of the elevational gradient thrive also at the top end).  #@NEW_LINE#@#  This assumption neutralizes the boundary effect attributable to the finiteness of the landscape elevational range.  #@NEW_LINE#@#  The second set of simulations (Fig S3 IL) is run using the standard assumption on the fitness described in the Materials and Methods (see also Fig S7A).  #@NEW_LINE#@#  Analyzing elevational gradients of species richness in the different setups allows the quantification of the contribution of each of the three geomorphic factors described above on the final pattern.  #@NEW_LINE#@#  Without any of these effects (Fig S3E), the model predicts no gradients of diversity.  #@NEW_LINE#@#  Each geomorphic factor produces, independently or in combination with others, a hump-shaped pattern of species richness.  #@NEW_LINE#@#  Moreover, the differential elevational connectivity characteristic of fluvial landscapes results in a marked variability of diversity for the same elevation.  #@NEW_LINE#@#  Note that in the first two landscapes, the expected value of -diversity for sites at the same elevation is theoretically the same, because these sites are, for construction, indistinguishable from each other.  #@NEW_LINE#@#  However, after averaging over 500 realizations of the process, a residual variance still remains.  #@NEW_LINE#@#  It should be noted that even assuming periodic fitness, it is not possible to completely neutralize the boundary effect in the fluvial landscapes (Fig S3 C and D) because sites at the bottom and top end of the elevational range are far apart.  #@NEW_LINE#@#  Instead, the extremes of the landscape elevational range are adjacent in the 1D gradients (Fig S3 A and B) because the landscape is periodic.  #@NEW_LINE#@#  This consideration explains why biodiversity patterns with or without periodic fitness in the two complex landscapes (Fig S3 G, H, K, and L) are very similar.  #@NEW_LINE#@#  
Fig S4 explores the sensitivity of diversity patterns with respect to variations of niche width .  #@NEW_LINE#@#  As the niche becomes wider (higher ), the variability of -diversity at the same elevation decreases.  #@NEW_LINE#@#  Such variability is attributable to the differential LEC shown by different sites at the same elevation.  #@NEW_LINE#@#  As  increases, species are less constrained by elevational barriers, and thus diversity is chiefly controlled by the abundance of sites with similar habitat in the system (i.e., the elevation frequency distribution).  #@NEW_LINE#@#  For very large  (Fig S4, bottom row), diversity patterns expectedly become insensitive to elevation and elevational gradients tend to flatten out.  #@NEW_LINE#@#  LEC consistently captures the effect of niche width on elevational diversity.  #@NEW_LINE#@#  
The sensitivity of diversity patterns with respect to the value of the diversification parameter  is investigated in Fig S5, where results shown in Fig 4 are compared with those obtained with a 10-fold reduction of .  #@NEW_LINE#@#  -Diversity expectedly decreases (43).  #@NEW_LINE#@#  However, the elevational gradients of diversity are similar over a one-order-of-magnitude variation of the diversification parameter .  #@NEW_LINE#@#  

Acknowledgments  #@NEW_LINE#@#  
The authors thank the reviewers for their insightful comments and suggestions.  #@NEW_LINE#@#  We acknowledge support from Swiss Federal Institute of Aquatic Science and Technology (Eawag) discretionary funds, the European Research Council (ERC) Advanced Grant Program through RINEC Project 227612, the H2020 European Framework Programme through ECOPOTENTIAL Project 641762, and the Swiss National Science Foundation through Projects 31003A_135622 and PP00P3_150698.  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  




