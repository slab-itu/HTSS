article id="http://dx.doi.org/10.1073/pnas.1505357112"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Complex constraints on allometry revealed by artificial selection on the wing of Drosophila melanogaster  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
Many traits scale precisely with size, but it is unknown whether this is due to selection for optimal function or due to evolutionary constraint.  #@NEW_LINE#@#  We use artificial selection to demonstrate that wing-shape scaling in fruit flies can respond to selection.  #@NEW_LINE#@#  This evolved response in scaling was lost during a few generations after selection ended, but other selected changes in wing shape persisted.  #@NEW_LINE#@#  Shapesize scaling in fly wings is therefore evolvable, but adaptation is apparently constrained by selection that may not be on wings.  #@NEW_LINE#@#  This may explain why scaling relationships are often evolutionarily conserved.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Precise exponential scaling with size is a fundamental aspect of phenotypic variation.  #@NEW_LINE#@#  These allometric power laws are often invariant across taxa and have long been hypothesized to reflect developmental constraints.  #@NEW_LINE#@#  Here we test this hypothesis by investigating the evolutionary potential of an allometric scaling relationship in drosophilid wing shape that is nearly invariant across 111 species separated by at least 50 million years of evolution.  #@NEW_LINE#@#  In only 26 generations of artificial selection in a population of Drosophila melanogaster, we were able to drive the allometric slope to the outer range of those found among the 111 sampled species.  #@NEW_LINE#@#  This response was rapidly lost when selection was suspended.  #@NEW_LINE#@#  Only a small proportion of this reversal could be explained by breakup of linkage disequilibrium, and direct selection on wing shape is also unlikely to explain the reversal, because the more divergent wing shapes produced by selection on the allometric intercept did not revert.  #@NEW_LINE#@#  We hypothesize that the reversal was instead caused by internal selection arising from pleiotropic links to unknown traits.  #@NEW_LINE#@#  Our results also suggest that the observed selection response in the allometric slope was due to a component expressed late in larval development and that variation in earlier development did not respond to selection.  #@NEW_LINE#@#  Together, these results are consistent with a role for pleiotropic constraints in explaining the remarkable evolutionary stability of allometric scaling.  #@NEW_LINE#@#  

Results_and_Discussion  #@NEW_LINE#@#  
In the Dipteran family Drosophilidae, the length of wing vein L2 shows tight and positive evolutionary and static allometries with wing size (Fig 1).  #@NEW_LINE#@#  The L2 vein intersects the leading edge of the wing (vein L1) in a relatively proximal position in small wings and more distally in larger wings (Fig 1).  #@NEW_LINE#@#  Our comparative analysis shows that both the intercept and the slope of the static allometry have evolved, but at very low rates (Table S1).  #@NEW_LINE#@#  For the intercept, the estimated standard deviation of change from a Brownian motion model of evolution ranges from 0.026 to 0.042 loge millimeters per million years depending on how deep the phylogeny is considered to be.  #@NEW_LINE#@#  This corresponds to average changes in relative L2 length of less than 4% per million years.  #@NEW_LINE#@#  Similarly, the slope changed with an estimated standard deviation of less than 0.037 slope units per million years.  #@NEW_LINE#@#  Hence, wing shape allometry is strongly conserved in drosophilids.  #@NEW_LINE#@#  
It proved easy to change the allometric intercept (i.e., mean shape) by selecting on the residuals of the loglog regression (Fig 2A).  #@NEW_LINE#@#  After seven generations of selection on the intercept, the average length of vein L2 had increased by 8.5% (from 1.34 mm to 1.46 mm in males and from 1.58 mm to 1.70 mm in females) in the up-selected populations and decreased by 6.5% (from 1.34 mm to 1.26 mm in males and from 1.58 mm to 1.47 mm in females) in the down-selected populations.  #@NEW_LINE#@#  Hence, the average length of vein L2 had become as large in the up-selected males as in the down-selected females (Fig 2A) whereas the sexual size dimorphism remained unchanged.  #@NEW_LINE#@#  This selection response of about 1% per generation is rapid evolution on a macroevolutionary scale.  #@NEW_LINE#@#  Only four generations of artificial selection were sufficient to produce a change comparable to the one observed over a million years of evolution, as judged from the average change in the comparative data.  #@NEW_LINE#@#  This change was also stable.  #@NEW_LINE#@#  During 16 generations without artificial selection, the intercept returned less than 0.15% per generation toward the original value (Fig 2A).  #@NEW_LINE#@#  Hence, natural selection on wing shape was weak in the laboratory environment.  #@NEW_LINE#@#  These results show that mean shape is highly evolvable in this population, as it is in many insects (3035).  #@NEW_LINE#@#  The stasis of wing shape among drosophilids must therefore be due to other factors than the lack of genetic variation.  #@NEW_LINE#@#  
Selecting on the static allometric slope is challenging because it is a property of a population that is not expressed at the individual level.  #@NEW_LINE#@#  To construct an individual-based selection index, we used Huxleys (5, 21) allometric model, which is based on individual growth parameters (see SI Materials and Methods).  #@NEW_LINE#@#  These individual growth parameters can be expressed as individual allometries that relate to the static allometry in the same way as ontogenetic allometries (see ref.  #@NEW_LINE#@#  23).  #@NEW_LINE#@#  Under this model, individuals that are near the bivariate phenotypic mean (i.e., average wing size and vein length) could have any breeding value for slope, and selection of those individuals would contribute nothing to the selection differential for slope.  #@NEW_LINE#@#  Therefore, although natural selection on slope may operate through favoring a particular traitsize relationship and generate high fitness for individuals at the bivariate phenotypic mean, a ridge-like selection index would be inefficient for generating selection on slope.  #@NEW_LINE#@#  Instead, we derived a saddle-shaped fitness function that simultaneously maximizes selection on slope while minimizing selection on size, variance in size, and the allometric intercept (Fig 3 and SI Materials and Methods).  #@NEW_LINE#@#  The result was that clusters of larger and smaller than average flies were selected within each sex in each generation.  #@NEW_LINE#@#  
The responses of the allometric slopes were erratic, but, after 26 generations, the male and female slopes had changed from 1.08 and 1.09 in the original populations to 1.39 and 1.42 in the up-selected populations and to 0.84 and 0.78 in the down-selected populations (Fig 2 B and C).  #@NEW_LINE#@#  These are large changes, resulting in allometric slopes in the outer range of those found in the sampled species (Fig 1).  #@NEW_LINE#@#  The allometry in the original population implies that a 10% increase in wing size increased L2 length by 10.9% (for females).  #@NEW_LINE#@#  After 26 generations of selection, this had changed so that a 10% increase in wing size would now increase L2 length by 14.2% in the up-selected females and 7.8% in the down-selected females.  #@NEW_LINE#@#  Figs.  #@NEW_LINE#@#  S1 and S2 give a visual representation of the response to selection on the wing outline.  #@NEW_LINE#@#  
The statistical support for selection responses in the static allometric slope is strong, as judged from the Akaike Information Criterion (AIC; Table 1).  #@NEW_LINE#@#  The average responses of the up- and the down-selected lines were significantly different from each other, although not from the average of the two controls (Table 1).  #@NEW_LINE#@#  The relationship between the change in slope and a measure of cumulative selection strength was also statistically significant for all comparisons except for the males in one of the down-selected populations (Fig 4), and several generations after selection ended, the average allometric slopes of the up- and down-selected lines still differed significantly from each other and from the starting value (Fig 2 B and C).  #@NEW_LINE#@#  We noticed an erratic and diverging behavior of the allometric slopes in the control lines (Fig 2 B and C).  #@NEW_LINE#@#  This strange behavior may, at least partly, be due to smaller sample size in these lines, resulting in less precise estimates of the slopes.  #@NEW_LINE#@#  
The precision with which the allometric slope can be estimated depends on the range of sizes investigated.  #@NEW_LINE#@#  We therefore expected that an increased range of sizes would improve our ability to select on the allometric slope by making it easier to detect flies with extreme breeding values for allometric slope.  #@NEW_LINE#@#  We thus performed the same selection experiment on independent populations in which size variation was increased by starving half of the larvae over the last 2 d of development.  #@NEW_LINE#@#  These populations produced adult flies with a much wider range of sizes.  #@NEW_LINE#@#  Contrary to our expectation, the allometric slope did not respond to selection in these starved populations (Fig 2 B and C and Table S5).  #@NEW_LINE#@#  
To understand the lack of selection response in these starved populations, we subjected flies from the unstarved slope-selected populations to the same type of starvation one generation after selection ended.  #@NEW_LINE#@#  Surprisingly, the entire evolved difference in the allometric slope disappeared in these starved flies.  #@NEW_LINE#@#  The difference in static allometric slope between the up- and the down-selected populations was only 0.022 ± 0.061 when the flies were starved, compared with 0.271 ± 0.061 in their unstarved siblings in the same generation (averaged over replicates and sexes).  #@NEW_LINE#@#  This genotype-by-environment interaction and the erratic selection response underscore the need for an experimental design with replicated controlled environments when investigating genetic differences in static slopes (as argued in ref.  #@NEW_LINE#@#  26).  #@NEW_LINE#@#  We hypothesize that the developmental processes responsible for the observed selection response in allometric slope are acting during the late third instar, when growth is precluded in the starved flies.  #@NEW_LINE#@#  The allometric relations may thus be the result of developmental palimpsests (36), where subsequent developmental processes are written on top of each other to partially mask variation created at different stages.  #@NEW_LINE#@#  Our results suggest that some of these processes are evolvable, causing a selection response in the slope, whereas others constrain small flies to remain on the original static allometric line.  #@NEW_LINE#@#  
A potentially confounding source of response to selection is the creation of linkage disequilibrium between alleles that affect wing size and alleles that affect L2 length.  #@NEW_LINE#@#  Such linkage disequilibrium could have generated a change in the allometric slope without changes in allele frequency.  #@NEW_LINE#@#  For example, an association between alleles that increase wing size with alleles that increase L2 length would increase the allometric slope between wing size and L2 length.  #@NEW_LINE#@#  To minimize linkage disequilibrium, we used disassortative mating when selecting on the static allometric slope.  #@NEW_LINE#@#  Female flies in the cluster above mean wing size were mated with male flies from below and vice versa (see Materials and Methods), so that recombination would be maximally effective in breaking up linkage disequilibrium.  #@NEW_LINE#@#  However, this does not completely prevent association between alleles, and we need to consider if the reversal of the response could have been due to breakup of linkage disequilibrium.  #@NEW_LINE#@#  Assuming an average recombination fraction of r = 0.365 between random loci in D. melanogaster (37), we estimated that the maximum fraction of the response that could be due to linkage disequilibrium averaged only 19.9 ± 22.6% and 14.3 ± 24.0% in males and females, respectively.  #@NEW_LINE#@#  
Nongenetic inheritance, such as parental (e.g., maternal) effects, may, in principle, affect the response to selection (38) but is not likely to be important in this case, as there are no indications of heritable nongenetic effects on wing shape in drosophilids.  #@NEW_LINE#@#  
We consider natural selection to be the most likely cause of the reversal toward the ancestral allometric slope.  #@NEW_LINE#@#  However, natural selection for restoring optimal wing function, for example due to selection for flight or courtship behavior, does not seem to be strong in the laboratory environment.  #@NEW_LINE#@#  In the presence of such selection, we expect that the intercept-selected populations would also have rapidly returned to their starting value.  #@NEW_LINE#@#  These populations instead showed little reversal of the selection response over an even longer time period, despite being more different from the initial wing shape than the slope-selected populations.  #@NEW_LINE#@#  Therefore, the more likely alternative is that the evolutionary change in allometric slope generated deleterious pleiotropic responses in other aspects of the phenotype, resulting in strong natural selection in the laboratory environment.  #@NEW_LINE#@#  
We have shown that a phylogenetically nearly invariant allometric slope can evolve rapidly under selection, but that this seems to generate countervailing natural selection to return the allometric slope to its initial value.  #@NEW_LINE#@#  This suggests that conserved allometric scaling may be best explained by pleiotropic constraints (12).  #@NEW_LINE#@#  Riedl (39, 40) proposed that fundamental developmental processes may become increasingly constrained, or burdened, by other processes that interact with or depend on them.  #@NEW_LINE#@#  Under this hypothesis, aspects of the developmental system that lead to precise allometric scaling also affect other aspects of organismal form and function, leading to deleterious pleiotropic effects when they are altered.  #@NEW_LINE#@#  If true, this hypothesis could provide a general explanation for the striking evolutionary conservatism of allometric power laws, while still leaving open the possibility for allometries to be optimized by natural selection over long time scales through compensatory mutations.  #@NEW_LINE#@#  

SI_Materials_and_Methods  #@NEW_LINE#@#  
Derivation_of_Populations_for_the_Selection_Experiment  #@NEW_LINE#@#  
The 30 inbred lines from the Drosophila Genetic Reference Panel (45) used to form the initial population were RAL 149, 324, 383, 486, 563, 714, 761, 787, 796, 801, 802, 804, 808, 819, 821, 822, 832, 843, 849, 850, 853, 859, 861, 879, 887, 897, 900, 907, 911, and 913.  #@NEW_LINE#@#  For the initial set of crosses, healthy lines were crossed with lines that were less fecund.  #@NEW_LINE#@#  Each cross, including reciprocals, was set up in six replicate vials of five or six females and three males.  #@NEW_LINE#@#  Virgin females and males were collected from the F1 offspring, and the next round of pairwise crosses was set up once a sufficient number of flies had been obtained.  #@NEW_LINE#@#  This procedure was continued until a single population resulted.  #@NEW_LINE#@#  
To found the initial (Generation 0) populations subjected to intercept and slope selection, we sampled 100 flies of each sex from the base population.  #@NEW_LINE#@#  For each of the starved control starting populations, we sampled 50 flies of each sex, and, for each of the well-fed control starting populations, we sampled 40 flies of each sex.  #@NEW_LINE#@#  

Rearing_of_Selected_Populations  #@NEW_LINE#@#  
Throughout the experiment, all of the selected populations (except those undergoing the starvation treatment; see below) were reared in 22-mm-diameter cylindrical vials containing 4 mL of food medium composed of yeast, corn flour, sucrose, propionic acid, and agar, plus an antibiotic (cycled between streptomycin, penicillin, and tetracycline).  #@NEW_LINE#@#  Vials were stored in an incubator at 25 °C, 5565% relative humidity, with a 12:12 h light/dark cycle.  #@NEW_LINE#@#  In all populations, flies were split into several vials for rearing, with roughly equal numbers of males and females.  #@NEW_LINE#@#  The number of adult flies in each vial was kept sufficiently low (less than 13 flies of each sex) to avoid high larval densities.  #@NEW_LINE#@#  Adult flies were allowed to lay eggs for 1 d, then transfered to new vials for an additional day, then discarded.  #@NEW_LINE#@#  To encourage remating, male and female parents were separated at the first transfer, and placed in vials with opposite-sex flies from a different vial.  #@NEW_LINE#@#  When flies began to eclose, virgins were collected at 8-h intervals and separated by sex.  #@NEW_LINE#@#  Virgins were kept in vials with no more than 10 females or 15 males until imaging.  #@NEW_LINE#@#  
In a second set of populations, we attempted to generate more efficient selection on the allometric slope by increasing the variance in size, potentially reducing the sampling variance in the estimation of the allometric slope.  #@NEW_LINE#@#  This was achieved by subjecting half the larvae in those populations to a starvation treatment, similar to that of Stillwell et al.  #@NEW_LINE#@#  (48).  #@NEW_LINE#@#  Larvae prevented from feeding after they reach a critical size for pupariation (approximately the start of the third larval instar) can eclose, but forego the most rapid period of growth, resulting in very small adults; following starvation, adults can have a thorax length as small as half the average size of fully fed flies.  #@NEW_LINE#@#  Thus, combining starved and normally reared flies greatly increases the variance in size among flies.  #@NEW_LINE#@#  Each generation, the selected adult flies in the starved populations were split evenly into two groups: One half was allowed to lay eggs in vials as described above, and their larvae were fed throughout the larval phase.  #@NEW_LINE#@#  The other half was confined overnight in a 90-mm Petri dish with standard food medium, during which time they mated and laid eggs.  #@NEW_LINE#@#  The following day, adults were removed from these egg layers, and the Petri dishes were placed in an incubator for 46 d. The dishes were checked regularly, and when most of the larvae appeared to have reached critical size for survival to adulthood, they were removed from the dish and placed in vials containing agar only, with no more than 20 larvae per vial.  #@NEW_LINE#@#  These larvae continued to consume the nonnutritive agar medium for several days before pupariation.  #@NEW_LINE#@#  Because the timing of development varied greatly among the selected populations, we used the average size as determined by visual inspection to determine when the larvae had reached the critical size.  #@NEW_LINE#@#  Equal numbers of adults from starvation and normal treatments were imaged in the starved populations.  #@NEW_LINE#@#  
Later in the course of the experiment, the fecundity of the two replicate starved slope-selected populations decreased.  #@NEW_LINE#@#  To counter this, we induced females to lay more eggs by removing the males from egg layers after the first day and replacing them with mated females from a stock bearing the Tubby (Tb) and white (w) mutations.  #@NEW_LINE#@#  The increased density of ovipositing females encouraged further egg laying by the selected females.  #@NEW_LINE#@#  The Tb phenotype enabled us to identify and remove the mutant larvae; mutant adults that remained were identified by the w eye color mutation and removed.  #@NEW_LINE#@#  Even with this method, however, we were sometimes unable to collect the full 200 virgin flies from each population toward the end of the experiment.  #@NEW_LINE#@#  

Justification_of_the_Allometric_Slope_Selection_Index  #@NEW_LINE#@#  
We developed a selection index based on Huxleys allometric model.  #@NEW_LINE#@#  Huxley (5) showed that a traits size (Y) relates to body size (X) by an allometric relation if both trait size and body size depend on some common growth variable G, such that dX/dt = uXG and dY/dt = vYG, where u and v are specific constants for body size and trait size, respectively, and t is the time of growth.  #@NEW_LINE#@#  Solving these differential equations for X and Y at some developmental stage (e.g., t = adult) gives the power functionsX=X0Qu,Y=Y0Qv,where X0 and Y0 are initial values for X and Y, and Q is G integrated over [t = 0, t = adult].  #@NEW_LINE#@#  Transforming these power functions to the natural log scale givesx=x0+uq,y=y0+vq,where the lowercase letters x, y, and q are used to indicate loge-transformed variables.  #@NEW_LINE#@#  From this, we get the allometric equationy=loge[a]+bx,where the allometric slope b = v/u, and the allometric intercept loge[a] = y0  bx0.  #@NEW_LINE#@#  We are interested in selecting on the ratio v/u.  #@NEW_LINE#@#  Assuming that u and v as well as relative fitness (w) are multivariate normally distributed with no correlation between u and v, the selection differential of the ratio b = v/u is given byS[b]=Cov[vu,w]=Cov[1u,w]v¯+E[1u(vv¯)(w1)]1u¯(Cov[v,w]E[1u]Cov[u,w])=1u¯(S[v]b¯S[u]),where E[.]  #@NEW_LINE#@#  or one overbar denotes the expectation, S[v] = Cov[v, w], S[u] = Cov[u, w], and b¯=E[v/u].  #@NEW_LINE#@#  The approximation is from the Taylor series 1/u1/u¯(uu¯)/u¯2, and is a good approximation when the coefficient of variation (CV) of u is small.  #@NEW_LINE#@#  From this, we see that the selection differential on v/u is proportional to the selection differential on v (S[v]) minus the selection differential on u (S[u]) weighted by the average allometric slope.  #@NEW_LINE#@#  To obtain these selection differentials, we use the standard quadratic relative fitness function w =  + xx + yy + ½xx2+ ½yy2+xyxy, where  is the intercept and x, y, x, y, and xy can be interpreted as the standard linear and quadratic selection gradients of x and y.  #@NEW_LINE#@#  We scale so that x¯=0 and y¯=0; the selection differentials S[v] and S[u] as functions of the selection gradients are then given byS[v]=Var[q]Var[v](y+u¯xy),S[u]=Var[q]Var[u](x+v¯xy).Substituting this into the equation for the selection differential on b, we obtainS[b]=1u¯Var[q](Var[v]yb¯Var[u]x+u¯(Var[v]b¯2Var[u])xy).  #@NEW_LINE#@#  [S1]This equation shows that disruptive selection on y (positive y) and stabilizing selection on x (negative x) both select for increased allometric slope.  #@NEW_LINE#@#  A positive correlational selection gradient (xy), on the other hand, contributes to increased allometric slope only whenVar[v]b¯2Var[u].This is because the correlational selection generates a selection differential both on Cov[x, y] and on Var[x].  #@NEW_LINE#@#  Assuming that the average allometric slope (b¯) equals the ratio Cov[x, y]/Var[x], we can simplify Eq.  #@NEW_LINE#@#  S1 by ensuring that there is no selection on Var[x].  #@NEW_LINE#@#  To accomplish this, we use the following argument from standard quantitative genetic theory: We know that the selection differential of the phenotypic covariance matrix (S[P]), when there is no linear selection, is given by S[P] = PP, where  is the matrix of quadratic selection gradients.  #@NEW_LINE#@#  Under the assumption of multivariate normality, we can derive the selection differential of the variance of x,S[Var[x]]=Var[x]2x+2Var[x]Cov[x,y]xy+Cov[x,y]y.This shows that there is no selection differential on the variance of x (S[Var[x]] = 0) when x=2b¯xy and y = 0.  #@NEW_LINE#@#  Substituting x=2b¯xy and y = 0 into Eq.  #@NEW_LINE#@#  S1 givesS[b]=Var[q](b¯2Var[u](2u¯1)+Var[v])xy.Biologically realistic values of u are less than 1 and certainly not higher than 2, because the amount of resources allocated to X is most likely a diminishing function of the total amount of resources available (Q).  #@NEW_LINE#@#  This means that this selection differential of the allometric slope is proportional to xy when there is no selection on the variance of x.  #@NEW_LINE#@#  
The average individual allometric slope (b¯) in the above models relates to the observed static allometric slope, bstatic = Cov[x, y]/Var[x], in the same way as the average ontogenetic allometric slope relates to the static allometric slope (see ref.  #@NEW_LINE#@#  23).  #@NEW_LINE#@#  In essence, this means a change in b¯ is expected to give the same change in bstatic, and that b¯ = bstatic if both the individual allometric intercept (loge[a]) and slope (b) are uncorrelated with size (x).  #@NEW_LINE#@#  
Based on the above results, we constructed the selection index for the slope asWslope=x(xx¯)+y(yy¯)+12x(xx¯)2+xy(xx¯)(yy¯),where xy = 1 for the up selection (increase in slope) and 1 for the down selection (decrease in slope).  #@NEW_LINE#@#  We did not directly use x = 0, y = 0, and x = 2b¯xy, because it is unlikely that the sample distribution is perfectly multivariate normal.  #@NEW_LINE#@#  Instead, the function (Wslope) was optimized for the parameters x, y, and x, to generate as little selection as possible on the means of x and y and on the variance of x.  #@NEW_LINE#@#  

Selection_Procedure  #@NEW_LINE#@#  
For the intercept selection, we wanted the average size of the selected individuals to be as similar as possible to the average size of all individuals in the population (i.e., no selection on size).  #@NEW_LINE#@#  To do this, we searched a wide range of values of 1 to find the value that minimized the value of (S[x])2, where 1 is the directional selection gradient on size and S[x] is the selection differential on size (i.e., the difference between the mean size of the selected individuals and the mean size of all individuals in the population).  #@NEW_LINE#@#  
For the slope selection, the optimization was done in three rounds to estimate the parameters x, y, and x.  #@NEW_LINE#@#  First, we searched through a range of different values for x with x = 0 and y = 0, to minimize (S[Var[x]])2, where S[.]  #@NEW_LINE#@#  denotes the selection differential.  #@NEW_LINE#@#  Next, we searched through a wide range of combinations of values of x and y to minimize (S[x]/x¯)2+(S[y]/y¯)2 with x at its current optimized value [i.e., the value that gave the lowest (S[Var[x]])2].  #@NEW_LINE#@#  Finally, we did a second round of searching through different values of x to minimize (S[Var[x]])2, but this time with x and y at the optimized values.  #@NEW_LINE#@#  

Statistical_Analyses_of_the_Comparative_Data  #@NEW_LINE#@#  
To estimate the rate of evolution for the allometric intercept, we fitted a Brownian-motion model of evolution using the phylogenetic mixed model (46)yijk=ui+bixij+aj+ijk,where y is loge L2 length, x is loge wing size (square root of wing area), u is the common intercept for each sex, b is the evolutionary allometric slope for each sex, a is the phylogenetic effect, and  is the residual term.  #@NEW_LINE#@#  The subscripts i, j, and k, represent sex, species, and individual, respectively, and subscript  means the average taken over the indicated level.  #@NEW_LINE#@#  The residuals are assumed to be independent identically normally distributed, whereas the phylogenetic effects are assumed to be distributed as a  N(0, rate2 A), where A is a phylogenetic relatedness matrix in which the elements are the shared branch length of species scaled to unit depth.  #@NEW_LINE#@#  This matrix was computed from a published phylogeny (42) with two species added based on other published evidence: Drosophila arizonae (41) and D. athabasca (49).  #@NEW_LINE#@#  Note that six species were not included in this analysis because they were not in our phylogeny (Homoneura sp., Leucophenga sp., Monochaetoscinella sp., Neogriphoneura sordida, Samoaia leonensis, and Thaumatomyia sp.).  #@NEW_LINE#@#  The rate (increase in variance) per million years is given by rate2/t, where t is the depth of the phylogeny in millions of years.  #@NEW_LINE#@#  Because the depth of this phylogeny is highly uncertain (47), we used both a best guess of 133 million years and a conservative estimate of 50 million years to estimate the rate.  #@NEW_LINE#@#  
To estimate the rate of evolution for the allometric slope, we fitted a similar model as for the intercept,yijkyij=bi(xijkxij)+aj(xijkxij)+ijk,where b is the common within-species slope for each sex separately.  #@NEW_LINE#@#  The phylogenetic effects of the slope (aj) are assumed to be distributed as the phylogenetic effects of the intercept, and the residuals (ijk) are assumed to be independent identically normally distributed.  #@NEW_LINE#@#  The per-million-year evolutionary rate for the slope was calculated in the same way as for the intercept.  #@NEW_LINE#@#  
The static allometric relationships within each sex for each species, presented in Fig 1, were estimated by standard linear regression models with loge L2 length as the response variable and loge wing size as the explanatory variable.  #@NEW_LINE#@#  The evolutionary allometry for each sex was a linear regression on the species means with loge L2 length as response and loge wing size as predictor.  #@NEW_LINE#@#  

Statistical_Analyses_of_the_Selection_Experiment  #@NEW_LINE#@#  
Changes and differences in allometric intercept and slope of loge vein L2 length on loge wing size (square-root wing area) were analyzed by a series of linear mixed-effects models because of the hierarchical structure of the data.  #@NEW_LINE#@#  
For the selection on the intercept, we wanted to estimate the following parameters: the average wing size (intercept) in the starting generation for each sex i (ui), the average allometric slope for each sex (bi), the linear change per generation of the intercept for all treatments j (up selected, down selected, and control) nested within sex (a1ij), the quadratic response to selection of the intercept for the up- and down-selection treatment for each sex separately (a2ij), and the linear effect of relaxed selection on the intercept for the up and down selection treatment for each sex separately (a3ij).  #@NEW_LINE#@#  To estimate these parameters, we fitted a broken-stick mixed model with loge vein L2 length (yijklm) as a function of loge wing size centered within sex (xijklmxi) and generation (t),yijklm=ui+bi(xijklmxi)+a1ijt1+a2ijt12K+a3ijt2K+cijkt1+dijkl+ijklm,where subscripts k, l, and m denote population (nested within treatment), generation (nested within population), and individual, respectively.  #@NEW_LINE#@#  Subscript  means the average taken over the indicated level.  #@NEW_LINE#@#  We implemented the broken-stick regression model through the values of t1 and t2: t1 represents generations 07 for the selected populations (treatment up and down) and generations 023 for the controls.  #@NEW_LINE#@#  For the selected populations, t1 takes the values 07 for generations 07 and value 0 for generations 823.  #@NEW_LINE#@#  For the controls, t1 takes the values 023 for generations 023.  #@NEW_LINE#@#  The other generation variable, t2, represents generations 823; t2 takes the values 0 for generations 07 and 015 for generations 823.  #@NEW_LINE#@#  The indicator variable K takes the value 0 for the control treatment and 1 for the up and down selection treatments.  #@NEW_LINE#@#  We also included two random effects (cijk and dijkl).  #@NEW_LINE#@#  The first random effect, cijk, is the deviation of each replicated population nested within treatment from the rest of the model, assumed to be independent identically normally distributed.  #@NEW_LINE#@#  The second random effect, dijkl, is the deviation of each generation (nested within population) from the rest of the model.  #@NEW_LINE#@#  This second random effect is assumed to be multivariate normally distributed with a variance term multiplied with a relatedness matrix (A) to account for temporal autocorrelation.  #@NEW_LINE#@#  The diagonal elements of A are unity, and the off-diagonal elements are given by 0.5t, where t is the difference in number of generations for elements of A belonging to the same population, and zero for all other elements.  #@NEW_LINE#@#  The residuals (ijklm), the deviation of each individual fly from the model prediction, are assumed to be independent identically normally distributed.  #@NEW_LINE#@#  
For the selection on the slope, we wanted to estimate the following parameters: the common allometric slope for all treatments in the starting generation for each sex i separately (bi) and the linear change in allometric slope per generation t for each treatment j (up selected, down selected, and control) nested within sex (aij).  #@NEW_LINE#@#  To estimate these parameters, we used a random regression model where we used loge vein L2 length centered on the within-generation sex mean for each population k (yijklmyijkl) as response variable, and loge wing size within-generation sex mean for each population k (xijklmxijkl) and generation (t) as explanatory variables,yijklmyijkl=bi(xijklmxijkl)+aij(xijklmxijkl)t+cijk(xijklmxijkl)t+dijkl(xijklmxijkl)+ijklm,where the subscripts denote the same as in the model for selection on the intercept.  #@NEW_LINE#@#  The random effects cijk give the deviation to the treatment mean in the change of the allometric slope for each population (nested within treatment), dijkl gives the deviation in the allometric slope from the rest of the model for each generation l (nested within population), and ijklm is the residual deviation of each fly.  #@NEW_LINE#@#  The random effects are assumed to be independent identically normally distributed, except dijkl, which is distributed as dijkl in the model for the intercept.  #@NEW_LINE#@#  
Separate analyses of the unstarved and the starved populations were conducted using this model.  #@NEW_LINE#@#  
For the change in slope after selection in the unstarved populations, we wanted to estimate the following parameters: the average slope in the first generation for each treatment j (up and down selected) nested within sex i (bij), the linear change in the allometric slope per generation of random mating t for each treatment nested within sex (a1ij), and the change in allometric slope per generation of random mating due to breakup of linkage disequilibrium for each treatment nested within sex (a2ij).  #@NEW_LINE#@#  We fitted the following random regression model:yijklmyijkl=bij(xijklmxijkl)+a1ij(xijklmxijkl)t+a2ij(xijklmxijkl)(1rt)+cijk(xijklmxijkl)+dijkl(xijklmxijkl)+ijklm,where the subscripts denote the same as in the model for the selection on the intercept.  #@NEW_LINE#@#  The effect of linkage disequilibrium is a linear function of 1  rt, where r is the average recombination fraction, 0.365 in D. melanogaster (37), and t is number of generations of random mating.  #@NEW_LINE#@#  Hence, by including breakup of linkage disequilibrium as a linear effect in our model, we obtain an estimate of the asymptote at linkage equilibrium.  #@NEW_LINE#@#  The random effect cijk gives the deviation of the treatment mean allometric slope for each population (nested within treatment), dijkl gives the deviation in the allometric slope from the rest of the model for each generation l (nested within population), and ijklm is the residual deviation of each fly.  #@NEW_LINE#@#  The random effects are assumed to be independent identically normally distributed.  #@NEW_LINE#@#  
To estimate the maximum fraction of the selection response that was due to linkage disequilibrium in each sex (qi), we replaced the term a2ij(xijklmxijkl)(1rt) in the above random regression model with qi(xijklmxijkl)(1rt)K. In this model, the selection response in all treatments is scaled to 1 by using the scaling factor K with values 0.327 and 0.365 for the females and males, respectively, in the up-selection treatment, and 0.190 and 0.182 for the females and males, respectively, in the down-selection treatment.  #@NEW_LINE#@#  The value of K is the difference between the allometric slope in the starting generation and after selection ended (generation 0 of relaxed selection).  #@NEW_LINE#@#  Hence, the parameter qi is an estimate of the maximum average fraction of the total selection response that is consistent with linkage disequilibrium across treatments.  #@NEW_LINE#@#  The reason that this is the maximum fraction is that natural selection in the laboratory environment could also cause exponential decay.  #@NEW_LINE#@#  
To investigate the effect of starvation on the evolved slopes, we subjected some of the larvae of the unstarved populations to the starvation treatment one generation after selection ended.  #@NEW_LINE#@#  We estimated the difference in allometric slope between the up- and down-selected populations both for starved and nonstarved flies using analysis of covariance.  #@NEW_LINE#@#  
All analyses were done in R (50) using the packages lme4 (51) and pedigreemm (52).  #@NEW_LINE#@#  


Materials_and_Methods  #@NEW_LINE#@#  
Comparative_Data  #@NEW_LINE#@#  
Species were obtained by collection from the wild, from the Drosophila Species Stock Center, or from other collectors.  #@NEW_LINE#@#  The full list of 111 taxa, specifications, their collection locations, and sample sizes are reported in Table S6.  #@NEW_LINE#@#  Flies were reared using combinations of food, temperature, and rearing environments suggested to be optimal for each particular species based on the instructions from the source or from published sources.  #@NEW_LINE#@#  Wild-collected specimens were measured when we were unable to rear the flies in the laboratory.  #@NEW_LINE#@#  Most of the 111 taxa are currently classified in the paraphyletic genus Drosophila or to genera in the subfamily Drosophilinae (41, 42).  #@NEW_LINE#@#  In addition, we included two species of steganine drosophilids and five outgroup species from other families.  #@NEW_LINE#@#  Four drosophilid species are represented by more than one subspecies.  #@NEW_LINE#@#  Most species had sample sizes of around 200 measured flies, and the total sample size was 20,345.  #@NEW_LINE#@#  

Wing_Measurements  #@NEW_LINE#@#  
The full procedure for imaging wings and for estimating vein locations and corresponding landmarks has been described by Houle et al.  #@NEW_LINE#@#  (43).  #@NEW_LINE#@#  In short, the left wing of a live CO2-anesthetized fly is immobilized in a suction device, a digital image of the wing is obtained, and the program Wings3.8 (44) is used to fit cubic B-splines to the wing veins, from which the coordinates of landmarks and semilandmarks are extracted.  #@NEW_LINE#@#  The length of vein L2 was estimated as the straight-line distance between the humeral break in the costa and the distal end of L2.  #@NEW_LINE#@#  The square root of wing area was used as a measure of wing size.  #@NEW_LINE#@#  See Fig S3 for detailed information on the wing measurements.  #@NEW_LINE#@#  

Derivation_of_Populations_for_the_Selection_Experiment  #@NEW_LINE#@#  
The initial population was made by intercrossing 30 inbred lines obtained from the Drosophila Genetic Reference Panel (45).  #@NEW_LINE#@#  This population was allowed to mate freely for one generation before being divided into the selected populations.  #@NEW_LINE#@#  We maintained 16 different populations in this experiment: two selected for increase and two for decrease in allometric intercept, two for increase and two for decrease in allometric slope, two for increase and two for decrease in slope with the starvation treatment, and two unstarved and two starved controls.  #@NEW_LINE#@#  Details are given in SI Materials and Methods.  #@NEW_LINE#@#  

Rearing_of_Selected_Populations  #@NEW_LINE#@#  
Details are given in SI Materials and Methods.  #@NEW_LINE#@#  

Justification_of_the_Allometric_Slope_Selection_Index  #@NEW_LINE#@#  
Details are given in SI Materials and Methods.  #@NEW_LINE#@#  

Selection_Procedure  #@NEW_LINE#@#  
In the two replicate control populations, 2025 virgin females and 2025 males were chosen haphazardly and imaged before being divided into two vials to produce the next generation.  #@NEW_LINE#@#  
In the two replicate starved control populations, 50 virgin females and 50 males were imaged, then divided haphazardly into four groups of 25 flies each (12 or 13 of each sex).  #@NEW_LINE#@#  Two groups were placed in vials and their larvae fed normally; the other two were placed in egg layers, and their larvae underwent the starvation treatment (see SI Materials and Methods).  #@NEW_LINE#@#  Note that these two populations were started later in the experiment (at generation 5 of the other populations).  #@NEW_LINE#@#  
Two replicate populations were maintained for each direction (up and down) of selection on the allometric intercept.  #@NEW_LINE#@#  Each generation in each population, 100 virgin females and 100 males were chosen haphazardly and imaged.  #@NEW_LINE#@#  From these, 2025 of each sex were selected to produce the next generation, using the selection indexWint=1(xx¯)+2(yloge[a]bx),  #@NEW_LINE#@#  
where x is loge wing size (square-root wing area), x¯ is the average of x, y is loge L2 length, loge[a] is the allometric intercept, b is the allometric slope, and the term (y - loge[a] - bx) is the residuals of the allometric regression.  #@NEW_LINE#@#  For the up selection, 2 = 1, and for the down selection, 2 = 1, whereas 1 was optimized to reduce selection on size (see SI Materials and Methods).  #@NEW_LINE#@#  The selection index was fitted independently each generation within each selected population, and the flies were stored in individual vials from imaging until the selection index score of each fly was calculated.  #@NEW_LINE#@#  Selection on the intercept was maintained in both replicates (A and B) for seven generations for both the up and the down directions.  #@NEW_LINE#@#  After this, the A replicates were discarded, whereas up- and down-selected populations in replicate B were maintained with relaxed selection (i.e., the same mating regime as in the control populations) for an additional 16 generations.  #@NEW_LINE#@#  
For each direction (up and down) of selection on the allometric slope, we kept two replicate populations (A and B).  #@NEW_LINE#@#  Each generation in each population, 100 virgin females and 100 males were imaged, of which 24 were selected using the selection indexWslope=x(xx¯)+y(yy¯)+12x(xx¯)2+xy(xx¯)(yy¯),  #@NEW_LINE#@#  
where xy = 1 for the up selection (increase in slope) and -1 for the down selection (decrease in slope).  #@NEW_LINE#@#  This function was optimized by choosing values of the parameters x, y, and x, to minimize selection on the means of x and y and on the variance of x (see SI Materials and Methods).  #@NEW_LINE#@#  The selection index was fitted independently each generation within each selected population, and the flies were stored in individual vials after imaging until the selection index score of each fly was calculated.  #@NEW_LINE#@#  To prevent linkage disequilibrium, we enforced disassortative mating on size by first dividing the selected flies into two groups, one containing the largest 12 females and smallest 12 males, the other with the smallest 12 females and largest 12 males.  #@NEW_LINE#@#  Each of these groups was then split at random into two groups of six males and six females, and each such group was placed in vials with another group of opposite-sex flies of contrasting size.  #@NEW_LINE#@#  These flies were allowed to mate and lay eggs overnight.  #@NEW_LINE#@#  Selection was carried out for 26 generations in replicate A and for 25 generations in replicate B.  #@NEW_LINE#@#  After this, we maintained the populations for an additional 13 generations in replicate A and 14 generations in replicate B under relaxed selection (i.e., the same mating regime as the control populations).  #@NEW_LINE#@#  At generation 23, we split off a population from each of the replicates and maintained these new populations under relaxed selection for 15 generations.  #@NEW_LINE#@#  At several points during the period of relaxed selection, we imaged 100 males and 100 females from each of the populations (see Fig 2B).  #@NEW_LINE#@#  
We also maintained two replicate starved slope-selected populations for each direction of slope selection.  #@NEW_LINE#@#  These were subjected to the same selection regime as the unstarved slope-selected populations but reared using the starvation treatment.  #@NEW_LINE#@#  Selection was carried out for 19 generations in these populations.  #@NEW_LINE#@#  Details are given in SI Materials and Methods.  #@NEW_LINE#@#  

Statistical_Analyses  #@NEW_LINE#@#  
To estimate the rate of evolution for the allometric intercept and slope, we fitted a Brownian-motion model of evolution using a phylogenetic mixed model (46).  #@NEW_LINE#@#  Because the depth of the phylogeny is highly uncertain (47), we used both a best guess of 133 million years and a conservative estimate of 50 million years to estimate the rate.  #@NEW_LINE#@#  
For the selection experiment, changes and differences in allometric intercept and slope of loge vein L2 length on loge wing size (square-root wing area) were analyzed by a series of linear mixed-effects models because of the hierarchical structure of the data.  #@NEW_LINE#@#  Details are given in SI Materials and Methods.  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
We thank Joseph Chen, Alex Cowart, Deanna DeRosia, Caitlin Ellinger, Andrew Falestiny, John Gonzalez, Amy Gordon, Axel Hadfeg, Jane-Elyse Henkel, Kyle Kilinski, Kirill Korshunov, Alina Krill, Dan Lam, Anastasia Lucignani, Edward Marques, Taylor Paisie, William Palmer, Andres Pareja, Enrique Story, and Jose D. Aponte for help in performing the selection experiment at Florida State University.  #@NEW_LINE#@#  This work was funded by the Research Council of Norway, Grant 196494/V40 to C.P.  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  


