article id="http://dx.doi.org/10.1073/pnas.1524383113"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Formation and maintenance of nitrogen-fixing cell patterns in filamentous cyanobacteria  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
Cyanobacteria produce an important fraction of oxygen on Earth and, together with archaea, fix atmospheric nitrogen used by all other organisms.  #@NEW_LINE#@#  Some types live in colonies with specialized cells that perform different functions.  #@NEW_LINE#@#  In particular, the genus Anabaena forms filaments in which some cells differentiate, forming patterns to effectively provide nitrogen for the colony.  #@NEW_LINE#@#  We present a theory that combines genetic, metabolic, and morphological aspects to understand this prokaryotic example of multicellularity.  #@NEW_LINE#@#  Our results quantitatively reproduce the appearance and dynamics of this pattern and are used to learn how different aspects, like fixed-nitrogen diffusion, cell division, or stochasticity, affect it.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Cyanobacteria forming one-dimensional filaments are paradigmatic model organisms of the transition between unicellular and multicellular living forms.  #@NEW_LINE#@#  Under nitrogen-limiting conditions, in filaments of the genus Anabaena, some cells differentiate into heterocysts, which lose the possibility to divide but are able to fix environmental nitrogen for the colony.  #@NEW_LINE#@#  These heterocysts form a quasiregular pattern in the filament, representing a prototype of patterning and morphogenesis in prokaryotes.  #@NEW_LINE#@#  Recent years have seen advances in the identification of the molecular mechanism regulating this pattern.  #@NEW_LINE#@#  We use these data to build a theory on heterocyst pattern formation, for which both genetic regulation and the effects of cell division and filament growth are key components.  #@NEW_LINE#@#  The theory is based on the interplay of three generic mechanisms: local autoactivation, early long-range inhibition, and late long-range inhibition.  #@NEW_LINE#@#  These mechanisms can be identified with the dynamics of hetR, patS, and hetN expression.  #@NEW_LINE#@#  Our theory reproduces quantitatively the experimental dynamics of pattern formation and maintenance for wild type and mutants.  #@NEW_LINE#@#  We find that hetN alone is not enough to play the role as the late inhibitory mechanism: a second mechanism, hypothetically the products of nitrogen fixation supplied by heterocysts, must also play a role in late long-range inhibition.  #@NEW_LINE#@#  The preponderance of even intervals between heterocysts arises naturally as a result of the interplay between the timescales of genetic regulation and cell division.  #@NEW_LINE#@#  We also find that a purely stochastic initiation of the pattern, without a two-stage process, is enough to reproduce experimental observations.  #@NEW_LINE#@#  

Basic_Genetics_of_Heterocyst_Differentiation  #@NEW_LINE#@#  
There is a large number of processes involved in the regulation of heterocyst pattern formation.  #@NEW_LINE#@#  In addition to nitrogen levels and other environmental aspects, many genes and factors play a role (24).  #@NEW_LINE#@#  When nitrogen stress is perceived, the transcriptional regulator ntcA is important to trigger heterocyst differentiation (25, 26), directly or indirectly controlling the expression of several genes (27, 28), including hetR.  #@NEW_LINE#@#  The gene hetR is central to heterocyst differentiation.  #@NEW_LINE#@#  Its expression is the main positive regulatory factor in heterocyst development (2932).  #@NEW_LINE#@#  The expressions of ntcA and hetR are mutually dependent, and the latter seems to be necessary and sufficient for heterocyst development, even under conditions of excess of external nitrogen (33).  #@NEW_LINE#@#  Thus, positive autoregulation of hetR is required for differentiation and is particularly significant in developing heterocysts (30, 34).  #@NEW_LINE#@#  In addition to ntcA, other genes such as patA, hetF, and hetP also regulate heterocyst differentiation (3538).  #@NEW_LINE#@#  
The gene patS is a negative regulator of hetR that suppresses differentiation when overexpressed and induces a Mch phenotype when deleted (23, 39, 40).  #@NEW_LINE#@#  PatS is a short peptide, predicted to be 13 or 17 aa, containing a carboxyl-terminal pentapeptide RGSGR that prevents DNA binding activity of HetR (41, 42) and inhibits differentiation when added to culture medium (23).  #@NEW_LINE#@#  The expression of patS in small groups of vegetative cells was shown to diminish the levels of HetR in adjacent cells (43), suggesting that a PatS-dependent signal can diffuse along the filament (44).  #@NEW_LINE#@#  It has been observed that patS is strongly expressed in developing heterocysts (23, 39), coming back to low levels after 24 h of nitrogen deprivation.  #@NEW_LINE#@#  Although lack of patS expression initially produces a pattern with frequent contiguous heterocysts and short intervals between separate ones, later this pattern tends to become more similar to a wild-type pattern (39), suggesting the presence of other patterning signals.  #@NEW_LINE#@#  
Thus, hetR and patS could be enough to obtain a minimalistic understanding of heterocyst pattern formation at early stages.  #@NEW_LINE#@#  However, other players have to be taken into account to explain pattern maintenance after an initial pattern of differentiated heterocysts appear.  #@NEW_LINE#@#  The key player for this role is the inhibitory factor hetN.  #@NEW_LINE#@#  Akin to PatS, HetN also contains a RGSGR motif, raising the possibility that a RGSGR-containing peptide derived from the full protein diffuses from cell to cell (45).  #@NEW_LINE#@#  In contrast to patS mutants, hetN mutants have a differentiation pattern similar to the wild type at the initial stages of nitrogen depletion and a Mch phenotype after 48 h (46), suggesting that hetN expression is activated later than that of patS.  #@NEW_LINE#@#  When both genes are suppressed, almost all cells along the filament eventually differentiate, causing lethal levels of heterocysts (47).  #@NEW_LINE#@#  
Metabolites have also been suggested to play a role in filament patterning, in particular the fixed-nitrogen products produced by heterocysts.  #@NEW_LINE#@#  It has been suggested that they inhibit heterocyst differentiation (39), although experiments with Anabaena variabilis (48, 49) did not find an observable effect.  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
Minimal_Model_for_the_Heterocyst_Differentiation_Gene-Regulatory_Network  #@NEW_LINE#@#  
Although the chemical and genetic regulation of heterocyst differentiation involves a great number of factors (4, 8, 24), we will focus on the core mechanisms involved: local autoactivation, early long-range inhibition, and late long-range inhibition.  #@NEW_LINE#@#  For concreteness, we will identify these generic mechanisms with the dynamics of three genes: hetR, patS, and hetN, and use what is known of their biochemistry to build a theoretical model.  #@NEW_LINE#@#  To first approximation, the effects of other genes like ntcA or patA could be included in a phenomenological way, as factors affecting the parameters.  #@NEW_LINE#@#  This approach will not capture all of the subtleties that the explicit inclusion of all possible effects would produce, but has the advantage of being generic, clear, and simple, allowing a more systematic analysis of the model.  #@NEW_LINE#@#  
Fig 1 shows a diagram of the minimal genetic network considered in our theoretical description.  #@NEW_LINE#@#  Upon nitrogen deprivation, hetR is expressed, partly in a constitutive way (34).  #@NEW_LINE#@#  Its protein acts as a dimer (42, 50, 51), binding the hetR and patS promoter regions and activating expression.  #@NEW_LINE#@#  HetR has recently been observed also as a tetramer (52); including that information in our model would only change parameter values but not the dynamics of differentiation.  #@NEW_LINE#@#  A PatS product, the RGSGR pentapeptide, can bind HetR with a 1:1 stoichiometry, and RGSGR-tagged HetR molecules can no longer bind DNA (41, 53).  #@NEW_LINE#@#  Because HetN also contains the RGSGR motif, we assume that it binds and affects HetR analogously to PatS.  #@NEW_LINE#@#  PatS is only produced in vegetative cells, whereas HetN is exclusively produced in heterocysts.  #@NEW_LINE#@#  Because expression of HetR remains high in heterocysts (54), we model it through constitutive expression.  #@NEW_LINE#@#  We will show later that a second late inhibitor with fast diffusion and a weaker inhibition power than HetN is required to reproduce some experimental findings.  #@NEW_LINE#@#  A likely candidate for this inhibitor could be the effect of fixed-nitrogen products.  #@NEW_LINE#@#  Finally, we include intercellular diffusion of PatS, HetN, and fixed-nitrogen products.  #@NEW_LINE#@#  For simplicity, we do not represent RGSGR explicitly in our model, making instead its effect proportional to the concentration of PatS or HetN.  #@NEW_LINE#@#  Vegetative cells that maintain a threshold level of HetR during a predefined period are switched to heterocyst status.  #@NEW_LINE#@#  
In contrast to static patterns that are permanently defined once formed, the heterocyst pattern is a dynamic one: vegetative cells keep on growing and dividing, causing the intervals between contiguous heterocysts to continuously increase in size, until eventually a cell of the interval differentiates into a new heterocyst.  #@NEW_LINE#@#  Thus, we have included cell growth and division as a key ingredient of this model.  #@NEW_LINE#@#  Moreover, the stochastic nature of gene expression cannot be ignored, and especially the noise in the duration of the cell cycle can play a relevant role in defining the statistics of vegetative intervals between contiguous heterocysts.  #@NEW_LINE#@#  For this reason, noise should be included in a theoretical description, both in the genetic network and in cell division.  #@NEW_LINE#@#  The details of the mathematical formulation, analysis, and computer simulation of our model are described in Supporting Information.  #@NEW_LINE#@#  
From a physical perspective, the local (nondiffusive) character of the activator, the distinction between inhibitors acting at different times, and the dynamic character of the growing filament, are the features that set this problem apart from other reactiondiffusion pattern-forming systems.  #@NEW_LINE#@#  

The_Theoretical_Model_Quantitatively_Reproduces_Wild-Type_Patterns  #@NEW_LINE#@#  
A first feel of the properties of our model can be obtained by visual inspection of the patterns it produces (Fig 2, Fig S1, and Movie S1).  #@NEW_LINE#@#  Cells with high levels of HetR appear early (55), frequently in clusters.  #@NEW_LINE#@#  Eventually only some isolated cells differentiate into heterocysts, whereas the others revert to a low HetR state.  #@NEW_LINE#@#  Once a heterocyst pattern is established, cell division increases the vegetative interval length between heterocysts.  #@NEW_LINE#@#  At some point, one or a few cells roughly in the middle of the interval increase their HetR levels, and, finally, just one vegetative cell differentiates into a new heterocyst, thus maintaining the quasiregularity of the pattern.  #@NEW_LINE#@#  
The properties of heterocyst patterns can be quantified making a histogram showing the relative frequency of vegetative intervals of each length.  #@NEW_LINE#@#  Changes in the shape of this histogram allow to characterize differences between different phenotypes, and also between different stages of filament growth after nitrogen deprivation.  #@NEW_LINE#@#  We have obtained these histograms and other statistical data averaging over 192 different filaments of 150 initial vegetative cells.  #@NEW_LINE#@#  The histograms in Fig 3 are remarkably similar to experimental ones (23, 39, 43, 44, 47, 5660), reproducing details such as the increase of the typical length of vegetative intervals with time, the gradual broadening of the shortest intervals observed on the filament, or the higher frequency of even intervals.  #@NEW_LINE#@#  The analysis can be pushed further from qualitative observation to quantitative characterization.  #@NEW_LINE#@#  This can be done using successive moments of the distributions given by the histograms: mean, variance, and skewness.  #@NEW_LINE#@#  The mean gives an estimation of the average interval length, and the variance, of the width of the intervals distribution.  #@NEW_LINE#@#  The skewness is a measure of the asymmetry of the distribution.  #@NEW_LINE#@#  Positive skewness indicates that the right tail of the distribution is heavier than the left tail, which is the situation generally found in experiments.  #@NEW_LINE#@#  We have compared the temporal evolution of these magnitudes in our simulations together with equivalent statistics extracted from experimental histograms in the literature (Fig 4).  #@NEW_LINE#@#  A first observation for the wild type is that the mean interval length slightly increases from 10 cells at 24 h up to 12 cells after a few days.  #@NEW_LINE#@#  
In the following, we proceed to discuss other conditions.  #@NEW_LINE#@#  To start with, in experiments, all cells of hetR mutants remain in the vegetative state (61).  #@NEW_LINE#@#  In the same way, because HetR is necessary for differentiation in our model, no heterocysts form in that condition.  #@NEW_LINE#@#  The same is true for any double knockdown involving hetR.  #@NEW_LINE#@#  Overexpression of hetR induces differentiation of all of the cells in the filament.  #@NEW_LINE#@#  

PatS_Promotes_Early_Pattern_Formation  #@NEW_LINE#@#  
The early behavior of the patS mutant is quite different from the wild type (Fig 5, Fig S2, and Movie S2).  #@NEW_LINE#@#  Due to the lack of PatS, before differentiation there is no sequestration of HetR that can weaken its autoinducing feedback loop, so all cells build up high levels of HetR at short times.  #@NEW_LINE#@#  The first cells to differentiate start producing HetN that diffuses to their neighbors and prevents others from differentiating; however, an abnormally high number of cells, some of them contiguous, have already become heterocysts.  #@NEW_LINE#@#  This is the Mch phenotype observed in experiments (8, 23, 39, 47, 61).  #@NEW_LINE#@#  This high number of heterocysts inhibit differentiation until the vegetative interval between them becomes large enough.  #@NEW_LINE#@#  For this reason, at long times the Mch phenotype is attenuated and the pattern becomes more similar to wild type.  #@NEW_LINE#@#  Because new cells cannot appear between contiguous heterocysts, this phenotype persists as a hallmark of the irregular initiation of pattern formation in patS mutants.  #@NEW_LINE#@#  The histograms for the patS mutant (Fig 3) show the predominance of contiguous heterocysts and short intervals at early times.  #@NEW_LINE#@#  Starting from mean intervals of five cells at 24 h, the mean converges to values similar to wild type after 4 d, as in experiments (Fig 4A).  #@NEW_LINE#@#  
These results confirm that PatS is essential during the first stages of pattern induction to produce a regular pattern.  #@NEW_LINE#@#  At late stages, a regular pattern can be maintained even in the absence of PatS, pointing to the need of a subsequent inhibitor key for pattern maintenance.  #@NEW_LINE#@#  Continuing the study of the effect of PatS on filament development, we have also simulated PatS overexpression.  #@NEW_LINE#@#  As observed in experiments (23), we found a complete repression of heterocyst differentiation in the filament.  #@NEW_LINE#@#  

HetN_Is_Necessary__but_Not_Sufficient__for_Pattern_Maintenance__A_Second_Inhibitor__Probably_Fixed-Nitrogen_Products__Also_Plays_a_Role  #@NEW_LINE#@#  
In the case of hetN loss of function, the presence of PatS assures a correct pattern formation until a first generation of heterocysts differentiates (Fig 6, Fig S3, and Movie S3).  #@NEW_LINE#@#  PatS produced in protoheterocysts inhibits the hetR feedback loop, but once those protoheterocysts differentiate into heterocysts, they cannot inhibit differentiation in their neighbors because they do not produce HetN.  #@NEW_LINE#@#  If the only mechanism of late long-range inhibition in the model is the hetN gene, in its absence, once a first pattern is established more and more cells continue to differentiate, until eventually the filament is almost entirely composed of heterocysts (Fig S4A and Movie S4).  #@NEW_LINE#@#  This is far from experimental observations, where the loss of hetN condition does induce an increase in the number of heterocysts and a Mch phenotype that eventually stabilizes with time, forming a pattern with roughly 20% of heterocysts (46, 47, 6163).  #@NEW_LINE#@#  This hints that a second late long-range inhibition mechanism must be at play to avoid the fatal differentiation of the whole filament.  #@NEW_LINE#@#  A natural candidate is the effect of fixed-nitrogen products produced by heterocysts (8, 39), although in principle it could be some other genetic or metabolic species.  #@NEW_LINE#@#  We have included it in our model explicitly, using a mechanism similar to that of HetN but with weaker inhibition power and larger diffusivity, which accounts for the smaller molecules involved (a detailed theoretical description of the effect of fixed nitrogen can be found in ref.  #@NEW_LINE#@#  19).  #@NEW_LINE#@#  When the inhibition by fixed-nitrogen products is taken into account, the model reproduces quantitatively the experimental data from hetN loss of function (Fig S4A).  #@NEW_LINE#@#  This suggests that, in a hetN loss-of-function background, fixed nitrogen plays a nonnegligible role in the maintenance of the pattern, a question that has been difficult to assess experimentally (8, 49).  #@NEW_LINE#@#  HetN and fixed-nitrogen products are not required for the appearance of the pattern but are essential for its maintenance at late stages.  #@NEW_LINE#@#  Because hetN is a much stronger inhibitor in our model, filaments in which fixed-nitrogen products have no function are identical to wild type (Fig S5 and Movie S5), in agreement with experiments in Anabaena variabilis (48, 49).  #@NEW_LINE#@#  
As in experiments (46), overexpression of HetN in our simulations prevents heterocyst differentiation.  #@NEW_LINE#@#  
We have also simulated the double patS:hetN knockdown condition.  #@NEW_LINE#@#  Because in our model only fixed-nitrogen products are working as a weak inhibitor, most of the cells in the filament quickly differentiate into heterocysts, as experimentally observed (47), although as late as after 100 h there is still a small fraction of vegetative cells.  #@NEW_LINE#@#  Under PatS or HetN overexpression on a hetN or patS mutant background, respectively, no heterocysts form, as observed (47).  #@NEW_LINE#@#  
Variance and skewness from our simulations also quantitatively compare well with experimental data (Fig 4 B and C).  #@NEW_LINE#@#  In contrast to the hetN mutant, for the wild type and the patS mutant skewness diminishes with time, as interval distributions become more symmetric.  #@NEW_LINE#@#  

Sequestration_by_PatS_and_HetN_Forms_Spatial_Gradients_of_HetR  #@NEW_LINE#@#  
We have simulated the dynamics of gene expression in the model (Movies S1S5).  #@NEW_LINE#@#  Because PatS and HetN (or more accurately, the pentapeptide RGSGR represented by them in our theory) can diffuse along the filament, not surprisingly their profiles can form gradients (64, 65).  #@NEW_LINE#@#  At early times after nitrogen deprivation, PatS levels increase in the whole filament (8, 23, 39).  #@NEW_LINE#@#  These levels remain high for some hours, but as some of these cells differentiate into heterocysts, system levels of PatS drop, and eventually high concentrations are observed only at new protoheterocysts that appear between formed heterocysts when filament growth moves them apart (39).  #@NEW_LINE#@#  The dynamics of HetN are somewhat reversed.  #@NEW_LINE#@#  At early times, HetN is not observed (66) because there are no heterocysts that produce it in the filament.  #@NEW_LINE#@#  At late times, HetN cell concentrations form quasiregular gradients with peaks at heterocysts (46, 67).  #@NEW_LINE#@#  
HetR concentration levels have been found to form interesting spatial profiles.  #@NEW_LINE#@#  For instance, expression of hetR has been shown to be correlated between neighbor cells before nitrogen deprivation (68).  #@NEW_LINE#@#  Because HetR does not diffuse, any gradient of its concentration would be produced by its interactions with the gradients of PatS and HetN.  #@NEW_LINE#@#  In addition, this is precisely what occurs in our model: the expression of HetR shows higher values in cells far apart from heterocysts.  #@NEW_LINE#@#  The resulting HetR profile shows variability from cell to cell, just as observed experimentally (43).  #@NEW_LINE#@#  Another prediction of this model is that the dynamics of the border cell is different from those in the middle, due to the accumulation of diffusing peptides at the end of the filament (see Fig S4B for more details).  #@NEW_LINE#@#  

Quasisynchronous_Cell_Division_Induces_Oscillatory_Variation_of_Pattern_Properties  #@NEW_LINE#@#  
The moments of the vegetative interval length distribution show an oscillatory behavior over time, especially the mean and the variance (Fig 4).  #@NEW_LINE#@#  The interpeak time in these oscillations is related to the average time for cell division.  #@NEW_LINE#@#  When vegetative cells divide synchronously, the average distance (and variance) between heterocysts increases.  #@NEW_LINE#@#  When a new heterocyst appears in the middle of an interval, it divides in two intervals roughly one-half in length.  #@NEW_LINE#@#  If the cell cycle is roughly synchronous in the whole filament, this mechanism will produce a lengthening of the mean interval with each round of cell division, and a shortening with each round of differentiation.  #@NEW_LINE#@#  To test this idea, we have made simulations with different levels of noise in cell growth dynamics (Fig 7A).  #@NEW_LINE#@#  Decreasing the noise, that is, synchronizing cell division, makes the oscillations of the mean interval distance more pronounced.  #@NEW_LINE#@#  Conversely, increasing the noise makes the oscillations disappear.  #@NEW_LINE#@#  The effects of the variation of the level of noise for other parameters are shown in Supporting Information (Fig S6).  #@NEW_LINE#@#  

Quasisynchronous_Cell_Division_Favors_Intervals_of_Even_Length  #@NEW_LINE#@#  
A characteristic property of the heterocyst pattern is the larger frequency of even-numbered vegetative cell intervals with respect to odd ones (58).  #@NEW_LINE#@#  This is apparent from experimental histograms of interval length in the literature (23, 39, 43, 5658).  #@NEW_LINE#@#  Our theory reproduces this observation for wild type and mutants (Fig 7B).  #@NEW_LINE#@#  The fraction of even intervals also shows an oscillatory behavior over time, a sign that it is also caused by the synchronous character of cell division along the filament.  #@NEW_LINE#@#  To test this, we plot (Fig 7C) the percentage of even intervals for different levels of noise in cell growth.  #@NEW_LINE#@#  For weak noise levels in cell growth, synchronous cell division induces a large fraction of even intervals.  #@NEW_LINE#@#  This fraction drops when interval lengths are large and several differentiation events happen almost simultaneously, randomizing interval parity until a new round of cell division occurs.  #@NEW_LINE#@#  In contrast, for high noise, rounds of cell division are not even well defined, and the percentage of even intervals remains always close to 50%.  #@NEW_LINE#@#  
Our result supports previous suggestions (56) that the synchronous division of vegetative cells during the time that new heterocysts are formed is responsible for the higher fraction of even intervals, with no need of extra mechanisms.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
In this work, we have shown that a model based on a positive-feedback loop that promotes heterocyst differentiation, plus three diffusible inhibitors, an early one with source at protoheterocysts and two late ones with source at heterocysts, is enough to explain the formation and maintenance of heterocyst patterns up to quantitative detail.  #@NEW_LINE#@#  As suggested by the biochemistry of the system (41), inhibition works through a multimer cloud mechanism (69), in which the formation of complexes between activators and inhibitors sequesters activator complexes and precludes them of realizing their activity.  #@NEW_LINE#@#  For clarity and concreteness, we have only considered the main genetic regulators of the system, hetR, patS, and hetN, as effective players for local activation, early long-range inhibition, and late long-range inhibition, respectively.  #@NEW_LINE#@#  A single late inhibitor would produce an overproduction of heterocysts in the hetN loss-of-function condition.  #@NEW_LINE#@#  This suggests the existence of, at least, a second late inhibitor, weaker and diffusing faster than HetN.  #@NEW_LINE#@#  A plausible candidate is the fixed nitrogen produced by heterocysts.  #@NEW_LINE#@#  
From a theoretical, more generic perspective, an interesting property of the model is that the main activator for heterocyst differentiation, HetR, is not diffusing.  #@NEW_LINE#@#  The main mechanisms for the pattern formation and maintenance are the positive-feedback loop for HetR production and diffusion of the inhibitor molecules between cells.  #@NEW_LINE#@#  The pattern shows a well-defined intrinsic wavelength, robust in time, that does not significantly change due to small variations in model parameter values (see Supporting Information for a sensitivity analysis, Fig S7).  #@NEW_LINE#@#  This contrasts with the classical Turing continuum model for pattern formation in reactive-diffusive systems (70), where the linear wavelength is proportional to the square root of the product of the activator and inhibitor diffusivities (71).  #@NEW_LINE#@#  Another main difference with most Turing systems is that the conditions for pattern formation in Turing models need to be finely tuned, and patterns are generally nonrobust in the sense that small variations in parameters may alter the observed wavelength, and even move the system out of the Turing regime.  #@NEW_LINE#@#  Actually, frequently in the Turing regime different patterns arise at the same point in parameter space, simply owing to slight variations in initial conditions.  #@NEW_LINE#@#  Obviously, this is not the case in heterocyst pattern formation, where a similar pattern is found independently of environmental and initial conditions.  #@NEW_LINE#@#  
A key aspect of our work is bringing together regulatory aspects and filament growth through cell division.  #@NEW_LINE#@#  Without this last aspect, it is possible to create pattern-forming models, but something as important as the maintenance of the pattern cannot be reproduced.  #@NEW_LINE#@#  Moreover, we show that it is not necessary to consider any cross talk between the cell cycle and the regulation of heterocyst differentiation to reproduce experimental patterns.  #@NEW_LINE#@#  This cross talk, or some other mechanism, has been postulated as a part of a two-stage model (58), where this mechanism would form a coarse prepattern, from which in a second stage protoheterocysts are refined (22).  #@NEW_LINE#@#  Our model reproduces quantitatively experimental patterns with a purely stochastic pattern initiation.  #@NEW_LINE#@#  Both small irregularities in the initial condition or the dynamic noise in the simulations are enough by themselves to trigger the emergence of the pattern.  #@NEW_LINE#@#  Although a first stage is not needed to form a prepattern, we cannot exclude its existence.  #@NEW_LINE#@#  Evidence for it has been found in a different strain of cyanobacteria, Nostoc punctiforme strain ATCC 29133 (60).  #@NEW_LINE#@#  
The mechanisms contemplated in our model are only the backbone of this patterning process.  #@NEW_LINE#@#  The phenotypes of other genes such as patA and hetF (33, 3537) show that there is more to the system than local activation and long-range inhibition.  #@NEW_LINE#@#  Future work should include modeling these finer mechanisms to be able to refine our understanding of how they work and discard hypothesis that do not pass the test of a theoryexperiment comparison.  #@NEW_LINE#@#  Also, extension to different strains of cyanobacteria, and, importantly, use of live gene expression data as in ref.  #@NEW_LINE#@#  68 are other main avenues for future work.  #@NEW_LINE#@#  A better understanding of biochemical kinetics and spatiotemporal aspects of gene expression and metabolite distribution would motivate the construction of models more experimentally constrained.  #@NEW_LINE#@#  This would allow to use these descriptions to obtain observable predictions and as guides to conduct novel experiments.  #@NEW_LINE#@#  

Model_Construction  #@NEW_LINE#@#  
We have constructed a model consisting of four variables per cell representing the concentration in the cell of molecular species responsible for the mechanisms of local autoactivation, early long-range inhibition and two types, strong and weak, of late long-range inhibition.  #@NEW_LINE#@#  We identify the molecules responsible for these mechanisms with HetR, PatS, HetN, and fixed-nitrogen products, and base the reaction scheme between the genes (Fig 1 of the main text) on the biochemistry discussed in ref.  #@NEW_LINE#@#  41.  #@NEW_LINE#@#  The identification of the weak late inhibitor with fixed-nitrogen products is speculative.  #@NEW_LINE#@#  However, they are a strong candidate to play this role, and in the following we will refer to them when discussing this mechanism.  #@NEW_LINE#@#  For simplicity, we do not describe mRNA concentrations and, for each cell i, have four variables: hi for the concentration of HetR monomers, pi for the concentration of PatS monomers, ni for the concentration of HetN monomers, and fi for the concentration of fixed-nitrogen products.  #@NEW_LINE#@#  
In our model, we distinguish between vegetative cells and heterocysts.  #@NEW_LINE#@#  In vegetative cells, HetN is not produced.  #@NEW_LINE#@#  HetR is produced with a small constitutive rate (34).  #@NEW_LINE#@#  Its monomers can bind into dimers (42, 50, 51).  #@NEW_LINE#@#  These HetR dimers can bind the hetR and patS promoter regions and activate production of HetR and PatS.  #@NEW_LINE#@#  If the concentration of HetR builds up above a threshold value without ever falling below a certain minimum value, the vegetative cell differentiates and turns into a heterocyst.  #@NEW_LINE#@#  Because heterocysts have already differentiated and HetR cannot diffuse between cells in our model, modeling HetR concentration in them is superfluous.  #@NEW_LINE#@#  However, because experimentally HetR concentration in heterocysts is high, we model it with a constitutive term.  #@NEW_LINE#@#  Heterocysts do not produce PatS, but HetN and fixed-nitrogen products are produced with a constitutive rate.  #@NEW_LINE#@#  
The RGSGR pentapeptide, a product of PatS, can bind HetR with a 1:1 stoichiometry, and RGSGR-tagged HetR molecules can no longer bind DNA (41).  #@NEW_LINE#@#  We assume the concentration of RGSGR derived from PatS is proportional to pi.  #@NEW_LINE#@#  HetN also contains a RGSGR motif (45), so as with PatS, we assume the concentration of RGSGR derived from HetN is proportional to ni.  #@NEW_LINE#@#  We allow the RGSGR pentapeptide to diffuse between neighbor cells, irrespectively of their vegetative or heterocyst identity.  #@NEW_LINE#@#  Because of this, we can find nonzero levels of pi in heterocysts or nonzero levels of ni in vegetative cells.  #@NEW_LINE#@#  Finally, we assume that HetR dimers tagged with one or two RGSGR molecules can no longer bind DNA (41).  #@NEW_LINE#@#  Hence, inhibition of HetR activity by PatS or HetN would be due to sequestration or titration of HetR dimers.  #@NEW_LINE#@#  This is similar to the cloud of dimers mechanism that appears in other biological processes (69).  #@NEW_LINE#@#  
Fixed-nitrogen products are assumed to diffuse between cells much faster than the RGSGR pentapeptide and be weaker inhibitors than HetN and PatS.  #@NEW_LINE#@#  

Mathematical_Formalism  #@NEW_LINE#@#  
The model description above can be used to write a set of chemical reactions for the following species: HetR monomers, HetR dimers (HetR:HetR), PatS monomers, HetN monomers, fixed-nitrogen products, and the complexes HetR:HetR:PatS, HetR:HetR:HetN, HetR:HetR:Pats:PatS, HetR:HetR:HetN:HetN, and HetR:HetR:PatS:HetN.  #@NEW_LINE#@#  PatS and HetN in the complexes actually represent RGSGR molecules.  #@NEW_LINE#@#  Only monomers can be produced by transcription and translation (bundled into a single process).  #@NEW_LINE#@#  We consider linear degradation kinetics for both monomers and multimers.  #@NEW_LINE#@#  Formation of a complex between HetR:HetR and the promoter regions of hetR and patS in vegetative cells is also considered.  #@NEW_LINE#@#  The formation of these complexes increases the rate of HetR and PatS production, respectively.  #@NEW_LINE#@#  The effect of fixed-nitrogen products is included in a phenomenological way as an inhibition in the regulatory function controlling the production rate of HetR and PatS.  #@NEW_LINE#@#  Assuming mass-action kinetics, we can write differential equations for the time evolution of each species.  #@NEW_LINE#@#  Making the usual assumption that all of the multimer reactions (binding and unbinding of monomers) are much faster than degradation reactions (72), we can make an adiabatic approximation and eliminate all multimer concentrations from the description.  #@NEW_LINE#@#  The resulting kinetics for monomer concentrations are as follows:dhi(t)dt=bh+ahg(hi,pi,ni,fi)hhi(t)[1+2hi(t)],[S1]dpi(t)dt=bp+[1hc,i]apg(hi,pi,ni,fi)ppi(t)+dp[pi+1(t)2pi(t)+pi1(t)],[S2]dni(t)dt=bn+hc,iannni(t)+dn[ni+1(t)2ni(t)+ni1(t)],[S3]dfi(t)dt=bf+hc,iafffi(t)+df[fi+1(t)2fi(t)+fi1(t)],[S4]withg(hi,pi,ni,fi)=[hi(t)k]21+[hi(t)k]2+pi(t)Kd+ni(t)Kd+[pi(t)Kd]2+[ni(t)Kd]2+pi(t)ni(t)Kd2+fi(t)Kf.  #@NEW_LINE#@#  [S5]The subindex i means that the variable is referred to cell i in the filament, its neighbor cells are i1 and i+1 (cells at the extremes of the filament only have one neighbor), t denotes time, hi is the HetR concentration in cell i, pi is the PatS concentration, ni is the HetN concentration, and fi is the fixed-nitrogen products concentration.  #@NEW_LINE#@#  In a parameter, the subindex h means that it is related to variable hi, p to pi, n to ni, and f to fi.  #@NEW_LINE#@#  bh, bp, bn, and bf are basal or constitutive production rates; we have used bp=bn=bf=0, but checked that the model is robust to finite values of these parameters.  #@NEW_LINE#@#  ah, ap, an, and af are the maximum regulated production rates.  #@NEW_LINE#@#  h, p, n, and f are linear degradation rates.  #@NEW_LINE#@#  dp, dn, and df are intercellular diffusion rates.  #@NEW_LINE#@#  We take the concentration of each species to be homogeneous inside a cell.  #@NEW_LINE#@#  The nonlinear degradation term in the equation for hi appears as the effect of dimer-mediated degradation of monomers (69).  #@NEW_LINE#@#  The parameter  is related to the rates kb of HetR monomers binding to form HetR dimers, ku of HetR dimers unbinding into HetR monomers, d of dimer degradation, and h of monomer degradation as follows:=kbh(1kuku+d).  #@NEW_LINE#@#  [S6]The factor hc,i specifies whether the cell is vegetative or a heterocyst: its value is 1 if cell i is a heterocyst, and 0 if it is vegetative.  #@NEW_LINE#@#  Because heterocysts cannot divide, initially all cells are vegetative and have hc,i=0; it changes to hc,i=1 if at any point the cell differentiates into a heterocyst.  #@NEW_LINE#@#  Regulation of the production of hi and pi is done through the function g(hi,pi,ni,fi) specified in Eq.  #@NEW_LINE#@#  S5.  #@NEW_LINE#@#  k is the equilibrium constant (or dissociation constant) of the bindingunbinding reaction between the HetR dimer and the hetR and patS promoters; for simplicity, we take both these constants to have the same value.  #@NEW_LINE#@#  Kd is the equilibrium constant for the bindingunbinding reaction between HetR and the RGSGR pentapeptide.  #@NEW_LINE#@#  Its value has been measured experimentally for PatS-derived RGSGR: Kd=227±23 nM (41).  #@NEW_LINE#@#  We assume the same value for HetN-derived RGSGR.  #@NEW_LINE#@#  The different terms with Kd in the denominator of Eq.  #@NEW_LINE#@#  S5 come from the titration of HetR dimers by a single PatS-derived RGSGR molecule, a single HetN-derived RGSGR molecule, two PatS-derived RGSGR molecules, two HetN-derived RGSGR molecules, and one PatS-derived plus a HetN-derived RGSGR molecules, respectively.  #@NEW_LINE#@#  The function could have been approximated by a simpler one where only the pi2 and ni2 terms related to Kd would be taken into account: this would have not changed the dynamics of the model in any relevant way.  #@NEW_LINE#@#  For the effective constant Kf controlling the strength of HetR and PatS repression by fixed-nitrogen products, we have chosen to use the same value as for Kd.  #@NEW_LINE#@#  Taking Kf=Kd may be unrealistic.  #@NEW_LINE#@#  However, the strength of the effect of the fixed-nitrogen products is given by both Kf and by its production rate af.  #@NEW_LINE#@#  To make this inhibition effect weaker than the effect of HetN, we have set the production rate of the fixed-nitrogen products to be much lower than the production rate of HetN, afan.  #@NEW_LINE#@#  

Model_Implementation  #@NEW_LINE#@#  
We have implemented a code in an object-oriented platform to model the differentiation and growth of vegetative and heterocyst cells.  #@NEW_LINE#@#  In this programming environment, each cell is described by an agent that has its own variables representing cell size and the current concentration of the species considered, HetR, PatS, HetN, and fixed-nitrogen products.  #@NEW_LINE#@#  These agents are ordered in a structure representing the filament.  #@NEW_LINE#@#  Because there can be a net flux of protein concentration between cells, the evolution equations for each agent are coupled with the equations for its adjacent neighbors.  #@NEW_LINE#@#  Cells at the extremes of the filament only have one neighbor.  #@NEW_LINE#@#  The evolution of the protein and fixed-nitrogen products concentrations for each cell is based on the noisy version of Eqs.  #@NEW_LINE#@#  S1S4.  #@NEW_LINE#@#  The stochastic nature of gene expression has been considered in our model by extending the equations derived above to the Langevin dynamics in the Itô interpretation (73).  #@NEW_LINE#@#  Because the evolution for a given concentration at cell i, xi, consists on a sum of production (synthesis) terms, Pi, minus the sum of degradation terms, Di, a stochastic term of the form xi(t)Pxi+|Dxi| was included in Eqs.  #@NEW_LINE#@#  S1S3.  #@NEW_LINE#@#  Here, xi(t) is an uncorrelated Gaussian white noise with zero mean and variance xi(t)xi(t)=ii(tt)/V, where V is an nondimensional effective volume setting noise strength in gene expression (73).  #@NEW_LINE#@#  
Vegetative cell growth was modeled by a stochastic differential equation for each agent:dsi(t)dt=+si(t),[S7]where si is the size of cell i,  is a constant growth rate, and si(t) is an uncorrelated Gaussian white noise with zero mean and variance si(t)si(t)=Gii(tt), which models the intrinsic fluctuations in the growth process.  #@NEW_LINE#@#  Starting from an initial size, each cell evolves following Eq.  #@NEW_LINE#@#  S7 up to a maximum size di, which is a noisy value drawn from a Gaussian distribution for each cell.  #@NEW_LINE#@#  When this size is reached, the vegetative cell divides, producing two new vegetative cells with one-half of its current size and identical protein concentrations.  #@NEW_LINE#@#  Heterocysts grow following the same dynamics, but once reached their maximum size, di, they do not divide and stop growing.  #@NEW_LINE#@#  
To differentiate into a heterocyst, a vegetative cell has to build up a certain level of HetR.  #@NEW_LINE#@#  This has been implemented integrating over time for each vegetative cell the value of HetR concentration, once the value of hi is above a threshold rs.  #@NEW_LINE#@#  This threshold is cell specific, being drawn from a Gaussian distribution.  #@NEW_LINE#@#  If at any point the value of hi drops below rs, the integral is reset to zero.  #@NEW_LINE#@#  Otherwise, if the integral ever reaches a value ci, also a cell-specific Gaussian distributed parameter, the vegetative cell differentiates into a heterocyst and hc,i changes from 0 to 1.  #@NEW_LINE#@#  An alternative way to model the differentiation decision is to consider that, if hi is above a given threshold for a certain window of continuous time, that particular vegetative cell will transform into a heterocyst.  #@NEW_LINE#@#  We checked this procedure, using the same threshold rs listed in Table S2 and a time window of 8 h, which has produced results indistinguishable from the method based on integrating the concentration over time.  #@NEW_LINE#@#  
Numerical integration of the equations has been made using the EulerMaruyama approximation for stochastic differential equations (74).  #@NEW_LINE#@#  Each simulation starts with 150 cells of size 3.3 m, and initial concentrations at each cell pi(0)=ni(0)=0 nM and a noisy value drawn from a Gaussian distribution with mean 9.4 and SD 0.2 nM for hi(0).  #@NEW_LINE#@#  No-flux boundary conditions were employed.  #@NEW_LINE#@#  The beginning of the simulation represents the moment of nitrogen deprivation.  #@NEW_LINE#@#  The statistical results in this work come from an average over 192 different realizations.  #@NEW_LINE#@#  
To simulate loss-of-function conditions, we have made the relevant parameters equal to zero.  #@NEW_LINE#@#  For instance, for the patS loss-of-function condition, we used ap=0 nM/h, ensuring no PatS production.  #@NEW_LINE#@#  Overexpression is simulated setting the corresponding basal production rate equal to the maximum regulated production rate.  #@NEW_LINE#@#  
To calculate the mean, variance, and skewness of vegetative cell intervals (Fig 4 of the main text), we have not considered intervals of length 0, frequent in a Mch phenotype.  #@NEW_LINE#@#  The reason to do this is to allow comparison with experimental references that do not report this piece of information.  #@NEW_LINE#@#  

Parameter_Estimation  #@NEW_LINE#@#  
Some parameters were obtained from literature.  #@NEW_LINE#@#  The affinity of RGSGR to HetR, Kd, was taken directly from ref.  #@NEW_LINE#@#  41.  #@NEW_LINE#@#  We consider that cells that have just divided are about 2 m long and roughly double their size before division.  #@NEW_LINE#@#  With these numbers, we have considered a cellular growth rate of =0.05 m/h, which produces a mean generation time of 40 h, in agreement with the data from ref.  #@NEW_LINE#@#  56 analyzed in ref.  #@NEW_LINE#@#  13.  #@NEW_LINE#@#  All of the other parameters were chosen with the aim to quantitatively reproduce the observations of the heterocyst pattern dynamics for the wild-type and mutant phenotypes.  #@NEW_LINE#@#  A preliminary linear stability analysis of a continuous version of Eqs.  #@NEW_LINE#@#  S1S5 was performed to establish a valid range of parameters in which the homogeneous steady state of the system is unstable and a spatial pattern in the protein concentration levels appears.  #@NEW_LINE#@#  Parameter values used in the wild-type simulation are given in Table S1.  #@NEW_LINE#@#  
Together with the dynamic noise in gene expression and cell growth, some parameters have cell-specific values obtained from a Gaussian distribution using the BoxMuller algorithm.  #@NEW_LINE#@#  The mean and SD of these parameters are given in Table S2.  #@NEW_LINE#@#  

Temporal_Evolution_of_Gene_Expression_in_the_Filaments  #@NEW_LINE#@#  
Figs.  #@NEW_LINE#@#  S1S3 and S5 show the expression of all four species considered in the model for different conditions at 6, 12, 24, 48, and 72 h after nitrogen deprivation.  #@NEW_LINE#@#  Some of the main features of the temporal evolution of these concentrations for each phenotype have been already discussed in the main text.  #@NEW_LINE#@#  For instance, as already stressed there, high levels of PatS are found for the wild type at short times (Fig S1).  #@NEW_LINE#@#  However, PatS concentrations decrease with time, and, eventually, large gradients of PatS are found only around protoheterocysts at long times.  #@NEW_LINE#@#  The dynamics of HetN is different.  #@NEW_LINE#@#  Gradients of HetN are only observed next to heterocysts at late times.  #@NEW_LINE#@#  Regarding the differences between wild type and mutants, HetR levels are larger in the patS mutant than in the wild type and hetN mutant at short times, coming back to low levels after a few hours (Fig S2).  #@NEW_LINE#@#  This agrees with experimental observations (23, 39).  #@NEW_LINE#@#  Another main difference between the wild-type and the mutant phenotypes is that the appearance of contiguous heterocysts is more common in the mutants.  #@NEW_LINE#@#  However, in contrast to the early contiguous heterocysts in the patS mutant, in the hetN mutant they form at later times (Fig S3).  #@NEW_LINE#@#  Thus, if we inspect a hetN mutant a long time after nitrogen deprivation, a large amount of contiguous heterocysts can be found.  #@NEW_LINE#@#  

Differentiation_of_Border_Cells  #@NEW_LINE#@#  
The cells at the border of a filament are an interesting study case, because the possible accumulation of diffusing peptides may render their dynamics different from those of the cells in the middle of a filament.  #@NEW_LINE#@#  An extreme case is the patA mutant, in which mainly the border cells of the filament differentiate into heterocysts (33, 35, 37).  #@NEW_LINE#@#  In Fig S4B, we plot the frequency of heterocyst formation both in the whole filament and considering only the two border cells, for wild type, patS loss of function, hetN loss of function, and no late long-range inhibitors.  #@NEW_LINE#@#  In all cases, the probability of a border cell being a heterocyst grows over time, because once a border cell differentiates it will remain a heterocyst forever.  #@NEW_LINE#@#  
Regarding the wild type, border cells initially have a lower propensity to differentiate than other cells.  #@NEW_LINE#@#  This is due to the fact that no-flux boundary conditions were used in our model.  #@NEW_LINE#@#  Therefore, PatS does not diffuse at the borders and accumulates at them, which has an inhibitory effect on differentiation.  #@NEW_LINE#@#  However, once the first round of differentiation has occurred, the main role inhibiting differentiation is played by HetN, which is only produced in heterocysts and diffuses to their neighbor cells.  #@NEW_LINE#@#  Now, a border cell will be the one in its vegetative interval that is further away from the first heterocyst, so as cell division goes on moving that heterocyst further away from it, it will be the cell with higher chances to differentiate.  #@NEW_LINE#@#  For this reason, the probability of a border cell to become a heterocyst becomes larger than in the interior of the filament.  #@NEW_LINE#@#  
The initial situation in a hetN mutant is very similar to the wild type.  #@NEW_LINE#@#  However, after the first round of differentiation, the inhibitory effect on heterocyst formation occurs only through PatS and fixed-nitrogen products.  #@NEW_LINE#@#  The latter diffuses very fast and has an almost homogeneous distribution along the filament, so it does not significantly increase the border cells advantage to differentiate over the rest of the cells.  #@NEW_LINE#@#  Thus, the initial situation for the cells at the end of the filaments of having a smaller probability of transforming into a heterocyst is maintained due to PatS accumulation.  #@NEW_LINE#@#  For this reason, in hetN mutants, border heterocysts are less frequent than interior heterocysts.  #@NEW_LINE#@#  
The situation with no late inhibitors of any kind at early times is again similar to wild type, but as time goes by the probability to differentiate at the borders grows dramatically, just as in cells in the interior of the filament (Fig S4A).  #@NEW_LINE#@#  
In patS mutants, due to the lack of PatS accumulation at the borders, right after nitrogen deprivation there is not any inhibitor that stops a border cell from differentiating.  #@NEW_LINE#@#  Moreover, after the formation of the first generation of heterocysts, as in the wild type, the effect produced by HetN favors even higher probability of differentiation at the borders.  #@NEW_LINE#@#  Fig S4B shows that our simulations predict a very high frequency of border heterocysts in patS mutants.  #@NEW_LINE#@#  
In summary, PatS and HetN have opposite effects on the probability of a border cell to become a heterocyst.  #@NEW_LINE#@#  Due to its accumulation at the borders in this theoretical model, PatS diminishes this probability.  #@NEW_LINE#@#  For HetN, because cells at the ends of the filament are the ones further away from the first heterocyst producing HetN, their probability to become heterocysts is larger than for the rest of the cells.  #@NEW_LINE#@#  It would be very interesting to check these predictions with experimental observations.  #@NEW_LINE#@#  

Noise_Effects  #@NEW_LINE#@#  
In the simulations shown in Fig 7 A and C of the main text, three different pairs of values of the intrinsic noise in cell growth G and the SD of the maximum cell size di were used to reproduce weak, medium, and strong noise conditions in cellular growth.  #@NEW_LINE#@#  The values of the parameters or their SDs used for the weak and strong conditions in these simulations, and for the conditions discussed throughout this section, are indicated in parentheses in Tables S1 and S2.  #@NEW_LINE#@#  
We have also studied the effect of variability on G and di independently.  #@NEW_LINE#@#  Weak and strong noise in cell growth and maximum cell size have a similar effect as that observed in Fig 7A of the main text.  #@NEW_LINE#@#  Small values of these noises induce large oscillations in the mean interval distance between heterocysts.  #@NEW_LINE#@#  Large values decrease these oscillations (see, for example, Fig S6A for small and large deviations for the maximum cell size, di).  #@NEW_LINE#@#  
Increasing variation in the threshold, parameters rs and ci used to decide when a cell differentiates, produces a small decrease of the interval mean (Fig S6B).  #@NEW_LINE#@#  With a less homogeneous threshold, it is more probable that protoheterocysts close to mature heterocysts have small values of this threshold and differentiate easily.  #@NEW_LINE#@#  More regular and longer intervals are found with a weak variation in this parameter.  #@NEW_LINE#@#  
A similar effect as for the variation in rs is found for the stochasticity in gene expression.  #@NEW_LINE#@#  Strong noise (small values of V) produces a decrease in the mean interval length (Fig S6C).  #@NEW_LINE#@#  That is because large noise in gene expression dynamics makes it easier for protoheterocysts to reach high values of HetR concentration and differentiate, which leads to shorter vegetative intervals.  #@NEW_LINE#@#  Although there is no experimental data to make comparisons, a more detailed study of noise effects could represent an interesting direction for future work.  #@NEW_LINE#@#  

Sensitivity_Analysis_and_Robustness  #@NEW_LINE#@#  
We have performed a sensitivity analysis of the model (75) and find that the mean distance between heterocysts and other pattern features are robust in time and with respect to changes in model parameter values.  #@NEW_LINE#@#  The model is more sensitive to alterations in those parameters related to hetR production and degradation rates, and its affinity to promoters, stressing the importance of the HetR local positive feedback, and confirming that hetR acts as the master regulator of the process.  #@NEW_LINE#@#  In any case, for the parameter ranges considered, the system shows a stable heterocyst pattern with a well-defined wavelength for any initial and boundary conditions.  #@NEW_LINE#@#  
We define the sensitivity SYX of the observable Y with respect to changes in the parameter X as follows:SYX=logYlogX.  #@NEW_LINE#@#  [S8]This quantity is evaluated at some point in the parameter space.  #@NEW_LINE#@#  The logarithmic derivative defined above can be written as follows:SYX=dY/YdX/X.  #@NEW_LINE#@#  [S9]To compute the sensitivity for small changes in the parameter X, we approximate Eq.  #@NEW_LINE#@#  S9 by the ratio of relative changes as follows:SYX=Y/YX/X.  #@NEW_LINE#@#  [S10]We determine the sensitivity of the model to changes in a given parameter X by evaluating the selected observable Y at two points, the focal point X0 and X=X0+X.  #@NEW_LINE#@#  The sensitivity, SYX, thus defined is the ratio between the percentage change in the variable Y and the percentage change in the parameter X.  #@NEW_LINE#@#  
We have studied the model sensitivity and robustness by performing multiple simulations for all of the parameters in our model and checking how the parameters affect the main pattern characteristics.  #@NEW_LINE#@#  We show the results regarding the mean distance between heterocysts, as one of the most relevant features of the heterocyst pattern (Fig S7).  #@NEW_LINE#@#  We find that the model is most sensitive with respect to hetR production and degradation rates, and its affinity to promoters.  #@NEW_LINE#@#  The model is very robust to small variations of any other parameter.  #@NEW_LINE#@#  This shows that the local positive feedback is the master regulator of the process, and we have used this fact to fit the model to experimental results using the three key parameters as the main handles to pattern properties.  #@NEW_LINE#@#  

Acknowledgments  #@NEW_LINE#@#  
We thank Joel Stavans, Fernando Falo, and Jesús Gómez-Gardeñes for enlightening discussions, and Carlos Rascón for critical reading of the manuscript.  #@NEW_LINE#@#  We acknowledge funding from the Spanish Ministry of Economy and Competitiveness through Grant PHYSDEV (FIS2012-32349) and the Ramón y Cajal Program (to S.A.).  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  


