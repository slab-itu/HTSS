article id="http://dx.doi.org/10.1073/pnas.1610835114"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Quantum interpolation for high-resolution sensing  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
Nanoscale magnetic resonance imaging enabled by quantum sensors is a promising path toward the outstanding goal of determining the structure of single biomolecules at room temperature.  #@NEW_LINE#@#  We develop a technique, which we name quantum interpolation, to improve the frequency resolution of these quantum sensors far beyond limitations set by the experimental controlling apparatus.  #@NEW_LINE#@#  The method relies on quantum interference to achieve high-fidelity interpolation of the quantum dynamics between hardware-allowed time samplings, thus allowing high-resolution sensing.  #@NEW_LINE#@#  We demonstrate over two orders of magnitude resolution gains, and discuss applications of our work to high-resolution nanoscale magnetic resonance imaging.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Recent advances in engineering and control of nanoscale quantum sensors have opened new paradigms in precision metrology.  #@NEW_LINE#@#  Unfortunately, hardware restrictions often limit the sensor performance.  #@NEW_LINE#@#  In nanoscale magnetic resonance probes, for instance, finite sampling times greatly limit the achievable sensitivity and spectral resolution.  #@NEW_LINE#@#  Here we introduce a technique for coherent quantum interpolation that can overcome these problems.  #@NEW_LINE#@#  Using a quantum sensor associated with the nitrogen vacancy center in diamond, we experimentally demonstrate that quantum interpolation can achieve spectroscopy of classical magnetic fields and individual quantum spins with orders of magnitude finer frequency resolution than conventionally possible.  #@NEW_LINE#@#  Not only is quantum interpolation an enabling technique to extract structural and chemical information from single biomolecules, but it can be directly applied to other quantum systems for superresolution quantum spectroscopy.  #@NEW_LINE#@#  

Quantum Interpolation scheme.  #@NEW_LINE#@#  (A) Conceptual picture of quantum interpolation.  #@NEW_LINE#@#  The set of useful sensing propagators (UN(k+p/N), blue line) constitute a one-dimensional manifold in the 4D operator space, shown here in the dominant 3D subspace (see SI Appendix, Quantum Interpolation: Theory & Practice, Geometric Representation).  #@NEW_LINE#@#  Conventionally, the unitary evolution of a quantum sensor can only be probed at discrete intervals UN(k) (black cubes), with k=k, and classical signal interpolation would miss an accurate description (dashed black line).  #@NEW_LINE#@#  Quantum interpolation faithfully approximates the evolution (UN(k+p/N), green spheres) by coherent combination of pulse sequences [Insets, CPMG (16) sequences], allowing for sampling at arbitrary small time intervals.  #@NEW_LINE#@#  (B and C) (Top) NMR signal from a single 14N spin associated with the NV quantum sensor.  #@NEW_LINE#@#  (B) Sensing with conventional sequences limited to =2 ns.  #@NEW_LINE#@#  (C) Quantum interpolation, improving the resolution to 110 ps.  #@NEW_LINE#@#  (Bottom) Quantum interpolation can reveal details of the signal (the folding and reflection of the central peak leading to the double peak), as expected from the theoretical line shape at large pulse numbers (see SI Appendix, Interferometric Spin Sensing via the NV Center).  #@NEW_LINE#@#  (D) Filter function description of quantum interpolation.  #@NEW_LINE#@#  (Top) Time domain filter function f(t) for the desired (dashed green lines) and interpolated pulse sequence (solid blue lines) for the simplest case of a half-time interpolation with total sequence time T. The deviation between these filters is the error function  (shaded regions in Middle) that needs to be minimized for an optimal interpolation construction.  #@NEW_LINE#@#  (Bottom) Frequency domain representation of both filter functions and the Fourier Transform (FT) of their difference.  #@NEW_LINE#@#  
Quantum_Interpolation  #@NEW_LINE#@#  
Principles  #@NEW_LINE#@#  
The building blocks of the quantum interpolated dynamics are propagators U(k) describing the quantum probe evolution under a control sequence unit composed of -pulses separated by a time k=k.  #@NEW_LINE#@#  Experimentally, thus, we combine well-known control sequences such as the XY8 sequence (1618).  #@NEW_LINE#@#  As shown in Fig 1A, these operators U(k) can be thought of as a discrete subset of all of the possible propagators that one might want to access for quantum sensing.  #@NEW_LINE#@#  Combining sequences with different timings (Fig 1A, Inset), we construct a propagator U(k+p/N) that approximates the desired interpolated dynamics, U(k+p/N),UN(k+p/N)P{m=1NpU(k)n=1pU(k+1)}UN(k+p/N).  #@NEW_LINE#@#  [1]  #@NEW_LINE#@#  
Here P describes a permutation of the propagators (the pulse sequence order).  #@NEW_LINE#@#  Only by optimizing P, as explained in Optimal Construction, can we achieve high-fidelity quantum interpolation, which would be otherwise limited by errors caused by the noncommutativity of the dynamics and further amplified when considering a large number of pulses.  #@NEW_LINE#@#  
Before giving more details of the optimal construction, we demonstrate the need and advantages of quantum interpolation (Fig 1 B and C) by performing high spectral resolution magnetometry using the electronic spin of the nitrogen vacancy (NV) center in diamond (19) as a nanoscale probe (7, 10, 20).  #@NEW_LINE#@#  Using a conventional XY8-6 dynamical decoupling sequence (17, 18) to measure the 14N nuclear spin of the NV center, we obtain a low-resolution signal where the expected sinc-like dip is barely resolved (Fig 1B).  #@NEW_LINE#@#  Upon increasing the number of pulses to XY8-18, this narrow dip is completely lost.  #@NEW_LINE#@#  To enhance the signal resolution, we use the optimized interpolation sequence that completely mitigates the deleterious effects of timing resolution and reveals the folding back of the dip into a double peak due to strong interference between the NV and the 14N spin (Fig 1C and SI Appendix, Interferometric Spin Sensing via the NV Center).  #@NEW_LINE#@#  Thanks to quantum interpolation, the number of points that can now be sampled scales linearly with the number of pulses N, and the resolution still improves as 1/N.  #@NEW_LINE#@#  The sensing resolution is thus determined only by the quantum probe coherence time T2 (simultaneously extended due to dynamical decoupling) and the number of pulses that can be reliably applied.  #@NEW_LINE#@#  

Optimal_Construction  #@NEW_LINE#@#  
The ordering of the different pulse sequence blocks is a crucial step in achieving an interpolated propagator that remains the most faithful approximation of UN(k+p/N), even at large N. For instance, a naive construction, P=1 in Eq.  #@NEW_LINE#@#  1, would lead to fast error accumulation and the failure of quantum interpolation.  #@NEW_LINE#@#  We tackle this problem by minimizing the deviation (t)=|fU(t)fU(t)| of the filter function in the time domain (shaded regions in Fig 1D) over the whole evolution.  #@NEW_LINE#@#  This procedure yields the optimal control sequence for any desired propagator, because we find that it also minimizes both the filter function error and the infidelity of the interpolated propagator, UN(k+p/N), with the ideal one, UN(k+p/N).  #@NEW_LINE#@#  Intuitively, the optimal construction compensates the error at each decoupling sequence block, to achieve a constant error that does not depend on the number N of pulses and scales as , allowing access to a large number of interpolated points.  #@NEW_LINE#@#  We show analytically and numerically that the errors for any interpolated propagator are approximately equal, and bounded by the error of U2(k+1/2)=U2(k+1/2)+O(2) (see SI Appendix, Optimal Quantum Interpolation Construction).  #@NEW_LINE#@#  


Experimental_Realization  #@NEW_LINE#@#  
Sensing_Classical_Fields  #@NEW_LINE#@#  
To demonstrate the power of quantum interpolation, we perform high-resolution magnetometry of a classical single-tone AC magnetic field at the frequency fAC=2.5 MHz.  #@NEW_LINE#@#  By applying optimally ordered quantum interpolated sequences (Fig 2A), we detect the spurious harmonic (21) of frequency 2fAC.  #@NEW_LINE#@#  As the number of -pulses is increased, the filter function associated with the equivalent XY-N sequences, and, accordingly, the measured signal, becomes narrower.  #@NEW_LINE#@#  The signal linewidths are not affected by the finite time resolution, as highlighted in Fig 2C.  #@NEW_LINE#@#  Without quantum interpolation, we reach our experimental resolution limit after applying a sequence of only 64 -pulses (XY8-8 sequence; Fig 1 B and C).  #@NEW_LINE#@#  Quantum interpolation enables AC magnetometry far beyond this limit: We obtain an improvement by a factor 112 in timing resolution, corresponding to a sampling time of 8.9 ps.  #@NEW_LINE#@#  
The advantage of quantum interpolation over conventional dynamical decoupling sequences is manifest when the goal is to resolve signals with similar frequencies.  #@NEW_LINE#@#  Fig 2B shows that our quantum sensor is able to easily detect a classic dual-tone perturbation, resolving fields that are separated by f=6.2 kHz, far below the limit set by our native 1-ns hardware time resolution.  #@NEW_LINE#@#  
A useful figure of merit to characterize the resolution enhancement of quantum interpolation, in analogy to band-pass filters, is the Q value of the sensing peak, Q=f/f.  #@NEW_LINE#@#  The Q value for conventional decoupling pulse sequences is set by the finite time resolution, Q=1/(2f).  #@NEW_LINE#@#  Quantum interpolation lifts this constraint, allowing Q2N/, limited only by the coherence time T2, NmaxT2/(2), and pulse errors.  #@NEW_LINE#@#  Our experiments illustrate that the effective sensing Q can be linearly boosted with the pulse number to over 1,000 (Fig 2D).  #@NEW_LINE#@#  Given typical NV coherence time (1 ms), -pulse length (50 ns), and timing resolution (1 ns), an impressive increase of about 104 over the hardware limits is achievable.  #@NEW_LINE#@#  Quantum interpolation can also enhance alternative high-resolution sensing techniques like correlation spectroscopy (22), and HartmannHahn sensing (23, 24) (see also SI Appendix, Comparison with Other High-Resolution Sensing Techniques for a detailed comparison with these methods).  #@NEW_LINE#@#  

Sensing_Quantum_Systems  #@NEW_LINE#@#  
Even more remarkably, the coherent construction of quantum interpolation ensures that one can measure not only classical signals, but also quantum systems [e.g., coupled spins (25)] with high spectral resolution.  #@NEW_LINE#@#  This result is nontrivial, because it implies that we are not only modulating the quantum sensor but also effectively engineering an interpolated Hamiltonian for the probed quantum system (26).  #@NEW_LINE#@#  Specifically, we consider a quantum probe coupled to the quantum system of interest via an interaction H=|00|H0+|11|H1.  #@NEW_LINE#@#  Here H0,1 is the target systems Hamiltonian (of dimension D), which depends on which eigenstate |0, |1 the probe is in.  #@NEW_LINE#@#  Then, the propagator under a -pulse train (with timings as in the XY8 sequence; Fig 1A) is given by UN()=|00|U0N()+|11|U1N(), withU0,1N()=(eiH0,1eiH1,02eiH0,1)N.[2]  #@NEW_LINE#@#  
Sensing of the target quantum system is achieved via interference between the two evolution paths given by U0,1N(), which results in the quantum probe signal S=[1+Tr(U0NU1N)/D]/2 (27, 28).  #@NEW_LINE#@#  The interference is enhanced by increasing the number of pulses N, and by a careful choice of the time , making it susceptible once again to finite timing resolution.  #@NEW_LINE#@#  Quantum interpolation can overcome this limitation, engineering any propagator U0,1N(k+p/N)U0,1N(k+p/N) by suitably combining U0,1Np(k) and U0,1p(k+1).  #@NEW_LINE#@#  It is somewhat surprising that this construction would work: When considering a large number of pulses, one would expect that the noncommutativity of the propagators and the nonconvergence of the perturbative BakerCampbellHausdorff expansion would amplify the discrepancy between ideal and interpolated propagator.  #@NEW_LINE#@#  Fortunately, the construction developed for classical fields still keeps the error small (as we show in SI Appendix, Quantum Interpolation: Theory & Practice) because higher-order terms cancel out in the interference between the propagators U0,1.  #@NEW_LINE#@#  
Consider, for example, the coupling of a quantum probe (the NV center) to two-level systems (nuclear spins 1/2).  #@NEW_LINE#@#  NV centers implanted a few nanometers below the diamond surface have recently emerged as the prime technology toward the long-standing goal of obtaining high spatial resolution structure of single molecules in their natural environment, by performing nanoscale NMR spectroscopy (10, 17, 18, 29, 30).  #@NEW_LINE#@#  The outstanding key challenge is resolving the spectral features (and hence positions) of densely packed networks of spins in such molecules.  #@NEW_LINE#@#  Frequency differences, as small as a few Hertz, arise from chemical shifts and the coupling to the NV.  #@NEW_LINE#@#  The Hamiltonian of the jth spin in the molecule is given by H0(j)=LIzj;H1(j)=LIzj+Az(j)Ij, where L is the Larmor frequency of the spins, and Az(j) are the components of the coupling to the NV center.  #@NEW_LINE#@#  Then, the U0,1 propagators are composed of nuclear spin rotations conditioned on the NV state.  #@NEW_LINE#@#  For weakly coupled spins, the maximum interference signal arises at =/(2L+Azz(j)), when the propagators correspond to rotations around two nonparallel axes separated by an angle =arctan[Azx(j)/(L+Azz(j)/2)].  #@NEW_LINE#@#  The angle between the nuclear spin rotation axes in the two NV manifolds is amplified with every subsequent application of -pulse, giving rise to a signal contrast that grows with N2.  #@NEW_LINE#@#  The destructive interference is also amplified away from the sensing peak (27, 28), leading to a sinc linewidth that falls as 1/(4N), similar to the results obtained using the semiclassical filter picture (see SI Appendix, Interferometric Spin Sensing via the NV Center).  #@NEW_LINE#@#  
To experimentally demonstrate the high-precision sensing reached by quantum interpolation, we measure the 14N nuclear spin via its coupling to the NV center electronic spin.  #@NEW_LINE#@#  Even if the 14N is strongly coupled to the NV (Azz=2.16 MHz), it usually does not give rise to an interferometric signal because of its transverse coupling Azx=0.  #@NEW_LINE#@#  However, a small perpendicular field B=0.62 G generates an effective transverse coupling eBAxx/(0eBz), with Axx=2.62 MHz (31) and e=2.8 MHz/G as the NV gyromagnetic ratio.  #@NEW_LINE#@#  This effect becomes sizable at a longitudinal magnetic field Bz=955.7 G that almost compensates the NV zero-field splitting 0=2.87 GHz.  #@NEW_LINE#@#  The 14N nuclear spin frequency is largely set by its quadrupolar interaction P=4.95 MHz, a high frequency beyond our timing resolution (Fig 1B).  #@NEW_LINE#@#  We used quantum interpolation to supersample the signal at 48 ps (a 41-fold resolution gain), revealing precise features of the spectral lineshape (Fig 3), including the expected slight asymmetry in sidelobes (SI Appendix, Interferometric Spin Sensing via the NV Center).  #@NEW_LINE#@#  Detecting this distinct spectral feature confirms that quantum interpolation can, indeed, achieve a faithful measurement of the quantum signal, as we find an excellent match of the experimental data with the theoretical model, with the error being less than 3% for most interpolated points.  #@NEW_LINE#@#  The ability to probe the exact spectral lineshape provides far more information than just the signal peaks, especially when there could be overlapping peaks or environment-broadened linewidths.  #@NEW_LINE#@#  


Conclusion_and_Outlook  #@NEW_LINE#@#  
These results have immediate and far-reaching consequences for nanoscale NV NMR (9, 10, 32), where our technique can map spin arrangements of a nearby single protein with a spatial resolution that dramatically improves with the number of pulses.  #@NEW_LINE#@#  The Q value provides an insightful way to quantify the resolution gains for these applications.  #@NEW_LINE#@#  With a Q104 that is currently achievable, 13C chemical shifts of aldehyde and aromatic groups can now be measured (33).  #@NEW_LINE#@#  Beyond sensing nuclear spins, we envision quantum interpolation to have important applications in condensed matter, to sense high-frequency (hence high Q) signals (34), such as those arising from the excitation of spin-wave modes in magnetic materials like yittrium iron garnett (35).  #@NEW_LINE#@#  
In conclusion, we have developed a quantum interpolation technique that achieves substantial gains in quantum sensing resolution.  #@NEW_LINE#@#  We demonstrated its advantages by performing high-frequency-resolution magnetometry of both classical fields and single spins using NV centers in diamond.  #@NEW_LINE#@#  The technique allows pushing spectral resolution limits to fully exploit the long coherence times of quantum probes under decoupling pulses.  #@NEW_LINE#@#  Quantum interpolation could also enhance the performance of other NV-based sensing technique.  #@NEW_LINE#@#  We experimentally demonstrated resolution gains of 112, and Q-value gains of over 1,000, although the ultimate limits of the technique can be at least an order of magnitude larger.  #@NEW_LINE#@#  Quantum interpolation thus turns quantum sensors into high-resolution and high-Q spectrum analyzers of classical and quantum fields.  #@NEW_LINE#@#  We expect quantum interpolation to be an enabling technique for nanoscale single-molecule spectroscopy at high magnetic fields (36), allowing the discrimination of chemical shifts and angstrom-resolution single-molecule structure.  #@NEW_LINE#@#  

Acknowledgments  #@NEW_LINE#@#  
We thank E. Bauch, F. Casola, D. Glenn, F. Jelezko, S. Lloyd, M. Lukin, E. Rosenfeld, and R. Walsworth for stimulating discussions and careful reading of the manuscript.  #@NEW_LINE#@#  This work was supported, in part, by the US Army Research Office through Grants W911NF-11-1-0400 and W911NF-15-1-0548 and by the NSF Grant PHY0551153 (Center for Ultracold Atoms).  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  


