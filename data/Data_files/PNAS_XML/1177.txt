article id="http://dx.doi.org/10.1073/pnas.1713314115"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Impact of the tree prior on estimating clock rates during epidemic outbreaks  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
Genetic sequencing data of pathogens allow one to quantify the evolutionary rate together with epidemiological dynamics using Bayesian phylodynamic methods.  #@NEW_LINE#@#  Such tools are particularly useful for obtaining a timely understanding of newly emerging epidemic outbreaks.  #@NEW_LINE#@#  During the West African Ebola virus disease epidemic, an unusually high evolutionary rate was initially estimated, promoting discussions regarding the potential danger of the strain quickly evolving into an even more dangerous virus.  #@NEW_LINE#@#  We show here that such high evolutionary rates are not necessarily real but can stem from methodological biases in the analyses.  #@NEW_LINE#@#  While most analyses of epidemic outbreak data are performed such that these biases may be present, we suggest a solution to overcome these biases in the future.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Bayesian phylogenetics aims at estimating phylogenetic trees together with evolutionary and population dynamic parameters based on genetic sequences.  #@NEW_LINE#@#  It has been noted that the clock rate, one of the evolutionary parameters, decreases with an increase in the sampling period of sequences.  #@NEW_LINE#@#  In particular, clock rates of epidemic outbreaks are often estimated to be higher compared with the long-term clock rate.  #@NEW_LINE#@#  Purifying selection has been suggested as a biological factor that contributes to this phenomenon, since it purges slightly deleterious mutations from a population over time.  #@NEW_LINE#@#  However, other factors such as methodological biases may also play a role and make a biological interpretation of results difficult.  #@NEW_LINE#@#  In this paper, we identify methodological biases originating from the choice of tree prior, that is, the model specifying epidemiological dynamics.  #@NEW_LINE#@#  With a simulation study we demonstrate that a misspecification of the tree prior can upwardly bias the inferred clock rate and that the interplay of the different models involved in the inference can be complex and nonintuitive.  #@NEW_LINE#@#  We also show that the choice of tree prior can influence the inference of clock rate on real-world Ebola virus (EBOV) datasets.  #@NEW_LINE#@#  While commonly used tree priors result in very high clock-rate estimates for sequences from the initial phase of the epidemic in Sierra Leone, tree priors allowing for population structure lead to estimates agreeing with the long-term rate for EBOV.  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
Simulation_Study  #@NEW_LINE#@#  
The empirical tree used to simulate sequences for the simulation study is shown in Fig 1A.  #@NEW_LINE#@#  The tree is obviously less balanced than a typical constant-size coalescent tree (compare with SI Appendix, Fig S2).  #@NEW_LINE#@#  The median estimate and 95% highest posterior density (HPD) intervals for clock rate, tree height, tree length, and total divergence for each replicate of the simulation study under a constant size coalescent are shown in Fig 1B and SI Appendix, Fig S3A.  #@NEW_LINE#@#  The dashed lines in each panel indicate the true values.  #@NEW_LINE#@#  The HPD intervals for tree height and total divergence include the true value in all but 1 replicate each, for all sequence lengths, and become smaller with increasing sequence length.  #@NEW_LINE#@#  The estimates for clock rate and tree length include the true value in none of the 30 replicates for tree length up to sequence length 1,000.  #@NEW_LINE#@#  The estimates are biased upward and downward, respectively.  #@NEW_LINE#@#  The bias and the variance decrease as the sequence length increases (SI Appendix, Fig S3D), but the true value is covered only by the HPD intervals of 7 and 8 of 10 replicates for sequence length 15,000, for tree length and clock rate, respectively.  #@NEW_LINE#@#  Without any sequence data (i.e., sequence length of 0), the median inferred value for the clock rate is unbiased and all HPD intervals contain the true value, as expected, since the prior is centered around the true rate (SI Appendix, Fig S4A).  #@NEW_LINE#@#  
Fig 1C shows the posterior distribution of tree topologies, for the first replicate (of 10), projected onto 2D Euclidean space (29), after down-sampling to 101 trees per sequence length and discarding 10% as burn-in.  #@NEW_LINE#@#  The points representing topologies obtained with sequence data form a cluster around the true topology (marked with a red cross), while topologies originating from the analysis without sequence data are clearly separated.  #@NEW_LINE#@#  
To illustrate that the above biases result from the empirical Guinea tree being very different from a typical coalescent tree (i.e., the tree prior) we repeated the simulation study on 10 trees simulated under the constant-size coalescent.  #@NEW_LINE#@#  As expected, about 95% of the HPDs contain the true values.  #@NEW_LINE#@#  Furthermore, the observed biases are very small and parameter estimates become unbiased with very small HPD intervals for sequences of length 500 or longer (SI Appendix, Figs.  #@NEW_LINE#@#  S5 and S6).  #@NEW_LINE#@#  
We assessed the robustness of our findings by repeating the simulation study with different clock rates (SI Appendix, Figs.  #@NEW_LINE#@#  S3 and S4) and with a less informative clock rate prior (SI Appendix, Figs.  #@NEW_LINE#@#  S7 and S8).  #@NEW_LINE#@#  We further changed the constant population-size assumption of the coalescent tree to exponential growth (SI Appendix, Fig S9) and also repeated the experiment with a birthdeath tree prior (SI Appendix, Fig S10).  #@NEW_LINE#@#  Finally, it has been noted that not exploring the correct topological space can result in biases to branch-length estimates (30).  #@NEW_LINE#@#  To test whether this hypothesis is responsible for the observed biases we fixed the tree topology (but not the branch lengths) to that of the empirical tree (SI Appendix, Fig S11).  #@NEW_LINE#@#  Although the magnitudes of the biases change between analyses, the same pattern remains visible in all of our sensitivity analyses.  #@NEW_LINE#@#  
SI Appendix, Fig S12 shows an analysis of the simulated alignments in a maximum-likelihood framework using the tools RAxML (31) and least-squares dating (32).  #@NEW_LINE#@#  In this case the clock rate is slightly underestimated for sequences of length 100, whereas it was severely overestimated in a Bayesian framework.  #@NEW_LINE#@#  For sequences of length 500 and more, the true value is within 1 SD of the inferred mean.  #@NEW_LINE#@#  

Empirical_Ebola_Study  #@NEW_LINE#@#  
Fig 2 shows the results for the two EBOV datasets.  #@NEW_LINE#@#  For the Guinea dataset the birthdeath model leads to the highest clock rate with a median of roughly 1.3×103 substitutions per site per year.  #@NEW_LINE#@#  Under all of the other models the inferred rate is slightly below 1.2×103 substitutions per site per year.  #@NEW_LINE#@#  The HPD intervals are largely overlapping.  #@NEW_LINE#@#  These estimates are in good agreement with the long-term rate estimated over the course of the epidemic [1.2×103 substitutions per site per year (10)].  #@NEW_LINE#@#  For the tree height the large HPD intervals for the constant coalescent stand out.  #@NEW_LINE#@#  This model also has the highest median of around 1.1 years, while the lowest estimate of slightly below 1 year is obtained under the birthdeath model.  #@NEW_LINE#@#  The inferred tree length shows the opposite trend to the clock rate, with the birthdeath model leading to a median estimate of 17 years whereas the other models result in an estimate between 18 and 19 years.  #@NEW_LINE#@#  For total divergence there are no noticeable differences between any of the models.  #@NEW_LINE#@#  
For Sierra Leone all of the unstructured models lead to a median estimate of the clock rate of about 2×103 substitutions per site per year.  #@NEW_LINE#@#  In contrast, the structured coalescent model results in a median rate of 1.3×103 substitutions per site per year which agrees with the long-term rate estimated over the course of the epidemic [1.2×103 substitutions per site per year (10)].  #@NEW_LINE#@#  The opposite trend is observed for the tree length.  #@NEW_LINE#@#  While the unstructured models result in estimates of around 1.5 years, the structured coalescent leads to a median value of 2.3 years.  #@NEW_LINE#@#  Similarly, for the tree height, the medians of the unstructured models are around 0.3 years but the birthdeath models result in narrower HPD intervals than the coalescent models.  #@NEW_LINE#@#  Using the structured coalescent, where we assigned demes based on genetic similarity (see SI Appendix, Supporting Methods, for details), we obtain a much larger HPD interval around a median of 0.46 years.  #@NEW_LINE#@#  Again, we find no noticeable difference for total divergence.  #@NEW_LINE#@#  
SI Appendix, Fig S13 shows the results of the model comparison.  #@NEW_LINE#@#  For both datasets the structured coalescent is clearly the best-fitting model among those examined.  #@NEW_LINE#@#  We assessed the robustness of this finding by running path sampling with a varying number of steps (SI Appendix, Table S2).  #@NEW_LINE#@#  While the structured coalescent always presents the best fit, the ranking of the other models varies.  #@NEW_LINE#@#  
The assignment to demes in the structured model analysis is not necessarily clear a priori and it could be argued that our results are applicable only to the particular assignment we used.  #@NEW_LINE#@#  To investigate this dependence we assigned sequences in the Sierra Leone dataset randomly to demes.  #@NEW_LINE#@#  Random deme assignment does not appear to affect estimates of the clock rate, tree height, tree length, or total divergence (SI Appendix, Fig S14).  #@NEW_LINE#@#  However, we advise caution when interpreting these results, as the analyses mix poorly for the migration model-specific parameters, although all other parameters have effective sample sizes above 200.  #@NEW_LINE#@#  


Discussion_and_Conclusion  #@NEW_LINE#@#  
Most common tree priors are relatively simple and do not take into account the interplay between the phylogeny, population structure, selection, and other factors that affect the population dynamics.  #@NEW_LINE#@#  Thus, empirical trees are often less balanced, with different distributions of branching times compared with trees under the prior.  #@NEW_LINE#@#  The simulation study shows that when simulating along a tree that is based on empirical data, it can be surprisingly difficult to recover the true clock rate, even when very simple clock and substitution models are used.  #@NEW_LINE#@#  The biases are observed despite the fact that the correct substitution model and an unbiased prior on the clock rate are used and persist even when conditioning on the true topology and allowing only branch lengths to vary.  #@NEW_LINE#@#  The problem arises from a misspecification of the tree prior (Fig 1 and SI Appendix, Fig S4) which will be difficult to detect in empirical datasets where the truth is unknown.  #@NEW_LINE#@#  Thus, the biases may be overcome by using more appropriate tree priors; however, the biases we observe will not vanish when using more complex clock-rate priors [such as the continuous-time Markov chain reference prior (33)], as our simulated data do not contain rate variation.  #@NEW_LINE#@#  Instead, it would be more difficult to disentangle biases due to the tree prior from those due to the clock-rate prior when using more complex clock-rate priors.  #@NEW_LINE#@#  The tree prior implies an indirect prior for the tree length, which may cause a bias in the clock-rate estimate.  #@NEW_LINE#@#  Biases on the clock rate disappear when sampling from the prior without sequence data (SI Appendix, Fig S4).  #@NEW_LINE#@#  
These results may initially seem counterintuitive.  #@NEW_LINE#@#  To explain them, we briefly review the Bayesian phylogenetic framework.  #@NEW_LINE#@#  Let the clock rate and substitution rate be denoted by , the tree by T, the parameters of the tree prior by , and the data (sequence alignment) by D. In a simple form, the posterior is given by P(,,T|D)P(D|,T)f(T|)f()f(), if we assume that the clock rate and tree priors are independent of each other (f(,)=f()f()), as is the case in all of the models we analyzed.  #@NEW_LINE#@#  Without any sequence data, we have P(D|,T)=1 and therefore, when sampling from the posterior, T and  can change independently; thus we do not observe biases in our analyses without sequence data.  #@NEW_LINE#@#  Adding only a small amount of sequence data can make a large difference in the inference as it links the tree and the clock rate via P(D|,T).  #@NEW_LINE#@#  If the tree prior causes the tree length to be underestimated, the model will compensate for this by increasing the clock rate to explain the overall diversity in the data; this is seen in our simulation analyses with sequences.  #@NEW_LINE#@#  
The prior distribution on the tree space, f(T|), is a distribution over topologies and branch lengths.  #@NEW_LINE#@#  This indirectly gives rise to the prior on the tree length (depicted in SI Appendix, Fig S4).  #@NEW_LINE#@#  Upon adding sequence data the topologies that before had a high prior support become very unlikely (Fig 1C) and under this constrained topological space, the indirect prior on the tree length is altered as well (see SI Appendix, Fig S2 for an illustration).  #@NEW_LINE#@#  The constrained topological space causes a downward bias in tree length for sequence lengths 100, 500, and 1,000 as seen in Fig 1B, which in turn causes the clock rate to be overestimated.  #@NEW_LINE#@#  Our simulation study indicates that in data-limited scenarios, none of the commonly used unstructured tree priors provide unbiased estimates for data simulated along an empirical tree (Fig 1B and SI Appendix, Figs.  #@NEW_LINE#@#  S9 and S10).  #@NEW_LINE#@#  Despite very different priors for the dynamics in the underlying unstructured population, too much weight is given to certain trees, causing a bias in the tree length.  #@NEW_LINE#@#  The dependence that even a small amount of sequence data introduces between the tree prior and the clock-rate prior, along with the negative correlation between the tree length and the clock rate, in turn results in biases to the clock rate.  #@NEW_LINE#@#  Negative correlations among parameters that are independent in the priors can be indicative of a model that is overparameterized (34).  #@NEW_LINE#@#  However, this is not necessarily the case, and the fact that we recover unbiased estimates as the sequence length is increased shows that this is unlikely to be a factor here.  #@NEW_LINE#@#  Since trees sampled from real epidemics are likely to be highly atypical under the currently available tree priors, the chosen tree prior may result in biased estimates, especially during the early phase of an epidemic.  #@NEW_LINE#@#  
The influence of sequence data on the topological space and on the tree length can be illustrated with a toy example (Fig 3).  #@NEW_LINE#@#  Consider a tree with two contemporary samples and one past sample.  #@NEW_LINE#@#  For a small population size a coalescent tree prior would give high probability to the tree topology in which the two contemporary tips form a cherry.  #@NEW_LINE#@#  When sequence data are added, it may become obvious, though, that the cherry should be formed between one of the contemporary tips and the sample from the past.  #@NEW_LINE#@#  This effectively puts a lower bound on the tree length.  #@NEW_LINE#@#  We point out that the tree prior restricts not only the topological space but also the branch lengths and thus restricts the tree length.  #@NEW_LINE#@#  This restriction also leads to biases, as observed when constraining our simulation analysis to the true tree topology, but allowing branch lengths to vary.  #@NEW_LINE#@#  
The usual approach to assess whether the data are informative on a parameter of interest (e.g., the clock rate) is to look for a departure of the posterior distribution from the prior.  #@NEW_LINE#@#  However, without enough data to overcome methodological biases from model misspecification, simply showing a departure from the prior is not sufficient.  #@NEW_LINE#@#  In our simulation study the clock rate and tree length both initially show very clear departures from their priors for shorter sequence lengths.  #@NEW_LINE#@#  However, it is only once more sequencing data are added that estimates become unbiased.  #@NEW_LINE#@#  Thus, in the absence of independent estimates, departures from the prior should not be taken as evidence that the data are informative enough to produce unbiased estimates.  #@NEW_LINE#@#  
We note that the tree height can be estimated much more reliably than the tree length (Fig 1B).  #@NEW_LINE#@#  Like the total divergence, it is a global parameter and a small amount of data are already informative about it.  #@NEW_LINE#@#  As there are many trees of the same height but with different lengths (e.g., Fig 3), inferring the length correctly is a much harder problem and thus more susceptible to biases from the tree prior.  #@NEW_LINE#@#  
We showed that a maximum-likelihood analysis which does not use a tree prior did not suffer from an upward bias in clock-rate estimates, offering a potential way to check for clock-rate biases in Bayesian analyses.  #@NEW_LINE#@#  In contrast, maximum-likelihood estimates were underestimated for the shortest sequences (although much shorter sequences were needed to obtain unbiased estimates than within a Bayesian framework).  #@NEW_LINE#@#  These results are reminiscent of ref.  #@NEW_LINE#@#  35, where the authors show that branch lengths tend to be underestimated in a Bayesian framework, whereas maximum-likelihood estimates tend to be inflated.  #@NEW_LINE#@#  
The analysis of the two empirical datasets also confirms that the tree prior can influence the inferred clock rate.  #@NEW_LINE#@#  For Sierra Leone, where 81 sequences were sampled over 3 months, we see that the choice of tree prior can heavily influence the estimated clock rate.  #@NEW_LINE#@#  If a structured model had been used in the original analysis (9), then the difference between the short- and long-term estimates would have disappeared.  #@NEW_LINE#@#  For the Guinea dataset (236 sequences spanning 10 months) we get similar clock-rate estimates across tree priors.  #@NEW_LINE#@#  In fact, the median clock rates of the Sierra Leone dataset under the structured coalescent and the Guinea dataset under any tree prior are estimated to be in the range 1.151.3×103, which is in good agreement with the long-term rate of 1.2×103 substitutions per site per year estimated over the course of the epidemic (10).  #@NEW_LINE#@#  
We did not use the structured coalescent in its usual form, as a model of migrations between discrete locations.  #@NEW_LINE#@#  Instead, we assigned sequences to different demes in the structured model based on genetic distance between sequences, as well as in a random manner.  #@NEW_LINE#@#  In this sense, the structured model allows distinct lineages to coalesce at different rates, introducing a greater degree of flexibility in the tree prior.  #@NEW_LINE#@#  Since clock-rate estimates are not affected by the particular chosen deme assignment, we suggest that the reduction in biases does not stem from the introduction of realistic population structure, but because the structured model assigns a higher probability to unbalanced trees with higher tree lengths than any of the unstructured models.  #@NEW_LINE#@#  It may be fruitful to apply a structured model that does not rely on classified tips, thereby avoiding arbitrary deme assignments (e.g., refs.  #@NEW_LINE#@#  36 and 37).  #@NEW_LINE#@#  Analogous to our findings regarding clock rates in epidemiological studies, simulation studies in the context of aDNA have shown that complex population structure in the past can lead to biased estimates of clock rate if the data are analyzed under a model that is too simple (38).  #@NEW_LINE#@#  
Model comparison suggests that structured models are strongly preferred, indicating that the data appear to demand a model that allows for more variability in the tree distribution than provided by unstructured models.  #@NEW_LINE#@#  However, correct estimation of the marginal likelihood is a difficult and computationally demanding task and the results should therefore be taken with a grain of salt.  #@NEW_LINE#@#  Furthermore, marginal likelihoods and Bayes factors say nothing about the absolute goodness of fit (39).  #@NEW_LINE#@#  This can be assessed only with even more computationally demanding methods like posterior predictive simulation (40).  #@NEW_LINE#@#  Regardless of its shortcomings, our results show the importance of carefully choosing a tree prior and that this choice can strongly influence the clock-rate estimates.  #@NEW_LINE#@#  
In this paper we highlight some conceptual problems in the inference of the clock rate when using Bayesian phylogenetic tools.  #@NEW_LINE#@#  The interaction between tree prior and clock-rate estimation can be complex and nonintuitive.  #@NEW_LINE#@#  We used a simulation study to demonstrate that deviation of the posterior clock-rate distribution from the prior does not necessarily imply a signal in the data and can be a mere artifact of the chosen tree prior.  #@NEW_LINE#@#  The study indicated that even under the simplest substitution and clock models it may not be possible to recover the true parameter values if the tree prior is a poor description of the evolutionary process.  #@NEW_LINE#@#  The reanalysis of an Ebola dataset from Sierra Leone showed that the high mutation rate that was reported originally could be due to biases introduced by model misspecification and that the inferred rate under a more flexible tree prior comes very close to the long-term estimate.  #@NEW_LINE#@#  Overall this emphasizes the need to choose the tree prior carefullyeven if the parameter of interest is the clock rateand demands further investigations into how overall model fit in Bayesian phylogenetic analyses can be assessed.  #@NEW_LINE#@#  

Materials_and_Methods  #@NEW_LINE#@#  
Simulation_Study  #@NEW_LINE#@#  
We simulated sequence evolution along a fixed empirical tree using simple clock and substitution models and subsequently analyzed the resulting alignment using the same clock and substitution models under a simple unstructured coalescent tree prior.  #@NEW_LINE#@#  The empirical tree was obtained from an analysis of the coding regions of 236 Ebola virus genomes sampled from patients in Guinea over a period of 10 months (previously described in refs.  #@NEW_LINE#@#  27 and 28).  #@NEW_LINE#@#  Details of the analysis are described in SI Appendix, Supporting Methods.  #@NEW_LINE#@#  
We simulated sequences of length 100 base pairs (bp), 500 bp, 1,000 bp, and 15,000 bp using a JukesCantor (JC69) (41) substitution model and a fixed clock rate of 0.1 substitutions per site per year.  #@NEW_LINE#@#  For each sequence length we performed 10 independent simulations.  #@NEW_LINE#@#  The parameters in the setup of this simulation are not meant to be biologically relevant but rather an illustrative example using the simplest possible substitution model.  #@NEW_LINE#@#  The simulated alignments were subsequently analyzed in Beast2 (2), using the same model of molecular evolution used to simulate the sequences (i.e., strict clock and JC69 model).  #@NEW_LINE#@#  We chose a normal distribution with standard deviation of 0.02 around the true value of 0.1 as a prior for the clock rate and a lognormal distribution with M=0 and S=0.5 for the population size of a constant-size coalescent tree prior.  #@NEW_LINE#@#  In sensitivity analyses we varied the clock rate used in simulations, the precision of the clock-rate prior, and the tree prior (using different coalescent and birthdeath tree priors).  #@NEW_LINE#@#  Model specifics and further details can be found in SI Appendix, Supporting Methods.  #@NEW_LINE#@#  

Empirical_EBOV_Study  #@NEW_LINE#@#  
We investigated the dependence of clock-rate inference on the chosen tree prior on two EBOV datasets.  #@NEW_LINE#@#  The first dataset is the one used to generate the tree for the simulation study and we refer to it as the Guinea dataset.  #@NEW_LINE#@#  The second dataset contains whole-genome data of 81 sequences sampled over 3 months, with all but 3 earlier sequences from Guinea sampled during the first month of the epidemic in Sierra Leone (9).  #@NEW_LINE#@#  Estimates of the clock rate from this dataset are about twice as high during the outbreak as between outbreaks, albeit with wide confidence intervals (9).  #@NEW_LINE#@#  We refer to this dataset as the Sierra Leone dataset.  #@NEW_LINE#@#  
For the analyses in Beast2 we used a strict clock and the Hasegawa, Kishino and Yano (HKY) substitution model (42) without site heterogeneity for all models.  #@NEW_LINE#@#  We used six different tree priors: constant-rate birthdeath, birthdeath skyline (26), constant population-size coalescent, exponential growth coalescent, coalescent skyline (25), and structured coalescent (43).  #@NEW_LINE#@#  We subsequently used path sampling (44) to assess the relative goodness of fit of the different models.  #@NEW_LINE#@#  Model specifics are listed in SI Appendix, Supporting Methods.  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
T.S.  #@NEW_LINE#@#  is supported in part by the European Research Council under the Seventh Framework Program of the European Commission (New phylogenetic methods for inferring complex population dynamics: Grant 335529).  #@NEW_LINE#@#  L.d.P.  #@NEW_LINE#@#  is supported by the European Research Council under the Seventh Framework Program of the European Commission (Pathogen Phylodynamics: Grant 614725).  #@NEW_LINE#@#  T.S.  #@NEW_LINE#@#  was funded in part by an SNF SystemsX grant (Systems Biology of Drug-resistant Tuberculosis in the Field).  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  

This open access article is distributed under Creative Commons Attribution-NonCommercial-NoDerivatives License 4.0 (CC BY-NC-ND).  #@NEW_LINE#@#  

