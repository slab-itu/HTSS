article id="http://dx.doi.org/10.1073/pnas.1619152114"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Elucidating reaction mechanisms on quantum computers  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
Our work addresses the question of compelling killer applications for quantum computers.  #@NEW_LINE#@#  Although quantum chemistry is a strong candidate, the lack of details of how quantum computers can be used for specific applications makes it difficult to assess whether they will be able to deliver on the promises.  #@NEW_LINE#@#  Here, we show how quantum computers can be used to elucidate the reaction mechanism for biological nitrogen fixation in nitrogenase, by augmenting classical calculation of reaction mechanisms with reliable estimates for relative and activation energies that are beyond the reach of traditional methods.  #@NEW_LINE#@#  We also show that, taking into account overheads of quantum error correction and gate synthesis, a modular architecture for parallel quantum computers can perform such calculations with components of reasonable complexity.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
With rapid recent advances in quantum technology, we are close to the threshold of quantum devices whose computational powers can exceed those of classical supercomputers.  #@NEW_LINE#@#  Here, we show that a quantum computer can be used to elucidate reaction mechanisms in complex chemical systems, using the open problem of biological nitrogen fixation in nitrogenase as an example.  #@NEW_LINE#@#  We discuss how quantum computers can augment classical computer simulations used to probe these reaction mechanisms, to significantly increase their accuracy and enable hitherto intractable simulations.  #@NEW_LINE#@#  Our resource estimates show that, even when taking into account the substantial overhead of quantum error correction, and the need to compile into discrete gate sets, the necessary computations can be performed in reasonable time on small quantum computers.  #@NEW_LINE#@#  Our results demonstrate that quantum computers will be able to tackle important problems in chemistry without requiring exorbitant resources.  #@NEW_LINE#@#  

(Left) X-ray crystal structure 4WES (21) of the nitrogenase MoFe protein from Clostridium pasteurianum taken from the protein database (the backbone is colored in green, and hydrogen atoms are not shown), (Middle) the close protein environment of the FeMoco, and (Right) the structural model of FeMoco considered in this work (C, gray; O, red; H, white; S, yellow; N, blue; Fe, brown; and Mo, cyan).  #@NEW_LINE#@#  
Quantum_Chemical_Methods_for_Mechanistic_Studies  #@NEW_LINE#@#  
At the heart of any chemical process is its mechanism, the elucidation of which requires the identification of all relevant stable intermediates and transition states.  #@NEW_LINE#@#  In general, a multitude of charge and spin states need to be explicitly calculated in search of the relevant ones that make the whole chemical process viable.  #@NEW_LINE#@#  Such a mechanistic exploration can lead to thousands of elementary reaction steps (25) whose reaction energies must be reliably calculated.  #@NEW_LINE#@#  In the case of nitrogenase, numerous protonated intermediates of dinitrogen-coordinating FeMoco and subsequently reduced intermediates in different charge and spin states are feasible and must be assessed with respect to their relative energy.  #@NEW_LINE#@#  Especially, kinetic modeling poses tight limits on the accuracy of activation energies entering the argument of exponentials in rate expressions.  #@NEW_LINE#@#  
For nitrogenase, an electrostatic quantum mechanical/molecular mechanical (QM/MM) model (26) that captures the embedding of FeMoco into the protein pocket of nitrogenase can properly account for the protein environment.  #@NEW_LINE#@#  Accordingly, we consider a structural model for the active site of nitrogenase (Fig 1, Right) carrying only models of the anchoring groups of the protein, which represents a suitable QM part in such calculations.  #@NEW_LINE#@#  To study this bare model is no limitation, as it does not at all affect our feasibility analysis (because electrostatic QM/MM embedding will not change the number of orbitals considered for the wave function construction).  #@NEW_LINE#@#  We carried out (full) molecular structure optimizations with DFT methods of this FeMoco model in different charge and spin states to avoid basing our analysis on a single electronic structure.  #@NEW_LINE#@#  Although our FeMoco model is taken from the resting state, binding of a small molecule such as dinitrogen, dihydrogen, diazene, or ammonia will not decisively change the complexity of its electronic structure.  #@NEW_LINE#@#  
The BornOppenheimer approximation assigns an electronic energy to every molecular structure.  #@NEW_LINE#@#  The accurate calculation of this energy is the pivotal challenge, here considered by quantum computing.  #@NEW_LINE#@#  Characteristic molecular structures are optimized to provide local minimum structures indicating stable intermediates and first-order saddle points representing transition structures.  #@NEW_LINE#@#  The electronic energy differences for elementary steps that connect two minima through a transition structure enter expressions for rate constants by virtue of Eyrings absolute rate theory (ART).  #@NEW_LINE#@#  Although more information on the potential energy surface as well as dynamic and quantum effects may be taken into account, ART is accurate even for large molecules such as enzymes (27, 28).  #@NEW_LINE#@#  These rate constants then enter a kinetic description of all elementary steps that ultimately provide a complete picture of the chemical mechanism under consideration.  #@NEW_LINE#@#  
Exact_Diagonalization_Methods_in_Chemistry  #@NEW_LINE#@#  
If the frontier orbital region around the Fermi level of a given molecular structure is dense, as is the case in -conjugated molecules or open-shell transition metal complexes (such as FeMoco), then so-called strong static electron correlation plays a decisive role already in the ground state.  #@NEW_LINE#@#  Static electron correlations are even more pronounced for electronically excited states relevant in photophysical and photochemical processes such as light harvesting for clean energy applications.  #@NEW_LINE#@#  Such situations require multiconfigurational methods of which the complete-active-space self-consistent-field (CASSCF) approach has been established as a well-defined model that also serves as the basis for more advanced approaches (29).  #@NEW_LINE#@#  CAS-type approaches require the selection of orbitals for the CAS, usually from those around the Fermi energy, which can be automatized (3033).  #@NEW_LINE#@#  Although CAS-type methods well account for static electron correlation, the remaining dynamic correlation is decisive for quantitative results.  #@NEW_LINE#@#  A remaining major drawback of exact-diagonalization schemes therefore is to include the contribution of all neglected virtual orbitals.  #@NEW_LINE#@#  
CASSCF is traditionally implemented as an exact diagonalization method, which limits its applicability to 18 electrons in 18 (spatial) orbitals, because of the steep scaling of many-electron basis states with the number of electrons and orbitals (34).  #@NEW_LINE#@#  The polynomially scaling density matrix renormalization group (DMRG) algorithm (35) can push this limit to about 100 spatial orbitals; this, however, also comes at the cost of an iterative procedure whose convergence for strongly correlated molecules is, due to the matrix product state representation of the electronic wave function, neither easy to achieve nor guaranteed.  #@NEW_LINE#@#  

Ways_Quantum_Computers_Will_Help_Solve_These_Problems  #@NEW_LINE#@#  
Molecular structure optimizations are commonly found with standard DFT approaches.  #@NEW_LINE#@#  DFT-optimized molecular structures are, in general, reliable, even if the corresponding energies are affected by large uncontrollable errors.  #@NEW_LINE#@#  The latter problem can be solved by a quantum computer that implements a multiconfigurational wave function model to access truly large active orbital spaces.  #@NEW_LINE#@#  The orbitals for this model do not necessarily need to be optimized, as natural orbitals can be taken from an unrestricted HartreeFock (36) or small-CAS CASSCF calculation.  #@NEW_LINE#@#  The missing dynamic correlation can then be implemented in a perturb-then-diagonalize fashion before the quantum computations start or in a diagonalize-then-perturb fashion, where the quantum computer is used to compute the higher-order reduced density matrices required.  #@NEW_LINE#@#  The former approach, i.e., built-in dynamic electron correlation, is considerably more advantageous, as no wave function-derived quantities need to be calculated.  #@NEW_LINE#@#  One option for this approach is, for example, to consider dynamic correlation through DFT that avoids any double counting effects by virtue of range separation, as has already been successfully studied for CASSCF and DMRG (37, 38).  #@NEW_LINE#@#  Fig 2 presents a flowchart that describes the steps of a quantum computer-assisted chemical mechanism exploration.  #@NEW_LINE#@#  Moreover, the quantum computer results can be used for the validation and improvement of parametrized approaches such as DFT to improve on the latter for the massive prescreening of structures and energies.  #@NEW_LINE#@#  


Quantum_Simulation_of_Quantum_Chemical_Systems  #@NEW_LINE#@#  
Ground state energies on a quantum computer can be obtained by quantum phase estimation (QPE).  #@NEW_LINE#@#  If we take the time evolution of an eigenstate to be eiHt|n=eiEnt|n, then QPE learns the phase =Ent in a manner analogous to a MachZehnder interferometer.  #@NEW_LINE#@#  Measuring the phase starting from an approximate ground state collapses the wave function into an exact eigenstate and gives its energy.  #@NEW_LINE#@#  Time evolution is implemented using the TrotterSuzuki approach (SI Appendix), and efficient methods exist to implement each of the terms in a second quantized Hamiltonian (11).  #@NEW_LINE#@#  Although algorithms are known that can achieve better scaling than low-order TrotterSuzuki methods for some problems (3944), they are more challenging to lay out, as circuits and preliminary estimates suggest that they perform worse at this problem size.  #@NEW_LINE#@#  For these reasons, we focus on low-order TrotterSuzuki methods here and leave the task of fully costing out these alternative methods for future work.  #@NEW_LINE#@#  
To achieve reliable results, a fault-tolerant implementation of the quantum algorithm is crucial.  #@NEW_LINE#@#  Encoding a single logical qubit in a number of physical qubits with a quantum error-correcting code, such as the surface code (45), protects the logical qubit against decoherence and other experimental imperfections.  #@NEW_LINE#@#  
Quantum error correction cannot directly protect any arbitrary quantum operation, but it can protect a discrete set of gates, from which any continuous quantum operation can be approximated to within arbitrarily small error (46).  #@NEW_LINE#@#  Approximation takes two steps.  #@NEW_LINE#@#  First, the exponentials in the time evolution are decomposed into single-qubit rotations and so-called Clifford gates.  #@NEW_LINE#@#  In the surface code, which we consider here, Clifford gates can be implemented fault tolerantly.  #@NEW_LINE#@#  The single-qubit rotations, however, require approximation by a discrete set of gates consisting of Clifford operations and at least one non-Clifford operation, usually taken to be the T gate, a rotation by /8 about the z axis.  #@NEW_LINE#@#  Each T gate requires a procedure called magic state distillation, which consumes a host of noisy quantum states to output a single accurate magic state.  #@NEW_LINE#@#  The magic state is then used to teleport a T gate into the computation (47).  #@NEW_LINE#@#  The space and time overheads of state distillation render it the most costly aspect of quantum error correction, leading to a large overhead that is not taken into account in most previous cost estimates for quantum chemistry.  #@NEW_LINE#@#  
Resource_Estimates  #@NEW_LINE#@#  
We now estimate the costs of such simulations, focusing on two prototypical structures of FeMoco that are an example of the complexity of those that naturally would arise when probing the potential energy landscape of the complex.  #@NEW_LINE#@#  We first estimate the run time of the computation assuming a quantum computer can perform a logical T gate every 10 ns or 100 ns; Clifford circuits require negligible time and that a good trial state for the ground state is available.  #@NEW_LINE#@#  The cost of preparing trial states is discussed in SI Appendix.  #@NEW_LINE#@#  We then determine the cost of performing this simulation fault-tolerantly using the surface code, such that each physical gate takes 10 ns or 100 ns, including any time required by the decoder.  #@NEW_LINE#@#  We will predominantly look at two cases.  #@NEW_LINE#@#  In the first, we consider a quantum computer with 103 error rates and 100-ns gates as a realistic estimate of where superconducting technology may be for near-term devices, and 106 error rates and 10-ns gates as an aspirational target for future generations of quantum computers.  #@NEW_LINE#@#  
We aim to compute the energies with a total error of, at most, 0.1 millihartree (mHa) adding up all sources of discretization and statistical error.  #@NEW_LINE#@#  We also consider errors of 1 mHa which is comparable to the accuracy range of standard state-of-the-art quantum chemical methods for simple (mononuclear) transition metal complexes.  #@NEW_LINE#@#  
We consider three concrete implementations of the quantum algorithm and show the required gate counts in Table 1.  #@NEW_LINE#@#  In the Serial approach, the rotations are constrained to occur serially.  #@NEW_LINE#@#  In the Nesting approach (18), Hamiltonian terms that affect disjoint sets of spin orbitals are executed in parallel.  #@NEW_LINE#@#  In a third approach, programmable ancilla rotations (PAR), rotations are precomputed in parallel factories and then teleported into the circuit as needed (12).  #@NEW_LINE#@#  The overall cost of each approach is found by decomposing the rotations into Clifford and T gates using ref.  #@NEW_LINE#@#  48 for the serial case and ref.  #@NEW_LINE#@#  49 in the other cases.  #@NEW_LINE#@#  If all gates are executed in series, then we estimate that the simulation will complete in under a year and use a small number of logical qubits.  #@NEW_LINE#@#  PAR can reduce the time required to several days at the price of requiring nearly 20 times as many logical qubits.  #@NEW_LINE#@#  Nesting gives a reasonable trade-off between the two.  #@NEW_LINE#@#  
These estimates can be improved, if necessary, using the techniques we provide in SI Appendix.  #@NEW_LINE#@#  Specifically, we provide simulation circuits that reduce the depth of the quantum simulation by a factor of 4 and also give near-optimal phase estimation algorithms that use a cluster of quantum computers to estimate the phase.  #@NEW_LINE#@#  These methods not only can allow our algorithms to be run in much less time, if necessary, but also may be of independent interest to researchers.  #@NEW_LINE#@#  

Resource_Requirements_with_Quantum_Error_Correction  #@NEW_LINE#@#  
We next add the overheads required to perform the simulation fault-tolerantly and summarize the costs for structure 1 in Table 2.  #@NEW_LINE#@#  The underlying resource calculations for the fault-tolerant overheads follow ref.  #@NEW_LINE#@#  45.  #@NEW_LINE#@#  These costs depend on the physical error rates in the hardware, and we consider three cases corresponding to (i) a near-term error rate of 103, (ii) error rates of 106 that may one day be achievable in superconducting qubits or ion traps, and (iii) 109, which could be achievable for topological quantum computers (50).  #@NEW_LINE#@#  
We consider a high-level architecture for a quantum computer, sketched in Fig 3, consisting of a classical supercomputer interfacing with a quantum computer that consists of a main quantum processor and dedicated separate T factories and rotation factories to produce T gates and to synthesize rotations, respectively.  #@NEW_LINE#@#  Only the main quantum processor is intended for general purpose computing, whereas the other factories are intended for special purposes.  #@NEW_LINE#@#  
The subdivisions in our architecture need not be physical.  #@NEW_LINE#@#  Indeed, we implicitly assume that they are logical in our analysis, but thinking about the device from this perspective reveals that quantum computer architectures can be tailored to quantum simulation.  #@NEW_LINE#@#  In particular, such hardware can exploit the fact that such simulations only require magic states when the algorithm is performing single-qubit rotations.  #@NEW_LINE#@#  Optimizing against a fixed architecture designed for quantum simulation can furthermore reduce the bandwidth needed to control the device, make compilation easier, and simplify communication within the device.  #@NEW_LINE#@#  
We first observe in Table 2 that the number of logical qubits in the main quantum processor is only of the order of a hundred, which translates into tens of thousands to millions of physical qubits, which is challenging but not out of reach.  #@NEW_LINE#@#  Most of the qubits are used in the T factories, which each need fewer physical qubits than the main quantum processor.  #@NEW_LINE#@#  The number of T factories needed to perform the serial calculation is small, with 202 such factories required, in this case, for an error rate of 103, and fewer for better qubits.  #@NEW_LINE#@#  After factoring in the number of qubits needed per T factory, we arrive at the conclusion that only 105 to 106 physical qubits are needed for the 106 and 109 error rates.  #@NEW_LINE#@#  
If we parallelize with the PAR approach, then these costs are more daunting.  #@NEW_LINE#@#  The number of T factories required increases by a factor of roughly 1,000.  #@NEW_LINE#@#  If we use the nesting approach, then the costs are an order of magnitude greater than the serial case in the number of qubits, with a comparable reduction in run times.  #@NEW_LINE#@#  
To summarize, our estimates suggest that a quantum computer that operates with 10-MHz gates with 103 error rates could be simulated within a reasonable time using either nesting or PAR, but the number of physical qubits required will likely be prohibitive.  #@NEW_LINE#@#  On the other hand, the requirements are much more modest with the aspirational target of 100-MHz gates with 106 error rates; a large but manageable number of physical qubits suffices, and the need to parallelize is nowhere near as dire.  #@NEW_LINE#@#  Therefore, barring further developments in quantum simulation algorithms or quantum error correction, we should aim to see quantum computers that meet our aspirational goal emerge from quantum computing programs.  #@NEW_LINE#@#  New simulation methods such as in refs.  #@NEW_LINE#@#  4144 may one day provide decisive advantages for problems like FeMoco, but more work is needed to provide complete cost estimates for them and, in turn, a fair comparison between the costs that they incur relative to TrotterSuzuki methods for problems of this size.  #@NEW_LINE#@#  Finally, these low gate errors could one day be provided by topological quantum computers (50), which underscores the value in developing such hardware.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
Although, at present, a quantitative understanding of chemical processes involving complex open-shell species such as FeMoco in biological nitrogen fixation remains beyond the capability of classical computer simulations, our work shows that quantum computers used as accelerators to classical computers could be employed to elucidate this mechanism using a manageable amount of memory and time.  #@NEW_LINE#@#  The quantum computer is used here to obtain, validate, or correct the energies of intermediates and transition states and thus gives accurate activation energies for various transitions.  #@NEW_LINE#@#  The required space and time resources for simulating FeMoco using the 54-orbital basis and nesting are comparable to that of Shors factoring algorithm for 4,096-bit numbers (45).  #@NEW_LINE#@#  
Parallelizing the quantum computation of the energy landscape will be crucial to providing answers within a timeframe of several days instead of several years.  #@NEW_LINE#@#  Bounding the number of repetitions of phase estimation needed to prepare the ground state from an initial ansatz remains an open problem (see SI Appendix), and parallelism may often be needed to allow us to tolerate low success probability.  #@NEW_LINE#@#  Quantum computers therefore must be designed with a scalable architecture in mind and also built with the realization that constructing a single quantum computer is insufficient to solve such tasks.  #@NEW_LINE#@#  Instead, we should aim to have quantum computers that can be built en masse, because clusters of quantum computers will be needed to scan over the many structures that need to be examined to identify and estimate all important reaction rates (25).  #@NEW_LINE#@#  
Finally, chemical reactions that involve strongly correlated species that are hard to describe by traditional multiconfiguration approaches are not just limited to nitrogen fixation: They are ubiquitous.  #@NEW_LINE#@#  They range from CH bond activating catalysts; to those for hydrogen and oxygen production, carbon dioxide fixation, and transformation; to industrially useful compounds; to photochemical processes.  #@NEW_LINE#@#  Given the economic and societal impact of chemical processes ranging from fertilizer production to polymerization catalysis and clean energy processes, the importance of a versatile, reliable, and fast quantum chemical approach powered by quantum computing can hardly be overemphasized.  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  


