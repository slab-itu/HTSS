article id="http://dx.doi.org/10.1073/pnas.1617258113"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Estimating uncertainty in respondent-driven sampling using a tree bootstrap method  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
Some hidden or hard-to-reach populations of interest to researchers are difficult to study with standard statistical methods because there is not a reliable list of members from which samples can be drawn.  #@NEW_LINE#@#  Respondent-driven sampling (RDS) is a common way to reach members of these populations by allowing a small number of respondents to recruit further respondents in the target population from their personal contacts.  #@NEW_LINE#@#  However, estimates derived from RDS are known to have a high degree of uncertainty, for which current methods do not fully account.  #@NEW_LINE#@#  We present a method that overcomes this problem and allows for better statistical inference from RDS data.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Respondent-driven sampling (RDS) is a network-based form of chain-referral sampling used to estimate attributes of populations that are difficult to access using standard survey tools.  #@NEW_LINE#@#  Although it has grown quickly in popularity since its introduction, the statistical properties of RDS estimates remain elusive.  #@NEW_LINE#@#  In particular, the sampling variability of these estimates has been shown to be much higher than previously acknowledged, and even methods designed to account for RDS result in misleadingly narrow confidence intervals.  #@NEW_LINE#@#  In this paper, we introduce a tree bootstrap method for estimating uncertainty in RDS estimates based on resampling recruitment trees.  #@NEW_LINE#@#  We use simulations from known social networks to show that the tree bootstrap method not only outperforms existing methods but also captures the high variability of RDS, even in extreme cases with high design effects.  #@NEW_LINE#@#  We also apply the method to data from injecting drug users in Ukraine.  #@NEW_LINE#@#  Unlike other methods, the tree bootstrap depends only on the structure of the sampled recruitment trees, not on the attributes being measured on the respondents, so correlations between attributes can be estimated as well as variability.  #@NEW_LINE#@#  Our results suggest that it is possible to accurately assess the high level of uncertainty inherent in RDS.  #@NEW_LINE#@#  

Methods  #@NEW_LINE#@#  
The recruitment process underlying RDS involves complicated social dynamics that would be difficult to model.  #@NEW_LINE#@#  Therefore, much of the literature on the properties of RDS estimators relies on a set of simplifying assumptions.  #@NEW_LINE#@#  We will assume here that (i) the social network is finite and connected; (ii) network connections are reciprocal, not directed; (iii) recruits accurately report their network degree; (iv) recruitment coupons are distributed uniformly at random to neighbors in the network; and (v) individuals may be recruited into the sample more than once (3, 5, 6).  #@NEW_LINE#@#  In practice, not all of these assumptions are realistic.  #@NEW_LINE#@#  Specifically, RDS is usually performed without replacement, disallowing the same individual from being recruited more than once.  #@NEW_LINE#@#  See Results for a discussion of how this violation affects estimation from an RDS sample.  #@NEW_LINE#@#  
Under these assumptions, RDS is equivalent to a random walk on the underlying social network.  #@NEW_LINE#@#  Hence, RDS can be modeled by a first-order Markov chain on the space of network nodes, having a stationary distribution proportional to the degrees of the nodes (6).  #@NEW_LINE#@#  That is, the probability that an individual is recruited into the sample is proportional to the number of connections that individual has within the network.  #@NEW_LINE#@#  From this, it follows that the VolzHeckathorn estimator for the mean  of an attribute x in the population can be developed by weighting sampled individuals inversely proportional to their degree.  #@NEW_LINE#@#  Thus, we have^VH=i=1nxidii=1n1di,[1]where xi is the value of the attribute in individual i and di is the network degree of individual i (3).  #@NEW_LINE#@#  When the xi take on binary 0-1 values indicating the presence or absence of an attribute, then ^VH estimates the prevalence of the attribute in the population.  #@NEW_LINE#@#  An additional assumption that the initial recruits, or seeds, were selected with probability proportional to their degree is often included to ensure that the Markov chain begins at its stationary distribution (6).  #@NEW_LINE#@#  With this assumption, the estimator is unbiased, but even without this assumption, it is still asymptotically unbiased (3).  #@NEW_LINE#@#  
Because RDS produces samples that are not independent, estimating the variance of and constructing confidence intervals for the VolzHeckathorn estimator ^VH is not straightforward.  #@NEW_LINE#@#  Furthermore, the nature of the dependence within samples is defined by the underlying social network, most of which is unobserved.  #@NEW_LINE#@#  A number of methods for estimating the uncertainty of RDS estimates have been developed.  #@NEW_LINE#@#  Volz and Heckathorn suggested a variance estimator for ^VH that invokes the standard theory of HansenHurwitz estimators (3).  #@NEW_LINE#@#  Salganik (8) proposed a bootstrap procedure that splits the sample into groups based upon the attribute value of their recruiter and iteratively resamples from these groups accordingly.  #@NEW_LINE#@#  Both of these methods attempt to leverage the Markovian properties of the RDS recruitment process.  #@NEW_LINE#@#  However, the methods both assume that these properties hold even when the individuals are grouped by their attribute values, which is not ensured by the theory.  #@NEW_LINE#@#  Gile (10) treated RDS similarly to a probability proportional to size without replacement design and developed an alternative to the VolzHeckathorn estimator with weights that are no longer simply proportional to network degree.  #@NEW_LINE#@#  
The method of uncertainty estimation for RDS that we introduce is both simple to implement and outperforms other methods in simulation studies.  #@NEW_LINE#@#  The major difference between the methods mentioned above and the one we propose is that previous methods focus heavily on the status of the observed attribute.  #@NEW_LINE#@#  Instead, we suggest ignoring the attribute status and focusing solely on the structure of the RDS recruitment trees, which allows us to take advantage of the primary source of the dependence within samples, namely the underlying social network.  #@NEW_LINE#@#  
Tree_Bootstrap  #@NEW_LINE#@#  
Our method is essentially a multilevel bootstrap procedure applied within the hierarchical framework of the RDS recruitment trees.  #@NEW_LINE#@#  To draw a bootstrap sample from a set of observed trees, the initial step is to resample with replacement from the seeds of the trees.  #@NEW_LINE#@#  Next, from each of those seeds, we resample with replacement from their recruits, creating the second level of the bootstrap sample trees.  #@NEW_LINE#@#  From each of these new recruits, we then resample with replacement from their recruits to create a third level.  #@NEW_LINE#@#  This process continues iteratively until no further recruits are available.  #@NEW_LINE#@#  From the resulting bootstrap sample trees, any statistic of interest, such as the VolzHeckathorn estimator, can be computed.  #@NEW_LINE#@#  By taking multiple bootstrap samples, the sampling distribution of the statistic can then be estimated from the observed RDS trees in a way that respects the dependence within the sample (14, 15).  #@NEW_LINE#@#  This is similar to what happens with other well-known techniques for resampling from correlated data, such as the block bootstrap methods for time series or spatial data, except that in our case, the structure of the dependence comes from the RDS recruitment process instead of proximity in time or space (16, 17).  #@NEW_LINE#@#  We note that due to the asymmetries of the observed RDS trees, the tree bootstrap produces resamples that vary in size.  #@NEW_LINE#@#  To alleviate any bias that may result from this variation, any inference based upon the bootstrap distribution of a statistic should be weighted by the effective relative sample sizes (e.g., i1/di for the VolzHeckathorn estimator).  #@NEW_LINE#@#  
Fig 1B shows an example of a bootstrap sample drawn from the observed trees in Fig 1A.  #@NEW_LINE#@#  Note that seed 2 was selected twice in the initial resampling step, whereas seed 3 was not selected, but the resampled trees resulting from the two copies of seed 2 are quite different due to the further recruits that were selected in later steps.  #@NEW_LINE#@#  Also note that although the individuals are shaded according to their attribute value, these values do not affect the resampling procedure.  #@NEW_LINE#@#  However, variability in the sampling distribution of statistics involving the attribute values will be represented in the changing structure of the resampled bootstrap trees.  #@NEW_LINE#@#  In fact, we can see from this example that the substantial attribute homophily observed in Fig 1A will result in a higher degree of variability in attribute statistics when using the tree bootstrap method than we would expect if we used a standard bootstrap method.  #@NEW_LINE#@#  


Data  #@NEW_LINE#@#  
Project_90  #@NEW_LINE#@#  
Our first dataset comes from the Colorado Springs Project 90 study, which was funded by the Centers for Disease Control and Prevention to investigate the affect of network structure on HIV transmission among a population of high-risk heterosexuals.  #@NEW_LINE#@#  From 1988 to 1992, researchers conducted interviews with 595 sex workers, paying and nonpaying partners of sex workers, IDUs, and sexual partners of drug users, and a network was constructed based upon a complete enumeration of participants social, sexual, and/or drug contacts (1820).  #@NEW_LINE#@#  There was a total of 5,492 individuals in the network, but we will focus only on the largest connected component, consisting of 4,430 individuals and 18,407 edges.  #@NEW_LINE#@#  For each individual, 13 different attributes were measured, including demographic factors and other factors of interest such as whether the individual is a sex worker, pimp, or sex worker client.  #@NEW_LINE#@#  
We used the Project 90 data to develop a simulation study by simulating RDS recruitment trees from the network using the following process: (i) 10 seeds are selected at random from the network with probability proportional to their degree; (ii) with probabilities 1/3, 1/6, 1/6, or 1/3, respectively, each recruit successively selects 0, 1, 2, or 3 new recruits uniformly at random from their neighbors in the network; and (iii) recruitment continues until the RDS contains 500 individuals.  #@NEW_LINE#@#  For our initial simulation study, all sampling was done with replacement, so the standard RDS assumptions hold.  #@NEW_LINE#@#  This process mimics that found in Goel and Salganiks assessment of RDS using the same Project 90 data (13).  #@NEW_LINE#@#  However, to account for how RDS is usually implemented in practice, we also conducted a second simulation study in which sampling was performed without replacement.  #@NEW_LINE#@#  It should be noted that although these are simulation studies from a network, the network itself was not simulated.  #@NEW_LINE#@#  Instead, only the RDS recruitment process was simulated from a preexisting network.  #@NEW_LINE#@#  

Add_Health  #@NEW_LINE#@#  
Our second dataset is from the National Longitudinal Study of Adolescent Health (Add Health), a nationally representative longitudinal study of adolescents in grades 712 to investigate the effect of social environments and behaviors in adolescence on health and achievement outcomes in young adulthood.  #@NEW_LINE#@#  We used only the initial wave of sampling from the 1994 to 1995 school year in which researchers administered in-school questionnaires to 90,118 students attending 84 pairs of middle and high schools chosen to be representative of US schools with respect to region of the country, urbanism, school type, ethnicity, and school size (21, 22).  #@NEW_LINE#@#  Social networks were mapped based upon nominations of up to five male and five female friends from each respondents school pair.  #@NEW_LINE#@#  The largest connected components of these school networks consist of a total of 72,262 individuals and 258,688 edges and range in size from 25 to 2,539 students, with a median of 753.  #@NEW_LINE#@#  For each individual, 46 different attributes were measured, including demographic factors, family status factors such as whether their mother or father live at home, and involvement in various school activities including sports teams and clubs.  #@NEW_LINE#@#  Our simulation study using the Add Health data were performed for each of the 84 school pairs in the same manner as described above for the Project 90 data.  #@NEW_LINE#@#  

Ukraine_IDU  #@NEW_LINE#@#  
These data were collected in 2011 from IDUs in major Ukrainian cities.  #@NEW_LINE#@#  Rates of HIV in Ukraine were among the highest in Eastern Europe at the time, and the epidemic had continued to grow despite comprehensive efforts to slow transmission of the disease, especially among IDUs (23).  #@NEW_LINE#@#  In an effort to track trends in HIV prevalence and understand behavioral patterns that affect the spread of the disease, sentinel surveillance of IDUs was conducted through the administration of behavioral surveys using RDS methodology.  #@NEW_LINE#@#  In each of 26 targeted cities, between 2 and 6 seed respondents were selected nonrandomly based on prespecified criteria.  #@NEW_LINE#@#  Each respondent then recruited up to 3 additional respondents until between 200 and 500 total IDUs were surveyed, with the target sample size being higher in cities with higher HIV prevalence (24).  #@NEW_LINE#@#  We will focus on four attributes measured by the behavioral survey in each city: (i) hospitalization to state drug treatment in-patient clinics during 2010; (ii) participation in the state substitution maintenance therapy (SMT) program; (iii) registration at nongovernmental organizations (NGO) that provide HIV prevention services; and (iv) use of HIV rapid tests distributed by NGOs that provide HIV prevention services.  #@NEW_LINE#@#  All our analyses are secondary data analyses of data collected by other organizations.  #@NEW_LINE#@#  The data we obtained included no personal identifiers of any kind.  #@NEW_LINE#@#  


Results  #@NEW_LINE#@#  
Project_90  #@NEW_LINE#@#  
From each of 1,000 simulated respondent-driven samples from the Project 90 data, we used multiple existing methods to infer the population proportions for each of the 13 attributes using confidence intervals.  #@NEW_LINE#@#  Because these true population proportions are known from the data, we can use these inferences to compare the coverage probabilities of the confidence intervals derived from the different methods.  #@NEW_LINE#@#  If we estimate 95% confidence intervals from the simulated samples, then for each attribute, we would expect these confidence intervals to cover the true population proportion in approximately 95% of the samples.  #@NEW_LINE#@#  
Fig 2A shows the resulting coverage probabilities of the 95% confidence intervals as estimated by the following methods: (i) the naive proportion variance estimator; (ii) the VolzHeckathorn variance estimator; (iii) the Salganik bootstrap; (iv) the Yamanis bootstrap; (v) the Gile successive-sampling bootstrap; and (vi) the tree bootstrap.  #@NEW_LINE#@#  Bootstrap confidence intervals were computed using the percentile method.  #@NEW_LINE#@#  For each attribute, the tree bootstrap method hewed much closer to the expected 95% coverage probability than any of the alternative methods, which rarely achieved more than 70% coverage.  #@NEW_LINE#@#  The tree bootstrap provided well-calibrated inference for attributes with very high design effects, such as whether an individual was nonwhite or a sex worker client.  #@NEW_LINE#@#  The estimated design effects for these attributes are about 60 and 30, respectively (13), where the design effect is defined as the ratio of the variance of the RDS estimator to that of the estimator from a simple random sample.  #@NEW_LINE#@#  Thus, if the design effect is 10, then the precision of an estimate from an RDS of size 500 is equivalent to that of a simple random sample of size 50.  #@NEW_LINE#@#  
Fig 2C shows the mean widths of these 95% confidence intervals for each attribute (80% intervals are shown in SI Appendix, Fig S1).  #@NEW_LINE#@#  To form a basis of comparison, we generated 9,000 additional samples and then calculated the expected widths of the intervals using the 2.5th and 97.5th percentiles of the sampling distribution across all 10,000 simulated samples.  #@NEW_LINE#@#  The average widths of the tree bootstrap confidence intervals were much closer to the expected values than those from the other methods.  #@NEW_LINE#@#  Even when estimating the proportions of nonwhites and sex worker clients, the tree bootstrap method inferred confidence intervals wide enough on average to accommodate their high design effects.  #@NEW_LINE#@#  
In contrast to the assumptions underlying the statistical models commonly used for RDS, RDS is usually carried out by sampling without replacement.  #@NEW_LINE#@#  In practice, respondents are generally not allowed to recruit individuals who have already been included in the sample.  #@NEW_LINE#@#  This can affect the sampling process because the underlying social network is reduced by the removal of nodes as the sampling continues, and it has been observed that the resulting RDS estimates can be biased (10, 25).  #@NEW_LINE#@#  As a result, we repeated the simulation study under the assumption that sampling was performed without replacement.  #@NEW_LINE#@#  Fig 2B shows the coverage probabilities of these 95% confidence intervals as estimated by the same methods as before.  #@NEW_LINE#@#  The tree bootstrap method still had coverage at least equal to the nominal 95% in almost all cases, and indeed its coverage was better (i.e., closer to the nominal level) than when sampling was with replacement.  #@NEW_LINE#@#  The other methods still had coverage substantially below the nominal level in most cases.  #@NEW_LINE#@#  As when sampling with replacement, only the tree bootstrap captured the large variability inherent in these samples when estimating attributes with high design effects, such as the proportions of nonwhites or sex worker clients.  #@NEW_LINE#@#  

Add_Health  #@NEW_LINE#@#  
We inferred population proportions using confidence intervals for each of the 84 school pairs and 46 attributes in the Add Health data in each of 1,000 simulated respondent-driven samples.  #@NEW_LINE#@#  Fig 3 shows the resulting mean coverage probabilities across the school pairs of 95% confidence intervals as estimated by the following methods: (i) the naive proportion variance estimator; (ii) the VolzHeckathorn variance estimator; (iii) the Salganik bootstrap; (iv) the Gile successive-sampling bootstrap; and (v) the tree bootstrap.  #@NEW_LINE#@#  The Salganik and Gile successive bootstrap methods had much longer computation times than the other methods due to the presence of 46 attributes.  #@NEW_LINE#@#  This result illustrates a benefit of the tree bootstrap method not being attribute-based: inference about any number of attributes can be carried out from a single bootstrap sample.  #@NEW_LINE#@#  
As with the Project 90 simulation study, the tree bootstrap method provided intervals with coverage probabilities closer to the nominal 95% than the alternatives, which usually achieved around 6080% coverage (80% intervals in SI Appendix, Fig S2).  #@NEW_LINE#@#  Again, the tree bootstrap provided reasonably well-calibrated inference regardless of the magnitudes of the design effects for the attributes.  #@NEW_LINE#@#  The results when sampling is without replacement are shown in SI Appendix, Figs.  #@NEW_LINE#@#  S3 and S4.  #@NEW_LINE#@#  

Ukraine_IDU  #@NEW_LINE#@#  
We applied the tree bootstrap method to the RDS data collected from IDUs in 26 Ukrainian cities.  #@NEW_LINE#@#  Fig 4 AD shows the resulting 80 and 95% confidence intervals obtained from this method, along with various others.  #@NEW_LINE#@#  The results for two selected cities are shown in Fig 4; the remaining results are in SI Appendix, Tables S1S4.  #@NEW_LINE#@#  
Fig 4 A and B give estimates for the proportion of IDUs hospitalized to state drug treatment in-patient clinics during 2010 and the proportion who participated in the state SMT program, respectively.  #@NEW_LINE#@#  As expected from the simulation study, the interval estimates from the tree bootstrap methods were generally wider than those from the alternative methods.  #@NEW_LINE#@#  For example, the upper limits of the 95% interval estimates from Bila Tserkva in Fig 4A were 5.2 and 4.7% when using Salganiks and Giles methods but 9.7% when using the tree bootstrap, nearly twice as high.  #@NEW_LINE#@#  Given previous results in this paper and related literature, we expect that the tree bootstrap more closely represented the true variability of the RDS estimators.  #@NEW_LINE#@#  
Fig 4C gives estimates for the proportion of IDUs registered at NGOs that provide HIV prevention services, and Fig 4D gives estimates for the average number of HIV rapid tests distributed by these NGOs that are used by each registered IDU.  #@NEW_LINE#@#  Again, we see that the tree bootstrap provided wider interval estimates that are more likely to cover the true values than the other methods.  #@NEW_LINE#@#  The interval estimates from Simferopol in Fig 4C are around three times wider for the tree bootstrap method than for the others, with the 95% interval stretching from 22 to 70%.  #@NEW_LINE#@#  
Fig 4D shows estimated means of the average number of HIV rapid tests distributed by NGOs that are used by each registered IDU.  #@NEW_LINE#@#  Our tree bootstrap method requires no additional modifications to handle cases where the object of inference is a count.  #@NEW_LINE#@#  Other currently available methods have not been adapted to discrete counts or continuous outcomes, which would be difficult because most methods rely on transitions from a finite number of discrete states.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
Previous work has indicated that although the VolzHeckathorn estimator can correct for much of the bias introduced by the RDS process, estimating the processs variance is much harder (13).  #@NEW_LINE#@#  Previous statistical inferences from RDS can be misleading when design effects often reduce effective sample sizes by a factor of 10 or more.  #@NEW_LINE#@#  We have shown here that existing methods for variance estimation such as the VolzHeckathorn variance estimator, the Salganik bootstrap, and the Gile successive-sampling bootstrap can fail to fully capture the variability in RDS estimates.  #@NEW_LINE#@#  
Our tree bootstrap method can produce interval estimates that are able to account for the high variability of the RDS process, even when the design effects are very large.  #@NEW_LINE#@#  The tree bootstrap intervals tend to be slightly conservative, but we have shown that their widths are not excessive compared with what should be expected from RDS.  #@NEW_LINE#@#  In many applications, this slight conservatism may be preferable to the overly narrow intervals that other methods provide.  #@NEW_LINE#@#  In some cases, the tree bootstrap yields interval estimates that are too wide for practical use, but this probably indicates a very large design effect and low effective sample size, suggesting that the RDS data are not of much value in these cases.  #@NEW_LINE#@#  Thus, our methods may also help diagnose situations where RDS is not of much use.  #@NEW_LINE#@#  
In the tree bootstrap, the resampling is performed with respect only to the structure of the RDS recruitment tree and not to the attributes measured on the respondents.  #@NEW_LINE#@#  Thus, estimates from any number of attributes can be derived from a single bootstrap sample.  #@NEW_LINE#@#  This is not the case for the other methods we examined, each of which requires an independent analysis for each attribute of interest.  #@NEW_LINE#@#  This makes the tree bootstrap more efficient computationally and also means that we can estimate not only the variances of the estimates of each attribute but also the covariances between these estimates.  #@NEW_LINE#@#  This could be useful in a capturerecapture design in which multiple capture sources are compared with a single RDS recapture sample because, in this case, good population size estimation would rely on estimating the dependence between the capture sources within the recapture sample.  #@NEW_LINE#@#  
The tree bootstrap is based on resampling through the tree structure while ignoring the attributes, and this may be what drives the methods success.  #@NEW_LINE#@#  Previous methods, including the VolzHeckathorn variance estimator and the Salganik bootstrap, effectively model RDS as a first-order Markov process on the set of attribute states.  #@NEW_LINE#@#  Although it is true that RDS is a first-order Markov process on the nodes in the underlying social network, this characteristic no longer holds when the nodes are aggregated by attribute status, which leads to bias in the estimation of sampling variance (26).  #@NEW_LINE#@#  On the other hand, the tree bootstrap method can be viewed as a resampling of paths down the observed RDS tree.  #@NEW_LINE#@#  Because entire paths from root to leaf are resampled together, transitions of length greater than one are considered, and we are able to escape the first-order Markov approximation.  #@NEW_LINE#@#  Further study of the theoretical properties of the tree bootstrap would be worthwhile.  #@NEW_LINE#@#  

Conclusion  #@NEW_LINE#@#  
We have introduced the tree bootstrap method for estimating uncertainty in samples derived from RDS.  #@NEW_LINE#@#  Unlike previous methods, the tree bootstrap can capture the large variability inherent in the RDS process, even in extreme cases.  #@NEW_LINE#@#  This method allows us to construct calibrated interval estimates, avoiding the overly narrow intervals that existing methods provide.  #@NEW_LINE#@#  We hope that this method removes one of the major obstacles facing the practical application of RDS to the study of hidden and hard to reach populations.  #@NEW_LINE#@#  An R package to implement the method called RDStreeboot is publicly available from CRAN, at https://CRAN.R-project.org/package=RDStreeboot.  #@NEW_LINE#@#  

Acknowledgments  #@NEW_LINE#@#  
The authors thank Tetyana Salyuk and Mary Mahy for sharing data and helpful conversations and two reviewers for constructive suggestions, which improved the article.  #@NEW_LINE#@#  This research was supported by NIH Grants R01 HD054511, R01 HD070936, and U54 HL127624 (to A.E.R.)  #@NEW_LINE#@#  and NIH Grant K01 HD078452, National Science Foundation Grant SES-1559778, and US Army Research Office Grant W911NF-12-1-0379 (to T.H.M.  #@NEW_LINE#@#  ).  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  




