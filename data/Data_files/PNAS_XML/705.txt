article id="http://dx.doi.org/10.1073/pnas.1615109114"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Extraordinarily rapid speciation in a marine fish  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
Divergent selection can lead to the evolution of distinct species, a process known as ecological speciation.  #@NEW_LINE#@#  Evidence for ecological speciation in the marine environment is scarce, and the few known examples have happened within a time frame of hundreds of thousands to millions of years.  #@NEW_LINE#@#  We present evidence that European flounders in the Baltic Sea exhibiting different breeding behaviors are a species pair arising from a recent event of ecological speciation.  #@NEW_LINE#@#  The two lineages diverged within less than 3,000 generations.  #@NEW_LINE#@#  This is the fastest event of speciation ever reported for any marine vertebrate.  #@NEW_LINE#@#  Extraordinarily rapid speciation driven by natural selection can therefore happen even in the marine environment.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Divergent selection may initiate ecological speciation extremely rapidly.  #@NEW_LINE#@#  How often and at what pace ecological speciation proceeds to yield strong reproductive isolation is more uncertain.  #@NEW_LINE#@#  Here, we document a case of extraordinarily rapid speciation associated with ecological selection in the postglacial Baltic Sea.  #@NEW_LINE#@#  European flounders (Platichthys flesus) in the Baltic exhibit two contrasting reproductive behaviors: pelagic and demersal spawning.  #@NEW_LINE#@#  Demersal spawning enables flounders to thrive in the low salinity of the Northern Baltic, where eggs cannot achieve neutral buoyancy.  #@NEW_LINE#@#  We show that demersal and pelagic flounders are a species pair arising from a recent event of speciation.  #@NEW_LINE#@#  Despite having a parapatric distribution with extensive overlap, the two species are reciprocally monophyletic and show strongly bimodal genotypic clustering and no evidence of contemporary migration, suggesting strong reproductive isolation.  #@NEW_LINE#@#  Divergence across the genome is weak but shows strong signatures of selection, a pattern suggestive of a recent ecological speciation event.  #@NEW_LINE#@#  We propose that spawning behavior in Baltic flounders is the trait under ecologically based selection causing reproductive isolation, directly implicating a process of ecological speciation.  #@NEW_LINE#@#  We evaluated different possible evolutionary scenarios under the approximate Bayesian computation framework and estimate that the speciation process started in allopatry 2,400 generations ago, following the colonization of the Baltic by the demersal lineage.  #@NEW_LINE#@#  This is faster than most known cases of ecological speciation and represents the most rapid event of speciation ever reported for any marine vertebrate.  #@NEW_LINE#@#  

Map of the sampling locations showing modeled mean bottom salinity in the Baltic Sea from Bendtsen et al.  #@NEW_LINE#@#  (62).  #@NEW_LINE#@#  Areas theoretically suitable for pelagic spawning are colored in green, yellow, and red.  #@NEW_LINE#@#  Locations are color-coded based on expected spawning behaviors.  #@NEW_LINE#@#  ÅLA, Åland Archipelago; BAR, Barsebäck; BOR, Bornholm Basin; DAB, Dabki; GDY, Gdynia; GUL, Gullmaren; HAN, Hanko (Western Gulf of Finland); HEL, Helsinki (Gulf of Finland); IRB, Irbe Strait; KAT, Kattegat; KVÄ, Kvädöfjärden; LAT, Latvian Sea; and ÖLA, Öland Island.  #@NEW_LINE#@#  More than 90% (Table S1) of samples from BOR (pelagic habitat) and ÖLA (demersal habitat) were ready for spawning at the time of capture, hence these locations were used as reference pelagic and demersal populations, respectively.  #@NEW_LINE#@#  
Results  #@NEW_LINE#@#  
The final dataset consisted of 2,051 biallelic SNPs genotyped for 282 individuals.  #@NEW_LINE#@#  A principal-component analysis (PCA) performed with all loci revealed two genetic clusters along the first axis (Fig 2A), which largely coincide with the expected distribution of demersal and pelagic spawners (Table S1 and Fig 1).  #@NEW_LINE#@#  Samples from the two reference populations (Bornholm for pelagic spawners, Öland for demersal spawners) clustered as expected with the pelagic and demersal clusters, respectively (Fig 2A).  #@NEW_LINE#@#  A few individuals (nine from Irbe, one from Kvädöfjärden, one from Hanko, and three from Helsinki) sampled in putative demersal locations appear to have genotypes characteristic of pelagic Baltic flounders, suggesting the two taxa co-occur in some locations (Fig 1).  #@NEW_LINE#@#  PCAs run only with loci from the core FST distribution (i.e., loci unlikely to be under selection) and excluding FST outliers revealed nearly identical patterns (Fig S1 A and C), with samples from the Baltic Sea showing a clear bimodal distribution on the first axis (Fig S1 B and D).  #@NEW_LINE#@#  There was no evidence of isolation by distance, regardless of whether the dataset was analyzed as a whole or pelagic and demersal flounders were analyzed separately (Fig 2B), and regardless of whether loci potentially under selection were excluded (Fig S1 E and F).  #@NEW_LINE#@#  Genetic diversity indices were very similar for each sampling location and for the three major genetic clusters (Table S2), suggesting that no major demographic events affecting genetic diversity have occurred since the time of common ancestry.  #@NEW_LINE#@#  
Genotypic clustering using K-means and fastSTRUCTURE suggests that values of K of 2 and 3 are useful models of the data (Fig S2 AD).  #@NEW_LINE#@#  Both fastSTRUCTURE and discriminant analysis of principal components (DAPC) identified the same genetic clusters as the PCA.  #@NEW_LINE#@#  At K = 2, both fastSTRUCTURE and DAPC separate the putative demersal and pelagic taxa (Fig S2E).  #@NEW_LINE#@#  When K = 3, the third cluster represented the North Sea samples (Fig 2C and Fig S2E).  #@NEW_LINE#@#  Individuals from the demersal and pelagic clusters co-occur in similar proportions in one location (Irbe, Fig 2C), and a small number of individuals with pelagic genotypes were sampled from the northern Baltic Sea coast in Finland and Sweden (Fig 2C).  #@NEW_LINE#@#  We found no sign of hybridization between the two Baltic taxa as none of the 282 sampled individuals showed intermediate genotypes (Fig 2 A and C).  #@NEW_LINE#@#  There was some evidence of hybridization between pelagic flounders from the Baltic Sea and the North Sea (Fig 2C), particularly in the transition zone (Barsebäck).  #@NEW_LINE#@#  The private allele method (23) suggests less than one migrant per generation between each of the major genetic clusters; five independent runs of BAYESASS reported migration rates of less than 0.5% between demersal and pelagic flounders, and the 95% CI of these estimates always overlapped with zero, providing no evidence for contemporary gene flow.  #@NEW_LINE#@#  
Multiple outlier tests (BAYESCAN, Arlequin, OutFLANK, and FLK) identified a set of 10 outlier loci that show higher than expected FST (Fig S3 and Table S3).  #@NEW_LINE#@#  Eight of these loci show evidence of divergent selection between demersal and pelagic locations in the Baltic, whereas only three show evidence of divergent selection among locations on either side of the transition zone (Fig 3 and Fig S3).  #@NEW_LINE#@#  There was no evidence of spatially diversifying selection among populations of the same taxon within the Baltic Sea (Fig 3 and Fig S3 G and H).  #@NEW_LINE#@#  In Irbe (IRB), we present frequencies of outlier loci for putative demersal and putative pelagic individuals separately (Fig 3), both of which show outlier frequencies similar to other demersal and pelagic populations, respectively, regardless of geographical proximity (Fig 3).  #@NEW_LINE#@#  Of the six outliers for which we obtained flanking regions, four matched protein-coding genes (Table S4).  #@NEW_LINE#@#  One (a protocadherin FAT1-like gene) has been shown to be involved in response to salinity stress in oysters (24, 25) and teleosts (26).  #@NEW_LINE#@#  Locus 3599 has a nonsynonymous mutation within the dynein axonemal heavy chain 5 gene, which codes for a protein playing a central role in flagellar movement and sperm motility (27)one of the traits that differs between the two taxa (13).  #@NEW_LINE#@#  
Maximum-likelihood and Bayesian phylogenetic analyses based on the sequences of 2,051 concatenated loci demonstrate that the two Baltic taxa are reciprocally monophyletic (Fig 4).  #@NEW_LINE#@#  However, there is no support for a Baltic pelagic clade distinct from North Sea flounders (Fig 4).  #@NEW_LINE#@#  Using an ABCrandom forest (ABC-RF) approach (28, 29), we evaluated different potential evolutionary scenarios (Fig 5 and Tables S5S9).  #@NEW_LINE#@#  The demersal and pelagic flounders within the Baltic originated via two independent invasions (Fig 5, scenario 1), which happened 2,400 (95% CI: 1,4509,110) and 1,490 (95% CI: 5964,780) generations ago, respectively.  #@NEW_LINE#@#  Evidence was also found for a demographic expansion in the ancestral population (Table S9), for a mild bottleneck in the demersal population (Table S8), and for secondary introgressionalbeit weakamong the two species in the Baltic (Table S9).  #@NEW_LINE#@#  

Discussion  #@NEW_LINE#@#  
Ecological_Speciation  #@NEW_LINE#@#  
Genomic analyses revealed that pelagic and demersal spawning flounders in the Baltic Sea represent two reciprocally monophyletic taxa exhibiting limited-to-no introgression, strongly bimodal genotypic clustering, and signatures of divergent selection.  #@NEW_LINE#@#  Genetic differentiation among Baltic locations closely mirrored expected breeding behavior and was uncorrelated with geographic distance.  #@NEW_LINE#@#  Four of the six outliers for which we obtained flanking sequences matched protein-coding genes, one of which has been implicated in salinity stress response in oysters (24, 25) and fish (26).  #@NEW_LINE#@#  A SNP in locus 3599 causes an amino acid change in a gene governing sperm motility (27), one of the key traits that have previously been shown to differ between demersal and pelagic spawners (13), reinforcing the interpretation that the outliers identified in this study are likely targets of ecological selection.  #@NEW_LINE#@#  Interpreted together, these findings are indicative of strong reproductive isolation and suggestive of a well-advanced process of ecological speciation (3).  #@NEW_LINE#@#  Along with previous studies showing that reproductive traits are population specific (13, 30, 31), the genetic differentiation and signatures of selection between pelagic and demersal spawners uncovered here strongly suggest that breeding behavior in P. flesus is not a plastic trait, as has been previously suggested for another flatfish species (18), but rather the result of ecological adaptations to the low salinities experienced in the coastal waters of the Baltic Sea (13, 15).  #@NEW_LINE#@#  
Pelagic and demersal flounders have a parapatric distribution and share the same feeding and wintering grounds in the central Baltic (30).  #@NEW_LINE#@#  Because the two taxa can co-occur around the time of spawning in the same shallow coastal waters (for example, as they do in Irbe), it should be possible for pelagic spawners to opportunistically fertilize demersal eggs.  #@NEW_LINE#@#  However, a study has shown that pelagic spawners sperm motility is very low at salinities below 11 psu (13).  #@NEW_LINE#@#  Because demersal spawners lay their eggs in coastal waters where salinity rarely exceeds 7.5 psuand never exceeds 11 psu (Fig 1)opportunistic fertilization by pelagic males is unlikely.  #@NEW_LINE#@#  Conversely, demersal spawners could remain in deeper areas after wintering and opportunistically fertilize pelagic eggs, although to what extent this may happen under natural conditions is unknown.  #@NEW_LINE#@#  Breeding behavior is expected to be under strong ecological selection in the northern Baltic region, and this expectation is supported by our findings of signatures of selection.  #@NEW_LINE#@#  Ecological selection on spawning behavior could lead to reproductive isolation via spawning segregation.  #@NEW_LINE#@#  As noted by Nosil (4), a trait under ecological selection causing reproductive isolation implicates a process of ecological speciation.  #@NEW_LINE#@#  
The extent of reproductive isolation seems to be stronger in the flounder species pair than in other cases of recent ecological speciation.  #@NEW_LINE#@#  Sympatric species of cichlid fish (Amphilophus citrinellus and Amphilophus zaliosus) in Lake Apoyo are not reciprocally monophyletic (the two species share many mtDNA haplotypes) and show stronger signs of introgression and less clearly bimodal genotypic clustering (32).  #@NEW_LINE#@#  Similarly, three-spined stickleback limnetic/benthic species pairs do occasionally mate in the wild; for example, roughly 1% of individuals in Paxton Lake are hybrids (33)although hybrids have reduced fitness in the natural environment (34).  #@NEW_LINE#@#  Despite sampling throughout the Baltic Sea, we found no evidence of first-generation hybrids or of intermediate genotypes.  #@NEW_LINE#@#  If hybridization ever occurs under natural conditions, it must be either rare or geographically restricted.  #@NEW_LINE#@#  
Our data suggest the existence of another barrier to gene flow and of spatially diversifying selection between pelagic flounders from the North Sea and the Baltic Sea, coincident with a steep gradient in temperature and salinity.  #@NEW_LINE#@#  Reproductive isolation between the North Sea and Baltic Sea pelagic flounders is partial, as documented by a number of individuals showing admixture in the transition zone.  #@NEW_LINE#@#  However, it is possible that a process of speciation may have initiated between these two populations, possibly driven by selection for lower temperatures and salinity in the Baltic Sea.  #@NEW_LINE#@#  This hypothesis is supported by findings from reciprocal transplant experiments showing that pelagic flounders on each side of the transition zone have different expression patterns in candidate genes for osmoregulation, stress resistance, and heme protein biosynthesis (35).  #@NEW_LINE#@#  

Possible_Evolutionary_Scenarios  #@NEW_LINE#@#  
The Baltic Sea became connected to the North Sea roughly 8.5 kya.  #@NEW_LINE#@#  Salinity remained well below the lowest salinity at which demersal flounders can reproduce until 7.5 kya and remained below the minimum requirements for pelagic spawning until 6.5 kya (11).  #@NEW_LINE#@#  During the period between 6.5 and 5 kya, salinity in the Baltic remained between 10 and 15 psu, creating an opportunity for colonization of the basin by pelagic spawners (11), and since has been steadily declining (11).  #@NEW_LINE#@#  
We propose that flounders adapted to a new ecological niche by developing a demersal spawning behavior in the early days of the Litorina Sea stage, possibly as early as 7.5 kya.  #@NEW_LINE#@#  Under this scenario, demersal flounders initially diverged from the pelagic flounders during a first allopatric phase lasting until 6 kya (11).  #@NEW_LINE#@#  Pelagic flounders could have invaded the Baltic Sea when conditions were suitable for pelagic spawning in most of the area (65 kya) and not exclusively, as today, in a few deep offshore basins.  #@NEW_LINE#@#  Such allopatric phase lasting 1,500/2,500 y might have prevented any homogenizing effect of gene flow in the early days of speciation.  #@NEW_LINE#@#  Other cases of extremely rapid ecological speciation, such as the evolution of benthic and limnetic species pairs of three-spined sticklebacks in postglacial lakes, are also thought to have started via double colonization and early divergence in allopatry (36).  #@NEW_LINE#@#  
This hypothesis is compatible with the double-invasion scenario identified by ABC-RF.  #@NEW_LINE#@#  The estimated time of divergence between demersal flounders and the North Sea population has a mode of 2,400 generations (95% CI: 1,4509,110).  #@NEW_LINE#@#  Within the Baltic, flounders reach sexual maturity around 2 y of age (37), although in the northernmost locations sexual maturity in females is delayed for another 12 y (38).  #@NEW_LINE#@#  Hence the coalescence estimates suggest an early colonization of the Baltic Sea (7.2 kya, assuming a generation time of 3 y).  #@NEW_LINE#@#  Divergence time estimates of pelagic flounders from the ancestral population are also consistent with the hypothesis of an invasion during peak salinity 65 kya.  #@NEW_LINE#@#  
The speciation of a marine vertebrate in such a short time frame has never been reported before.  #@NEW_LINE#@#  Documented examples of ecological speciation in the marine environment are extremely rare (8) and have usually required much longer time frames (9).  #@NEW_LINE#@#  The speciation of the Baltic flounder species pair must have initiated no earlier than 8.5 kya, when the Baltic Sea first became connected to the North Sea.  #@NEW_LINE#@#  Other ecological speciation events have been recorded over similar time frames (less_than10,000 y), but such events involve species that reach sexual maturity within 1 or 2 y and none are from marine environments (32, 33).  #@NEW_LINE#@#  Hence, in terms of number of generations, speciation of the Baltic flounder species has likely happened faster than in those examples.  #@NEW_LINE#@#  To the best of our knowledge, this would place the speciation of the Baltic flounder species pair as one of the most rapid events of ecological speciation, and the fastest speciation event ever recorded for a marine vertebrate.  #@NEW_LINE#@#  

Conservation_Implications  #@NEW_LINE#@#  
The discovery that European flounders in the Baltic Sea represent a pair of closely related species calls for a reassessment of the species pairs conservation status by the International Union for the Conservation of Nature.  #@NEW_LINE#@#  The fact that both species co-occur during feeding in a part of their range suggests that harvesting should be managed within the framework of a multispecies fishery.  #@NEW_LINE#@#  
Climate change is predicted to increase freshwater runoff in the Baltic Sea, causing a reduction in salinity and hence contracting the distribution of many marine species by hundreds of kilometers (39).  #@NEW_LINE#@#  At the same time, eutrophication and climate change are causing a rapid increase in hypoxia and anoxia in bottom waters where salinity is suitable for pelagic spawning (40).  #@NEW_LINE#@#  Consequently, the spawning habitat of pelagic flounders, which is already geographically limited, will likely contract in the future, raising concerns over a possible local extinction of this species.  #@NEW_LINE#@#  The endemic demersal spawners might prove more resilient, despite local declines of northern populations (41), but could experience a possible southward range shift.  #@NEW_LINE#@#  Young species pairs arising from recent events of ecological speciation may be prone to species collapse if anthropogenic activities alter the very factors that led to speciation, a process known as reverse speciation (42).  #@NEW_LINE#@#  It is possible that a decrease in salinity in the Baltic Sea linked to climate change may provide a strong selective pressure on pelagic spawners, leading to a second behavioral shift to demersal spawning and the collapse of this species pair.  #@NEW_LINE#@#  


Methods  #@NEW_LINE#@#  
Sampling  #@NEW_LINE#@#  
A total of 282 samples was collected from 13 locations spanning nearly the entire distribution of European flounders in the Baltic Sea, including samples from the North Sea and the transition zone between the two regions.  #@NEW_LINE#@#  Sample collection took place in 20022004, 2009, and 2012.  #@NEW_LINE#@#  Details of sampling locations are given in Table S1.  #@NEW_LINE#@#  Most samples were collected at the time of spawning in either coastal locations (targeting demersal spawners) or offshore spawning grounds (targeting pelagic spawners).  #@NEW_LINE#@#  In Bornholm and Öland, almost all individuals (100% and 92%, respectively) were spawning during sampling in a pelagic (Bornholm) and coastal benthic (Öland) environment.  #@NEW_LINE#@#  Hence, samples from these two locations can be used as references to test for genetic differentiation among flounders exhibiting contrasting spawning behaviors.  #@NEW_LINE#@#  In some locations (Gdynia, Dabki, and Hanko; Fig 1), sampling took place shortly after spawning (Table S1).  #@NEW_LINE#@#  Samples from Swedish waters were collected under a permit issued by the Swedish Board of Fisheries and samples from Hanko under a permit granted by Tvärminne Zoological Station (University of Helsinki).  #@NEW_LINE#@#  Samples from other locations were obtained from commercial fisheries.  #@NEW_LINE#@#  The described scientific sampling did not require ethical permission according to the Finnish Animal Conservation Law (7§ 28.6.2013/498).  #@NEW_LINE#@#  

SNP_Genotyping  #@NEW_LINE#@#  
DNA was extracted from fin clips or muscle tissues using either a standard salting out protocol or a DNeasy Blood and Tissue Kit (Qiagen).  #@NEW_LINE#@#  Library preparation and sequencing was carried out by Diversity Arrays Technology Pty Ltd using the standard DArTSeq.  #@NEW_LINE#@#  DArTSeq is a SNP genotyping-by-sequencing approach that combines genome complexity reduction via double-enzymatic digestion characteristic of DArT markers and sequencing on Illumina platforms (43).  #@NEW_LINE#@#  We initially tested four pairs of enzymes for complexity reduction and selected the PstI and SphI combination.  #@NEW_LINE#@#  Library preparation and sequencing were carried out as per Booksmythe et al.  #@NEW_LINE#@#  (44).  #@NEW_LINE#@#  Libraries were sequenced on three lanes of an Illumina Hiseq2000 platform.  #@NEW_LINE#@#  De novo assembly and SNP calling was performed using the pyRAD pipeline (45), using a minimum read depth of 10, a maximum read depth equal to the mean read depth plus two times the SD, a clustering threshold of 0.94, the strict quality filtering option, a minimum coverage of 95% of sampled individuals, and a maximum of five SNPs per locus.  #@NEW_LINE#@#  Only one random SNP per locus was retained for further analyses to avoid creating a set of tightly linked markers.  #@NEW_LINE#@#  We carried out the entire procedure, from library preparation to SNP calling, a second time for 60 technical replicates and retained only biallelic loci with 100% reproducibility (i.e., no genotyping errors).  #@NEW_LINE#@#  Loci that deviated from HardyWeinberg equilibrium in at least three locations (one representative of each genetic cluster: KAT from the North Sea and at least one demersal and one pelagic Baltic locations) were removed.  #@NEW_LINE#@#  

Analyses  #@NEW_LINE#@#  
A PCA on allele frequency data was performed in the R package adegenet (46).  #@NEW_LINE#@#  The analysis was repeated after removing loci from the right and left 5% tails of the FST distributions obtained when comparing the main genetic clusters (North Sea, Baltic pelagic, and Baltic demersal).  #@NEW_LINE#@#  This neu-tral dataset should not include loci under strong divergent or stabilizing selection and should therefore be reflective of demographic processes such as genetic drift and migration.  #@NEW_LINE#@#  Genetic structure was further investigated using fastSTRUCTURE (47) and a DAPC (48).  #@NEW_LINE#@#  The most likely number of genetic clusters was determined by (i) running fastSTRUCTURE at multiple numbers of K using fivefold cross-validation and comparing the log-marginal likelihood lower bound (LLBO) and prediction error across increasing values of K; and (ii) running K-means clustering at multiple values of K and comparing Akaike information criterion (AIC) and Bayesian information criterion (BIC), as per Jombart et al.  #@NEW_LINE#@#  (48).  #@NEW_LINE#@#  Weir and Cockerham FST among locations and their 95% CI were estimated with 100 bootstraps in the R package diveRsity (49), and geographic distance among locations was estimated as the least cost path distance over seawater in the R package marmap (50).  #@NEW_LINE#@#  An estimate of number of migrants per generation was obtained using the private allele method (23).  #@NEW_LINE#@#  Migration rates between pelagic and demersal flounders within the Baltic were estimated using BAYESASS (51).  #@NEW_LINE#@#  For the latter analyses, pelagic and demersal flounders were grouped according to the results from PCA, fastSTRUCTURE, and DAPC; we ran five independent runs, each 10 million generations long, using a burn-in of 2 million generations.  #@NEW_LINE#@#  
We used four outlier tests to look for signatures of selection: BAYESCAN (52); OutFLANK (53); the coalescent method from Beaumont and Nichols (54) implemented in the software Arlequin, version 3.5 (55) (referred to as the Fdist method); and FLK (56).  #@NEW_LINE#@#  The tests were carried out first on a dataset where the samples were grouped as two populations representing the two major genetic clusters to identify outlier loci under selection among pelagic and demersal flounders.  #@NEW_LINE#@#  The tests were then carried out on pelagic and demersal flounders separately, grouping individuals according to geographical location to look for signatures of spatially diversifying selection.  #@NEW_LINE#@#  The FLK tests were only carried out for the latter analyses, using 24 individuals from the opposite taxon as outgroup population.  #@NEW_LINE#@#  For BAYESCAN analyses, we set prior odds to 100 to minimize chances of false positives and ran 20 pilot runs, followed by 100,000 iterations (5,000 samples, a thinning interval of 10, and a burn-in of 50,000).  #@NEW_LINE#@#  For the Fdist analyses, we used the island model implemented in Arlequin in cases where hierarchical genetic structure were not discovered by previous analyses, running 100 simulated demes and 20,000 coalescent simulations.  #@NEW_LINE#@#  For the detection of outliers between pelagic flounders in the Baltic Sea and the North Sea, we used the hierarchical, coalescent-based approach outlined by Excoffier et al.  #@NEW_LINE#@#  (57).  #@NEW_LINE#@#  In this analysis, locations were split in three groups according to PCA results: North Sea, Baltic Pelagic, and samples from the transition zone (Barsebäck).  #@NEW_LINE#@#  We used 10 simulated groups, 100 simulated demes for each group, and ran 20,000 coalescent simulations.  #@NEW_LINE#@#  OutFLANK analyses were carried out as outlined by Whitlock and Lotterhos (53).  #@NEW_LINE#@#  FLK analyses were carried out using the R and Python codes provided by the authors (available at https://qgsp.jouy.inra.fr/).  #@NEW_LINE#@#  Loci that were identified as outliers by all tests were considered as putatively under selection.  #@NEW_LINE#@#  
Maximum-likelihood (ML) and Bayesian phylogenies were constructed using a subsample of 57 individuals (32 putative pelagic and 25 putative demersal individuals).  #@NEW_LINE#@#  The alignment included the concatenated sequences of all 2,051 loci (for a total length of 135,164 bp).  #@NEW_LINE#@#  The ML Smart Model Selection (SMS) approach implemented in PHYML (58) was used to identify the evolutionary model (GTR+G), and ML and Bayesian phylogenetic analyses were carried out using the software PHYML (58) and MrBayes (59).  #@NEW_LINE#@#  ML analysis was performed using 100 bootstraps, 10 random starting trees and tree improvement by using the best of the nearest-neighbor interchange and subtree pruning and regrafting.  #@NEW_LINE#@#  Bayesian analyses were run for 3 million generations using two independent runs and 32 chains for each run.  #@NEW_LINE#@#  Convergence among runs was tested by checking SD of split frequencies fell below 0.05, and stability of each parameter was visually checked using the software TRACER (60).  #@NEW_LINE#@#  Convergence was reached around 2 million generations, and therefore any tree sampled before then was discarded.  #@NEW_LINE#@#  
We evaluated possible divergence scenarios and past demographic events under an ABC framework (see Supporting Information for a detailed description).  #@NEW_LINE#@#  We formulated competing scenarios describing the demographic history of P. flesus in the North Sea and the Baltic Sea (Fig 5 and Table S5) and simulated datasets under these scenarios using the software DIYABC, version 2.1.0 (61).  #@NEW_LINE#@#  Model choice was performed using the recently developed ABC-RF approach (28) to evaluate the most probable scenario corresponding to our data, as well as its associated posterior probability.  #@NEW_LINE#@#  After ensuring the stability of model choice results for several demographic parameters (Fig 5 and Tables S5S9), we estimated divergence time for both demersal and pelagic flounders using the parameter estimation analysis implemented in DIYABC on the 1% closest simulated data.  #@NEW_LINE#@#  The adequacy of our final model was tested by performing the model-posterior checking analysis implemented in DIYABC (Fig S4).  #@NEW_LINE#@#  


Inference_of_Platichthys_flesus_Evolutionary_History_Through_Approximate_Bayesian_ComputationRandom_Forest  #@NEW_LINE#@#  
Formulation_of_Competing_Scenarios  #@NEW_LINE#@#  
Approximate Bayesian computation (ABC) is a methodological framework allowing to test for multiple evolutionary scenarios using molecular data (22, 29).  #@NEW_LINE#@#  ABC relies on the simulation of large number of datasets matching a finite set of competing scenarios and summarized with a pool of summary statistics.  #@NEW_LINE#@#  Simulated datasets are subsequently compared with the observed dataset to estimate approximate posterior probabilities of the most probable scenario (i.e., the most likely evolutionary history of the focal populations).  #@NEW_LINE#@#  ABC inference has become widely used in population genetics, spanning over diverse fields of research including anthropology (63) and invasion biology (64).  #@NEW_LINE#@#  Here, it was used to investigate the evolutionary history of P. flesus.  #@NEW_LINE#@#  
The evolutionary and demographic histories of the three flounder lineages identified in this study are potentially complex; they may have involved multiple past changes in effective population size, and a number of different divergence scenarios are thinkable.  #@NEW_LINE#@#  Nevertheless, these possible evolutionary scenarios are all variations of two main evolutionary models: a single-invasion scenario and a double-colonization scenario.  #@NEW_LINE#@#  The single-invasion scenario postulates that flounders colonized the Baltic Sea only once, and thereafter diverged in two distinct lineages within the Baltic Sea, either in sympatry or parapatry.  #@NEW_LINE#@#  According to the double-invasion scenario, the two Baltic Sea lineages originated via two distinct colonization events from the North Sea, and hence speciation could have started during an early allopatric phase.  #@NEW_LINE#@#  Within each of these two divergence scenarios, either the pelagic or the demersal flounders could have diverged first from the ancestral population.  #@NEW_LINE#@#  If we assume that the Baltic lineages originated from the North Sea population, we therefore have four main evolutionary scenarios, representing all possible divergence events (Fig 5 in the main manuscript and Table S5), to test.  #@NEW_LINE#@#  
Within each of these four scenarios, a number of other factors should be considered and tested to reconstruct the correct demographic history of the species pair.  #@NEW_LINE#@#  First, the ancestral population might have been itself subject to changes in effective population size.  #@NEW_LINE#@#  Tajimas D was negative and with very similar values at every location for each of the three lineages (Table S2), suggesting the ancestral population from which they originated underwent a demographic expansion.  #@NEW_LINE#@#  Both Baltic Sea lineages could have experienced weak or strong bottlenecks and demographic expansions at the time of colonization.  #@NEW_LINE#@#  Furthermore, although there is no evidence of contemporary migration between the two Baltic Sea flounder species, fastSTRUCTURE analyses suggest that, following divergence, there may have been some limited secondary introgression (specifically, from pelagic to demersal flounders; Fig S2E).  #@NEW_LINE#@#  The four basic scenarios, along with all variations that are considered, are depicted in Fig 5 in the main manuscript.  #@NEW_LINE#@#  
Here, we formulated competing scenarios corresponding to the most probable history of P. flesus populations in the North Sea and the Baltic Sea (Table S5) and used the software DIYABC, version 2.1.0 (61), to simulate datasets from each scenario based on uniformly distributed priors (Table S6 for detailed information on the priors).  #@NEW_LINE#@#  

Model_Choice  #@NEW_LINE#@#  
An inherent drawback of ABC inference is the computational effort required to simulate sufficient amounts of datasets when multiple competing scenarios are considered (65).  #@NEW_LINE#@#  Recently, Pudlo et al.  #@NEW_LINE#@#  (28) developed a new approach called ABCrandom forest (ABC-RF) to discriminate among competing models at a much less intensive computational costsee Pudlo et al.  #@NEW_LINE#@#  (28) for a detailed statistical description and Fraimout et al.  #@NEW_LINE#@#  (64) for a case study.  #@NEW_LINE#@#  Briefly, ABC-RF uses the datasets simulated for different scenarios using parameter values drawn from prior distributions and their respective summary statistics (i.e., the ABC reference table) to discriminate the most probable scenario and estimate its posterior probability.  #@NEW_LINE#@#  We used the RF classification method implemented in the R package abcrf, version 1.1 (28), to apply ABC-RF treatment on competing evolutionary scenarios.  #@NEW_LINE#@#  As suggested by Pudlo et al.  #@NEW_LINE#@#  (28), we processed a reference table of 10,000 simulations per scenario and ran the treatments for 10 iterations to ensure model choice consistency (Tables S7S9; values reported are means from 10 iterations).  #@NEW_LINE#@#  
To identify the most likely scenario, we ran a multiple-tier tournament among competing divergence and demographic models.  #@NEW_LINE#@#  In the first-tier competition, we ran simulations for each of the main four divergence scenarios (scenarios 14, Table S5) under every possible combination of the following parameters: constant ancestral Ne vs. ancestral demographic expansion, constant Ne at invasion vs. bottlenecks, and with and without secondary introgression among the two Baltic lineages (Table S6).  #@NEW_LINE#@#  We therefore had eight orthogonal combinations of the three above-mentioned parameters (each of which had two levels, i.e., 23).  #@NEW_LINE#@#  Regardless of what combination of demographic parameters was chosen, the winning scenario in every iteration of all eight random forest analyses was always scenario 1: a double-invasion scenario whereby the demersal lineage invaded the Baltic Sea first (Table S7).  #@NEW_LINE#@#  After identifying scenario 1 as the most likely divergence scenario, we ran further tournaments among versions of scenario 1 with different demographic parameters.  #@NEW_LINE#@#  
We ran a second-tier tournament to determine whether or not the two Baltic lineages underwent a bottleneck followed by a demographic expansion during and after the invasion of the Baltic Sea.  #@NEW_LINE#@#  Given the extremely low divergence of the Pelagic Baltic lineage from the North Sea population, we assumed that a very strong bottleneck of this lineage is unlikely (genetic drift is extremely low and diversity indices were very similar to other populations; Table S2); therefore, we only modeled a mild bottleneck (ancestral Ne less_than 25,000 with uniform prior distribution) for this population.  #@NEW_LINE#@#  For the demersal lineage, which shows much stronger divergence from the North Sea as well as from the Baltic pelagic population, we modeled both a strong (Ne 11,000, with a normal distributionmean Ne 500 ± 250) and mild (Ne 1,00010,000, with a normal distributionmean Ne 5,000 ± 2,500) bottlenecks.  #@NEW_LINE#@#  We compared every possible combination among these parameter levels (Table S8, scenarios 1ae) and ran simulations under all possible combinations of the remaining two still unaddressed demographic parameters (constant ancestral Ne vs. ancestral demographic expansion, and with and without secondary introgression among the two Baltic lineages).  #@NEW_LINE#@#  Under all combinations of ancestral Ne and introgression parameters, scenario 1d (no bottleneck in the pelagic lineage and a mild bottleneck in the demersal lineage) was always chosen as the most likely scenario in all 10 RF iterations, with posterior probabilities ranging from about 0.43 to nearly 0.9 (Table S8).  #@NEW_LINE#@#  Scenarios including a bottleneck in the Pelagic lineage performed consistently worse than all others.  #@NEW_LINE#@#  
In the final steps of model selection, we used the same approach to test whether there was any evidence of secondary introgression and of a demographic expansion in the ancestral population.  #@NEW_LINE#@#  Scenarios including secondary introgression (scenario 1-d-i) among Baltic lineages always performed better (they were consistently chosen in all ten RF iterations) but only marginally so, as shown by low posterior probabilities (Table S9).  #@NEW_LINE#@#  On the other hand, evidence for demographic expansion (scenario 1-d-i-e) in the ancestral population was very strong (mean posterior probability over 10 iterations, 0.993 ± 0.005; Table S9).  #@NEW_LINE#@#  Hence, the most likely scenario chosen is scenario 1-d-i-e; the colonization of the Baltic Sea lineages therefore most likely happened via a double colonization.  #@NEW_LINE#@#  The pelagic lineage did not undergo any major bottleneck event, whereas the demersal lineage underwent a mild bottleneck at the time of invasion.  #@NEW_LINE#@#  Following the invasion of the pelagic lineage, there seem to have been some secondary introgression, although evidence is not very strong.  #@NEW_LINE#@#  Finally, the ancestral population from which all lineages descend underwent a demographic expansion.  #@NEW_LINE#@#  
A reference table of 500,000 simulations was generated under scenario 1-d-i-e to estimate the posterior distribution of demographic parameters and to estimate how well the model fit the data (see next paragraphs).  #@NEW_LINE#@#  Because the right tail of the some of the demographic parameters (mostly Ne) was not fully captured with the set of priors used in the tournaments, we slightly modified the priors: we increased the upper bound the Ne to 500,000 for the North Sea and Pelagic Baltic lineage, and to 200,000 for the demersal Baltic lineage, and we used slightly wider priors for the time of divergence of the pelagic Baltic lineage (10010,000 generations, normally distributedmean, 2,000 ± 3,000) and the demersal Baltic lineage (50020,000 generations, normally distributedmean, 3,000 ± 3,000).  #@NEW_LINE#@#  

Parameter_Estimation  #@NEW_LINE#@#  
Through ABC inferences, the distribution of the demographic parameters posterior values produced under the most probable chosen scenario can be estimated.  #@NEW_LINE#@#  Here, a paramount aspect of our study is to estimate how recently did the ecological speciation process initiate.  #@NEW_LINE#@#  To specifically address this question, we estimated the posterior distribution of split time (i.e., time of divergence) from the North Sea of both pelagic and demersal flounders.  #@NEW_LINE#@#  We used the parameter estimation analysis implemented in DIYABC using all summary statistics proposed by the software, and a local linear regression of the 1% closest simulated datasets.  #@NEW_LINE#@#  We found that the Baltic demersal population diverged 2,400 generations ago (95% CI: 1,4509,110) from the ancestral North Sea population, that is, 7,200 y before present time assuming a generation time of 3 y (38).  #@NEW_LINE#@#  The Baltic pelagic population's colonization time was estimated to happen 1,490 generations ago (95% CI: 5964,780), that is, 4,470 y before present.  #@NEW_LINE#@#  

Model_Checking  #@NEW_LINE#@#  
As ABC inferences are model-based, they allow for the estimation of posterior distributions of the most probable evolutionary history from a finite set of competing scenarios.  #@NEW_LINE#@#  An important issue to be resolved in ABC is thus to estimate how well the most probable scenario fits with the observed dataset (i.e., matches the true evolutionary history).  #@NEW_LINE#@#  We used the ABC model-posterior checking method implemented in DIYABC (61) to evaluate how well our final scenario with associated parameter posterior distributions matched the observed datasetsee Cornuet et al.  #@NEW_LINE#@#  (66) and Fraimout et al.  #@NEW_LINE#@#  (64) for a detailed descriptions of the analyses.  #@NEW_LINE#@#  The principle of model-posterior checking is as follows: if a scenario-posterior combination fits the observed data correctly, then data simulated under this scenario with parameters drawn from associated posterior distributions should be close to the observed data.  #@NEW_LINE#@#  The closeness of simulated and observed datasets can be further evaluated by applying a principal-component analysis (PCA) on the total datasets (i.e., observed and simulated) and measuring the frequency at which summary statistics measured on the observed dataset are extreme with respect to the distributions of the same statistics computed from the simulated datasets (i.e., the posterior predictive distributions).  #@NEW_LINE#@#  Hence, too many observed summary statistics falling in the tails of distributions would cast serious doubts on the adequacy of the model-posterior combination to the observed dataset.  #@NEW_LINE#@#  Graphical representation of the PCA on total datasets revealed that the observed dataset points fell well within the simulated datasets produced through our final scenario (Fig S4).  #@NEW_LINE#@#  In agreement with this result, none of the 36 summary statistics associated to the simulated datasets showed signs of deviation from the observed summary statistics distribution after applying Benjamini and Hochbergs sequential correction for multiple comparisons.  #@NEW_LINE#@#  Altogether, these results show that the final scenario chosen to depict the evolutionary history of the flounder species-pair matches well the observed dataset.  #@NEW_LINE#@#  


Genome_Walking_and_Outliers'_Annotation  #@NEW_LINE#@#  
Because DArTSeq loci are fairly short (69 bp after the removal of PstI restriction site), we used an inverse-PCR (I-PCR) protocol to obtain flanking regions upstream and downstream of the eight outlier loci identified as outliers between the Baltic Sea species-pair.  #@NEW_LINE#@#  This was done to increase the chances of finding matches for the outlier loci in the public databases.  #@NEW_LINE#@#  I-PCR is a technique aimed at amplifying sequences that are flanking a known genomic region (67); it involves digestion with a restriction enzyme (usually a blunt cutter with a 4- to 6-bp-long restriction site) that does not cleave within the known region, followed by circularization of the digested product.  #@NEW_LINE#@#  The circular template is then amplified using PCR primers whose orientation is opposite to a standard PCR, often using a nested or heminested amplification protocol to increase specificity.  #@NEW_LINE#@#  
We digested genomic DNA from five individuals using, in separate experiments, three restriction enzymes that do not cleave within the known sequences: RsaI, BsaAI and HaeIII.  #@NEW_LINE#@#  A total of 150 ng of template DNA was digested in a 20-L reaction at 37 °C for 2 h, following the manufacturers instructions.  #@NEW_LINE#@#  RsaI and HaeIII digestions were heat-inactivated at 80 °C for 20 min (BsaAI cannot be heat-inactivated).  #@NEW_LINE#@#  The target fragment was circularized via self-ligation; briefly, 5 µL of digestion product was used as template in a 25-µL ligation reaction using T4 Ligase (NEB), following the manufacturers instructions.  #@NEW_LINE#@#  RsaI and Hae III digestions were ligated at room temperature for 2 h, whereas BsaAI digestions were ligated at 4 °C overnight.  #@NEW_LINE#@#  The ligated products were amplified using a heminested PCR protocol and sequenced using a commercial service (MACROGEN).  #@NEW_LINE#@#  From the obtained sequences, we designed additional primers and screened 10 individuals (5 from demersal and 5 from pelagic flounders) to both confirm the genotypes obtained via DArTSeq and to screen for further variation in the flanking region.  #@NEW_LINE#@#  We were able to obtain flanking regions from six of the eight outliers; a representative sequence of each of the two alleles for each locus was submitted to GenBank (accession numbers KY933571KY933582).  #@NEW_LINE#@#  
Genotypes retrieved from sequencing were always consistent with DArTSeq alleles.  #@NEW_LINE#@#  Four of the six outliers for which flanking regions were obtained matched protein-coding genes from the National Center for Biotechnology Information database (Table S4).  #@NEW_LINE#@#  Two loci (2178 and 3599) matched genes that have been implicated in salinity stress and sperm motility.  #@NEW_LINE#@#  Locus 2178 matched a protocadherin Fat 1-like gene; protocadherins are Ca2+-binding proteins involved in the maintenance of calcium homeostasis, cell adhesion, and signaling (68).  #@NEW_LINE#@#  Cadherin and protocadherin have been shown to be involved in acclimatization to salinity stress in teleosts (26) and oysters (25).  #@NEW_LINE#@#  Locus 3599 was found to match a dynein axonemal heavy chain 5 gene, whereby one of the SNPs identified causes an amino acid change; dyneins are a family of cytoskeletal proteins that drive the beat of eukaryotic cilia and flagella and hence have a major role in sperm motility and sperm activation (27), some of the key traits that differ between the pelagic and demersal flounders and that are considered key adaptations to the extremely low salinities of the Baltic (13).  #@NEW_LINE#@#  

Acknowledgments  #@NEW_LINE#@#  
We thank A. Stow, F. Calboli, A. Estoup, Z. Li, T. Shikano, B. Guo, and J. DeFaveri for discussion and comments.  #@NEW_LINE#@#  Thanks are due to the collectors of the 2003 samples in the study by Florin and Höglund (15).  #@NEW_LINE#@#  ABC-RF analyses were performed on the CBGP HPC and UMS 2700 OMSI computational platforms.  #@NEW_LINE#@#  This project was funded by the the Maj & Tor Nessling Foundation, the Academy of Finland (project 292737), and the Walter and Andrée de Nottbeck Foundation.  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  


