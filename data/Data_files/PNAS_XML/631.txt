article id="http://dx.doi.org/10.1073/pnas.1610206114"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Multitrait successional forest dynamics enable diverse competitive coexistence  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
Walking through any forest, one is struck by the variety of plant forms coexisting.  #@NEW_LINE#@#  Given that all plants compete for the same basic resources, why is there not a single winner?  #@NEW_LINE#@#  Our study shows that when key ingredients common to all forests are accounted forincluding disturbance events, competition for light, and two widely observed trait-based tradeoffsmodels of niche differentiation predict forests of considerably greater diversity than was previously thought possible.  #@NEW_LINE#@#  In particular, our model accurately predicts the proliferation of species occupying niche space in low light, a feature of tropical forests that motivated the so-called neutral theory of biodiversity and biogeography.  #@NEW_LINE#@#  The presented results thereby provide a platform for understanding diversity in forests worldwide.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
To explain diversity in forests, niche theory must show how multiple plant species coexist while competing for the same resources.  #@NEW_LINE#@#  Although successional processes are widespread in forests, theoretical work has suggested that differentiation in successional strategy allows only a few species stably to coexist, including only a single shade tolerant.  #@NEW_LINE#@#  However, this conclusion is based on current niche models, which encode a very simplified view of plant communities, suggesting that the potential for niche differentiation has remained unexplored.  #@NEW_LINE#@#  Here, we show how extending successional niche models to include features common to all vegetationheight-structured competition for light under a prevailing disturbance regime and two trait-mediated tradeoffs in plant functionenhances the diversity of species that can be maintained, including a diversity of shade tolerants.  #@NEW_LINE#@#  We identify two distinct axes of potential niche differentiation, corresponding to the traits leaf mass per unit leaf area and height at maturation.  #@NEW_LINE#@#  The first axis allows for coexistence of different shade tolerances and the second axis for coexistence among species with the same shade tolerance.  #@NEW_LINE#@#  Addition of this second axis leads to communities with a high diversity of shade tolerants.  #@NEW_LINE#@#  Niche differentiation along the second axis also generates regions of trait space wherein fitness is almost equalized, an outcome we term evolutionarily emergent near-neutrality.  #@NEW_LINE#@#  For different environmental conditions, our model predicts diverse vegetation types and trait mixtures, akin to observations.  #@NEW_LINE#@#  These results indicate that the outcomes of successional niche differentiation are richer than previously thought and potentially account for mixtures of traits and species observed in forests worldwide.  #@NEW_LINE#@#  

Multitrait successional dynamics enable diverse species coexistence.  #@NEW_LINE#@#  We consider a model in which plant species inhabiting a metacommunity of patches can differ in two functional traits, leaf mass per unit leaf area and height at maturation.  #@NEW_LINE#@#  (A) After a disturbance, vegetation development in a patch follows successional dynamics under height-structured competition for light.  #@NEW_LINE#@#  A, Upper shows the height of individual plants in a patch as it ages, and A, Lower shows the prevalence of species (left vertical axis and colored areas) as the probability that a patch remains undisturbed decreases (right vertical axis and black line).  #@NEW_LINE#@#  The black line therefore shows the distribution of patch ages in the metacommunity, with an average interval between disturbances of 60 y.  #@NEW_LINE#@#  After a disturbance, patches start at age 0 with a total shading of zero (A, Lower shows the successional dynamics starting from age 1 y).  #@NEW_LINE#@#  Note the log scaling of the horizontal axis.  #@NEW_LINE#@#  (B) Across the metacommunity, patches are in different successional stages, linked through seed rain.  #@NEW_LINE#@#  In this schematic illustration, patches are shown with finite size and internal horizontal structure, whereas in the model they are treated as being infinitely large and horizontally homogeneous.  #@NEW_LINE#@#  (C) Evolutionary dynamics in the two functional traits give rise to a metacommunity with a characteristic pattern of coexisting species (white circles), comprising a few early-successional fast-growing species (green and blue regions) and a high diversity of late-successional shade-tolerant species (yellow and red regions).  #@NEW_LINE#@#  Colors in A and B indicate trait combinations as shown in C.  #@NEW_LINE#@#  
Results  #@NEW_LINE#@#  
Our analyses focus on determining the coexistence patterns of trait combinations resulting from the underlying ecological model.  #@NEW_LINE#@#  The two trait-mediated tradeoffs included in our model each promote diversity, meaning that, unless mutation and immigration cease entirely, a metacommunity with a single type cannot prevent other types from invading.  #@NEW_LINE#@#  This applies when only LMA is evolving (SI Appendix, Figs.  #@NEW_LINE#@#  S4 and S5), when only HMAT is evolving (except where noted; SI Appendix, Figs.  #@NEW_LINE#@#  S6 and S7), and when both traits are evolving (SI Appendix, Figs.  #@NEW_LINE#@#  S12 and S13).  #@NEW_LINE#@#  To see how this tendency to promote diversity plays out, we assemble metacommunities under a scenario akin to that experienced in real vegetation, with new types generated via two mechanisms: through small variation arising from mutations in the trait values of the resident (or existing) types and through introduction of new residents with trait values drawn from a uniform probability distribution across the entire viable trait space (these can be thought of as dispersers from a regional species pool).  #@NEW_LINE#@#  The assembly algorithm uses a discrete time step, with each step corresponding approximately to the length of the mean interval between disturbances.  #@NEW_LINE#@#  At each step, we update the abundance of resident types via Eq.  #@NEW_LINE#@#  1, introduce new types at a minimum density, and remove resident types that have dropped below that minimum.  #@NEW_LINE#@#  Thus, only types that experience positive fitness during invasion are able to establish as residents.  #@NEW_LINE#@#  The number of mutants and immigrants introduced is drawn from a Poisson distribution, with an average rate of 0.1 and 1 per step, respectively.  #@NEW_LINE#@#  The assembly process is continued for up to 5,000 steps, after which the assembled metacommunities are functionally fully differentiated and evolutionarily stable, as indicated by a stable mean and covariance of trait values and a fitness landscape with no regions of positive fitness (Figs.  #@NEW_LINE#@#  2 and 3 and SI Appendix, Figs.  #@NEW_LINE#@#  S4S7, S12, and S13).  #@NEW_LINE#@#  Generally, we find that the ecological model enables the stable coexistence of different types across the metacommunity.  #@NEW_LINE#@#  Moreover, we find that similar trait mixtures are predicted when the rates of immigration and mutation are lowered 10-fold (SI Appendix, Figs.  #@NEW_LINE#@#  S8 and S9), indicating that mixtures primarily reflect the underlying tradeoffs.  #@NEW_LINE#@#  
Single-Trait_Evolution  #@NEW_LINE#@#  
Evolution of LMA in the model leads to stable coexistence of up to three different types (Figs.  #@NEW_LINE#@#  2A and 4).  #@NEW_LINE#@#  Embedding the tradeoff between LMA and leaf turnover rate in our physiological growth model gives rise to a demographic tradeoff between the height growth rate and shade tolerance of seedlings (SI Appendix, Fig S2B).  #@NEW_LINE#@#  In the evolved metacommunities, low-LMA strategies correspond to fast-growing, early-successional types that flourish in high-light conditions immediately following a disturbance.  #@NEW_LINE#@#  Due to their fast leaf turnover, low-LMA strategies pay high costs of leaf replacement and are intrinsically shade intolerant.  #@NEW_LINE#@#  They are unable to regenerate in older patches, where higher-LMA strategies prevail, corresponding to mid- and late-successional types.  #@NEW_LINE#@#  The exact number of LMA strategies also varies with the value of HMAT, from two strategies when plants are constrained to be short to three strategies when they are allowed to grow taller (Fig 4A).  #@NEW_LINE#@#  
Differentiation in HMAT also promotes niche diversification in the model, but through a different mechanism, allowing strategies with similar successional types (similar LMA) to coexist with one another via the partitioning of reproductive opportunity (Fig 2B).  #@NEW_LINE#@#  By reproductive opportunity, we refer to the potential of a plant with positive carbon budget to produce seeds.  #@NEW_LINE#@#  As they have similar LMA strategies, different HMAT strategies show the same patterns before maturation of seedling recruitment, growth rate, shade tolerance, and reproductive opportunity.  #@NEW_LINE#@#  However, as they begin to reproduce, species differentiate based on how much they capitalize on current reproductive opportunity vs. deferring reproduction into the future.  #@NEW_LINE#@#  These differences in reproductive allocation generate differences in growth rate and seed output among older plants (Fig 2B).  #@NEW_LINE#@#  Within a set of similar LMA strategies, there is first a period of joint establishment and growth, and then early-maturing strategies are progressively overtopped by strategies with higher HMAT (Fig 2B).  #@NEW_LINE#@#  
Importantly, we find that coexistence of different HMAT strategies is possible only once LMA exceeds a threshold (Fig 4B).  #@NEW_LINE#@#  Below that threshold, only a single strategy can be supported, whereas above it, a diversity of types can be maintained.  #@NEW_LINE#@#  The reason mixtures are easier to maintain at higher than at lower LMA values is that competitive thinning during stand development is less intense.  #@NEW_LINE#@#  The equilibrium population size in single-strategy systems tends to decrease toward higher LMA values (SI Appendix, Fig S10).  #@NEW_LINE#@#  The lower density of seeds implies a lower density of germinating seedlings and thus a lower density of plants during development of the stand.  #@NEW_LINE#@#  When the density of competitors is lower, plants shifting to reproduction take longer to be overtopped and thus have more opportunity to reproduce before they eventually die.  #@NEW_LINE#@#  
The two traits considered here not only offer alternative pathways of niche differentiation, but also have different effects on the resultant fitness landscapes.  #@NEW_LINE#@#  A fitness landscape describes whether variants with new trait combinations can invade a resident community.  #@NEW_LINE#@#  During the process of community assembly, new residents establish in positive regions of the landscape, until these disappear.  #@NEW_LINE#@#  Residents can also be competitively excluded.  #@NEW_LINE#@#  Whether the eventual metacommunities predicted by our model contain one, few, or many types results from differences in the way fitness landscapes are progressively reshaped during community assembly, which in turn reflects the way traits influence community dynamics.  #@NEW_LINE#@#  We find that differentiation in LMA creates a fitness landscape with distinct adaptive peaks, allowing only a finite number of types to coexist competitively (Fig 2A; for the pattern arising through the assembly, see SI Appendix, Figs.  #@NEW_LINE#@#  S4 and S5).  #@NEW_LINE#@#  Differentiation in HMAT, on the other hand, creates an almost flat fitness landscape (Fig 2B; for the pattern arising through the assembly, see SI Appendix, Figs.  #@NEW_LINE#@#  S6 and S7).  #@NEW_LINE#@#  This can support many more types compared with LMA.  #@NEW_LINE#@#  We use the term evolutionarily emergent near-neutrality for these flattened fitness landscapes.  #@NEW_LINE#@#  Importantly, they do not start out flat, but rather become leveled by density-dependent and frequency-dependent selection, with nonresident strategies invading at trait combinations having positive fitness and resident strategies climbing up nearby peaks through gradual evolution under directional selection (SI Appendix, Figs.  #@NEW_LINE#@#  S6 and S7).  #@NEW_LINE#@#  
The emergence of a peaked fitness landscape for LMA and a flat fitness landscape for HMAT reflects the underlying nature of the tradeoffs mediated by these traits.  #@NEW_LINE#@#  Because LMA generates a demographic tradeoff between growth rate and shade tolerance, niche differentiation occurs when these types can regenerate successfully at different patch ages (Fig 1A).  #@NEW_LINE#@#  The spacing of LMA types and the deep valley in the fitness landscape between the lower two LMA strategies in the evolved metacommunity (Fig 2A) arise because there is a substantial cost in having an LMA value only slightly higher than the resident.  #@NEW_LINE#@#  This occurs because the intrinsic dynamics of size-structured growth produce undulations in the total amount of shading at ground level, with total shading during the first wave of recruitment jumping up (Fig 1A) (24).  #@NEW_LINE#@#  As a result, species with only a marginally higher LMA are unable to recruit below the canopy of an early-successional strategy, whereas species with a substantially higher LMA are able to recruit.  #@NEW_LINE#@#  The dynamics of recruitment thereby impose a form of limiting similarity in LMA values.  #@NEW_LINE#@#  Because the amplitude of these undulations in total shading decreases with patch age (Fig 1A), the relief of the fitness landscape is more subdued around mid- and late-successional types.  #@NEW_LINE#@#  In contrast to LMA, HMAT does not generate deep valleys or limiting similarity in the fitness landscape.  #@NEW_LINE#@#  Having the same LMA (and thereby the same potential growth rate and shade tolerance), plants differing only in their HMAT strategies establish at the same time.  #@NEW_LINE#@#  Any undulations in total shading thus impact similarly on species during establishment, irrespective of HMAT.  #@NEW_LINE#@#  Coexistence of different HMAT types then becomes possible when the shorter species are able to produce sufficient seed to survive into the next generation, despite being overtopped by species with greater HMAT.  #@NEW_LINE#@#  Nothing in the shading profile or dynamics prevents two species from maturing at similar heights.  #@NEW_LINE#@#  

Two-Trait_Evolution  #@NEW_LINE#@#  
When LMA and HMAT coevolve, differentiation in both produces a metacommunity with a limited number of early- and midsuccessional strategies and a larger number of late-successional, shade-tolerant trees and shrubs (Figs.  #@NEW_LINE#@#  1, 2C, and 3).  #@NEW_LINE#@#  Except for the lowest-LMA strategythe first to reach its evolutionary attractorthe trait values favored when the traits coevolve cannot be inferred either from the evolution of each trait in isolation (Fig 4) or from the fundamental niche space given by the fitness landscape before competition begins (Fig 3A).  #@NEW_LINE#@#  The tendency remains for differentiation in HMAT to occur only at higher LMA values.  #@NEW_LINE#@#  However, coexistence in the HMAT dimension becomes possible at lower values of LMA than when the traits are evolving in isolation (Fig 4).  #@NEW_LINE#@#  This occurs because the presence of lower-LMA strategies in the metacommunity reduces the abundance of the high-LMA types and thus the intensity of competition within the high-LMA populations.  #@NEW_LINE#@#  As noted above, it is this reduced competitive intensity within the recruiting cohort that potentially allows for the partitioning of reproductive opportunity.  #@NEW_LINE#@#  Also, the possibility for strategies with lower HMAT to invade arises only once the tallest late-successional strategy has neared its attractor (Fig 3 E and F).  #@NEW_LINE#@#  
Joint evolution of the two traits crucially modifies the number of types that can be maintained.  #@NEW_LINE#@#  As when each trait evolves in isolation, the range of supported LMA types is still low, with three broad types emerging (Fig 2C).  #@NEW_LINE#@#  Within the type with highest LMA, there is a subtle negative covariation between LMA and HMAT.  #@NEW_LINE#@#  Still, the high-LMA strategies are overall tightly clustered along the LMA axis.  #@NEW_LINE#@#  Compared with when HMAT evolves in isolation, the range of supported HMAT types is lower.  #@NEW_LINE#@#  Nevertheless, the evolved metacommunity has a concentration of types within the late-successional group.  #@NEW_LINE#@#  A nearly level plateau is generated in the fitness landscape at high LMA and across a range of HMAT (Figs.  #@NEW_LINE#@#  2C and 3).  #@NEW_LINE#@#  Once the plateau has been generated, the nearly flat fitness landscape makes competitive advantage very weak, so further competitive exclusion proceeds extremely slowly.  #@NEW_LINE#@#  

Environmental_Factors  #@NEW_LINE#@#  
So far, we have focused on the functional composition and diversity of a metacommunity experiencing environmental conditions similar to those of tropical forests (high site productivity and intermediate disturbance interval), because this is where previous niche models seemed least satisfying.  #@NEW_LINE#@#  We now expand our results from this focus: Fig 5 shows how, by varying the disturbance interval and site productivity, our model readily generates a much wider variety of trait mixtures and metacommunities, via the same fundamental set of processes.  #@NEW_LINE#@#  
Across the range of metacommunities that result, several features are notable.  #@NEW_LINE#@#  First, mean trait values shift across the environmental space (Fig 5 A and B).  #@NEW_LINE#@#  Lower LMA values are favored in locations with higher productivity and shorter disturbance intervals, whereas higher HMAT values are favored in locations with higher productivity and longer disturbance intervals.  #@NEW_LINE#@#  Second, the number of successional types (LMA values) drops from three down to two and then to one as disturbances become more frequent, such that shade-tolerant types are absent at locations with shortest intervals between disturbances (SI Appendix, Fig S13).  #@NEW_LINE#@#  Third, metacommunities occurring on productive sites that are infrequently disturbed lack the diversity of late-successional species that arise at intermediate disturbance intervals, thus resembling tall temperate forests (Fig 5E).  #@NEW_LINE#@#  Fourth, diversity is highest within the last successional type, irrespective of whether the metacommunity comprises one, two, or three successional types.  #@NEW_LINE#@#  As before, these diversity hotspots in trait space correspond to plateaus of evolutionarily emergent near-neutrality (SI Appendix, Fig S13).  #@NEW_LINE#@#  Also, in more frequently disturbed metacommunities, coexistence of different HMAT strategies becomes possible at lower values of LMA.  #@NEW_LINE#@#  This occurs because the relative value of the seed output that plants can produce before being overtopped increases as disturbances become more frequent, even if competitive intensity within the first successional type is still high.  #@NEW_LINE#@#  

Sensitivity_Analysis  #@NEW_LINE#@#  
Overall, we find that our results are robust to changes in model parameters.  #@NEW_LINE#@#  In SI Appendix, Figs.  #@NEW_LINE#@#  S11, S14, and S15 show how parameter changes affect mainly the quantitative details of the evolved trait mixtures, while leaving the qualitative features of the reported coexistence patterns mostly unaffected.  #@NEW_LINE#@#  In particular, we find that reducing the maximum allocation to reproduction does not change the tendency for coexistence of different HMAT types on a flat fitness landscape when HMAT evolves alone (SI Appendix, Fig S11).  #@NEW_LINE#@#  When both traits evolve together, we find that reducing the maximum allocation to reproduction causes a narrower range of HMAT strategies to be maintained, but these still exist within a cluster of strategies on a relatively flat plateau of the fitness landscape (SI Appendix, Fig S15).  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
Although niche differentiation is widely regarded as a key process maintaining diversity in forests, models based on successional niche differentiation have so far been unable to demonstrate how more than a few functional types can stably coexist; in particular, they have predicted only a single late-successional type (6, 1518).  #@NEW_LINE#@#  The fact that such niche models could not explain why niches are more finely partitioned under low-light conditions than under high-light conditions (ref.  #@NEW_LINE#@#  19, p. 169) has provided continued motivation for an alternative neutral theory of biodiversity and biogeography based on the controversial assumption of fitness equivalence (11, 19, 37).  #@NEW_LINE#@#  However, our results suggest that this perception of successional niche differentiation being able to support only a few strategies may have arisen only because previous models lacked critical features of real forestsmost importantly, the ability of species to differentiate in traits influencing both seedling growth rate and reproductive allocation.  #@NEW_LINE#@#  Here we have demonstrated that when these features are added, successional niche models can indeed account for the relatively denser occupation of niche space in low light, as well as for other empirically observed patterns of forest structure, such as the shifts in trait mixtures along environmental gradients.  #@NEW_LINE#@#  These results highlight the importance of successional dynamics and trait-mediated tradeoffs in shaping forest diversity.  #@NEW_LINE#@#  Additionally, our eco-evolutionary framework for modeling forest composition bridges to, and potentially enhances, models of ecosystem function, the neutral theory of biodiversity, and trait-based approaches in ecology.  #@NEW_LINE#@#  
Multiple_Axes_of_Successional_Differentiation  #@NEW_LINE#@#  
Coexistence of different strategies in our model, which occurs at the metacommunity level, becomes possible as species specialize in growing or reproducing in patches of particular ages within the successional process.  #@NEW_LINE#@#  A distribution of patch ages in the metacommunity is thus essential for stable coexistence.  #@NEW_LINE#@#  Under different environmental conditions, a variety of vegetation types emerge from the same successional processes (Fig 5).  #@NEW_LINE#@#  But if disturbance is removed, the metacommunity collapses to a single patch and the opportunity for coexistence disappears.  #@NEW_LINE#@#  
The two traits we have studied offer distinct mechanisms of successional differentiation.  #@NEW_LINE#@#  Differences in LMA produce different successional types (i.e., strategies differing in growth rate and shade tolerance), whereas differences in HMAT allow for differentiation within a successional type.  #@NEW_LINE#@#  Previously, it has been recognized that the widely cited competitioncolonization tradeoff actually entails two distinct tradeoffs, one involving differences in the ability of species to colonize vacant patches and another involving differences in their ability to grow in high vs. low light (8).  #@NEW_LINE#@#  Here, we have identified a third dimension of differentiation in the maturation schedule of larger plants having the same seedling demography.  #@NEW_LINE#@#  Also, we have shown how the latter two dimensions potentially interact to shape diversity (Figs.  #@NEW_LINE#@#  2 and 4).  #@NEW_LINE#@#  Our results demonstrate how joint differentiation in LMA and HMAT can lead to metacommunities exhibiting the archetypal structure of most tropical forests (4, 19): a limited number of early-successional, shade-intolerant strategies and a larger number of late-successional, shade-tolerant trees and shrubs (Fig 2C).  #@NEW_LINE#@#  This is exactly the feature of tropical forests that was thought unattainable by niche models (19).  #@NEW_LINE#@#  
At the same time, the finding that only a limited number of LMA types can be maintained suggests that differences in reproductive allocation (here via HMAT) may play a stronger role than differences in growth rate (here via LMA) in maintaining total species richness in forests.  #@NEW_LINE#@#  Our analysis for LMA is undoubtedly more realistic than those of earlier niche models, as we explicitly link to a prominent physiological trait as a driver of successional niche differentiation.  #@NEW_LINE#@#  However, our results for LMA are also aligned with core conclusions from earlier successional models: that successional processes can maintain only a limited number of types differing in growth rate and shade tolerance, including only a single shade-tolerant species (6, 1517).  #@NEW_LINE#@#  Increased diversity in our model becomes possible through introducing HMAT as the second trait.  #@NEW_LINE#@#  Indeed, HMAT has been proposed before as a potentially independent axis of differentiation among late-successional species (13, 14, 38).  #@NEW_LINE#@#  Our results support this view, but with the caveat that the mechanism allowing coexistence of different HMAT types still relies on the successional process.  #@NEW_LINE#@#  Furthermore, our results support the idea (13) that the higher diversity of tropical forests in part can be attributed to an absence of short, shade-tolerant types in temperate forests (compare Fig 5 EG).  #@NEW_LINE#@#  

Predicting_Trait_Mixtures_and_Vegetation_Structure  #@NEW_LINE#@#  
It is well known that coexisting plant species often exhibit a wide range of physiological traits, affecting various aspects of plant function (25, 30).  #@NEW_LINE#@#  However, it has been less clear how such trait mixtures are maintained (3, 25, 34).  #@NEW_LINE#@#  The model we have introduced and analyzed here has uncovered unique insights into what sort of mechanisms can maintain a trait mixture.  #@NEW_LINE#@#  Building on well-established empirical results (12, 26, 30), we show how mixtures for two prominent traits can be maintained through differentiation along a successional niche axis.  #@NEW_LINE#@#  Moreover, we find that the conditions enabling diversification along the two considered trait axes are at least widespread, if not universal, in forests.  #@NEW_LINE#@#  These are size-structured competition for light, a disturbance regime, and tradeoffs in plant function related to leaf turnover and reproductive allocation.  #@NEW_LINE#@#  
How much of plant trait diversity can be accounted for by successional processes remains unclear, but a wide range of traits have been implicated in such processes, including properties of leaves, seeds, wood, and xylem.  #@NEW_LINE#@#  Fundamentally, one can expect any trait influencing growth, mortality, or fecundity to have implications for successional dynamics.  #@NEW_LINE#@#  Successional processes therefore hold promise for explaining mixtures in many traits, not only with regard to LMA and HMAT.  #@NEW_LINE#@#  
The eco-evolutionary framework applied here also holds promise for predicting trait mixtures over environmental gradients, complementing previous efforts, which succeeded in using evolutionary algorithms to predict carbon allocation among roots and stems (35).  #@NEW_LINE#@#  Under different environmental conditions, our model predicts a variety of vegetation types and trait mixtures (Fig 5).  #@NEW_LINE#@#  These evolved forests capture two well-known empirical patterns whereby LMA values tend to be lower in more productive sites with shorter disturbance intervals (30, 39, 40) and plants tend to be taller on more productive sites with longer disturbance intervals (39, 41).  #@NEW_LINE#@#  
In addition, our model provides testable hypotheses about other features of vegetation for which good data are as yet lacking.  #@NEW_LINE#@#  For example, we find that the number of LMA types varies with the disturbance regime and that HMAT diversity is always highest within the last successional type, irrespective of whether the metacommunity comprises one, two, or three successional types.  #@NEW_LINE#@#  More generally, frameworks like the one used here have potential to bridge between models focusing alternatively on the function and composition of forests (42), which have until recently remained separate and largely incompatible.  #@NEW_LINE#@#  

Evolutionarily_Emergent_Near-Neutrality  #@NEW_LINE#@#  
The unified neutral theory of biodiversity (UNT) (11) was proposed as a conceptual alternative to the theory of niche differentiation, for explaining species diversity in forests and, in particular, the high diversity of late-successional types in tropical forests (19).  #@NEW_LINE#@#  Unlike niche theory, the UNT assumes that all plants are functionally identical, having equal growth rates, shade tolerance, and fitness.  #@NEW_LINE#@#  Trait differences do not affect community assembly; rather, stochastic speciation and population dynamics maintain diversity via the continual introduction of new species combined with slow competitive exclusion.  #@NEW_LINE#@#  The parameters of the UNT can be tuned so that it captures the high species diversity observed in tropical forests.  #@NEW_LINE#@#  However, to most forest ecologists, including Hubbell himself (11, 19), the core assumption of fitness equivalence on which the UNT rests seems implausible, partly for theoretical reasons (43), but mainly because coexisting species are known to vary greatly in the demographic rates contributing to fitness (4, 11, 19, 44).  #@NEW_LINE#@#  
Since its publication, multiple studies have therefore attempted either to reconcile the UNT with traditional niche-based theories of diversity (10, 4547) or to justify the assumption of fitness equivalence (19, 37, 45).  #@NEW_LINE#@#  In attempts thus far, slow competitive exclusion has been imposed on the system, rather than emerging intrinsically.  #@NEW_LINE#@#  For example in the model by Hubbell (37), strong dispersal and recruitment limitations are introduced to bring the process of competitive exclusion to a near standstill.  #@NEW_LINE#@#  Under such conditions a variety of types can be maintained, but if competitive exclusion resumes, then diversity collapses to a single type.  #@NEW_LINE#@#  How conditions of near-neutrality or slow competitive exclusion might arise in nature therefore remains hotly debated (10, 37, 45).  #@NEW_LINE#@#  
Our study goes one step farther toward reconciling niche theory and neutral theory by showing how a central assumption of the UNTfitness equivalencecan arise intrinsically as an outcome of trait-based niche differentiation.  #@NEW_LINE#@#  Importantly, the fitness equivalence arises not as a global property, but in specific regions of trait space.  #@NEW_LINE#@#  Niche differentiation is often thought of as creating a fitness landscape with distinct adaptive peaks, supporting a finite number of types that are able to persist without competitive exclusion (9, 15).  #@NEW_LINE#@#  Such a landscape does indeed result when LMA is evolving alone (Fig 2B).  #@NEW_LINE#@#  However, our model shows that fitness landscapes of quite different shapes are also possible.  #@NEW_LINE#@#  When HMAT is evolving alone, this produces a flattened fitness landscape (Fig 2B; for the emergence of this fitness landscape in the course of community assembly, see SI Appendix, Fig S7).  #@NEW_LINE#@#  When LMA and HMAT evolve jointly, a nearly level (near-neutral) plateau arises, but only in a specific region of trait space, corresponding to shade-tolerant, late-successional types (Figs.  #@NEW_LINE#@#  2C and 3).  #@NEW_LINE#@#  These plateaus in fitness landscapes are what we call evolutionarily emergent near-neutrality.  #@NEW_LINE#@#  The definition of neutrality used here is the same as that in the UNT: equivalence in per capita fitness among all individuals of every species (11, 45).  #@NEW_LINE#@#  However, evolutionarily emergent near-neutrality differs from the complete neutrality assumed in the UNT in two important ways.  #@NEW_LINE#@#  First, the flattened fitness landscape appears only toward the end of community assemblyit is a product of a competition process, not a property assumed or imposed as in the UNT (11).  #@NEW_LINE#@#  Second, evolutionarily emergent near-neutrality does not apply globally across the whole assemblage, but rather emerges in particular regions of trait space.  #@NEW_LINE#@#  The fitness landscape as a whole can thus include both peaks and plateaus.  #@NEW_LINE#@#  
The question then naturally arises whether the near-neutral fitness landscapes created via trait-based niche differentiation are sufficiently flat to enable ecological drift to contribute to the range of types and species maintained in the community.  #@NEW_LINE#@#  In general, flattened fitness landscapes slow down the process of competitive exclusion.  #@NEW_LINE#@#  When combined with demographic stochasticity, they sustain a considerably larger number of species than landscapes with steep relief and spaced peaks.  #@NEW_LINE#@#  

Generality_and_Limitations  #@NEW_LINE#@#  
Many theoretical studies have identified mechanisms that potentially promote diversity, using models with simplified population dynamics.  #@NEW_LINE#@#  In this study, we set out to investigate whether niche differentiation can generate and maintain richer trait mixtures than had previously been recognized, by making the details of the population dynamics one step more realistic.  #@NEW_LINE#@#  By linking to explicit traits, whose tradeoffs can be quantified empirically, we have also sought to increase the connection between field observations and theoretical research.  #@NEW_LINE#@#  Nevertheless, the question remains how well the dynamics of our model reflect those of real ecosystems.  #@NEW_LINE#@#  
Overall, the assumptions underlying our model seem well supported.  #@NEW_LINE#@#  The key demographic processes captured by our modeldisturbance, size-asymmetric shading, successional dynamics, and trait-mediated tradeoffs in plant functionare found in nearly all vegetation and have been applied broadly in successional models (22, 48).  #@NEW_LINE#@#  Predictions about the effects of traits on growth made using the growth model applied in this study (24) were found to be well supported in a meta-analysis of more than 100 studies (49).  #@NEW_LINE#@#  Whereas some previous theoretical models have been shown to suffer from pathologies arising from discontinuous competition kernels (17, 50), the competitive interactions in our model are not generated from a fixed kernel, but instead dynamically arise from plants shading each other, with the effects of this shading varying continuously with respect to size (via integration through photosynthesis) across the entire life cycle of a plant (SI Appendix, Fig S16).  #@NEW_LINE#@#  
However, some limitations of our approach and results should be made clear.  #@NEW_LINE#@#  Compared with previous niche models lacking size structure and traits of known importance, our approach is an improvement.  #@NEW_LINE#@#  However, we focus on competition for a single resource (light) and model abstract disturbance events that remove all vegetation.  #@NEW_LINE#@#  We also assume that competition can be described in terms of vertical spatial structure within patches without accounting for intricacies of horizontal spatial structure and that the patches in the metacommunity are equally coupled by dispersal.  #@NEW_LINE#@#  Although these are essential simplifications, they are commonly used across a number of vegetation models to render tractable the computational analysis of size-structured populations (6, 14, 22).  #@NEW_LINE#@#  Additionally, we have considered only traits involved in two tradeoffs.  #@NEW_LINE#@#  Although this is more than previously considered in niche models, species in real forests are known to vary widely in other traits involved in other tradeoffs (12, 25).  #@NEW_LINE#@#  In extending our work, it will be interesting to investigate whether the addition of extra traits further enhances the opportunities for niche differentiation reported here.  #@NEW_LINE#@#  
The parameters of the physiological growth model applied in our analysis would benefit from further empirical support and testing.  #@NEW_LINE#@#  Here, we have used a previously published parameter set (24): Although drawing on available data as much as possible, data for some parameters were limited.  #@NEW_LINE#@#  As an example, we assume that mature plants eventually allocate all surplus energy to reproduction.  #@NEW_LINE#@#  Data to test this assumption are almost entirely absent (51).  #@NEW_LINE#@#  Because we have defined surplus energy as that being left over after tissues lost via turnover are replaced, trees allocating 100% of surplus energy to reproduction still produce new cohorts of leaves and continue to expand in stem diameter.  #@NEW_LINE#@#  Moreover, we have established that our results are not sensitive to varying the parameter values used in our analysis (SI Appendix, Figs.  #@NEW_LINE#@#  S11, S14, and S15).  #@NEW_LINE#@#  In particular, we have shown that relaxing the assumption that plants shift to allocating 100% of surplus energy to reproduction does not change our core results: HMAT mixtures can be maintained when HMAT evolves alone even when we reduce the maximum fraction allocated to reproduction to as low as 20% (SI Appendix, Fig S11).  #@NEW_LINE#@#  When HMAT and LMA evolve jointly, we find that reducing the maximum fraction allocated to reproduction narrows the range of HMAT coexisting strategies, without affecting our key result of finding a cluster of strategies on a relatively flat plateau of the emergent fitness landscape (SI Appendix, Fig S15).  #@NEW_LINE#@#  

Closing_Remarks  #@NEW_LINE#@#  
Overall, our work demonstrates that when a few key ingredients common to all forests are added, successional niche models can readily produce forests of considerably higher diversity than was previously thought possible, including the particular feature of tropical forests that helped motivate the UNT: the proliferation of species occupying niche space in low light.  #@NEW_LINE#@#  We have shown how the core tradeoffs underpinning two prominent traits are sufficient to maintain stable coexistence of species differing in those traits, via distinct pathways of successional behavior.  #@NEW_LINE#@#  Finally, we have shown how niche differentiation can create regions in trait space where fitness landscapes are nearly flat and, through this evolutionarily emergent near-neutrality, promote rich patterns of coexistence enhanced by ecological drift across the resultant fitness plateaus.  #@NEW_LINE#@#  


Materials_and_Methods  #@NEW_LINE#@#  
SI Appendix, Fig S1 summarizes the processes represented in the model, and in SI Appendix, Tables S1 and S2 summarize all variables and parameters defined below.  #@NEW_LINE#@#  
Population_Dynamics  #@NEW_LINE#@#  
We consider a metacommunity of patches, with the age a of each patch corresponding to the time since its last disturbance (Fig 1).  #@NEW_LINE#@#  Disturbance events remove all plants within a patch.  #@NEW_LINE#@#  Following a disturbance, patches are colonized by seeds arriving from a global pool of dispersers; any seeds produced within the patch contribute to this global pool of dispersers.  #@NEW_LINE#@#  Different patches within the metacommunity are assumed to have similar abiotic properties and thus differ only in their age.  #@NEW_LINE#@#  The state of a metacommunity can therefore be characterized by the density distribution P of patch ages and, for each patch age, the height distribution of plants of all species within patches of that age.  #@NEW_LINE#@#  With continuous distributions, the model captures the ensemble behavior of an infinitely large number of patches and thus plants.  #@NEW_LINE#@#  
The distribution P is affected by the disturbance regime.  #@NEW_LINE#@#  We assume that disturbances are caused externally and can be described fully by the average time interval between disturbances, a^ (by default 60 y).  #@NEW_LINE#@#  Further, we let the age-dependent probability (a) of patch disturbance increase linearly with patch age a.  #@NEW_LINE#@#  Incorporating these assumptions into von Foersters equation for age-structured population dynamics (52) leads to a Weibull distribution of patch ages (53), P(a)=a^1exp(14a2/a^2), as shown in Fig 1A.  #@NEW_LINE#@#  
Competitive hierarchies among plants within developing patches are modeled by tracking the height distribution of plants as patches age after a disturbance.  #@NEW_LINE#@#  We denote by xi=(i,Hm,i) the traits of plant species i, where i is the LMA and Hm,i is the HMAT of plant species i; by x=(x0,,xK) the traits of K resident species; and by y=(y0,,yK) their average seed rain across the metacommunity (details below).  #@NEW_LINE#@#  Here traits refer to heritable characteristics of plants that are constant throughout ontogeny, in contrast to a plants height, which changes through ontogeny.  #@NEW_LINE#@#  We denote by N(H|xi,Ex,y,a) the density of plants with height H given their traits xi and a competitive environment Ex,y,a and by g(xi,H,Ex,y,a), d(xi,H,Ex,y,a), and f(xi,H,Ex,y,a) the height growth rate, death rate, and fecundity rate of those plants in that environment.  #@NEW_LINE#@#  These variables depend on the vertical profile of shading within the patch, Ex,y,a, which in turn depends on the resident traits x, the seed rains y of these resident types, and the patch age a.  #@NEW_LINE#@#  For each xi, the seed rain yi is given by the cumulative seed output across the metacommunity,yi=0P(a)0SDf(xi,H,Ex,y,a)N(H|xi,Ex,y,a)dHda,[1]where SD is the probability of offspring surviving dispersal.  #@NEW_LINE#@#  
The dynamics of the metacommunity, as described by the density distribution N, are then given by a partial differential equationaN(H|xi,Ex,y,a)=d(xi,H,Ex,y,a)N(H|xi,Ex,y,a)[2]H[g(xi,H,Ex,y,a)N(H|xi,Ex,y,a)](22, 27, 28).  #@NEW_LINE#@#  Eq.  #@NEW_LINE#@#  2 has two boundary conditions.  #@NEW_LINE#@#  The first,N(H0|xi,Ex,y,a)=yiSG(xi,Ex,y,a)g(xi,H0,Ex,y,a),[3]equates the inflow of plants at the lower bound H0 of the height distribution to the rate at which offspring are produced in the metacommunity.  #@NEW_LINE#@#  Here, SG is the probability of offspring successfully establishing themselves in a new patch, set to decrease as the growth rate of seedling declines (SI Appendix, Eq.  #@NEW_LINE#@#  S16).  #@NEW_LINE#@#  The second boundary condition states that patches are completely cleared after a disturbance,N(xi,H,Ex,y,0)=0.  #@NEW_LINE#@#  [4]  #@NEW_LINE#@#  
Plants and species interact via their influences on the vertical shading profile Ex,y,a.  #@NEW_LINE#@#  Specifically, canopy openness at height z in a patch of age a is calculated from the total leaf area above that height (54),Ex,y,a(z)=exp(cexti=1KzQ(z,H)N(H|xi,Ex,y,a)dH),[5]where Q(z,H) is the total leaf area above height z for plants of height H and cext is the light-extinction coefficient.  #@NEW_LINE#@#  

Invasion_Fitness  #@NEW_LINE#@#  
We denote by F(x,x,y) the (invasion) fitness of plants with traits x growing in a metacommunity with one or more resident strategies with traits x and seed rains y (32, 33).  #@NEW_LINE#@#  Invasion fitness is ideally calculated as the long-term per capita growth rate of the population with traits x when rare; however, in structured metacommunities, the most convenient indicator of per capita growth rate is the logarithm of the basic reproduction ratio, F(x,x,y)=log10R(x,x,y) (29), where R(x,x,y) is the average number of dispersing seeds with traits x produced by each dispersing seed.  #@NEW_LINE#@#  The trait combination x can invade when R(x,x,y)1 or equivalently F(x,x,y)0.  #@NEW_LINE#@#  
Recalling that patches of age a have frequency density P(a) in the landscape, it follows that a dispersing seed with traits x has probability P(a)da of landing in a patch of age a to a+da.The basic reproduction ratio for plants with traits x is thusR(x,x,y)=0P(a)R(x,Ex,y,a)da,[6]where R(x,Ex,y,a) is the expected number of dispersing seeds with traits x produced by a single dispersing seed with traits x arriving in a patch of age a (29).  #@NEW_LINE#@#  Here, R is calculated by integrating a plants fecundity, f(x,H,Ex,y,a), over the expected lifetime of the patch, taking into account competitive shading from residents with traits x, the plants probability of surviving, and its traits:R(x,Ex,y,a)=af(x,H(x,Ex,y,a,a),Ex,y,a)×SDSI(x,Ex,y,a,a)SP(a,a)da.  #@NEW_LINE#@#  [7]H(x,Ex,y,a,a) and SI(x,Ex,y,a,a), respectively, are the height and the cumulative survival probability at the patch age a of seeds with traits x arriving in a patch of age a, and SP(a,a) is the probability that the patch remains undisturbed from age a to a.  #@NEW_LINE#@#  

Physiological_Dynamics  #@NEW_LINE#@#  
Rates of growth, mortality, and fecundity are given by a physiological submodel specifically formulated for height-structured metacommunity models (24).  #@NEW_LINE#@#  This submodel is fully described in SI Appendix, section 1, Eqs.  #@NEW_LINE#@#  S1S16.  #@NEW_LINE#@#  The principal ingredients are (i) growth driven by carbon assimilation and light interception, (ii) an allometric model linking a plants leaf area to its height and mass of supporting tissues, (iii) a continuous vertical distribution of leaf area within the crown of each plant, (iv) net dry-matter production given by gross photosynthesis (calculated by integrating instantaneous assimilation rates in a given light profile over the annual solar environment) minus costs of tissue respiration and turnover, (v) fecundity calculated from reproductive investment and mass per seed, and (vi) an exponential increase in mortality with declining carbon income per leaf area (24).  #@NEW_LINE#@#  
The two evolving traits, LMA () and HMAT (Hm), generate demographic differences by influencing rates of net biomass production and allocation.  #@NEW_LINE#@#  The details of the trait-mediated tradeoffs are as follows.  #@NEW_LINE#@#  LMA determines the cost of deploying leaf area and is related to leaf turnover kl via an allometric relationship observed in a global dataset (30), kl=4(/(kgm2))4, with fitted parameters 4 and 4 (SI Appendix, Fig S2).  #@NEW_LINE#@#  We also vary the mass-based leaf respiration rate rl so that it stays constant per unit leaf area as LMA is varied, as is empirically observed (30), rl=rRl0/.  #@NEW_LINE#@#  HMAT affects the fraction r(H,Hm) of mass increment allocated to reproduction, varying with height H,r(H,Hm)=cr11+exp(cr2(1H/Hm)),[8]where cr1 is the maximum allocation (ranging between 0 and 1) and cr2 determines the sharpness of the transition.  #@NEW_LINE#@#  By default, we set cr1=1 and cr2=50, implying a rapid transition to reproduction at H=Hm (SI Appendix, Fig S3).  #@NEW_LINE#@#  The remaining fraction of mass increment is allocated to growth.  #@NEW_LINE#@#  

Parameters  #@NEW_LINE#@#  
We use parameter values as provided for the previously published growth model (24) (SI Appendix, Table S2).  #@NEW_LINE#@#  To vary environmental conditions, we change the mean disturbance interval, a^, and a dimensionless index of site productivity, which acts as a multiplier on the maximum photosynthesis per leaf area, cp1.  #@NEW_LINE#@#  Default values for these parameters are a^=60 y and cp1=150.36molm2y1.  #@NEW_LINE#@#  We assess the sensitivity of our results to changes in other parameters by evolving trait mixtures for parameter values at 90% and 110% of the default values (SI Appendix, Figs.  #@NEW_LINE#@#  S11, S14, and S15).  #@NEW_LINE#@#  

Numerical_Methods  #@NEW_LINE#@#  
To solve Eq.  #@NEW_LINE#@#  2, we use a refined version of the Escalator Boxcar Train (EBT) method (27, 55) powered by an embedded fourth-order RungeKutta ordinary differential equation solver.  #@NEW_LINE#@#  This solver is also used to calculate invasion fitness by numerically integrating Eqs.  #@NEW_LINE#@#  6 and 7.  #@NEW_LINE#@#  The original EBT method proceeds by introducing cohorts at fixed time intervals and then approximating the first and second moments of the density distribution N within each cohort (27).  #@NEW_LINE#@#  We extend this method by adaptively refining the time points at which new cohorts are introduced into the metacommunity.  #@NEW_LINE#@#  This is necessary to handle the strongly size-asymmetric interactions occurring in our model.  #@NEW_LINE#@#  To generate Figs.  #@NEW_LINE#@#  1 and 5, we sample from the continuous distribution N for a series of patch ages (SI Appendix, section 2).  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
We thank five anonymous reviewers and many colleagues for helpful discussions and comments on earlier versions of this paper.  #@NEW_LINE#@#  This work was supported by Australian Research Council (ARC) Grants DP110102086 and DP0877064 (to D.S.F.).  #@NEW_LINE#@#  Å.B.  #@NEW_LINE#@#  was supported by the Swedish Research Council Formas (2012-2008).  #@NEW_LINE#@#  M.W.  #@NEW_LINE#@#  was supported by a fellowship from the ARC.  #@NEW_LINE#@#  U.D.  #@NEW_LINE#@#  was supported by the European Commission, the European Science Foundation, the Austrian Science Fund, the Austrian Ministry of Science and Research, and the Vienna Science and Technology Fund.  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  




