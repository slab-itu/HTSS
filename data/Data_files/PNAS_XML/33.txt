article id="http://dx.doi.org/10.1073/pnas.1508584112"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
From residue coevolution to protein conformational ensembles and functional dynamics  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
Evolutionary-related protein sequences have been selected to preserve a common function and fold.  #@NEW_LINE#@#  Residues in contact in this conserved structure are coupled by evolution and show correlated mutational patterns.  #@NEW_LINE#@#  The exponential growth of sequenced genomes makes it possible to detect these coevolutionary coupled pairs and to infer three-dimensional folds from predicted contacts.  #@NEW_LINE#@#  But how far can we push the prediction of native folds?  #@NEW_LINE#@#  Can we predict the conformational heterogeneity of a protein directly from sequences?  #@NEW_LINE#@#  We address these questions developing an accurate contact prediction algorithm and a protein coarse-grained model, and exploring conformational landscapes congruent with coevolution.  #@NEW_LINE#@#  We find that both structural and dynamical properties can be already recovered using evolutionary information only.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
The analysis of evolutionary amino acid correlations has recently attracted a surge of renewed interest, also due to their successful use in de novo protein native structure prediction.  #@NEW_LINE#@#  However, many aspects of protein function, such as substrate binding and product release in enzymatic activity, can be fully understood only in terms of an equilibrium ensemble of alternative structures, rather than a single static structure.  #@NEW_LINE#@#  In this paper we combine coevolutionary data and molecular dynamics simulations to study protein conformational heterogeneity.  #@NEW_LINE#@#  To that end, we adapt the Boltzmann-learning algorithm to the analysis of homologous protein sequences and develop a coarse-grained protein model specifically tailored to convert the resulting contact predictions to a protein structural ensemble.  #@NEW_LINE#@#  By means of exhaustive sampling simulations, we analyze the set of conformations that are consistent with the observed residue correlations for a set of representative protein domains, showing that (i) the most representative structure is consistent with the experimental fold and (ii) the various regions of the sequence display different stability, related to multiple biologically relevant conformations and to the cooperativity of the coevolving pairs.  #@NEW_LINE#@#  Moreover, we show that the proposed protocol is able to reproduce the essential features of a protein folding mechanism as well as to account for regions involved in conformational transitions through the correct sampling of the involved conformers.  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
Contact_Predictions_via_Boltzmann_Learning  #@NEW_LINE#@#  
Entropy maximization provides a simple procedure for building a probabilistic model that is consistent with a set of available measures.  #@NEW_LINE#@#  If we know the average values {Fi} of a set of variables {xi}, the associated maximum entropy distribution is given by Pexp(iixi), with a Lagrange multiplier i for each variable xi (40).  #@NEW_LINE#@#  Fixing the frequencies for single and pairs of amino acids in a multiple sequence alignment (MSA), P takes the form (11): P({a})=Z1exp[ihi(ai)+iless_thanjJi,j(ai,aj)] over protein sequences.  #@NEW_LINE#@#  The parameters hi() and Ji,j(,) are the Lagrange multipliers that fix the averages of the model, fi() and fi,j(,), to the empirical frequencies Fi() and Fi,j(,) computed from the MSA, where  and  denote two particular amino acids and i, j two particular residues along the protein sequence.  #@NEW_LINE#@#  Due to the Boltzmann-like form of the previous equation, the parameter Ji,j(,) can be interpreted as the direct interaction between amino acids  and  at positions i and j, after the contributions from the interaction with other positions through indirect pathways have been disentangled (11, 12, 22).  #@NEW_LINE#@#  
To our knowledge, since the early work of Lapedes et al.  #@NEW_LINE#@#  (11), the numerical route of likelihood maximization via importance sampling, or Boltzmann learning (27), has not been explored, probably due to its computational complexity.  #@NEW_LINE#@#  As outlined in the introduction, this approach [see, e.g., Roudi et al.  #@NEW_LINE#@#  (41) for an extensive comparison between Boltzmann learning and various approximated schemes] has the advantage of having unbounded precision in retrieving the parameters of a maximum-entropy model.  #@NEW_LINE#@#  We tested Boltzmann learning on an assorted set of 18 proteins with varying length, from 63 to 216 residues, and different secondary structure composition (Table 1).  #@NEW_LINE#@#  For each alignment, we inferred a pairwise model by maximizing a regularized version of the log-likelihood of the sequences with respect to parameters {h} and {J} (see Materials and Methods for details).  #@NEW_LINE#@#  In all 18 cases, we were able to reproduce the empirical frequencies {F} within a reasonable error, as we checked through extensive sampling from the final models (SI Appendix, Fig S1).  #@NEW_LINE#@#  Depending on the size of the protein sequence, we obtained mean absolute relative errors |Fi,jfi,j|/Fi,j between the model pair frequencies fi,j and the empirical Fi,j ranging from 1% to 3% (0.22% for Fi,j0.01) for the different protein families.  #@NEW_LINE#@#  Being that our approach is based on importance sampling, the presence of many isolated modes in the distribution of sequences could lead to poor mixing of the Markov chain and, consequently, to a large error in the estimate of the gradient of the likelihood function.  #@NEW_LINE#@#  Indeed, clusters of sequences in multiple sequence alignments are common and are known to reflect potential functional subfamilies among the members of a single protein family (7).  #@NEW_LINE#@#  As a cross-check, we verified that the fitted models capture the organization of the original alignment in clusters of sequences (Fig 1 and SI Appendix).  #@NEW_LINE#@#  We point out that external sources of variationsuch as changes in functional requirements within the same protein familyshould be explicitly taken into account in future, improved models to discriminate between intrinsic and extrinsic correlations in the sequence alignment.  #@NEW_LINE#@#  
For each protein, from the estimated set of {J} we computed a matrix of coevolutionary couplings using a protocol first proposed by Ekeberg et al.  #@NEW_LINE#@#  (25).  #@NEW_LINE#@#  Assuming that a strong, direct coevolution is an evidence of physical contact between two residues, we finally ranked the pairs of residues using the value of coevolutionary coupling as a score.  #@NEW_LINE#@#  The accurate determination of couplings through the Boltzmann learning algorithm resulted in high-quality predictions.  #@NEW_LINE#@#  Fig 1 summarizes the performance in terms of mean precision against the top-scoring predictions rank, and as mean true positive rate as a function of false positive rate.  #@NEW_LINE#@#  We defined a pair of residues to be in contact when the distance between their C atoms (C in case of GLY) is smaller than 8 Å (42, 43), and included in the analysis all of the pairs with a sequence separation larger than four.  #@NEW_LINE#@#  For the top N predictions, where N denotes the number of amino acids in a protein structure, the algorithm obtained a mean precision of 0.67±0.03, with a maximum of 0.89 for the cNMP_binding domain (PDB ID code 3FHI).  #@NEW_LINE#@#  A comparison with predictions obtained through a more standard mean-field solution (18, 19) is included in SI Appendix.  #@NEW_LINE#@#  

A_Coarse-Grained_Model_for_Structure_Prediction_and_Conformational_Sampling  #@NEW_LINE#@#  
To take full advantage of the accurate contact predictions resulting from the Boltzmann learning algorithm, we propose a coarse-grained model that combines an all-heavy-atom description of the protein backbone with a C description of the side chains (Materials and Methods).  #@NEW_LINE#@#  Similar coarse-grained approaches have already been successfully applied to study the thermodynamics of model proteins (30).  #@NEW_LINE#@#  Because we expect the residues to be evolutionary coupled through their side chains, we set the predicted interactions to act between the C atomsi.e., the first atom to branch out of the main chain.  #@NEW_LINE#@#  More precisely, in our model we used the N best-predicted contacts, where N is the number of residues (Materials and Methods).  #@NEW_LINE#@#  Moreover, the inclusion of all of the heavy atoms of the main chain allows use of a transferable potential that acts on the actual degrees of freedom of the backbone enabling the correct reproduction of the experimental population of Ramachandran backbone angles.  #@NEW_LINE#@#  To complement long-range predictions, we estimated the helical propensity of each residue solely from the predicted contacts and translated it in a stabilizing hydrogen bond-mimicking interaction between residues i,i+4 (see SI Appendix for details).  #@NEW_LINE#@#  For all of the  and / proteins, all of the helices are correctly predicted with the exception of h1 for 3D7I, h5 for 2GJ3, and h2 for 5P21 structures (SI Appendix, Fig S2).  #@NEW_LINE#@#  
Using this simplified model, we investigated the conformational space accessible to the protein domains in Table 1.  #@NEW_LINE#@#  The nine best-predicted structures obtained in the folding runs are shown in Fig 2 superimposed to their respective native folds.  #@NEW_LINE#@#  Those structures correspond to the conformations with minimum distance RMSD of the  carbon atoms (C-dRMSD; Materials and Methods) to the native conformation.  #@NEW_LINE#@#  For all of them, not only is the global fold correctly predicted, but also most of the secondary structure elements are present and correctly packed.  #@NEW_LINE#@#  
For domains of similar size, we found a clear correlation between the precision of the contact predictions and the final dRMSD values (e.g., domains Trans_Reg_C, CMD, and PAS have lower precision in contact prediction and higher dRMSD values than other domains with a similar number of amino acids; Table 1), confirming that the precision of contacts prediction is the main determinant of the quality of the final fold reconstruction.  #@NEW_LINE#@#  However, all 18 proteins fold within 3 Å to the native protein, except for the 2GJ3 structure (PAS domain), which performs worse (Table 1 and SI Appendix, Fig S6).  #@NEW_LINE#@#  We found that the model is tolerant to both a conspicuous presence of nonnative contacts among the set of predicted contacts as well as to the absence of a large proportion of native contacts among the predicted ones.  #@NEW_LINE#@#  
To have a reference baseline to compare with, we also simulated the proteins using the same conditions but replacing the set of predicted contacts with the set of native contacts (see details in SI Appendix).  #@NEW_LINE#@#  The best dRMSDs obtained in this case are always below 2 Å (SI Appendix, Fig S6, black curve).  #@NEW_LINE#@#  These values quantify the theoretical limit of the present model with perfectly predicted contacts.  #@NEW_LINE#@#  The quality of the predicted structures is as good as those predicted by the structure-based reference simulation in several cases (HTH_31, Sigma70_r2, RRM_1, Ras).  #@NEW_LINE#@#  Interestingly, the dRMSD of the minimum energy structure (dashed curve in SI Appendix, Fig S6) does not deviate much from the absolute minimum dRMSD structure sampled in the trajectory.  #@NEW_LINE#@#  Indeed, for 17 of 18 proteins, the minimum energy structure is below 4 Å to the native structure, which indicates that the model and the contact predictions are sound and lead to a funnel-shaped energy landscape whose minimum corresponds to the crystallographic structure.  #@NEW_LINE#@#  
In the single case of the PAS domain, we observe a larger deviation, 7 vs. 3.6 Å for the dRMSD of the minimum energy structure and the absolute minimum, respectively (Table 1), which can be only partially explained by the presence of an associated cofactor in the experimental structure.  #@NEW_LINE#@#  Such a large difference indicates that though the minimum dRMSD structure still belongs to the native basin, it does not coincide with the minimum energy structure, which is the defining property of the native fold.  #@NEW_LINE#@#  Inspecting the set of predicted contacts, we found that five of them are in the dimeric interface of the corresponding homodimer (SI Appendix, Fig S7).  #@NEW_LINE#@#  After removing these interdomain contacts, the minimum energy dRMSD of the monomeric structure decreases to 4.7 Å (SI Appendix, Fig S6), showing that these few contacts were responsible for a large displacement from the native conformation.  #@NEW_LINE#@#  This result is also corroborated by the fact that when five randomly chosen false-positive contacts are removed, the dRMSD of the minimum energy structure does not improve, which we verified running 20 independent simulations (SI Appendix).  #@NEW_LINE#@#  As far as we know, the effect on fold reconstruction of strongly coupled pairs of residues at homodimeric (or homooligomeric) interfaces, when incorrectly classified as contacts in the monomeric structure, have not been described before.  #@NEW_LINE#@#  Here we show that this effect can be large, depending on the relative position of the pairs of residues at the dimer interfaces.  #@NEW_LINE#@#  Reasonably, similar but weaker effects are present for other cases, being that 10 over 18 proteins in our set were homodimeric in the corresponding PDB structure.  #@NEW_LINE#@#  The analysis demonstrates that the ability of PAS domains to form homodimers (44) is subjected to evolutionary pressure, and identifies a set of five pairs of positions involving the N-terminal helix (I40-F27; Y49-F27; A117-P35; L130-Q29; M132-A34 in the 2GJ3 PDB numbering) that emerge as crucial for the stabilization of the PAS homodimer across the protein family, as supported by their proximity in the crystal structure, strong coevolutionary coupling, and simulation.  #@NEW_LINE#@#  

Conformational_Heterogeneity_and_Residue_Coevolution  #@NEW_LINE#@#  
To investigate the ability of coevolutionary couplings to also encode for dynamical and functional information, we analyzed the conformational space close to the native fold in the case of the catalytic domain (CD) of SRC tyrosine kinase and characterized the full folding reaction of the Ras domain from a thermodynamical point of view.  #@NEW_LINE#@#  
Protein kinases are known to undergo a large conformational rearrangement of a centrally located loop during activation, called activation loop or A-loop.  #@NEW_LINE#@#  In the case of the CD of the SRC tyrosine kinase, the A-loop spans more than 20 residues, and the structural rearrangement moves the backbone across 25 Å from the inactive conformation where the A-loop is folded, to the fully active structure where the A-loop is in an extended conformation.  #@NEW_LINE#@#  The A-loop is known to be flexible to the point of being invisible in many crystal structures.  #@NEW_LINE#@#  It is thus interesting to see if traces of this conformational transition can be observed by an exhaustive sampling of the native fold basin with our model.  #@NEW_LINE#@#  We performed a 500-ns-long parallel tempering (PT) simulation of the 250 residues CD starting from the inactive conformation with the A-loop in the so-called half-closed conformation, corresponding to the structure with PDB code 2SRC.  #@NEW_LINE#@#  We used the 250 best-predicted contacts calculated over 3,812 effective sequences from PFAM Pkinase_Tyr family, without adding any structure-based bias.  #@NEW_LINE#@#  Indeed, only 130 of the 250 contacts are native contacts (where a native contact is defined between CB atoms within 8 Å in the native structure).  #@NEW_LINE#@#  Consistent with the fact that no contacts have been predicted for the A-loop, we observe an extensive sampling of the conformational space available to the loop while the rest of the protein correctly maintains the native fold.  #@NEW_LINE#@#  
In Fig 3 we compare the experimental and simulated structural flexibility of different positions along the chain.  #@NEW_LINE#@#  Even though we expect a sequence-dependent effect on structural order/disorder, we note that flexible regions (A-loop, 298303 loop and G-helix) are captured by our model with few exceptions (C-helix, G-rich loop), suggesting that chain flexibility itself is partially encoded in the sequences of the kinase protein family (SI Appendix, Fig S8).  #@NEW_LINE#@#  Indeed, these regions are known to be involved in the activation or in proteinprotein interaction (45).  #@NEW_LINE#@#  We note that flexibility cannot be trivially deducted from the number of predicted contacts involving each residue, as shown in SI Appendix, Fig S8, but is rather a consequence of the whole fold and network of interactions.  #@NEW_LINE#@#  Moreover, both the active and inactive conformations of the A-loop are repeatedly sampled within 5 Å C-RMSD to the crystal structure (SI Appendix, Fig S8).  #@NEW_LINE#@#  The ability to reach both endpoints of the complex conformational transition in the catalytic domain is very encouraging.  #@NEW_LINE#@#  
The Ras protein is a / globular protein and is a crucial mediator of cellular proliferation and differentiation involved in several signaling pathways (46, 47).  #@NEW_LINE#@#  We performed a 180-ns-long PT simulation to explore a wide range of temperatures and to have a solid sampling.  #@NEW_LINE#@#  The simulated folding transition is highly cooperative with a clear peak in the heat capacity at constant volume at the folding temperature Tf (SI Appendix, Fig S9).  #@NEW_LINE#@#  In Fig 4, we show the free energy as a function of dRMSD at three different temperatures: Tlowless_thanTf, TTf, and ThighTf.  #@NEW_LINE#@#  In the unfolded state (U), the -strands 2 and 3 are unfolded and lead to an extended tail departing from a rather structured core around the partially formed 3 and 4 helices.  #@NEW_LINE#@#  The collapse of this unfolded tail and its correct positioning lead to an intermediate, partially folded state (I, dRMSD = 6.5 Å), where helices 4 and 3 are formed.  #@NEW_LINE#@#  Eventually, the native basin (N, dRMSD = 3.8 Å) is reached with the formation of helices 3 and 5 and their correct packing by crossing a free-energy barrier of 4 kJ/mol.  #@NEW_LINE#@#  These features are not simply encoded in the native fold, because a coarse-grained C structure-based model (48) is unable to capture them (SI Appendix).  #@NEW_LINE#@#  It is interesting to note that the existence of a folding intermediate has been reported at high pressure and in denaturing conditions (49).  #@NEW_LINE#@#  Though we cannot directly compare our result with the experimental structures and the different experimental conditions, it is promising to observe the emergence of typical folding features, such as intermediate folding states, from a genomic-derived coarse-grained model.  #@NEW_LINE#@#  


Discussion_and_Outlook  #@NEW_LINE#@#  
Among proteins sharing a common ancestor, secondary and tertiary structure is generally much more conserved than protein sequence (50).  #@NEW_LINE#@#  As a result, a protein family is free to explore a large space of possible sequences while at the same time preserving a common structural framework.  #@NEW_LINE#@#  As shown by previous works (3, 4, 8, 11, 12, 1726), the information contained in sequence variability can be translated to a series of couplings between protein residues, restraining the set of conformations compatible with the observed protein sequences.  #@NEW_LINE#@#  The main objective of this paper is to study such an evolutionary-restrained space of conformations.  #@NEW_LINE#@#  We extracted the optimal couplings by forgoing unnecessary approximations and using a standard reference algorithm, Boltzmann learning (51), based on MCMC simulations of trajectories in sequence space.  #@NEW_LINE#@#  This scheme allowed us to verify, at variance with previous works, the simple but important fact that the fitted maximum-entropy models reproduce the observed correlations between residues in multiple sequence alignments.  #@NEW_LINE#@#  We developed a simplified physical model for protein dynamics, showing that the combination of accurate contact predictions and a coarse-grained yet biologically meaningful protein model allows for a full sampling of the structural ensemble associated to a protein family.  #@NEW_LINE#@#  Our simulations support the finding (19) that the structural landscape dictated by residue coevolution is dominated by the energy minimum corresponding to the native fold, which we recover with high accuracy for a set of unrelated protein domains.  #@NEW_LINE#@#  We show that the presence of conserved quaternary structure in the family, as a biologically relevant homodimer or homooligomer, can lead to misclassification of coevolving residues at the dimeric interface as contacts in the monomeric structure, compromising the quality of the folding reconstruction.  #@NEW_LINE#@#  
Furthermore, the main end of our protocol is to explore the connection between coevolutionary couplings at the residues level and protein dynamicsan issue that has been mentioned in the literature (18, 36, 52) but not directly addressed.  #@NEW_LINE#@#  We show in two significant cases that coevolutionary information can be used to reproduce and predict increasingly complex protein features: from identifying flexible regions, as in the case of SRC, to the sampling of conformers crucial for the kinase activation and function up to a full characterization of the folding reaction as in the case of the RAS protein.  #@NEW_LINE#@#  It is worth noting that in all these cases, the recovered information is not easily accessible by other approaches, such as elastic-network models or without explicit knowledge of the structures involved.  #@NEW_LINE#@#  
The approach we propose paves the way to further development in combining experimental and genomic data, going beyond the rigid structure paradigm and taking on the exploration of a protein energy landscape and its biologically relevant conformations.  #@NEW_LINE#@#  

Materials_and_Methods  #@NEW_LINE#@#  
Inference_of_Coevolutionary_Couplings_and_Contact_Predictions  #@NEW_LINE#@#  
Full MSAs for the 18 families were downloaded from the Pfam database (10).  #@NEW_LINE#@#  The alignments were filtered, removing unaligned insertions and keeping the remaining aligned positions.  #@NEW_LINE#@#  Repeated sequences, sequences containing nonnatural amino acids, or those with a fraction of gaps greater than 0.2 were removed.  #@NEW_LINE#@#  The empirical frequencies for single and pairs of amino acids were computed from the final alignments as weighted averages to account for sampling biases (see SI Appendix for details).  #@NEW_LINE#@#  The parameters {Ji,j(,)} were obtained by finding the maximum of the (l2-regularized) likelihood of the parameters as discussed in SI Appendix.  #@NEW_LINE#@#  Numerical maximization of the likelihood requires the calculation of the model frequencies, which we estimated through multiple (2064) parallel Metropolis Monte Carlo simulations, and a number of sweeps per gradient estimation ranging from 104 to 105 per simulation, depending on the system.  #@NEW_LINE#@#  The final coevolutionary couplings Ci,j between each pair of residues were calculated from the estimated coupling parameters {Ji,j(,)} using a protocol proposed by Ekeberg et al.  #@NEW_LINE#@#  (25) (see SI Appendix for details).  #@NEW_LINE#@#  

Protein_Coarse-Grained_Model  #@NEW_LINE#@#  
The protein chain is described by the heavy atoms of the backbone plus the C atoms of the side chains.  #@NEW_LINE#@#  See SI Appendix, Fig S5, Inset for a schematic illustration of all of the nonbonded potentials and the protein coarse-graining.  #@NEW_LINE#@#  The complete potential is fully described in SI Appendix and comprises contributions from the AMBER99SB-ILDN force field (53) to account for a correct backbone geometry, a nonbonded term in the form of a 12-6 LennardJones function between C atoms with parameters (r = 0.55 nm,  = 15 kJ/mol), which accounts for the coevolution predictions and an hydrogen-bond mimicking potential between O and N atoms in the form of a 12-6 LennardJones function with parameters (rON = 0.3 nm,  = 15 kJ/mol), derived from the sequence analysis, to stabilize the helices.  #@NEW_LINE#@#  The simulation protocols and the analysis methods are detailed in SI Appendix.  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
We thank the following for computing time: Partnership for Advanced Computing in Europe (PRACE) Research Infrastructure Resources MareNostrum at the Barcelona Supercomputing Center and the Institut Curie Paris at the Très Grand Centre de Calcul-CEA (FP7 RI-283493), PRACE-3IP Project FP7 RI-312763 Resources, and the HECBioSim Resource Archer.  #@NEW_LINE#@#  Support for this work was provided by Engineering and Physical Sciences Research Council Grant EP/M013898/1 (to F.L.G.)  #@NEW_LINE#@#  and the Spanish Ministry of Economy and Competitiveness (MINECO) Grant BIO2012-40205 (to A.V.  #@NEW_LINE#@#  ).  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  



