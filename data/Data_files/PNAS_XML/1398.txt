article id="http://dx.doi.org/10.1073/pnas.1721286115"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Inferring dynamic topology for decoding spatiotemporal structures in complex heterogeneous networks  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
Inferring connections forms a critical step toward understanding large and diverse complex networks.  #@NEW_LINE#@#  To date, reliable and efficient methods for the reconstruction of network topology from measurement data remain a challenge due to the high complexity and nonlinearity of the system dynamics.  #@NEW_LINE#@#  These obstacles also form a bottleneck for analyzing and controlling the dynamic structures (e.g., synchrony) and collective behavior in such complex networks.  #@NEW_LINE#@#  The novel contribution of this work is to develop a unified data-driven approach to reliably and efficiently reveal the dynamic topology of complex networks in different scalesfrom cells to societies.  #@NEW_LINE#@#  The developed technique provides guidelines for the refinement of experimental designs toward a comprehensive understanding of complex heterogeneous networks.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Extracting complex interactions (i.e., dynamic topologies) has been an essential, but difficult, step toward understanding large, complex, and diverse systems including biological, financial, and electrical networks.  #@NEW_LINE#@#  However, reliable and efficient methods for the recovery or estimation of network topology remain a challenge due to the tremendous scale of emerging systems (e.g., brain and social networks) and the inherent nonlinearity within and between individual units.  #@NEW_LINE#@#  We develop a unified, data-driven approach to efficiently infer connections of networks (ICON).  #@NEW_LINE#@#  We apply ICON to determine topology of networks of oscillators with different periodicities, degree nodes, coupling functions, and time scales, arising in silico, and in electrochemistry, neuronal networks, and groups of mice.  #@NEW_LINE#@#  This method enables the formulation of these large-scale, nonlinear estimation problems as a linear inverse problem that can be solved using parallel computing.  #@NEW_LINE#@#  Working with data from networks, ICON is robust and versatile enough to reliably reveal full and partial resonance among fast chemical oscillators, coherent circadian rhythms among hundreds of cells, and functional connectivity mediating social synchronization of circadian rhythmicity among mice over weeks.  #@NEW_LINE#@#  

Theory_and_Algorithms  #@NEW_LINE#@#  
With ICON, we study any broadly defined complex network that consists of a population of N units (agents), x1,,xN, following the dynamical law governed by the agents self-dynamics and the influence from other agents,xi(t)=f(xi)+jiKij(xi,xj),i=1,...,N,[1]where the vector xi(t)n denotes the state of agent i at time t, the function f represents the baseline dynamics, e.g., frequency, of each agent, and Kij, where i,j=1,,N, is the coupling function between agent i and j (Kij can be different from Kji).  #@NEW_LINE#@#  The dynamics, i.e., f and Kij, and thus the topology of such a directed network are problematic to infer from data, because the inherent nonlinearity within and between individual agents as well as the large-scale nature of these systems deteriorate the computational efficiency and accuracy for estimation (10); moreover, state observations may be incomplete or only partially available in practice and contaminated by intrinsic and external noise (14).  #@NEW_LINE#@#  
The central idea of our approach is to approximate the agents self-dynamics and coupling dynamics, f and Kij, respectively, by using complete orthogonal bases, e.g., the Legendre or Chebyshev polynomials, or the Fourier basis.  #@NEW_LINE#@#  Specifically, we represent each of these functions as a truncated series, i.e., f(xi)kakQk(xi) and Kij(xi,xj)kbijkPk(xi)P(xj), where {Qk}k=1 and {Pk}k=1 constitute orthonormal bases of the respective function space containing f and Kij.  #@NEW_LINE#@#  Then, the dynamical law in ref.  #@NEW_LINE#@#  1 can be expressed as (for n=1)xi(t)=kakQk(xi)+jikbijkPk(xi)P(xj),[2]where ak and bijk are the scalar coefficients, and the coupling strength ij is defined by ij=k(bijk)2.  #@NEW_LINE#@#  Following this strategy based on the orthonormal basis representation, given the measurement data (time series) of each agent i in the network, the topology estimation can be formulated as a simple linear inverse problem for each agent i, given byminz(i)y(i)A(i)z(i)2,[3]where y(i) is the data vector; A(i)M×(r2N+m) is a matrix composed of the orthonormal bases, in which M is the number of data points in the time series for agent i and r and m are the numbers of expansion terms in the truncated series {Pk} and {Qk}, respectively; and z(i) is the coefficient vector that is being determined (see SI Appendix, sections 1 and 2 for detailed formulation and examples for the case of n1).  #@NEW_LINE#@#  
Most importantly, this formulation enables independent estimation of the coupling dynamics for each individual agent in the network, so that estimating topology of very large networks becomes possible via a parallel computation architecture.  #@NEW_LINE#@#  Note that there exists a variety of techniques for solving the large-scale least squares (linear inverse) problem as in Eq.  #@NEW_LINE#@#  3 (15), for example, the truncated singular value decomposition (TSVD) for regularization of ill-conditioned matrix A(i) (15, 16), compressive sensing for very large-scale networks with sparse topology (17), and iterative methods, such as the iterative recursive thresholding and iterative shrinkage-thresholding algorithms for large-scale inverse problems with dense matrix data (18, 19).  #@NEW_LINE#@#  One may employ a specific method depending on the size and structure of the network.  #@NEW_LINE#@#  The optimized coefficient vectors z(i) for i=1,,N define the time-varying functions f and Kij in Eq.  #@NEW_LINE#@#  1, and thus identify the dynamic network topology from data.  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
Complex systems constituted by a network of rhythmic components appear in many engineered and living systems at different scales, such as circadian neurons, chemical oscillators, power grids, and animal societies (2024), in which the network emerging properties are functionally significant, such as sleepwake cycles and jet lag, battery pack chargedischarge cycles, and short-term memory and communication through social behaviors (25).  #@NEW_LINE#@#  Revealing topology and connectivity is essential to characterize the dynamical structures and functions of such networks, which, in turn, leads to the fundamental understanding of many real-world complex systems, such as functional connections in the brain, synergy of circadian clocks, and social synchronization in groups of animals.  #@NEW_LINE#@#  We apply the ICON technique to determine topology of networks of oscillators with different periodicities, degree nodes, coupling functions, and time scales, arising in silico, and in electrochemistry, neuronal networks, and groups of mice.  #@NEW_LINE#@#  The excellent agreement of the estimation with the experiments over such an extremely diverse set of systems validates our strategy and suggests that our data-driven methodology provides a general framework that can be applied to numerous additional systems of interacting dynamic units.  #@NEW_LINE#@#  
Synthetic_Networks  #@NEW_LINE#@#  
We first tested the accuracy of ICON to estimate the topology of a synthetic network with oscillatory system dynamics.  #@NEW_LINE#@#  The techniques of phase model reduction have been widely used to describe the dynamics of coupled nonlinear oscillatory systems (22, 2628), e.g., circadian clock networks.  #@NEW_LINE#@#  Here, we consider topology estimation of a network of slightly heterogeneous, weakly coupled, generalized Kuramoto-type nonlinear oscillators (26), whose dynamics are described by i(t)=i+jiKij(ij), where i[0,2) and i0 denote the phase and the natural oscillation frequency of oscillator i, respectively, and the coupling function Kij, i,j=1,,N, is 2-periodic.  #@NEW_LINE#@#  Fig 1 shows the estimation of a representative network consisting of 600 oscillatory units in the presence of white noise.  #@NEW_LINE#@#  This synthetic network (Fig 1A) was created using the above Kuramoto model, with i randomly sampled over (0,) and the coupling functions Kij, i,j=1,,600, randomly synthesized, and following the procedure presented in SI Appendix, section 2.  #@NEW_LINE#@#  The reconstructed network (represented using ij over the sampling time interval) is shown in Fig 1 A and B.  #@NEW_LINE#@#  The estimation, using the TSVD with A(i)12,000×6,001, showed excellent agreement with the true network (Fig 1 A and B) with precise recovery in the natural oscillation frequency (Fig 1C) and the coupling strength (Fig 1D), where Kij was approximated using a Fourier series of 10 terms.  #@NEW_LINE#@#  The computational time for estimating the entire network simultaneously was 381.3 min (65.3 s for estimating an agent) on a standard desktop computer (time was averaged over estimating 10 such randomly synthesized networks of 600 nodes).  #@NEW_LINE#@#  

Electrochemical_Oscillators  #@NEW_LINE#@#  
We chose a network of oscillatory chemical reactions to validate the ICON method in an experimental system where a complex coupling topology can be experimentally designed with a relatively large number of nodes.  #@NEW_LINE#@#  In this experiment, 15 corroding nickel wires immersed in sulfuric acid represent the nodes of the network; the reactions are coupled by resistors to produce the network structure (Fig 2A) (29).  #@NEW_LINE#@#  Because of inherent heterogeneities in the uncoupled network, the oscillatory reactions have slightly different frequencies on each node.  #@NEW_LINE#@#  When electrical coupling occurs through the resistors with sufficiently strong coupling, the network can exhibit synchronized oscillations.  #@NEW_LINE#@#  We applied a synchronization engineering technique with a global linear feedback (22) to desynchronize the oscillations, and recorded the relaxation of the system to the synchronized behavior (about 33 cycles of data collection, 37,600 sample points) and applied the ICON technique to reconstruct the dynamics of the system.  #@NEW_LINE#@#  
The estimated natural frequencies (Fig 2C) precisely matched (with 0.05% relative SD) the values measured in independent experiments.  #@NEW_LINE#@#  Fig 2A shows that the ICON technique identified all of the 14 existing network connections properly out of the 105 possible links.  #@NEW_LINE#@#  The technique also found two connections between nodes that were not coupled (67 and 1011).  #@NEW_LINE#@#  Because these two predicted links were weak and between nodes that were coupled indirectly through another node, the impact of such mismatches on the overall network behavior was small.  #@NEW_LINE#@#  We validated the reliability of the frequency and topology estimation by looking at the synchronization pattern at a 44% weakened coupling strength.  #@NEW_LINE#@#  At this coupling strength, the network splits into three frequency clusters with two, three, and six elements, respectively; the rest of the nodes were phase-drifting (Fig 2B).  #@NEW_LINE#@#  As shown in Fig 2D, the phase model extracted from the ICON technique (adjusted for the weakened coupling strength) properly predicted all of the pairwise synchronization indices ij between the elements, and thus properly predicts the synchronization pattern of the system.  #@NEW_LINE#@#  Such high-fidelity prediction of the spatiotemporal pattern was not previously possible, e.g., with methods based on kinetic models (29), because of the inability to extract theoretical and experimental information on the origin of heterogeneities and the timing of the interactions between the regulated chemical reactions.  #@NEW_LINE#@#  

Circadian_Neurons  #@NEW_LINE#@#  
The suprachiasmatic nucleus (SCN) of the mammalian hypothalamus has been referred to as the master circadian pacemaker that drives daily rhythms in behavior and physiology (4).  #@NEW_LINE#@#  When isolated from their network, SCN neurons can express sustained or damped circadian oscillations, or even arrhythmic patterns.  #@NEW_LINE#@#  The SCN network can be pharmacologically perturbed while monitoring the component cells for desynchronization and resynchronization of their circadian gene expression (4, 3032).  #@NEW_LINE#@#  We tested the ability of ICON to estimate the connections and coupling functions that underlie circadian resynchronization by analyzing PERIOD2 (PER2) protein levels during and after SCN explants were treated with the voltage-gated Na+ channel blocker, tetrodotoxin (TTX).  #@NEW_LINE#@#  Using recordings of PER2-driven bioluminescence (2,850 sample points) from 541 SCN cells (Fig 3A), ICON recovered a time-dependent network.  #@NEW_LINE#@#  We found that the influence of individual cells on the network resynchronization (i.e., the sum of the coupling strengths of all of its outgoing connections) varied 10-fold, depending on the cell and its location within the SCN (Fig 3 BD).  #@NEW_LINE#@#  The 14 and 16 hub cells (the cells with strong outgoing connections) identified in the left and right SCN, respectively, could indicate the presence of supercells with greater impact on circadian synchrony in the SCN.  #@NEW_LINE#@#  The coupling dynamics can be further analyzed by comparing the shape of the averaged coupling functions between different SCN regions.  #@NEW_LINE#@#  Specifically, we found similar numbers and kinds of connections within left and right SCN (Fig 3 G and H), but weaker connections between than within the two SCN (Fig 3 GI).  #@NEW_LINE#@#  Coupling functions within the bilateral dorsal SCN (Fig 3 E and J) were more similar to each other than to those in the bilateral ventral SCN (Fig 3 F and K), consistent with prior predictions based on anatomy and physiology (3336).  #@NEW_LINE#@#  We note that the averaged interaction functions often have large cosine harmonics, which results in nearly zero slope at zero phase difference.  #@NEW_LINE#@#  Such large nonisochronicity is an important oscillatory property, which was computationally predicted by a biomolecular model of the SCN (33) and supported in Fig 3 E and F.  #@NEW_LINE#@#  

Social_Synchronization_in_Groups_of_Mice  #@NEW_LINE#@#  
Social synchronization of animal and human activities is a central phenomenon that characterizes the temporal order and structures in both social and biological systems (14, 30, 37).  #@NEW_LINE#@#  We utilized ICON to reconstruct the topology of social networks of groups of cohoused laboratory mice, and to analyze and predict synchronization of their circadian rhythms within each group.  #@NEW_LINE#@#  Using previously reported recordings of body temperature of inbred female mice housed in groups of five (38) (15-min resolution over 10 d before they were grouped, 68 d of cohabitation, and 7 d after separation), we convolved the data (8,192 sample points) with the complex-valued Morlet continuous wavelet functions to measure period and amplitude over time (39).  #@NEW_LINE#@#  Daily phases of the circadian peak were determined for each mouse and then interpolated with a peak-finding approach.  #@NEW_LINE#@#  
The network estimations using ICON differed depending on the synchronization behavior of the seven recorded quintets of mice (Fig 4 and SI Appendix, section 4).  #@NEW_LINE#@#  The recorded synchronization behavior of each group of mice and predicted coordination of the inferred network, i.e., the sync indices calculated based on the experimental data (measured sync indices, red triangles in Fig 4) and the estimated phase data (estimated sync indices, blue curves in Fig 4), reliably and quantifiably identified mutual entrainment in the same cohabitating groups as demonstrated by the positive correlation between the sync index, , and the dominant eigenvalue, 2, of the Laplacian matrix of each of the seven estimated networks.  #@NEW_LINE#@#  [A relationship between sync index and 2 could be expected based on the WuChua conjecture (40), which was experimentally confirmed by electrochemical oscillators (29).]  #@NEW_LINE#@#  Moreover, our results suggest that the synchrony of such social networks was not induced by the distribution of the natural frequencies of the mice (Fig 4F), but by the interactions among mice within each quintet (Fig 4E).  #@NEW_LINE#@#  

Nonoscillatory_Networks  #@NEW_LINE#@#  
The ICON technique is not restricted to the inference of the topology of networks with oscillatory coupling dynamics.  #@NEW_LINE#@#  Fig 5 shows the estimation of a network with nonperiodic coupling dynamics consisting of 60 nonlinear dynamical units.  #@NEW_LINE#@#  This synthetic network was created using Eq.  #@NEW_LINE#@#  1, with constant self-dynamics, f(xi)=i, randomly sampled over (/2,/2), and the coupling functions Kij(xi,xj), i,j=1,,60, randomly synthesized using the procedure presented in SI Appendix, section 2, where xi(t).  #@NEW_LINE#@#  The reconstructed network (Fig 5 A and B), using TSVD, showed excellent agreement with the true network with precise recovery in both the natural oscillation frequency (Fig 5C) and the coupling strength (Fig 5D), where Kij was approximated using a 2D Fourier series of 10 terms.  #@NEW_LINE#@#  More analysis of the ICON estimation on multidimensional (n=2) nonoscillatory and larger networks (up to 30,000 agents) with respect to different network properties (e.g., sparsity and noise intensity) is provided in SI Appendix (SI Appendix, section 2 for numerical examples and SI Appendix, section 3 for robustness, reliability, and efficiency of the ICON technique).  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
In summary, we developed a unified data-driven methodology for revealing the dynamic topology of complex networks and demonstrated its validity for diverse scientific fields and scales by analyzing networks of in silico circuits, artificial chemical oscillators, cells in a tissue, and animals in a group.  #@NEW_LINE#@#  The robustness and versatility of the ICON technique applied to these four distinct systems suggests its broad applicability to determine network topology and dynamics in diverse natural and engineered systems.  #@NEW_LINE#@#  For example, prior efforts using mutual information (4) or cross-correlated activity (41) estimated the direction or strength of connectivity among cells in the SCN, but not the coupling functions.  #@NEW_LINE#@#  Most recently, a theoretical framework for how SCN cells might behave under different levels of coupling was used to support the prediction that TTX weakens coupling in the SCN (42).  #@NEW_LINE#@#  Here, ICON goes beyond categorizing coupling as either undercritical or overcritical by providing testable predictions for the direction, strength, and dynamics of all cellcell interactions in the SCN.  #@NEW_LINE#@#  The notion of the orthonormal basis representation introduced in this paper enables the linear and parallel formulation of the nonlinear topology estimation problem, which lays the foundation for analyzing real-world complex networks of tremendous size, such as brain, transportation, internet, power grids, and social networks (14, 24).  #@NEW_LINE#@#  Importantly, the ICON technique provides guidelines for the refinement of experimental designs toward a comprehensive understanding of complex heterogeneous networks.  #@NEW_LINE#@#  We note that, in this work, we assumed that the network dynamics are additive between the self-dynamics and the coupling dynamics and within the coupling dynamics, and considered the networks in the presence of white noise.  #@NEW_LINE#@#  Although these are valid assumptions in many practical scenarios, future studies should test ICON on networks that reorganize (e.g., add or lose nodes or change coupling) or have multiplicative and colored noise in their self-dynamics or coupling dynamics.  #@NEW_LINE#@#  Here, ICON was used on networks where we have some prior knowledge of the agents self-dynamics [i.e., the functional form of f(xi)] and with data recorded from nodes while the network relaxed from desynchronized to synchronized states.  #@NEW_LINE#@#  These expectations also need further evaluation.  #@NEW_LINE#@#  Ultimately, constructing reliable network topology is the essential next step for the control of collective behavior of networked systems, such as the design of entrainment waveforms for asymptotic synchronization of a nonsynchronous network, pinning controls for stabilization of an oscillatory network, or desynchronization stimulus for suppression of unwanted synchrony in brain networks.  #@NEW_LINE#@#  

Materials_and_Methods  #@NEW_LINE#@#  
See SI Appendix for detailed materials and methods.  #@NEW_LINE#@#  Detailed formulation and implementation of the ICON technique can be found in SI Appendix, sections 1 and 2.  #@NEW_LINE#@#  Especially, the detailed method for weakly coupled oscillatory networks is provided in SI Appendix, section 1.  #@NEW_LINE#@#  The robustness, reliability and efficiency of the ICON technique can be numerically validated by numerous synthetic networks, and the results are included in SI Appendix, section 3.  #@NEW_LINE#@#  The phase definition of the experimental data and the detailed analysis of the mouse and SCN data are also provided in SI Appendix, sections 2, 4, and 5, respectively.  #@NEW_LINE#@#  All SCN and mouse data came from previous publications (4, 38).  #@NEW_LINE#@#  

Acknowledgments  #@NEW_LINE#@#  
This collaboration was supported a National Academy of Science Keck Future Initiative Seed Grant for research on Collective Behavior from Cells to Societies (to G.B., E.D.H., and J.-S.L.  #@NEW_LINE#@#  ), and by the National Science Foundation (NSF) Award ECCS-1509342 (to J.-S.L.  #@NEW_LINE#@#  ), the Air Force Office of Scientific Research Grant FA9550-17-1-0166 (to J.-S.L.  #@NEW_LINE#@#  ), and National Institutes of Health Grants 1R21-EY027590-01 (to J.-S.L.  #@NEW_LINE#@#  ), U01EB021956 and NS09536702 (to E.D.H.  #@NEW_LINE#@#  ), and GM094109 (to W.J.S.).  #@NEW_LINE#@#  G.B.  #@NEW_LINE#@#  and W.J.S.  #@NEW_LINE#@#  thank Clark Way Harrison Visiting Professorships for supporting their stays at Washington University in St. Louis.  #@NEW_LINE#@#  I.Z.K.  #@NEW_LINE#@#  acknowledges support from NSF Grant CHE-1465013.  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  

This open access article is distributed under Creative Commons Attribution-NonCommercial-NoDerivatives License 4.0 (CC BY-NC-ND).  #@NEW_LINE#@#  

