article id="http://dx.doi.org/10.1073/pnas.1714070115"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Local initiation conditions for water autoionization  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
The dissociation of water is arguably the most fundamental chemical reaction occurring in the aqueous phase.  #@NEW_LINE#@#  Despite that the splitting of a water molecule very seldom occurs, the reaction is of major importance in many areas of chemistry and biology.  #@NEW_LINE#@#  Direct experimental probing of the event is still impossible and also simulating the event via accurate computer simulations is challenging.  #@NEW_LINE#@#  Here, we achieved the latter via specialized rare-event algorithms estimating rates of dissociation in agreement with indirect experimental measurements.  #@NEW_LINE#@#  Even more interestingly, by a rigorous analysis of our results we identified anomalies in the water structure that act as initiators of the reaction, a finding that suggests paradigms for steering and catalyzing chemical reactions.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
The pH of liquid water is determined by the infrequent process in which water molecules split into short-lived hydroxide and hydronium ions.  #@NEW_LINE#@#  This reaction is difficult to probe experimentally and challenging to simulate.  #@NEW_LINE#@#  One of the open questions is whether the local water structure around a slightly stretched OH bond is actually initiating the eventual breakage of this bond or whether this event is driven by a global ordering that involves many water molecules far away from the reaction center.  #@NEW_LINE#@#  Here, we investigated the self-ionization of water at room temperature by rare-event ab initio molecular dynamics and obtained autoionization rates and activation energies in good agreement with experiments.  #@NEW_LINE#@#  Based on the analysis of thousands of molecular trajectories, we identified a couple of local order parameters and show that if a bond stretch occurs when all these parameters are around their ideal range, the chance for the first dissociation step (double-proton jump) increases from 107 to 0.4.  #@NEW_LINE#@#  Understanding these initiation triggers might ultimately allow the steering of chemical reactions.  #@NEW_LINE#@#  

Results_and_Discussion  #@NEW_LINE#@#  
The autoionization event was investigated using ab initio RETIS simulations as described in Materials and Methods.  #@NEW_LINE#@#  For the RETIS simulations, we used a relatively simple geometric distance order parameter, , as illustrated in Fig 1: When the system consists of only H2O species,  is the largest covalent OH bond distance, and when the system contains OH and H3O+ species,  is taken as the shortest distance between the oxygen in OH and the hydrogen atoms in H3O+.  #@NEW_LINE#@#  In the following, we refer to the oxygen atom used for the order parameter as O.  #@NEW_LINE#@#  The type of species (OH, H2O, or H3O+) was identified by allocating to each hydrogen a single bond connecting it to the closest oxygen.  #@NEW_LINE#@#  Note that the definition of the order parameter does not require a threshold for defining a chemical bond nor does it constrain the order parameter to specific water molecules for the duration of the simulation.  #@NEW_LINE#@#  This means that we compute the rate of dissociation of any water molecule in the system instead of a single targeted OH bond or water molecule.  #@NEW_LINE#@#  
From our RETIS simulations, the water dissociation rate constant, kD, can be obtained as the product of a flux, fA, and a (conditional) probability, PA(N|0):kD=fA×PA(N|0).  #@NEW_LINE#@#  [1]Here, 0 and N are interfaces defining the initial (less_than0) and final (N) states and PA(N|0) is the probability of reaching the final state before (possibly) reentering the initial state, given that the initial interface 0 has been crossed.  #@NEW_LINE#@#  The flux, fA, is a measure of the frequency of crossings with 0.  #@NEW_LINE#@#  Since we consider the dissociation of any water molecule in our system, we have normalized fA by the number of water molecules present.  #@NEW_LINE#@#  Typically, for rare events, the crossing probability is very small and in practice, PA(N|0) is calculated by first positioning several more interfaces 0less_than1less_thanless_thanN between the initial and the final state.  #@NEW_LINE#@#  The overall crossing probability is then obtained as a product of several (history-dependent) conditional probabilities (14).  #@NEW_LINE#@#  The conditional probabilities are calculated in a separate path ensemble simulation where the [i+] path ensemble defines the collection of paths crossing i.  #@NEW_LINE#@#  The number and location of the interfaces alter the efficiency of the method, but not the results.  #@NEW_LINE#@#  
In the present case, we placed the final interface beyond the maximum distance obtainable in our system.  #@NEW_LINE#@#  All trajectories were thus propagated until the system contained only H2O species again.  #@NEW_LINE#@#  Separated ions may still recombine fast (within a few femtoseconds) even if the separation is large (16) and this observation was confirmed in our analysis (SI Appendix, Fig S1).  #@NEW_LINE#@#  To better identify and distinguish the metastable ionized states, we used path reweighting (21) to project the crossing probability on an alternative order parameter, , which equals the trajectory length (in femtoseconds).  #@NEW_LINE#@#  
In Fig 1, we show the calculated crossing probability from our simulations as a function of the order parameter.  #@NEW_LINE#@#  In principle, there are two potential mechanisms which lead to an increase of the reaction coordinate  after the first proton jump.  #@NEW_LINE#@#  The ionic species can separate further by another proton jump, the so-called Grotthuss mechanism, reassigning the H3O+ or OH ion to another oxygen and causing a sudden discontinuous increase in the reaction coordinate.  #@NEW_LINE#@#  A second possible mechanism keeps the first ionic species intact and lets them move away from each other by diffusion, yielding a more gradual increase of the reaction coordinate.  #@NEW_LINE#@#  Based on the completely flat intermediate plateau region between 1.5 Å and 3.2 Å, we can conclude that only the first mechanism is effective.  #@NEW_LINE#@#  For 3 Å, we consider  as the order parameter and we have used a threshold of 1 ps as a criterion to identify a stable dissociation event.  #@NEW_LINE#@#  This choice is rather arbitrary since there is not a clear separation of timescales for the reverse recombination reaction which would result in another flat plateau region of the crossing probability.  #@NEW_LINE#@#  With a threshold of 1 ps, the crossing probability is PA=4.0×1015.  #@NEW_LINE#@#  Combined with the initial flux, calculated to be fA=2.9×103 fs1 in our simulations, the resulting dissociation constant is kD=fA×PA=1.1×102 s1.  #@NEW_LINE#@#  An alternative rate constant not requiring any time threshold can be defined by counting the trajectories that undergo a hydrogen swap; i.e., in the last frame some of the water molecules have swapped their protons.  #@NEW_LINE#@#  The rationale behind this definition is that the proton swap must imply a significant reorganization of the hydrogen bond network so that the reverse reaction can be considered as an independent recombination reaction.  #@NEW_LINE#@#  Vice versa, the forward reaction has established a quasi-stable state since it is not followed up by a correlated reverse reaction.  #@NEW_LINE#@#  This definition yields a rate of kD=0.16 s1.  #@NEW_LINE#@#  
Comparing with experimentally determined dissociation constants at 25 °C [kD=2.5×105 s1 (7) and kD=2.04×105 s1 (8)] we overestimate the rate constant by a factor 500 (although the simulated rate will drop and gets closer to the experimental rate if a larger threshold is chosen).  #@NEW_LINE#@#  Considering all factors that play a role in the accuracy (statistical error, functional, small system size, purely classical treatment of protons, the time threshold value) the deviation with experiments is satisfactory and comparable to other density functional theory studies.  #@NEW_LINE#@#  Depending on the functionals considered in the ab initio calculation, energy barriers may be in error by 1020 kJ/mol (22) which at room temperature would already correspond to a factor 553,000 difference between experimental and theoretical rate constants.  #@NEW_LINE#@#  Still, density functional theory generally manages to reproduce trends and mechanistic information in reasonable agreement with experiments (23).  #@NEW_LINE#@#  
We also calculated the average energy of the generated trajectories as a function of the order parameter (Fig 1).  #@NEW_LINE#@#  The energy is expected to converge to the activation energy as can be derived from the temperature derivative of the rate constant (24, 25).  #@NEW_LINE#@#  We note that this activation energy gives a more direct comparison with experiments than free energy barriers which depend on the choice of order parameter.  #@NEW_LINE#@#  The activation energy obtained from the average energy of the accepted paths is approximately 17.8 kcal/mol.  #@NEW_LINE#@#  For comparison, an Arrhenius plot of the experimental data of Natzle and Moore (8) results in an activation energy of approximately 17.3 kcal/mol while Eigen and Maeyer (7) reported an activation energy between 15.5 kcal/mol and 16.5 kcal/mol.  #@NEW_LINE#@#  The deviation with our result is lower than the typical error margin mentioned above and the fact that the experimental activation barriers are lower than our simulation result, despite having lower rate constants, is rather remarkable.  #@NEW_LINE#@#  Since experimental data on this topic are at least three decades old, we hope that our finding will encourage future experimental investigations on the dissociation reaction.  #@NEW_LINE#@#  
Path sampling methods generate reactive (and nonreactive) trajectories which can be used to discover possible mechanisms and initiation conditions.  #@NEW_LINE#@#  To characterize these conditions, we considered additional collective variables, which we label =(1,2,).  #@NEW_LINE#@#  In principle, these is can be functions of all positions and momenta in the system, and they do not necessarily have simple physical interpretations.  #@NEW_LINE#@#  Since the ability to form hydrogen bonds is one of the characteristic features of water (26) and since previous computational studies have demonstrated the relevance of the hydrogen bond wire connecting the ionized species (16, 17), we have focused on a set of relatively simple collective variables which quantify the hydrogen bond network and the distortion from tetrahedral geometry.  #@NEW_LINE#@#  
The first collective variable we consider is the length of the hydrogen bond wire bridging the nascent ion species.  #@NEW_LINE#@#  Our aim is to predict the outcome of initiated trajectories and in particular the initiation conditions for reactive events.  #@NEW_LINE#@#  Thus, we cannot define the hydrogen bond wires as connecting the ionic species, since this is one of the outcomes we wish to predict.  #@NEW_LINE#@#  For a single trajectory, we define the hydrogen bond wire as the shortest wire containing the O species and i1 other water species at the first point in time when  is greater than a given threshold value, t=1.15 Å.  #@NEW_LINE#@#  Typically, this threshold is reached within 36 fs in our trajectories.  #@NEW_LINE#@#  This defines a wire containing i water species whose length, wi, is obtained as the sum of the OO distances of consecutive members.  #@NEW_LINE#@#  
In addition, we have considered the following four collective variables which describe the local structure surrounding the O species: (i) The number of hydrogen bonds accepted, na, and (ii) donated, nd, by the water species containing O; (iii) the tetrahedral order parameter, q, obtained using the angles defined by O and its four nearest oxygen atoms (27, 28) (by the definition q=1 for a perfect tetrahedral structure and q1 otherwise); and (iv) an angle order parameter, qcos, defined as the smallest of the cosine of the two internal angles in the wire.  #@NEW_LINE#@#  We refer to Materials and Methods for additional information on these collective variables.  #@NEW_LINE#@#  
After defining the extra s, we analyzed the trajectories using the predictive power method (19).  #@NEW_LINE#@#  This method begins by classifying the trajectories as reactive or nonreactive based on two thresholds r and c defined such that rc0.  #@NEW_LINE#@#  A trajectory is considered reactive if it reaches the specified r; otherwise it is considered nonreactive.  #@NEW_LINE#@#  At the first crossing point with c, we record the s and form two distributions using the reactive/nonreactive classification: rc,r(), the fraction of c-passing trajectories that cross c at a point  and reach r, and uc,r(), the fraction of c-passing trajectories that cross c at a point  but fail to reach r. These two distributions give information on the relation between the additional order parameters and the reactivity.  #@NEW_LINE#@#  For instance, if uc,r()=0, it could be that  is inaccessible, but if we can cross c at , the trajectory will be reactive.  #@NEW_LINE#@#  To quantify the importance of the different s, we calculate the predictive ability, TAc,r, defined as (19)TAc,r=11PA(r|c)rc,r()uc,r()rc,r()+uc,r()d,[2]such that 1TAc,rPA(r|c).  #@NEW_LINE#@#  If the collective variables do not correlate with reactivity, the lower limit is attained but if the s are relevant for the reaction, TAc,rPA(r|c).  #@NEW_LINE#@#  We use the ratio TAc,r/PA(r|c)1 to measure how much the predictive ability is increased when considering the extra s, compared with using the crossing probability alone.  #@NEW_LINE#@#  Note that the definition in Eq.  #@NEW_LINE#@#  2 shows that if the overlap of the two distributions is small, then the predictive ability increases.  #@NEW_LINE#@#  
We first investigated the lengths of hydrogen bond wires containing three, four, and five water molecules.  #@NEW_LINE#@#  Comparing the predictive abilities for these collective variables (respectively, w3, w4, w5) we find that w4 and w5 are more correlated with reactivity and that w4 is more relevant for larger r (SI Appendix, Fig S2).  #@NEW_LINE#@#  Thus, in the following we focus on wires containing four water molecules.  #@NEW_LINE#@#  For the water wires, we observe that when the ionic species are separated by at least two water molecules, the ionic state survives for a longer time compared with cases where they are separated by just one water molecule.  #@NEW_LINE#@#  This implies that (at least) three proton transfer events have occurred.  #@NEW_LINE#@#  We monitored the distances of the initially covalent OH bonds and show these for the first (|OH|1), the second (|OH|2), and the third (|OH|3) transferred proton in Fig 2.  #@NEW_LINE#@#  As can be expected from the Grotthuss mechanism (29, 30), the initial autoionization event is followed by several proton transfers in which the ionic species separate along the wire.  #@NEW_LINE#@#  Fig 2 shows that this can happen in both a concerted and a stepwise way: The transfer of the first and the second proton occurs almost exclusively in a concerted way, while the transfer of the third proton (if it occurs) can happen stepwise or concertedly.  #@NEW_LINE#@#  This is also reflected in the waiting time between these events (SI Appendix, Fig S3): The waiting time distribution between the second and the third proton transfer is broader compared with the first and the second transfer.  #@NEW_LINE#@#  To investigate the stability of the wires, we also calculated the hydrogen bond wire in time-reversed trajectories (SI Appendix, Fig S4).  #@NEW_LINE#@#  We find that trajectories are indeed starting and ending with a contracted wire (w4less_than7.6 Å) as reported by Hassanali et al.  #@NEW_LINE#@#  (17), but at the end these wires do not necessarily contain the same oxygen atoms.  #@NEW_LINE#@#  This might occur due to an actual breakage of the hydrogen bond wire or by a lesser disruption (for example, by a shift of the selection of four consecutive oxygens within a five-membered wire).  #@NEW_LINE#@#  The majority of the longer trajectories reform via another wire, but there are still a significant number of long trajectories (1 ps) for which the recombination is exactly the same as the dissociation path.  #@NEW_LINE#@#  This contradicts the hypothesis (16) that a breakage of the wire is a necessary condition to reach a metastable state.  #@NEW_LINE#@#  Also, visual inspection shows that relatively long trajectories exist in which the hydrogen bond wire remains intact except for some very short on/off fluctuations in the hydrogen bonds.  #@NEW_LINE#@#  We find the abovementioned hypothesis therefore difficult to defend.  #@NEW_LINE#@#  Conversely, we can also examine whether an actual breakage always leads to a long-lived metastable state.  #@NEW_LINE#@#  For this we adopt again the assumption that all trajectories with a hydrogen swap necessarily imply an indisputable breakage of the hydrogen bond wire.  #@NEW_LINE#@#  SI Appendix, Fig S5, shows that trajectories with a proton swap are on average longer, but can still be relatively short (35 fs).  #@NEW_LINE#@#  
Comparing the additional collective variables (SI Appendix, Figs.  #@NEW_LINE#@#  S6 and S7), we find that nd is less relevant than the other variables and we do not consider it further.  #@NEW_LINE#@#  The other collective variables are more correlated with reactivity and in Fig 3A, we show the predictive ability for some of their combinations.  #@NEW_LINE#@#  In Fig 3B we show TAc,r as function of r2 Å for c=1.16 Å compared with the crossing probability using several combinations of the collective variables.  #@NEW_LINE#@#  Fig 3 A and B shows that we can increase the predictive ability by a factor 107 compared with the crossing probability.  #@NEW_LINE#@#  We note that since the crossing probability is small in this case, with a TAc,r0.4, we cannot perfectly predict the outcome.  #@NEW_LINE#@#  This indicates that there are other collective variables important for the description, possibly even nonlocal ones, as suggested by Geissler et al.  #@NEW_LINE#@#  (16).  #@NEW_LINE#@#  Also, we stress that here we are focusing only on the first concerted-jump step of the reaction in which the order parameter increases from 1.16 Å to 2.0 Å.  #@NEW_LINE#@#  As is clear from Fig 1C the vast majority of trajectories reaching =2.0 Å will not lead to long-lived metastable states.  #@NEW_LINE#@#  Predicting this from the very first snapshot seems still a step too far since it depends on collisions between water molecules after many MD steps far away from the initially stretched OH bond.  #@NEW_LINE#@#  
Inspecting the initiation conditions in more detail, we investigate the reactive and nonreactive distributions rc,r() and uc,r() in Fig 4 for c=1.16 Å and r=2.0 Å.  #@NEW_LINE#@#  Here, we examine all dissociation events, even the ones that recombine quickly and show the distributions for =(w4,na) in Fig 4A [see SI Appendix, Fig S8 for the distributions for =(w4,q) and =(w4,qcos)].  #@NEW_LINE#@#  Along the w4 coordinate we observe a clear separation of the two distributions which indicates that trajectories crossing c=1.16 Å have a larger probability of being reactive for shorter wires (smaller w4).  #@NEW_LINE#@#  This supports the hypothesis of a compressed wire as an important condition for autoionization, as first suggested by Hassanali et al.  #@NEW_LINE#@#  (17).  #@NEW_LINE#@#  Along the na coordinate we observe a higher probability of reactivity for wires in which O is hypercoordinated, which was also proposed by Hassanali et al.  #@NEW_LINE#@#  (17).  #@NEW_LINE#@#  Still, the chance of not being reactive is larger at any point (w4,na) in Fig 4A [rc,r() would not be visible if it had not been normalized].  #@NEW_LINE#@#  For example, if (i) 7.15less_thanw4less_than7.6 and at the same time na=3, the probability for a reactive event is 3.6106, which is small but still a factor 58 larger than the chance to be reactive from a random point at c. In a more extreme case, if (ii) w4less_than7.3 and simultaneously na=4, the chance increases to 0.15.  #@NEW_LINE#@#  The predictive ability TAc,r provides a weighted average of these chances in which the weights are proportional to the relevance (19); since of all reactive trajectories, 45% cross c in region i and only 0.6% in region ii, the latter will have 75 times lower weight.  #@NEW_LINE#@#  
If we consider the q coordinate, we observe that rc,r is shifted toward lower q values compared with uc,r, which indicates that a distortion from a tetrahedral arrangement around the dissociating water species may also initiate the event.  #@NEW_LINE#@#  This finding is somewhat surprising as in some other aqueous phase chemical reactions the opposite effect was found (31).  #@NEW_LINE#@#  Similar conclusions can be drawn for the distribution of =(w4,qcos).  #@NEW_LINE#@#  Here, there is a peak along the qcos coordinate for the reactive distribution closer to a linear arrangement of the water molecules.  #@NEW_LINE#@#  In Fig 4B we show a representative snapshot, obtained early (after 3 fs) in a reactive trajectory.  #@NEW_LINE#@#  Overall the results shown in Fig 3 report that a compression of the water wire (measured by w4) and hypercoordination (measured by na) or distortion (measured by q and qcos) are necessary initiation conditions for autoionization.  #@NEW_LINE#@#  However, these are not sufficient conditions as shown by the values of TAc,r in Fig 3B: Still 60% of the trajectories starting off within the ideal  parameter range fail to establish a concerted proton jump.  #@NEW_LINE#@#  
Machine learning (ML) applied to path-sampling data (33, 34) is a promising approach to find important collective variables that can easily be missed by human intuition.  #@NEW_LINE#@#  To explore this possibility, we built ML models for predicting the outcome of trajectories given the state of the water system early in the trajectories.  #@NEW_LINE#@#  We focus on the same range as in the predictive power analysis and we use the state of the system, when 1.15 Å is first attained, to predict the outcome.  #@NEW_LINE#@#  We used several ML techniques in which every odd path ensemble was included in the calibration and the even path ensembles were used for the test set.  #@NEW_LINE#@#  An alternative split in which the data within each path ensemble were evenly divided in two gave similar results.  #@NEW_LINE#@#  Moreover, as heavily skewed distributions are difficult to treat with ML, we further omitted the reweighting of the datasets with the statistical weights of the corresponding path ensembles.  #@NEW_LINE#@#  However, we applied the ML techniques as a qualitative approach to find new parameters that could be tested quantitatively within the predictive power method (19).  #@NEW_LINE#@#  
In addition, to avoid a potential risk of overinterpretation we opted to restrict the complexity of the ML decision process and imposed a maximum of four order parameters when computing TAc,r.  #@NEW_LINE#@#  For instance, excellent predictive performances (90%) were obtained using the ensemble-based gradient-boosting machines (35, 36).  #@NEW_LINE#@#  However, the interpretation of the model is problematic since an ensemble of 100150 deep decision trees (added in a sequence) is used.  #@NEW_LINE#@#  Although the performance is improved, the chance of overfitting with accidental correlations increases.  #@NEW_LINE#@#  We have therefore restricted ourselves to the single-treebased decision models based on classification and regression decision trees (CART) (20).  #@NEW_LINE#@#  The restriction to four order parameters for the TAc,r function is based on similar reasons.  #@NEW_LINE#@#  Adding more parameters gives more sparse matrices representing the reactive/nonreactive distributions, and, as a result, numerical integration for computing the overlap between these distributions becomes very sensitive to the bin size and could underestimate the overlap due to bins being empty by insufficient statistics.  #@NEW_LINE#@#  
We considered 138 collective variables consisting of oxygenoxygen distances; oxygenhydrogen distances for initially bound water molecules; all angles formed by O and its four closest oxygen neighbors; and the Steinhardt order parameters of orders 3, 4, and 6 (32) (see Materials and Methods for more details).  #@NEW_LINE#@#  In addition, the order parameters already considered were added.  #@NEW_LINE#@#  Fig 5A shows the resulting decision tree.  #@NEW_LINE#@#  Remarkably, of all of the input parameters, the w4 parameter is both on top of the decision tree and the most important variable as measured by the reduction in the classification error attributed to each variable at each split in the decision tree (20) (SI Appendix, Fig S9).  #@NEW_LINE#@#  Also the tetrahedral ordering and the number of accepted hydrogen bonds appear in the decision tree.  #@NEW_LINE#@#  To describe the first effect, the ML approach prioritized the Steinhardt q4 order parameter above the similar q parameter previously used by us.  #@NEW_LINE#@#  Some distances that also appear in the decision tree like d25, the distance between O and its 25th closest oxygen, are most likely due to accidental correlations caused by the limited size of the dataset.  #@NEW_LINE#@#  This is verified by inspecting the importance of this variable: d25 does not appear among the 20 most important variables (SI Appendix, Fig S9), and, in fact, other similar variables (e.g., d24) are ranked higher, albeit with low importance.  #@NEW_LINE#@#  A more important and intuitively sound parameter that is suggested by the ML approach is 2, the OH distance between the oxygen closest to O and its hydrogen with the largest intramolecular bond.  #@NEW_LINE#@#  Recomputing the predictive ability using parameters from the ML tree (Fig 5B) did not yield higher performances than the combination w4, q, na, and qcos, but should be conceived as equally good, considering statistical uncertainties.  #@NEW_LINE#@#  

Conclusions  #@NEW_LINE#@#  
We investigated the autoionization of water at room temperature, using an unconstrained ab initio rare-event simulation method.  #@NEW_LINE#@#  Our simulations sample reactive events that happen on the timescale of minutes and we demonstrated that autoionization can be initiated by the hypercoordination of a stretched OH bond and the compression of a hydrogen bond wire as suggested by Hassalani et al.  #@NEW_LINE#@#  (17).  #@NEW_LINE#@#  However, these are not sufficient conditions.  #@NEW_LINE#@#  Only when the wire is strongly condensed (less_than7.3 Å) and the stretched OH bond accepts four hydrogen bonds, does the reaction probability become significant (0.15), but only 0.6% of the reactive trajectories start off with such extreme conditions.  #@NEW_LINE#@#  The vast majority of reactive paths start with milder initial values for these two parameters.  #@NEW_LINE#@#  In this region of parameter space the reaction probability is largely enhanced compared with an arbitrary case, but still extremely small.  #@NEW_LINE#@#  Hence, the reaction takes place when additional structural parameters have values inside the right range.  #@NEW_LINE#@#  We identified additional structural parameters which correspond to the alignment of the hydrogen bond wire and the distortion from a tetrahedral arrangement.  #@NEW_LINE#@#  Hence, we showed that the local order parameters can be used to predict the self-ionization event, although it requires a combination of several conditions.  #@NEW_LINE#@#  
Due to the multiple correlated factors that influence the water autoionization, we combined our analysis method with ML techniques which identified additional parameters not considered before, in particular the OH stretch of the oxygen closest to O.  #@NEW_LINE#@#  Even though the ML result did not outperform the level of predictiveness by the human effort based on intuition, visual inspection of many molecular movies, and intensive trial-and-error approaches, the ML approach found all previously identified parameters very efficiently and, in addition, revealed some equally important parameters that were overlooked.  #@NEW_LINE#@#  We therefore believe that ML applied to path sampling has a great potential especially since data limitations will become less of an issue in the future due to the further expected increase of high-performance computing, a better parallelization scheme of sampling unequal trajectory-length path ensembles, and the use of more efficient Monte Carlo (MC) path-generating moves (37).  #@NEW_LINE#@#  It would therefore be promising to apply the same method to other aqueous-phase chemistry studies which so far have mainly been based on biased dynamics (31, 38).  #@NEW_LINE#@#  
The fundamental understanding of reaction triggers that can be gathered by this approach could open up avenues of practical applications.  #@NEW_LINE#@#  For instance, even if not all identified parameters correlating with reactivity will necessarily imply causal correlation, it is plausible that an intelligent manipulation of their equilibrium distribution via external electric fields (39) or inclusion of additives might lead to catalytic ways to steer reactions and in particular water dissociation.  #@NEW_LINE#@#  

Materials_and_Methods  #@NEW_LINE#@#  
Simulation_Methods  #@NEW_LINE#@#  
The MD simulations required by the RETIS algorithm (14) were performed with the BornOppenheimer MD capabilities of the CP2K program package (40).  #@NEW_LINE#@#  We used the BeckeLeeYangParr (BLYP) functional with a DZVP-MOLOPT (41) basis set and a plane-wave cutoff of 280 Ry.  #@NEW_LINE#@#  The BLYP functional gives a reasonable description of the structure and dynamics of liquid water (42, 43) and the absence of dispersion corrections (44) is likely of minor importance for ionwater interactions where the dominant interactions are mainly electrostatic.  #@NEW_LINE#@#  However, we note that the BLYP functional is known to give an overstructured description of liquid water with a low diffusion coefficient (45).  #@NEW_LINE#@#  Previous studies on the recombination mechanism for water (17, 46) and for weak bases in water (18) have, however, found that the collective compression of the hydrogen bond wire and the motion of the protons are reproduced with different choices of the functional and basis set.  #@NEW_LINE#@#  
The initial system consisted of 32 water molecules placed in a cubic simulation box of 9.85×9.85×9.85 Å3.  #@NEW_LINE#@#  All MD simulations were carried out under constant energy (microcanonical) dynamics, with a time step of 0.5 fs and periodic boundaries.  #@NEW_LINE#@#  
The transition region was divided into 20 path ensembles by positioning RETIS interfaces at = {1.07, 1.10, 1.13, 1.16, 1.19, 1.22, 1.25, 1.28, 1.31, 1.34, 1.39 1.43, 1.48, 1.52, 1.56, 1.80, 2.00, 2.50, 2.90, 3.29} Å.  #@NEW_LINE#@#  In addition, a final interface was placed at = such that all trajectories were propagated until they reached the pure water state again.  #@NEW_LINE#@#  After generating an initial path for each path ensemble (this was done by repeatedly modifying the momenta of the particles and evolving the system forward in time until valid paths were obtained) the RETIS algorithm attempts to either swap paths between different path ensembles or generate new trajectories by the so-called shooting or the time-reversal move.  #@NEW_LINE#@#  In our simulations the probability of performing a swapping move was set to 50% while the probabilities of the two other moves were both set to 25%.  #@NEW_LINE#@#  New velocities for the shooting move were drawn from a MaxwellBoltzmann distribution corresponding to an average temperature of 300 K.  #@NEW_LINE#@#  
We performed 24,000 MC moves for each path ensemble, using the RETIS algorithm.  #@NEW_LINE#@#  This generated between 8,000 and 18,000 distinct trajectories in each path ensemble.  #@NEW_LINE#@#  The length of the trajectories ranged from 13.5 fs to 1,365 fs and we disregarded the first 400 trajectories in our analysis.  #@NEW_LINE#@#  

Analysis_of_Trajectories  #@NEW_LINE#@#  
Crossing probabilities along the reaction coordinate  were computed by matching the results of the different path ensembles.  #@NEW_LINE#@#  Projection of the crossing probability along  was obtained using the reweighting scheme of Rogal et al.  #@NEW_LINE#@#  (21) for the path ensembles in the transition interface sampling framework.  #@NEW_LINE#@#  
For trajectories harvested with the RETIS algorithm we calculated additional collective variables: the hydrogen bond wire length (wi), the number of hydrogen bond donors (nd) and acceptors (na), the orientation order parameter (q), and the angle formed by O and its closest oxygen neighbors (qcos).  #@NEW_LINE#@#  Using the first configuration in each trajectory, hydrogen atoms were assigned to the closest oxygen atom and this defined the initial H2O molecules.  #@NEW_LINE#@#  Then, the hydrogen bond network was obtained for each configuration in the trajectory.  #@NEW_LINE#@#  Hydrogen bonds were identified using the criteria of Luzar and Chandler (47) and all (shortest) hydrogen bond connections between all pairs of water molecules were determined using the FloydWarshall algorithm (48).  #@NEW_LINE#@#  This allowed us to represent the hydrogen bond structure as a graph.  #@NEW_LINE#@#  Next, the oxygen atom (O) used in the definition of the order parameter was identified.  #@NEW_LINE#@#  With no OH present, this is the oxygen atom for which the covalent OH distance is largest and when we have OH present in the system, this is the OH oxygen atom.  #@NEW_LINE#@#  After identifying O, we obtained the number of hydrogen bonds accepted (na) and donated (nd) by the water species containing it.  #@NEW_LINE#@#  The relevant hydrogen bond wire was obtained using the following criteria: (i) The wire should contain the oxygen atom used for the order parameter (identified as explained above) when the order parameter first crossed 1.15 Å, (ii) the wire should contain i water species, and (iii) the wire should be the shortest of the wires where two criteria i and ii are met.  #@NEW_LINE#@#  The length of the wire was defined as the sum of the OO distances of consecutive molecules in the wire.  #@NEW_LINE#@#  
The orientation order parameter measures the distortion from a tetrahedral orientation of four water molecules around a central molecule and is defined by (27, 28)q=138j=13k=j+14cosjk+132.  #@NEW_LINE#@#  [3]Here, jk is the angle formed by the central oxygen and its four nearest oxygen neighbors.  #@NEW_LINE#@#  The central oxygen is always O or the oxygen with the largest OH bond for pure water or the OH oxygen if it is present.  #@NEW_LINE#@#  For a perfect tetrahedral orientation q=1 and it is q1 otherwise.  #@NEW_LINE#@#  The angle order parameter, qcos, was obtained directly as qcos=min(cos,cos), where  and  are the two internal angles in the wire.  #@NEW_LINE#@#  
After calculating these additional collective variables, we analyzed the trajectories using the methodology of van Erp et al.  #@NEW_LINE#@#  (19).  #@NEW_LINE#@#  For the analysis we used 100 subinterfaces for both r and c for the range 0less_than/Åless_than6.4.  #@NEW_LINE#@#  The histograms in the collective variable space were constructed using 20 bins for 4.0w3/Å7.0, 7.0w4/Å9.6, 9.0w5/Å12; 20 bins for 0q1; and 25 bins for 1qcos1, while the bins (midpoints) were placed at 0.5,0.5,1.5,,6.5 for both na and nd.  #@NEW_LINE#@#  
The classification models were constructed using CARTs (20) available within the R (49) software package.  #@NEW_LINE#@#  The mean of sensitivity and specificity was used as the classifier performance measure (50).  #@NEW_LINE#@#  
For the CART models we considered several sets of collective variables and we obtained these variables at the frame in the trajectories where the order parameter first crossed 1.15 Å.  #@NEW_LINE#@#  The trajectories were classified as reactive if they reached a 2 and as nonreactive otherwise.  #@NEW_LINE#@#  The first set of collective variables consisted of all 4,560 atomatom separations in the system, which gave a model in which the oxygenoxygen distances were most important.  #@NEW_LINE#@#  This model did not lend itself to an easy interpretation and we next considered several models with a reduced number of collective variables.  #@NEW_LINE#@#  
In the best-performing model (performance measure for training 0.89 and for testing 0.88) we considered 138 collective variables: all oxygenhydrogen distances for initially bound water molecules, all oxygenoxygen distances involving O, the averaged distances between O and its i={2,3,,31} oxygen neighbors, the cosine of all angles formed by O and its 4 closest oxygen neighbors, all of the collective variables considered in the predictive power analysis, and the Steinhardt order parameters of order 3, 4, and 6 (32).  #@NEW_LINE#@#  When performing the predictive power analysis for the collective variables used by the CART analysis, we used 20 bins in the range [0.7,2.0] for oxygenhydrogen distances and 20 bins in the range [1.0,4.2] for oxygenoxygen distances, and for angles and the Steinhardt order parameters we used similar bins to those for qcos and q given above.  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
The authors thank Øivind Wilhelmsen for fruitful discussions.  #@NEW_LINE#@#  The authors thank the Research Council of Norway Projects 237423 and 250875 and the Faculty of Natural Sciences and Technology, Norwegian University of Science and Technology (NTNU) for support.  #@NEW_LINE#@#  This research was supported in part with computational resources at NTNU provided by the Norwegian Metacenter for Computational Science (NOTUR), www.sigma2.no.  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  

Published under the PNAS license.  #@NEW_LINE#@#  

