article id="http://dx.doi.org/10.1073/pnas.1712021114"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Patterns of coevolving amino acids unveil structural and dynamical domains  #@NEW_LINE#@#  

Significance  #@NEW_LINE#@#  
Patterns of pairwise correlations in sequence alignments can be used to reconstruct the network of residue-residue contacts and thus the three-dimensional structure of proteins.  #@NEW_LINE#@#  Less explored, and yet extremely intriguing, is the functional relevance of such coevolving networks: Do they encode for the collective motions occurring in proteins at thermal equilibrium?  #@NEW_LINE#@#  Here, by combining coevolutionary coupling analysis with a state-of-the-art dimensionality reduction approach, we show that the network of pairwise evolutionary couplings can be analyzed to reveal communities of amino acids, which we term evolutionary domains, that are in striking agreement with the quasi-rigid protein domains obtained from elastic network models and molecular dynamics simulations.  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Patterns of interacting amino acids are so preserved within protein families that the sole analysis of evolutionary comutations can identify pairs of contacting residues.  #@NEW_LINE#@#  It is also known that evolution conserves functional dynamics, i.e., the concerted motion or displacement of large protein regions or domains.  #@NEW_LINE#@#  Is it, therefore, possible to use a pure sequence-based analysis to identify these dynamical domains?  #@NEW_LINE#@#  To address this question, we introduce here a general coevolutionary coupling analysis strategy and apply it to a curated sequence database of hundreds of protein families.  #@NEW_LINE#@#  For most families, the sequence-based method partitions amino acids into a few clusters.  #@NEW_LINE#@#  When viewed in the context of the native structure, these clusters have the signature characteristics of viable protein domains: They are spatially separated but individually compact.  #@NEW_LINE#@#  They have a direct functional bearing too, as shown for various reference cases.  #@NEW_LINE#@#  We conclude that even large-scale structural and functionally related properties can be recovered from inference methods applied to evolutionary-related sequences.  #@NEW_LINE#@#  The method introduced here is available as a software package and web server (spectrus.sissa.it/spectrus-evo_webserver).  #@NEW_LINE#@#  

Results_and_Discussion  #@NEW_LINE#@#  
Our strategy is based on the analysis of comutating pairs of amino acids to identify groups of residues that have putatively evolved in a concerted manner.  #@NEW_LINE#@#  Revealing such coevolving groups is important because they would expectedly reflect the action of structural and functional constraints operating at a larger scale than the pairwise one, which can be elegantly and effectively probed by direct coupling analysis methods (39, 42, 60).  #@NEW_LINE#@#  Considering this expectedly extended organization of such coevolving clusters of amino acids, we shall refer to them as EDs.  #@NEW_LINE#@#  A detailed presentation of the ED search method is presented in Materials and Methods.  #@NEW_LINE#@#  For completeness, and to make this section self-cointained, we provide a brief summary of the method before discussing its applications.  #@NEW_LINE#@#  
Searching_for_EDs__Methodological_Overview  #@NEW_LINE#@#  
As summarized in Fig 1A, the input of the ED search strategy for a given protein is the matrix of the statistical couplings between any two pairs of amino acid positions within the relative MSA encoding for its protein family.  #@NEW_LINE#@#  Our method of choice for the coupling analysis is the plmDCA approach described in ref.  #@NEW_LINE#@#  60, but similar results can be obtained by other approaches, such as gplmDCA and plmDCA20 (42) (Materials and Methods and SI Appendix).  #@NEW_LINE#@#  
The evolutionary relatedness encoded by the statistical coupling is used to assign a similarity score (or evolutionary proximity) between pairs of amino acids.  #@NEW_LINE#@#  The subdivision of the whole sequence in multiple EDs is then the result of a clustering procedure, the spectral clustering (62), which returns an optimal set of densely connected groups.  #@NEW_LINE#@#  To ensure a robust domain subdivision, the similarity matrix is regularized into a k-nearest neighbors graph by retaining the top k=7 strongest evolutionary couplings of each amino acid, which have been found to maximize the clustering properties of the coupling network (as will be discussed in Dataset-Wide Survey).  #@NEW_LINE#@#  The k-nearest neighbors strategy has been chosen for its simplicity, but we note that the final outcomes are not significantly affected by the particular sparsification strategy used to regularize the similarity matrix (Materials and Methods and SI Appendix).  #@NEW_LINE#@#  
The number of evolutionary-based subdivisions is not specified a priori but is set by analyzing the profile of a quality score indicating the best protein decomposition as a function of the number of domains, providing thus a consistent description of the protein at both large and small scales, respectively, for low and high numbers of clusters.  #@NEW_LINE#@#  The clustering strategy is similar to that used by the SPECTRUS (spectral-based rigid units subdivision) algorithm (61) to determine dynamical, quasi-rigid domains in proteins or protein complexes.  #@NEW_LINE#@#  

A_Test_Case__Adenylate_Kinase  #@NEW_LINE#@#  
To illustrate and validate the sequence-based ED decomposition, we first apply it to Escherichia coli adenylate kinase [Protein Data Bank (PDB) ID 4AKE], a standard benchmark for domain partitioning methods.  #@NEW_LINE#@#  The results are given in Fig 1B.  #@NEW_LINE#@#  The red curve in the upper left graph shows the quality score, Q, for subdivisions of the enzyme into an increasing number of EDs.  #@NEW_LINE#@#  The quality score reflects how sharply defined, according to the clustering metrics, is the returned optimal subdivision compared with random partitions.  #@NEW_LINE#@#  The highest scores for the sequence-based partitioning are found for Q=3, 6, and 9 EDs.  #@NEW_LINE#@#  The structural and sequence-wise representations of the partitions into Q = 3 and 6 domains are given in Fig 1B.  #@NEW_LINE#@#  Note that EDs, which can span several intercalated stretches of the primary sequence, are nonetheless structurally compact.  #@NEW_LINE#@#  This is a noteworthy and intriguing result, since the evolutionary subdivisions are exclusively sequence-based, with no input about the actual structure of the protein.  #@NEW_LINE#@#  
As a matter of fact, the returned subdivisions are viable from the structural and functional point of view.  #@NEW_LINE#@#  This emerges from their comparison with quasi-rigid, dynamical domains (DDs).  #@NEW_LINE#@#  These were identified with the SPECTRUS web server (61) using as input the structural fluctuations observed in extensive MD simulations of adenylate kinase.  #@NEW_LINE#@#  As shown in Fig 1B, the Q=3 and Q=6 evolutionary subdivisions are well consistent, both structurally and sequence-wise, with the high-scoring quasi-rigid partitionings into similar numbers of domains.  #@NEW_LINE#@#  In particular, for both cases, the Q=3 subdivision corresponds to the well-known partitioning into three main functional domains, namely the ATP-binding site, the AMP-binding site, and the core, shown respectively in red, gray, and blue.  #@NEW_LINE#@#  In addition, even the finest partitionings (Q=9 and Q=10; see SI Appendix, Fig S1) provide consistent decompositions in the two cases and highlight structural elements that are arguably crucial for the protein functional dynamics.  #@NEW_LINE#@#  
The result is noteworthy because, although sequences code for both structural and functional properties, it would have been difficult to anticipate that the latter could be obtained directly from the primary sequence without additionally using a 3D conformation.  #@NEW_LINE#@#  In addition, although DCA is a very powerful means of extracting reliable indications of proteins folds, we are not aware of documented instances where DCA-derived structural information was used to infer functional movements.  #@NEW_LINE#@#  These considerations reinforce the significance of showing that functional and structural domains can be directly and confidently extracted from the coupling analysis of MSAs (see SI Appendix, Fig S2).  #@NEW_LINE#@#  

Dataset-Wide_Survey  #@NEW_LINE#@#  
For a systematic characterization of the EDs, we then extended the analysis to a dataset of 813 MSAs compiled by Feinauer et al.  #@NEW_LINE#@#  (42).  #@NEW_LINE#@#  This was chosen for two main reasons.  #@NEW_LINE#@#  First, it gives a comprehensive coverage of several protein families, with various MSA sizes (from 16 to 65,000 entries) and protein lengths (from 30 to 500 amino acids).  #@NEW_LINE#@#  Second, a PDB entry is available for a representative protein of each family/MSA.  #@NEW_LINE#@#  This is a key element in this study because it allows us to assess the spatial compactness of ED decompositions, which are exclusively based on the sequences defining each MSA, and to compare them to the DDs subdivisions.  #@NEW_LINE#@#  

Case_Study__Comparative_Analysis_Across_the_6TM_Family_of_Ion_Channels  #@NEW_LINE#@#  
To further assess the capability of ED decompositions to outline important functional properties of a protein family, we conclude by applying the ED analysis in a comparative scenario to a specific class of ion channels, the six-transmembrane-helices (6TM) superfamily, for which the sequencefunction relationship has been actively investigated in a number of seminal studies (70).  #@NEW_LINE#@#  This superfamily is characterized by a strictly conserved tetrameric architecture.  #@NEW_LINE#@#  The latter is shown in Fig 5A where different colors are used to highlight the main functional domains, including the four-helix bundle voltage sensor domain (VSD) and the pore of the ion conduction pathway, which involves two transmembrane helices and the linking reentrant pore, containing the selectivity filter.  #@NEW_LINE#@#  This single structural template inherited from an ancestor gene has enabled, through differentiation, an explosion of functional variability.  #@NEW_LINE#@#  Channels in the 6TM class, in fact, are involved, for instance, in reporting noxious environmental conditions, in shaping the neuronal action potential, and in syncing the beating of the heart (59).  #@NEW_LINE#@#  Since all these channels share the same architecture, different decompositions in EDs in different phylogenetic groups likely reflect distinct functional rather than structural aspects (51, 52).  #@NEW_LINE#@#  
For definiteness, we focus on three different 6TM families: the voltage-gated potassium-selective channel [Kv, PDB ID 2R9R (71)], the bacterial voltage-gated sodium-selective channel [BacNav, PDB ID 4EKW (72)], and transient receptor potential [TRP, PDB ID 3J5P (73)] channels.  #@NEW_LINE#@#  We analyzed the MSAs for the three families based on a pool of 800 sequences, each with 200 positions (74) from which we omitted the highly gapped regions of the alignments (typically occurring in loops between the six transmembrane helices).  #@NEW_LINE#@#  Although the 6TM dataset that we used is the most comprehensive available at the moment, its size is clearly limited by comparison with the much better populated cases discussed previously, showing a pretty low C (see SI Appendix, Fig S12).  #@NEW_LINE#@#  To ensure a robust analysis, we decided to decompose the graph corresponding to the maximum C for each MSA.  #@NEW_LINE#@#  
In Fig 5 B and E, we present various subdivisions for the Kv family for increasing numbers of domains (see SI Appendix, Fig S13 for quality score).  #@NEW_LINE#@#  The subdivision for Q=2 is already unexpectedly informative, since the fourth helix of the VSD (called S4) and its facing residues are associated with the pore domain rather than the rest of the VSD.  #@NEW_LINE#@#  This is an intriguing result because the aforementioned classic subdivision into structural domains would have kept these elements apart.  #@NEW_LINE#@#  From a functional point of view, however, the sequence-based subdivision of the primary (Q=2) EDs is meaningful.  #@NEW_LINE#@#  In fact, it agrees with the strong mechanical coupling between the pore region and S4 (7577).  #@NEW_LINE#@#  We recall that the latter contains the positive residues (yellow spheres in Fig 5B) that sense transmembrane potential variations and determine the movement of this helix across the membrane; this movement is, in turn, transmitted to the pore domain for gating.  #@NEW_LINE#@#  The division into Q=4 EDs, in Fig 5C, picks up further functional features.  #@NEW_LINE#@#  One domain largely corresponds to the selectivity region, formed by all of the residues lining the narrow and highly conductive ion pathway (in yellow), another is associated to the gating region (red), and the other two comprise, respectively, the internal and external residues of the VSD.  #@NEW_LINE#@#  It is notable that a different domain assignment is found for the two faces of the pore helix, with the upper one sustaining the selectivity filter and the lower one contacting the gating domain.  #@NEW_LINE#@#  This Kv example is also particularly instructive regarding the multilevel description that EDs can provide about the various protein features.  #@NEW_LINE#@#  Finer subdivisions (Q=6) mostly return the basic structural elements of the system.  #@NEW_LINE#@#  In this subdivision, the pore and the voltage sensor regions are mostly assigned to different EDs, with the exception of the extracellular portion of the channel (highlighted in blue in Fig 5 D and E), which still bridges between the two.  #@NEW_LINE#@#  When viewed in the context of the channel tetramer, it appears natural to speculate that this region is instrumental for the signal propagation between the loops of the voltage-sensing and the pore domains, which can indeed be modulated by external stimuli, like ligand binding.  #@NEW_LINE#@#  We accordingly surmise that amino acids in this region are genuinely evolutionary-related for functional reasons.  #@NEW_LINE#@#  
Further elements regarding the functional role of EDs emerge from the comparisons of Kv, BacNav, and TRP subdivisions, which are given in Fig 6 and are further detailed in SI Appendix, Fig S13.  #@NEW_LINE#@#  The comparison between Kv and BacNav (another tetrameric voltage-gated family, selective for sodium) reflects how the functional constraints shaped these two families along evolution, in an almost superimposable way.  #@NEW_LINE#@#  In fact, the S4 helix segregates with the lower part of the pore, and, together, they form the gating domain (in red).  #@NEW_LINE#@#  Similarly, the reentrant pore helix is split into the upper and lower faces, sustaining the selectivity domain (in yellow), and the rest of VSD is grouped into internal and external residues.  #@NEW_LINE#@#  The organization of EDs for TRP channels is, instead, totally different.  #@NEW_LINE#@#  Indeed, this channel family, identified only in Eukaryota, has distinct characteristics with respect to the other ones.  #@NEW_LINE#@#  Specifically, it is a nonselective cation channel gated by a variety of stimuli, such as temperature, pH, and ligands binding (7881).  #@NEW_LINE#@#  In particular, these channels have been shown to possess two different gating regions (73, 82), which are, indeed, well captured by the ED decomposition.  #@NEW_LINE#@#  The division of S4 is compelling in this respect, since it is consistent with the lack of the dynamical role that, instead, characterizes it in voltage-gated ion channels: Only the C-terminal residues are associated with the gating domain (in red).  #@NEW_LINE#@#  The upper part of S4 is, instead, longitudinally sectioned, with the internal residues all grouped with the upper part of the rest of the VSD.  #@NEW_LINE#@#  The external part of S4 belongs to the extended yellow domain: The latter represents effectively a second upper gating domain, as suggested in refs.  #@NEW_LINE#@#  73 and 82.  #@NEW_LINE#@#  Remarkably, the yellow cavity determined by the two pore helices and the external part of S4 corresponds exactly to the location of the vannilloid pocket (8286), which represents the main intracellular binding site for the activators of these channels.  #@NEW_LINE#@#  
The indication from the 6TM family is that EDs can single out domains that, owing to their specific functional character, are distinct from subdvisions made with static structural criteria.  #@NEW_LINE#@#  

Comparison_with_Protein_Sectors_Analysis  #@NEW_LINE#@#  
Identifying groups of coevolving residues from patterns of correlated mutations is a long-standing issue (48) that has been tackled from various perspectives.  #@NEW_LINE#@#  Among the best-known and most elegant approaches are the protein sectors analysis (49) and CoeViz (87), which provides insight into the cooperative nature of residue coevolution.  #@NEW_LINE#@#  ED analysis is mostly complementary to these techniques, because of several methodological differences.  #@NEW_LINE#@#  For instance, protein sectors analysis returns a nonexhaustive coverage of the protein residues.  #@NEW_LINE#@#  In fact, it uses the top eigenvectors of a conservation-weighted covariance matrix built from an MSA, and typically only 20% of residues with the largest component on one eigenvector determines a sector, i.e., a group of residues evolving concertedly.  #@NEW_LINE#@#  By construction, the method prioritizes the most conserved residues (88).  #@NEW_LINE#@#  Importantly, this nonexhaustive assignment is nonexclusive too, meaning that one residue can be part of distinct sectors.  #@NEW_LINE#@#  By contrast, the ED decomposition uses the entire DCA-based similarity to ensure a residue assignment that is both exhaustive and exclusive.  #@NEW_LINE#@#  The latter feature, in particular, is instrumental to the specific goal pursued here of comparing EDs with DDs.  #@NEW_LINE#@#  
DCA and statistical coupling analysis share nevertheless important conceptual similarities (89, 90), and, therefore, similarities between EDs and sectors can be expected in specific contexts.  #@NEW_LINE#@#  We therefore compared the two types of subdivisions for several case studies.  #@NEW_LINE#@#  We first considered the two datasets of ref.  #@NEW_LINE#@#  49, which consist of the PDZ domain and the S1A serine protease families.  #@NEW_LINE#@#  The former dataset has 240 sequences and features one sector.  #@NEW_LINE#@#  The quality score profile of the ED analysis in Fig 7A has an overall decreasing trend, which is typical of datasets of this size, indicating meaningful division for Q=2,3.  #@NEW_LINE#@#  The first subdivision features a domain that totally includes the aforementioned sector (red spheres).  #@NEW_LINE#@#  In the finer ED subdivisions, the protein sector is resolved into smaller and spatially coherent EDs (red and gray domains in the sequence diagram), allowing a further comparison with DDs for Q=3: the highlighted residues (and corresponding EDs) overlap with two distinct dynamical partitions of the protein.  #@NEW_LINE#@#  The second dataset, with a larger number of sequences (1,388), yields three sectors.  #@NEW_LINE#@#  The EDs quality score profile in Fig 7B indicates that significant subdivisions are found for Q=2,3,8 domains.  #@NEW_LINE#@#  Two of the three sectors (red and orange in the diagram) have a good correspondence with the EDs.  #@NEW_LINE#@#  They are compact and both contained in the red domain for Q=2,3, and then perfectly separated for Q=8.  #@NEW_LINE#@#  The other sector (in gray in Fig 7B) instead comprises scattered residues.  #@NEW_LINE#@#  This is consistent with previous studies that showed that this sector is more related to thermal stability than structural properties (49).  #@NEW_LINE#@#  Interestingly, when S1A sectors and EDs differ from DDs (again for Q=3), they are still consistent with each other.  #@NEW_LINE#@#  In fact, one sees in Fig 7 that the red ED includes the orange sector but both groups differ from the blue DD.  #@NEW_LINE#@#  Overall, the comparative analysis of these two families, whose MSAs contain homogeneous sets of sequences, shows that EDs and sectors have significant similarities.  #@NEW_LINE#@#  
Remarkable differences, however, are observed in case of larger and more heterogeneous sets of sequences.  #@NEW_LINE#@#  In SI Appendix, Figs.  #@NEW_LINE#@#  S14S16, we illustrate three examples discussed previously, namely SbmC gyrase inhibitory protein, adenylate kinase, and ABC transporter, whose MSAs have been built by including the largest number of sequences (42).  #@NEW_LINE#@#  While, for SbmC (Nseqeff=3,714), some similarity is still noticeable between two sectors (cyan and orange in SI Appendix, Fig S14) and the subdivisions in two DDs and EDs, for the other datasets (adenylate kinase and the ABC transporter), it is not possible to relate sectors to EDs or DDs: Protein sector analysis on these large datasets (more than 14,000 effective sequences) returns groups of residues distant in both primary and tertiary structure (see SI Appendix, Figs.  #@NEW_LINE#@#  S15 and S16).  #@NEW_LINE#@#  The fact that the differences between EDs and protein sectors are more pronounced for large datasets suggests that, when presented with highly heterogeneous sequence sets, these two algorithms highlight different aspects of residueresidue correlations.  #@NEW_LINE#@#  For instance, protein sectors analysis has been shown to effectively identify the groups of amino acids that experience the largest variations on passing from one phylogenetic group to another (91).  #@NEW_LINE#@#  On the other hand, DCA is seemingly less sensitive to the phylogenetic structure of the MSA analyzed (42).  #@NEW_LINE#@#  For this reason, we believe that the interpretation of EDs in terms of structural domains and DDs ought to be applicable in more general contexts, and particularly to large datasets.  #@NEW_LINE#@#  


Conclusions  #@NEW_LINE#@#  
Patterns of correlated mutations in an MSA can be used to reveal a set of pairwise statistical interactions that are often informative about the possible spatial proximity between the residues involved.  #@NEW_LINE#@#  Strikingly, we showed that this network of couplings has a peculiar structure with communities of residues that are more connected among themselves than with the rest of the sequence.  #@NEW_LINE#@#  Therefore, beyond compensatory mutations involving pairs of contacting residues, entire groups of residues appear to evolve in a concerted fashion.  #@NEW_LINE#@#  We characterized these communities, that we term EDs, by interpreting the statistical couplings as a measure of evolutionary proximity between residues.  #@NEW_LINE#@#  To this end, we used an efficient clustering framework, namely, the spectral clustering.  #@NEW_LINE#@#  When analyzed in the context of the protein structure, these couplings show an innate tendency to segregate into spatially localized and compact groups.  #@NEW_LINE#@#  We explored the possible biological meaning of these subdivisions, comparing EDs with the dynamical, quasi-rigid domains identified by a recently introduced approach (61).  #@NEW_LINE#@#  The sequence- and structure-based subdivisions were found to be very consistent across a diverse repertoire of protein families.  #@NEW_LINE#@#  This is noteworthy because sequence-based approaches could be expected to give a less direct, and hence noisier, route to domain decompositions than structural ones.  #@NEW_LINE#@#  As a matter of fact, the two subdivision approaches provide consistent results for both small and large number of domains, thus indicating the viability of ED decompositions at different spatial resolutions.  #@NEW_LINE#@#  These features ought to be particularly valuable in contexts where structural data are not available or are sparser than the sequence-based data.  #@NEW_LINE#@#  
In these cases, detecting the hierarchical organization in domains can represent a crucial initial step for any structural modeling with an atomistic level of detail.  #@NEW_LINE#@#  Even more interesting is the perspective of using this approach to engineer existing proteins: Transferring EDs across proteins sharing the same architecture might enable de novo design of protein chimeras with novel biological properties.  #@NEW_LINE#@#  
Finally, despite the fact that the DCA analysis, used for the inference of statistical couplings, depends crucially on the effective number of sequences in the MSA, we observe robust and consistent results even for a few hundreds of sequences.  #@NEW_LINE#@#  For this reason, we believe that EDs, and therefore the topology of the network of coevolutionary couplings, are more robust with respect to the sample size than are the single interresidue couplings (41, 42).  #@NEW_LINE#@#  Importantly, this aspect widens de facto the scope of applicability of these inference methods beyond those cases for which thousands of sequences are available.  #@NEW_LINE#@#  In particular, this enables comparative studies in which homologous subfamilies, rather than the entire group, are studied separately, with the ultimate goal of highlighting the functionally features distinctive to each subgroup, as shown here for the challenging case of ion channels.  #@NEW_LINE#@#  

Materials_and_Methods  #@NEW_LINE#@#  
SI Appendix contains supplementary results, methods, and figures.  #@NEW_LINE#@#  The method introduced here is available as a software package and web server at spectrus.sissa.it/spectrus-evo_webserver.  #@NEW_LINE#@#  
Dataset  #@NEW_LINE#@#  
We used the dataset of ref.  #@NEW_LINE#@#  42 consisting of 813 MSAs.  #@NEW_LINE#@#  The latter were obtained with HHblits (92), a homology detection scheme, using sequences of target PDB entries as input queries.  #@NEW_LINE#@#  The MSAs in the dataset are heterogeneous for both the number of involved sequences (16 to 65,535) and positions (30 to 494).  #@NEW_LINE#@#  The PDB structures associated with the query sequences were used a posteriori to assess the structural and dynamical characteristics of the EDs inferred from the sole direct coupling analysis of the MSAs (39, 93).  #@NEW_LINE#@#  The MSA for adenylate kinase was obtained with the approach of ref.  #@NEW_LINE#@#  42, while MSAs for the three ion channels were the same ones derived in refs.  #@NEW_LINE#@#  74 and 52, based on curated phylogenetic reconstructions.  #@NEW_LINE#@#  All of the relative couplings were obtained using three DCA methods, described in SI Appendix.  #@NEW_LINE#@#  

EDs_and_DDs  #@NEW_LINE#@#  
DDs were identified with the SPECTRUS algorithm (61).  #@NEW_LINE#@#  The method uses interresidue distance fluctuations as input data for a clustering procedure that optimally partitions protein structures into quasi-rigid domains.  #@NEW_LINE#@#  Interresidue distance fluctuations for adenylate kinase were obtained from atomistic MD trajectories, while, for the other considered instances, they were computed using the ENM of ref.  #@NEW_LINE#@#  68.  #@NEW_LINE#@#  
In brief, the DD partitioning involves the following steps: (i) An auxiliary similarity matrix, Sij, is derived from the distance fluctuations of all pairs of amino acids, i and j; (ii) next, a spectral clustering scheme (61, 62, 94) is used to subdivide amino acids into an increasing number of domains, Q, from 2 to 10.  #@NEW_LINE#@#  For optimal domain discrimination, this spectral partitioning step is customarily performed with a k-medoids algorithm, after sparsifying the similarity matrix by retaining only the most significant couplings.  #@NEW_LINE#@#  Following ref.  #@NEW_LINE#@#  61, we accordingly retained only entries corresponding to pairs of amino acids that were in contact in the reference PDB structures (C distances less than 10 Å).  #@NEW_LINE#@#  For robustness (62, 94), the stochastic k-medoids procedure was repeated 1,000 times for each value of Q, and we retained only the one with the best k-medoids score.  #@NEW_LINE#@#  Finally, (iii) for each partition into Q=2,,10 domains, we computed a quality score, and used it to single out the top-most significant (top ranking) subdivision(s).  #@NEW_LINE#@#  
EDs were identified with exactly the same method, but with two differences.  #@NEW_LINE#@#  First, the Sij entries of the similarity matrix were derived from the DCA pairwise couplings.  #@NEW_LINE#@#  Specifically, the couplings were first additively shifted to remove negative values and then squared to increase the contrast between weak and strong couplings.  #@NEW_LINE#@#  The second change concerns the sparsification of the similarity matrix in step ii, which was necessary because the structural (contact) criterion used for DDs could not be used in the sequence-based context of EDs.  #@NEW_LINE#@#  As the simplest choice, we adopted the symmetric k-nearest neighbor criterion, where, for each residue, only the k strongest couplings are kept; see Optimization of the k-Nearest Neighbor Network.  #@NEW_LINE#@#  To ensure the connectivity of the network associated with the S matrix, a requisite for meaningful subdivisions, we always retained entries corresponding to consecutive residues.  #@NEW_LINE#@#  We evaluated the robustness of the ED assignment procedure with respect to (i) the size of the MSA dataset (see SI Appendix, Figs.  #@NEW_LINE#@#  S17 and S18), (ii) the purity of EDs (that is, their variability over independent instances of the k-medoids assignment; see SI Appendix, Fig S19), (iii) the specific sparsification strategy applied to the DCA-based similarity matrix (see SI Appendix, Figs.  #@NEW_LINE#@#  S20S23), and (iv) the DCA method used (see SI Appendix, Figs.  #@NEW_LINE#@#  S24S29).  #@NEW_LINE#@#  In the latter case, we also tested the domain assignment variability upon omitting residues with the weakest couplings in the network; see SI Appendix, Fig S23.  #@NEW_LINE#@#  We surmise that, in future developments of the current method, an optimization on the protocol for omitting such residues could improve EDs resolution.  #@NEW_LINE#@#  

Optimization_of_the_k-Nearest_Neighbor_Network  #@NEW_LINE#@#  
To set k, we profiled the clustering coefficient C (95), or cliqueness, of the network of k-nearest neighboring residues for various values of k. The clustering coefficient measures the probability that two neighbors of a node in the network (i.e., a residue) are themselves neighbors.  #@NEW_LINE#@#  The local clustering coefficient of node i is defined as Ci=2ti/[ni(ni1)], where ti is the number of links between the ni neighbors of i.  #@NEW_LINE#@#  The global clustering coefficient is obtained by averaging Ci over all nodes in the network with ni1.  #@NEW_LINE#@#  In this paper, we used a generalized, weighted definition of clustering coefficient, which takes into account the weights associated with each link (63).  #@NEW_LINE#@#  
A commonly used term of reference is a random graph, for which Crand=k¯/(N1), where N is the number of nodes and k¯ is the average number of neighbors per node (96).  #@NEW_LINE#@#  Here we use this quantity to profile the k dependence of the clustering propensity of the network derived from the DCA.  #@NEW_LINE#@#  Specifically, for each of the 813 MSA entries, we computed C=CCrand for k{3,5,7,10,15,20,25,30,40,55}.  #@NEW_LINE#@#  We then identified the value of k yielding the largest C for each entry.  #@NEW_LINE#@#  The distribution of such optimal values of k is shown in Fig 2.  #@NEW_LINE#@#  The distribution is visibly peaked at k=7, which we then used for the ED analysis.  #@NEW_LINE#@#  The peak location is robust with respect to the specific DCA method used and with respect to the MSA size (see SI Appendix, Fig S3).  #@NEW_LINE#@#  The use of a suboptimal graph, anyway, leads basically to the same subdivisions (see SI Appendix, Fig S29).  #@NEW_LINE#@#  Accordingly, in Results and Discussion, we always set k=7, making our method parameter-free.  #@NEW_LINE#@#  

Structural_Compactness  #@NEW_LINE#@#  
The spatial compactness of EDs was assessed a posteriori by establishing whether the individual EDs consisted of two or more subdomains that are 10 Å apart.  #@NEW_LINE#@#  We mapped each ED q to a graph where the nq nodes (residues) were linked only if their Cs were within 10 Å.  #@NEW_LINE#@#  We then considered all nq(nq1) distinct pairings of the nodes and checked whether or not they can be connected by a path on the network of links.  #@NEW_LINE#@#  The degree of disconnectedness of the domain is then measured as dq=bq/(nq1), where bq is the number of residue pairs without a connecting path.  #@NEW_LINE#@#  The overall compactness of a subdivision into Q domains is then defined asQ=11Nq=1Qdq,[1]where N is the total number of nodes/residues.  #@NEW_LINE#@#  For a physical interpretation of , see SI Appendix, Fig S6.  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
This work was partially supported by National Institutes of Health Grants R01GM093290, S10OD020095, and P01GM055876 (to V.C.)  #@NEW_LINE#@#  and National Science Foundation Grant ACI-1614804 (to V.C.  #@NEW_LINE#@#  ).  #@NEW_LINE#@#  

Footnotes  #@NEW_LINE#@#  

Published under the PNAS license.  #@NEW_LINE#@#  

