article id="http://dx.doi.org/10.1371/journal.pone.0147073"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Large-Scale Analysis of Zipfs Law in English Texts  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Despite being a paradigm of quantitative linguistics, Zipfs law for words suffers from three main problems: its formulation is ambiguous, its validity has not been tested rigorously from a statistical point of view, and it has not been confronted to a representatively large number of texts.  #@NEW_LINE#@#  So, we can summarize the current support of Zipfs law in texts as anecdotic.  #@NEW_LINE#@#  We try to solve these issues by studying three different versions of Zipfs law and fitting them to all available English texts in the Project Gutenberg database (consisting of more than 30 000 texts).  #@NEW_LINE#@#  To do so we use state-of-the art tools in fitting and goodness-of-fit tests, carefully tailored to the peculiarities of text statistics.  #@NEW_LINE#@#  Remarkably, one of the three versions of Zipfs law, consisting of a pure power-law form in the complementary cumulative distribution function of word frequencies, is able to fit more than 40% of the texts in the database (at the 0.05 significance level), for the whole domain of frequencies (from 1 to the maximum value), and with only one free parameter (the exponent).  #@NEW_LINE#@#  

Citation: Moreno-Sánchez I, Font-Clos F, Corral Á (2016) Large-Scale Analysis of Zipfs Law in English Texts.  #@NEW_LINE#@#  PLoS ONE 11(1):  #@NEW_LINE#@#  
           e0147073.  #@NEW_LINE#@#  

        https://doi.org/10.1371/journal.pone.0147073  #@NEW_LINE#@#  
Editor: Dante R. Chialvo,  #@NEW_LINE#@#  
National Scientific and Technical Research Council (CONICET)., ARGENTINA  #@NEW_LINE#@#  

Received: September 15, 2015; Accepted: December 27, 2015; Published:  January 22, 2016  #@NEW_LINE#@#  
Copyright:  © 2016 Moreno-Sánchez et al.  #@NEW_LINE#@#  This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.  #@NEW_LINE#@#  
Data Availability: All word-count files are available at http://dx.doi.org/10.6084/m9.figshare.1515919.  #@NEW_LINE#@#  
Funding: This work was supported by Ministerio de Economia y Competitividad (Gobierno de España) (http://www.mineco.gob.es/), grant number FIS2012-31324 (receiver: ACC) and Agència de Gestió dAjust Universitaris i de Recerca (Generalitat de Catalunya) (http://www10.gencat.cat/agaur_web/AppJava/catala/index.jsp), grant number 2014SGR-1307 (receiver: ACC).  #@NEW_LINE#@#  The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  
Competing interests:  The authors have declared that no competing interests exist.  #@NEW_LINE#@#  
Introduction  #@NEW_LINE#@#  
Zipfs law constitutes a striking quantitative regularity in the usage of language [14].  #@NEW_LINE#@#  It states that, for a large enough piece of text, the frequency of use n of any word decreases with its rareness r in the text in an approximately hyperbolic way, i.e., n  1/r, where the symbol  denotes proportionality.  #@NEW_LINE#@#  Technically, r is called the rank, and the most common (i.e., less rare) word is assigned r = 1, the second most common, r = 2, and so on.  #@NEW_LINE#@#  A slightly more general formulation includes a parameter in the form of an exponent ; then, the rank-frequency relation takes the form of a power law,  #@NEW_LINE#@#  
(1)  #@NEW_LINE#@#  
with the value of  close to one.  #@NEW_LINE#@#  
This pattern Eq (1) has been found across different languages, literary styles, time periods, and levels of morphological abstraction [2, 57].  #@NEW_LINE#@#  More fascinatingly, the same law has been claimed in other codes of communication, as in music [8] or for the timbres of sounds [9], and also in disparate discrete systems where individual units or agents gather into different classes [10], for example, employees into firms [11], believers into religions [12], insects into plants [13], units of mass into animals present in ecosystems [14], visitors or links into web pages [15], telephone calls to users [16], or abundance of proteins (in a single cell) [17].  #@NEW_LINE#@#  The attempts to find an explanation have been diverse [3, 16, 1825], but no solution has raised consensus [21, 2628].  #@NEW_LINE#@#  
Despite its quantitative character, Zipfs law has been usually checked for in a qualitative way, plotting the logarithm of the frequency n versus the logarithm of the rank r and looking for some domain with a roughly linear behavior, with slope more or less close to 1.  #@NEW_LINE#@#  A more refined approach consists in fitting a straight line to the double-logarithmic plot by linear regression [29].  #@NEW_LINE#@#  But several authors have recently pointed out the limitations of this method when applied to probability distributions [12, 3032], and the advantages of using an asymptotically unbiased and minimum-variance procedure such as maximum likelihood (ML) estimation [32], whose solutions, moreover, are invariant under reparameterizations [33, 34].  #@NEW_LINE#@#  One should consider then ML estimation as the most reliable procedure of estimation for parametric models (when a maximum of the likelihood does exist and the number of data is large).  #@NEW_LINE#@#  
Furthermore, for the particular case of linguistics, the search for Zipfs law has been traditionally performed in very limited sets of texts (less than a dozen in a typical research article [6, 35], although in hundreds of languages [7]).  #@NEW_LINE#@#  More recently, however, large corpora have been considered these are representative collections of different texts aggregated together into a single bag, so, instead of many separated texts one deals with one enormous mixed text.  #@NEW_LINE#@#  When rare words are not considered (rare in terms of the frequency, i.e., frequencies below some particular value), it seems that Zipfs law still holds in these large collections, in the sense that Eq (1) is valid only for high frequencies [2, 3639].  #@NEW_LINE#@#  
At present, there is agreement that Zipfs law is a rough approximation in lexical statistics, but its range of validity is totally unknown, i.e., we ignore how good Zipfs law is in order to account for the appearance of words, and for which texts it should work and with which level of precision and for which texts it should fail.  #@NEW_LINE#@#  We know, however, that this peculiar pattern seems to hold in hundreds of different languages, in concrete in those languages in which some electronic texts are available [7].  #@NEW_LINE#@#  
An extra difficulty emerges when one recognizes the ill-defined nature of Zipfs law.  #@NEW_LINE#@#  In fact, the law has two formulations, with the first one being Eq (1), which just counts the frequency of words.  #@NEW_LINE#@#  For the sake of clarity, the words that are counted are referred to as word types, in order to distinguish them from each repetition, which is called a token.  #@NEW_LINE#@#  The second formulation of Zipfs law arises when, after counting the frequency of word types, one performs a second statistics and counts how many values of the frequency are repeated, that is, how many word types have the same frequency.  #@NEW_LINE#@#  This means that the frequency n is considered the random variable.  #@NEW_LINE#@#  One can realize that the rank, when normalized by its maximum value in text, is just the empirical estimation of the complementary cumulative distribution function of n, and then, the derivative of the expression for r(n) (the inverse of Eq (1)) yields a continuous approximation for the probability mass function f(n) of the frequency n. From here one obtains another power law,  #@NEW_LINE#@#  
(2)  #@NEW_LINE#@#  
with the new exponent  fulfilling  = 1 + 1/, which yields values of  close to 2.  #@NEW_LINE#@#  The expression given by Eq (2) was in fact the first approach followed by Zipfs himself [3], and is usually considered as equivalent to Eq (1) [3, 10, 15, 16, 35]; however, as it is derived in the continuum limit, both expressions can only be equivalent asymptotically, for large n [40].  #@NEW_LINE#@#  Consequently, if one wants to be precise, a natural question follows: which one is the true Zipfs law (if any)?  #@NEW_LINE#@#  
We cannot know a priori which of the two Zipfs laws better describes real texts, but we can argue which of the two representations (that of n(r), Eq (1), or that of f(n), Eq (2)) is better for statistical purposes, independently of the functional dependency they provide.  #@NEW_LINE#@#  It is clear that the rank-frequency representation, given by n(r), presents several difficulties, due to the peculiar nature of the rank variable.  #@NEW_LINE#@#  First, in Ref.  #@NEW_LINE#@#  [41], Zipf-like texts were randomly generated following Eq (1), keeping the original ranks hidden (as it happens in the real situation), and it was found that the rank reconstructed from the sample deviated considerably from the original ranks when these were taking large values (which for a power law happens with a high probability).  #@NEW_LINE#@#  The resulting ML estimations of the exponent  were highly biased and the Kolmogorov-Smirnov test rejected the power-law hypothesis, although the original ranks were power-law indeed.  #@NEW_LINE#@#  
One might argue that the problem could be escaped by using an upper truncated power-law distribution (introducing then an additional parameter for the truncation), in order to avoid the inconsistency of the rank representation for high values.  #@NEW_LINE#@#  But a second problem is that the rank is not a true random variable [42], as its values are assigned a posteriori, once the sample (i.e., the text) is analyzed.  #@NEW_LINE#@#  This means that the rank does not show enough statistical fluctuations, that is, if ra less_than rb, then the frequency of a is always larger, by construction, than the frequency of b.  #@NEW_LINE#@#  This does not necessarily happen for a true random variable.  #@NEW_LINE#@#  The negative correlation between the variable and its frequency of occurrence makes the power-law hypothesis harder to reject.  #@NEW_LINE#@#  In fact, inflated p-values (not uniformly distributed between 0 and 1) have been found when fitting truncated power laws to simulated power-law rank-frequency representations [41].  #@NEW_LINE#@#  This problem could still be avoided by choosing a low enough upper truncation parameter (yielding a very short range of ranks, for which the fluctuations would be very little) but at the expense of disregarding an important part of the data.  #@NEW_LINE#@#  
A third inconvenience is the impossibility, due to normalization, that a non-truncated power law comprises values of the exponent smaller than 1.  #@NEW_LINE#@#  This yields the necessity of introducing a truncation parameter that may be artifactual, i.e., not present in the real system.  #@NEW_LINE#@#  All this leads to the conclusion that the most reliable method of parameter estimation (ML, in a frequentist framework) cannot be directly applied to the rank-frequency representation.  #@NEW_LINE#@#  In contrast, the representation in terms of the distribution of frequencies is devoid of these problems [41], as n is a well-defined random variable, and this will be the representation used in this paper for statistical inference.  #@NEW_LINE#@#  Nevertheless, for alternative arguments, see Ref.  #@NEW_LINE#@#  [43].  #@NEW_LINE#@#  
The purpose of this paper is to quantify, at a large, big-data scale, different versions of Zipfs law and their ranges of validity.  #@NEW_LINE#@#  In the next section, we present and justify the three Zipf-like distributions we are going to fit, and we briefly explain the selected fitting method and the goodness-of-fit test.  #@NEW_LINE#@#  The corpus of texts under consideration is also detailed.  #@NEW_LINE#@#  The subsequent section presents the results, with special attention to their statistical significance and their dependence with text length.  #@NEW_LINE#@#  Finally, we end with a discussion, conclusions and some technical appendices.  #@NEW_LINE#@#  

Zipf-like_Distributions  #@NEW_LINE#@#  
As implicit in the introduction, and in contrast with continuous random variables, in the discrete case a power law in the probability mass function f(n) does not lead to a power law in the complementary cumulative distribution or survival function S(n), and vice-versa.  #@NEW_LINE#@#  Let us specify our definition for both functions, f(n) = Prob[frequency = n] (as usual), and S(n) = Prob[frequency  n] (changing, for convenience, the usual strict inequality sign by the non-strict inequality).  #@NEW_LINE#@#  Then, the relation between both is f(n) = S(n)  S(n + 1) and .  #@NEW_LINE#@#  
We consider that the values the random variable takes, given by n, are discrete, starting at the integer value a, taking values then n = a, a + 1,  up to infinity.  #@NEW_LINE#@#  In this study we will fix the parameter a to a = 1, in order to fit the whole distribution and not just the tail.  #@NEW_LINE#@#  Then, although for large n and smooth S(n) we may approximate f(n)  dS(n)/dn, this simplification is clearly wrong for small n. Note that the simplification leads to the implication that a power law in f(n) leads to a power law in S(n), and vice-versa, but this is clearly wrong for small values of n in discrete distributions.  #@NEW_LINE#@#  The simplification also lies in the equivalence between Eqs (1) and (2), assuming that S(n) is proportional to the rank and inverting Eq (1).  #@NEW_LINE#@#  
For the first distribution that we consider, the power-law form is in f(n), then,  #@NEW_LINE#@#  
(3)  #@NEW_LINE#@#  
This is just the normalized version of Eq (2), and then,  #@NEW_LINE#@#  

with   1 and  the Hurwitz zeta function, which ensures normalization of both expressions of the distribution (f1(n) and S1(n)).  #@NEW_LINE#@#  A preliminary analysis of texts in terms of this distribution was done in Ref.  #@NEW_LINE#@#  [44].  #@NEW_LINE#@#  
In contrast, when the power law is in S(n), this leads to our second case,  #@NEW_LINE#@#  
(4)  #@NEW_LINE#@#  
and  #@NEW_LINE#@#  

with   1 again.  #@NEW_LINE#@#  Note that this corresponds to a power law in the empirical rank-frequency relation.  #@NEW_LINE#@#  As S2(a) = 1 this ensures normalization of S2(n), and also of f2(n), which is derived from S2(n).  #@NEW_LINE#@#  
Finally, it is interesting to consider also the frequency distribution derived by Mandelbrot [40] when ranks are generated independently from a power law in Eq (1), which is,  #@NEW_LINE#@#  
(5)  #@NEW_LINE#@#  
and  #@NEW_LINE#@#  

with 1 less_than  less_than 2, and  denotes the gamma function [45].  #@NEW_LINE#@#  In this case the power law is the underlying theoretical rank-frequency relation n(r).  #@NEW_LINE#@#  Note that f3(n) can be written as  #@NEW_LINE#@#  

using the beta function [45], B(x, y) = (x)(y)/(x + y), with an analogous expression for S3(n) (nevertheless, do not confuse this distribution with the beta distribution).  #@NEW_LINE#@#  
In all three cases it is easy to show that we have well-defined, normalized probability distributions, when n takes values n = a, a + 1, , with a being a positive integer.  #@NEW_LINE#@#  Moreover, in the limit n   all of them yield a power-law tail, f(n)  1/n, so  will be referred to as the power-law exponent.  #@NEW_LINE#@#  Indeed, it is easy to show that  #@NEW_LINE#@#  

whereas  #@NEW_LINE#@#  

using Stirlings formula [45].  #@NEW_LINE#@#  The main difference between the three distributions is in the smaller values of n, taking f2(n) a convex shape in log-log-scale (as seen from above); f3(n) a concave one; and f1(n) being somehow in between, as it is neither concave nor convex.  #@NEW_LINE#@#  

Methodology_and_Data  #@NEW_LINE#@#  
In order to fit these three distributions to the different texts, and test the goodness of such fits, we use maximum likelihood estimation [46] followed by the Kolmogorov-Smirnov (KS) test [47].  #@NEW_LINE#@#  The procedure seems similar to the one proposed in Ref.  #@NEW_LINE#@#  [12], but as a is fixed here, the problems resulting from the search of the optimum a[34, 48] do not arise in this case.  #@NEW_LINE#@#  
The method of ML estimation proceeds in the following simple way.  #@NEW_LINE#@#  Given a set of data {ni} with i = 1, 2, N, and a probability mass function parameterized by , denoted as f(n; ) = f(n), the log-likelihood function is obtained as  #@NEW_LINE#@#  
(6)  #@NEW_LINE#@#  
We are assuming that the data points ni are independent from each other, in other words, we are calculating the likelihood that the data are generated independently from f(n; ).  #@NEW_LINE#@#  The ML estimation of  is obtained as the value of  which maximizes l(); we undertake this numerically, using Brents method in the range 1 less_than   4 [47].  #@NEW_LINE#@#  In the case of the distribution f1 the log-likelihood function takes the simple form l1()/N = ln((, a))   lnG, with G the geometric mean of the set {ni}.  #@NEW_LINE#@#  For the other distributions no closed-form expression is possible and we use Eq (6) directly.  #@NEW_LINE#@#  
As mentioned, the goodness-of-fit test is done through the Kolmogorov-Smirnov statistic [12, 47], in the discrete case [49], for which the p-value is calculated from Monte Carlo simulations (due to the fact that, as the value of the exponent is calculated from the same data is going to be tested, the procedure would be biased towards the empirical value and the theoretically computed p-value [47] would be inflated).  #@NEW_LINE#@#  In this paper we use 100 Monte Carlo simulations for each test.  #@NEW_LINE#@#  The proper simulation of the 3 distributions is explained in the Appendix.  #@NEW_LINE#@#  Remember that a small enough p-value leads to the rejection of the fit.  #@NEW_LINE#@#  Although we perform multiple testing, we do not incorporate any Bonferroni-like correction [5052], due to the fact that these corrections increase the number of non-rejected null hypotheses (that is, decrease the number of type I errors), inflating the performance of the fits, in the case of goodness-of-fit tests.  #@NEW_LINE#@#  Without Bonferroni-like corrections, our acceptance (i.e., non-rejection) of the fits is more strict.  #@NEW_LINE#@#  
In order to check the consistency of our fitting procedure, we also perform a direct comparison of models through the likelihood ratio (LR) test [12, 53].  #@NEW_LINE#@#  Taking distributions f1 and f2, the log-likelihood-ratio between both is  #@NEW_LINE#@#  

and, under the null hypothesis that both models are equally good to describe the data, R1,2 should be normally distributed with zero mean and a variance that can be estimated as N2, with 2 the variance of the random variable lnf1(n)  lnf2(n).  #@NEW_LINE#@#  Large absolute values of R1,2 will lead to the rejection of the null hypothesis.  #@NEW_LINE#@#  
In order to apply this methodology we consider a set of 36 813 texts in UTF-8 encoding downloaded from the Project Gutenberg database (accessed July 2014 [54]).  #@NEW_LINE#@#  These texts correspond to different languages, styles, and time periods, although most of them are works of literature from the Western cultural tradition [55].  #@NEW_LINE#@#  First of all, parts of text that do not pertain to the piece under consideration (copyright notes, headers,) are removed by an automatized process.  #@NEW_LINE#@#  Books that have not been filtered in this step (mainly because they do not have standard delimiters) are discarded.  #@NEW_LINE#@#  After this, we still keep 98.2% of the total (i.e., 36 147).  #@NEW_LINE#@#  To perform our study, we restrict ourselves to the subset of texts in English, which represent the 86% of these 36 147 (i.e., 31 102).  #@NEW_LINE#@#  
An important characteristic of each text is its length, L, counting the number of word tokens contained in the text.  #@NEW_LINE#@#  It turns out to be that in the database L expands from very small values up to 4 659 068 tokens, with a distribution that is shown in Fig 1.  #@NEW_LINE#@#  Observe the roughly uniform distribution up to about L = 105, and the decay afterwards.  #@NEW_LINE#@#  
Texts with less than 100 tokens are not considered.  #@NEW_LINE#@#  A power-law fit of the tail [34] yields an exponent 2.92 ± 0.15.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0147073.g001  #@NEW_LINE#@#  
For our analysis we consider only the 31 075 English texts that consist of more than 100 word tokens, as smaller texts would not have statistical value.  #@NEW_LINE#@#  For each of these texts we select then actual word types (punctuation signs, numbers and any character different from letters are not considered) to count their frequencies n, which will be our primary object of study.  #@NEW_LINE#@#  The values of these frequencies, for each text, are available on http://dx.doi.org/10.6084/m9.figshare.1515919, in order to facilitate the reproducibility of our results.  #@NEW_LINE#@#  
In summary, we apply the above described fitting and goodness-of-fit procedure using ML estimation and the Kolmogorov-Smirnov test to a total of 31 075 texts from the English Project Gutenberg database, using three different possibilities for the distribution of frequencies: f1 (Eq (3)), f2 (Eq (4)), and f3 (Eq (5)).  #@NEW_LINE#@#  This yields a total of 3 × 31075 fits and associated p-values, which we analyze and interpret in what follows.  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
Contrary to previous studies where the number of texts considered was, at most, in the order of tens, the large-scale approach taken in this work requires a statistical analysis of the fitting results, as a case-by-case interpretation is out of hand.  #@NEW_LINE#@#  We first focus on the distribution of p-values, see Figs 2 and 3.  #@NEW_LINE#@#  If all texts were truly generated by a mechanism following a given distribution, the corresponding p-values for that distribution would be uniformly distributed between zero and one [56] (see p. 28), [57] (see p.441).  #@NEW_LINE#@#  As seen in Fig 2, this is not the case and, furthermore, most texts have rather small p-values for the three fits; nevertheless, for distributions f1 and f2 there are still many texts that yield high enough p-values.  #@NEW_LINE#@#  
The histograms just count the number of texts in each bin of width 0.01.  #@NEW_LINE#@#  Note the poor performance of distribution 3 and the best performance of 2.  #@NEW_LINE#@#  Power-law approximations to the histograms for f1 and f2, with respective exponents 0.74 and 0.78, are shown as a guide to the eye.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0147073.g002  #@NEW_LINE#@#  
This corresponds, except for normalization, to the integral of the previous figure, but we have included a fourth curve for the fraction of texts whose p-values for fits 1 and 2 are both higher than the value marked in the abscissa.  #@NEW_LINE#@#  Note that the values of p can play the role of the significance level.  #@NEW_LINE#@#  The value for p = 0 is not shown, in order to have higher resolution.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0147073.g003  #@NEW_LINE#@#  
This implies that, although we cannot conclude that the whole database is generated by any of these distributions, these cannot be rejected as good descriptions for large subsets of the database.  #@NEW_LINE#@#  Regarding distribution f3, it is clear from the histogram of p-values that it can be discarded as a good description of the distribution of frequencies in any non-negligible subset of texts.  #@NEW_LINE#@#  So, from now on, we will concentrate on the remaining options, f1 and f2, to eventually quantify which of these better describes our corpus.  #@NEW_LINE#@#  In essence, what we are interested in is which version of Zipfs law, either distribution f1 or f2, fits better a reasonable number of texts, and which range of validity these simple one-parameter distributions have.  #@NEW_LINE#@#  
The outcome is that, independently of the significance level (as long as this is not below our resolution of 0.01 given by the number of Monte Carlo simulations), the ratio between the number of texts fitted by distribution f2 and those fitted by f1 is nearly constant, taking a value around 2.6.  #@NEW_LINE#@#  For example, considering significance level (i.e., minimum p-value) equal to 0.05, Fig 3 shows that distribution f2 fits about 40% of all texts, whereas distribution f1 fits just 15%.  #@NEW_LINE#@#  Both percentages include a 2.7% of texts that are fitted by both distributions simultaneously, although this number does not keep a constant ratio with the other two, rather, it decreases when the significance level is increased (as it is implicit in the values of Fig 3).  #@NEW_LINE#@#  Given that the aforementioned ratio of 2.6 is independent of the significance level, it is fair to say that distribution f2 provides, compared to f1, a better description of our database.  #@NEW_LINE#@#  As a visual illustration of the performance of the fits we display in Fig 4 the word frequency distribution of the longest texts that have p  1/2, for distributions f1, f2 and f3.  #@NEW_LINE#@#  
These texts are the ones with the largest length L (83 720, 239 018 and 2 081 respectively) of those that fulfill p  1/2, for fits 1, 2 and 3 respectively.  #@NEW_LINE#@#  The exponent  takes values 1.96, 1.89, and 1.82, in each case.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0147073.g004  #@NEW_LINE#@#  
The next question we address is the dependence of the performance of fits on text length L. In order to asses this, note that from the shape of the histograms in Fig 2 we can distinguish two groups of texts: those that lie in the zero bin (whose p-value is strictly less than 0.01), and the rest.  #@NEW_LINE#@#  Taking the last group, i.e., texts with p  0.01, and partitioning it into different subsets according to text length (i.e., looking at the distribution of p conditioned to p  0.01 for different ranges of L), it holds that the shape of the resulting distribution of p does not strongly depend on L, as shown in Fig 5.  #@NEW_LINE#@#  In contrast, the number of texts that yield p-value near zero certainly varies with L, see Fig 6.  #@NEW_LINE#@#  Therefore, in order to compare the performances of f1 and f2 as a function of the text length L, it is enough to consider a single value of the significance level (greater than zero) as the results for any other significance level will be the same, in relative terms.  #@NEW_LINE#@#  
We divide the distribution of text length into 15 intervals of 2 000 texts each.  #@NEW_LINE#@#  For distribution f1 only the first seven groups (up to length 34 400) are displayed (beyond this value we do not have enough statistics to see the distribution of p-values greater than 0.01, as displayed in Fig 6; for distribution 2 this happens only in the last two groups).  #@NEW_LINE#@#  The intervals Li range from L1 = [115, 5291] to L6 = [25739, 34378] and to L13 = [89476, 103767].  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0147073.g005  #@NEW_LINE#@#  
Values of L denote the geometric mean of ranges containing 1000 texts each.  #@NEW_LINE#@#  The higher value for the fit of f1 (except for L below about 13000 tokens) denotes its worst performance.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0147073.g006  #@NEW_LINE#@#  
Indeed, Fig 7(a) shows how distribution f1 fits some more texts than distribution f2 for small values of L, up to about 13000 tokens.  #@NEW_LINE#@#  But for larger texts, distribution f2 clearly outperforms distribution f1, which becomes irrelevant for L beyond 100000 (at 0.05 significance level), whereas distribution f2 is able to fit many texts with L larger than 200000.  #@NEW_LINE#@#  The figure shows that this is the case no matter if the significance level is 0.05, 0.20, or 0.50; the collapse of the curves in Fig 7(b) confirms this fact.  #@NEW_LINE#@#  From Fig 6 one could infer the same for significance level equal to 0.01.  #@NEW_LINE#@#  This stability of the performance of the fits for different significance levels arises from the observed fact that the distributions of p-values (conditioned to p  0.01) are nearly identical for different L, as shown in Fig 5.  #@NEW_LINE#@#  
(a) Histograms showing the fraction of accepted texts by the three distributions as a function of their text length, for three different significance levels p0: 0.05 (upper curves), 0.20 (middle), 0.50 (lower).  #@NEW_LINE#@#  To be concrete, for each range of L, the ratio between the number of texts with p  p0 and the number of texts in that range is calculated.  #@NEW_LINE#@#  (b) Same curves (removing those for distribution 3) under rescaling.  #@NEW_LINE#@#  We rescale the yaxis by the number of p  p0, in each case, showing that the relative performance of each fit with regard L is independent on the significance level.  #@NEW_LINE#@#  Bins are selected to contain 1000 texts each.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0147073.g007  #@NEW_LINE#@#  
Next, we apply the LR test to all texts that have been fitted, considering 0.05 as significance level, by at least one of the two distributions f1 and f2.  #@NEW_LINE#@#  Table 1 merges the results of this test and our previous procedure (based on ML estimation plus the KS test).  #@NEW_LINE#@#  The total number of texts previously fitted by f1 or/and f2 is displayed depending on the sign of the corresponding log-ratio R1,2.  #@NEW_LINE#@#  However we must take into account that the sign of the obtained value of R1,2 could be a product of just statistical fluctuations if the true value were zero and thus, the sign of R1,2 cannot be trusted in order to discriminate between two models.  #@NEW_LINE#@#  The probability under the null hypothesis, of obtaining an absolute value of the log-ratio greater than the empirical value |R1,2| is computed through:  #@NEW_LINE#@#  

where erfc is the complementary error function [45].  #@NEW_LINE#@#  We will take as statistically significant those R1,2 that yield pLR less_than 0.05.  #@NEW_LINE#@#  Equivalently, at 0.05 significance level, R1,2 is significant if its absolute value is greater than .  #@NEW_LINE#@#  The results are shown in Table 2  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0147073.t001  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0147073.t002  #@NEW_LINE#@#  
Note that the LR test cannot conclude if a fit is good or bad, as it only compares the relative performance of two fits; in other words, if the LR test selects a particular distribution, that distribution can still yield a bad fit, in absolute terms.  #@NEW_LINE#@#  Anyway, there is no mismatch between the results of both tests: any time the ML-KS method selects one distribution over the other, the LR test either supports the selection or does not give significant results, but it never selects the other option (as shown in Table 2).  #@NEW_LINE#@#  
Taking now those texts whose frequency distributions could be approximated by f1 or f2, we draw attention to the distribution of the estimated exponents (i.e., the parameter ).  #@NEW_LINE#@#  The original formulation of Zipfs law implies  = 2 and Fig 8 shows that  is certainly distributed around 2, with a bell-like shape, and the range of variation is, more or less, between 1.6 and 3.  #@NEW_LINE#@#  The lower value   1.6 is in surprising good agreement with the results of the information-theoretic model of Ref.  #@NEW_LINE#@#  [58], whereas the upper limit   3 is somewhat larger than the results of that model.  #@NEW_LINE#@#  Moreover, the distributions of  are not symmetric, and the upper limit cannot be defined so sharply as the lower limit.  #@NEW_LINE#@#  Notice also that texts with limiting values of the exponents do not correspond, in principle, to pathological texts, as claimed in Ref.  #@NEW_LINE#@#  [58]; rather, for the smallest  we find theatre (including Tosltoy and Ibsen) and children books (some by Jane L. Stewart), whereas the largest  correspond to short poems.  #@NEW_LINE#@#  
Curves have been calculated from the histograms via normal kernel smoothing method as implemented in MatLab (ksdensity function).  #@NEW_LINE#@#  Estimated mean and standard deviation of  are 2.03 and 0.15 respectively for the fit of f1, and 2.02 and 0.17 for f2.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0147073.g008  #@NEW_LINE#@#  
If we check the effect of the text length L in the distribution of , we find a decreasing trend of  with L, as can be seen in Figs 9 and 10.  #@NEW_LINE#@#  We have tested that this observation is not an artifact of the fitting method, as synthetic texts generated with fixed  do not show this behavior.  #@NEW_LINE#@#  This trend is not in disagreement with the claims of Ref.  #@NEW_LINE#@#  [35], where the stability of the exponent  was demonstrated for a single growing text (i.e., comparing small parts of a text with the whole).  #@NEW_LINE#@#  A possible explanation for the decrease of  with L could be a systematic dependence of  with genre, and a bias of L with genre.  #@NEW_LINE#@#  At present we do not have an automatic way to assign genres to texts and we cannot test this hypothesis.  #@NEW_LINE#@#  
We have divided both groups of accepted texts into 4 percentiles according to L. As in the previous figure, the normal kernel smoothing method is applied.  #@NEW_LINE#@#  (a) For distribution f1.  #@NEW_LINE#@#  (b) For distribution f2.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0147073.g009  #@NEW_LINE#@#  
Note that the last bin of f1 contains a single datapoint, and so its standard deviation is not defined.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0147073.g010  #@NEW_LINE#@#  

Discussion_and_Conclusions  #@NEW_LINE#@#  
Zipfs law is probably the most intriguing and at the same time well-studied experimental law of quantitative linguistics, and extremely popular in its wider sense in the science of complex systems.  #@NEW_LINE#@#  Although the previous literature is vast, as far as we know our work constitutes the first large-scale analysis of Zipfs law in single (non-aggregated) texts.  #@NEW_LINE#@#  Thus, we are in a position to make a well-grounded statement about the validity of Zipfs law in such texts (when those are written in English).  #@NEW_LINE#@#  
Let us first briefly summarize, however, some key technical points of our study.  #@NEW_LINE#@#  First, we have analyzed a total of 31 075 English texts from the Project Gutenberg database using rigorous fitting procedures, and have tested how well they are described by three Zipf-like distributions.  #@NEW_LINE#@#  Our choice of distributions has not been exhaustive; rather, we have limited ourselves to different interpretations of what can be understood as Zipfs law, in the sense of having a perfect power law either in the probability mass function of word frequencies, or in the complementary cumulative distribution function (whose empirical estimation leads to the rank-frequency relation of the sample), or in the rank-frequency relation of an underlying population.  #@NEW_LINE#@#  Remarkably, the resulting distributions have a unique parameter, , which in all cases is the exponent of an asymptotic power law in the probability mass function of the frequency.  #@NEW_LINE#@#  It is left to explore how other, more complicated extensions of Zipfs law perform on this large corpus, but it is obvious that, by including additional parameters, one might provide good fits to a larger number of texts (although in this case, proper model selection will require to balance number of parameters and parsimony).  #@NEW_LINE#@#  
Our aim in this paper has not been to fit as many texts as possible, but to test the performance of the simplest Zipf-like distributions within a very strict, conservative framework.  #@NEW_LINE#@#  Indeed, by requiring the three versions of Zipfs law to hold on the full range of frequencies n = 1, 2,  (and not only on the tail of the distribution) we put ourselves in the strictest range of demands.  #@NEW_LINE#@#  It is hence remarkable that, e.g., at the standard significance level of 0.05, and for text lengths between 104 and 105 word tokens, more than 40% of the considered texts are statistically compatible with the pure power law in the complementary cumulative distribution function represented by distribution f2 (see Fig 7).  #@NEW_LINE#@#  So, we can state that, for the corpus under consideration, the most appropriate version of Zipfs law is given by a probability mass function  #@NEW_LINE#@#  

or, equivalently, by a complementary cumulative distribution function  #@NEW_LINE#@#  

Due to the broad coverage of the Project Gutenberg corpus we speculate that this distribution should fit a large fraction of generic (non-technical) English texts.  #@NEW_LINE#@#  Of course, testing this speculation in front of all possible corpora is an impossible task.  #@NEW_LINE#@#  
We have also shown that our conclusions regarding the relative performance of a pure power law in the probability mass function, given by distribution f1, versus distribution f2 are robust with respect to changes in the significance level: about twice as many texts are statistically compatible with distribution f2 than those compatible with f1, at any significance level (obviously, in absolute terms, the number of accepted texts varies with the significance level).  #@NEW_LINE#@#  Hence we can conclude that distribution f2 gives a better description of English texts than distribution f1, at least for the corpus considered in this work.  #@NEW_LINE#@#  
We may speculate that the predominance of f2 in front of f1 (and in front of f3) may be a peculiarity of the English language, caused by its poor inflectional morphology.  #@NEW_LINE#@#  Indeed, the difference between these distributions is in the lowest frequencies (mainly n = 1, n = 2).  #@NEW_LINE#@#  Languages with a richer inflectional morphology should yield a larger proportion of low-frequency words (in comparison to the other words) than English, favoring perhaps f1 in front of f2.  #@NEW_LINE#@#  This analysis is left for future studies.  #@NEW_LINE#@#  Lemmatization of texts [6] would be very helpful to test this speculation, but at present we cannot afford large-scale lemmatization.  #@NEW_LINE#@#  
Another conclusion is that distribution f3, first derived by Mandelbrot [40], is irrelevant for the description of texts in this corpus.  #@NEW_LINE#@#  Finally, we have corroborated that the exponent  of Zipfs law certainly varies from text to text, as had been previously claimed using other approaches for defining what Zipfs law is [5, 6].  #@NEW_LINE#@#  Interestingly, the value  = 2 originally proposed by Zipf himself is among the most frequent ones.  #@NEW_LINE#@#  
We believe that our analysis constitutes a major advancement in the understanding of Zipfs law.  #@NEW_LINE#@#  It is astonishing how good the simplest one-parameter Zipf-like distributions perform on such a large set of texts, particularly with the strict set of requirements we have imposed.  #@NEW_LINE#@#  This is in sharp contrast for instance with Zipfs law in demography [59] and in the distribution of income [60], where the power law seems to be valid only for the tail corresponding to the largest sizes, as it happens also for the distribution of word frequency in large text corpora, as mentioned above [2, 3639].  #@NEW_LINE#@#  
Zipfs law has been subject to much debate, and will probably continue to be so for many years.  #@NEW_LINE#@#  Indeed, one can always cast doubt on its validity on the basis of some particular examples.  #@NEW_LINE#@#  Yet it seems clear to us that, in our modern times of big data and large computational capabilities, more efforts should be put towards large-scale analysis of Zipfs law.  #@NEW_LINE#@#  We hope this paper constitutes a first step in this direction.  #@NEW_LINE#@#  

Appendix__Simulation_of_Discrete_Zipf-like_Distributions  #@NEW_LINE#@#  
As part of the testing procedure, we need simulated samples from f1, f2, and f3, which are discrete distributions defined for n = a, a + 1, .  #@NEW_LINE#@#  We will give the recipe of simulation for an arbitrary positive integer value of the lower cut-off a.  #@NEW_LINE#@#  It is simpler to start with f2, as this is used as an auxiliary distribution in the simulation of the other two.  #@NEW_LINE#@#  
Simulation_of_f2  #@NEW_LINE#@#  
Fixed a and given the parameter , we want a set of random numbers whose complementary cumulative distribution function is a discrete power law: S2(n) = (a/n)1.  #@NEW_LINE#@#  For that, we first generate a random number u from a uniform distribution in the interval (0, umax), with umax = 1/a1.  #@NEW_LINE#@#  The inversion method [56, 57] guarantees that if we take x = 1/u1/(1), the values of x yield a continuous power law with , for x  a, where the superscript c distinguishes the continuous distribution from its discrete analogous one.  #@NEW_LINE#@#  So, taking n equal to the integer part of x, i.e., n = int(x), yields a discrete distribution with S2(n) = (a/n)1, as desired.  #@NEW_LINE#@#  This is so because, for any X, int(X)  n is equivalent to X  n for n integer.  #@NEW_LINE#@#  In a recipe:  #@NEW_LINE#@#  
By means of the so-called rejection method [56, 57], simulated integers distributed following f2 can be used for the simulation of integers following f1 or f3.  #@NEW_LINE#@#  The key point to achieve a high performance in the rejection method is to use a good auxiliary function, i.e., one that leads to a low rejection rate.  #@NEW_LINE#@#  This is certainly the case in our framework, as explained below.  #@NEW_LINE#@#  

Simulation_of_f1  #@NEW_LINE#@#  
In this case, the steps are:  #@NEW_LINE#@#  
Note that the rejection method [56, 57] guarantees that the resulting (non-rejected) n will be distributed according to f1.  #@NEW_LINE#@#  
It is easy to check that the maximum of f1/f2 is reached at n = a as this is a decreasing function [41].  #@NEW_LINE#@#  The acceptance condition above can be simplified by taking  = (1 + n1)1, and b = (1 + a1)1, then, the condition becomes:  #@NEW_LINE#@#  

which is devoid of the calculation of the Hurwitz-zeta function.  #@NEW_LINE#@#  This is a generalization for a  1 of the method of Ref.  #@NEW_LINE#@#  [56].  #@NEW_LINE#@#  The choice of f2 as the auxiliary distribution function is justified by the small value that C takes, as this is the expected number of generated values of n until we accept one.  #@NEW_LINE#@#  For instance, for  = 2 and a = 1 we get C = 1.2158.  #@NEW_LINE#@#  

Simulation_of_f3  #@NEW_LINE#@#  
Proceeding similarly, we get in this case low values of C = maxn  a{f3(n)/f2(n)} as well (we get C = 2 in the limit   2 for a = 1).  #@NEW_LINE#@#  The maximum of f3(n)/f2(n) is numerically seen to be reached at n = a.  #@NEW_LINE#@#  In summary, the steps are:  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
We are grateful to the Project Gutenberg initiative, and to those who help maintain it alive.  #@NEW_LINE#@#  S. Pueyo provided bibliographic wisdom for Zipfs law in ecology, I. Serra assistance for ML estimation, and J. Serrà a critical reading of the manuscript.  #@NEW_LINE#@#  I. M.-S. enjoys a contract from the Collaborative Mathematics Project of La Caixa Foundation.  #@NEW_LINE#@#  Research projects in which this work is included are FIS2012-31324, from Spanish MINECO, and 2014SGR-1307, from AGAUR.  #@NEW_LINE#@#  

Author_Contributions  #@NEW_LINE#@#  
Analyzed the data: IMS FFC AC.  #@NEW_LINE#@#  Wrote the paper: IMS FFC AC.  #@NEW_LINE#@#  

References  #@NEW_LINE#@#  



