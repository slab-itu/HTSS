article id="http://dx.doi.org/10.1371/journal.pcbi.1004808"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Reconstruction of Tissue-Specific Metabolic Networks Using CORDA  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Human metabolism involves thousands of reactions and metabolites.  #@NEW_LINE#@#  To interpret this complexity, computational modeling becomes an essential experimental tool.  #@NEW_LINE#@#  One of the most popular techniques to study human metabolism as a whole is genome scale modeling.  #@NEW_LINE#@#  A key challenge to applying genome scale modeling is identifying critical metabolic reactions across diverse human tissues.  #@NEW_LINE#@#  Here we introduce a novel algorithm called Cost Optimization Reaction Dependency Assessment (CORDA) to build genome scale models in a tissue-specific manner.  #@NEW_LINE#@#  CORDA performs more efficiently computationally, shows better agreement to experimental data, and displays better model functionality and capacity when compared to previous algorithms.  #@NEW_LINE#@#  CORDA also returns reaction associations that can greatly assist in any manual curation to be performed following the automated reconstruction process.  #@NEW_LINE#@#  Using CORDA, we developed a library of 76 healthy and 20 cancer tissue-specific reconstructions.  #@NEW_LINE#@#  These reconstructions identified which metabolic pathways are shared across diverse human tissues.  #@NEW_LINE#@#  Moreover, we identified changes in reactions and pathways that are differentially included and present different capacity profiles in cancer compared to healthy tissues, including up-regulation of folate metabolism, the down-regulation of thiamine metabolism, and tight regulation of oxidative phosphorylation.  #@NEW_LINE#@#  

Author_Summary  #@NEW_LINE#@#  
Cellular metabolism is defined by a large, intricate network of thousands of components, and plays a fundamental role in many diseases.  #@NEW_LINE#@#  To study this network in its entirety, metabolic models have been built which encompass all known biochemical reactions in the human metabolism.  #@NEW_LINE#@#  However, since not all metabolic reactions take place in any given tissue, these generalized models need to be tailored to study specific cell types.  #@NEW_LINE#@#  Algorithms developed to date to perform this tailoring process have focused on keeping tissue-specific models as concise as possible.  #@NEW_LINE#@#  This approach, however, can remove essential reactions from the model and hamper subsequent analysis.  #@NEW_LINE#@#  Here we present CORDA, a tissue-specific building algorithm that yields concise, but not minimalistic, tissue-specific models.  #@NEW_LINE#@#  CORDA has many advantages over previous methods, including better agreement with experimental data and better model functionality.  #@NEW_LINE#@#  Using CORDA, we developed a library of 76 healthy and 20 cancer-specific models of metabolism, which we used to identify similarities between healthy and cancerous tissues, as well as metabolic pathways that are unique to cancer.  #@NEW_LINE#@#  Results of this work provide a broadly applicable tool to model cell- and tissue-specific metabolism, while highlighting potential new pathway targets for cancer therapies.  #@NEW_LINE#@#  

Citation: Schultz A, Qutub AA (2016) Reconstruction of Tissue-Specific Metabolic Networks Using CORDA.  #@NEW_LINE#@#  PLoS Comput Biol 12(3):  #@NEW_LINE#@#  
           e1004808.  #@NEW_LINE#@#  

        https://doi.org/10.1371/journal.pcbi.1004808  #@NEW_LINE#@#  
Editor: Costas D. Maranas,  #@NEW_LINE#@#  
The Pennsylvania State University, UNITED STATES  #@NEW_LINE#@#  

Received: September 17, 2015; Accepted: February 13, 2016; Published:  March 4, 2016  #@NEW_LINE#@#  
Copyright:  © 2016 Schultz, Qutub.  #@NEW_LINE#@#  This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.  #@NEW_LINE#@#  
Data Availability: Data are available in the Human Protein Atlas database (http://www.proteinatlas.org/about/download) for both healthy (http://www.proteinatlas.org/download/normal_tissue.csv.zip) and cancerous (http://www.proteinatlas.org/download/cancer.csv.zip) tissues.  #@NEW_LINE#@#  The data used in the mCADRE reconstruction are available in S1 Table.  #@NEW_LINE#@#  
Funding: This work was funded by: National Science Foundation (http://www.nsf.gov/awardsearch/showAward?AWD_ID=1354390&HistoricalAwards=false) grant number 1354390 (AAQ), and National Science Foundation (http://www.nsf.gov/awardsearch/showAward?AWD_ID=1150645&HistoricalAwards=false) grant number 1150645 (AAQ).  #@NEW_LINE#@#  The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  
Competing interests:  The authors have declared that no competing interests exist.  #@NEW_LINE#@#  
Introduction  #@NEW_LINE#@#  
Genome-wide Metabolic Reconstructions (GEMs) computationally model the molecules and reactions responsible for metabolism in any given organism, and have been applied across a variety of fields including metabolic engineering and evolutionary analysis [1].  #@NEW_LINE#@#  Computational methods developed to study GEMs [2] have generated novel hypotheses about the structure of metabolic networks in microorganisms, and helped elucidate gaps in our knowledge of metabolism [3, 4].  #@NEW_LINE#@#  Since the publication of the comprehensive human metabolic reconstruction Recon1 [5], human GEMs have enabled the study of human metabolism at a genome level [6].  #@NEW_LINE#@#  These studies include the prediction of novel metabolic functions [7], prediction of metabolic biomarkers for congenital genetic disorders [8, 9], context analysis of omics data [1012], comparison between humans and other mammals through gene homolog mapping [13, 14], and prediction of suitable cancer drugs [15, 16] and drug targets [1719].  #@NEW_LINE#@#  
A particularly prolific subfield of human GEMs is the development of tissue-specific reconstructions.  #@NEW_LINE#@#  Different groups of metabolic reactions occur in different cell types.  #@NEW_LINE#@#  Hence, numerous studies have been dedicated to generating tissue specific or cell specific models of metabolism [20, 21].  #@NEW_LINE#@#  These tissue-specific reconstructions can be built by piecing together the model based on previously established biological evidence obtained by reviewing the literature [2226], through the integration of omics data and computational methods in order to tailor generic, published human reconstructions [5, 9, 2729] to the desired cell type [15, 16, 3033], or through a combination of computational algorithms and manual curation [27, 28, 3436].  #@NEW_LINE#@#  
Automated tissue-specific reconstruction algorithms developed to date can be broadly categorized into two groups [20]: flux-dependent and pruning methods.  #@NEW_LINE#@#  Flux dependent methods find an optimal flux distribution through the general reconstruction which contains the maximum number of high confidence reactions (i.e.  #@NEW_LINE#@#  reactions whose presence is supported by significant experimental data) [15, 31, 32, 3739].  #@NEW_LINE#@#  These algorithms have been successfully used to predict gene essentiality in cancer tissues [19, 33], cancer specific metabolic pathways [31], metabolic biomarkers for congenital genetic disorders [8, 9], and cancer specific anti-growth factors [15, 16].  #@NEW_LINE#@#  One of the main advantages of flux-dependent methods is the fact that they predict a flux distribution along with the tissue-specific model [20].  #@NEW_LINE#@#  While this characteristic can be desirable, it also renders flux-dependent reconstructions snapshots of the metabolic state defined by the data, as opposed to comprehensive, functional metabolic models [15, 20].  #@NEW_LINE#@#  
The second category of tissue-specific reconstruction methods are pruning algorithms, which include MBA [34], mCADRE [30] and fastCORE [40].  #@NEW_LINE#@#  Models generated using these algorithms have been used to calculate metabolic flux values in hepatocytes [34], identify pathways specific to cancer [30], and predict cancer drug targets [17, 18].  #@NEW_LINE#@#  These algorithms start with a core set of reactions, obtained through literature review or experimental data, and proceed by removing the remaining reactions in the generalized human reconstruction while maintaining functionality in the core set.  #@NEW_LINE#@#  In these algorithms, a tradeoff can be defined between maintaining the model as concise as possible and including all core reactions.  #@NEW_LINE#@#  That is, if a core reaction requires too many undesirable reactions to carry flux, the algorithm may remove this core reaction from the tissue model, a tradeoff referred to as flexible core.  #@NEW_LINE#@#  
There are two main advantages to defining a core set of reactions before performing the tissue-specific algorithm.  #@NEW_LINE#@#  The first advantage is the possible inclusion of multiple sources of data and biochemical information [20, 34].  #@NEW_LINE#@#  The definition of the reactions core is left to the users discretion, allowing for both the combination of data sources and the manual inclusion of reactions.  #@NEW_LINE#@#  Secondly, reactions with overwhelming evidence are always included in the final tissue model, since a non-flexible set of high confidence reactions can be defined [20].  #@NEW_LINE#@#  This pruning approach then allows for the construction of comprehensive tissue models, containing all reactions that may be in a tissues metabolism, as opposed to a snapshot of the metabolic state returned by the flux-dependent methods [15, 20].  #@NEW_LINE#@#  
Current pruning methods are also accompanied by two major limitations, however.  #@NEW_LINE#@#  First, the order in which reactions are removed from the model plays a major role in the final reconstruction.  #@NEW_LINE#@#  Second, similar to flux-dependent methods, current algorithms aim to keep the final tissue-reconstruction as concise as possible, an approach referred to as parsimonious.  #@NEW_LINE#@#  These algorithms aim to remove from the tissue-specific model all reactions for which experimental data is unsupportive or unavailable, such as reactions with low levels of gene expression or non-gene associated reactions.  #@NEW_LINE#@#  While a concise tissue-specific reconstruction is desirable, keeping the reconstruction as parsimonious as possible may lead to the removal of fundamental reactions and physiologically unlikely flux distributions.  #@NEW_LINE#@#  In Recon 1, for instance, oxygen and H2O exchange reactions can be removed from the reconstruction with no effect on model functionality (Fig 1A).  #@NEW_LINE#@#  During simulations, however, these would be replaced by the uptake of the toxic metabolites superoxide anion and hydrogen peroxide respectively, leading to the prediction of physiologically inaccurate flux distributions (Fig 1A).  #@NEW_LINE#@#  The oxygen exchange reaction is in fact not present in the MBA and mCADRE liver reconstructions, and the water exchange reaction is not present in the mCADRE liver reconstruction.  #@NEW_LINE#@#  
(A) Recon1 subnetwork involving water (h2o), oxygen (o2), hydrogen peroxide (h2o2) and superoxide anion (o2s) illustrating how standard oxygen (blue) and water (green) import pathways can be substituted by alternative, physiologically unlikely pathways (red and orange respectively).  #@NEW_LINE#@#  All metabolites and reactions are labeled as in Recon1.  #@NEW_LINE#@#  (B) Overview of the dependency assessment method.  #@NEW_LINE#@#  Each reaction in the reconstruction is associated with a specific cost through the addition of a pseudo-metabolite to the model.  #@NEW_LINE#@#  FBA is then performed while minimizing the cost production in order to identify high cost reactions which are favorable to the reaction being tested.  #@NEW_LINE#@#  (C) The CORDA tissue-specific algorithm.  #@NEW_LINE#@#  During each step, reaction groups being tested are outlined in blue, while reaction groups associated with a high cost are outlined in red.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pcbi.1004808.g001  #@NEW_LINE#@#  
Hence, in order to ensure our algorithm did not rely on alternative, physiologically unlikely pathways, and that it was independent of any ordering assignments, we chose to take an approach which was not parsimonious.  #@NEW_LINE#@#  Here we introduce a novel tissue-specific reconstruction algorithm based on Cost Optimization Reaction Dependency Assessment (CORDA).  #@NEW_LINE#@#  CORDA returns a concise, functional tissue-specific reconstruction, and features a flexible reactions core.  #@NEW_LINE#@#  CORDA does not depend on Flux Variability Analysis [41] or Mixed Integer Linear Programming (MILP) problems, but only on Flux Balance Analysis [42] (FBA), which is dependent on Linear Programming (LP).  #@NEW_LINE#@#  This characteristic renders CORDA considerably faster than previous, similar methods.  #@NEW_LINE#@#  Finally, the CORDA algorithm returns reaction associations that assist in any manual curation to be performed following the automated reconstruction process.  #@NEW_LINE#@#  
In line with previous studies [43], we apply CORDA to generate a library of 76 healthy and 20 cancer-specific metabolic reconstructions.  #@NEW_LINE#@#  These reconstructions enabled us to identify metabolic similarities amongst healthy tissues as well as key differences between healthy and cancerous tissues.  #@NEW_LINE#@#  Furthermore, by sampling the feasible solution space in cancer and healthy models, this library can be used to predict the up- and down-regulation of cancer-specific pathways in cancer metabolism.  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
The_CORDA_algorithm  #@NEW_LINE#@#  
The CORDA algorithm is based on a novel approach to identify the dependency of desirable reactions (i.e.  #@NEW_LINE#@#  reactions with high experimental evidence) on undesirable reactions (i.e.  #@NEW_LINE#@#  reactions with no experimental evidence), a method referred to here as dependency assessment.  #@NEW_LINE#@#  In the dependency assessment approach, the metabolic network is modified in four ways (Fig 1B).  #@NEW_LINE#@#  First, reversible reactions are split into forward and backward components.  #@NEW_LINE#@#  Second, a pseudo-metabolite is added as a product for every reaction in the model.  #@NEW_LINE#@#  At this point, undesirable reactions will carry a higher stoichiometric coefficient for this added metabolite, assigning these reactions a higher cost.  #@NEW_LINE#@#  Third, a reaction consuming this pseudo-metabolite is added to the model.  #@NEW_LINE#@#  Finally, a positive lower bound is set for the reaction being tested in order to force that reaction to carry flux.  #@NEW_LINE#@#  After modifying the network, FBA (Materials and Methods) is performed while minimizing the flux through the cost-consuming reaction (Fig 1B).  #@NEW_LINE#@#  The flux distribution returned will then use high cost, undesirable reactions only as necessary for the reaction being tested to carry flux.  #@NEW_LINE#@#  Throughout the manuscript, we will refer to high cost reactions predicted to carry flux as associated with the reaction being tested.  #@NEW_LINE#@#  In order to identify pathways with the same cost (i.e.  #@NEW_LINE#@#  same number of undesirable reactions), multiple dependency assessment can be performed while adding a small amount of noise to the cost of each reaction.  #@NEW_LINE#@#  
Using this dependency assessment, we have developed the CORDA algorithm for the reconstruction of tissue-specific models (Fig 1C).  #@NEW_LINE#@#  CORDA takes as input the reactions in the generalized human reconstruction separated into high (HC), medium (MC), and negative (NC) confidence groups (see Materials and Methods section for a detailed description).  #@NEW_LINE#@#  All remaining reactions in the reconstruction (i.e.  #@NEW_LINE#@#  non gene associated reactions or reactions for which no data is available) are designated as others (OT).  #@NEW_LINE#@#  All HC reactions are included in the model, and the maximum number of MC reactions is included while minimizing the inclusion of NC reactions.  #@NEW_LINE#@#  While the definition of these four reaction groups are left to the users discretion, here we categorize them according to proteomics data from the Human Protein Atlas (HPA)[44, 45] and a methodology used in previous studies [30, 32, 37] (Materials and Methods).  #@NEW_LINE#@#  To begin the algorithm, all HC reactions are moved into the tissue reconstruction (RE).  #@NEW_LINE#@#  In a first step, MC and NC reactions associated with each RE reaction (which are the same as the HC group at this point) are identified using the dependency assessment and moved into the RE group.  #@NEW_LINE#@#  In a second step, NC reactions associated with a high number of MC reactions are identified and moved into the tissue model, and all remaining NC reactions are blocked (upper and lower bounds set to zero).  #@NEW_LINE#@#  Next, all MC reactions still able to carry flux are also moved to the RE group.  #@NEW_LINE#@#  Finally, in the final step of the algorithm, all OT reactions associated with any RE reaction are moved to the RE group for the final tissue-specific model.  #@NEW_LINE#@#  A detailed description of the CORDA method, including detailed steps, algorithm parameters, and categorization of model reactions is available in the Materials and Methods section.  #@NEW_LINE#@#  

Validation_of_the_CORDA_algorithm  #@NEW_LINE#@#  

Generation_of_multiple_healthy_and_cancer_tissue-specific_models  #@NEW_LINE#@#  
Following the algorithm validation, we generated a library of 76 healthy and 20 cancer tissue-specific models using CORDA.  #@NEW_LINE#@#  In order to generate the most comprehensive models possible, we used the generalized human reconstruction Recon2 [9] in the calculation of this library.  #@NEW_LINE#@#  Recon2 is one of the most comprehensive human reconstructions performed to date, containing approximately twice the amount of reactions than Recon1, 1.7 times more unique metabolites, and 1.2 times more unique genes.  #@NEW_LINE#@#  Details of how the reconstructions were calculated can be found in the Materials and Methods section.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
Here we introduced a novel tissue-specific algorithm based on Cost Optimization Reaction Dependency Assessment (CORDA).  #@NEW_LINE#@#  CORDA relies solely on FBA, rendering it more computationally efficient than previous methods.  #@NEW_LINE#@#  CORDA takes a non-parsimonious approach to the reconstruction process, based on the addition of valuable reactions to the reconstruction as opposed to the removal of non-essential reactions.  #@NEW_LINE#@#  We showed that the CORDA algorithm provides reconstructions that agree better with experimental data, and that demonstrate better metabolic functionality than prior methods like MBA and mCADRE.  #@NEW_LINE#@#  Furthermore, CORDA provides reaction associations that can greatly assist subsequent manual curation, while maintaining the reconstructions only slightly larger than previous parsimonious approaches.  #@NEW_LINE#@#  Monte-Carlo sampling analysis also demonstrates that the CORDA generated models provide better predictions of tissue-specific functionality.  #@NEW_LINE#@#  
In addition to the algorithm validation, we generated a library of 76 healthy and 20 cancer tissue-specific reconstructions, which show considerable agreement with our current knowledge of healthy tissue and cancer metabolism.  #@NEW_LINE#@#  First, as an initial validation of our cancer and healthy tissue models, we computationally predicted metabolites that are more frequently essential in cancer models than healthy tissues [15, 16, 54].  #@NEW_LINE#@#  Two metabolites were implicated in this analysis: phosphatidylethanolamine (pe_hs) and triglyceride (tag_hs), both of which are part of metabolic pathways previously implicated as cancer specific [15, 16].  #@NEW_LINE#@#  While future work is merited to identify more specific essential metabolites (e.g.  #@NEW_LINE#@#  through the inclusion of more comprehensive metabolic tasks in the tissue reconstruction process, and more metabolites in the essential metabolite identification algorithm), these results help validate the cancer and healthy tissue reconstructions presented here.  #@NEW_LINE#@#  
Following this analysis, we demonstrated that the tissue models calculated by CORDA cluster largely according to tissue type.  #@NEW_LINE#@#  Similar clustering patterns, based on gene expression and proteomics data, have been observed experimentally.  #@NEW_LINE#@#  In particular, based on the expression of over 30,000 genes across multiple individuals and tissues, one study found that brain, muscle, and liver tissues, as well as Epstein-Barr virus-transformed lymphocytes, form well defined groups, while skin, adipocytes, and nerve tissues cluster closely together [117].  #@NEW_LINE#@#  A separate study used in the generation of the HPA, based on protein evidence from almost 17,000 protein-coding genes in 44 major tissues and organs, also showed that tonsils, spleen, appendix, and lymph node tissues cluster closely together, and that bone marrow clusters separately, but close to these lymphoid tissues [45].  #@NEW_LINE#@#  
Evidence supporting many of the apparent exceptions identified by our clustering analysis is also available.  #@NEW_LINE#@#  For instance, Uhlén et.  #@NEW_LINE#@#  al.  #@NEW_LINE#@#  found that brain and liver tissues, along with testis, cluster considerably separate from other tissues and closer to each other, which is what we observed by clustering the CORDA models.  #@NEW_LINE#@#  The same study found that prostate tissue clusters closely with salivary glands [45].  #@NEW_LINE#@#  It is worth noting that good agreement with the data by Uhlén et.  #@NEW_LINE#@#  al.  #@NEW_LINE#@#  is expected, given that a subset of this data was used to generate the tissue-specific models.  #@NEW_LINE#@#  This agreement, however, suggests that the similarities between tissues shown by Uhlén et.  #@NEW_LINE#@#  al.  #@NEW_LINE#@#  [45] and Melé et.  #@NEW_LINE#@#  al.  #@NEW_LINE#@#  [117] at the gene expression and protein level are also present in the metabolic enzymes level.  #@NEW_LINE#@#  
Additionally, breast and salivary glands are known to share many morphological features, and studies have shown that both can give rise to tumors with similar morphology [118, 119] and myoepithelial differentiation [120].  #@NEW_LINE#@#  These finding can explain why breast and salivary glands clustered with epithelial and myoepithelial cells, as opposed to glandular cells.  #@NEW_LINE#@#  Finally, skin cancer and non-Hodgkins lymphoma appear frequently as secondary cancers in immunosuppressed individuals [121, 122].  #@NEW_LINE#@#  This could lead to cancers with significantly different metabolic profiles, supporting their separation from the remaining cancer models.  #@NEW_LINE#@#  
Clustering of tissue-specific models according to subsystems has also highlighted many differences between healthy and cancerous tissues at the pathway level (Fig 5).  #@NEW_LINE#@#  Evidence for many of these differences are also available in the literature, including:  #@NEW_LINE#@#  
Single reactions included most often in cancer or healthy tissue models were also analyzed, and again literature evidence has been found to support many of them (Table 3).  #@NEW_LINE#@#  Two surprising findings stemmed from this analysis.  #@NEW_LINE#@#  First is the predicted down-regulation of CoA synthesis reactions, implicated in both the subsystem and single reaction analyses.  #@NEW_LINE#@#  Upon further inspection, we traced this differential inclusion to the gene PPCS, the only gene related to this pathway included in the reconstruction process, which is significantly down-regulated in cancer cells [44, 45].  #@NEW_LINE#@#  Second, the exclusion of ACOAO7p from most cancer models is also unexpected, since this reaction is part of the fatty-acid oxidation pathway, which has been shown to be up-regulated in cancer tissues [123, 124].  #@NEW_LINE#@#  Protein evidence of this reactions associated gene, ACOX1, supports this exclusion from cancer models [44, 45], suggesting an alternate pathway for palmitoyl-CoA oxidation in cancer tissues.  #@NEW_LINE#@#  
Finally, Monte-Carlo sampling was also performed in all healthy and cancer tissue models.  #@NEW_LINE#@#  Sampling results demonstrate that cancer models show an increased capacity through pathways that are largely up-regulated in cancer metabolism, and a reduced capacity through pathways previously shown to be down-regulated.  #@NEW_LINE#@#  Interestingly, mitochondrial respiration showed a slightly reduced and tightly constrained capacity in cancer over healthy tissue models, despite the presence of a larger number of oxidative phosphorylation reactions in cancer models (Fig 5).  #@NEW_LINE#@#  For decades, the role of mitochondrial respiration was thought to be decreased in cancer tissues due to their high glycolytic capacity.  #@NEW_LINE#@#  In recent years, however, researchers have shown that this pathway actually plays an important role in cancer metabolism [125, 126].  #@NEW_LINE#@#  Our results suggest that although a larger number of oxidative phosphorylation reactions are present in cancer models, the activity of this pathway is tightly regulated by cancer metabolism topology (Fig 6).  #@NEW_LINE#@#  On one hand, the low probability of cancer models reaching high cytochrome c oxidase flux values compared to healthy tissues is in line with cancers high glycolytic potential.  #@NEW_LINE#@#  At the other extreme, the low probability of cancer models reaching relatively low cytochrome c oxidase sampled fluxes is in line with the key role played by mitochondrial respiration in cancer metabolism uncovered in recent years.  #@NEW_LINE#@#  
We have also investigated the differences in glycine hydroxymethyltransferase capacity in cancer versus healthy tissue models (S1 Text).  #@NEW_LINE#@#  This reaction is dependent on two proteins, SHMT1 and SHMT2, which correspond the cytosolic and mitochondrial isozymes respectively.  #@NEW_LINE#@#  Both these proteins have been shown to be up-regulated in cancer over healthy tissue models [127], although SHMT2 has been so to a greater extent [71, 127].  #@NEW_LINE#@#  The over expression of these proteins, however, has been shown to be heavily dependent on cancer type [127].  #@NEW_LINE#@#  This claim is supported by the protein expression of SHMT2 in the HPA, where half the cancer types considered have samples with both high and not detected SHMT2 expression.  #@NEW_LINE#@#  This variability could explain why the distribution of reactions associated with these genes is similar between cancer and healthy tissue models (S1 Text).  #@NEW_LINE#@#  Some cancer types, however, show a considerable increase in SHMT2 expression when compared to their healthy counterparts, including breast, glioma, head and neck, lung, stomach, testicular, and thyroid cancer.  #@NEW_LINE#@#  In all but one of these models (glioma), the flux distribution of glycine hydroxymethyltransferase was shown to be considerably shifted towards higher values when compared to their healthy counterparts (S1 Text).  #@NEW_LINE#@#  These results demonstrate CORDAs ability to predict cancer type specific functionality, and not only differences between all cancer and healthy tissues taken together.  #@NEW_LINE#@#  
The CORDA tissue-specific reconstruction algorithm, as well as the healthy and cancer tissue-specific reconstructions presented here, introduce a new approach for the development of comprehensive tissue-specific metabolic reconstructions.  #@NEW_LINE#@#  These reconstructions can generate novel insights into both healthy and diseased human metabolic behavior.  #@NEW_LINE#@#  Furthermore, the ability of CORDA to generate models based solely on experimental data, along with the computational efficiency of this algorithm, allows for continuous updates of this library of tissue-specific models, both as more experimental data is updated and made available, and as more comprehensive human metabolic reconstructions are developed.  #@NEW_LINE#@#  

Materials_and_Methods  #@NEW_LINE#@#  
The_Cost_Optimization_Reaction_Dependency_Assessment_(CORDA)_algorithm  #@NEW_LINE#@#  
While previous methods determined reaction dependencies using Flux Variability Analysis (FVA), the CORDA algorithm takes a different approach, referred here as dependency assessment.  #@NEW_LINE#@#  The novelty of this method lies not in the LP formulation itself, which is the same as the widely established Flux Balance Analysis (FBA), but in the model modifications performed prior to the application of FBA, as well as the interpretation of the flux distribution returned.  #@NEW_LINE#@#  Assuming we want to test whether a given reaction, x, is dependent on the presence of a group of reactions, Y, to carry flux, CORDA proceeds in five steps.  #@NEW_LINE#@#  The parameters required for the CORDA algorithm are summarized in Table 4:  #@NEW_LINE#@#  
It is worth noting that the high cost reactions implicated in step five are not necessarily essential for x to carry a flux ±, but are the set of reactions in Y that combined carry the minimal amount of flux.  #@NEW_LINE#@#  That is, no flux distribution through the metabolic network allows for the predefined flux through x with a lower combined flux through the reactions of Y.  #@NEW_LINE#@#  For instance, if one of the reactions in Y deemed associated with x were to be removed from the reconstruction, x could still be able to carry a flux ±, but the combined flux through the reactions in Y would be larger than before.  #@NEW_LINE#@#  This way, this dependency assessment does not minimize the number of undesirable reactions to allow x to carry flux, but instead the combined flux through them.  #@NEW_LINE#@#  Naturally, however, a lower number of reactions would more easily allow for a lower combined flux.  #@NEW_LINE#@#  It is also for this reason that throughout the manuscript we use the term associate instead of dependent.  #@NEW_LINE#@#  Throughout the literature, referring to one reaction as dependent on another means the removal of the later from the model negates the formers ability to carry flux, which is not necessarily the case for the reaction associations defined here.  #@NEW_LINE#@#  
Another significant advantage of this dependency assessment over previous pruning algorithms is that it requires only the LP problem solved during FBA, rendering it much faster than previous methods.  #@NEW_LINE#@#  While MBA and mCADRE used a much faster variation of FVA, it is still considerably more computationally expensive than LP.  #@NEW_LINE#@#  Although mCADRE is up to three orders of magnitude faster than MBA [30], the mCADRE model used in this study took about 4 hours to be calculated in a 2.34 GHz CPU with 4G RAM using the IBM CPLEX solver [30].  #@NEW_LINE#@#  The CORDA reconstruction, on the other hand, using the same data and general human reconstruction, took under 30 minutes in a 2.66 GHz CPU with 4G RAM using the Gurobi solver [128].  #@NEW_LINE#@#  
In order to obtain a tissue-specific metabolic reconstruction using this dependency assessment, we define the Cost Optimization Reaction Dependency Assessment (CORDA) algorithm.  #@NEW_LINE#@#  This algorithm takes as input the reactions in the generalized human reconstruction divided into four categories:  #@NEW_LINE#@#  
Here, we also allow for the inclusion of metabolic tasks in the HC group.  #@NEW_LINE#@#  That is, during the CORDA algorithm, sinks can be specified for given metabolites, and added to the model when tested to ensure the final tissue model can produce these metabolites.  #@NEW_LINE#@#  These reactions are added when being tested then immediately removed from the model, so that none of these metabolic task reactions are present when other reactions are being tested, and no two test reactions are present in the model at the same time.  #@NEW_LINE#@#  The 32 metabolic tasks included in all CORDA reconstructions in this manuscript are available in S1 Table.  #@NEW_LINE#@#  
While the definition of these reaction groups can be left to the users discretion, here we defined the four groups according to proteomics data from the HPA [44, 45], and boolean gene-reaction rules included in the generalized reconstructions Recon1 and Recon2.  #@NEW_LINE#@#  In the HPA, each protein is classified as being Not Detected, or present at Low, Medium or High levels in each tissue.  #@NEW_LINE#@#  The gene-reaction association rules are composed of gene names and AND and OR boolean associations.  #@NEW_LINE#@#  For instance, the reaction r0634 in Recon2 has the boolean rule HADHB AND (ACAA2 OR ACAA1), and can therefore be considered active if the gene HADHB, as well as ACAA2 or ACAA1, are active.  #@NEW_LINE#@#  
Using this boolean mapping, gene IDs were first replaced by the numerical values -1, 1, 2, and 3, corresponding to Not detected, Low, Medium and High protein expression levels respectively.  #@NEW_LINE#@#  Genes not included in the dataset were assigned a numerical value of zero.  #@NEW_LINE#@#  Next, AND boolean associations were replaced by the function MIN; OR boolean associations were replaced by the function MAX; and the expression was evaluated.  #@NEW_LINE#@#  Reactions with a final score of 3 were assigned to the HC group; reactions with scores of 1 or 2 were assigned to the MC group; and reactions with a score of -1 were assigned to the NC group.  #@NEW_LINE#@#  Reaction scores of -1, 1, 2, and 3 also correspond to Not Detected, Low, Medium, and High expression levels expressed in Fig 2.  #@NEW_LINE#@#  
As an example, HADHB is expressed at low levels in cerebellum Purkinje cells; ACAA2 is not detected; and ACAA1 is expressed at high levels.  #@NEW_LINE#@#  The r0634 gene-reaction rule mentioned above was then be replaced by MIN(1,MAX(-1,3)), which evaluates to 1.  #@NEW_LINE#@#  During the Purkinje cells reconstruction, this reaction was then placed in the MC group.  #@NEW_LINE#@#  Similar approaches have been used by previous studies to assign reaction confidence scores [30, 32, 37].  #@NEW_LINE#@#  
Aside from the four reaction groups, the CORDA algorithm also requires 5 parameters to operate, which are summarized in Table 4.  #@NEW_LINE#@#  To begin the algorithm, all HC reactions are moved into the tissue-specific reconstruction (RE), since these are sure to be included in the final model.  #@NEW_LINE#@#  Given the remaining three reaction groups, the CORDA algorithm proceeds in three steps:  #@NEW_LINE#@#  
It is worth noting that one of the main advantages of CORDA over pruning algorithms is the fact that it is independent of how reactions are ordered.  #@NEW_LINE#@#  This is due to the fact that reaction associations are calculated for each step, and at the end of each step a decision is made as to which reactions are added to the tissue reconstruction.  #@NEW_LINE#@#  This way, the order in which reaction dependencies are calculated does not affect the final tissue reconstruction.  #@NEW_LINE#@#  
The CORDA reconstructions used for comparison to previous methods were generated using  = 105, the highest cost value tested,  = 10-2, the lowest noise value tested,  = 1, a threshold similar to a previous study [32], n = 5, to allow for the inclusion of a larger number of OT reactions, and p = 2.  #@NEW_LINE#@#  
For a direct comparison to previous methods, the CORDA reconstructions used during the parameter sensitivity analysis, cross-validation, and comparison to previous methods were performed using the same data used for the mCADRE hepatocyte reconstruction.  #@NEW_LINE#@#  For the Monte-Carlo sampling analysis, a new reconstruction was generated using the most up-to-date data from the HPA.  #@NEW_LINE#@#  Both of these reconstructions are available in the supplemental material (S1 File).  #@NEW_LINE#@#  All calculations in this study were performed using the COBRA toolbox [129] and the Gurobi optimizer [128].  #@NEW_LINE#@#  The MATLAB function file used for CORDA reconstructions is also available in the supplemental material (S2 File).  #@NEW_LINE#@#  Finally, an example of the CORDA algorithm, applied to small sample networks, is available in S2 Text.  #@NEW_LINE#@#  

Parameter_sensitivity_analysis  #@NEW_LINE#@#  
While CORDA requires a number of different parameters, many of these values can be arbitrarily assigned.  #@NEW_LINE#@#  For instance,  can be arbitrarily large, while  and  can be arbitrarily small.  #@NEW_LINE#@#  In order to demonstrate that the CORDA algorithm is robust to a wide range of parameters, we performed 108 hepatocyte specific reconstructions varying all parameters but p (which was set to be equal to two) to a wide range of values.  #@NEW_LINE#@#  A separate sensitivity analysis of p was performed and is included in S1 Text.  #@NEW_LINE#@#  The parameter p can be set in order to define a more or less flexible MC and NC core, and can be set to the users discretion.  #@NEW_LINE#@#  
These 108 reconstructions were based on the generalized human reconstruction Recon1 [5], using the same set of protein expression data (total of 560) and 32 of the metabolic tests used in the mCADRE hepatocyte specific reconstruction [30].  #@NEW_LINE#@#  The data used in this step, as well as the metabolic tests and calculated reaction groups, are available in the supplemental information (S1 Table).  #@NEW_LINE#@#  Metabolic tests were included as single reactions in the reconstruction in order to assure the model was able to produce certain metabolites.  #@NEW_LINE#@#  Each metabolic test was added to the model when being tested then immediately removed, so that no two tests were present in the model at the same time, and no metabolic test reaction was included when other reactions were being assessed.  #@NEW_LINE#@#  Details of this analysis are available in S1 Text.  #@NEW_LINE#@#  

Metabolic_tests_analysis  #@NEW_LINE#@#  
During the metabolic tasks validation analysis, the exchange rate of the basal inputs carbon dioxide (co2[e]), water (h2o[e]), protons (h[e]), oxygen (o2[e]), phosphate (pi[e]), hydrogen peroxide (h2o2[e]), superoxide anion (o2s[e]), bicarbonate (hco3[e]) and carbon monoxide (co[e]) were unconstrained.  #@NEW_LINE#@#  All other uptake reactions were blocked unless otherwise specified.  #@NEW_LINE#@#  
For each of the 20 amino-acid recycling tests, the uptake rate of the given amino acid and glucose were set to an arbitrary value, so that the amino-acid being tested was the only source or nitrogen.  #@NEW_LINE#@#  Next, the production of urea was set to a strictly positive value, and FBA was performed while optimizing the production of urea.  #@NEW_LINE#@#  The same test was also performed for ammonium.  #@NEW_LINE#@#  For each of the 21 glucogenic tests, the uptake rate of the given metabolite was set to an arbitrary value, and the production of glucose was optimized.  #@NEW_LINE#@#  For both the amino-acid and glucogenic tests, if the model returned a feasible flux distribution the test was considered passed, otherwise it was considered failed.  #@NEW_LINE#@#  If the exchange reaction of the given metabolite was not present in the model, the result was considered inconsistent.  #@NEW_LINE#@#  The generalized Recon1 reconstruction failed two of the glucogenic tests, so the results of the remaining 19 tests are reported in the main text.  #@NEW_LINE#@#  
For the eight nucleotide production tests, a sink consuming the given nucleotide was added to the cytosolic compartment.  #@NEW_LINE#@#  The model was allowed to uptake glucose and ammonium (as a source of nitrogen), and the flux through the sink was optimized.  #@NEW_LINE#@#  If the model was able to produce the given nucleotide, the test was considered passed.  #@NEW_LINE#@#  

Generation_of_healthy_and_cancer_tissue_models  #@NEW_LINE#@#  
Following the validation of the CORDA algorithm, we generated a library of 76 healthy and 20 cancer tissue-specific reconstructions using the generalized human reconstruction Recon2 [9] and the most recent proteomics data from the HPA [44, 45].  #@NEW_LINE#@#  All reactions used to generate the tissue-specific models are available in S1 Table, and tissue-specific models are available in SBML and MATLAB format at [130].  #@NEW_LINE#@#  The healthy tissue models were calculated using the same classification as described in the algorithm description section, since data for each protein was categorized as not detected, low, medium or highly expressed in each cell type.  #@NEW_LINE#@#  For cancer models, the same classification was available for any number of samples for each protein in each cancer type.  #@NEW_LINE#@#  In this case, values of -1, 1, 2 and 3 were assigned to each sample according to not detected, low, medium or high expression levels respectively, and these values were averaged for a final protein score in that particular cancer type.  #@NEW_LINE#@#  These protein values were then used in the gene-reaction boolean association as described in the algorithm description for a final reaction score.  #@NEW_LINE#@#  Reactions with a score equal to or greater than 2.5 were assigned to the HC group, less than 2.5 but greater than 1 to the MC group, and less than or equal to -0.5 to the NC group.  #@NEW_LINE#@#  
For instance, in renal cancer samples, protein HADHB has been analyzed in 12 different samples in the HPA, and was found to be expressed in high levels in 2 of them, medium levels in 8, and in low levels in 2.  #@NEW_LINE#@#  The protein score associated with HADHB in renal cancer is then calculated as .  #@NEW_LINE#@#  Similarly, ACAA1 expression was calculated as medium in 5 samples, low in two samples, and not detected in four samples of renal cancer, yielding a score of .  #@NEW_LINE#@#  Finally, ACAA2 is present in high levels in one sample, medium level in 5 samples, low levels in one sample and not detected in 3 samples of renal cancer, giving this protein a score of .  #@NEW_LINE#@#  With that, the score for r0634 is calculated as MIN(2,MAX(0.73,1.1)), which is 1.1, putting this reaction in the MC group during the renal cancer reconstruction.  #@NEW_LINE#@#  Data and reaction distributions used during these calculations can be found in S1 Text.  #@NEW_LINE#@#  

Clustering_of_healthy_and_cancer_tissue_models  #@NEW_LINE#@#  
Healthy and cancer specific models were clustered according to reactions present in each model.  #@NEW_LINE#@#  For that, 4,205 reactions present in at least one, but not all models were obtained.  #@NEW_LINE#@#  A binary vector was then calculated for each model indicating whether reactions were present (1) or not present (-1).  #@NEW_LINE#@#  These vectors were then clustered using hierarchical clustering with Hamming distance as the similarity metric, and average linkage.  #@NEW_LINE#@#  Leaf orders were also calculated in order to maximize the similarity between neighbors in the hierarchical binary cluster tree dendrogram.  #@NEW_LINE#@#  These results are summarized in Fig 4.  #@NEW_LINE#@#  
Next, in order to divide the clusters according to subsystem expression, a total of 4,751 reactions present in any of the models was obtained.  #@NEW_LINE#@#  These reactions were then divided by subsystem according to their classification in the Recon2 reconstruction.  #@NEW_LINE#@#  For each of the clusters of models calculated in the previous step, the average number of reactions from each subsystem included in the clusters models was then calculated.  #@NEW_LINE#@#  Finally, this number was divided by the total number of reactions in that subsystem which were included in any of the models for a final score between zero and one.  #@NEW_LINE#@#  These values were then clustered using hierarchical clustering with Euclidean distance as the similarity metric, and average linkage.  #@NEW_LINE#@#  Leaf orders were again organized to maximize similarity between neighbors to yield Fig 5.  #@NEW_LINE#@#  

Flux_Balance_Analysis  #@NEW_LINE#@#  
Perhaps the most widely used method to analyze GEMs is Flux Balance Analysis (FBA) [42].  #@NEW_LINE#@#  FBA predicts a flux distribution through the metabolic network which optimizes (maximizes or minimizes) a given objective function, defined as a single reaction or group of reactions in the network.  #@NEW_LINE#@#  This flux distribution is subject to upper- and lower-bound constraints, which include exchange reactions, and a steady state assumption for all model metabolites, so that no metabolite has a net production or consumption rate.  #@NEW_LINE#@#  
The mathematical formulation of GEMs are defined at the core by a stoichiometric matrix S, where each row defines a metabolite, each column defines a reactions, and each entry the stoichiometric coefficient of that metabolite in that particular reaction.  #@NEW_LINE#@#  Vectors defining lower (lb) and upper (ub) bounds for each reaction, as well as an objective vector (c) of the same length, are also defined.  #@NEW_LINE#@#  Given this model, FBA finds a flux vector v through all reactions in the GEM such that:  #@NEW_LINE#@#  

During the dependency assessment described here, the stoichiometric matrix S is altered to reflect the changes described above.  #@NEW_LINE#@#  Given a reaction j being tested, a group of undesirable reactions Y, and a matrix S of size m by n, let  denote a random number drawn uniformly between 0 and .  #@NEW_LINE#@#  The GEM is modified in the following ways:  #@NEW_LINE#@#  
With these constraints in place, FBA is performed as described above while minimizing the objective function.  #@NEW_LINE#@#  For each reaction in the reconstruction, if i  Y and vi  0, the reaction i is deemed associated with j.  #@NEW_LINE#@#  

Monte-Carlo_sampling  #@NEW_LINE#@#  
Monte-Carlo sampling was performed in a manner similarly to Bordbar et.  #@NEW_LINE#@#  al.  #@NEW_LINE#@#  [25] and Lewis et.  #@NEW_LINE#@#  al.[49].  #@NEW_LINE#@#  This sampling method is a slight variation of the Artificially Centered Hit and Run (ACHR) algorithm developed by Kaufman and Smith [131].  #@NEW_LINE#@#  In this algorithm, warmup points are initially generated at random corners of the solution space by solving an LP problem with objective vectors containing randomly generated ones and negative ones.  #@NEW_LINE#@#  The center point between all points is then computed.  #@NEW_LINE#@#  Next, for each point sampled, a random direction is selected as the difference between a randomly selected point and the center point.  #@NEW_LINE#@#  By selecting the direction this way, the direction is biased in the longer direction of the solution space, speeding up the rate of mixing while maintaining uniformity.  #@NEW_LINE#@#  After a direction is chosen, the limit of how far the current point can travel in that direction is calculated, and a new point is randomly chosen along that line.  #@NEW_LINE#@#  After several iterations, the set of generated points will be well mixed and approach a uniform sampling of the solution space.  #@NEW_LINE#@#  
The termination condition imposed on the ACHR algorithm here is the same imposed by Bordbar et.  #@NEW_LINE#@#  al.  #@NEW_LINE#@#  [25] and Lewis et.  #@NEW_LINE#@#  al.  #@NEW_LINE#@#  [49], introducing the concept of mixed fraction.  #@NEW_LINE#@#  For that, a partition is created over the set of points by drawing a line at the median value, with half the points on either side of the partition.  #@NEW_LINE#@#  The mixed fraction is the number of points that cross this line during mixing.  #@NEW_LINE#@#  Initially, the mixed fraction is one as all the points are on their original side of the line.  #@NEW_LINE#@#  As the sample solutions are mixed, the probability of each point crossing the median line approaches 0.5 asymptotically.  #@NEW_LINE#@#  The sampled points were initially mixed using the warmup points created as described above until the mixed fraction reached a particular threshold.  #@NEW_LINE#@#  Following that, the samples were mixed two more times, using the previous iterations final points as warmup points, until the same mixed fraction was reached.  #@NEW_LINE#@#  For the comparison between CORDA and other tissue-specific algorithms, a mixed fraction threshold of 0.52 was chosen as the termination condition.  #@NEW_LINE#@#  For the cancer and healthy tissue-specific models, a mixed fraction threshold of 0.6 was chosen to make the 96 sampling experiments computationally feasible.  #@NEW_LINE#@#  
Due to the heterogeneity between tissue-specific models, sampled flux values were evaluated between all cancer and healthy tissue models separately.  #@NEW_LINE#@#  That is, all sampled flux values for the given reaction were obtained from all cancer models that contain that reaction, and compared to all sampled values from healthy tissue models that contain the reaction.  #@NEW_LINE#@#  Results of this analysis are presented in Fig 6.  #@NEW_LINE#@#  In some cases, two or more reactions were combined: MTHFD2* combines reactions MTHFD2 and MTHFD2m, GHMT2r* combines reactions GHMT2r and GHMT2rm, and SPODM* combines reactions SPODM, SPODMe, SPODMm, SPODMn and SPODMx.  #@NEW_LINE#@#  These are the same reactions taking place in different cellular compartments.  #@NEW_LINE#@#  For these, flux values from each of these groups of reactions were added within each sampled flux distribution when plotting Fig 6.  #@NEW_LINE#@#  




