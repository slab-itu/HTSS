article id="http://dx.doi.org/10.1371/journal.pone.0198163"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Competition and niche construction in a model of cancer metastasis  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Niche construction theory states that not only does the environment act on populations to generate Darwinian selection, but organisms reciprocally modify the environment and the sources of natural selection.  #@NEW_LINE#@#  Cancer cells participate in niche construction as they alter their microenvironments and create pre-metastatic niches; in fact, metastasis is a product of niche construction.  #@NEW_LINE#@#  Here, we present a mathematical model of niche construction and metastasis.  #@NEW_LINE#@#  Our model contains producers, which pay a cost to contribute to niche construction that benefits all tumor cells, and cheaters, which reap the benefits without paying the cost.  #@NEW_LINE#@#  We derive expressions for the conditions necessary for metastasis, showing that the establishment of a mutant lineage that promotes metastasis depends on niche construction specificity and strength of interclonal competition.  #@NEW_LINE#@#  We identify a tension between the arrival and invasion of metastasis-promoting mutants, where tumors composed only of cheaters remain small but are susceptible to invasion whereas larger tumors containing producers may be unable to facilitate metastasis depending on the level of niche construction specificity.  #@NEW_LINE#@#  Our results indicate that even if metastatic subclones arise through mutation, metastasis may be hindered by interclonal competition, providing a potential explanation for recent surprising findings that most metastases are derived from early mutants in primary tumors.  #@NEW_LINE#@#  

Citation: Qian JJ, Akçay E (2018) Competition and niche construction in a model of cancer metastasis.  #@NEW_LINE#@#  PLoS ONE 13(5):  #@NEW_LINE#@#  
           e0198163.  #@NEW_LINE#@#  

        https://doi.org/10.1371/journal.pone.0198163  #@NEW_LINE#@#  
Editor: Zhiqian Zhang,  #@NEW_LINE#@#  
Beijing Cancer Hospital, CHINA  #@NEW_LINE#@#  

Received: January 24, 2018; Accepted: May 15, 2018; Published:  May 29, 2018  #@NEW_LINE#@#  
Copyright:  © 2018 Qian, Akçay.  #@NEW_LINE#@#  This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.  #@NEW_LINE#@#  
Data Availability: All relevant data are within the paper and its Supporting Information files.  #@NEW_LINE#@#  
Funding: J.J.Q.  #@NEW_LINE#@#  was supported by a summer stipend from the Roy and Diana Vagelos Scholars Program in the Molecular Life Sciences at the University of Pennsylvania (http://www.sas.upenn.edu/biochem/vspmls.html).  #@NEW_LINE#@#  The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  
Competing interests:  The authors have declared that no competing interests exist.  #@NEW_LINE#@#  
Introduction  #@NEW_LINE#@#  
A cancer tumor is a collection of abnormal cells whose unregulated proliferation damages surrounding host tissue, often resulting in patient death.  #@NEW_LINE#@#  It is also a population of genetically and phenotypically diverse cells that compete, propagate, and contribute (or not) to the cellular society.  #@NEW_LINE#@#  Tools from population biology are therefore increasingly used to study cancer dynamics.  #@NEW_LINE#@#  Cancers genetic instability and high mutation rate, compounded with harsh spatial constraints, a dearth of nutrients, and immune surveillance, lead to rapid selection for the survival of the fittest tumor cells.  #@NEW_LINE#@#  However, the evolutionary dynamics of tumors are only fully comprehensible when the ecological contextthe tumor ecosystemis considered [1, 2].  #@NEW_LINE#@#  This entails applying ecological concepts such as predation, niches, and invasion (in evolutionary theory and in this paper, invasion refers to the establishment of a mutant genotype into an existing population, a concept distinct from cancer invasion, or expansion, into surrounding tissue).  #@NEW_LINE#@#  Accordingly, a number of ecological models have provided useful insight into cancer progression [3, 4].  #@NEW_LINE#@#  
A recently influential idea in ecology is that not only does the environment act on a population to generate selection pressures and Darwinian evolution, but organisms reciprocally modify the environment through a process called niche construction (also known as ecological engineering) [5, 6].  #@NEW_LINE#@#  Via niche construction, organisms not only influence aspects of the ecosystem such as resource flow and trophic relationships, but they modify the actual sources of natural selection acting on themselves and their neighbors.  #@NEW_LINE#@#  For example, new selection pressures on beavers teeth, tail, and social behavior arise due to the construction of a dam [6].  #@NEW_LINE#@#  The environmental modifications resulting from niche construction may be passed down to descendants through ecological inheritance, which has been recognized as a key aspect of extra-genetic inheritance [7].  #@NEW_LINE#@#  
Niche construction also likely plays an important role in cancer population biology [811].  #@NEW_LINE#@#  Cancer cells greatly alter their microenvironments.  #@NEW_LINE#@#  For example, tumor cells release angiogenic factors such as vascular endothelial growth factor and stimulate vascularization [1214], reduce local pH [15], release a gamut of growth factors such as insulin-like growth factor II [16], and secrete matrix metalloproteinases that degrade extracellular matrix proteins [12].  #@NEW_LINE#@#  Tumors also drastically alter the local flow of nutrients and signaling factors, creating a nutrient-poor ecosystem that is passed down to descendant cells via ecological inheritance.  #@NEW_LINE#@#  This ecological inheritance promotes tumor cell heterogeneity and cancer growth, suggesting that cancer niche construction may be a worthwhile therapeutic target [8].  #@NEW_LINE#@#  
In this paper, we use niche construction theory to examine metastasis.  #@NEW_LINE#@#  Metastasis is not simply a result of mutation of tumor subclones into more invasive phenotypes and subsequent cell dissemination; it additionally requires the construction of a pre-metastatic niche [10, 1722].  #@NEW_LINE#@#  The concept of the pre-metastatic niche dates back to Pagets seed and soil hypothesis, which states that tumors (the seed) are predisposed to metastasize to certain organs (the soil) because the metastatic site must provide a milieu conducive to the recruitment and settlement of disseminated tumor cells [23].  #@NEW_LINE#@#  This receptive microenvironment, termed the pre-metastatic niche, must be established before metastasis can occur [10, 1722].  #@NEW_LINE#@#  Examples of pre-metastatic niche construction include increasing vascular permeability and clot formation, altering local resident cells such as fibroblasts, remodeling the extracellular matrix, and activating and recruiting non-resident cells such as haematopoietic progenitor cells and other bone marrow-derived cells, which further induce many subsequent changes [17].  #@NEW_LINE#@#  Interestingly, evidence has shown that primary tumors actively prepare distant organs for reception of future metastatic cells by secreting various factors and extracellular vesicles that foster pre-metastatic niche construction into the bloodstream [1722, 2429].  #@NEW_LINE#@#  Primary tumor-derived secretions that promote pre-metastatic niche construction include TGF [18, 21], TNF- [18], placental growth factor [18, 22], vascular endothelial growth factor [18, 21, 22], lysyl oxidase [19], microvesicles [29], exosomes [20, 2628], and many more [17, 18].  #@NEW_LINE#@#  These findings show that some primary tumor cells sacrifice metabolic resources in order to promote successful settlement by their disseminated descendants into metastatic sites, which provides no benefit to themselves.  #@NEW_LINE#@#  Why such behavior is so common is an interesting question especially because the ability of a tumor to metastasize cannot evolve adaptively analogous to life-history traits, since tumors are not selected to metastasize between generations and cancer lineages are in general evolutionary dead-ends [2].  #@NEW_LINE#@#  Accordingly, the ability to metastasize, when it does occur, arises as a result of local ecological dynamics of a tumor.  #@NEW_LINE#@#  In this paper, we are interested in the fate of primary tumor mutations that promote pre-metastatic niche construction, rather than the entire metastatic cascade or settlement into the metastatic site.  #@NEW_LINE#@#  
Although previous work has recognized the applicability of niche construction theory to cancer [8, 9], there are only a few formal models of the phenomenon.  #@NEW_LINE#@#  Among these, Bergman and Gligorijevic [10] proposed a framework to integrate experimental metastasis data with niche construction theory, with the goal of providing a predictive model that can be directly parameterized.  #@NEW_LINE#@#  Another model by Gerlee and Anderson [30] studied the evolution of tumor carrying capacity as a function of niche construction.  #@NEW_LINE#@#  They assumed that niche construction increases the tumor carrying capacity, a phenomenon commonly seen in ecological settings.  #@NEW_LINE#@#  They noted that tumors may include both producers, which actively contribute to niche construction, and cheaters, which reap the benefits of niche construction without paying the growth rate cost of production.  #@NEW_LINE#@#  They showed that the specificity of the benefits from niche construction as well as spatial structure maintains selection for producers and allows for coexistence of cheaters and producers.  #@NEW_LINE#@#  
Another idea that motivates our model is the recent observation that metastatic cell lineages tend to diverge from the primary tumor early on [31].  #@NEW_LINE#@#  In other words, metastasis involves mutations that occur early in the tumors lifetime.  #@NEW_LINE#@#  This finding contradicts the linear progression model of cancer, where metastatic tumors arise from late-stage primary tumors.  #@NEW_LINE#@#  This finding is somewhat paradoxical, since later-stage primary tumors are bigger and therefore harbor more mutations from which metastatic tumors might arise, and hence one might expect more metastatic tumors to be derived from late-stage tumors.  #@NEW_LINE#@#  As we will see below, competition between local and pre-metastatic niche constructors may provide a potential answer to this paradox.  #@NEW_LINE#@#  
We present a mathematical model of niche construction and metastasis in cancer.  #@NEW_LINE#@#  Our model contains producers of both the primary tumor (i.e., local) niche and the pre-metastatic niche, as well as cheaters.  #@NEW_LINE#@#  We model a tumor population with a carrying capacity that increases with local niche construction.  #@NEW_LINE#@#  We derive expressions for the ecological conditions necessary for metastasis, showing that they depend on niche construction specificity and the interclonal competition structure.  #@NEW_LINE#@#  Our results reveal a robust trade-off between the arrival of metastasis-promoting mutants and their ability to invade a tumor.  #@NEW_LINE#@#  Tumors composed only of cheaters remain small but are susceptible to invasion by cells that construct the pre-metastatic niche, whereas larger tumors containing producers may be unable to facilitate metastasis depending on the level of niche construction specificity.  #@NEW_LINE#@#  In certain competition structures, tumors containing only local producers can completely preclude metastasis unless invasion of metastasis-promoting subclones occurs early on.  #@NEW_LINE#@#  Our results highlight the fact that metastasis requires both the necessary genetic mutations and a suitable ecological milieu: even if metastatic subclones arise through mutation, invasion may not be possible due to competitive exclusion and a lack of niche opportunities.  #@NEW_LINE#@#  These findings can explain the observation that metastasis involves early mutations [31].  #@NEW_LINE#@#  

Methods  #@NEW_LINE#@#  
We consider a primary tumor with N cells, which can include both producers and cheaters, and a bloodstream into which tumor cells can enter via intravasation.  #@NEW_LINE#@#  (An extended form of the model is discussed in S1 Appendix.)  #@NEW_LINE#@#  Producers participate in niche construction at a cost to their growth rate, since it takes energy and metabolic resources to secrete angiogenic factors, growth factors, and matrix metalloproteinases.  #@NEW_LINE#@#  Cheaters do not participate in niche construction but still benefit from it, so they have a higher growth rate than producers.  #@NEW_LINE#@#  We assume that a cells type (producer or cheater) is determined genetically.  #@NEW_LINE#@#  
There are three subsets of producers.  #@NEW_LINE#@#  Local producers contribute only to niche construction in the tumors immediate microenvironment, benefiting primary tumor cells but not circulating or metastasized cells.  #@NEW_LINE#@#  The extent of local niche construction is represented by the amount of resource R, a general resource that for example could represent the amount of recruited vasculature.  #@NEW_LINE#@#  The primary tumor also includes secondary producers, which contribute to the spatially distant pre-metastatic niche by secreting chemokines, growth factors, and exosomes into the bloodstream to allow circulating tumor cells to settle down to form a secondary tumor, as mentioned in the introduction.  #@NEW_LINE#@#  These molecules are carried away from the primary tumor and provide no benefit to primary tumor cells, so construction of the pre-metastatic niche is not included in the variable R. Secondary producers pay a growth cost similar to primary producers, but they otherwise act as cheaters from the primary tumors point of view since they benefit from R without contributing to it.  #@NEW_LINE#@#  Additionally, there are global producers that contribute to niche construction in both the primary microenvironment and the pre-metastatic niche and pay double the growth rate cost.  #@NEW_LINE#@#  Because pre-metastatic niche construction is required for metastasis, as discussed above, we treat the existence of secondary or global producers as a necessary condition for metastasis, consistent with our focus on interrogating the prerequisites of metastasis within the primary tumor.  #@NEW_LINE#@#  S2 Appendix discusses how our model is robust to changes in the interpretation of the four cell types and shows how our model may be generalized without changing the mathematical details or results.  #@NEW_LINE#@#  
Cells are given a subscript (x, y), where x  {0, 1} describes participation in local niche construction (0 for cheaters and 1 for producers) and y  {0, 1} similarly denotes participation in pre-metastatic niche construction.  #@NEW_LINE#@#  The population of each cell type is nx,y with respective growth rates rx,y.  #@NEW_LINE#@#  Local and global producers increase R with rate g and R suffers independent resource depletion with rate l. Fig 1 shows a schematic representation of the model.  #@NEW_LINE#@#  
The model considers a primary tumor with four cell types and a distant pre-metastatic niche.  #@NEW_LINE#@#  Cheaters are white, local producers are blue, secondary producers are red, and global producers are both red and blue.  #@NEW_LINE#@#  Niche construction occurs in the primary microenvironment through production of resource R, which benefits the tumor by increasing carrying capacity, represented as a dotted line.  #@NEW_LINE#@#  Construction of the pre-metastatic niche by primary tumor cells is represented by the red arrow.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0198163.g001  #@NEW_LINE#@#  
Primary tumor cells enter the bloodstream as a result of intravasation.  #@NEW_LINE#@#  Local crowding has been suggested to cause a reduction in tumor cell fitness and lead to increased mutation rate and ecological dispersal [8].  #@NEW_LINE#@#  Other studies have provided evidence that haematogenous tumor cell dissemination can begin early during primary tumor development and progression [21, 32, 33].  #@NEW_LINE#@#  To account for these results and the ecological dispersal hypothesis, we introduce a function m(N, R) representing the rate at which primary tumor cells exit the local niche and enter the bloodstream.  #@NEW_LINE#@#  We assume this function has the form  where  is a constant and the denominator is the carrying capacity (discussed below).  #@NEW_LINE#@#  Cells tend to migrate more when they receive less of the share of resources in the microenvironment [8, 3437].  #@NEW_LINE#@#  It is important to note that the precise form of this dispersal function is not crucial to our results, because parameter estimation (see S3 Appendix) suggests  is several orders of magnitude smaller than any other parameter, a fact we use in simplifying our results as described later.  #@NEW_LINE#@#  
Carrying_capacity  #@NEW_LINE#@#  
We assume carrying capacity increases linearly with niche construction.  #@NEW_LINE#@#  Primary and secondary tumors possess intrinsic carrying capacity k, which can represent the number of cells that can survive without significant self-induced angiogenesis or release of growth factors.  #@NEW_LINE#@#  In the primary tumor, the carrying capacities of cheaters and secondary producers are both k+0 R(t) while those of primary and global producers are k+1 R(t).  #@NEW_LINE#@#  0 and 1 are constants describing the benefit that either cheaters or producers receive from niche construction.  #@NEW_LINE#@#  If 0  1, then either cheaters or producers use the resource more efficiently.  #@NEW_LINE#@#  This is analogous to the specificity of niche construction in Gerlee and Andersons model [30].  #@NEW_LINE#@#  If , modifications of the niche are specific to the genotype that generates it and cheaters are less able to free-ride.  #@NEW_LINE#@#  Strong specificity refers to .  #@NEW_LINE#@#  

Competition  #@NEW_LINE#@#  
We assume cells grow according to Lotka-Volterra competition equations, shown in Table 1 with the parameters summarized in Table 2.  #@NEW_LINE#@#  We consider multiple competition structures with varying competition strength among the four cell types, summarized in Fig 2.  #@NEW_LINE#@#  In each, the strength of inter-type competition between the four cell types (symmetric in competition structures I and II) is denoted by Greek letters whose values are positive and less than or equal to 1.  #@NEW_LINE#@#  The magnitude of intraclonal competition is 1, such that interclonal competition strength is weaker than or equal to intraclonal competition.  #@NEW_LINE#@#  Biologically, stronger intra-type competition can stem from spatial considerations since cellular neighbors tend to be of the same cell type.  #@NEW_LINE#@#  During competition for resources on a local spatial scale, cells therefore compete more strongly with members of the same type.  #@NEW_LINE#@#  Stronger intra-type competition can also arise because different cell types utilize other resources (that we do not explicitly model) differentially.  #@NEW_LINE#@#  Cells of different clones may focus on different cellular pathways and require a different profile of metabolic resources.  #@NEW_LINE#@#  For example, cheaters focus on cell division and require a significant commitment to nucleotide biosynthesis and genome duplication.  #@NEW_LINE#@#  Producers, on the other hand, focus on protein production.  #@NEW_LINE#@#  The assumption that intraclonal competition is equal to or stronger than interclonal competition is discussed in further detail in the Discussion.  #@NEW_LINE#@#  
Competition structure I is the most general symmetric case in which no assumptions are made about the relative magnitudes of the various interclonal competition terms.  #@NEW_LINE#@#  By starting with this most general case, we show our results are robust to parameterization.  #@NEW_LINE#@#  Competition structure II and III are less general, as certain assumptions are made about the relative competition strengths.  #@NEW_LINE#@#  In competition structure II, interclonal competition between producers is as strong as intraclonal competition, while cheaters compete less with all three producer types.  #@NEW_LINE#@#  This scenario may arise if primary and secondary niche construction require similar metabolic resources so all producers occupy the same ecological niche, whereas cheaters focus on their own division instead of ecological engineering.  #@NEW_LINE#@#  In other words, cheaters express a unique phenotype with different target metabolic resources and cellular pathways than the producer types.  #@NEW_LINE#@#  Competition structure III assumes the two distinct niches in the tumor ecosystem are producing and cheating in the primary tumor regardless of propensity for secondary resource production.  #@NEW_LINE#@#  From the primary tumors standpoint, cheaters and secondary producers may occupy the same niche since neither cell type participates in local niche construction, while local and global producers both do and thus occupy a distinct niche.  #@NEW_LINE#@#  Intra-niche competition is as strong as intraclonal competition, while inter-niche competition is weaker.  #@NEW_LINE#@#  

Separation_of_timescales  #@NEW_LINE#@#  
Simulations of the model (shown in S2 Fig) show that, for reasonable parameters (inferred from the literature in S3 Appendix), cell populations equilibrate more quickly than the resource dynamics.  #@NEW_LINE#@#  The latter keep growing without reaching an equilibrium at timescales relevant to tumor growth (i.e.  #@NEW_LINE#@#  the lifespan of a human).  #@NEW_LINE#@#  This is biologically intuitive since niche construction processes such as microenvironment vascularization are generally slower than cell division.  #@NEW_LINE#@#  This allows us to make a separation of timescales argument.  #@NEW_LINE#@#  In particular, we consider the cell dynamics to be fast and the resource dynamics to be slow.  #@NEW_LINE#@#  We first analyze the fast-changing variables while treating the slow-changing variable as constant.  #@NEW_LINE#@#  In other words, we find the equilibria of the cell dynamics while holding R constant (we refer to these equilibria of the fast dynamics, which are functions of R, as quasi-equilibria).  #@NEW_LINE#@#  Then, we analyze the dynamics of the slow variable R while assuming the fast variables are at a quasi-equilibrium.  #@NEW_LINE#@#  


Results  #@NEW_LINE#@#  
For each competition structure, we examine a primary tumor that initially consists of only cheaters and local producers.  #@NEW_LINE#@#  The conditions for metastasis are equivalent to the invasion conditions of secondary or global producers into this tumor, since pre-metastatic niche construction is required for circulating tumor cells to settle into a secondary site.  #@NEW_LINE#@#  For invasion of secondary producers,  must be positive if a small but nonzero number of secondary producers cells are suddenly added to the population (e.g.  #@NEW_LINE#@#  through mutation).  #@NEW_LINE#@#  For invasion of global producers,  must be positive if a small but nonzero number of global producers are suddenly added to the population.  #@NEW_LINE#@#  There are three possible non-trivial quasi-equilibria of a local tumor: cheaters only, local producers only, and coexistence.  #@NEW_LINE#@#  We determine the stability of each quasi-equilibrium and evaluate the invasion conditions for secondary and global producers.  #@NEW_LINE#@#  These results for each competition structure are outlined in Table 3 and considered in detail below.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0198163.t003  #@NEW_LINE#@#  
Tumors containing producers have a large amount of resource, i.e.  #@NEW_LINE#@#  R k, since the producer-only and coexistence quasi-equilibria result in rapid resource accumulation.  #@NEW_LINE#@#  On the other hand, tumors starting with cheaters only have low R, i.e.  #@NEW_LINE#@#  k  R since there is no niche construction.  #@NEW_LINE#@#  Additionally,   0 in any sum since  is several orders of magnitude smaller than any other parameter (see S3 Appendix).  #@NEW_LINE#@#  We use these facts in simplifying the derivation of stability and invasion conditions.  #@NEW_LINE#@#  The trajectories the tumor can undergo depend on niche construction specificity and inter-type competition structure.  #@NEW_LINE#@#  We consider each possibility in detail below.  #@NEW_LINE#@#  
Competition_structure_I  #@NEW_LINE#@#  
The invasion conditions for secondary producer and global producers are, respectively,  #@NEW_LINE#@#  
(1) (2)  #@NEW_LINE#@#  
For large R and small , the producer-only quasi-equilibrium is stable when  #@NEW_LINE#@#  
(3)  #@NEW_LINE#@#  
This inequality means that the higher the specificity of niche construction (measured by ) the less likely cheaters are able to invade the population.  #@NEW_LINE#@#  Secondary producers can invade the local producer-only tumor if  #@NEW_LINE#@#  
(4)  #@NEW_LINE#@#  
This condition similarly means that the higher the niche construction specificity, the less likely the invasion of secondary producers.  #@NEW_LINE#@#  If  less_than , there is a window of specificity where the producer-only tumor is resistant to invasion by cheaters but susceptible to invasion by secondary producers.  #@NEW_LINE#@#  On the other hand, global producers can invade the producer-only tumor if  #@NEW_LINE#@#  
(5)  #@NEW_LINE#@#  
Thus, the stability and resistance to invasion of a tumor containing only producers depends on the strength of interclonal competition and may depend additionally on niche construction specificity.  #@NEW_LINE#@#  
Secondary producers can invade the coexistence quasi-equilibrium if  #@NEW_LINE#@#  
(6)  #@NEW_LINE#@#  
For high niche specificity, this is satisfied when   , which is unlikely given that competition between cheaters and any producer type is less than competition among producers.  #@NEW_LINE#@#  Global producers can invade a tumor at coexistence if  #@NEW_LINE#@#  
(7)  #@NEW_LINE#@#  
Importantly, whether a metastasis-promoting subclone can invade a tumor containing both cheaters and local producers depends on both niche construction specificity and competition strength.  #@NEW_LINE#@#  Finally, it is easy to see from Eqs (1) and (2) that a cheater-only tumor (with R = 0 and   1) can always be invaded by any producer cell type regardless of specificity, as long as  and  less_than 1.  #@NEW_LINE#@#  
These results point to an interesting trade-off: cheater-only tumors offer no competitive obstacle to metastasis.  #@NEW_LINE#@#  However, they remain small due to the lack of niche construction, which constrains the number of mutations they might experience that can lead to secondary or global producer clones.  #@NEW_LINE#@#  In contrast, if local producers invade first the tumor grows bigger, increasing the arrival rate of mutations, yet simultaneously the invasion conditions for a secondary or global producer become more stringent so that the pre-metastatic niche may be precluded by competition.  #@NEW_LINE#@#  As we discuss below, this tension is even more apparent in other competition structures.  #@NEW_LINE#@#  

Competition_structure_II  #@NEW_LINE#@#  
The invasion conditions for secondary and global producers are, respectively,  #@NEW_LINE#@#  
(8) (9)  #@NEW_LINE#@#  
Producer-only tumors can be invaded by secondary producers when  #@NEW_LINE#@#  
(10)  #@NEW_LINE#@#  
i.e.  #@NEW_LINE#@#  when there is no niche specificity and cells that do not produce the resource must benefit from it more than cells that do.  #@NEW_LINE#@#  Global producers cannot invade the producer-only tumor under this competition structure.  #@NEW_LINE#@#  
At the coexistence quasi-equilibrium, invasion of secondary producers can occur if  #@NEW_LINE#@#  
(11)  #@NEW_LINE#@#  
This condition is less likely to be true with increasing specificity.  #@NEW_LINE#@#  Global producers can invade when  #@NEW_LINE#@#  
(12)  #@NEW_LINE#@#  
Both invasion conditions for tumors with coexistence depend on the strength of competition and niche specificity.  #@NEW_LINE#@#  The cheater-only tumor, on the other hand, is always vulnerable to invasion by any producer cell types, just like for competition structure I.  #@NEW_LINE#@#  The trade-off between mutant arrival and invasion is reproduced in this competition structure and is even more apparent since global producers cannot invade producer-only tumors.  #@NEW_LINE#@#  Once again, stability and invasion of tumors containing producers depend on competition strength and specificity while cheaters are generally susceptible regardless of specificity.  #@NEW_LINE#@#  

Competition_structure_III  #@NEW_LINE#@#  
The invasion conditions for secondary producers and global producers are, respectively,  #@NEW_LINE#@#  
(13) (14)  #@NEW_LINE#@#  
The condition for stability of the local producer-only quasi-equilibrium is Eq (3), just like the other two competition structures.  #@NEW_LINE#@#  Global producers cannot invade producer-only tumors, while invasion of secondary producers is possible when  #@NEW_LINE#@#  
(15)  #@NEW_LINE#@#  
As niche construction specificity increases, this condition is less likely to be true.  #@NEW_LINE#@#  This invasion condition is mutually exclusive with the stability of the quasi-equilibrium.  #@NEW_LINE#@#  If  then the tumor remains at the stable producer-only quasi-equilibrium and is resistant to invasion by cheaters, global producers, and secondary producers.  #@NEW_LINE#@#  If  the quasi-equilibrium is unstable and susceptible to invasion by cheaters or secondary producers.  #@NEW_LINE#@#  The larger the competition that secondary producers would experience from local producers, the more efficiently they must be able to use the resource in order to invade.  #@NEW_LINE#@#  
At the coexistence quasi-equilibrium, the invasion condition for secondary producers is  #@NEW_LINE#@#  
(16)  #@NEW_LINE#@#  
This condition is never fulfilled since secondary producers pay a growth rate cost relative to cheaters.  #@NEW_LINE#@#  The condition for invasion of global producers is  #@NEW_LINE#@#  
(17)  #@NEW_LINE#@#  
The coexistence quasi-equilibrium allows for invasion of cells that contribute to the pre-metastatic niche only if they also contribute to local niche construction and only under certain levels of interclonal competition and specificity.  #@NEW_LINE#@#  Even if the necessary mutations for genesis of secondary producers occur, ecological conditions prevent the invasion of the lineage.  #@NEW_LINE#@#  Coexistence of cheaters and local producers can obstruct successful metastasis through a failure of settlement into the pre-metastatic niche rather than a failure of intravasation.  #@NEW_LINE#@#  
On the other hand, the cheater-only quasi-equilibrium is unstable and always vulnerable to invasion by global producers.  #@NEW_LINE#@#  Secondary producers can invade if  #@NEW_LINE#@#  
(18)  #@NEW_LINE#@#  
i.e.  #@NEW_LINE#@#  if primary producers grow more slowly than secondary producers, which may be satisfied since the growth rate cost of local niche construction can easily be higher than that of preparing the pre-metastatic niche, again highlighting the susceptibility of cheater-only tumors to invasion by all producers.  #@NEW_LINE#@#  
In short, for all competition structures we consider, tumors with cheaters only are easily invaded while tumors containing producers are more difficult to invade, with restrictions on competition strength and niche construction specificity.  #@NEW_LINE#@#  To confirm this tension between invasion and mutation, we simulated the tumor and resource dynamics starting with cheaters only.  #@NEW_LINE#@#  The mutation rate in cancer is estimated to be 2 × 107 per cell division per gene [38] and the cell cycle length is approximately one day for at least some cancers [39].  #@NEW_LINE#@#  We thus use a daily mutation rate of 2 × 107 and assume 1 out of 1000 mutations creates (11) cells from (00) cells or (10) cells from (01) cells.  #@NEW_LINE#@#  We assume 1 out of 500 mutations creates (01) or (10) cells from (00) cells, or (11) or (00) cells from (10) cells, since these cellular transformations do not require as drastic a phenotypic alteration.  #@NEW_LINE#@#  These mutation probabilities are somewhat arbitrary but the trade-off is robust to the choice of specific mutation probabilities.  #@NEW_LINE#@#  We choose these specific probabilities only to illustrate this trade-off in a convenient manner.  #@NEW_LINE#@#  

Fig 3a shows a common tumor trajectory with clinically realistic tumor size.  #@NEW_LINE#@#  The tumor starts with cheaters and does not increase in size initially after arriving at the carrying capacity without producers.  #@NEW_LINE#@#  Once producers arise by mutation and successfully invade, cheaters go extinct.  #@NEW_LINE#@#  The tumor increases in size as resource production commences.  #@NEW_LINE#@#  The increasing size leads to numerous mutations, but these mutations do not lead to successful invasion since R has accumulated to a high level and we showed above that a stable producer-only quasi-equilibrium with high R is resistant to invasion.  #@NEW_LINE#@#  Fig 3b shows a clear trade-off between mutation rate and invasion.  #@NEW_LINE#@#  In tumors where producers arise from mutation and invade, size increases with time.  #@NEW_LINE#@#  The number of mutations increases drastically with tumor size, but these mutations all result in failed invasion.  #@NEW_LINE#@#  In tumors that remain cheater-only, successful invasion of secondary or global producers is possible, as shown by red triangles.  #@NEW_LINE#@#  There is a much smaller number of mutations for cheater-only tumors due to their small size, but once a mutation does arise, invasion is much more probable than in larger producer-only tumors.  #@NEW_LINE#@#  

Tumor_trajectories  #@NEW_LINE#@#  

Fig 4 schematically summarizes the trajectory tumors can undergo starting from cheaters only, in light of the results presented above.  #@NEW_LINE#@#  After tumorigenesis, cheaters proliferate and approach the intrinsic carrying capacity.  #@NEW_LINE#@#  The small initial tumor is always unstable and can be invaded by any producer cell type regardless of specificity.  #@NEW_LINE#@#  It can promote metastasis as long as the necessary mutations occur to generate secondary or global producers.  #@NEW_LINE#@#  However, to continue expanding the tumor population, niche construction is necessary.  #@NEW_LINE#@#  Mutations can lead to the appearance of producers from the cheater-only tumor, which saves the population from stagnation.  #@NEW_LINE#@#  Subsequent tumors reaching either coexistence or extinction of cheaters can, however, be resistant to invasion by metastasis-promoting lineages, depending on competition strength and niche construction specificity.  #@NEW_LINE#@#  Furthermore, under competition structure III, any tumor at the stable local producer-only quasi-equilibrium is resistant for all levels of specificity and any tumor containing coexistence is resistant to invasion by secondary producers.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
We presented a simple model of niche construction in cancer, where local niche construction benefits all primary tumor cells by increasing the carrying capacity, and secondary niche construction (construction of the pre-metastatic niche) is needed for successful metastasis.  #@NEW_LINE#@#  Primary tumor cells can contribute to niche construction in one or both of the sites at a cost to their growth rate.  #@NEW_LINE#@#  Cheaters can reap the benefits of niche construction without paying the cost.  #@NEW_LINE#@#  Although no definitive information exists on the relative strengths of interclonal competition and density dependence, we have analyzed three plausible competition structures of varying generality.  #@NEW_LINE#@#  
The primary tumor, without any distant or global producers, can arrive at one of three nontrivial quasi-equilibria: extinction of cheaters, extinction of local producers, or coexistence of local producers and cheaters.  #@NEW_LINE#@#  The cheater-only quasi-equilibrium is vulnerable to invasion by any producer cell type, independent of niche construction specificity, as long as interclonal competition is weaker than intraclonal.  #@NEW_LINE#@#  On the other hand, quasi-equilibria containing producers have different requirements for stability and varying levels of susceptibility to the invasion of secondary or global producers, dependent on the strength of interclonal competition and niche construction specificity.  #@NEW_LINE#@#  The invasion of primary tumor cells that contribute to the pre-metastatic niche is a necessary condition for metastasis and settlement of the secondary tumor site [1722].  #@NEW_LINE#@#  Importantly, susceptibility or resistance to invasion are not intrinsic to a tumor, but are crafted through an ecological pathological relationship between the tumor and its microenvironment.  #@NEW_LINE#@#  Metastasis requires the necessary mutations for the genesis of certain subclones and also an ecological milieu that facilitates invasion of these subclones.  #@NEW_LINE#@#  Even if the appropriate mutations occur, the cells could fail to invade and instead die off if the tumor is resistant to invasion.  #@NEW_LINE#@#  We have shown that such resistance is more likely to occur in tumors containing producers, which are larger and accumulate more mutations.  #@NEW_LINE#@#  Small, cheater-only tumors experience fewer mutations yet are more able to facilitate the successful proliferation of metastasis-promoting lineages.  #@NEW_LINE#@#  Although we adopt a deterministic invasion perspective (i.e., mutant lineages either increase or not depending on the invasion condition), our argument also applies to the stochastic persistence of a small mutant lineage, since all things being equal, such persistence is less likely when invasion conditions are not satisfied.  #@NEW_LINE#@#  
Under all three competition structures, tumors containing only producers also demonstrate a trade-off between stability and the ability of secondary producers to invade.  #@NEW_LINE#@#  Regardless of interclonal competition strength, increasing niche construction specificity promotes stability of the producer-only tumor such that cheaters are unable to invade.  #@NEW_LINE#@#  This result agrees with Gerlee and Andersons findings that selection for niche construction requires sufficient specificity, as specificity keeps cheaters from free-riding [30].  #@NEW_LINE#@#  However, we find that niche construction specificity makes it less likely that secondary producers can invade a producer-only tumor.  #@NEW_LINE#@#  This stems from the fact that secondary producers do not produce the primary resource and therefore are also selected against due to specificity of the resource.  #@NEW_LINE#@#  On the other hand, the ability of global producers to invade this tumor does not depend on niche construction specificity since they also produce the local resource and benefit with the same efficiency as local producers.  #@NEW_LINE#@#  Instead, invasion is possible only under competition structure I and only if interclonal competition between global and secondary producers is weaker than intraclonal competition.  #@NEW_LINE#@#  
Our main result is identifying a trade-off between the arrival of mutations leading to metastasis and their invasion success.  #@NEW_LINE#@#  This trade-off may help explain the early metastasis hypothesis, which posits that metastasis is not necessarily a late event in the tumor history, but rather can occur while the tumor is still small.  #@NEW_LINE#@#  Many genetic and clinical studies support this view [40].  #@NEW_LINE#@#  For example, evidence suggests that cells in metastases are genetically less progressed in terms of tumor progression than primary tumor cells at diagnosis [41, 42] and that metastases do not necessarily not come from large tumors [43].  #@NEW_LINE#@#  Studies of breast cancer metastasis suggest that it can be an early event [4448].  #@NEW_LINE#@#  Similarly, it has been proposed that metastatic capacity stems from mutations acquired early in a tumor history [49], an idea supported by a recent analysis of tumor phylogenies that shows early genetic divergence of metastatic lineages [31].  #@NEW_LINE#@#  These observations contradict the idea that cancer follows a linear progression in which late-stage primary tumors facilitate metastasis.  #@NEW_LINE#@#  However, the idea that metastasis is not a late event may be paradoxical because late primary tumors are larger and harbor more mutations that can lead to the genesis of metastatic lineages.  #@NEW_LINE#@#  Our results indicate that this paradox and the early metastasis phenomenon may potentially operate through a tension between mutant arrival and invasion caused by competition between local and pre-metastatic niche constructors late in a tumor history.  #@NEW_LINE#@#  Secondary or global producers must invade while the tumor is still small, and if they do the pre-metastatic niche will begin recruiting circulating tumor cells from an early time point.  #@NEW_LINE#@#  Otherwise, the pre-metastatic niche may remain unprepared, since larger, late primary tumors containing producers may be resistant to invasion by pre-metastatic niche constructors.  #@NEW_LINE#@#  Large tumors participate in metastasis as long as invasion occurred while the tumor was still small.  #@NEW_LINE#@#  Accordingly, empirical evidence suggests that construction of the pre-metastatic niche is the limiting factor for establishing secondary tumors, not dissemination of circulating tumor cells which is independent of tumor size [43] and occurs starting early on [50].  #@NEW_LINE#@#  This is supported by the parallel progression model of cancer, in which frequently disseminated cancer cells rarely establish themselves [31, 51].  #@NEW_LINE#@#  In short, our results showing a tension between the arrival of a mutation for pre-metastatic niche construction and its successful establishment support the idea that metastasis begins early and provide a potential explanation for a paradoxical aspect of nonlinear tumor progression.  #@NEW_LINE#@#  Our conclusion that the timing of metastasis is partially mediated through the timing of invasion by pre-metastatic niche constructors into the primary tumor can be validated if empirical analyses reveal that mutations causing pre-metastatic niche construction occur before the divergence of metastatic tumor lineages from the primary tumor.  #@NEW_LINE#@#  
One implication of our results is that if certain types of cancers may be resistant to metastasis even over long periods of time despite the accumulation of mutations.  #@NEW_LINE#@#  This happens if the tumor switches to a producer-only or coexistence state with high niche-construction specificity and relatively high competition between different producer clones.  #@NEW_LINE#@#  Cancers that are not associated with metastasis are known since the work of Paget [23], who first proposed the seed and soil hypothesis.  #@NEW_LINE#@#  Our model suggests there could be an ecological, rather than genetic, explanation for the tendency of certain cancers to be less likely to metastasize.  #@NEW_LINE#@#  Resistance to invasion of metastatic subclones can be characteristic of particular cancers based on the typical cell types within the primary tumor cell population and the way they compete and use resources, rather than from a lack of necessary mutations.  #@NEW_LINE#@#  
Under competition structure III we find that in the coexistence quasi-equilibrium, reducing the growth rate of cheaters promotes the invasion of secondary producers.  #@NEW_LINE#@#  Chemotherapy is a method of targeting rapidly dividing cells and likely to disproportionately affect cheaters [52].  #@NEW_LINE#@#  Thus, it is possible for chemotherapy to depress cheater growth rate enough such that r00 less_than r01, which would lead to Eq (16) to be satisfied and secondary producers to invade, a necessary step towards metastasis.  #@NEW_LINE#@#  This result is consistent with accumulating evidence that chemotherapy may increase the potential for metastasis by increasing pro-tumorigenic growth factors in the blood and mobilizing bone marrow-derived progenitor cells to make the secondary tumor site more receptive to circulating tumor cells [5355].  #@NEW_LINE#@#  
The assumption that intra-type competition is stronger than inter-type competition is central to our results.  #@NEW_LINE#@#  This assumption, shared with other models of clonal dynamics [56, 57], can be viewed as an expression of the fact that cellular neighbors tend to be of the same cell type and competition for resources occurs on a local spatial scale.  #@NEW_LINE#@#  A wealth of mathematical and experimental evidence shows that tumors contain spatial clustering of subclones with relatedness decreasing as distance increases between cells [30, 5864].  #@NEW_LINE#@#  Another biological mechanism for stronger intraclonal competition is that different producer and cheater clones might occupy different niches, due to their different metabolic needs and utilization of different cellular pathways.  #@NEW_LINE#@#  Since cells that are highly related are more likely to use the same metabolic resources compared to cells that are less related, cells within the same clone compete with one another more strongly than they compete with a less-related cell of another clone that uses different resources and cellular pathways.  #@NEW_LINE#@#  
Another assumption we made was that the benefit of niche construction is manifested by increasing carrying capacity of both producers and cheaters [30].  #@NEW_LINE#@#  Cancer cells thrive at cellular densities considerably higher than that of normal host cells [65].  #@NEW_LINE#@#  Increased carrying capacity due to niche construction can be achieved through many mechanisms; perhaps the most obvious is angiogenesis.  #@NEW_LINE#@#  Tumors often live in highly acidic microenvironments due to their increased glycolytic metabolism.  #@NEW_LINE#@#  Inducing vascularization delivers oxygen, clears metabolic waste products, provides nutrients, and provides growth factors.  #@NEW_LINE#@#  It has been established that tumors larger than 1-2 mm are supported by newly formed blood vessels through secretion of various angiogenic factors, including PDGF (platelet-derived growth factor), AngI, AngII, and VEGF [66, 67].  #@NEW_LINE#@#  One model used tumor carrying capacity as a function of blood vessel density due to the importance of tumor-induced angiogenesis [66], and this is essentially carrying capacity as a function of niche construction.  #@NEW_LINE#@#  Another example is the release of autocrine factors by tumor cells, since this increases their ability to divide despite high cell density [30].  #@NEW_LINE#@#  In vitro [68] and in vivo [69] studies have observed tumors with a subset of producers that contributed to overall population growth through the secretion of diffusable growth factors.  #@NEW_LINE#@#  This is evidence that a tumor can have producers and cheaters with an increasing carrying capacity.  #@NEW_LINE#@#  
In summary, we have created a mathematical model to study metastasis as an outcome of niche construction.  #@NEW_LINE#@#  Though the full complexity of cancer dynamics and metastasis is not captured in this model, important guiding theoretical principles can be revealed in a simple toy model [70, 71].  #@NEW_LINE#@#  The contribution of our toy model is to show a fundamental tension between mutant arrival and invasion.  #@NEW_LINE#@#  Tumors containing cheaters only are completely susceptible to invasion by all producer cell types while tumors containing producers can be resistant to invasion, dependent on competition strength and niche construction specificity.  #@NEW_LINE#@#  Our findings may help explain the early metastasis phenomenon and the observation that metastasis involves early mutations.  #@NEW_LINE#@#  We emphasize that successful metastasis requires a double-hit of the necessary genetic mutations and appropriate ecological conditions.  #@NEW_LINE#@#  Much research has focused on the genetic aspects of cancer initiation and progression, but this is insufficient if the context in which the genes exist and mutations arise is not considered [1, 4].  #@NEW_LINE#@#  Pagets seed and soil hypothesis is often invoked while studying metastasis [23]; our model shows that the analogy is more than evocative.  #@NEW_LINE#@#  Just as we need to consider the soil, sunlight, wind, and nearby flora and fauna to understand the germination of a seed, we also need to take the ecologists view to understand metastasis.  #@NEW_LINE#@#  Only then can we hope to stop the seed from spreading in the first place.  #@NEW_LINE#@#  

Supporting_information  #@NEW_LINE#@#  
S1_Appendix_Extended_model  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0198163.s001  #@NEW_LINE#@#  
(PDF)  #@NEW_LINE#@#  

S2_Appendix_Alternative_interpretation_of_cell_types  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0198163.s002  #@NEW_LINE#@#  
(PDF)  #@NEW_LINE#@#  

S3_Appendix_Estimation_of_parameters  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0198163.s003  #@NEW_LINE#@#  
(PDF)  #@NEW_LINE#@#  

S1_Fig_Extended_model_schematic  #@NEW_LINE#@#  
Schematic representation of the extended mathematical model described in S1 Appendix.  #@NEW_LINE#@#  The model considers a primary tumor with four cell types, bloodstream with two cell types, and secondary tumor with two cell types.  #@NEW_LINE#@#  Cheaters are white and producers are blue.  #@NEW_LINE#@#  In the primary tumor, cells could additionally be secondary producers (red) or global producers (red and blue).  #@NEW_LINE#@#  Niche construction occurs in the tumor sites through production of resources R1 and R3, which benefit the tumors by increasing carrying capacity, represented as dotted lines.  #@NEW_LINE#@#  Construction of the pre-metastatic niche by primary tumor cells is represented by accumulation of resource R2, which facilitates settlement in the secondary tumor site.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0198163.s004  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S2_Fig_Supplementary_simulations  #@NEW_LINE#@#  
Simulation of a tumor with competition structure I starting with both cheaters and producers before the separation of timescales.  #@NEW_LINE#@#  r00 = 0.07, r10 = 0.05, r01 = 0.045, r11 = 0.02, k = 105, 0 = 1, 1 = 1.2,  = 0.9, g = 0.004, l = 0.001,  = 106.  #@NEW_LINE#@#  Simulations show that prior to the separation of timescales, the model (using competition structure I) contains a clinically realistic tumor size over time but fails to reach an equilibrium even after a decade.  #@NEW_LINE#@#  Different reasonable parameter combinations yield the same result.  #@NEW_LINE#@#  Cell populations in the model equilibrate more quickly than resource dynamics.  #@NEW_LINE#@#  The cell density always closely tracks the carrying capacity and the resource dynamics are slow.  #@NEW_LINE#@#  This allows us to make a separation of timescales argument, which is biologically expected since niche construction processes (such as microenvironment vascularization) are generally slower than cell division.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0198163.s005  #@NEW_LINE#@#  
(TIFF)  #@NEW_LINE#@#  

S1_Table_Extended_model_equations  #@NEW_LINE#@#  
Governing equations of the extended model described in S1 Appendix and the corresponding variables whose rates of change they describe, using competition structure I.  #@NEW_LINE#@#  Time dependence of n and R has been suppressed for notational simplicity.  #@NEW_LINE#@#  Dependence of m on N1 and R1 has also been suppressed.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0198163.s006  #@NEW_LINE#@#  
(PDF)  #@NEW_LINE#@#  

S2_Table_Governing_equations_of_the_model_for_competition_structure_II  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0198163.s007  #@NEW_LINE#@#  
(PDF)  #@NEW_LINE#@#  

S3_Table_Governing_equations_of_the_model_for_competition_structure_III  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0198163.s008  #@NEW_LINE#@#  
(PDF)  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
We would like to acknowledge A.  #@NEW_LINE#@#  Brown and B. Morsky for helpful comments regarding the manuscript.  #@NEW_LINE#@#  

References  #@NEW_LINE#@#  



