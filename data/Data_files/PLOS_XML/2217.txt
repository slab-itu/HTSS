article id="http://dx.doi.org/10.1371/journal.pcbi.1006122"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Identification of animal behavioral strategies by inverse reinforcement learning  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Animals are able to reach a desired state in an environment by controlling various behavioral patterns.  #@NEW_LINE#@#  Identification of the behavioral strategy used for this control is important for understanding animals decision-making and is fundamental to dissect information processing done by the nervous system.  #@NEW_LINE#@#  However, methods for quantifying such behavioral strategies have not been fully established.  #@NEW_LINE#@#  In this study, we developed an inverse reinforcement-learning (IRL) framework to identify an animals behavioral strategy from behavioral time-series data.  #@NEW_LINE#@#  We applied this framework to C. elegans thermotactic behavior; after cultivation at a constant temperature with or without food, fed worms prefer, while starved worms avoid the cultivation temperature on a thermal gradient.  #@NEW_LINE#@#  Our IRL approach revealed that the fed worms used both the absolute temperature and its temporal derivative and that their behavior involved two strategies: directed migration (DM) and isothermal migration (IM).  #@NEW_LINE#@#  With DM, worms efficiently reached specific temperatures, which explains their thermotactic behavior when fed.  #@NEW_LINE#@#  With IM, worms moved along a constant temperature, which reflects isothermal tracking, well-observed in previous studies.  #@NEW_LINE#@#  In contrast to fed animals, starved worms escaped the cultivation temperature using only the absolute, but not the temporal derivative of temperature.  #@NEW_LINE#@#  We also investigated the neural basis underlying these strategies, by applying our method to thermosensory neuron-deficient worms.  #@NEW_LINE#@#  Thus, our IRL-based approach is useful in identifying animal strategies from behavioral time-series data and could be applied to a wide range of behavioral studies, including decision-making, in other organisms.  #@NEW_LINE#@#  

Author_summary  #@NEW_LINE#@#  
Understanding animal decision-making has been a fundamental problem in neuroscience and behavioral ecology.  #@NEW_LINE#@#  Many studies have analyzed the actions representing decision-making in behavioral tasks, in which rewards are artificially designed with specific objectives.  #@NEW_LINE#@#  However, it is impossible to extend this artificially designed experiment to a natural environment, as in the latter, the rewards for freely-behaving animals cannot be clearly defined.  #@NEW_LINE#@#  To this end, we sought to reverse the current paradigm so that rewards could be identified from behavioral data.  #@NEW_LINE#@#  Here, we propose a new reverse-engineering approach (inverse reinforcement learning), which can estimate a behavioral strategy from time-series data of freely-behaving animals.  #@NEW_LINE#@#  By applying this technique on C. elegans thermotaxis, we successfully identified the respective reward-based behavioral strategy.  #@NEW_LINE#@#  

Citation: Yamaguchi S, Naoki H, Ikeda M, Tsukada Y, Nakano S, Mori I, et al.  #@NEW_LINE#@#  (2018) Identification of animal behavioral strategies by inverse reinforcement learning.  #@NEW_LINE#@#  PLoS Comput Biol 14(5):  #@NEW_LINE#@#  
           e1006122.  #@NEW_LINE#@#  

        https://doi.org/10.1371/journal.pcbi.1006122  #@NEW_LINE#@#  
Editor: Andre Brown, UNITED KINGDOM  #@NEW_LINE#@#  
Received: October 10, 2017; Accepted: April 3, 2018; Published:  May 2, 2018  #@NEW_LINE#@#  
Copyright:  Â© 2018 Yamaguchi et al.  #@NEW_LINE#@#  This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.  #@NEW_LINE#@#  
Data Availability: All relevant data are within the paper and its Supporting Information files.  #@NEW_LINE#@#  
Funding: This research was mainly supported by Grant-in-Aids for Young Scientists (B) (No.  #@NEW_LINE#@#  16K16147) from the Ministry of Education, Culture, Sports, Science and Technology (MEXT), Japan (author HN).  #@NEW_LINE#@#  It was also supported partially by the Platform Project for Supporting in Drug Discovery and Life Science Research (Platform for Dynamic Approaches to Living System) (authors HN and SI) from the Japan Agency for Medical Research and Development (AMED), the Brain Mapping by Integrated Neurotechnologies for Disease Studies (Brain/MINDS) (author SI) from AMED and the Strategic Research Program for Brain Sciences (authors HN, SN, YT, IM, and SI) from MEXT.  #@NEW_LINE#@#  The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  
Competing interests:  The authors have declared that no competing interests exist.  #@NEW_LINE#@#  
Introduction  #@NEW_LINE#@#  
Animals develop behavioral strategies, a set of sequential decisions necessary for organizing appropriate actions in response to environmental stimuli, to ensure their survival and reproduction.  #@NEW_LINE#@#  Such strategies lead animals to their preferred states and provide them with effective solutions to overcome difficulties in a given environment.  #@NEW_LINE#@#  For example, foraging animals are known to optimize their strategy to most efficiently exploit food sources [1].  #@NEW_LINE#@#  Therefore, understanding behavioral strategies of biological organisms is important from biological, ethological, and engineering point of views.  #@NEW_LINE#@#  
A number of studies have recorded the behavioral sequences reflecting the overall animal strategies.  #@NEW_LINE#@#  However, mechanistic descriptions are different from phenomenological descriptions of recorded behaviors [2], and there is no well-established method that can objectively identify behavioral strategies, a mechanistic component of behavior.  #@NEW_LINE#@#  From a theoretical viewpoint, this mechanistic component corresponds to an algorithmic/representational level of understanding of information processing systems [3].  #@NEW_LINE#@#  To derive behavioral strategies from quantitative time-series behavioral data, we propose a new computational framework based on the concept of reinforcement learning (RL).  #@NEW_LINE#@#  
RL is a mathematical paradigm that represents how animals adapt their behavior to maximize cumulative rewards via trial and error [4] (blue arrow in Fig 1A).  #@NEW_LINE#@#  A previous study indicated that dopamine activity reflects the reward prediction error [5], similar to temporal difference learning in RL [6], suggesting that RL-based regulation underlies animals behavioral learning.  #@NEW_LINE#@#  Even in the simple neural circuits of Caenorhabditis elegans (C. elegans), dopamine-dependent activity, involved in explorative behavior, is reminiscent of RL [7].  #@NEW_LINE#@#  Thus some behavioral strategies are likely associated with the reward system.  #@NEW_LINE#@#  
(A) Reinforcement learning represents a forward problem, in which a behavioral strategy is optimized to maximize the cumulative reward given as a series of states and rewards.  #@NEW_LINE#@#  IRL represents an inverse problem, in which a behavioral strategy, or its underlying value and reward functions, is estimated in order to reproduce an observed series of behaviors.  #@NEW_LINE#@#  The behavioral strategy is evaluated by the profiles of the identified functions.  #@NEW_LINE#@#  (B) Examples of passive and controlled dynamics.  #@NEW_LINE#@#  An animal migrates upwards, while the food (reward) is placed to its right.  #@NEW_LINE#@#  In this situation, if the animal continues to migrate upwards, the distance to the food increases.  #@NEW_LINE#@#  If the animal exercises harder body control, that is, changes its migrating direction towards the food, the distance to the food decreases.  #@NEW_LINE#@#  The animal should therefore make decisions based on balancing these two dynamics.  #@NEW_LINE#@#  (C) The agent-environment interaction.  #@NEW_LINE#@#  The agent autonomously acts in the environment, observes the resultant state-transition through its sensory system, and receives not only a state reward but also a body control cost.  #@NEW_LINE#@#  The behavioral strategy is optimized to maximize the accumulation of the net reward, which is given as the state reward minus the body control cost.  #@NEW_LINE#@#  (D) IRL framework for the identification of animal behavioral strategies.  #@NEW_LINE#@#  If a certain behavioral strategy is under investigation, a behavioral experiment is initially performed (phase 1), which can either involve a free-movement task or a conditional task.  #@NEW_LINE#@#  Subsequently, the states and passive dynamics, based on which the animal develops its strategy, are selected and modelled (phase 2 and 3).  #@NEW_LINE#@#  For these phases, prior knowledge on the type of sensory information an animal processes is useful for appropriately selecting the states and passive dynamics.  #@NEW_LINE#@#  Phases 4 and 5 involve the quantification of the time-series of the selected states and the implementation of the linearly-solvable Markov decision process-based IRL, respectively, in order to estimate the value function.  #@NEW_LINE#@#  The behavioral strategy can be then identified.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pcbi.1006122.g001  #@NEW_LINE#@#  
Inverse reinforcement learning (IRL) is a recently developed machine-learning framework that can solve the inverse problem of RL (blue arrow in Fig 1A) and estimate reward-based strategies from behavioral time-series data [8,9].  #@NEW_LINE#@#  One engineering application of IRL is apprenticeship learning.  #@NEW_LINE#@#  For example, seminal studies on IRL employed a radio-controlled helicopter, for which the state-dependent rewards of an expert were estimated by using time-series observations of both a human experts manipulation and the helicopters state.  #@NEW_LINE#@#  Consequently, autonomous control of the helicopter was achieved by (forward) RL, by utilizing the estimated rewards [10,11].  #@NEW_LINE#@#  This engineering application prompted studies on animal behavioral strategies by using IRL.  #@NEW_LINE#@#  Recently, IRL application studies have emerged, mostly regarding human behavior, with a particular interest in constructing artificially intelligent systems that mimic such behavior [1215].  #@NEW_LINE#@#  In these studies, the behavioral tasks were designed with specific objectives, thus the observed behavioral strategies were usually expected.  #@NEW_LINE#@#  However, IRL applications involving freely behaving animals, in a more natural environment, are far from established.  #@NEW_LINE#@#  
In an effort to apply IRL to freely behaving animals, we chose thermotaxis in C. elegans as a model for a behavior that is regulated by specific strategies.  #@NEW_LINE#@#  When worms are cultivated at a constant temperature with plenty of food and then placed on a thermal gradient without food, they show an appetitive response to the cultivation temperature [16,17].  #@NEW_LINE#@#  In contrast, if they are first cultivated at a constant temperature without food and then transferred on the thermal gradient, they show an aversive behavior towards the cultivation temperature [18,19].  #@NEW_LINE#@#  Although the worms are not aware of the spatial temperature profile or their current location, it is obvious that they somehow make rational decisions, depending on their feeding status.  #@NEW_LINE#@#  Although there are multiple potential strategies that can theoretically lead animals to their goals, the actual ones they utilize in each condition are largely unknown due to the stochastic nature of behavioral sequences, which conceals the principles of behavioral regulation, as in the case of many other animal behaviors.  #@NEW_LINE#@#  
In this study, we developed a new IRL framework to identify the behavioral strategy as a value function.  #@NEW_LINE#@#  The value function represented the benefit of each state, namely, how much future rewards were expected starting from a given state.  #@NEW_LINE#@#  By applying this IRL framework to time-series behavioral data of freely migrating C. elegans, we identified the value functions underlying thermotactic strategies.  #@NEW_LINE#@#  Fed animals behaved based on sensory information of both the absolute and temporal derivative of temperature, and their behavior involved two modes; directed migration (DM) towards the cultivation temperature and isothermal migration (IM) along contour at constant temperature.  #@NEW_LINE#@#  Starved worms, in contrast, used only the absolute temperature but not its temporal derivative for escaping the cultivation temperature.  #@NEW_LINE#@#  By further applying the IRL to thermosensory neuron-impaired worms, we found that the so-called AFD neurons are fundamental for the DM exhibited by the fed worms.  #@NEW_LINE#@#  Thus, our framework can reveal the most preferable/optimal state for the animals and, more importantly, how animals reach that state, thereby providing clues for understanding the computational principles in the nervous system.  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
IRL_framework  #@NEW_LINE#@#  
To identify animal behavioral strategies based on IRL, we initially made the assumption that they are the result of the balance between two factors: passive dynamics (blue worm in Fig 1B) and reward-maximizing dynamics (red worm in Fig 1B), which correspond to inertia-based and purpose-driven body movements, respectively.  #@NEW_LINE#@#  For example, even if a worm moving in a straight line wants to make a purpose-driven turn towards a reward, it cannot turn suddenly, due to the inertia of its already moving body.  #@NEW_LINE#@#  Thus, it is reasonable to consider that the animals behavior is optimized by taking the above two factors into account, i.e., by minimizing the resistance to passive dynamics and maximizing approach to the destination (reward).  #@NEW_LINE#@#  Such a behavioral strategy has recently been modeled by using a linearly-solvable Markov decision process (LMDP) [20], in which the agent requires not only a state-dependent reward, but also a control cost for quantifying resistance to passive dynamics (Fig 1C).  #@NEW_LINE#@#  Importantly, the optimal strategy in the LMDP is analytically obtained as the probability of controlled state transition [20]:  #@NEW_LINE#@#  
(1)  #@NEW_LINE#@#  
where st indicates the animals state at time step t; v(s) is the value function and is defined as the expected sum of state-dependent rewards, r(s), and negative control cost, KL[(|s)||p(|s)], from state s towards the future; and P(st+1|st) represents the probability of uncontrolled state transition, indicating the passive dynamics from st to st+1.  #@NEW_LINE#@#  In this equation, the entire set of v(s) represents the behavioral strategy.  #@NEW_LINE#@#  Thus, the identification of a behavioral strategy is equivalent to the estimation of the value function v(s), based on the observed behavioral data (s1, s2,st,sT; red arrow in Fig 1A).  #@NEW_LINE#@#  For this purpose, we used the maximum likelihood estimation (MLE) method [21].  #@NEW_LINE#@#  Notably, in this estimation, we introduced a constraint to make the value function smooth, since animals generate similar actions in similar states.  #@NEW_LINE#@#  This constraint was essential to stably estimate the behavioral strategy of animals.  #@NEW_LINE#@#  The different phases of the IRL framework are depicted in the flowchart of Fig 1D.  #@NEW_LINE#@#  Following this flowchart, we applied the IRL framework to freely-migrating C. elegans under a thermal gradient.  #@NEW_LINE#@#  

Phase_1__Monitoring_animal_behaviors  #@NEW_LINE#@#  
To identify the behavioral strategy underlying the thermotactic behavior of C. elegans, we performed population thermotaxis assays, in which 80150 worms, which had been cultivated at 20Â°C, were placed on the surface of an agar plate with controlled thermal gradients (Fig 2A).  #@NEW_LINE#@#  Since the rate of physical contact is low at this worm density, behavioral crosstalk was negligible.  #@NEW_LINE#@#  To collect behavioral data, we prepared three different thermal gradients of 1420, 1723, and 2026Â°C, centered at 17, 20, and 23Â°C, respectively; we expected that the first gradient would encourage ascent up the gradient, the second movement around the center, and the third descent down the gradient.  #@NEW_LINE#@#  Indeed, the fed worms aggregated around the standard cultivation temperature (20Â°C) in all gradients (Fig 2B).  #@NEW_LINE#@#  

Phase_2__Selection_of_states  #@NEW_LINE#@#  
We first defined the worms state, signified by s in Eq (1), taking into account that it should represent the sensory information that the worms process during thermotaxis.  #@NEW_LINE#@#  Previous studies have shown that thermosensory AFD neurons encode the temporal derivative of temperature [22,23]; therefore, we assumed that worms select appropriate actions based not only on temperature, but also on its temporal derivative.  #@NEW_LINE#@#  We thus represented state by a two-dimensional (2-D) sensory space: s = (T, dT), where T and dT denote temperature and its temporal derivative, respectively.  #@NEW_LINE#@#  This means that the value function in Eq (1) represents a function of T and dT, i.e., v(s) = v(T, dT).  #@NEW_LINE#@#  Notably, we did not select the spatial coordinates on the assay plate for state, since the worms cannot recognize the spatial temperature profile or their current position on the plate.  #@NEW_LINE#@#  

Phase_3__Modeling_passive_dynamics  #@NEW_LINE#@#  
Next, we defined passive dynamics, signified by P(st+1|st) in Eq (1).  #@NEW_LINE#@#  Passive dynamics are the result of state transitions as a consequence of uncontrolled behavior.  #@NEW_LINE#@#  We assumed that a worm likely migrates in a persistent direction, but in a sometimes fluctuating manner.  #@NEW_LINE#@#  During state transition in a short time interval, the local thermal gradient can be considered as linear (Fig 2C).  #@NEW_LINE#@#  Thus, we modelled the passive transition from state st = (Tt, dTt), at time t, to the next state, st+1 = (Tt+1, dTt+1), at time t + 1, where dTt+1 maintains dTt with noise perturbation, while Tt+1 is updated as Tt+dTt with noise perturbation.  #@NEW_LINE#@#  Accordingly, P(st+1|st) was simply expressed by a normal distribution (please note the distinction between T and t throughout this paper).  #@NEW_LINE#@#  

Phase_4__Quantification_of_state_time-series  #@NEW_LINE#@#  
To quantify thermosensory states selected in phase 2, we tracked the trajectories of individual worms over 60 min within each gradient, by using a multi-worm tracking software [24] (Fig 2D).  #@NEW_LINE#@#  We then recorded the temperature that each individual worm experienced at each time-point (upper panel in Fig 2E) and calculated the temporal derivative of temperature by using a Savitzky-Golay filter [25] (lower panel in Fig 2E).  #@NEW_LINE#@#  State trajectories in the T-dT space were also plotted (S2A Fig).  #@NEW_LINE#@#  

Phase_5__Identification_of_behavioral_strategy_by_IRL  #@NEW_LINE#@#  
Using the collected state time-series data, s = (T, dT), and passive dynamics, P(st+1|st), we performed IRL, i.e., we estimated the value function, v(s).  #@NEW_LINE#@#  We modified an existing estimation method called OptV [21], by introducing a smoothness constraint, and confirmed that this constraint was indeed effective in accurately estimating the value function, when applied to artificial data simulated by Eq (1) (S1 Fig).  #@NEW_LINE#@#  Since this method could powerfully estimate a behavioral strategy based on artificial data, we next applied it to the behavioral data of the fed worms.  #@NEW_LINE#@#  
Our method successfully estimated the value function (Fig 3A) and visualized the desirability function, expressed by exp(v(T, dT)) [21] (Fig 3B).  #@NEW_LINE#@#  Furthermore, we could calculate the reward function from the identified desirability function using Eq (8) (Fig 3C).  #@NEW_LINE#@#  The reward function primarily represents the worms preference, while the desirability function represents the behavioral strategy and is thus a result of optimizing the cumulative sum of rewards and negative control costs.  #@NEW_LINE#@#  Therefore, our method quantitatively clarified the behavioral strategy of fed C. elegans.  #@NEW_LINE#@#  

Interpretation_of_the_identified_strategy  #@NEW_LINE#@#  
Since both the value and desirability functions essentially represented the same thermotactic strategy, we focus on the results only for the desirability function.  #@NEW_LINE#@#  We found that the identified desirability function peaked at T = 20Â°C and dT = 0Â°C/s, encouraging the worms to reach and stay close to the cultivation temperature.  #@NEW_LINE#@#  Moreover, we recognized both diagonal and horizontal components (Fig 3B), though the latter one was partially truncated by data limitation and data inhomogeneity (S2B Fig).  #@NEW_LINE#@#  The diagonal component represented directed migration (DM), a strategy that enables worms to efficiently reach the cultivation temperature.  #@NEW_LINE#@#  At lower temperatures than the cultivation temperature a more positive dT is favored, whereas at higher temperatures a more negative dT is favored.  #@NEW_LINE#@#  This DM strategy is consistent with the observation that worms migrate toward the cultivation temperature, and also clarifies how they control their thermosensory state throughout migration.  #@NEW_LINE#@#  On the other hand, the horizontal component represented isothermal migration (IM), which explains a well-known characteristic of worms, called isothermal tracking; worms typically exhibit circular migration under a concentric thermal gradient [17].  #@NEW_LINE#@#  Although we used a linear, not a concentric gradient in our thermotaxis assay, our IRL algorithm successfully extracted the isothermal tracking-related migration strategy, which worked both at the cultivation temperature and at other temperatures.  #@NEW_LINE#@#  The desirability function (Fig 3B) described the strategy of state transition (Eq (1)), while the state distribution of T and dT (S2B Fig) was an outcome of the strategy; therefore, the desirability function was not equivalent to the actual state distribution.  #@NEW_LINE#@#  
During thermotaxis, worms alternate between runs and sharp turns, which correspond to persistent migration with slight changes in direction, during long intervals, and intermittent directional changes with large angle, during short intervals, respectively [26].  #@NEW_LINE#@#  Because the number of data points obtained during the runs is much larger than those during the sharp turns in total, our IRL framework could recapitulate the strategy for shallow but not for sharp turns.  #@NEW_LINE#@#  Indeed, we could not find a relationship between the desirability function and the rate of sharp turns (S2C and S2D Fig).  #@NEW_LINE#@#  

Reliability_of_the_identified_strategy  #@NEW_LINE#@#  
We verified the reliability of the identified strategies with the following four ways.  #@NEW_LINE#@#  First, we examined the dimension of the strategy.  #@NEW_LINE#@#  We performed IRL based on a one-dimensional (1-D) state representation, i.e., s = (T).  #@NEW_LINE#@#  Comparing 1-D and 2-D cases, we used cross-validation to confirm that the prediction ability for a future state transition was significantly higher in the 2-D than in the 1-D behavioral strategy (p = 0.0002; Mann-Whitney U test) (S3 Fig).  #@NEW_LINE#@#  This result indicates that fed worms utilized sensory information of both the absolute temperature and its temporal derivative for their behavioral strategy.  #@NEW_LINE#@#  Second, we confirmed that our IRL approach recapitulated the nature of thermotactic behaviors.  #@NEW_LINE#@#  We simulated temperature trajectories starting from 15, 20, and 25Â°C, by sampling the state transition from Eq (1), using the identified value function.  #@NEW_LINE#@#  The simulated worm population converged around the cultivation temperature (S4 Fig), showing that the identified strategy indeed represented the thermotactic property of the fed worms.  #@NEW_LINE#@#  Third, we statistically tested the identified DM and IM strategies.  #@NEW_LINE#@#  As a null hypothesis, we assumed that the worms randomly migrated under a thermal gradient with no behavioral strategy.  #@NEW_LINE#@#  By means of surrogate method-based statistical testing, we showed that the DM and IM strategies could not be obtained by chance, indicating that both strategies reflected an actual strategy of thermotaxis (S5 Fig).  #@NEW_LINE#@#  Finally, we cross-checked the DM and IM strategies by repeating our IRL protocol on another C. elegans strain.  #@NEW_LINE#@#  To this end, we used worms in which the chemosensory ASI neurons were genetically ablated via cell-specific expression of caspases [27].  #@NEW_LINE#@#  This ASI-deficient strain appeared to show normal thermotaxis (Fig 4Aa), suggesting that the ASI neurons were not responsible for thermotaxis in our assay.  #@NEW_LINE#@#  We found clear diagonal and horizontal components in the desirability function, supporting the existence of the DM and IM strategies (Fig 4Ab).  #@NEW_LINE#@#  

Strategies_of_thermosensory_neuron-deficient_worms  #@NEW_LINE#@#  
To examine the role of the thermosensory circuit in the observed behavioral strategy, we created two worm strains in which one of the two types of thermosensory neurons, AWC or AFD, [16,17,28] had been genetically ablated via cell-specific expression of caspases.  #@NEW_LINE#@#  The AWC-deficient worms appeared to show normal thermotaxis (Fig 4Ba).  #@NEW_LINE#@#  The desirability function, obtained as for wild type (WT) animals (Fig 4Bb), suggested that AWC neurons did not play an essential role in thermotaxis.  #@NEW_LINE#@#  In contrast, AFD-deficient worms demonstrated cryophilic thermotaxis (Fig 4Ca).  #@NEW_LINE#@#  The desirability function consistently increased as temperature decreased (Fig 4Cb) but lacked the dT-dependent structure, indicating that the DM strategy observed in WT worms had disappeared.  #@NEW_LINE#@#  Moreover, the fact that AFD neurons encode the temporal derivative of temperature [22,23] further corroborates the loss of the dT-dependent structure.  #@NEW_LINE#@#  Thus, AFD-deficient worms inefficiently aimed for lower temperatures by a strategy primarily depending on the absolute temperature but not on its temporal derivative (Fig 4Cb).  #@NEW_LINE#@#  Taken together, these findings demonstrate that AFD and not AWC neurons are essential for efficiently navigating towards the desired/cultivation temperature.  #@NEW_LINE#@#  

Strategy_of_starved_worms  #@NEW_LINE#@#  
Further, we performed IRL on behavioral data from starved worms, which were cultivated at 20Â°C without food and then placed on the thermal gradient.  #@NEW_LINE#@#  The starved worms dispersed in the low-temperature region and avoided the high-temperature one (Fig 4Da).  #@NEW_LINE#@#  Regarding the desirability function, we found that, compared with the fed worms (Fig 3B), the diagonal structure was not present in the starved worms (Fig 4Db), suggesting that they did not use DM.  #@NEW_LINE#@#  In contrast, we could still observe IM (Fig 5Ab), indicating that the starved worms retained the ability to perform isothermal tracking.  #@NEW_LINE#@#  Most importantly, the desirability function was lower at the cultivation temperature than at surrounding temperatures, suggesting that, unlike the fed worms, the starved ones escaped the cultivation temperature region based on sensory information of only the absolute temperature, but not of its temporal derivative.  #@NEW_LINE#@#  These results indicate that our method could distinguish between strategies of normally fed and starved worms.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
In this study, we proposed an IRL framework to identify animal behavioral strategies based on collected behavioral time-series data.  #@NEW_LINE#@#  We validated the framework using artificial data, and then applied it to behavioral data collected during C. elegans thermotaxis experiments.  #@NEW_LINE#@#  We quantitatively identified the thermotactic strategies and discovered that fed worms use both the absolute temperature and its temporal derivative, whereas starved worms only use the absolute temperature.  #@NEW_LINE#@#  We then visualized the properties of this thermotactic strategy, by means of the desirability function, and successfully identified which states are pleasant and unpleasant for C. elegans.  #@NEW_LINE#@#  Finally, we demonstrated the ability of this technique to discriminate alterations in components within a strategy, by using it to compare the desirability functions of two strains of worms with impaired thermosensory neuron function; we found that AFD, but not AWC, neurons are fundamental for the worms to efficiently navigated towards the cultivation temperature.  #@NEW_LINE#@#  
Advantages_of_the_IRL_approach  #@NEW_LINE#@#  
Our approach has three advantages.  #@NEW_LINE#@#  First, it is generally applicable to behavioral data of any organism, not just C. elegans.  #@NEW_LINE#@#  Second, it can be applied independently of the experimental conditions.  #@NEW_LINE#@#  Our approach is especially suitable for analyzing behavior in natural conditions where target animals are behaving freely.  #@NEW_LINE#@#  To the best of our knowledge, this is the first study to identify the behavioral strategy of a freely-behaving animal by using IRL.  #@NEW_LINE#@#  Third, this approach estimates the strategy that generates natural behaviors, by introducing passive dynamics in the LMDP.  #@NEW_LINE#@#  Animal movements are usually restricted by external constraints, including inertia and gravity, as well as by internal (musculoskeletal) constraints; therefore, animals prefer entering a natural unrestricted state-transition.  #@NEW_LINE#@#  Thus, the LMDP-based IRL is suitable for modeling animal behavioral strategies.  #@NEW_LINE#@#  Although there are several studies on IRL application to human behaviors [1215], none of these have considered passive dynamics.  #@NEW_LINE#@#  Since high-throughput experiments produce massive amounts of behavioral data, our IRL approach could be a fundamental tool for their analysis, with applicability in behavioral sciences, in general, including ecology and ethology.  #@NEW_LINE#@#  

Validity_of_the_identified_strategies  #@NEW_LINE#@#  
We applied our IRL approach to worms of different genetic backgrounds (WT and three mutant strains) and confirmed that the identified behavioral strategies undertaken by the animals, as expressed by the desirability function, showed no discrepancy in thermotactic behaviors.  #@NEW_LINE#@#  The fact that fed WT worms aggregated at the cultivation temperature, while starved WT worms dispersed around it can be explained by the increased and decreased amplitude, respectively, of the desirability function at the cultivation temperature.  #@NEW_LINE#@#  We found that ASI- and AWC-deficient worms exhibit normal thermotaxis, and their desirability functions were similar to that of WT animals.  #@NEW_LINE#@#  However, AFD-deficient worms demonstrate cryophilic thermotaxis, consistent with the increased amplitude of the desirability function at lower temperatures.  #@NEW_LINE#@#  Taken together, these results demonstrate the validity of our approach, as well as its potential to determine changes in behavioral strategies.  #@NEW_LINE#@#  

Alternative_behavioral_strategies  #@NEW_LINE#@#  
Our approach provides novel insight into how the C. elegans reaches a target temperature on a thermal gradient.  #@NEW_LINE#@#  In theory, the strategy we identified is not the sole solution for the animals in order to reach the target state; several alternative solutions could have allowed animals to navigate to their behavioral goals.  #@NEW_LINE#@#  The strategies undertaken by fed or starved animals and the possible alternative ones are discussed below in terms of control theory [29].  #@NEW_LINE#@#  
In the case of the fed worms (Fig 5A5C), several alternative strategies might have enabled the animals in their DM towards the goal (cultivation temperature).  #@NEW_LINE#@#  The DM strategy is shown in Fig 5A.  #@NEW_LINE#@#  Fig 5B shows the desirability function for worms switching their preference between a positive and a negative temperature gradient, lower or higher than the goal temperature, representing the so called bang-bang control.  #@NEW_LINE#@#  A previous computational study modeled C. elegans thermotaxis based on the bang-bang control [30], in which straight runs and random turnings (corresponding to omega and reversal turns) alternate, while the run duration is regulated by the temperature, its temporal derivative and the cultivation temperature.  #@NEW_LINE#@#  Fig 5C shows the resulting desirability function when worms simply prefer the goal temperature, regardless of its temporal derivative.  #@NEW_LINE#@#  This might be interpreted as proportional (P) control.  #@NEW_LINE#@#  However, the identified DM strategy is based on both the absolute temperature and its temporal derivative, suggesting that the worms in fact perform proportional-derivative (PD) control, which is more sophisticated than the bang-bang control.  #@NEW_LINE#@#  
Regarding the strategy of the starved worms, similar alternatives exist, as discussed above.  #@NEW_LINE#@#  The worms could escape the cultivation temperature by performing bang-bang control or PD control, as shown in Fig 5E and 5F.  #@NEW_LINE#@#  The identified starved strategy however is closer to P control, which only uses the absolute temperature.  #@NEW_LINE#@#  Our IRL-based approach is therefore able to clarify how the worms control their thermosensory state throughout migration, which was not understood until now.  #@NEW_LINE#@#  

Functional_significance_of_DM_and_IM_strategies  #@NEW_LINE#@#  
We found that the WT worms use a thermotactic strategy consisting of two components; a diagonal, representing DM; and a horizontal, representing IM.  #@NEW_LINE#@#  What is the functional meaning of these two strategies?  #@NEW_LINE#@#  We propose that they might be necessary for balancing exploration and exploitation.  #@NEW_LINE#@#  Exploitation is the use of pre-acquired knowledge in an effort to obtain rewards, while exploration is the effort of searching for possible greater rewards.  #@NEW_LINE#@#  For example, worms know that food is associated with the cultivation temperature and can exploit this association.  #@NEW_LINE#@#  Alternatively, they can explore different temperatures to search for more food than that available at the cultivation temperature.  #@NEW_LINE#@#  In an uncertain environment, animals usually face an exploration-exploitation dilemma [31]; exploitative behaviors reduce the chance to explore for greater rewards, whereas exploratory behaviors disrupt the collection of the already-available reward.  #@NEW_LINE#@#  Therefore, an appropriate balance between exploration and exploitation is important for controlling behavioral strategies.  #@NEW_LINE#@#  We propose that DM and IM generate exploitative and explorative behaviors, respectively: the worms, via DM, exploit the cultivation temperature, and at the same time explore possible alternative rewards (food) in different temperatures through IM.  #@NEW_LINE#@#  
We found that in the case of starved worms, temperature and feeding are dissociated, and worms do not exhibit DM; instead they still exhibit IM.  #@NEW_LINE#@#  According to these findings, we hypothesize that DM emerges as a consequence of associative learning (association between the cultivation temperature and food access); the IM strategy, however, could be innate.  #@NEW_LINE#@#  Further investigation regarding these hypotheses should be expected in the future.  #@NEW_LINE#@#  
In the case of thermosensory neuron-deficient worms, we found that AWC-neuron ablation does not affect the desirability function, whereas AFD-neuron depletion abolishes the DM diagonal component, as well as any bias along the dT axis.  #@NEW_LINE#@#  The AWC and AFD neurons are both known to sense the temporal derivative of temperature, dT [16,22,23].  #@NEW_LINE#@#  Thus, we can assume that AFD-neuron loss might prevent worms from deciding whether an increase or decrease in temperature is favorable, which could lead to inefficient thermotactic migration.  #@NEW_LINE#@#  Thus, the AFD, but not AWC neurons, are involved in the DM based on temporal changes in temperature.  #@NEW_LINE#@#  

Future_perspectives_for_neuroscience_research  #@NEW_LINE#@#  
Finally, it is worth discussing future perspective of our IRL approach in neuroscience research focusing on higher-order animals beyond C. elegans.  #@NEW_LINE#@#  Over the last two decades, several reports have demonstrated that dopaminergic activity in the ventral tegmental area (VTA) encodes for reward prediction error [5], similar to temporal difference (TD) learning in RL [6], suggesting that animal behavioral strategies are associated with reward-based representation.  #@NEW_LINE#@#  In addition, it is widely believed that RL-like algorithms are processed within functionally connected cortical and subcortical areas, especially within the basal ganglia [3235] and amygdala [36,37], brain areas that heavily innervated by VTA dopaminergic neurons.  #@NEW_LINE#@#  Recent advances in neural recording technology have enabled researchers to monitor the activity of neuronal populations related to the reward-based representation of a given strategy in freely-behaving animals.  #@NEW_LINE#@#  However, the actual rewards for freely-behaving animals, especially those internally-represented in the brain, rather than the primitive ones, like food, are difficult to recognize.  #@NEW_LINE#@#  Our study shows that the presented IRL framework can identify the reward-based representation of animal strategies, thus allowing the analysis of neural correlates, such as comparing neural activities in freely-behaving animals with strategy-related variables, calculated by using IRL.  #@NEW_LINE#@#  Therefore, a combination of neuroscience experiments and the IRL technology could contribute in discovering behavioral neural substrates and their computational principles.  #@NEW_LINE#@#  


Materials_and_methods  #@NEW_LINE#@#  
Reinforcement_learning  #@NEW_LINE#@#  
RL is a machine learning model that describes how agents learn to obtain an optimal policy, that is, a behavioral strategy, in a given environment [4].  #@NEW_LINE#@#  RL consists of several components: an agent, an environment, and a reward function.  #@NEW_LINE#@#  The agent learns and makes decisions, and the environment is defined by everything else.  #@NEW_LINE#@#  The agent continuously interacts with the environment, in which the state of the agent changes based on its actions (behavior), and the agent gets a reward at the new state according to the reward function.  #@NEW_LINE#@#  The aim of the agent is to identify an optimal strategy (policy) that maximizes cumulative rewards in the long term.  #@NEW_LINE#@#  
In this study, the environment and the agents behavioral strategy were modeled as an LMDP, one of settings of RL [20].  #@NEW_LINE#@#  The LMDP included the passive dynamics of the environment, in the absence of control, and the controlled dynamics that reflect a behavioral strategy.  #@NEW_LINE#@#  Passive and controlled dynamics were each defined by transition probabilities from state s to s, namely, p(s|s) and (s|s), respectively.  #@NEW_LINE#@#  In each state, the agent not only acquires a reward, but also receives resistance to passive dynamics (Fig 1C).  #@NEW_LINE#@#  Thus, the net reward is described as  #@NEW_LINE#@#  
(2)  #@NEW_LINE#@#  
where r(s) denotes a state reward and KL[(.|s)||p(.|s)] indicates the KullbackLeibler (KL) divergence between (.|s) and p(.|s), which represents the resistance to passive dynamics.  #@NEW_LINE#@#  The optimal policy that maximizes the cumulative net reward has been analytically obtained [20] as  #@NEW_LINE#@#  
(3)  #@NEW_LINE#@#  
where the asterisk indicates optimal, and v(s) is the value function, i.e., the cumulative net reward expected from state s toward the future:  #@NEW_LINE#@#  
(4)  #@NEW_LINE#@#  
Here, we briefly show how to derive Eq (3).  #@NEW_LINE#@#  First, the controlled dynamics were defined as  #@NEW_LINE#@#  
(5)  #@NEW_LINE#@#  
where the elements us of a vector u directly modulate the transition probability of passive dynamics.  #@NEW_LINE#@#  Note that (s|s, 0) = p(s|s).  #@NEW_LINE#@#  Because of probability, Eq (5) must satisfy  #@NEW_LINE#@#  
(6)  #@NEW_LINE#@#  
The value function can be rewritten by the Bellman equation:  #@NEW_LINE#@#  
(7)  #@NEW_LINE#@#  
where .  #@NEW_LINE#@#  The maximization in Eq (7), subjected to Eq (6) by the method of Lagrange multipliers, yields u*, which represents the optimal strategy.  #@NEW_LINE#@#  Substituting u* in Eq (5) gives Eq (3).  #@NEW_LINE#@#  In addition, substituting the optimal strategy [Eq (3)] in the Bellman Eq (7) and dropping the max operator lead to  #@NEW_LINE#@#  
(8)  #@NEW_LINE#@#  
which satisfies Bellmans self-consistency.  #@NEW_LINE#@#  Using this equation, v(s) can be calculated from the reward function r(s), and vice versa.  #@NEW_LINE#@#  The full derivation is described in [20].  #@NEW_LINE#@#  

Inverse_reinforcement_learning_(estimation_of_the_value_function)  #@NEW_LINE#@#  
To estimate v(s), we assumed that the observed sequential state transitions {st, st+1}t = 1:T are generated by the stationary optimal policy *.  #@NEW_LINE#@#  We then maximized the likelihood of the sequential state transition:  #@NEW_LINE#@#  
(9)  #@NEW_LINE#@#  
where *(st+1|st; v(s)) corresponds to Eq (3).  #@NEW_LINE#@#  This estimation is called OptV [21].  #@NEW_LINE#@#  Based on the estimated v(s), the primary reward function, r(s), can be calculated by using Eq (8).  #@NEW_LINE#@#  
In our implementation, states were represented by a tabular format, in which 2-D space (temperature and its temporal derivative) was divided as a mesh grid.  #@NEW_LINE#@#  Thus, our IRL required a number of state trajectory data, spanning the entire mesh grid.  #@NEW_LINE#@#  In order to compensate for data limitation and noisy sensory systems, we assumed that animals have value functions that are smooth in their state space.  #@NEW_LINE#@#  To obtain smooth value functions, we regularized MLE as  #@NEW_LINE#@#  
(10)  #@NEW_LINE#@#  
where the first term represents the log-likelihood and the second term represents a smoothness constraint introduced to the value function; a positive constant  indicates the strength of the constraint, and (s) indicates a set of neighboring states of s in the state space.  #@NEW_LINE#@#  The evaluation function, i.e., the regularized log-likelihood, is convex with respect to v(s), which means there are no local minima in its optimization procedure.  #@NEW_LINE#@#  

Passive_dynamics_of_thermotaxis_in_C_elegans  #@NEW_LINE#@#  
To apply the LMDP-based IRL to the thermotactic behaviors of C. elegans, state s and passive dynamics p(s|s) were defined (phase 2 and 3 in Fig 1D).  #@NEW_LINE#@#  We previously found that the thermosensory AFD neurons encode the temporal derivative of the environmental temperature [22] and thus assumed that worms can sense not only the absolute temperature, T, but also its temporal derivative, dT/dt.  #@NEW_LINE#@#  We therefore set a 2-D state representation as (T, dT).  #@NEW_LINE#@#  For simplicity dT/dt is simply denoted as dT.  #@NEW_LINE#@#  
The passive dynamics were described by the transition probability of a state (T, dT) as  #@NEW_LINE#@#  
(11)  #@NEW_LINE#@#  
where N(x|, ) indicates a Gaussian distribution of variable x with mean  and variance , and t indicates the time interval of monitoring during behavioral experiments.  #@NEW_LINE#@#  The passive-dynamics aspect can be loosely interpreted as if the worms inertially migrate in a short time interval under a thermal gradient, and may be perturbed by white noise.  #@NEW_LINE#@#  The distribution of passive dynamics can be arbitrary selected, and the choice of Gaussian was not due to mathematical necessity for the IRL.  #@NEW_LINE#@#  

Artificial_data  #@NEW_LINE#@#  
To confirm that our regularized version of OptV (Eq (6)) provided a good estimation of the value function, we used simulation data.  #@NEW_LINE#@#  First, we designed the value function of T and dT as the ground truth (S1A Fig), and passive dynamics through Eq (7).  #@NEW_LINE#@#  Thus, the optimal policy was defined by Eq (3).  #@NEW_LINE#@#  Second, we generated a time-series of state transitions based on the optimal policy and separated these time series into training and test datasets.  #@NEW_LINE#@#  Next, we estimated v(s) from the training dataset, varying the regularization parameter  in Eq (6) (S1B Fig).  #@NEW_LINE#@#  We then evaluated the squared error between the behavioral strategy, based on the ground truth, and the estimated v(s), using the test dataset.  #@NEW_LINE#@#  Since the squared error on the test data was substantially reduced (by 88.1%) due to regularization, we deemed it effective for avoiding overfitting (S1C Fig).  #@NEW_LINE#@#  

Cross-validation  #@NEW_LINE#@#  
For estimating v(s), we performed cross-validation to determine  in Eq (10), and T and dT in Eq (11), with which the prediction ability is maximized.  #@NEW_LINE#@#  We divided the time-series behavioral data equally into nine parts.  #@NEW_LINE#@#  We then independently performed estimation of v(s) nine times; for each estimation, eight of the nine parts of the data were used for estimation, while the remaining part was used to evaluate the prediction ability of the estimated value function by the likelihood [Eq (9)].  #@NEW_LINE#@#  We then optimized those parameters at which we obtained the highest log-likelihood, as averaged from the nine estimations.  #@NEW_LINE#@#  

Surrogate_method-based_statistical_testing  #@NEW_LINE#@#  
To check whether the DM and IM strategies were not obtained by chance, surrogate method-based statistical testing was performed under a null hypothesis that the worms randomly migrated under a thermal gradient with no behavioral strategy.  #@NEW_LINE#@#  We first constructed a set of artificial temperature time-series, which could be observed under the null hypothesis.  #@NEW_LINE#@#  By using the iterated amplitude adjusted Fourier transform method [38], we prepared 1000 surrogate datasets by shuffling the observed temperature time-series (S5A Fig), while preserving the autocorrelation of the original time-series (S5B Fig).  #@NEW_LINE#@#  We then applied our IRL algorithm to this surrogate dataset to estimate the desirability function (S5C Fig).  #@NEW_LINE#@#  To assess the significance of the DM and IM strategies, we calculated the sums of the estimated desirability functions within the previously described horizontal and diagonal regions, respectively (S5D Fig).  #@NEW_LINE#@#  Empirical distributions of these test statistics for the surrogate datasets could then serve as null distributions (S5E Fig).  #@NEW_LINE#@#  For both DM and IM, the test statistic derived using the original desirability function was located above the empirical null distribution (p less_than0.001 for the DM strategy; p less_than0.001 for the IM strategy), indicating that both strategies were not obtained by chance but reflected an actual strategy of thermotaxis.  #@NEW_LINE#@#  

C_elegans_preparation  #@NEW_LINE#@#  
All worms were hermaphrodites and cultivated on OP50 as bacterial food using standard techniques [39].  #@NEW_LINE#@#  The following strains were used: N2 wild-type Bristol strain, PY7505 oyIs84[gcy-27p::cz::caspase-3(p17), gpa-4p::caspase-3(p12)::nz, gcy-27p::GFP, unc-122p::dsRed], IK2808 njIs79[ceh-36p::cz::caspase-3(p17), ceh-36p::caspase-3(p12)::nz, ges-1p::NLS::GFP] and IK2809 njIs80[gcy-8p::cz::caspase-3(p17), gcy-8p::caspase3(p12)::nz, ges-1p::NLS::GFP].  #@NEW_LINE#@#  The ASI-ablated strain (PY7505) was a kind gift from Dr. Piali Sengupta [27].  #@NEW_LINE#@#  The AFD-ablated strain (IK2809) and the AWC-ablated strain (IK2808) were generated by the expression of reconstituted caspases [40].  #@NEW_LINE#@#  Plasmids carrying the reconstituted caspases were injected at 25 ng/l with the injection marker pKDK66 (ges-1p::NLS::GFP) (50 ng/l).  #@NEW_LINE#@#  Extrachromosomal arrays were integrated into the genome by gamma irradiation, and the resulting strains were outcrossed four times before analysis.  #@NEW_LINE#@#  To assess the efficiency of cell killing by the caspase transgenes, the integrated transgenes were crossed into integrated reporters that expressed GFPs in several neurons, including the neuron of interest, as follows: IK0673 njIs2[nhr-38p::GFP, AIYp::GFP] for AFD and IK2811 njIs82[ceh-36p::GFP, glr-3p::GFP] for AWC.  #@NEW_LINE#@#  Neuronal loss was confirmed by the disappearance of fluorescence; 100% of njIs80 animals displayed a loss of AFD and 98.4% of the njIs79 animals displayed a loss of AWC neurons.  #@NEW_LINE#@#  

Thermotaxis_assay  #@NEW_LINE#@#  
Thermotaxis assays were performed as previously described [41].  #@NEW_LINE#@#  Animals were first cultivated at 20Â°C and then placed on the center of an assay plate (14 cm Ã 10 cm, 1.45 cm height) containing 18 ml of thermotaxis medium, supplemented with 2% agar, and were allowed to move freely for 60 min.  #@NEW_LINE#@#  The center of the plate was adjusted to 17, 20, or 23Â°C, to create three different gradient conditions, and the plates were then maintained at a linear thermal gradient of approximately 0.45Â°C/cm.  #@NEW_LINE#@#  

Behavioral_recording  #@NEW_LINE#@#  
Worm behaviors were recorded using a CMOS sensor camera-link camera (8 bits, 4,096 Ã 3,072 pixels; CSC12M25BMP19-01B; Toshiba-Teli), a Line-Scan Lens (35 mm, f/2.8; YF3528; PENTAX), and a camera-link frame grabber (PCIe-1433; National Instruments).  #@NEW_LINE#@#  The camera was mounted at a distance above the assay plate and consistently produced an image with 33.2 m per pixel.  #@NEW_LINE#@#  The frame rate of recordings was approximately 13.5 Hz.  #@NEW_LINE#@#  Images were captured and processed by a multi-worm Tracker [24], to detect worm bodies and measure the position of the centroid.  #@NEW_LINE#@#  


Supporting_information  #@NEW_LINE#@#  
S1_Fig_Validation_of_the_regularized_(OptV)_estimation_method_by_using_artificial_data  #@NEW_LINE#@#  
(A) The desirability function corresponding to the ground truth value function used for generation of artificial data.  #@NEW_LINE#@#  Time-series data were artificially generated as training and test data sets by sampling Eq (1), based on the ground truth of the value function.  #@NEW_LINE#@#  (B) The desirability functions under three different regularization parameters () were visualized from the estimated value functions.  #@NEW_LINE#@#  (C) Squared error between the behavioral strategies based on the ground truth and estimated value functions using the test data set.  #@NEW_LINE#@#  The presence of an optimal , at which the minimal squared error is obtained, indicates that the regularization was effective for accurately estimating the value function.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1006122.s001  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S2_Fig_Behaviors_in_the_T-dT_space  #@NEW_LINE#@#  
(A) T-dT trajectories of fed WT worms.  #@NEW_LINE#@#  This is another representation of Fig 2E.  #@NEW_LINE#@#  (B) Distributions of T and dT in all trajectories of fed WT worms.  #@NEW_LINE#@#  Notice that the distribution is substantially different from the desirability function (see Fig 3B).  #@NEW_LINE#@#  (C) Scatter plot of T and dT at 5 seconds before the moment of sharp turns.  #@NEW_LINE#@#  Correlation coefficient was 3.6e-10.  #@NEW_LINE#@#  Note that dT is 0 at the moment of a sharp turn, because the worm stops in order to make large directional changes.  #@NEW_LINE#@#  (D) Histogram of the scatter plot in C.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1006122.s002  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S3_Fig_Inverse_reinforcement_learning_analysis_using_one-dimensional_state_representation  #@NEW_LINE#@#  
IRL was performed with one-dimensional state representation (s = (T)).  #@NEW_LINE#@#  (A) The desirability function was calculated using the estimated value function.  #@NEW_LINE#@#  In the estimation, the regularization parameter, , in Eq (6), was optimized by cross-validation.  #@NEW_LINE#@#  (B) The prediction ability was compared between IRLs with s = (T, dT) and s = (T) using a cross-validation dataset.  #@NEW_LINE#@#  The negative log-likelihood of behavioral strategies (Eq (1)) when estimating the value function of both T and dT (see Fig 3B), was significantly smaller than when estimating the value function of T alone (A; p = 0.0002; Mann-Whitney U test).  #@NEW_LINE#@#  Thus, the behavioral strategy with s = (T, dT) was more appropriate than that with s = (T).  #@NEW_LINE#@#  (C) The desirability function became smoother as  increased, with a peak around the cultivation temperature (20Â°C).  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1006122.s003  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S4_Fig_Reproduction_of_thermotaxis_by_simulating_the_identified_strategy  #@NEW_LINE#@#  
(A) The identified desirability function of the fed WT worms.  #@NEW_LINE#@#  This is identical to Fig 3B.  #@NEW_LINE#@#  (B) Temperature time-series of simulated worms started from 15, 20, or 25Â°C with 0Â°C/s.  #@NEW_LINE#@#  In the simulation, the state transition was sampled from Eq (3) using the identified desirability function in (A).  #@NEW_LINE#@#  Different colored lines correspond to different simulation runs.  #@NEW_LINE#@#  (C) Temporal changes in distributions of 100 simulated worms.  #@NEW_LINE#@#  Notice that most worms converged around the cultivation temperature, i.e., 20Â°C.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1006122.s004  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S5_Fig_Statistical_test_of_the_behavioral_strategy_reliability_using_the_surrogate_method  #@NEW_LINE#@#  
The reliability of the directed migration (DM) and isothermal migration (IM) strategies (see Fig 3) was assessed by means of statistical testing with the null hypothesis that worms randomly migrate with no behavioral strategy.  #@NEW_LINE#@#  (A) To generate time-series data under this null hypothesis, original time-series data of temperature (left panel) were surrogated by the iterated amplitude adjusted Fourier transform method (right panel).  #@NEW_LINE#@#  (B) Before and after the surrogation, the autocorrelations were almost preserved.  #@NEW_LINE#@#  (C) The desirability functions estimated from the surrogate datasets.  #@NEW_LINE#@#  (D) The DM and IM strategies correspond to the red-highlighted diagonal and horizontal regions of the desirability function, respectively.  #@NEW_LINE#@#  Within these regions, sums of the estimated desirability functions were calculated as test statistics.  #@NEW_LINE#@#  (E) Histograms of the empirical null distributions of the test statistics for the DM and IM strategies.  #@NEW_LINE#@#  Test statistics derived by the original desirability function (red arrows) are located above the empirical null distributions (p less_than0.001 for the PT strategy; p less_than0.001 for the IT strategy).  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1006122.s005  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S6_Fig_Estimated_value_reward_functions_and_state_distributions  #@NEW_LINE#@#  
The estimated value functions, reward functions, and state distributions are depicted for the ASI- (A), AWC- (B), and AFD-deficient worms (C), as well as for the starved WT worms (D).  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1006122.s006  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
We thank Drs.  #@NEW_LINE#@#  Eiji Uchibe, Masataka Yamao, and Shin-ichi Maeda for their valuable comments.  #@NEW_LINE#@#  We are also grateful to Dr. Shigeyuki Oba for giving advice on statistical testing.  #@NEW_LINE#@#  

References  #@NEW_LINE#@#  



