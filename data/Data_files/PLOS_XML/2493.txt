article id="http://dx.doi.org/10.1371/journal.pbio.2002842"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Deconstructing the principles of ductal network formation in the pancreas  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
The mammalian pancreas is a branched organ that does not exhibit stereotypic branching patterns, similarly to most other glands.  #@NEW_LINE#@#  Inside branches, it contains a network of ducts that undergo a transition from unconnected microlumen to a mesh of interconnected ducts and finally to a treelike structure.  #@NEW_LINE#@#  This ductal remodeling is poorly understood, both on a microscopic and macroscopic level.  #@NEW_LINE#@#  In this article, we quantify the network properties at different developmental stages.  #@NEW_LINE#@#  We find that the pancreatic network exhibits stereotypic traits at each stage and that the network properties change with time toward the most economical and optimized delivery of exocrine products into the duodenum.  #@NEW_LINE#@#  Using in silico modeling, we show how steps of pancreatic network development can be deconstructed into two simple rules likely to be conserved for many other glands.  #@NEW_LINE#@#  The early stage of the network is explained by noisy, redundant duct connection as new microlumens form.  #@NEW_LINE#@#  The later transition is attributed to pruning of the network based on the flux of fluid running through the pancreatic network into the duodenum.  #@NEW_LINE#@#  

Author_summary  #@NEW_LINE#@#  
In the pancreas of mammals, digestive enzymes are transported from their production site in acini (clusters of cells that secrete the enzymes) to the intestine via a network of ducts.  #@NEW_LINE#@#  During organ development in fetuses, the ducts initially form by the coordinated polarization of cells to form small holes, which will connect and fuse, to constitute a meshwork.  #@NEW_LINE#@#  This hyperconnected network further develops into a treelike structure by the time of birth.  #@NEW_LINE#@#  In this article, we use methods originally developed to analyze road, rail, web, or river networks to quantify the network properties at different developmental stages.  #@NEW_LINE#@#  We find that the pancreatic network properties are similar between individuals at specific time points but eventually change to achieve the most economical and optimized structure to deliver pancreatic juice into the duodenum.  #@NEW_LINE#@#  Using in silico modeling, we show how the stages of pancreatic network development follow two simple rules, which are likely to be conserved for the development of other glands.  #@NEW_LINE#@#  The early stage of the network is explained by noisy, redundant duct connection as new small ductal holes form.  #@NEW_LINE#@#  Later on, the secretion of fluid that runs through the pancreatic network into the duodenum leads to the widening of ducts with the greatest flow, while nonnecessary ducts are eliminated, akin to how river beds are formed.  #@NEW_LINE#@#  

Citation: Dahl-Jensen SB, Yennek S, Flasse L, Larsen HL, Sever D, Karremore G, et al.  #@NEW_LINE#@#  (2018) Deconstructing the principles of ductal network formation in the pancreas.  #@NEW_LINE#@#  PLoS Biol 16(7):  #@NEW_LINE#@#  
           e2002842.  #@NEW_LINE#@#  

        https://doi.org/10.1371/journal.pbio.2002842  #@NEW_LINE#@#  
Academic Editor: Emma Rawlins, University of Cambridge Department of Pathology, United Kingdom of Great Britain and Northern Ireland  #@NEW_LINE#@#  
Received: April 25, 2017; Accepted: July 16, 2018; Published:  July 26, 2018  #@NEW_LINE#@#  
Copyright:  © 2018 Dahl-Jensen et al.  #@NEW_LINE#@#  This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.  #@NEW_LINE#@#  
Data Availability: All relevant data are within the paper and its Supporting Information files.  #@NEW_LINE#@#  
Funding: Danish National Research Foundation https://dg.dk/en/ (grant number DNRF 116).  #@NEW_LINE#@#  Received by AGB.  #@NEW_LINE#@#  The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  Danish National Research Foundation https://dg.dk/en/ (grant number Center for Models of life).  #@NEW_LINE#@#  Received by KS.  #@NEW_LINE#@#  The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  Novo Nordisk Foundation http://novonordiskfonden.dk/en (grant number NNF17CC0027852).  #@NEW_LINE#@#  Received by AGB.  #@NEW_LINE#@#  The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  European Union's Seventh Framework Programme ERC Grant https://erc.europa.eu/funding/advanced-grants (grant number 740704).  #@NEW_LINE#@#  Received by KS.  #@NEW_LINE#@#  The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  
Competing interests:  The authors have declared that no competing interests exist.  #@NEW_LINE#@#  
Abbreviations:  #@NEW_LINE#@#  
          3D,  #@NEW_LINE#@#  
            three-dimensional; Ano1/Tmem16a,  #@NEW_LINE#@#  
            anoctamin-1/transmembrane member 16a; BABB,  #@NEW_LINE#@#  
            solution of 1:2 Benzyle Alcohol and Benzyle Benzoate; BICC1,  #@NEW_LINE#@#  
            bicaudal C homolog 1; CFTR,  #@NEW_LINE#@#  
            cystic fibrosis transmembrane conductance regulator; E,  #@NEW_LINE#@#  
            embryonic day; FGF,  #@NEW_LINE#@#  
            fibroblast growth factor; HNF1B,  #@NEW_LINE#@#  
            hepatocyte nuclear factor 1 beta; HNF-6,  #@NEW_LINE#@#  
            hepatocyte nuclear factor 6; Kif3a,  #@NEW_LINE#@#  
            kinesin family member 3a; LN,  #@NEW_LINE#@#  
            lumen node; MST,  #@NEW_LINE#@#  
            minimum spanning tree; NR5A2,  #@NEW_LINE#@#  
            nuclear receptor subfamily 5 group A member 2; PBS,  #@NEW_LINE#@#  
            phosphate-buffered saline; RhoA,  #@NEW_LINE#@#  
            Ras homolog gene family member A; Slc26a6,  #@NEW_LINE#@#  
            solute carrier family 26 member 6  #@NEW_LINE#@#  
Introduction  #@NEW_LINE#@#  
Branching is a phenomenon that appears everywhere in life.  #@NEW_LINE#@#  Biological examples include tree leaves and branches [1], the arterial and venous systems [2], the liver [3], lung [4,5], kidney, and several glands such as the pancreas, the mammary [6], salivary [7], lacrimal [8], prostate [9], and meibomian glands [10].  #@NEW_LINE#@#  Work carried out on independent organs suggests that several branched organs share principles, such as the importance of mesenchymal signals, and even molecules, such as a frequent use of fibroblast growth factor (FGF) sources [4,5].  #@NEW_LINE#@#  However, important differences in morphogenesis also exist across organs.  #@NEW_LINE#@#  For example, branching is more stereotypic in the lung than in glands, in which the ductal tree differs between individuals.  #@NEW_LINE#@#  Though emphasis has been put on the outer shape of the branching epithelium, experiments in the pancreas [11,12] and salivary glands [13] suggest that the branching process may be driven from inside the gland when lumen form and connect into tubes.  #@NEW_LINE#@#  
The mature pancreas is a branched organ in which branches are formed of monolayers of cells assembled into tubes that are connected to form a treelike structure with exit into the duodenum.  #@NEW_LINE#@#  The pancreas is composed of three main components: acinar, ductal, and endocrine cells.  #@NEW_LINE#@#  Acinar cells at the terminal ends of the ductal tree secrete digestive enzymes into the ducts, which deliver them into the duodenum [14].  #@NEW_LINE#@#  Ductal cells secrete water, the bicarbonate that neutralizes acidic gastric juices, and mucus that protects the ducts [15,16].  #@NEW_LINE#@#  The basic pH of ductal secretions contributes to keeping the digestive enzymes inactive until they reach the duodenum.  #@NEW_LINE#@#  The endocrine cells reside in islets of Langerhans embedded near the ductal system and regulate glucose homeostasis by secretion into the bloodstream.  #@NEW_LINE#@#  In recent years, our understanding of pancreatic development has grown with increasing speed, driven by advances in both image acquisition and methods for tracking and categorizing cells.  #@NEW_LINE#@#  
Around embryonic day (E) 9.5 of mouse development, cells in the foregut endoderm change from a cuboidal into a columnar shape, forming the dorsal and mouse pancreatic buds [17,18].  #@NEW_LINE#@#  The pancreatic progenitor cells then proliferate and form a stratified epithelium, with most cells losing their apical domain and connection to the duodenal lumen.  #@NEW_LINE#@#  Shortly after, clusters of cells begin forming microlumen.  #@NEW_LINE#@#  At E10.75, several of these microlumen exist, some of which are connected by polarized canals [12].  #@NEW_LINE#@#  Isolated lumen continue to emerge and subsequently connect to this burgeoning network.  #@NEW_LINE#@#  This results in a plexus of interconnected ducts at E12.5 [11,12,17].  #@NEW_LINE#@#  
From E12.5, the now densely packed epithelium starts remodeling its ductal structure.  #@NEW_LINE#@#  This, combined with general expansion of the epithelium and associated ducts, results in fingerlike protrusions of plexus into the surrounding mesenchyme [12,17].  #@NEW_LINE#@#  Running in parallel with this remodeling, the cells begin to segregate into domains with distinctive tip and trunk cell identities [19].  #@NEW_LINE#@#  Tip domains contain cells that are progressively restricted to an acinar fate, while the trunk domain contains the endocrine/duct bipotent progenitors.  #@NEW_LINE#@#  Starting from E13.5, the tip cells become committed to the acinar fate and start a massive wave of proliferation, rapidly increasing the amount of acinar ends in the network [19].  #@NEW_LINE#@#  At around E18.5, the network of the pancreas is more arborized, forming a ramified ductal network [20].  #@NEW_LINE#@#  In the adult, the ducts are categorized in a rough hierarchical order of duct thickness, with the smallest intercalated ducts close to acini, intralobular ducts, and ending with the interlobular ducts separating the lobes of the pancreas [14].  #@NEW_LINE#@#  
We still know little about how the microlumen coalesce into a plexus.  #@NEW_LINE#@#  Kesavan and colleagues showed that epithelial polarity is needed for microlumen formation and maintenance of the ductal network [11].  #@NEW_LINE#@#  However, a detailed description of how the microlumens form the ductal network is missing.  #@NEW_LINE#@#  Even less understood are the mechanisms for remodeling the ductal network from a plexus to a ramified treelike organ.  #@NEW_LINE#@#  Villasenor and colleagues provided invaluable insight into this process with a detailed anatomical description of the remodeling process [12].  #@NEW_LINE#@#  They unveiled that the pancreas might be more stereotypic than previously believed and could identify trends in the patterns of branches.  #@NEW_LINE#@#  However, further understanding has been limited by a lack of quantitative measures.  #@NEW_LINE#@#  
In this work, we digitize the ductal network at 3 distinct phases in the development of its ductal tree.  #@NEW_LINE#@#  We chose E12.5 to represent the early stage with an almost completely interlinked plexus.  #@NEW_LINE#@#  E14.5 represents the intermediary network in which distinct cell types are appearing and plexus remodeling starts to be visible.  #@NEW_LINE#@#  Finally, E18.5 represents the (almost) fully mature network.  #@NEW_LINE#@#  We show that the pancreatic ductal system has stereotypic traits at each stage and that its remodeling can be quantified by standard network measures.  #@NEW_LINE#@#  
Using in silico modeling, we deconstruct the main steps of network development into a set of simple rules.  #@NEW_LINE#@#  We show that the creation of the early network from E10.5 to E12.5 can be explained by noisy, redundant duct formation as new microlumens form.  #@NEW_LINE#@#  We show that a little noise in both the amount of microlumen connections and where it connects is needed to reproduce a network similar to the E12.5.  #@NEW_LINE#@#  We subsequently show that the later transition from E14.5 to E18.5 can be reproduced by pruning the network based on a flux of fluid running through the pancreatic network into the duodenum.  #@NEW_LINE#@#  Taken together, we show that pancreatic ductal development can be conceptualized into simple, rule-based modeling that is likely of relevance to several other glands including secreting fluid.  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
Digitizing_the_pancreatic_network  #@NEW_LINE#@#  
To assess and quantify the development of the pancreatic ductal network, we first digitized it.  #@NEW_LINE#@#  The ducts were visualized by whole-mount immunostaining of mucin1 and e-cadherin, which respectively highlight the apical side of cells forming the ductal structure and the membranes of the cells lining the ducts.  #@NEW_LINE#@#  Although automatic segmentation succeeded in digitizing a large part of the network, it failed on fine ducts.  #@NEW_LINE#@#  Several of the ductal parameters rely on mapping all duct types.  #@NEW_LINE#@#  The networks were therefore manually skeletonized at different time points by mapping the terminal ends and intersections of the ducts.  #@NEW_LINE#@#  Thereby, we defined nodes and linked them by edges following the ductal system (S1 Fig).  #@NEW_LINE#@#  The method is labor intensive, and we therefore largely focused on the ventral pancreas, as it is almost entirely planar at its later developmental stages and is therefore easier to map manually.  #@NEW_LINE#@#  Some comparisons with the dorsal pancreas were done at E14.5 to test whether the network was different.  #@NEW_LINE#@#  The resulting networks (Fig 1) closely resemble the pancreatic structure reported in previous studies [11,12,17,20].  #@NEW_LINE#@#  The network appears as a plexus at E12.5 and E14.5 and ends as a more treelike structure at E18.5.  #@NEW_LINE#@#  

Quantifying_network_properties_and_their_temporal_evolution  #@NEW_LINE#@#  
The digitization of the pancreatic duct system enables us to derive its network properties based on nodes and links that form the network (Fig 2).  #@NEW_LINE#@#  A nodes degree k is the amount of connections it has to other nodes.  #@NEW_LINE#@#  The polygonal features formed by the nodes and their links are derived by counting network limit cycles and give a measure of how interlinked the network is [21].  #@NEW_LINE#@#  The average clustering coefficient C (less_than greater than  denotes average) relates to the number of triangles found in the network [22].  #@NEW_LINE#@#  In addition, we consider the cost of the network in terms of redundancy of paths from one point to another.  #@NEW_LINE#@#  This was quantified by comparing the network in question to its (euclidian) minimum spanning tree (MST) obtained by connecting the nodes in the spatial location with links that minimize the total length of all links in the network [23,24].  #@NEW_LINE#@#  A similar comparison quantified network performance, defined by the transport distance along the network between all pairs of nodes, normalized by the MST.  #@NEW_LINE#@#  
The E12.5 and E14.5 pancreas networks contain many polygonal features (short loops), have a cost above 1, and have a performance below 1, all features of an overconnected network [24].  #@NEW_LINE#@#  At these stages, there is more than one path from a point to the duodenal exit.  #@NEW_LINE#@#  Both the E12.5 and E14.5 networks have a dimension close to 2 (Fig 2, S2 Fig), highlighting that the planarity that is visible at E18.5 is also present in the network from early developmental stages.  #@NEW_LINE#@#  The dorsal pancreas, mapped at E14.5, is also an overconnected network.  #@NEW_LINE#@#  The dorsal pancreas has more redundant ducts than the ventral pancreas at this stage, evident from its number of polygons, average degree, and clustering coefficient.  #@NEW_LINE#@#  The dimension of the network remains close to 2, suggesting that the dorsal pancreas is also planar.  #@NEW_LINE#@#  The ventral E14.5 network has a slightly lower cost, worse performance, and slightly fewer polygons than the E12.5 after normalization to network size, which suggests that some redundant ducts may start to be eliminated.  #@NEW_LINE#@#  The E18.5 network has almost no polygons and a cost of 1.2.  #@NEW_LINE#@#  The ventral network was mapped on about half of the ventral pancreas at E18.5, always on the same area.  #@NEW_LINE#@#  A single E18.5 ventral pancreas has been fully mapped to see the shift in network properties from the partially mapped E18.5 (S3 Fig).  #@NEW_LINE#@#  Nearly all features analyzed were similar, with the exception of performance.  #@NEW_LINE#@#  This finding lends credibility to the use of partially mapped E18.5 ventral pancreata, with the caveat that the true performance of these networks might be even better, closer to 0.4, based on the whole ventral part analysis.  #@NEW_LINE#@#  This mature network contains almost no redundant connections.  #@NEW_LINE#@#  The network undergoes drastic changes as the pancreas matures (E12.5  E18.5), with a loss of almost every polygonal structure and an order of magnitude shift in clustering coefficient (Figs 2 and 3).  #@NEW_LINE#@#  
The size of the network increases as seen in the total length Ltot of the ductal system (bearing in mind that only half of the E18.5 networks were mapped).  #@NEW_LINE#@#  The average distance to the network exit Droot increases with development, meaning that the network expands away from the exit node.  #@NEW_LINE#@#  The average distances between all nodes D increases even more than to the common exit node, reflecting that distances in the early development are reduced by redundant connections.  #@NEW_LINE#@#  The system loses its redundant connections and thereby has a decrease in cost and a shift in network dimension from 2 to 1.7.  #@NEW_LINE#@#  This transformation agrees with the visual evidence that the pancreas prunes its structure to a treelike structure [12].  #@NEW_LINE#@#  The changes from E12.5 to E14.5 are less pronounced, although there is a significant loss of local loops (polygons) and a slight decrease in average degree k. However, the absolute number of polygonal features of the E14.5 network is higher than at E12.5.  #@NEW_LINE#@#  This suggests that either pruning of links takes place alongside growth at the E14.5 stage or that the newly formed network forms without loops.  #@NEW_LINE#@#  The existence of loops at the network periphery suggests that the newly grown network also forms with redundant ducts while pruning has been initiated (S4 Fig).  #@NEW_LINE#@#  None of the digitized networks resembled their randomized counterparts, suggesting that there are rules behind their formation (S5 Fig).  #@NEW_LINE#@#  
We visualize some of these network transformations in (Fig 3).  #@NEW_LINE#@#  As the pancreas matures to E18.5, the network gains more nodes with degree 1 (terminal end) compared to earlier stages.  #@NEW_LINE#@#  Even at the mature stage, the network retains a few nodes with degree 5 and higher.  #@NEW_LINE#@#  Fig 3B also visualizes the normalized distribution of polygonal features in the network as the pancreas matures.  #@NEW_LINE#@#  Each developmental stage has a defining amount of such loops.  #@NEW_LINE#@#  It is therefore possible to separate each pancreatic stage based on its polygons.  #@NEW_LINE#@#  Another and more global network characterization is the average distance to the exit normalized by the average distance between every node Droot/D (Fig 3C).  #@NEW_LINE#@#  This property decreases substantially as the pancreas matures from stage E14.5 to E18.5.  #@NEW_LINE#@#  Strikingly, the average distance to the exit of the pancreas approaches the average distance between nodes.  #@NEW_LINE#@#  This again demonstrates the development toward a branched treelike structure, with the exit node as the common center.  #@NEW_LINE#@#  Taken together, our analysis shows that although the branches of the pancreas are different between individual mice [12], the pancreatic network structure is stereotypic at each stage and changes systematically as the pancreas matures.  #@NEW_LINE#@#  

Network_creation_by_redundant_linking  #@NEW_LINE#@#  
In order to deconstruct the formation and maturation of the ductal network, we condensed our observations into a few principles and implemented these in silico (Fig 4).  #@NEW_LINE#@#  First, we describe the formation of the network in terms of a growth model, starting with a single lumen node (LN).  #@NEW_LINE#@#  LNs are subsequently added at a random position within rCM + 0.5 of the existing LNs center of mass, where rCM is the distance from the LNs center of mass to the most distant point in the network.  #@NEW_LINE#@#  These newly added nodes are then connected to the already generated network.  #@NEW_LINE#@#  Each new node forms M + 1 links with the existing network, where M is drawn from a Poisson distribution with mean .  #@NEW_LINE#@#  The assigned links are then attached to the neighboring LNs drawn from a pool of the M + 1 +  closest LNs, where  is parametrizing the spatial specificity for local links formation.  #@NEW_LINE#@#  Fig 4C shows the best fit together with the in vivo data for the E12.5 networks.  #@NEW_LINE#@#  In the supporting information, we show that an expanded parameter analysis of the in silico network approximately recapitulates the observed properties of the E12.5 pancreas network, provided that  is about 1.  #@NEW_LINE#@#  The cost measures are the limiting factor for larger  values (S6 Fig).  #@NEW_LINE#@#  Further, it seems that  = 0.25 yields the best fit, which means that simulations best fit the biological data when new nodes only connect to slightly more than 1 node.  #@NEW_LINE#@#  A higher  results in too many triangles and a too high cost measure of the network (S6 and S7 Figs), whereas a lower  results in too few loops of any length.  #@NEW_LINE#@#  Therefore, in order to achieve the observed network, some noise is needed in the number of formed connections between new nodes and where they connect.  #@NEW_LINE#@#  We notice that the best fit does not completely pass every statistical test for all measures.  #@NEW_LINE#@#  These discrepancies might be explained by the lack of a growth direction in the model, which results in a roughly spherical structure of the simulated 3D network.  #@NEW_LINE#@#  Some secretory organs, such as the kidney, exhibit an initial phase of stereotyped duct formation followed by less stereotyped processes [25,26].  #@NEW_LINE#@#  Though this has not been observed in the early pancreas [12], this may have been overlooked.  #@NEW_LINE#@#  We thus attempted to initialize the network from small initial binary/dichotomic patterns (L-system) of 4, 20, and 100 out of the nodes eventually generated.  #@NEW_LINE#@#  The decrease in polygons becomes significant only when the initial L-system makes up a large fraction of the whole network (100 out of about 320) (S8 Fig).  #@NEW_LINE#@#  

Flux-based_pruning_of_the_network  #@NEW_LINE#@#  
The ductal network of the E12.5 pancreas has an inhomogeneous duct thickness that does not indicate a hierarchy between the main duct and its terminal ends [12].  #@NEW_LINE#@#  In contrast, the ductal network at E14.5 exhibits some hierarchy of duct diameter, with wider ducts close to the exit, making it possible to identify a difference between terminal ends and the main duct [12].  #@NEW_LINE#@#  This hierarchy is even more distinct at the E18.5 stage, in which the main duct and the acini ends are easily identified [12].  #@NEW_LINE#@#  This suggests that duct diameter relates to fluid running through the developing pancreas.  #@NEW_LINE#@#  We hypothesized that fluid running through the network may contribute to other time evolutions of the ductal network such as the pruning of redundant ducts.  #@NEW_LINE#@#  We postulated that, as the pancreas matures, redundant ducts would compete, and the smallest of competing ducts may be remodeled or merged.  #@NEW_LINE#@#  In order to assess this flux-based mechanism for pruning of the network, we constructed a simple in silico model (S9A Fig).  #@NEW_LINE#@#  The model uses the already digitized E14.5 pancreatic networks as its input.  #@NEW_LINE#@#  Fluid is added at the terminal ends of the network continually and is drained at the exit to the duodenum.  #@NEW_LINE#@#  This assumes that the acinar cells are the main contributors of fluid in the developing pancreas, but this assumption can be relaxed by simulating ductal secretion on every node, without significant change of our results (see Fig 5, S10 Fig).  #@NEW_LINE#@#  There is in fact evidence that ductal cells also secrete fluid during development [27].  #@NEW_LINE#@#  The network is then allowed to reach steady state.  #@NEW_LINE#@#  This simulation provides a measure of the flux through all the ductal links (Figs 5A and S10A).  #@NEW_LINE#@#  We see that the high flux links lie in the inner pancreas structure, and the highest fluxes are found close to the exit of the pancreas (S11 Fig).  #@NEW_LINE#@#  This would impose a higher hydrostatic pressure and flow, which promotes widening of the ducts, in agreement with the observation that the largest ducts of the pancreas are closest to converging points and to the exit [12].  #@NEW_LINE#@#  Similar phenomena have been reported during the transition from networks to trees in blood vessels [2831].  #@NEW_LINE#@#  According to Poiseuilles law, a high flux of fluid is expected to result in a high internal pressure, which is lessened by increasing duct width, equilibrating at steady state to the same pressure for every duct (see Materials and methods).  #@NEW_LINE#@#  In agreement with this hypothesis, we show that the drained basin (approximated to the total number of total nodes or duct length upstream of a given duct) is proportional to the cube of duct diameter (S11 Fig).  #@NEW_LINE#@#  This is exactly what is to be expected from laminar flow in a duct system with draining (see Materials and methods).  #@NEW_LINE#@#  
Our assumption is further that ducts that carry low or no flow tend to be eliminated.  #@NEW_LINE#@#  The second part of the model therefore consists of pruning the network, removing redundant links with the lowest flux.  #@NEW_LINE#@#  A link is considered redundant if its removal does not fragment the network (S9A Fig).  #@NEW_LINE#@#  This process is repeated, removing subsequent redundant links until the network is a perfect treelike structure (Fig 5).  #@NEW_LINE#@#  We observe that flux-based pruning results in the network being pruned from its periphery and progressively toward the center/outlet (Fig 5B, S10B Fig).  #@NEW_LINE#@#  This result agrees with the experimentally observed network structure [32].  #@NEW_LINE#@#  
We further compare the flux-pruned network with a network that instead is pruned by randomly removing redundant links regardless of their flux (Fig 5, S10B Fig).  #@NEW_LINE#@#  Fig 5C quantifies that the flux-pruned network matches the mature pancreas significantly better than the random-pruned network.  #@NEW_LINE#@#  The random-pruned network does not correctly prioritize the exit to the duodenum (Fig 5C), and as a result, it will be less efficient at transporting fluid to the exit.  #@NEW_LINE#@#  

Experimentally_induced_lack_of_exit_prevents_pruning  #@NEW_LINE#@#  
We previously established an in vitro 3-dimensional (3D) culture model in which small clusters of pancreatic progenitors proliferate, differentiate, and self-organize to form a pancreas-like structure [33].  #@NEW_LINE#@#  The forming organoids branch and form ducts after 7 days of culture [33,34].  #@NEW_LINE#@#  By whole-mount immunocytochemistry detection of the apical marker mucin, we observe that these organoids form a network of pancreatic ducts.  #@NEW_LINE#@#  This network is isotropic and lacks an exit point.  #@NEW_LINE#@#  Although the organoids are extracted from E10.5 pancreas and kept for 7 days in culture, they do not recapitulate the features of a network that resemble the one seen in the pancreas at E18.5.  #@NEW_LINE#@#  They do establish lumen and connect them into a network, but the network in the organoid exhibits a large number of loops, high cost, low performance, and high average connectivity (Figs 1 and 2).  #@NEW_LINE#@#  Its high cost and low performance suggest a level of connectivity that is even higher than the E12.5 pancreas.  #@NEW_LINE#@#  A network devoid of exit point is not exposed to a net flux, even if it is actively secreting, which is suggested by the observation that with time, the lumens widen to eventually form cysts at day 10 of culture [33].  #@NEW_LINE#@#  Taken together, this suggests that in the absence of flux, pruning does not occur.  #@NEW_LINE#@#  

Secretion_of_fluid_during_embryogenesis  #@NEW_LINE#@#  
Pancreatic secretion and flux have not been studied in the embryo.  #@NEW_LINE#@#  The fluid secreted by the pancreas in the adult originates from ductal cells, for the most part, and from acinar cells [16,35].  #@NEW_LINE#@#  Many of the channels and transporters involved in fluid secretion have been uncovered.  #@NEW_LINE#@#  Using transcriptional profiling, we found that many were already expressed at E10.5, E12.5, and 14.5 (S12 Fig).  #@NEW_LINE#@#  Several important players were up-regulated between E10.5 and E12.5 at the time of microlumen formationnotably, the apical chloride channel cystic fibrosis transmembrane conductance regulator (CFTR), which is coupled to the anion exchanger solute carrier family 26 member 6 (Slc26a6) for ductal bicarbonate secretion, as well as the calcium-activated chloride channel anoctamin-1 (Ano1)/transmembrane member 16a (Tmem16a), active also in adult acinar and ductal cells [16,35,36].  #@NEW_LINE#@#  These are the main channels secreting ions and osmotically driving the water flow in the adult pancreas and in the salivary gland.  #@NEW_LINE#@#  The main pancreatic water channel, aquaporin 1, is also strongly up-regulated between E10.5 and E12.5, as well as the secretin receptor, which activates ductal secretion in adult.  #@NEW_LINE#@#  To test whether the secretory machinery is active, we stimulated CFTR channels using forskolin on E12.5 pancreatic explants (Fig 6A).  #@NEW_LINE#@#  This led to a dilation of ductal/acinar lumen.  #@NEW_LINE#@#  We also observed a dilation on spheres produced from E12.5 progenitors (Fig 6B).  #@NEW_LINE#@#  These spheres are mostly formed of ductal cells.  #@NEW_LINE#@#  These experiments reveal that the pancreatic cells secrete fluid as early as E12.5 and clarify the molecular machinery used.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
Here, we show that mapping the pancreatic network unveils previously unknown features of pancreatic development.  #@NEW_LINE#@#  This work on a specific organ is likely to be relevant to other glands that also exhibit connecting microlumen, such as the salivary gland and more generally glands that secrete fluid.  #@NEW_LINE#@#  The organ-forming rules we propose here are different from the more deterministic lung branching program or the random walk proposed in the mammary gland [5,37].  #@NEW_LINE#@#  We reveal that although the pancreatic branches are not stereotypic at different orders in the network and between individual mice, the pancreatic network has stereotypic properties at different developmental stages between E12.5 and E18.5.  #@NEW_LINE#@#  We show that the transition of the pancreatic ductal network from an interlinked mesh to a treelike structure is reflected in changing network properties.  #@NEW_LINE#@#  Furthermore, we uncover that this transition optimizes the distance from the acinar ends to the duodenum while reducing redundancy in the ductal network.  #@NEW_LINE#@#  The development of the pancreatic tubular network can be described by redundant lumen connection followed by flux-based pruning.  #@NEW_LINE#@#  Redundant lumen connection is simulated with a simple growth model in which new lumen appear close to the established pancreas network and immediately connect to the nearest lumen of the network.  #@NEW_LINE#@#  The model recapitulates the network traits of the E12.5 pancreas, but the molecular mechanisms that drive network connectionthat is, the alignment of cells with coordinated apicobasal polarity in continuous tubesare currently unknown.  #@NEW_LINE#@#  The network creation model predicts that if new microlumen connect to every node ( = ) when they appear, then the network should form a single large lumen.  #@NEW_LINE#@#  This is possibly what happens in Pdx1 / mouse strains [38].  #@NEW_LINE#@#  In this strain, the network has a single lumen at E11.5.  #@NEW_LINE#@#  At later developmental stages, microlumen do appear and connect to this monolumen, expanding it to a single large lumen [38].  #@NEW_LINE#@#  
Even a small reduction of the average connectivity  has a profound effect on the in silico network, in particular a loss of polygonal features, a decrease in cost (fewer redundant links), and lower performance (longer distance between nodes).  #@NEW_LINE#@#  A reduction in  may be the phenotype that was observed in the p120 / mice [39].  #@NEW_LINE#@#  These mice have fewer ducts and larger ducts than their wild-type counterparts.  #@NEW_LINE#@#  In addition, the p120 / pancreas also contains fewer branches, suggesting a correlation between the inner ductal network and the outer branching morphology in the pancreas [39].  #@NEW_LINE#@#  
The subsequent model for flux-based pruning is a zero-parameter model that assumes that pruning of the ducts is solely based on the minimal assumption that redundant links with low flux are removed first.  #@NEW_LINE#@#  Thereby, we recapitulate the transition of an E14.5 pancreas network into a treelike network resembling the more mature E18.5 structure.  #@NEW_LINE#@#  Villasenor and colleagues qualitatively characterized the developing morphology of the pancreatic ductal network and its outer morphology [12].  #@NEW_LINE#@#  Our work expands this description by providing quantitative measures of the developing ductal network.  #@NEW_LINE#@#  With our dataset, it is possible to compare the pancreatic network to other transportation networks such as, for example, rivers [4043], infrastructure [24], and blood vessels [44].  #@NEW_LINE#@#  This comparison suggests some similarities to other networks transporting fluids.  #@NEW_LINE#@#  As seen in these networks, we observe wider ducts close to the network exit.  #@NEW_LINE#@#  Our quantitative measurements of duct diameter reveal that the drained basin, which is expected to be proportional to flow, is proportional to the cube of duct diameter in a manner similar to blood vessels.  #@NEW_LINE#@#  
Though we show that network restructuring is best modeled by the elimination of ducts with the lowest flow when alternative paths exist, it raises questions as to how the ducts are eliminated.  #@NEW_LINE#@#  Cell death is unlikely, as there is relatively little cell death during pancreas development, and they do not form patterns of aligned cells.  #@NEW_LINE#@#  It is more likely that cells are rearranged and recycled to widen or elongate contiguous ducts.  #@NEW_LINE#@#  The recent observation that Afadin and Ras homolog gene family member A (RhoA), acting upstream of microfilament dynamics, are needed for loop elimination is in agreement with this hypothesis [45].  #@NEW_LINE#@#  This raises questions as to how cells sense the lowest flow and the fact that the duct is supernumerary.  #@NEW_LINE#@#  It is unlikely that the cells measure an absolute amount of flow, as ducts with different flows are pruned in the model.  #@NEW_LINE#@#  A likely scenario is that the ducts with high flow build fluid pressure, leading to a response that widens these ducts, and that this promotes pulling forces and cell redistribution from adjacent ducts.  #@NEW_LINE#@#  For nonsupernumerary ducts, the initiation of closure would be expected to lead to pressure increase and reopening [46].  #@NEW_LINE#@#  A flow increase may be sensed by multiple systems, including multiple ion channels, adhesion and cytoskeletal proteins, cilia, caveolae, and the membrane bilayer itself [47].  #@NEW_LINE#@#  While this has been studied mainly in the blood vessels and largely in the adult, similar systems may be used in the pancreas.  #@NEW_LINE#@#  The elements of the flow that are sensed may be shear stress, circumferential stretch, or, though less likely, variations in the flow.  #@NEW_LINE#@#  
Among these sensors, only primary cilia have been shown to affect the pancreatic ductal network.  #@NEW_LINE#@#  Ductal cells have primary cilia on their apical side, while acinar cells do not [48,49].  #@NEW_LINE#@#  Bending of cilium caused by fluid movement has been shown to cause an activation of the calcium channels in kidney tubules, affecting a number of downstream targets [5052].  #@NEW_LINE#@#  Disruption of cilia affects the structure of ducts in both the kidney and the pancreas; local ductal enlargements have been reported, but the ductal network has not been studied in whole mount, and we therefore do not know whether the resolution from a plexus to a tree is affected.  #@NEW_LINE#@#  
Specific pancreatic inactivation of kinesin family member 3a (Kif3a), a molecular motor used to build the cilia during development, led to cyst formation and duct enlargement.  #@NEW_LINE#@#  However, when cilia formation was inactivated 4 weeks after birth, no phenotype was observed [53].  #@NEW_LINE#@#  This suggests that, like in the kidney, primary cilia play an important role in developing the pancreatic duct network but have a lesser role in maintaining it.  #@NEW_LINE#@#  Furthermore, when Kif3a inactivation was limited to the acinar and endocrine cells, no phenotype was observed [53].  #@NEW_LINE#@#  Therefore, only the primary cilia of the ductal cells play an important role in pancreas tubulogenesis during development.  #@NEW_LINE#@#  In a similar manner, inactivation of Tg737/Polaris [54], a protein that promotes cilia assembly, leads to cyst formation.  #@NEW_LINE#@#  Several other mutants affect cilia and lead to cystic ducts, including hepatocyte nuclear factor 6 (HNF-6) / mice [55], specific pancreatic inactivation of hepatocyte nuclear factor 1 beta (HNF1B) [27], as well as bicaudal C homolog 1 (BICC1) inactivation mutants [56].  #@NEW_LINE#@#  In all these mutants, the defects reported are ductal enlargements, and it would be important to know whether other ductal parameters studied here are affected.  #@NEW_LINE#@#  
The model also predicts that fluid must run though the pancreas from E14.5 or even earlier in order to prune correctly.  #@NEW_LINE#@#  Secretion in the adult pancreas originates from ductal and acinar cells.  #@NEW_LINE#@#  We show that the main drivers of ductal secretionTMEM16, CFTR, and aquaporin 1are already expressed by E12.5, and duct enlargement upon forskolin exposure suggests ductal secretion.  #@NEW_LINE#@#  Since spheres are primarily made of bipotent progenitors [33], we surmise that they produce a large part of the fluid.  #@NEW_LINE#@#  At E12.5, there are no acinar cells in the pancreas yet, but acinar cells may contribute after they differentiate.  #@NEW_LINE#@#  CFTR is expressed at relatively low levels in the ducts at these stages, and its importance in secretion in mice is less important than in human.  #@NEW_LINE#@#  It has been proposed that this is due to functional overlap with calcium-activated chloride channels (TMEM16A/ANO1) in mice [57,58].  #@NEW_LINE#@#  In human and pigs, CFTR mutations are already symptomatic in the fetal pancreas as early as 19 weeks of pregnancy.  #@NEW_LINE#@#  Ductal obstruction and enlargement have been reported antenatally in these models, providing a natural circumstance [59] [60] suggesting that secretion starts before birth as well [61].  #@NEW_LINE#@#  We did not observe dilation in explant nor spheres with secretin, cholecystokinin (CCK), or carbachol, which respectively activate secretion in adult ducts, acini, and both, even though their receptors are expressed during pregnancy.  #@NEW_LINE#@#  [17,56].  #@NEW_LINE#@#  An interesting mutant lends support to the hypothesis that secretion test runs lead to network remodeling.  #@NEW_LINE#@#  Indeed, the pancreas-specific inactivation of the transcription factor nuclear receptor subfamily 5 group A member 2 (NR5A2) prevents the formation of acinar cells and intercalated ducts [62].  #@NEW_LINE#@#  In this mutant, the ductal network remains hyperconnected at birth, suggesting that acinar or terminal ducts control network pruning, possibly via their secretion.  #@NEW_LINE#@#  
Our study suggests more elaborate tests of our flux pruning scenario.  #@NEW_LINE#@#  The first is to obstruct the pancreas exit into the duodenum during normal development, a difficult experiment in vivo in embryos and for which no spontaneous incidence has been reported.  #@NEW_LINE#@#  In the same spirit, organoids, which do not have an outlet, do not exhibit network optimization.  #@NEW_LINE#@#  We experimentally tried to use capillaries to create an artificial outlet, but inserting them in ducts and preventing clogging prevented success.  #@NEW_LINE#@#  The organoid experiment shows that the formation of the ductal meshwork occurs independently of the formation of a blood vessel network, though eventually, blood vessels are enriched along the pancreatic epithelial branches of the tree, and cross-talk is known to exist between the two tissues [6365].  #@NEW_LINE#@#  
Our work provides new methods and a new framework to evaluate the formation of ductal networks in organs and sets the stage to evaluate structural defects in mutants to decipher the cellular events underlying network remodeling.  #@NEW_LINE#@#  Moreover, it paves the way to analyzing similarities and differences in the secretory network of other glands.  #@NEW_LINE#@#  

Materials_and_methods  #@NEW_LINE#@#  
Ethics_statement  #@NEW_LINE#@#  
The Danish Veterinary Office approved the animal experiments performed under license number 2014-15-2934-01008.  #@NEW_LINE#@#  

Explant__organoid__and_sphere_culture  #@NEW_LINE#@#  
Timed-pregnant ICR mice were killed at E10.5 (for organoids and spheres) or E12.5 (for spheres), and the cells of embryonic pancreases were recovered, dispersed, and seeded in Matrigel as described previously [33,34,66].  #@NEW_LINE#@#  Organoids were cultured for 7 days and spheres for 4 days prior to imaging.  #@NEW_LINE#@#  For explants, E12.5 pancreases were cultured overnight on fibronectin-coated glass-bottom plates, as described previously, prior to live image acquisition [67].  #@NEW_LINE#@#  

Immunohistochemistry  #@NEW_LINE#@#  
Whole-mount immunostaining was performed for pancreata harvested at E12.5, E14.5 (dorsal pancreata only), and E18.5 and organoids harvested at day 7 in vitro as previously described [26].  #@NEW_LINE#@#  Samples were fixed with 4% paraformaldehyde at 4°C and then washed in phosphate-buffered saline (PBS).  #@NEW_LINE#@#  Samples were dehydrated stepwise in 33%, 66%, and 100% methanol for 15 minutes at each step and stored at 20°C until later use.  #@NEW_LINE#@#  For autofluorescence quenching, they were incubated with freshly prepared Methanol:DMSO:H2O2 (2:1:3, 15% H2O2) at room temperature (RT) for 1224 hours.  #@NEW_LINE#@#  Samples were washed twice in 100% methanol for 30 minutes at RT and brought to 80°C 35 times for at least 1 hour each time and back to RT to make antigens in the deeper parts accessible.  #@NEW_LINE#@#  Samples were rehydrated stepwise in Methanol/TBST (50 mM Tris-Hcl pH 7.4, 150 mM NaCl, 0.1% TritonX-100) 33%, 66%, and 100% for 15 minutes at each step at RT.  #@NEW_LINE#@#  After blocking overnight at 4°C in CASBLOC blocking solution, samples were incubated with primary antibodies (Ecadherin [1/200] # 610181, BD transduction laboratories and Mucin1 [1/200] #HM-1630-P0, Thermo Fisher) diluted in CAS-Block Histochemical Reagent, # 8120, Thermo Fisher for 2448 hours.  #@NEW_LINE#@#  Then, samples were washed overnight in TBST and incubated with secondary (goat anti-A.  #@NEW_LINE#@#  hamster biotinylated [1/1,000], Invitrogen) and tertiary antibodies (donkey anti-mouse Alexa 488 [1/200] and strepatividin Alexa 647 [1/800] Invitrogen) and for 2448 hours followed by overnight washing in TBST.  #@NEW_LINE#@#  Stained samples were dehydrated stepwise in Methanol as previously described and cleared in a solution of 1:2 Benzyle Alcohol and Benzyle Benzoate (BABB) for 1224 hours prior to imaging.  #@NEW_LINE#@#  

Image_acquisition_and_reconstruction  #@NEW_LINE#@#  
Cleared samples were subsequently mounted in glass concavity slides and submerged completely in BABB to maintain refractive index matching and sample transparency.  #@NEW_LINE#@#  Cleared samples were imaged using a Leica SP8 confocal microscope with a 20X/0.75 oil immersion (most samples) or a 10× air (E18.5) objective at 1024 × 1024 resolution.  #@NEW_LINE#@#  Samples were imaged in an 8-bit format unless otherwise indicated.  #@NEW_LINE#@#  Images were stitched and reconstructed into 3D images using the Imaris software (Bitplane).  #@NEW_LINE#@#  
For live imaging of explants and spheres, we used a Zeiss LSM780 confocal microscope with a 10× air objective.  #@NEW_LINE#@#  Calcein 10 M was used as background stain and incubated for 3060 minutes and rinsed before imaging.  #@NEW_LINE#@#  Independent samples were imaged at least in triplicate for 40 minutes, 1 image every 2 minutes, after addition of the drug tested.  #@NEW_LINE#@#  We tested 10 M Forskolin, 1 M Ionomycin, 10 nM secretin + 10 M Carbachol.  #@NEW_LINE#@#  

Image_analysis_and_quantification  #@NEW_LINE#@#  
The inner diameter was automatically segmented and measured for each sphere at each time point using Lumen Thickness Detector script (https://github.com/gopalrk/Lumen_Detector_and_Quantification).  #@NEW_LINE#@#  The value of the inner diameter at t was first normalized to t0 and then normalized to control over time (n = 2 independent experiments; the total number of analyzed spheres is 68 for forskolin treatment and 59 for control).  #@NEW_LINE#@#  Statistically different diameter between t0 and t15 in forskolin condition and between t15 forskolin versus control; MannWhitney U test, p less_than 0.001.  #@NEW_LINE#@#  

Statistical_methods  #@NEW_LINE#@#  
Every mean and standard error of mean (SEM) shown in the paper is based on the data shown in Fig 2.  #@NEW_LINE#@#  All statistical tests in the paper are 2-sample, 2-tailed t tests and thus assume the data have a Gaussian distribution, which we cannot test.  #@NEW_LINE#@#  The annotation for p-values are as follows: *p less_than 0.05, **p less_than 0.01, ***p less_than 0.0001.  #@NEW_LINE#@#  

Transcriptome_analysis  #@NEW_LINE#@#  
Pancreata were isolated at E10.5, E12.5, or E14.5 and lysed with lysis buffer RLT, and RNA was purified following the manufacturer instructions (RNeasy Plus Micro Kit, #74034, Qiagen).  #@NEW_LINE#@#  RNA quality was assessed using an Agilent 2100 Bioanalyzer, following the manufacturer instructions (Agilent RNA 6000 Pico Kit # 50671513).  #@NEW_LINE#@#  Extracted RNA (700 pg) was amplified using Ovation Pico SL WTA system V2 (# 331248, Nugen).  #@NEW_LINE#@#  Samples were labeled with SureTag DNA labeling kit (#51903391, Agilent Technologies), run on SurePrint G3 Mouse Gene Exp v2 Array (# G4852B, Agilent Technologies), and read by a SureScan Microarray Scanner (Agilent Technologies).  #@NEW_LINE#@#  

Calculation_of_network_properties  #@NEW_LINE#@#  
In the section below, we describe the calculus needed to derive the network properties shown in Fig 2, S3 Fig, and S5 Fig  #@NEW_LINE#@#  
A network of N nodes and E links (edges) can be represented by its N × N adjacency matrix A  #@NEW_LINE#@#  

For an undirected network, A(i,j) = A(j,i).  #@NEW_LINE#@#  Nodes in the networks do not connect to themselves, A(i,i) = 0, and so the trace of A is always zero .  #@NEW_LINE#@#  
A modified adjacency matrix can be constructed, called the weighted adjacency matrix Aw:  #@NEW_LINE#@#  

where d is the euclidian distance between node i and node j.  #@NEW_LINE#@#  The total length of the network lT is defined as the sum of all weighted links:  #@NEW_LINE#@#  

The cost of the network is the total length of all the links in the network compared to the same value of the euclidian MST composed of the same nodes [24].  #@NEW_LINE#@#  
The performance of the network is the average shortest path between every node compare to the same value of the MST:  #@NEW_LINE#@#  

where l(i,j) is the shortest path between node i and j through the network [24].  #@NEW_LINE#@#  
The mean distance to the root node is the mean of the shortest paths from node i to the root node.  #@NEW_LINE#@#  
The mean distance between every node is calculated in much the same way.  #@NEW_LINE#@#  
For finding polygons in the network, we follow the calculation of Alon [21].  #@NEW_LINE#@#  In the following, A is the adjacency matrix, D is the degree matrix for the network, and |E| is the amount of edges in the network.  #@NEW_LINE#@#  nG(C3),nG(C4), and nG(C5) are the number of triangles, squares, and pentagons in the network, respectively.  #@NEW_LINE#@#  The following calculations assume an undirected network.  #@NEW_LINE#@#  
Here, D(i,i) is the degree of node i, and tr () is the trace of the matrix.  #@NEW_LINE#@#  The code calculating all the above network properties has been written in MATLAB 2014a and is in the supporting information as NetworkProp.m.  #@NEW_LINE#@#  

Adaptation_of_duct_diameter_to_flux_(S11_Fig)  #@NEW_LINE#@#  
The expected adaptation of duct diameter in response to flux of pancreatic fluid is inspired by previous work in blood vessels [31], satisfying the following equation:  #@NEW_LINE#@#  

where d is the duct diameter at time t, K is an adaption constant, and  is the shear stress experienced by the duct as a result of the fluid flow.  #@NEW_LINE#@#  In our setup, we consider the system only at steady state, and so  #@NEW_LINE#@#  

which means that at steady state, every duct has adapted to have the desired shear stress, whichever that value might be.  #@NEW_LINE#@#  Shear stress relates to flux and duct diameter though Poiseuilles equation (assuming a likely laminar flow and a noncompressible fluid)  #@NEW_LINE#@#  

where  represents fluid viscosity and Q the flux of fluid running through the duct.  #@NEW_LINE#@#  Assuming that every part of the duct adapts to have the same shear stress (and by that extension pressure), as they are made of the same material, this shows that every duct at steady state will have a diameter that is proportional to the cubic root of the flux.  #@NEW_LINE#@#  
It should be noted that Hacking and colleagues [31] show that given two ducts connected in parallel with a constant flow source, one duct is bound to disappear, while the other will attain the ideal diameter for the flow.  #@NEW_LINE#@#  This theoretical result explains that redundant ducts can be eliminated in the pancreas, as it will have a constant flow source at steady state.  #@NEW_LINE#@#  
Experimentally, the duct diameter was measured using Imaris at 27 random nonredundant ducts distributed over the network of an E18.5 pancreas (S11A Fig).  #@NEW_LINE#@#  The code has been written in MATLAB 2017 and is in the supporting information as DuctDiameter.m, DuctThickness.m, and DuctThicknessAnalysis,m.  #@NEW_LINE#@#  The analysis shows that the cubic root is a reasonable approximation to the relation between flux, represented as nodes upstream and duct length upstream, and the corresponding duct thickness (S11B and S11C Fig).  #@NEW_LINE#@#  

Network_diffusion  #@NEW_LINE#@#  
The network diffusion model works in the following steps:  #@NEW_LINE#@#  
The code applying diffusion to the network has been written in MATLAB 2014a and is in the supporting information as DiffusionOnNetwork.m.  #@NEW_LINE#@#  
Given concentration  at node i, which is allowed to freely diffuse,  obeys the heat equation  #@NEW_LINE#@#  

where 2 is the laplacian, and C is the diffusion coefficient.  #@NEW_LINE#@#  
On a network, both  and 2 are discretized, and diffusion is constrained to the network links.  #@NEW_LINE#@#  The heat equation can then be rewritten  #@NEW_LINE#@#  

where L(i,j) = L is the network Laplacian, and (i) is the concentration at node i.  #@NEW_LINE#@#  
The network laplacian for node i can be defined by the node degree d and the neighbors of node i.  #@NEW_LINE#@#  
An example of a network diffusion matrix is presented in S9B Fig In order to solve diffusion numerically, the forward Euler scheme of network diffusion can be used, giving the diffusion scheme  #@NEW_LINE#@#  


Network_creation_model  #@NEW_LINE#@#  
The network creation model works in the following steps:  #@NEW_LINE#@#  
The code constructing the random network has been written in MATLAB 2014a and is in the supporting information as NetworkCreation.m, as well as the code to initiate the system from an L-system setup instead of two nodes, RandLsystem.m.  #@NEW_LINE#@#  

Network_pruning  #@NEW_LINE#@#  
The network pruning model works in the following steps:  #@NEW_LINE#@#  
The code applying network pruning to the network has been written in MATLAB 2014a and is in the supporting information as PruneBasedOnFlux.m.  #@NEW_LINE#@#  
A file named ExampleScript.m demonstrates how all the above scripts work in concert.  #@NEW_LINE#@#  


Supporting_information  #@NEW_LINE#@#  
S1_Fig_Method_for_digitizing_the_pancreas_network  #@NEW_LINE#@#  
(A) The network is digitized by mapping the terminal end and intersections of the network and connecting them through the ductal structure.  #@NEW_LINE#@#  All the digitized networks are based on 3D segmentation, and the resulting networks are also 3D in the spatial sense.  #@NEW_LINE#@#  (B) An example of the technique applied on a sample network is shown in 2D for clarity.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002842.s001  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S2_Fig_Determining_the_dimension_of_the_pancreas_networks  #@NEW_LINE#@#  
Step-by-step instructions on how to obtain the dimension of a given network.  #@NEW_LINE#@#  (A) The cumulative histogram of the 10th node of the ventral pancreas E14.5 1 network.  #@NEW_LINE#@#  The marked area indicates the data used for further analysis of network dimension.  #@NEW_LINE#@#  (B) The selected data in a log-log plot.  #@NEW_LINE#@#  The slope of the fitted curve is the dimension of the network from the perspective of the given node.  #@NEW_LINE#@#  The code file DimFit is provided in S1 Data.  #@NEW_LINE#@#  E, embryonic day.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002842.s002  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S3_Fig_Mapping_the_whole_ventral_pancreas_E185_causes_a_slight_shift_in_network_properties  #@NEW_LINE#@#  
(A) Part of the E18.5 1 pancreas with network properties that appear in Fig 2.  #@NEW_LINE#@#  (B) The fully mapped E18.5 1 ventral pancreas.  #@NEW_LINE#@#  The network only experiences a slight shift in most properties when fully mapped, with the exception of network performance.  #@NEW_LINE#@#  Digitized data and code files Import_Experimental_data, ConvertToAdjMat, ConvertToAdjList, NetworkProp, NetworkShapes, FindTriangles, PlotNetwork,Remove_kinks are provided in S1 Data.  #@NEW_LINE#@#  E, embryonic day.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002842.s003  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S4_Fig_Location_of_triangles_in_the_E145_networks  #@NEW_LINE#@#  
The triangles are highlighted in red, while the root node is highlighted in green in the networks for (A) E14.5 1, (B) E14.5 2, and (C) E14.5 3.  #@NEW_LINE#@#  (D) Histogram showing the triangles distance to the root node for the three networks.  #@NEW_LINE#@#  Digitized data and code files Import_Experimental_data, ConvertToAdjMat, ConvertToAdjList, FindTriangles, and PlotNetwork,Remove_kinks are provided in S1 Data.  #@NEW_LINE#@#  E, embryonic day.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002842.s004  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S5_Fig_Random_networks_based_on_the_in_vivo_and_in_vitro_networks  #@NEW_LINE#@#  
less_than  greater than  denotes the average of a value for every node in the network.  #@NEW_LINE#@#  C is the clustering coefficient for a given node.  #@NEW_LINE#@#  k is node degree.  #@NEW_LINE#@#  Droot is a node's distance to the root node through the network.  #@NEW_LINE#@#  Ltot is the total amount of link length in the entire network.  #@NEW_LINE#@#  Errors represent SEM, with n = 100.  #@NEW_LINE#@#  Digitized data and code files Import_Experimental_data, FindTriangles, NetworkProp, NetworkShapes, and sym_generate_srand_conncomp_Mod are provided in S1 Data.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002842.s005  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S6_Fig_Parameter_space_for_the_network_creation_model  #@NEW_LINE#@#  
less_than  greater than  denotes the average value for every node in the network.  #@NEW_LINE#@#  k is node degree.  #@NEW_LINE#@#  Errors represent SEM, with n = 100.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002842.s006  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S7_Fig_Parameter_space_of_the_network_creation_model  #@NEW_LINE#@#  
(A) p-values from t test comparisons between the created in silico network and the in vivo E12.5 networks.  #@NEW_LINE#@#  Dark red indicates the parameter space in which the in silico model is significantly different from the ventral pancreas E12.5 network.  #@NEW_LINE#@#  (B) The above pass/fail data combined into one plot.  #@NEW_LINE#@#  Pass/fail is determined by t test with p = 0.05 significance and Bonferroni corrections for multiple hypothesis testing.  #@NEW_LINE#@#  E, embryonic day  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002842.s007  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S8_Fig_Effect_of_an_initial_L-system_on_in_silico_generated_networks  #@NEW_LINE#@#  
Distribution of polygonal features for networks generated as described in the supporting information but with a varying number of initial nodes connected in a spatially random L-system.  #@NEW_LINE#@#  The fully random results correspond to the in silico results in Fig 3C.  #@NEW_LINE#@#  The generated networks all consist of approximately 320 nodes.  #@NEW_LINE#@#  Error bars represent SEM, n = 10,000.  #@NEW_LINE#@#  The code files RandLSystem, ConvertToAdjMat, ConvertToAdjList, NetworkProp, NetworkShapes, FindTriangles, Remove_kinks are provided in S1 Data.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002842.s008  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S9_Fig_Description_of_diffusion-based_pruning  #@NEW_LINE#@#  
(A) Step-by-step instructions on how to prune a given network for both the flux-based and random pruning.  #@NEW_LINE#@#  (B) Example of diffusion matrix and associated network.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002842.s009  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S10_Fig_Flux-based_pruning_of_the_ventral_pancreas_E145_1_and_E145_3  #@NEW_LINE#@#  
(A) The logarithm of the normalized flux at steady state of the pancreas networks.  #@NEW_LINE#@#  Thicker links indicate a higher flux.  #@NEW_LINE#@#  The highest flux is closest to the exit, with some interlinking nodes having very low flux.  #@NEW_LINE#@#  The links highlighted red are pruned by the pruning mechanism of least flux.  #@NEW_LINE#@#  (B) The pruning events distance from the exit as pruning progresses for flux-based pruning and random pruning.  #@NEW_LINE#@#  Digitized data and code files Import_Experimental_data, DiffusionOnNetwork, PruneBasedOnFlux, SnapShot, ConvertToAdjMat, ConvertToAdjList, NetworkProp, NetworkShapes, FindTriangles, Remove_kinks are provided in S1 Data.  #@NEW_LINE#@#  E, embryonic day.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002842.s010  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S11_Fig_Measurements_of_duct_thickness_on_in_vivo_E185_pancreas  #@NEW_LINE#@#  
Duct diameter of selected ducts of an E18.5 network.  #@NEW_LINE#@#  (A) The network visualized along with the measured ducts highlighted in green.  #@NEW_LINE#@#  (B) Duct diameter as a function of nodes upstream of the given duct.  #@NEW_LINE#@#  (C) Duct diameter as a function of total duct length upstream.  #@NEW_LINE#@#  Digitized data and code files Import_Experimental_data, PlotNetwork, DuctDiameter, and DuctThicknessAnalysis are provided in S1 Data.  #@NEW_LINE#@#  E, embryonic day.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002842.s011  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S12_Fig_Expression_of_transcripts_encoding_proteins_involved_in_pancreatic_secretion  #@NEW_LINE#@#  
The families of proteins are color-encoded on the right side.  #@NEW_LINE#@#  The expression is reported in the pancreas at E10.5, E12.5, and E14.5.  #@NEW_LINE#@#  The rows highlighted in gray correspond to family members with reported function in adult pancreas secretion.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002842.s012  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S1_Data_Supporting_information  #@NEW_LINE#@#  
Data and code used to make plots in all figures.  #@NEW_LINE#@#  Data are provided as two excel files for every sample: one reporting node ID and position in space and one reporting node connectivity and distances.  #@NEW_LINE#@#  These excel files were templates used in the code files to generate figures, as indicated in figure legends.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002842.s013  #@NEW_LINE#@#  
(7Z)  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
We would like to thank the Semb lab and StemPhys project members for inputs as well as Jutta Bulkescher for advice and support with imaging.  #@NEW_LINE#@#  

References  #@NEW_LINE#@#  



