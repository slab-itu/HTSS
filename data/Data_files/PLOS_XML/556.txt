article id="http://dx.doi.org/10.1371/journal.pone.0152421"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Modeling Magnetomyograms of Uterine Contractions during Pregnancy Using a Multiscale Forward Electromagnetic Approach  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Understanding the mechanisms of uterine contractions during pregnancy is especially important in predicting the onset of labor and thus in forecasting preterm deliveries.  #@NEW_LINE#@#  Preterm birth can cause serious health problems in newborns, as well as large financial burdens to society.  #@NEW_LINE#@#  Various techniques such as electromyography (EMG) and magnetomyography (MMG) have been developed to quantify uterine contractions.  #@NEW_LINE#@#  However, no widely accepted method to predict labor based on electromagnetic measurement is available.  #@NEW_LINE#@#  Therefore, developing a biophysical model of EMG and MMG could help better understand uterine contractions, interpret real measurements, and detect labor.  #@NEW_LINE#@#  In this work, we propose a multiscale realistic model of uterine contractions during pregnancy.  #@NEW_LINE#@#  At the cellular level, building on bifurcation theory, we apply generalized FitzHugh-Nagumo (FHN) equations that produces both plateau-type and bursting-type action potentials.  #@NEW_LINE#@#  At the tissue level, we introduce a random fiber orientation model applicable to an arbitrary uterine shape.  #@NEW_LINE#@#  We also develop an analytical expression for the propagation speed of transmembrane potential.  #@NEW_LINE#@#  At the organ level, a realistic volume conductor geometry model is provided based on magnetic resonance images of a pregnant woman.  #@NEW_LINE#@#  To simulate the measurements from the SQUID Array for Reproductive Assessment (SARA) device, we propose a sensor array model.  #@NEW_LINE#@#  Our model is able to reproduce the characteristics of action potentials.  #@NEW_LINE#@#  Additionally, we investigate the sensitivity of MMG to model configuration aspects such as volume geometry, fiber orientation, and pacemaker location.  #@NEW_LINE#@#  Our numerical results show that fiber orientation and pacemaker location are the key aspects that greatly affect the MMG as measured by the SARA device.  #@NEW_LINE#@#  We conclude that sphere is appropriate as an approximation of the volume geometry.  #@NEW_LINE#@#  The initial step towards validating the model against real MMG measurement is also presented.  #@NEW_LINE#@#  Our results show that the model is flexible to mimic the limited-propagation magnetic signature during the emergence and decay of a uterine contraction.  #@NEW_LINE#@#  

Citation: Zhang M, Tidwell V, La Rosa PS, Wilson JD, Eswaran H, Nehorai A (2016) Modeling Magnetomyograms of Uterine Contractions during Pregnancy Using a Multiscale Forward Electromagnetic Approach.  #@NEW_LINE#@#  PLoS ONE 11(3):  #@NEW_LINE#@#  
           e0152421.  #@NEW_LINE#@#  

        https://doi.org/10.1371/journal.pone.0152421  #@NEW_LINE#@#  
Editor: Roger C. Young,  #@NEW_LINE#@#  
PreTel Inc, UNITED STATES  #@NEW_LINE#@#  

Received: November 3, 2015; Accepted: March 14, 2016; Published:  March 28, 2016  #@NEW_LINE#@#  
Copyright:  © 2016 Zhang et al.  #@NEW_LINE#@#  This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.  #@NEW_LINE#@#  
Data Availability: Data are available from the UAMS Institutional Data Access/Ethics Committee for researchers who meet the criteria for access to confidential data.  #@NEW_LINE#@#  The restrictions will include information pertaining to patients personal information and records.  #@NEW_LINE#@#  Requests can be made to the co-author Hari Eswaran by email: eswaranhari@uams.edu.  #@NEW_LINE#@#  
Funding: This study was funded by National Institute of Biomedical Imaging and Bioengineering grant R01EB016567.  #@NEW_LINE#@#  This funding organization provided financial support in the form of authors salaries (MZ, VT, JDW, HE, AN) and research materials, but did not play a role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  The author (PSL) in Monsanto Company is also a member in the joint undergraduate Engineering program between University of Missouri and Washington University in St. Louis.  #@NEW_LINE#@#  The Monsanto Company did not play a role in the financial support, study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  The specific roles of the authors are articulated in the author contributions section of the online submission form.  #@NEW_LINE#@#  
Competing interests:  The authors do not have any competing interests in employment, consultancy, patents, products in development, or marketed products, etc.  #@NEW_LINE#@#  The commercial affiliation does not alter the authors adherence to PLOS ONE policies on sharing data and materials.  #@NEW_LINE#@#  
Introduction  #@NEW_LINE#@#  
The clinical importance of modeling contractions of pregnant uterus lies in better understanding the mechanisms of normal and preterm births.  #@NEW_LINE#@#  Preterm birth, which occurs before 37 weeks of gestation, has potential to result in serious health problems to preterm infants.  #@NEW_LINE#@#  The earlier infants are born, the greater their risk of morbidity and mortality.  #@NEW_LINE#@#  In addition to health problems, preterm birth causes huge financial costs to families and society [1].  #@NEW_LINE#@#  As a result, it is urgent to understand the mechanisms under which uterine contractions lead to preterm birth.  #@NEW_LINE#@#  
The uterus provides a safe environment for developing fetus, which is later expelled through intense contractions.  #@NEW_LINE#@#  These contractions are primarily regulated by the uterine electrical activities [2, 3].  #@NEW_LINE#@#  Previous models [4, 5] rarely consider the physiological properties of myometrium.  #@NEW_LINE#@#  A computer model consisting of discrete contractile elements that propagate electrical impulses and generate tension is proposed in [4].  #@NEW_LINE#@#  The authors predict contraction waveforms by defining contracting and refractory periods.  #@NEW_LINE#@#  In [5], the authors demonstrate that two mechanisms, action potential propagation and calcium wave propagation, contribute to intercellular communication.  #@NEW_LINE#@#  
The models presented in [611] take into account the physiological aspect of uterine contractions.  #@NEW_LINE#@#  A simple electrophysiological model of smooth muscle cell is developed in [6].  #@NEW_LINE#@#  The limitation of this model is that it only includes sodium and potassium currents, but not the involved physiological ionic currents.  #@NEW_LINE#@#  In [7], the authors propose a model that considers the electrical and mechanical properties of smooth muscle cells; however the model disregards the time dependency of calcium current.  #@NEW_LINE#@#  A model is developed to study the process of myometrial excitation and contraction in [8].  #@NEW_LINE#@#  This model describes L-type Ca2+ current, Ca2+ pumps, and Na+/Ca2+ exchangers without including the time-dependency dynamics.  #@NEW_LINE#@#  In [9], the authors construct a model in terms of voltage-dependent Na+ currents, voltage-dependent Ca2+ currents, voltage and calcium-dependent K+ currents, a leakage current, and dynamics of intracellular calcium concentration.  #@NEW_LINE#@#  In [10], the authors provide a more detailed smooth muscle cell model, which has 13 ionic currents and calcium dynamics, to reproduce different types of action potentials.  #@NEW_LINE#@#  In [11], KCNQ and hERG channel currents are added into the uterine cell model which is developed in [10], enabling the simulations of long-lasting bursting-type action potentials.  #@NEW_LINE#@#  
Recently, the models focus on characterizing the electrophysiological property of uterine contractions jointly at the cellular, tissue, and organ levels.  #@NEW_LINE#@#  A 2D multiscale model for uterine electrical activity is presented in [12, 13].  #@NEW_LINE#@#  This model considers K+ current and the dynamics of Ca2+ in the cell scale, applies a 2D isotropic grid of square cells in the tissue scale, and simulates the surface electrohysterogram in the organ scale.  #@NEW_LINE#@#  In our previous work [14], a multiscale electromagnetic model of uterine contractions is developed.  #@NEW_LINE#@#  This model is the first to apply 3D multiscale approach to uterine modeling.  #@NEW_LINE#@#  However, it regards the uterus as a sphere with fixed-angle conductivity tensor, which is an oversimplified version of the real geometry.  #@NEW_LINE#@#  
In this work, we develop a more realistic multiscale forward model of uterine contractions during pregnancy based on the simplified model in [14].  #@NEW_LINE#@#  We first introduce an ionic current model capable of generating both plateau-type and bursting-type action potentials in each myocyte.  #@NEW_LINE#@#  Specifically, using bifurcation analysis, we develop a generalization of the FitzHugh-Nagumo (FHN) equations capable of generating both types of action potentials.  #@NEW_LINE#@#  Second, we introduce a random fiber orientation model applicable to an arbitrary uterine shape.  #@NEW_LINE#@#  An analytical expression for the speed of propagation is also developed.  #@NEW_LINE#@#  Third, instead of a spherical model, we introduce a realistic model for the volume conductor geometry based on magnetic resonance images (MRI) of a pregnant woman.  #@NEW_LINE#@#  We also propose a sensor array model matching the SARA device to simulate the real recordings [1517].  #@NEW_LINE#@#  The numerical results illustrate the main characteristics of both types of action potentials.  #@NEW_LINE#@#  We also demonstrate that the pattern of magnetic field depends greatly on the fiber orientation and pacemaker location, rather than the volume geometry.  #@NEW_LINE#@#  The spherical volume geometry is therefore a good approximation of uterine geometry to investigate the MMG measurements of the SARA device.  #@NEW_LINE#@#  We also validate that our modeling approach is flexible to mimic the limited-propagation magnetic field pattern of real patient data during the emergence and decay of contraction.  #@NEW_LINE#@#  
Our aim is to better understand the uterine structure and propagation of contractions from electrophysiological point of view and to determine which aspects of model configuration have a major influence on the pattern of abdomen-surface magnetic field as measured by the SARA device.  #@NEW_LINE#@#  By creating a variety of model configuration aspects, e.g., by spatially varying the fiber layout or conductivity properties of the myometrium, and then simulating the magnetic field on abdominal surface for each configuration, we wish to determine the extent to which each aspect of the configuration has influence on the pattern of magnetomyograms.  #@NEW_LINE#@#  Creating a realistic multiscale forward model of uterine contractions will allow us to better interpret the data of MMG measurements and, therefore, shed light on the prediction of preterm labor.  #@NEW_LINE#@#  

Methods  #@NEW_LINE#@#  
Below, we first review our preliminary work and then elaborate on our improvement to the approach.  #@NEW_LINE#@#  
Preliminary_work  #@NEW_LINE#@#  
In the following section, we summarize our preliminary work.  #@NEW_LINE#@#  In our recent paper [14], we proposed a multiscale forward electromagnetic model of human myometrial contractions during pregnancy, of which the details are listed in Table 1.  #@NEW_LINE#@#  
Our modeling approach was to solve the forward electromagnetic problem of uterine contractions using a four-compartment volume conductor geometry, namely, we computed at the abdominal surface the magnetic field, B(r, t) Eq (1), and the electrical potential, (r, t) Eqs (2)(4), generated by the myometrial current source density, Js(r, t) Eq (5).  #@NEW_LINE#@#  According to Ohms law, the current source density Js(r, t) was defined as the gradient of transmembrane potential, vm(r, t) Eq (6).  #@NEW_LINE#@#  The transmembrane potential vm(r, t), using reaction diffusion equations, was modeled as a function of ionic current dynamics, Jion(r, t), stimulus current due to pacemakers, Jstim(r, t) Eq (7), anisotropic conductivity,  and , and the corresponding boundary conditions Eqs (8)(15).  #@NEW_LINE#@#  As illustrated in [14], in the volume conductor geometry model,  represents the abdominal cavity and  the boundary surface defined by the abdomen.  #@NEW_LINE#@#  represents the myometrium, and  and  are its external and internal boundary surfaces, respectively.  #@NEW_LINE#@#  The volume denoted by  represents the space filled with the amniotic fluid that exists between the internal uterine wall  and the boundary  defined by the fetus volume .  #@NEW_LINE#@#  Focusing on plateau-type action potential, we applied the modified version of FitzHugh-Nagumo (FHN) equations [18, 19] to model the ionic currents, Jion(r, t), in each myocyte.  #@NEW_LINE#@#  We also proposed a general approach to design conductivity tensors,  and , simply assuming that the main axis of the fibers runs vertically from the fundus to the cervix for any uterine shape.  #@NEW_LINE#@#  To model the volume conductor geometry, we defined a spherical uterus and also a spherical abdomen as a simplification of the real anatomical structure.  #@NEW_LINE#@#  
Although our preliminary work provides a novel approach to model the contractions in pregnant uterus, some aspects of the model are oversimplified when compared with the realistic case.  #@NEW_LINE#@#  In the following sections, we will explain explicitly how we develop a more realistic multiscale model taking into consideration the electrophysiological and anatomical characteristics of uterus.  #@NEW_LINE#@#  

Bursting-type_action_potential_model_based_on_bifurcation_theory  #@NEW_LINE#@#  
In this section, we present an ionic current model capable of generating plateau-type and bursting-type action potentials (Fig 1), since both of them are very common in pregnant human uterus [20, 21].  #@NEW_LINE#@#  Particularly, we apply a variation of the FHN equations [14], which is given by the following nonlinear dynamical system of ordinary differential equations:  #@NEW_LINE#@#  
(16) (17)  #@NEW_LINE#@#  
where vm is the action potential, w is a state variable,  is the stimulus current amplitude due to pacemaker activity, which is defined in Eq (7), and 1, 2, k, , , , v1, v2, and v3 are model parameters.  #@NEW_LINE#@#  
The behavior of a nonlinear dynamical system depends greatly on the values of its parameters.  #@NEW_LINE#@#  For example, for certain set of parameters, the FHN model has a stable but excitable equilibrium.  #@NEW_LINE#@#  That is, if the system undergoes a sufficiently large perturbation, there is a large excursion of variables in phase space before returning to the equilibrium, hence generating plateau-type action potential.  #@NEW_LINE#@#  There is also a range of values where the FHN model displays limit cycle characteristics; that is, the variables settle on a closed trajectory in phase space, hence spike trains occur in the system.  #@NEW_LINE#@#  
In this work, we focus on investigating the bursting-type action potential, which occurs when the FHN model displays limit cycle behavior.  #@NEW_LINE#@#  In order to identify the set of parameters that generates a limit cycle, we apply bifurcation analysis to the variation of the FHN model.  #@NEW_LINE#@#  Bifurcation analysis is a powerful tool to investigate such properties of nonlinear dynamical systems.  #@NEW_LINE#@#  It helps to identify the set of parameters with which certain behavior occurs in the systems.  #@NEW_LINE#@#  The parameter that is varied is known as bifurcation parameter.  #@NEW_LINE#@#  We assume in this work that the uterus is formed by the same type of cells.  #@NEW_LINE#@#  The pacemaker activity is initiated for a specified stimulus current but the parameters of the ionic current cell model are exactly the same throughout the uterus.  #@NEW_LINE#@#  Therefore, the only degree of freedom that we have is the stimulus amplitude, which can be varied at initiation, so it can be regarded as the bifurcation parameter.  #@NEW_LINE#@#  In other words, our claim is that the cell response changes on the basis of the pacemaker activity.  #@NEW_LINE#@#  
In bifurcation analysis, equilibrium, limit cycle, and their stabilities appear as a function of the bifurcation parameter.  #@NEW_LINE#@#  Since the right hand side of Eq (16) is a cubic polynomial of vm, it is difficult to write explicitly the equilibrium  as a function of the bifurcation parameter .  #@NEW_LINE#@#  Instead, we rewrite the stimulus amplitude  as a function of the equilibrium :  #@NEW_LINE#@#  
(18)  #@NEW_LINE#@#  
where  is the value of action potential at the equilibrium.  #@NEW_LINE#@#  Therefore, by finding the conditions in which the system has an unstable equilibrium and limit cycle, we can then derive the corresponding values for the stimulus amplitude using Eq (18).  #@NEW_LINE#@#  In this work, we are interested in the case when there is always only one equilibrium in the FHN model whatever the stimulus amplitude , for which the parameters should satisfy the following condition (see S1 Appendix):  #@NEW_LINE#@#  
(19)  #@NEW_LINE#@#  
Using bifurcation analysis (see S1 Appendix), we identify the following condition under which the FHN model has an unstable equilibrium and also a limit cycle:  #@NEW_LINE#@#  
(20)  #@NEW_LINE#@#  
where the parameters v1, v2, v3, k, , 1, 2, cm should satisfy  #@NEW_LINE#@#  
(21)  #@NEW_LINE#@#  
Note that the parameters need to satisfy both 1 less_than 0 and 2  0, which introduces the following relationship:  #@NEW_LINE#@#  
(22)  #@NEW_LINE#@#  
With Eq (18) and inequalities Eqs (19)(21), we finally obtain the set of stimulus amplitude  that leads to a limit cycle.  #@NEW_LINE#@#  
A periodic bursting-type action potential can then be derived by designing a stimulus amplitude so that the state of the FHN model periodically switches between a stable equilibrium and a limit cycle, hence producing a periodic spike trains.  #@NEW_LINE#@#  Here, we model the pacemaker activity Jstim using a periodic function with stimulus amplitude  in the limit cycle range (a value satisfying Eq (18) and inequality Eqs (19)(21)):  #@NEW_LINE#@#  
(23)  #@NEW_LINE#@#  
where h(t) = h(t + T), which is a periodic function with frequency f = 1/T that controls the time interval between trains of spikes and therefore contractions.  #@NEW_LINE#@#  

Random_conductivity_tensor_model  #@NEW_LINE#@#  
In this section, we introduce a random conductivity tensor model that aims at better capturing the lack of global structure of uterine fibers.  #@NEW_LINE#@#  At the tissue level, the velocity of the transmembrane potential propagation is dependent on the myocyte fiber anisotropy.  #@NEW_LINE#@#  In order to take into account the myometrial fiber orientation, we assume a regular fiber structure, that is, we define al(r) as a unit vector parallel to the main fiber orientation at a point r. Following the same procedure as that in our previous work [14], the conductivity tensors in a global coordinate system are given by  #@NEW_LINE#@#  
(25)  #@NEW_LINE#@#  
(26)  #@NEW_LINE#@#  
where  () is the intra (extra) cellular conductivity tensor, il, it (el, et) are the longitudinal and transversal conductivity values of the intra (extra) cellular domain, respectively, a3(r) is a basis vector that is parallel to al(r), and I3 denotes an identity matrix of size 3 × 3.  #@NEW_LINE#@#  
In our previous work [14], we represented the uterus as a hollow volume with uniform thickness and introduced a general framework for designing the tensor direction in the myometrium for an arbitrary uterine shape.  #@NEW_LINE#@#  Specifically, we presented the fiber orientation a3(r) using its angle  with respect to the vector defined in the tangential plane at that point r. The angle  can be modeled as a spatial basis function defined over the whole uterine domain.  #@NEW_LINE#@#  In the numerical example, however, we only considered a fixed fiber angle of /4 for the whole myometrium (Fig 2(a)).  #@NEW_LINE#@#  In this work, we define the fiber orientation using a finite element method (FEM) mesh.  #@NEW_LINE#@#  We divide the uterus into 25 contiguous regions, via random sampling of the finite elements within the myometrium model, resampling any point that lies less than 4 cm from its nearest neighbor.  #@NEW_LINE#@#  We compute the vector based on the surface normals at our uterus model mesh points for an arbitrary uterine shape.  #@NEW_LINE#@#  Given a mesh point r, with surface normal , the fiber orientation a3(r) is defined as  #@NEW_LINE#@#  
(27)  #@NEW_LINE#@#  
where  is the angle of the fiber relative to the tangent vector.  #@NEW_LINE#@#  In this work, the vertical axis is the y axis rather than the z axis in the previous work [14].  #@NEW_LINE#@#  In order to take into account the spatial variation of fiber orientations, we assign random fiber angles to each region of uterus by sampling from the normal distribution (0, /4) (Fig 2(b)), where 0 is oriented along the vertical axis of the uterus.  #@NEW_LINE#@#  

Speed_of_propagation_for_bursting-type_potential  #@NEW_LINE#@#  
In our previous work [14], we obtained the expression for anisotropy ratio  by solving for a traveling wave solution with reported value of propagation speed of plateau-type potential.  #@NEW_LINE#@#  In this section, we derive the speed of propagation of the bursting-type potential by following a similar solution for the traveling wave with fixed value of .  #@NEW_LINE#@#  
A traveling wave is defined as a wave which travels without change of shape.  #@NEW_LINE#@#  The speed of propagation of the leading front of the waveform can then be taken as the wavespeed.  #@NEW_LINE#@#  Considering the leading front of a transmembrane potential, the variable w of the FHN model changes slowly, which is then regarded to be set at the resting value.  #@NEW_LINE#@#  With Eq (17), we get its resting value as follows:  #@NEW_LINE#@#  
(28)  #@NEW_LINE#@#  
where vmr is the resting potential.  #@NEW_LINE#@#  Replacing Eq (28) in Eq (6), the reaction diffusion equation is then presented by  #@NEW_LINE#@#  
(29)  #@NEW_LINE#@#  
where am is the surface-to-volume ratio of the membrane.  #@NEW_LINE#@#  Eq (29) matches the standard form of reaction diffusion equation for an excitable kinetics model in [22], whose wavespeed is given by  #@NEW_LINE#@#  
(30)  #@NEW_LINE#@#  
where , , and  are the roots of the following polynomial  #@NEW_LINE#@#  
(31)  #@NEW_LINE#@#  
Note that the speed of propagation is proportional to the square root of extracellular longitudinal conductivity el and inversely proportional to membrane capacitance cm and the square root of surface-to-volume ratio am.  #@NEW_LINE#@#  

Realistic_volume_conductor_model  #@NEW_LINE#@#  
At the organ level, we create anatomically realistic models for the volume conductors.  #@NEW_LINE#@#  Rather than using a simple spherical model for the uterus, we model the uterus based on the MRI of a real, near-term, pregnant woman.  #@NEW_LINE#@#  We adapt a uterine mesh from the FEMONUM project (available through http://femonum.telecom-paristech.fr/downloadPage.html) [23], creating a smooth, 3D model for the organ with a uniform 1cm thickness (Fig 3(a)).  #@NEW_LINE#@#  Similarly, rather than using a spherical model for the abdomen, we assume that, when the mother leans against the device, her abdomen will deform slightly to follow the device contours.  #@NEW_LINE#@#  Following this assumption, we create an abdominal model that follows the shape of the SARA device, offset from the front of the uterus by roughly 2 cm (Fig 3(b)).  #@NEW_LINE#@#  

Sensor_model_on_the_abdominal_surface  #@NEW_LINE#@#  
Finally, in order to obtain a more accurate simulation of magnetic field measurements especially around the lower abdomen, we replicate the true sensor positions and measurements from the SARA device, rather than simply observing the normal component of the magnetic field at the abdomen.  #@NEW_LINE#@#  The SARA sensors are hardware gradiometers; each sensor measures the magnetic field at two coils.  #@NEW_LINE#@#  The first is on the inner surface of the device close to the mothers abdomen (denoted as B1) and the second is displaced 8 cm from the first in a direction roughly normal to the SARA surface (denoted as B2).  #@NEW_LINE#@#  The recorded SARA measurement from the ith sensor is actually the difference between the fields at these two points, which is given by  #@NEW_LINE#@#  
(32)  #@NEW_LINE#@#  
where i = 1, 2, , 151.  #@NEW_LINE#@#  This recording is very similar, but not identical, to the normal component of the magnetic field.  #@NEW_LINE#@#  The discrepancy is particularly notable in areas such as the lower central portion of the SARA device where the convexity of the surface results, due to space constraints in placing the sensors, in a non-negligible difference between the surface normal and the actual sensor orientation.  #@NEW_LINE#@#  

Summary_of_modeling_assumptions  #@NEW_LINE#@#  
In this section, we list all the assumptions that are used to formulate the model:  #@NEW_LINE#@#  

SARA_data_collection  #@NEW_LINE#@#  
The data presented here was collected at the University of Arkansas for Medical Sciences (UAMS).  #@NEW_LINE#@#  The protocol was approved by the UAMS Institutional Review Board.  #@NEW_LINE#@#  The study protocol was explained to the subjects and written consent to perform the study was obtained.  #@NEW_LINE#@#  The subjects were then requested to sit comfortably and lean forward on to the sensor array.  #@NEW_LINE#@#  
The duration of a recording was typically around 20 minutes with a sampling rate of 250 Hz.  #@NEW_LINE#@#  The MMG data was then downsampled to 32 Hz and processed using a bandpass filter of 0.1  1 Hz.  #@NEW_LINE#@#  Further, in order to exclude maternal breathing artifact, a notch filter of 0.25  0.35 Hz was applied.  #@NEW_LINE#@#  Using spectral analysis, the primary magnetic activity of a uterine contraction is represented by a low frequency band between 0.1 Hz and 0.4 Hz [26, 27].  #@NEW_LINE#@#  The MMG activity in this range likely represents the plateau and repolarization phase of the action potentials.  #@NEW_LINE#@#  For a more accurate analysis that is closer to the real time-frame, a higher band 0.4  1 Hz should be added to the analysis [26, 27].  #@NEW_LINE#@#  Also, early studies [2830] have shown that the power spectrum density of uterine EMG bursts in patients during active labor is peaked at 0.71±0.05 Hz as compared to non-laboring term 0.48 ± 0.03 Hz patients.  #@NEW_LINE#@#  Most of the uterine EMG studies apply a bandwidth of 0.35  1 Hz.  #@NEW_LINE#@#  The lower band limit of 0.35 Hz is chosen to avoid movement artifacts and also since maternal breathing is a prominent signal around the frequency of 0.33 Hz which can contaminate uterine EMG acquisition.  #@NEW_LINE#@#  In our study, we included the frequency band 0.1  0.25 Hz since we have the ability to acquire signals as low as 0.1 Hz with a relatively high signal to noise ratio with the SARA system [15, 16].  #@NEW_LINE#@#  


Results  #@NEW_LINE#@#  
In this section, we evaluate our multiscale forward model at the cellular, tissue, and organ levels.  #@NEW_LINE#@#  
Cellular_level  #@NEW_LINE#@#  
The plateau-type action potential under certain parameters was illustrated in our previous paper [14].  #@NEW_LINE#@#  To generate a bursting-type action potential, we computed the range of stimulus amplitude such that the FHN system, with model parameters as in Table 2, underwent a limit cycle behavior.  #@NEW_LINE#@#  Specifically, 1 in this case is negative and 2 is positive, hence by evaluating Eq (18) and inequality Eq (20), we obtained that  should range between 0.012 and 0.207.  #@NEW_LINE#@#  We confirmed our computation with the bifurcation diagram (Fig 4) produced by XPPAUT [31] which is an effective numerical tool for simulating, animating, and analyzing dynamical systems.  #@NEW_LINE#@#  The bifurcation parameter  is shown on the horizontal axis and the vertical axis shows the values of the function.  #@NEW_LINE#@#  The red lines denote stable equilibria while the black lines are the unstable equilibria.  #@NEW_LINE#@#  The green solid circles represent stable limit cycles while the blue ones refer to the unstable limit cycles.  #@NEW_LINE#@#  Note that limit cycle behavior is produced when the stimulus amplitude  is between the two vertical lines.  #@NEW_LINE#@#  
The ionic current model is a nonlinear dynamical system of ordinary differential equations which should be solved numerically.  #@NEW_LINE#@#  We used MATLABs built-in ode45 function, which includes fourth order Runge-Kutta method, to validate the cellular level model.  #@NEW_LINE#@#  We reproduced different types of action potentials (Fig 5) by varying the stimulus current.  #@NEW_LINE#@#  Fig 5(a) shows the plateau-type action potential, which was obtained by applying no stimulus current.  #@NEW_LINE#@#  In this case, a stable equilibrium exists in the FHN model.  #@NEW_LINE#@#  The system returns to the equilibrium point after experiencing an excitation, generating the plateau-type action potential.  #@NEW_LINE#@#  If the stimulus current is set to be 0.15 A/m2, it falls in the limit cycle range and hence periodic spike trains will be generated (Fig 5(b)).  #@NEW_LINE#@#  Periodic stimulus current that changes between stable equilibrium and limit cycle ranges gives rise to the periodic bursting-type action potential.  #@NEW_LINE#@#  Fig 5(c) shows an example of the periodic bursting-type action potential by applying a sinusoidal stimulus current with amplitude  = 0.11 and frequency f = 0.05 Hz in Eq (23).  #@NEW_LINE#@#  
We designed the stimulus current of the generalized FHN model using as a reference the average bursting-type action potential recorded from isolated tissue strips of human myometrium at term [20].  #@NEW_LINE#@#  In particular, as reported in [20] from the 39th week of pregnancy, the resting potential is approximately 56 mV and the interval between contractions is around 7 minutes.  #@NEW_LINE#@#  In this numerical example, we introduced the heaviside function, which is the unit step function whose value is zero for negative argument and one for positive argument, as the stimulus current.  #@NEW_LINE#@#  With a periodic heaviside function whose duration is 1 minute and period is 7 minutes, the periodic bursting-type action potential is illustrated in Fig 5(d).  #@NEW_LINE#@#  We observe that the resting potential of our model is 55.6 mV, and the period of consecutive contractions is about 420 s, which are in fair agreement with the recorded values in [20].  #@NEW_LINE#@#  
In Table 3, we examined the relationship between the frequency of spike trains and parameters 1 and 2 using the stimulus current in Fig 5(b).  #@NEW_LINE#@#  We generated transmembrane potentials for different combinations of 1 and 2 values.  #@NEW_LINE#@#  It shows that we are able to obtain a higher frequency with smaller 1 and larger 2, which is consistent with the relationship that is derived in Eq (24).  #@NEW_LINE#@#  

Tissue_level  #@NEW_LINE#@#  

Table 4 gives the parameter values (other than those included in Table 2) for the analysis of propagation speed of the bursting-type potential.  #@NEW_LINE#@#  According to Eq (30), the speed of propagation is 0.0429 m/s along the main fiber direction.  #@NEW_LINE#@#  In order to verify the speed, the fiber orientation  in Eq (27) was set to be 0 so that the fibers lay along the vertical axis of the uterus.  #@NEW_LINE#@#  In our numerical simulation, we took the difference between the top and equator of uterus and find the speed at the equator is approximately 0.0421 m/s, which is a good match with the above theoretic value of wavespeed.  #@NEW_LINE#@#  

Organ_level  #@NEW_LINE#@#  
We tested various configuration aspects, e.g., shape of uterus, shape of abdomen, fiber orientation, and pacemaker location, by simulating the abdomen-surface magnetic field using our multiscale forward model.  #@NEW_LINE#@#  Fig 6 presents simulations of the abdominal magnetic field under each configuration (the detailed configuration for each subfigure is shown in Table 5).  #@NEW_LINE#@#  In [14], we illustrated the normal magnetic field simulation for one pacemaker on the fundus of a spherical myometrium with fixed-angle fiber and a spherical abdomen (Fig 6(a)).  #@NEW_LINE#@#  In order to investigate the sensitivity of MMG to each aspect in configuration, we simulated the normal magnetic field with one aspect of configuration changed in each numerical example (Fig 6(b)6(e)) when compared with the original normal magnetic field (Fig 6(a)) that was obtained using the simplified model.  #@NEW_LINE#@#  Fig 6(b) was generated by introducing an anatomical uterus developed from the FEMONUM project instead of a spherical uterus.  #@NEW_LINE#@#  It can be seen that the general pattern of normal magnetic field for the anatomical uterus is similar to that for a spherical one.  #@NEW_LINE#@#  The normal magnetic field pattern over a SARA-shape abdomen is shown in Fig 6(c).  #@NEW_LINE#@#  We observe that no significant difference is introduced into the abdominal magnetic field even though the shape of abdomen is changed.  #@NEW_LINE#@#  Fig 6(d) illustrates the normal magnetic field with fiber orientation randomly taken from a normal distribution, which displays a significantly different pattern from that with fixed-angle fiber orientation.  #@NEW_LINE#@#  When the pacemaker is located at the lateral of uterus, the normal magnetic field pattern is given in Fig 6(e).  #@NEW_LINE#@#  It is obvious that the propagation direction of magnetic field is influenced by the location of pacemaker.  #@NEW_LINE#@#  Fig 6(f) presents the magnetic field pattern applying the sensor model, which replicates the true SARA sensor readings, to the same configuration as in Fig 6(c).  #@NEW_LINE#@#  It is shown that significant difference of magnetic field pattern occurs at the lower abdomen.  #@NEW_LINE#@#  

Initial_validation_with_real_data  #@NEW_LINE#@#  
Matching a simulation of a full contraction to a real contraction would require optimization of many variables, such as the initial pacemaker location, pacemaker intensity, and fiber directions, and taking into consideration complex scenarios such as one transmembrane potential taking a tortured path that travels across the whole uterus [32], or a transmembrane potential that travels confined within a restricted area and recruits other pacemakers in areas across the uterus [33, 34].  #@NEW_LINE#@#  In the second scenario, the locations and activation times of the recruited pacemakers must also be optimized.  #@NEW_LINE#@#  Without an inverse model, manually optimizing these variables is infeasible.  #@NEW_LINE#@#  As such, we validate our model by comparing its magnetic field outputs with the real patient MMG data during a limited portion of a uterine contraction.  #@NEW_LINE#@#  Specifically, we match the emergence and decay of the contraction, when it is known that the contraction will be limited to a small region around a single pacemaker.  #@NEW_LINE#@#  
The real data presented here was collected from a pregnant woman whose gestational age was 38 weeks and 4 days (see SARA data collection for details).  #@NEW_LINE#@#  We chose to simulate the emergence and decay of one pre-labor uterine contraction, which are marked in the red boxes (1050 s1065 s, 1135 s1150 s) in Fig 7.  #@NEW_LINE#@#  Considering the alternating positive and negative magnetic field measurements in Fig 7, we decided to adopt the ionic current model that can generate the bursting-type action potential.  #@NEW_LINE#@#  
In our numerical example, we applied the simplified spherical uterus with a 16 cm radius measured from the center to the external boundary surface of the myometrium  and assumed the uterine wall with a uniform thickness of 1 cm.  #@NEW_LINE#@#  The spherical abdominal compartment with a 21 cm radius was 2 cm offset from the front of the uterus.  #@NEW_LINE#@#  The spherical uterus and abdomen were chosen according to the above analysis at the organ level that the geometry has little impact in the magnetic field pattern when compared to those of the real anatomy and SARA shape.  #@NEW_LINE#@#  We also defined the fetus to be a solid sphere with a 12 cm radius concentric to the myometrium.  #@NEW_LINE#@#  The conductivity values of the homogeneous and isotropic compartments were listed in Table 6.  #@NEW_LINE#@#  The anisotropy of uterus was represented by the random conductivity tensor model and the surface normals were specified relative to the mesh points of the uterus.  #@NEW_LINE#@#  We randomly chose the conductivities of uterus to be either 0 or sampled from a normal distribution such that the average value matched the conductivity value in Tabel 4.  #@NEW_LINE#@#  We assumed that one pacemaker was located at the back of the uterus, centered at (0, 13.0, 7.5)cm, which was represented by  with stimulus amplitude Vstim = 0.11 V and stimulus duration Tstim = 5 s.  #@NEW_LINE#@#  
The limited propagation of the bursting-type transmembrane potential, as expected during the emergence and decay of a new contraction, can be achieved either by simply electrically isolating the limited propagation area or, more realistically, by having region-specific ionic current model parameters.  #@NEW_LINE#@#  To test the more realistic limited-propagation approach, we set the ionic current model parameters to lie within the limit cycle range for the region of uterus less than 10 cm from the center of the pacemaker, and designed the parameters within the stable equilibrium range outside this region of uterus (see Table 7 for detailed parameters).  #@NEW_LINE#@#  
The computation of the electromagnetic fields on the uterine and abdominal surfaces was implemented using the FEM solver COMSOL Multiphysics version 4.3a on a server with 12 processors at 2.3 GHz with 64 GB RAM.  #@NEW_LINE#@#  We discretized the four-compartment volume conductor geometry into 1,181,186 tetrahedral elements, which were allocated as: 109,237 elements in the additional compartment concentric to the abdomen with a 50 cm radius, 321,633 elements in the abdominal cavity, 555,180 elements in the myometrium, 190,289 elements in the intrauterine cavity, and 4,847 elements in the fetus.  #@NEW_LINE#@#  The uterine and abdominal surfaces were divided into 38,844 and 6,834 triangular elements, respectively.  #@NEW_LINE#@#  After the discretization, the computations of transmembrane potential, electrical potential, and magnetic field were given in 3 steps.  #@NEW_LINE#@#  The first step to solve the 10-minutes uterine transmembrane potential required 4.5 hours when the number of degree of freedom was 223,274, while the solution time in the second step for electrical potential was 7 hours with number of degree of freedom 1,440,961.  #@NEW_LINE#@#  In the computation of abdominal magnetic field, the number of degree of freedom was 1,579,337 and the corresponding solution time was 4 hours when we chose the generalized minimal residual (GMRES) solver.  #@NEW_LINE#@#  

Fig 8 shows several snapshots of the real patient MMG and the FEM solution of our forward model at three time instants within the limited propagation mode of a contraction (i.e., during the beginning or end of a contraction).  #@NEW_LINE#@#  Fig 8(a) provides the magnetic field measurements of the pregnant woman during the two portions of the uterine contraction.  #@NEW_LINE#@#  Fig 8(b) illustrates the simulated magnetic field at the abdominal surface and the corresponding transmembrane potential at the uterus surface is shown in Fig 8(c).  #@NEW_LINE#@#  We observe that our multiscale forward model is able to capture certain features of the specific patients MMG recordings, such as the spreading pattern of magnetic field at different areas, by proper placement of the pacemaker and restriction of the propagation area.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
As an ionic current model, the FHN equations produced a fair approximation of the plateau-type action potential [14].  #@NEW_LINE#@#  We generated a periodic bursting-type action potential by applying a periodic stimulus current into the FHN equations.  #@NEW_LINE#@#  Our simulation result at the cellular level shows that the simple spikes in a burst depolarize to an average of 25 mV.  #@NEW_LINE#@#  However, the depolarization of bursting-type action potential in human myocytes reported in [20] is much smaller (42 mV).  #@NEW_LINE#@#  Note that in [14], the authors pointed out that the model parameters v1, v2, v3, and k control the range of vm, which means that it is possible to generate a bursting-type action potential as in the literature through adjusting these four parameters.  #@NEW_LINE#@#  
In our previous work, the magnetic field was recognized as highly dependent on the fiber orientation of the myometrium.  #@NEW_LINE#@#  Our numerical simulation results (Fig 6(a) and 6(d)) provide a fair illustration that the direction and intensity of magnetic field change significantly under different fiber orientations.  #@NEW_LINE#@#  The magnetic field recordings of pregnant women obtained using the SARA device also demonstrate the relationship between the pattern of the magnetic field and complex fiber orientations.  #@NEW_LINE#@#  In order to obtain the best match to patient recordings, fiber orientations should ideally be accurate to the individual.  #@NEW_LINE#@#  Unfortunately, a widely accepted model of fiber architecture of the myometrium is currently unavailable [35].  #@NEW_LINE#@#  The current technique is to study the global fiber based on magnetic resonance (MR) diffusion tensor imaging (DTI).  #@NEW_LINE#@#  However, it is difficult to get approval for MRI studies on pregnant women that are not medically indicated, thus making it challenging to obtain an accurate fiber structure for every pregnant woman.  #@NEW_LINE#@#  Instead of totally random fiber orientation in this work, we can instead apply the average fiber structure of human myometrium, which is obtained from the MRDTI studies on the recruited subjects in this project.  #@NEW_LINE#@#  
In our work, we are assuming that the abdomen follows the contour of the SARA device after the pregnant woman sits and leans her abdomen against the device.  #@NEW_LINE#@#  This abdominal model would be incorporated into our entire modeling if it produces magnetic field that matches more with the real data.  #@NEW_LINE#@#  However, the magnetic field measured at the realistic abdomen (Fig 6(c)) shows minimal changes when compared with that measured at the spherical abdomen (Fig 6(a)).  #@NEW_LINE#@#  In this sense, a spherical abdomen is suitable to represent the geometry of the abdomen surface.  #@NEW_LINE#@#  
The spherical volume conductor geometry was thought to be an oversimplification of the real uterus and a more realistic model was proposed [14].  #@NEW_LINE#@#  However, the simulation result with an anatomical uterus from the FEMONUM project (Fig 6(b)) displays a quite similar magnetic field pattern to that of the spherical one (Fig 6(a)).  #@NEW_LINE#@#  The spherical uterus assumption is appropriate for SARA device analysis, since the shape of the SARA device is concave, which is related to the shape of the abdomen.  #@NEW_LINE#@#  Despite specific uterine shapes at different stages of pregnancy, a spherical geometry is therefore a good choice for simplified modeling without causing too much distortion.  #@NEW_LINE#@#  
It is expected that each uterine myocyte can act as a pacemaker as well as a pacefollower.  #@NEW_LINE#@#  In this work, we observe that the location of pacemaker has significant impact on the magnetic field pattern (Fig 6(e)).  #@NEW_LINE#@#  The sensitivity of propagating direction to pacemaker locations makes it possible for us to determine from real data where the pacemaker is located.  #@NEW_LINE#@#  Exploring the configurations that characterize specific contraction patterns is exactly what we want to achieve by developing the multiscale forward model of contractions in pregnant uterus.  #@NEW_LINE#@#  
Obtaining a better replication of real data in a relatively simple way is possible with the following steps.  #@NEW_LINE#@#  Regarding the volume conductor geometry, we propose to use the simple spherical model no matter which stage the pregnant woman is in and how her abdomen is deformed.  #@NEW_LINE#@#  Accurate modeling for the conductivity tensor and pacemaker location is important since they have a more significant effect on the pattern of magnetic field.  #@NEW_LINE#@#  The fiber orientation should be averaged to population according to the MR DTI while the pacemaker can be set at the back of uterus.  #@NEW_LINE#@#  Periodic bursting-type action potential is introduced into our model by adding a periodic stimulus current in the FHN model.  #@NEW_LINE#@#  In [10], the ionic current model with a simple constant stimulus current produces more complex action potentials other than the bursting-type one simply by adjusting the parameters of the model, which makes it a perfect applicant as our ionic current model.  #@NEW_LINE#@#  
The application of our multiscale forward model to real MMG data shows that our model is able to mimic the limited-propagation magnetic field patterns during the emergence and decay of a uterine contraction.  #@NEW_LINE#@#  Note that this result is obtained by applying a pacemaker at the back of the uterus, a random fiber direction, a simplified spherical volume conductor geometry, and region-specific ionic current model parameters.  #@NEW_LINE#@#  Our model, therefore, is flexible to mimic the magnetic field patterns at different stages of uterine contraction by simply changing the aspects of model configuration.  #@NEW_LINE#@#  Among other things, our modeling approach enables us to test for different scenarios hypothesized in the literature regarding the recruitment of the uterus during a contraction [3234].  #@NEW_LINE#@#  
Our first analysis on real data shows that reproducing the magnetic field patterns for the entire uterine contraction process would require estimating the model parameters for the specific subject and setting the right model configurations as described in Table 5.  #@NEW_LINE#@#  In fact, based on our results, the magnetic field patterns are sensitive to ionic current model parameters, conductivity tensor model of myometrium, and pacemaker location.  #@NEW_LINE#@#  To estimate the configurations that best predict the data of a particular patient, there is a need to formally solve the inverse problem of uterine contractions using the proposed multiscale model.  #@NEW_LINE#@#  Given the MMG measurements and our multiscale forward model, we can estimate the current density, conductivity tensor, and pacemaker location by solving the inverse problem.  #@NEW_LINE#@#  Developing the multiscale forward model is the prerequisite of solving the inverse problem while solving the inverse problem functions as the bridge between the multiscale modeling and clinical application.  #@NEW_LINE#@#  
Although solving the inverse problem is out of the scope of this paper, we are currently working on developing the statistical framework to enable this approach.  #@NEW_LINE#@#  We intend to first estimate the current density in the myometrium from the abdominal MMG measurements, with which we intend to discover the features that can characterize the preterm uterine contraction patterns.  #@NEW_LINE#@#  The performance of our model will be further quantified by root-mean-square error (RMSE) between the simulated magnetic field, which is obtained using our model with configuration properly set, and the real patient recordings.  #@NEW_LINE#@#  

Conclusions  #@NEW_LINE#@#  
We developed a realistic multiscale forward model of contractions in pregnant uterus jointly at the cellular, tissue, and organ levels.  #@NEW_LINE#@#  Our approach incorporated the electrophysiological and anatomical knowledge of uterine contractions to compute the abdominal magnetic field.  #@NEW_LINE#@#  At the cellular level, we introduced a variation of the FitzHugh-Nagumo equations to generate both plateau-type and bursting-type action potentials.  #@NEW_LINE#@#  Analytical expressions for the speed of propagation and frequency of the bursting potential were derived and validated using numerical examples.  #@NEW_LINE#@#  We also designed a random conductivity tensor model applicable to an arbitrary uterine shape at the tissue level.  #@NEW_LINE#@#  At the organ level, we introduced a realistic anatomical model for the volume conductor geometry based on the magnetic resonance images of a pregnant woman.  #@NEW_LINE#@#  In order to simulate the real measurements of the SARA device, we proposed an array sensor model on the abdominal surface.  #@NEW_LINE#@#  Finally, we investigated the sensitivity of magnetic field pattern to the configuration aspects using numerical examples.  #@NEW_LINE#@#  Since the volume conductor geometry rarely changes the pattern of magnetic field, we conclude that the spherical shape stands out as a good approximation of the geometry of uterus and abdomen.  #@NEW_LINE#@#  We demonstrate that fiber orientation and pacemaker location have a great effect on the pattern of magnetic field.  #@NEW_LINE#@#  We also show that it is flexible to mimic the limited-propagation magnetic field pattern during the emergence and decay of the uterine contraction by setting certain configurations for our multiscale forward model.  #@NEW_LINE#@#  
For the future work, we will build up a conductivity tensor model based on magnetic resonance diffusion tensor imaging rather than wholly random as a better way to configure the fiber structure of uterus.  #@NEW_LINE#@#  We will also introduce a more complex ionic current model which considers the electrochemical characteristic of individual myocyte as in [10] and reproduce the full contraction simulation to match with the real patient data by estimating the optimal configurations using an inverse problem approach.  #@NEW_LINE#@#  



