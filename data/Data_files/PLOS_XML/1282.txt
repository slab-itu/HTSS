article id="http://dx.doi.org/10.1371/journal.pcbi.1005435"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Variable habitat conditions drive species covariation in the human microbiota  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Two species with similar resource requirements respond in a characteristic way to variations in their habitattheir abundances rise and fall in concert.  #@NEW_LINE#@#  We use this idea to learn how bacterial populations in the microbiota respond to habitat conditions that vary from person-to-person across the human population.  #@NEW_LINE#@#  Our mathematical framework shows that habitat fluctuations are sufficient for explaining intra-bodysite correlations in relative species abundances from the Human Microbiome Project.  #@NEW_LINE#@#  We explicitly show that the relative abundances of closely related species are positively correlated and can be predicted from taxonomic relationships.  #@NEW_LINE#@#  We identify a small set of functional pathways related to metabolism and maintenance of the cell wall that form the basis of a common resource sharing niche space of the human microbiota.  #@NEW_LINE#@#  

Author_summary  #@NEW_LINE#@#  
The human body is inhabited by a vast number of microorganisms comprising the human microbiota.  #@NEW_LINE#@#  The species composition of the microbiota varies considerably from person-to-person and the relative abundances of some species rise and fall in concert.  #@NEW_LINE#@#  We introduce a mathematical model where differences in habitat conditions cause most of the variability of the microbiota.  #@NEW_LINE#@#  A statistical analysis shows that variable habitat conditions are sufficient for explaining the patterns of variation observed across a healthy human population and, as a result, the correlation between the relative abundances of two species reflects how closely related they are rather than how they directly interact with each other.  #@NEW_LINE#@#  

Citation: Fisher CK, Mora T, Walczak AM (2017) Variable habitat conditions drive species covariation in the human microbiota.  #@NEW_LINE#@#  PLoS Comput Biol 13(4):  #@NEW_LINE#@#  
           e1005435.  #@NEW_LINE#@#  

        https://doi.org/10.1371/journal.pcbi.1005435  #@NEW_LINE#@#  
Editor: Justin Lessler,  #@NEW_LINE#@#  
Johns Hopkins Bloomberg School of Public Health, UNITED STATES  #@NEW_LINE#@#  

Received: August 2, 2016; Accepted: March 1, 2017; Published:  April 27, 2017  #@NEW_LINE#@#  
Copyright:  Â© 2017 Fisher et al.  #@NEW_LINE#@#  This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.  #@NEW_LINE#@#  
Data Availability: Source code and processed data files are available as part of the Supporting Information and at https://sites.google.com/site/charleskennethfisher/home/programs-and-data.  #@NEW_LINE#@#  We obtained all of the data from publicly available resources.  #@NEW_LINE#@#  Specifically, data from the Human Microbiome Project were obtained from MG-RAST at http://metagenomics.anl.gov/mgmain.html?mgpage=project&project=mgp385, and data on species metabolic enzymes were obtained from KEGG at http://www.genome.jp/kegg/.  #@NEW_LINE#@#  
Funding: This work was funded by a Philippe Meyer Fellowship to CKF (http://www.ipm.ens.fr/?lang=en).  #@NEW_LINE#@#  The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  
Competing interests:  The authors have declared that no competing interests exist.  #@NEW_LINE#@#  
Introduction  #@NEW_LINE#@#  
Species in an ecosystem interact with each other and with their environment.  #@NEW_LINE#@#  Both types of interactions leave an imprint on the composition and diversity of a community.  #@NEW_LINE#@#  Two species competing for exactly the same resources engage in a struggle for existence [1].  #@NEW_LINE#@#  In the end, one species will win the competition by driving the other to extinction.  #@NEW_LINE#@#  As a result, one might expect that closely related species rarely occupy the same habitat where they would risk being drawn into competition.  #@NEW_LINE#@#  On the other hand, species that survive in the same habitat must share many common features [2].  #@NEW_LINE#@#  Thus, the rise and fall of a common resource may cause the abundances of similar species to rise and fall in concert.  #@NEW_LINE#@#  These opposing ecological forces simultaneously push and pull on species abundances to shape the composition of a community.  #@NEW_LINE#@#  
Ecological processes operate on the thousands of microbial species that inhabit the human body [36] just as they operate on the Amazon rainforest.  #@NEW_LINE#@#  Technological advances have recently made it possible to study the human microbiota using 16S ribosomal RNA tag-sequencing and whole genome shotgun metagenomics [7].  #@NEW_LINE#@#  Variability in the composition of the microbiota can be studied in two ways.  #@NEW_LINE#@#  Longitudinal studies follow the relative abundances of the species in a single bodysite of a particular person over time [8].  #@NEW_LINE#@#  Cross-sectional studies examine the relative abundances of the species in a single bodysite across a sample of many different people [9].  #@NEW_LINE#@#  These studies have demonstrated that the composition of the human microbiota exhibits three qualitative scales of variation [10, 11]: there are small-scale fluctuations in relative species abundances through time, there are medium-scale variations in species composition from person-to-person, and there are large-scale differences in species composition between different bodysites.  #@NEW_LINE#@#  
In this work we quantitatively explore the idea that variations in species abundances between different sites can be explained mainly through the local variations in resource availability.  #@NEW_LINE#@#  Concretely, we reanalyze data from the Human Microbiome Project (HMP) [35, 12] on the species composition of different bodysites (i.e., gut, skin, vagina, and oral cavity; Fig 1).  #@NEW_LINE#@#  To develop the analysis method, we start from a theoretical model that assumes maximal diversity of species and derives a relationship between species abundance and resource availability.  #@NEW_LINE#@#  We then use the results of this model to guide the joint analysis of the datasets from different body sites in the HMP project, introducing a new Common Component Analysis (CoCA) method.  #@NEW_LINE#@#  The general idea is that if the same species exist in different body sites, the same resources must also be present at these body sites.  #@NEW_LINE#@#  We find that this intuition is correct by showing that the covariance of species abundances at specific body sites can be simultaneously projected into the same basis that describes the availability of effective resources.  #@NEW_LINE#@#  This means that the abundances of species at different body sites are driven by the same set of resources, just different resources are of varying importance at different body sites.  #@NEW_LINE#@#  These results cannot be reproduced from randomized data and reflect an underlying global set of ecological resources shared between body sites.  #@NEW_LINE#@#  
A) Data on the microbial species composition of the gut, oral cavity, vagina, and skin from the Human Microbiome Project were obtained from MG-RAST.  #@NEW_LINE#@#  One hundred highly abundant species were selected for further study (S1 Text).  #@NEW_LINE#@#  The top five most abundant species in each bodysite are shown.  #@NEW_LINE#@#  B) We propose a theory for the composition of the microbiota based on a Maximum Diversity Hypothesis, which says that the equilibrium relative species abundances in a community maximize the diversity of the community while ensuring that all niches are fully utilized.  #@NEW_LINE#@#  As a consequence, variability from person-to-person in the species composition within a bodysite results from variability in the availabilities of some effective resources that define the space of niches.  #@NEW_LINE#@#  C) An overview of the steps in the Common Components Analysis (CoCA) algorithm.  #@NEW_LINE#@#  Covariance matrices are computed from the log-ratio transformed relative abundances in each bodysite.  #@NEW_LINE#@#  The covariance matrices are simultaneously diagonalized to obtain a basis of common components, and an inverse log-ratio transform is applied obtain the inferred effective resource utilizations.  #@NEW_LINE#@#  D. Overall logical flow of the paper.  #@NEW_LINE#@#  Characterizing the effective resources allows us to identify the functional pathways which must be conserved to utilize a common habitat.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pcbi.1005435.g001  #@NEW_LINE#@#  
Our method identifies species that share common resources.  #@NEW_LINE#@#  To understand the source of this sharing, we look for similarities between the species.  #@NEW_LINE#@#  We find that species that share common resources are also closely related taxonomically, suggesting that evolution is constrained by ecology.  #@NEW_LINE#@#  We further back this observation by identifying specific metabolic pathways that are conserved between species identified as close using our resource sharing analysis.  #@NEW_LINE#@#  
The goal of this work is three-fold.  #@NEW_LINE#@#  First, we introduce a new analysis technique that identifies covariations among components in different subsets that are driven by the same process (CoCA).  #@NEW_LINE#@#  Second, by successfully applying the CoCA analysis technique to HMP data, we show that the diversity of the microbiome at different body sites is shaped by common biological processes.  #@NEW_LINE#@#  Third, in the case of the specific problem of species at different ecological sites, we make the biological point that microbiome species that share the same resources are also closely related taxonomically and we back this fact by identifying shared pathways.  #@NEW_LINE#@#  The methodological developments are presented in the Theory subsection of the Results and the biological results in theAnalysis subsection.  #@NEW_LINE#@#  For readers predominantly interested in the biological results the Analysis subsection can be read independently of the Theory subsection.  #@NEW_LINE#@#  
In addition to presenting statistical evidence for the observations described above, we formulate a hypothesis (in the form of a mathematical model) that explains their origin.  #@NEW_LINE#@#  Our model is inspired by MacArthurs famous model of competition [1, 1315], but is adapted to account for the compositional nature of metagenomic survey data.  #@NEW_LINE#@#  We demonstrate that habitat variability is sufficient to explain the medium-scale variations in species composition observed in a cross-sectional study of the human microbiota.  #@NEW_LINE#@#  As a result, the relative abundances of closely related species are positively correlatedthey rise and fall in concert as habitat conditions vary from person-to-person.  #@NEW_LINE#@#  Therefore, cross-sectional studies allow us to extract a wealth of information about the influence of species traits and habitat properties on community composition using advanced statistical techniques.  #@NEW_LINE#@#  

Results_and_discussion  #@NEW_LINE#@#  
Theory  #@NEW_LINE#@#  

Analysis  #@NEW_LINE#@#  
Although we have stated the maximum diversity hypothesis as a generative model of species composition, we rarely know, and generally cannot measure, all of the effective resources in a community.  #@NEW_LINE#@#  Therefore, we treat the mathematical model as an inverse problem with the goal of inferring the effective resources from observations of species composition across many individuals and bodysites.  #@NEW_LINE#@#  The inverse problem can be solved because, by construction, the model imposes that the inferred effective resources correspond to directions with high intra-bodysite variability (Fig 2A2C).  #@NEW_LINE#@#  We exploit this feature to developed a technique we called CoCA that infers the characteristics of the species and habitats from observed correlations (S1 Text).  #@NEW_LINE#@#  Like other techniques for simultaneous matrix diagonalization [1921, 28], CoCA aims to find a single set of directions that simultaneously explain variation within each of the bodysites.  #@NEW_LINE#@#  Moreover, CoCA has a theoretical interpretation derived from the maximum diversity hypothesis and properly accounts for the compositional nature of genomic survey data.  #@NEW_LINE#@#  
Our statistical analysis of the data from the Human Microbiome Project (HMP) centers on three observations:  #@NEW_LINE#@#  
The first point is a validation of our mathematical model, whereas points 2 and 3 demonstrate that the results obtained by CoCA have biologically reasonable interpretations.  #@NEW_LINE#@#  Point 3 is a corollary of point 2; if taxonomy explains species relationships in the common basis then it follows that there will also be a relationship with characteristics that vary by taxonomy (e.g., metabolic pathways).  #@NEW_LINE#@#  Nevertheless, it is important to check that the pathways that are selected make biological sense.  #@NEW_LINE#@#  We compare the CoCA results to PCA, as well as to the results of the CoCA algorithm applied to randomized data (S1 Text).  #@NEW_LINE#@#  

Conclusion  #@NEW_LINE#@#  
Previous studies have revealed that bacteria exhibit tremendous genomic and functional diversity due, in part, to high rates of horizontal gene transfer (HGT) [36].  #@NEW_LINE#@#  As a result, the ability of sequence-based or taxonomic classification of bacteria to capture ecological relationships has been called into question [3740].  #@NEW_LINE#@#  Nevertheless, we found that genetically related species respond to fluctuating habitat conditions in the same way, implying that they occupy similar ecological niches.  #@NEW_LINE#@#  Thus, current taxonomic groupings of bacteria are largely sufficient for explaining cross-sectional correlations in relative species abundances over the healthy human population.  #@NEW_LINE#@#  This result is not at odds with high rates of HGT; it simply implies ecologically derived constraints on evolution.  #@NEW_LINE#@#  
We introduced CoCA, a theory-driven data analysis technique that can be applied to any cross-sectional study with labeled metadata, including studies with populations corresponding to healthy and unhealthy individuals.  #@NEW_LINE#@#  Although the effective resources identified by CoCA are derived entirely from data on relative species abundances across a population, they reflect indirect ecological relationships between species that are mediated through resources and form the basis of a common resource sharing niche space of the human microbiota.  #@NEW_LINE#@#  Future analyses of larger, and more diverse, datasets will further elucidate the relationship between this underlying niche space and the functional properties of the organisms in the microbiota.  #@NEW_LINE#@#  Given that CoCA identifies features that separate the bodysites with high fidelity, we believe that it is a useful technique for identifying microbiota based biomarkers that discriminate between host phenotypes.  #@NEW_LINE#@#  Extending our results to include data from unhealthy subjects will be an important avenue for future work.  #@NEW_LINE#@#  
A recent paper by Bashan et al [41] developed an approach to analyzing microbial dynamics based on a Dissimilarity-Overlap Curve.  #@NEW_LINE#@#  They found that communities with a high overlap in the species that were present also have a low dissimilarity in their relative abundance profiles.  #@NEW_LINE#@#  They argue that this relationship is evidence of universality where interspecies interactions are essentially the same across a population of human subjects.  #@NEW_LINE#@#  Our model is also based on the assumption that the underlying drivers of variation in the microbiota are the same across subjects and across bodysites, and it is only the relative importance of these factors that leads to differences between groups.  #@NEW_LINE#@#  However, we focused only on variation in the relative abundances of highly abundant species that are present across all four major bodysites in the Human Microbiome Project rather than variation in species assemblages.  #@NEW_LINE#@#  
The successful application of CoCA to HMP data from four different body sites implies that the processes that shape the variation in species abundances are shared between bodysites, and only changes in the specific contribution of various effective resources differentiate bodysites.  #@NEW_LINE#@#  CoCA uses simultaneous diagonalization to identify processes that are shared between communities.  #@NEW_LINE#@#  Covariance matrices from communities without shared drivers of variation cannot be simultaneously diagonalized, as we showed with randomized data.  #@NEW_LINE#@#  Consequently, we would expect that CoCA would fail on datasets from clearly different ecological environments (e.g., hot springs compared to body sites).  #@NEW_LINE#@#  In this case, failure is not a bad thing: it can be easily diagnosed from the poor agreement between the predicted and observed covariances and it provides an ecologically meaningful result be ruling out the hypothesis that the environments have shared drivers of variation.  #@NEW_LINE#@#  
CoCA does not explain 100% of the variation in the HMP data, nor do taxonomic relationships explain 100% of the variation in the inferred resource utilizations.  #@NEW_LINE#@#  The additional variation is likely do to other types of interactions between species in the human microbiota that cannot be captured using effective resources that are shared across bodysites.  #@NEW_LINE#@#  Moreover, effective resources are only defined by a statistical model and, therefore, do not have obvious relationships to measurable environmental variables.  #@NEW_LINE#@#  Here, we attempted to explain the inferred effective resources in terms of metabolic processes inferred through KEGG pathways but it is likely that other factors, such as resilience to temperature or pH ranges, contribute to the effective resources in ways that our analysis with KEGG pathways could not uncover.  #@NEW_LINE#@#  
Our study also has other limitations that should be addressed in future work.  #@NEW_LINE#@#  We have based our analyses on relative species abundances derived from OTUs constructed using data from the HMP.  #@NEW_LINE#@#  These data are likely to be noisy, but the degree of uncertainty is difficult to quantify.  #@NEW_LINE#@#  Moreover, the use of OTUs defined by 97% sequence identity, and subsequent reduction of the communities to 100 highly abundant species, leads to a coarse grained representation that may smooth out relevant features.  #@NEW_LINE#@#  It will be important to revisit our analyses on additional datasets, and with additional tools for generating highly accurate pictures of community composition.  #@NEW_LINE#@#  On the theoretical side, it will be important to examine the validity of the maximum diversity hypothesis across communities with different properties.  #@NEW_LINE#@#  


Methods  #@NEW_LINE#@#  
Data_collection  #@NEW_LINE#@#  
We analyzed data from the Human Microbiome Project (HMP) on person-to-person variability in relative species abundances in four bodysites (gut, oral cavity, vagina, and skin; Fig 1A) [35, 12].  #@NEW_LINE#@#  The species-level relative abundances derived from the HMP whole genome sequencing data were obtained from MG-RAST (Project 385) through the MR-RAST API [42].  #@NEW_LINE#@#  Only the processed data as provided on the MG-RAST server were extracted.  #@NEW_LINE#@#  Thus, these species counts were constructed using the default MG-RAST pipeline [43].  #@NEW_LINE#@#  Briefly, this pipeline identifies putative rRNA fragments and clusters them at 97% identity to define operational taxonomic units, which are assigned species labels using a search against the M5rna database [44].  #@NEW_LINE#@#  We eliminated any lowly abundant species and selected for further study 100 species (Fig 3A) that were highly abundant across all bodysites, as described in S1 Text.  #@NEW_LINE#@#  The final dataset (consisting of the counts of the 100 selected species in each of the samples) is available in the Supporting Information (S1 Code) and at https://sites.google.com/site/charleskennethfisher/home/programs-and-data along with the source code.  #@NEW_LINE#@#  

Log-ratio_transformations_and_CoCA  #@NEW_LINE#@#  
Log-ratio transformations are obtained using y = G log x, where x is an N dimensional vector of relative abundances, G is an N  1 Ã N matrix with G1 = 0, and y is an N  1 dimensional vector of transformed relative abundances.  #@NEW_LINE#@#  We use a G that implements an additive log-ratio (or ALR) transform, but the choice of G is not critical for our analyses and some other possible choices are discussed further in the S1 Text.  #@NEW_LINE#@#  Applying a log-ratio transformation to Eq 2 gives .  #@NEW_LINE#@#  Here, V is an N Ã N  1 dimensional matrix whereas  is an N  1 Ã N  1 dimensional matrix.  #@NEW_LINE#@#  Once again, the use of relative abundances shows up as a loss of information.  #@NEW_LINE#@#  The matrix V that contains the information about all N species that we would like to obtain can only be recovered from  using some assumptions.  #@NEW_LINE#@#  
The use of compositional transformations with CoCA requires an extra step to recover the N Ã N  1 dimensional matrix V from the N  1 Ã N  1 dimensional matrix .  #@NEW_LINE#@#  Unfortunately, the matrix G is not invertible.  #@NEW_LINE#@#  But, if we assume that V is sparse then it is possible to determine V from .  #@NEW_LINE#@#  In the context of the model, this assumption means that any individual consumer species is unlikely to be able to utilize every effective resource.  #@NEW_LINE#@#  To recover V from , we solve the problem:  #@NEW_LINE#@#  
(5)  #@NEW_LINE#@#  
where ||V||1 = i |Vi|.  #@NEW_LINE#@#  Using the ALR transform, all of the solutions to this problem are all of the form  for i = 1, , N, where z can, in principle, take on any real value.  #@NEW_LINE#@#  Because we want the solution with a minimum L1 norm, it is sufficient to test z = 0 and  (the only sparse solutions) and to choose the one with minimum norm.  #@NEW_LINE#@#  This is a tractable search over N(N  1) possibilities in the worst case and can be done easily for reasonable system sizes.  #@NEW_LINE#@#  

Pathway_selection_with_the_Bayesian_Ising_Approximation  #@NEW_LINE#@#  
Each row of the matrix  (here, G is a matrix that arises from the log-ratio transformsee details) describes how one of the species responds to changes in the latent variables.  #@NEW_LINE#@#  Thus, the ith row of V is a mathematical representation of species i.  #@NEW_LINE#@#  The distance between species i and j in the inferred basis can be calculated by computing the distance between the ith and jth rows of V with each column (i.e., latent variable) weighted by its variance (S1 Text).  #@NEW_LINE#@#  
Distances between species computed from the common components were regressed against the distances computed from KEGG pathways (S1 Text).  #@NEW_LINE#@#  To select relevant pathways, we compute posterior probabilities for each regression coefficient to be non-zero using the Bayesian Ising Approximation (BIA) [34, 35].  #@NEW_LINE#@#  The BIA approximates the posterior distribution of a vector indicator variables with si = +1 if pathway i relevant and si =  1 if pathway i is not relevant.  #@NEW_LINE#@#  The posterior distribution is approximately an Ising model described by:  #@NEW_LINE#@#  
(6)  #@NEW_LINE#@#  
where the external fields (hi) and couplings (Jij) are defined as:  #@NEW_LINE#@#  
(7) (8)  #@NEW_LINE#@#  
and  is the inverse variance of the prior distribution.  #@NEW_LINE#@#  Here, r(z1, z2) is the Pearson correlation coefficient between variables z1 and z2.  #@NEW_LINE#@#  The BIA approximation is based on a series expansion that is valid as long as:  #@NEW_LINE#@#  
(9)  #@NEW_LINE#@#  
where  is the root mean square correlation between features.  #@NEW_LINE#@#  
To perform feature selection, we are interested in computing marginal probabilities P(sj = 1|y)  (1 + mj())/2, where we have defined the magnetizations mj() = sj.  #@NEW_LINE#@#  While there are many techniques for calculating the magnetizations of an Ising model, we focus on the mean field approximation which leads to a self-consistent equation:  #@NEW_LINE#@#  
This mean field approximation provides a computationally efficient tool that approximates Bayesian feature selection for linear regression.  #@NEW_LINE#@#  


Supporting_information  #@NEW_LINE#@#  
S1_Fig_Comparison_of_the_additive_logratio_(ALR)_transform_with_the_Aitchison_distance  #@NEW_LINE#@#  
A) The Aitchison distance is a metric for relative abundance data based on log-ratios.  #@NEW_LINE#@#  The ALR transform is not isometric (meaning, it does not preserve distances exactly) but the distances computed with the ALR transformed relative abundances are highly correlated the Aitchison distance (R = 0.87).  #@NEW_LINE#@#  b) The first two principal coordinates computed using the Aitchison distance.  #@NEW_LINE#@#  c) The first two principal coordinates computed using the ALR transformed relative abundances (reproduced in S7E Fig).  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1005435.s001  #@NEW_LINE#@#  
(TIFF)  #@NEW_LINE#@#  

S2_Fig_Fitting_the_common_components_analysis_model  #@NEW_LINE#@#  
Plot of the CoCA objective function during gradient descent using the true covariance matrices (red, dashed line) and 20 randomized covariances matrices (black lines).  #@NEW_LINE#@#  The error bars on the final value of the objective function with the randomized matrices represent Â± 6 standard deviations.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1005435.s002  #@NEW_LINE#@#  
(TIFF)  #@NEW_LINE#@#  

S3_Fig_Comparing_the_variance_in__to_s  #@NEW_LINE#@#  
(Top row) Correlations between diagonal elements of s and the variances computed from the inferred s. (Middle row) Correlations between diagonal elements of s and the variances computed from the inferred s for the best of the 20 randomizations.  #@NEW_LINE#@#  (Bottom row) The distribution of correlations from all 20 randomizations.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1005435.s003  #@NEW_LINE#@#  
(TIFF)  #@NEW_LINE#@#  

S4_Fig_Intra-body_site_correlations_between_common_components  #@NEW_LINE#@#  
Histograms of the correlations between  and , conditioned on body site, computed from observed covariance matrices (top row) and randomized covariance matrices (bottom row).  #@NEW_LINE#@#  These plots show that the niche availabilities obtained from the observed data are approximately uncorrelated, whereas those inferred from randomized covariance matrices are not.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1005435.s004  #@NEW_LINE#@#  
(TIFF)  #@NEW_LINE#@#  

S5_Fig_Correlation_between_taxonomic_and_ecological_distances  #@NEW_LINE#@#  
Histogram of the correlation between the taxonomic distance and ecological distances computed from randomized covariance matrices.  #@NEW_LINE#@#  The correlation obtained with the observed data is shown as a dotted red line.  #@NEW_LINE#@#  The true correlation lies far outside the distribution obtained from randomization.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1005435.s005  #@NEW_LINE#@#  
(TIFF)  #@NEW_LINE#@#  

S6_Fig_Schematic_comparison_of_CoCA_and_PCA  #@NEW_LINE#@#  
Each species corresponds to a point in a high dimensional niche space.  #@NEW_LINE#@#  Fluctuations in the availabilities of the niches from person-to-person cause fluctuations in the relative abundances of the species.  #@NEW_LINE#@#  If the distribution of niche availabilities does not depend on the bodysite (e.g.  #@NEW_LINE#@#  gut, skin, etc) then the log-ratio transformed abundances are Gaussian distributed, and the structure of niche space can be inferred using Principal Components Analysis (PCA) by finding the set of axes with the largest variation.  #@NEW_LINE#@#  If the distribution of the niche availabilities does depend on the bodysite, however, then the log-ratio transformed abundances are drawn from mixture of Gaussians and maximum likelihood fitting of the model identifies a common set of axes, or common components, that approximately diagonalize the covariance matrices in each of the bodysites.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1005435.s006  #@NEW_LINE#@#  
(TIFF)  #@NEW_LINE#@#  

S7_Fig_Comparison_of_CoCA_and_PCA_on_the_HMP_data  #@NEW_LINE#@#  
A) Percentage of variance explained in each bodysite as function of the number of common components.  #@NEW_LINE#@#  B) Projecting onto two common components with large inter-bodysite differences and small intra-bodysite variation separates the bodysites into coherent clusters.  #@NEW_LINE#@#  C) Distances between species computed from CoCA are strongly correlated with taxonomy.  #@NEW_LINE#@#  Note that parts A-C are reproduced from the Main Text to facilitate comparison with PCA.  #@NEW_LINE#@#  D) Percentage of variance explained in each bodysite as function of the number of principal components.  #@NEW_LINE#@#  E) Projecting onto the two largest principal components fails to separate the bodysites into coherent clusters.  #@NEW_LINE#@#  F) Distances between species computed from PCA are only weakly correlated with taxonomy.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1005435.s007  #@NEW_LINE#@#  
(TIFF)  #@NEW_LINE#@#  

S8_Fig_Feature_selection_path_of_the_Bayesian_Ising_Approximation  #@NEW_LINE#@#  
Posterior probability that each figure (i.e., KEGG pathway) is relevant for computing the ecological distance between species as a function of the variance of the prior distribution (i.e., the inverse of the regularization parameter).  #@NEW_LINE#@#  The pathways with a posterior probability greater than 0.95 when the inverse regularization parameter is one (i.e, */ = 1) are shown in red.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1005435.s008  #@NEW_LINE#@#  
(TIFF)  #@NEW_LINE#@#  

S9_Fig_Comparison_of_BIA_to_Monte_Carlo_simulations  #@NEW_LINE#@#  
Posterior probabilities estimated using the BIA compared to those computed with Monte Carlo simulations for  = *.  #@NEW_LINE#@#  Four pathways (shown) reach a posterior probability of 0.95 for Monte Carlo, but not for BIA.  #@NEW_LINE#@#  All pathways that reached the 0.95 threshold for relevance with the BIA also reached the relevance threshold with Monte Carlo.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1005435.s009  #@NEW_LINE#@#  
(TIFF)  #@NEW_LINE#@#  

S1_Text_Extended_sections_on_theory_and_materials_and_methods  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1005435.s010  #@NEW_LINE#@#  
(PDF)  #@NEW_LINE#@#  

S1_Code_Zip_archive_containing_the_CoCA_code_and_the_processed_HMP_data  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1005435.s011  #@NEW_LINE#@#  
(ZIP)  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
We would like to thank Thomas Gurry for helpful conversations.  #@NEW_LINE#@#  

Author_Contributions  #@NEW_LINE#@#  


Methodology: CKF.  #@NEW_LINE#@#  
Software: CKF.  #@NEW_LINE#@#  
Writing  original draft: CKF TM AMW.  #@NEW_LINE#@#  



References  #@NEW_LINE#@#  



