article id="http://dx.doi.org/10.1371/journal.pcbi.1006223"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
OpenSim: Simulating musculoskeletal dynamics and neuromuscular control to study human and animal movement  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Movement is fundamental to human and animal life, emerging through interaction of complex neural, muscular, and skeletal systems.  #@NEW_LINE#@#  Study of movement draws from and contributes to diverse fields, including biology, neuroscience, mechanics, and robotics.  #@NEW_LINE#@#  OpenSim unites methods from these fields to create fast and accurate simulations of movement, enabling two fundamental tasks.  #@NEW_LINE#@#  First, the software can calculate variables that are difficult to measure experimentally, such as the forces generated by muscles and the stretch and recoil of tendons during movement.  #@NEW_LINE#@#  Second, OpenSim can predict novel movements from models of motor control, such as kinematic adaptations of human gait during loaded or inclined walking.  #@NEW_LINE#@#  Changes in musculoskeletal dynamics following surgery or due to humandevice interaction can also be simulated; these simulations have played a vital role in several applications, including the design of implantable mechanical devices to improve human grasping in individuals with paralysis.  #@NEW_LINE#@#  OpenSim is an extensible and user-friendly software package built on decades of knowledge about computational modeling and simulation of biomechanical systems.  #@NEW_LINE#@#  OpenSims design enables computational scientists to create new state-of-the-art software tools and empowers others to use these tools in research and clinical applications.  #@NEW_LINE#@#  OpenSim supports a large and growing community of biomechanics and rehabilitation researchers, facilitating exchange of models and simulations for reproducing and extending discoveries.  #@NEW_LINE#@#  Examples, tutorials, documentation, and an active user forum support this community.  #@NEW_LINE#@#  The OpenSim software is covered by the Apache License 2.0, which permits its use for any purpose including both nonprofit and commercial applications.  #@NEW_LINE#@#  The source code is freely and anonymously accessible on GitHub, where the community is welcomed to make contributions.  #@NEW_LINE#@#  Platform-specific installers of OpenSim include a GUI and are available on simtk.org.  #@NEW_LINE#@#  

Citation: Seth A, Hicks JL, Uchida TK, Habib A, Dembia CL, Dunne JJ, et al.  #@NEW_LINE#@#  (2018) OpenSim: Simulating musculoskeletal dynamics and neuromuscular control to study human and animal movement.  #@NEW_LINE#@#  PLoS Comput Biol 14(7):  #@NEW_LINE#@#  
           e1006223.  #@NEW_LINE#@#  

        https://doi.org/10.1371/journal.pcbi.1006223  #@NEW_LINE#@#  
Editor: Dina Schneidman,  #@NEW_LINE#@#  
Hebrew University of Jerusalem, ISRAEL  #@NEW_LINE#@#  

Received: January 5, 2018; Accepted: May 23, 2018; Published:  July 26, 2018  #@NEW_LINE#@#  
Copyright:  Â© 2018 Seth et al.  #@NEW_LINE#@#  This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.  #@NEW_LINE#@#  
Data Availability: Executables for the OpenSim application are freely available for download from https://simtk.org/projects/opensim.  #@NEW_LINE#@#  Open-source code for OpenSim is available on GitHub at https://github.com/opensim-org/opensim-core (for core libraries and command-line applications) and https://github.com/opensim-org/opensim-gui (for building the graphical user interface and OpenSim distribution).  #@NEW_LINE#@#  
Funding: This work was supported by a) the National Institutes of Health (https://www.nih.gov/) through grants U54 GM072970, R24 HD065690, P2C HD065690, U54 EB020405, R01 HD033929, R01 NS055380, R01 HD046814, and R01 HD046774; b) Defense Advanced Research Projects Agency (DARPA, https://www.darpa.mil/) contracts, including W911QX-12-C-0018 and HR0011-12-C-0111, via subcontract 12-006 from Open Source Robotics Foundation, and c) European Commission (http://cordis.europa.eu/project/rcn/93746_en.html) grant FP7-ICT-248189.  #@NEW_LINE#@#  JLH and CLD received support from the National Science Foundation Graduate Fellowship Program (https://www.nsfgrfp.org); JLH, CLD, CFO, EMA, and JRY received support from the Stanford (University) Bio-X Graduate Fellowship (https://biox.stanford.edu/fellowship-app-info); and CFO received support from the Siebel Scholars Program (http://www.siebelscholars.com).  #@NEW_LINE#@#  The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  
Competing interests:  The authors have declared that no competing interests exist.  #@NEW_LINE#@#  
This is a PLoS Computational Biology Software paper.  #@NEW_LINE#@#  
Introduction  #@NEW_LINE#@#  
By studying the biomechanical structures and neuromuscular control underlying movement, we can discover strategies to prevent injury, treat disease, and enhance performance.  #@NEW_LINE#@#  The benefits are undeniable: an understanding of typical and impaired neuromuscular control has improved rehabilitation for patients after a stroke [1]; musculoskeletal analysis has shown promise as a tool for predicting outcomes of orthopaedic surgeries and for optimizing assistive devices [2, 3]; studies of posture have led to recommendations for establishing safe working conditions to reduce the risk of musculoskeletal injuries, such as carpal tunnel syndrome and low back pain [4, 5]; and biomechanical observations have led to improved technique and performance in swimming [6, 7].  #@NEW_LINE#@#  However, the complex interactions of neural control with musculoskeletal dynamics during the production of movement (Fig 1) pose a significant barrier to making such discoveries.  #@NEW_LINE#@#  A complication is that many quantities of interestincluding neural control signals and joint loadsare difficult or impossible to measure with experiments.  #@NEW_LINE#@#  To advance movement science, researchers desire computational modeling and simulation tools that span disciplines such as anatomy, physiology, neuroscience, kinesiology, mechanics, robotics, and computer science, distributed with permissive software licenses so that discoveries can be widely shared.  #@NEW_LINE#@#  Several open-source software packages (e.g., BTK [8] and OpenMA [9]) provide tools for collecting and analyzing experimental movement data, but have limited support for simulation and optimization tasks.  #@NEW_LINE#@#  While a few groups around the world have developed their own simulation and optimization software tools, these independent approaches limit the exchange of models and algorithms.  #@NEW_LINE#@#  
Movement arises from a complex orchestration of the neural, muscular, skeletal, and sensory systems.  #@NEW_LINE#@#  OpenSim includes computational models of these systems, enabling prediction and analysis of human and animal movement.  #@NEW_LINE#@#  Neural command to muscles, in the form of excitations, can be estimated from controller models or experimental data (e.g., EMG).  #@NEW_LINE#@#  OpenSims Hill-type musculotendon models, which translate excitations into muscle forces, include the forcelength and forcevelocity properties of muscles.  #@NEW_LINE#@#  OpenSim provides the flexibility to represent the wide range of muscle geometry found in animals, and the parameters defining muscle geometry and contraction dynamics can be modified based on experimental data.  #@NEW_LINE#@#  OpenSims underlying Simbody engine for multibody dynamics includes contact models (e.g., to simulate footground interaction) and several solvers/integrators that allow users to generate muscle-driven simulations (forward simulation) or to solve for muscle forces and moments that generate an observed motion (inverse simulation).  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pcbi.1006223.g001  #@NEW_LINE#@#  
OpenSim enables the advancement of movement science by equipping research and clinical communities with biomechanical models and simulation tools in an open-source, extensible, and collaborative platform.  #@NEW_LINE#@#  OpenSims capabilities span four core areas.  #@NEW_LINE#@#  First, users can build, manipulate, and interrogate biomechanical models.  #@NEW_LINE#@#  For example, bone specimens were used to build a musculoskeletal model of the Australopithecus afarensis hand to investigate whether this primate species had sufficient grip strength to make certain stone tools [10].  #@NEW_LINE#@#  Second, OpenSim can be used to simulate musculoskeletal dynamics and neuromuscular control.  #@NEW_LINE#@#  Simulations enable researchers to pursue studies that are difficult to perform experimentally, such as investigating how humans and animals exploit tendon elasticity to make running more efficient [1113] and optimizing the design of implantable mechanisms and assistive devices [1418].  #@NEW_LINE#@#  Third, using solely principles of neuromuscular control and dynamic simulation, OpenSim can be used to predict novel movements and adaptations to novel conditions, without performing any experiments.  #@NEW_LINE#@#  This capability has led to a deeper understanding of muscle coordination during loaded and inclined walking [19], insight into limitations of reflexes in preventing ankle injuries when landing [20], and suggestions of optimal device design to enhance jumping performance [21].  #@NEW_LINE#@#  Fourth, OpenSims modular and extensible design allows researchers to create and share new computational models [22, 23], numerical methods, and simulation tools [2426] that extend the capabilities of the software.  #@NEW_LINE#@#  
In addition to its advanced computational tools, OpenSim provides a collaborative research platform that serves a diverse, global, and expanding user base (Fig 2).  #@NEW_LINE#@#  This active research community is using OpenSim to make scientific discoveries, and is disseminating these results in workshops, webinars, conference presentations, and journal publications.  #@NEW_LINE#@#  The paper describing the first version of OpenSim [27] was cited 322 times in 2016 alone (Google Scholar; accessed June 5, 2017); approximately 3/4 of the citing papers used the software in their study.  #@NEW_LINE#@#  Many of the models, data, and plugins described in these references are publicly shared, enabling one to reproduce, validate, and extend others results.  #@NEW_LINE#@#  There are currently over 180 OpenSim-related projects on simtk.org, a website for sharing biophysical models and software, many of which contain valuable experimental data sets (e.g., [22, 28, 29]).  #@NEW_LINE#@#  OpenSim users also contribute to the community by asking and answering questions on the user forum and by contributing software to the codebase on GitHub.  #@NEW_LINE#@#  Community engagement is critical as user requirements play a substantial role in shaping the software.  #@NEW_LINE#@#  We have developed a suite of teaching materials, which includes (i) a users guide, (ii) dozens of tutorials and examples for training novice users, demonstrating advanced features, and providing templates for starting new studies, and (iii) documentation of the Application Programming Interface (API) for plugin developers and scripting users.  #@NEW_LINE#@#  The software and these teaching materials are used for introducing biomechanics to a broad range of students, from middle-school to graduate-school levels.  #@NEW_LINE#@#  
(A) Locations of visitors to the OpenSim documentation (sessions per country in the 1-year period ending April 21, 2018).  #@NEW_LINE#@#  Since its launch in 2012, the OpenSim documentation wiki has been visited by over 25,000 users from around the world per year [30].  #@NEW_LINE#@#  (B) Publications citing OpenSim by research category (Web of Science).  #@NEW_LINE#@#  Note that journals, and thus citations of OpenSim, may belong to more than one research category.  #@NEW_LINE#@#  According to Google Scholar, OpenSim [27] has been cited 1947 times as of June 13, 2018; based on analysis of the subset of these papers published in 2016, we estimate that 3/4 of these publications make use of the software.  #@NEW_LINE#@#  (C) Cumulative downloads of OpenSim since its release in August 2007.  #@NEW_LINE#@#  35,915 users have downloaded the software as of June 13, 2018 [31].  #@NEW_LINE#@#  World map in (A) created using tools at http://gunn.co.nz/map.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pcbi.1006223.g002  #@NEW_LINE#@#  
This paper describes the design and capabilities of OpenSim and provides a sampling of the types of research questions that can be answered using OpenSim.  #@NEW_LINE#@#  The software was first released in August 2007 as a research tool for generating simulations of movement.  #@NEW_LINE#@#  Early versions of the software were used primarily for studying human gait and exploring the effects of pathologies and treatments [27, 32].  #@NEW_LINE#@#  We have introduced many additional capabilities in recent years, among which are enhancements in four key areas.  #@NEW_LINE#@#  First, new accurate models for modeling muscle contraction dynamics, muscle metabolic power, joint kinematics, and assistive devices have been introduced.  #@NEW_LINE#@#  These models enable users to closely replicate human and animal movements, and to explore metabolic cost under natural and engineered conditions.  #@NEW_LINE#@#  An extensive test suite ensures these models are correctly implemented, robust, and efficient.  #@NEW_LINE#@#  Second, users are now able to explore beyond predefined workflows and create custom studies that combine existing computational tools in new ways.  #@NEW_LINE#@#  For example, users can now access muscle-related variables like moment arms [33], fiber lengths, and passive fiber forces directly from a model, without running a complicated analysis in the OpenSim application.  #@NEW_LINE#@#  This functionality is available through the C++ API as well as MATLAB and Python scripting interfaces, ensuring the tools are accessible to researchers with differing computational backgrounds.  #@NEW_LINE#@#  Third, OpenSim now includes functionality for controlling data flow, such as converting data from motion capture file formats and managing data within a simulation.  #@NEW_LINE#@#  Without the help of third-party tools, users can read in experimental data from files in standard motion capture file formats to plot the data in OpenSim and use it to generate simulations.  #@NEW_LINE#@#  Fourth, the OpenSim desktop application incorporates a modern cross-platform visualizer with tools for creating animations of movement (Fig 3), which provides users with more control over the visualization and allows use on both Windows and Mac operating systems.  #@NEW_LINE#@#  These capabilities enable groundbreaking work in the academic, clinical, and industrial arenas.  #@NEW_LINE#@#  
A graphical user interface provides access to tools for inspecting, modifying, and simulating musculoskeletal models.  #@NEW_LINE#@#  Shown here are the results of muscle-driven simulations of human and chimpanzee walking that were generated by tracking experimental motion capture data.  #@NEW_LINE#@#  OpenSim models can be augmented with passive and active devices to explore designs of exoskeletons.  #@NEW_LINE#@#  (Human model and simulation from Rajagopal et al.  #@NEW_LINE#@#  [34]; chimpanzee model from ONeill et al.  #@NEW_LINE#@#  [35] and unpublished simulation results provided by M.C.  #@NEW_LINE#@#  ONeill and B.R.  #@NEW_LINE#@#  Umberger.)  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pcbi.1006223.g003  #@NEW_LINE#@#  

Design_and_implementation  #@NEW_LINE#@#  
Overview_of_the_software_design  #@NEW_LINE#@#  
Formulating and solving the equations that govern the motion of a neuromusculoskeletal system are daunting, even for experts.  #@NEW_LINE#@#  OpenSim automates the difficult and error-prone task of formulating these equations from a conceptual model and provides tools to solve them (Fig 4).  #@NEW_LINE#@#  We define a Model to be a codified description of the form (topology) and function (dynamics) of a biomechanical system, which can include neural, muscular, and skeletal structures, as well as non-biological components like exoskeletons.  #@NEW_LINE#@#  We capitalize Model here, and similar terms elsewhere, to denote the specific data structure (i.e., class) defined in OpenSim.  #@NEW_LINE#@#  An OpenSim user creates a Model by defining the components of the Model (e.g., rigid bodies and muscles), their properties (e.g., body masses and muscle fiber lengths), and the connections between each of the components (e.g., the femur and tibia bodies in a lower limb model are connected by a knee joint).  #@NEW_LINE#@#  OpenSim then automatically generates a System, which comprises the system of equations that governs the kinematics and dynamics of a Model.  #@NEW_LINE#@#  The System, which does not change during a simulation, is separate from the time-varying State of a Model, which stores the values of the variables in the Models equations of motion (e.g., joint angles, muscle activations, and the stretch of a clutched elastic cord).  #@NEW_LINE#@#  A simulation generates a trajectory of these States in time.  #@NEW_LINE#@#  One can then employ OpenSims Solvers to systematically study Models and their motion.  #@NEW_LINE#@#  For example, one can solve for a set of muscle forces required to track a movement observed experimentally, or integrate the Models equations of motion to compute its trajectory (States) over time.  #@NEW_LINE#@#  
OpenSim is accessible via a desktop application and the API, through C++, Java, MATLAB, and Python interfaces.  #@NEW_LINE#@#  The desktop application (built using the Java interface) comprises a graphical user interface (GUI) and a visualizer, enabling a broad community of users to apply models and simulations to study movement.  #@NEW_LINE#@#  The desktop application provides tools for users to visualize Models and motions via WebGL, interrogate and edit Models, configure and run Solvers, and plot and export simulation results.  #@NEW_LINE#@#  OpenSims command-line executables allow batch processing.  #@NEW_LINE#@#  Extensible Markup Language (XML) files are used to document and store Models and simulation parameters, and human-readable file formats allow users to archive and share simulation results.  #@NEW_LINE#@#  OpenSim is built atop other validated packages.  #@NEW_LINE#@#  OpenSim relies on Simbody to compute the dynamics of multibody systems, which is done using an order-N recursive formulation [3639].  #@NEW_LINE#@#  Additional dependencies include BTK (Coordinate 3D (C3D) file support), SWIG (creating non-C++ interfaces), doxygen (API documentation), Java NetBeans (GUI), JFreeChart (plotting), Jython (GUI scripting), and TinyXML (XML parsing).  #@NEW_LINE#@#  
OpenSim employs several design, implementation, and testing strategies to maintain software quality.  #@NEW_LINE#@#  The softwares object-oriented design strictly limits the scope of each software unit, allowing each to be tested thoroughly in isolation.  #@NEW_LINE#@#  We also use comprehensive unit testing to ensure components are valid (e.g., tests for Components, like Joints, verify that energy is conserved) and can be written to and read from file to maintain backward compatibility with old model files (serialization).  #@NEW_LINE#@#  Regression testing ensures that simulation and analysis results are preserved as the software grows and evolves.  #@NEW_LINE#@#  We employ continuous integration (via AppVeyor and Travis CI) to run our full test suite before accepting proposed changes to the codebase.  #@NEW_LINE#@#  

Biologically_accurate_models  #@NEW_LINE#@#  
OpenSim includes computational models of muscle, biological joints, and other musculoskeletal structures that are based on decades of research.  #@NEW_LINE#@#  Muscle mechanics, muscle architecture, and joint kinematics can be defined and modified to represent a wide variety of human and animal musculoskeletal structures.  #@NEW_LINE#@#  These capabilities are useful for modeling muscle spasticity and contracture in children with cerebral palsy [40], the unique musculoskeletal structures of animals to understand how ostriches run at high speed and with high metabolic economy [12], and in many other computational studies.  #@NEW_LINE#@#  Models of muscle mechanics have typically been validated against experimental data obtained from animals (e.g., the soleus muscle of rats; see Fig 5).  #@NEW_LINE#@#  These models have been adapted for studying human movement and can likewise be adapted to study a diversity of other animals.  #@NEW_LINE#@#  We have used recent experimental studies to improve previously published models and continue to add new models to expand the possible research applications of OpenSim.  #@NEW_LINE#@#  For example, biomechanical joints [38] compute accurate joint kinematics and reaction forces for the lower extremity (e.g., the knee [41, 42]), the spine and neck [43], and the shoulder [44].  #@NEW_LINE#@#  The muscle models in OpenSim capture activation dynamics, the forcelength and forcevelocity relationships, and muscletendon dynamics [45].  #@NEW_LINE#@#  Recent enhancements improve the computational speed and numerical stability of the muscle models as well as their agreement with in vitro testing of rat muscles [46].  #@NEW_LINE#@#  Muscle metabolics models [13, 4749] in OpenSim allow users to estimate muscle-level and whole-body energetics during movement.  #@NEW_LINE#@#  Neurophysiological structures and controllers, such as goal-directed and tracking (Computed Muscle Control; CMC) controllers [50] and a reflex controller [20], enable users to generate muscle-driven simulations of observed motions and to predict human and animal movement.  #@NEW_LINE#@#  
To ensure our models and simulations are biologically accurate, we validate our simulation results by comparing with experimental measures and other independent models and simulations (Fig 5).  #@NEW_LINE#@#  We also make all of our simulation and experimental data freely available so others can perform independent testing.  #@NEW_LINE#@#  Members of the OpenSim community are helping to validate models and simulations by performing sensitivity studies [52], developing benchmarks for multi-body system analysis [53], and analyzing parameter uncertainty [54].  #@NEW_LINE#@#  

Custom_simulation_studies  #@NEW_LINE#@#  
OpenSim uses a modular Component and Solver architecture.  #@NEW_LINE#@#  Users can create custom simulation studies that combine existing computational tools in new ways, and write new computational tools that extend the built-in capabilities of OpenSim.  #@NEW_LINE#@#  
OpenSim Components employ the composite design pattern [55], enabling users to assemble and combine models of musculoskeletal structures, exoskeletons, and implantable mechanisms to compute and report values of interest (Fig 6).  #@NEW_LINE#@#  A Component is a self-contained part of a Model that describes a physical structure or phenomenon and its contribution to the Models equations of motion.  #@NEW_LINE#@#  A variety of Components are built into OpenSim, including rigid bodies, joints, constraints, controllers, actuators, contact models, and springs.  #@NEW_LINE#@#  The computational models of muscle, biological joints, and other musculoskeletal structures described in the previous section are also Components.  #@NEW_LINE#@#  An OpenSim user builds a Model by specifying an interconnected set of Components.  #@NEW_LINE#@#  For example, a femur Body and a tibia Body are connected by a knee Joint, all of which are contained by the Model.  #@NEW_LINE#@#  This modular architecture allows users to systematically compose complex models from simpler submodels.  #@NEW_LINE#@#  The properties of the Component (e.g., the mass and inertia tensor of a Body) can be written to and read from a file (as XML), facilitating model archiving, editing, and sharing.  #@NEW_LINE#@#  Furthermore, users can write and share their own Components to extend OpenSim.  #@NEW_LINE#@#  For example, van der Krogt and colleagues created and validated a muscle spasticity controller and shared it as an OpenSim plugin on simtk.org [40].  #@NEW_LINE#@#  
OpenSim includes several inverse and forward Solvers to compute quantities of interest from a Model.  #@NEW_LINE#@#  For example, a forward dynamics Solver can be used to integrate model dynamics (i.e., state derivatives) forward in time to generate a trajectory of States.  #@NEW_LINE#@#  By incorporating reflex and other neurophysiological controllers, users can generate de novo movements.  #@NEW_LINE#@#  Alternately, inverse kinematics and dynamics Solvers determine the generalized coordinates (e.g., joint angles) and forces, respectively, that are consistent with external measurements (e.g., experimental marker trajectories from a motion capture system and ground reaction forces).  #@NEW_LINE#@#  OpenSims novel Component design provides access to the underlying dynamic equations, along with quantities like contact forces and metabolic cost, allowing users to extend OpenSim by creating custom Solvers.  #@NEW_LINE#@#  For example, single-shooting (e.g., [1921]) and direct collocation (e.g., [5660]) methods have been applied to predict movements like walking and jumping that optimize a user-determined objective (e.g., minimizing metabolic cost or maximizing jump height).  #@NEW_LINE#@#  

Data_flow  #@NEW_LINE#@#  
OpenSim provides users with flexibility and control when both inputting data, such as experimental measurements that drive a simulation, and outputting results of interest, such as joint angles and muscle forces.  #@NEW_LINE#@#  FileAdapters provide the capability to import data from common file formats (e.g., C3D, CSV, and TRC) and can be extended by developers to support new file types.  #@NEW_LINE#@#  Any Component can generate Outputs (e.g., a Muscle can output its force-generating capacity), which users can report to an internal table, a file, or the console using a Reporter.  #@NEW_LINE#@#  OpenSim also provides tools to manage the exchange of data within a simulation.  #@NEW_LINE#@#  Any Output generated by a Component (e.g., a Muscles fiber length) can be received by another Component as an Input (e.g., a stretch-based reflex Controller that generates an excitation signal based on a Muscles fiber length as an Input).  #@NEW_LINE#@#  DataTables are in-memory containers that can be used to store experimental and simulation data (e.g., marker locations, muscle-fiber lengths, and excitation signals) as columns of time series and their related metadata, such as column labels and units of measurement.  #@NEW_LINE#@#  

Model_visualization  #@NEW_LINE#@#  
Visualization of models and simulations is vital for interpreting, troubleshooting, and communicating results.  #@NEW_LINE#@#  OpenSims WebGL visualizer (see Fig 3) uses a modern graphics rendering pipeline, which provides features such as lighting, shadows, and textures, along with cross-platform support.  #@NEW_LINE#@#  Components can be visualized with analytic geometry (e.g., spheres, cylinders, and boxes; see the exoskeleton in Fig 3) that is straightforward to define, in addition to mesh-based geometry (e.g., bone meshes).  #@NEW_LINE#@#  


Results  #@NEW_LINE#@#  
OpenSim is enabling researchers from diverse fields to gain insight into human and animal movement.  #@NEW_LINE#@#  Since its first release, OpenSim has been used as a modeling and visualization tool to examine the functional roles of individual muscles in human gait and to understand the effect of treatments on patients with gait disorders caused by cerebral palsy and stroke [2, 6171].  #@NEW_LINE#@#  Open access to human and animal models and recent improvements to the software (see Design and implementation) have expanded the scope of studies that are performed with OpenSim.  #@NEW_LINE#@#  Comparative biologists are using OpenSim to study relationships between form and function in animals [12, 7276], and engineers are using OpenSim to design and analyze assistive devices [1417].  #@NEW_LINE#@#  Researchers are also using OpenSim to create models of reflexes and spinal circuits [20, 40, 77, 78] to understand movement disorders or prevent injury.  #@NEW_LINE#@#  OpenSim is being integrated into larger simulation and experimental frameworks for research in ergonomics [79], assistive robotics [8082], and neurorehabilitation [78], where a model of human or animal movement is integral to the design of workspaces, devices, and treatments.  #@NEW_LINE#@#  The four examples below represent the range of studies enabled by recent advances in OpenSim.  #@NEW_LINE#@#  
Example_1__Form_and_function  #@NEW_LINE#@#  
OpenSim is being used to discover relationships between form and function that explain how humans and animals move.  #@NEW_LINE#@#  For example, Rankin and colleagues [12] investigated the mechanisms responsible for the impressive speed, agility, and efficiency of the fastest running biped: the ostrich.  #@NEW_LINE#@#  The researchers constructed a musculoskeletal model of the ostrichs lower limb (Fig 7A) and used an inverse approach in OpenSim to compute the muscle forces and mechanical work required to track experimental measurements of walking and running.  #@NEW_LINE#@#  Their analysis revealed that the biarticular muscles crossing both the hip and knee were the primary contributors to propulsion during stance, based on the large positive work they generate (Fig 7B, biarticular hip/knee).  #@NEW_LINE#@#  In contrast, the uniarticular knee extensors acted like brakes, performing negative work.  #@NEW_LINE#@#  The digital extensor muscleswhich cross several joints, including the ankle and the metatarsalphalangeal jointsand their compliant tendons acted like springs by storing energy (performing negative work) in early stance and releasing energy (performing positive work) in late stance, particularly during running (Fig 7B, digital flexors).  #@NEW_LINE#@#  The model, experimental data, and simulation procedures to reproduce their results are available on Dryad [83].  #@NEW_LINE#@#  Analogous studies have been performed for other extant [35, 74, 75, 84] and extinct animals [10] to relate musculoskeletal form to function.  #@NEW_LINE#@#  

Example_2__Device_design  #@NEW_LINE#@#  
OpenSim is being used to design implantable and exoskeletal devices.  #@NEW_LINE#@#  For example, Homayouni and colleagues [14] used OpenSim to prototype new passive, implantable mechanisms for hand tendon transfer surgery to improve grasp performance and restore function in patients with partial paralysis of the upper extremity.  #@NEW_LINE#@#  The goal of the mechanisms is to achieve a grasp that evenly distributes forces between the fingersa key limitation of current tendon transfer procedures.  #@NEW_LINE#@#  The researchers modeled an artificial tendon network and a lever mechanism (Fig 8A and 8B), both of which act to distribute force from the attached extensor carpi radialis longus (ECRL) muscle among four tendons in the hand.  #@NEW_LINE#@#  They performed forward dynamics simulations of grasping tasks, where the motion was not prescribed but evolved based on the activation of the ECRL muscle.  #@NEW_LINE#@#  They examined the resulting kinematics of the digits of the hand and the forces applied to a grasped ball.  #@NEW_LINE#@#  Both proposed mechanisms allowed for greater motion of the digits (Fig 8C) while maintaining grasp strength comparable to that of healthy individuals.  #@NEW_LINE#@#  Others are using OpenSim to study assistive devices, such as those that assist walking and running [1618], and to improve below-knee prosthetic comfort and performance [85].  #@NEW_LINE#@#  

Example_3__Neural_control  #@NEW_LINE#@#  
The ability to create custom controllers in OpenSim enables users to investigate the role of reflexes in generating movement and preventing injury.  #@NEW_LINE#@#  Consider, for example, ankle sprains, which are the most common acute sport trauma [86].  #@NEW_LINE#@#  Existing interventions have limited success [87, 88], in part because the role of muscle coordination in preventing injury is poorly understood [20].  #@NEW_LINE#@#  DeMers and colleagues used OpenSim to compare the effectiveness of reflex control and preparatory co-activation in preventing ankle injuries.  #@NEW_LINE#@#  The authors simulated many landing scenarios, including those too dangerous to study experimentally.  #@NEW_LINE#@#  Their simulations used a full-body musculoskeletal model with muscle stretch reflexes and preset muscle activation controllers (Fig 9A).  #@NEW_LINE#@#  The model also included an elastic foundation contact model to compute footfloor contact forces, and passive force elements that modeled the mechanics of ankle ligaments.  #@NEW_LINE#@#  Over a wide range of simulated landing scenarios, they found that strong preparatory co-activation of the ankle evertors and invertors prior to ground contact prevented the ankle inversion angle from exceeding injury thresholds (Fig 9B).  #@NEW_LINE#@#  Conversely, even superhuman stretch reflexes were too slow to generate adequate eversion moments before the simulations reached the threshold for inversion injury (Fig 9C).  #@NEW_LINE#@#  These results suggest that training interventions to protect the ankle should focus on stiffening the ankle with muscle co-activation prior to landing.  #@NEW_LINE#@#  The musculoskeletal and neuromuscular controller models, software, and simulation results from this study are freely available [23].  #@NEW_LINE#@#  Previous studies using OpenSim have provided controller-driven simulations to examine the changes in muscle function due to factors like muscle spasticity [40] or surgical intervention [6365, 77].  #@NEW_LINE#@#  Further, by applying optimization to select controller parameters, researchers have been able to predict human-like movements [21] and adaptations to varying physiological and environmental conditions [19].  #@NEW_LINE#@#  

Example_4__Multidisciplinary_research  #@NEW_LINE#@#  
OpenSim enables investigators to incorporate musculoskeletal models into multidisciplinary simulation studies that require expertise and tools from diverse fields, such as neuroscience [78], ophthalmology [89], and humanmachine interaction [80].  #@NEW_LINE#@#  For example, electrical epidural stimulation has shown promise for restoring some voluntary function in individuals with spinal cord injury (SCI; Fig 10); however, the mechanisms by which the therapy enables modulation of muscle activity are poorly understood.  #@NEW_LINE#@#  Moraud et al.  #@NEW_LINE#@#  [78] used simulations to uncover potential mechanisms by which the stimulation can restore standing and walking, and inform the design of new stimulation patterns to improve function.  #@NEW_LINE#@#  OpenSim was integrated into a larger computational framework to provide biomechanically accurate estimates of muscle stretch in rats during locomotionkey inputs to the computational spindle circuit model of Moraud et al.  #@NEW_LINE#@#  The simulations revealed that epidural stimulation modulated muscle activity by interacting with muscle spindle feedback circuits such that increments in frequency ranging from 10 to 100 Hz led to a linear increase in the mean firing rate of both sensory and motor neurons.  #@NEW_LINE#@#  A comparable modulation in motor output was observed when increasing electrical epidural stimulation amplitude.  #@NEW_LINE#@#  These characterizations enabled the investigators to design phasic stimulation strategies for rats with incomplete and complete SCI, thereby reducing gait asymmetry and restoring balance in spinalized rats.  #@NEW_LINE#@#  Their findings and stimulation techniques could eventually help humans regain mobility after SCI.  #@NEW_LINE#@#  


Availability_and_future_directions  #@NEW_LINE#@#  
OpenSim is an open-source project with dozens of contributors and thousands of users.  #@NEW_LINE#@#  The OpenSim source code is available under the permissive Apache License 2.0, making OpenSim suitable for any academic, commercial, government, or personal use (some dependencies have more restrictive licenses).  #@NEW_LINE#@#  The source code is available on GitHub at https://github.com/opensim-org/opensim-core and https://github.com/opensim-org/opensim-gui.  #@NEW_LINE#@#  To make OpenSim accessible to a broad community of users, pre-packaged binaries with a desktop application (GUI and visualizer) are released periodically at https://simtk.org/projects/opensim.  #@NEW_LINE#@#  Documentation for users and developers, teaching materials, examples, musculoskeletal models, the Q&A Forum, and other resources can be accessed through http://opensim.stanford.edu/support/.  #@NEW_LINE#@#  
The recent software developments described above, coupled with the collective effort of the diverse and growing user community, will enable OpenSim to play an integral role in advancing research and design.  #@NEW_LINE#@#  Generating simulations of de novo movements (i.e., predictive simulation) is one area of particular interest.  #@NEW_LINE#@#  For example, providing easier access to predictive simulation would enable rehabilitation researchers to use simulations to guide the design of devices for preserving, restoring, and enhancing movement, and would accelerate the efforts of comparative biomechanists to predict the locomotor patterns of extinct species [91, 92].  #@NEW_LINE#@#  Recent advances in direct collocation [57, 60, 93], fast and accurate impact models [94], and efficient modeling techniques [44] will help bring predictive simulation to a broader audience.  #@NEW_LINE#@#  As demonstrated by Moraud et al.  #@NEW_LINE#@#  [78], neural controllers can be studied experimentally by using a computational model of the musculoskeletal system as the plant in simulations of movement.  #@NEW_LINE#@#  The principles learned from such studies could eventually be used to improve control of implantable devices, prostheses, and exoskeletons (e.g., via real-time sensing and biofeedback).  #@NEW_LINE#@#  OpenSim can provide virtual prototyping capabilities for improving outcomes and reducing development time in clinical applications.  #@NEW_LINE#@#  
As with any open-source project, the future of OpenSim will be determined largely by the participation of the community.  #@NEW_LINE#@#  Our vision is to deepen the understanding of human and animal movement and to accelerate the development of rehabilitative treatments and assistive devices.  #@NEW_LINE#@#  Simulation can help realize this vision.  #@NEW_LINE#@#  Computer-aided design revolutionized the processes of conceptualizing, developing, and manufacturing engineered products from appliances to airplanes.  #@NEW_LINE#@#  We envision that neuromuscular and musculoskeletal simulation will continue to drive the evolution of engineered devices and treatments that assist and interact with people.  #@NEW_LINE#@#  The complexity and diversity of the human (and animal) motor system present fundamental challenges that can be overcome only by a large, diverse, and active community of researchers, engineers, and clinicians.  #@NEW_LINE#@#  This community benefits from models and simulation tools for making discoveries, transferring knowledge, and designing effective technologies.  #@NEW_LINE#@#  OpenSim is poised to support these endeavors.  #@NEW_LINE#@#  

Acknowledgments  #@NEW_LINE#@#  
The authors thank David Delp for illustrating Figs 1, 4 and 6.  #@NEW_LINE#@#  

References  #@NEW_LINE#@#  



