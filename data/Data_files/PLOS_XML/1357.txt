article id="http://dx.doi.org/10.1371/journal.pgen.1006792"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Two extended haplotype blocks are associated with adaptation to high altitude habitats in East African honey bees  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Understanding the genetic basis of adaption is a central task in biology.  #@NEW_LINE#@#  Populations of the honey bee Apis mellifera that inhabit the mountain forests of East Africa differ in behavior and morphology from those inhabiting the surrounding lowland savannahs, which likely reflects adaptation to these habitats.  #@NEW_LINE#@#  We performed whole genome sequencing on 39 samples of highland and lowland bees from two pairs of populations to determine their evolutionary affinities and identify the genetic basis of these putative adaptations.  #@NEW_LINE#@#  We find that in general, levels of genetic differentiation between highland and lowland populations are very low, consistent with them being a single panmictic population.  #@NEW_LINE#@#  However, we identify two loci on chromosomes 7 and 9, each several hundred kilobases in length, which exhibit near fixation for different haplotypes between highland and lowland populations.  #@NEW_LINE#@#  The highland haplotypes at these loci are extremely rare in samples from the rest of the world.  #@NEW_LINE#@#  Patterns of segregation of genetic variants suggest that recombination between haplotypes at each locus is suppressed, indicating that they comprise independent structural variants.  #@NEW_LINE#@#  The haplotype on chromosome 7 harbors nearly all octopamine receptor genes in the honey bee genome.  #@NEW_LINE#@#  These have a role in learning and foraging behavior in honey bees and are strong candidates for adaptation to highland habitats.  #@NEW_LINE#@#  Molecular analysis of a putative breakpoint indicates that it may disrupt the coding sequence of one of these genes.  #@NEW_LINE#@#  Divergence between the highland and lowland haplotypes at both loci is extremely high suggesting that they are ancient balanced polymorphisms that greatly predate divergence between the extant honey bee subspecies.  #@NEW_LINE#@#  

Author_summary  #@NEW_LINE#@#  
Identifying the genes and genetic changes responsible for environmental adaptation is an important step towards understanding how species evolve.  #@NEW_LINE#@#  The honey bee Apis mellifera has adapted to a variety of habitats across its worldwide geographical distribution.  #@NEW_LINE#@#  Here we aim to identify the genetic basis of adaptation in honey bees living at high altitudes in the mountains of East Africa, which differ in appearance and behavior from their lowland relatives.  #@NEW_LINE#@#  We compare whole genome sequences from highland and lowland populations and find that, although in general they are extremely similar, there are two specific chromosomal regions (representing 1.4% of the genome) where they are strongly differentiated.  #@NEW_LINE#@#  These regions appear to represent structural rearrangements that are strongly correlated with altitude and contain many genes.  #@NEW_LINE#@#  One of these genomic regions harbors a set of octopamine receptor genes, which we hypothesize regulate differences in learning and foraging behavior between highland and lowland bees.  #@NEW_LINE#@#  The extremely high divergence between highland and lowland genetic variants in these regions indicates that they have an ancient origin and were likely to have been involved in environmental adaptation even before honey bees came to inhabit their current range.  #@NEW_LINE#@#  

Citation: Wallberg A, Schöning C, Webster MT, Hasselmann M (2017) Two extended haplotype blocks are associated with adaptation to high altitude habitats in East African honey bees.  #@NEW_LINE#@#  PLoS Genet 13(5):  #@NEW_LINE#@#  
           e1006792.  #@NEW_LINE#@#  

        https://doi.org/10.1371/journal.pgen.1006792  #@NEW_LINE#@#  
Editor: Yannick Wurm, Queen Mary University of London, UNITED KINGDOM  #@NEW_LINE#@#  
Received: January 25, 2017; Accepted: May 1, 2017; Published:  May 25, 2017  #@NEW_LINE#@#  
Copyright:  © 2017 Wallberg et al.  #@NEW_LINE#@#  This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.  #@NEW_LINE#@#  
Data Availability: All relevant data are within the paper and its Supporting Information files except for the sequence data.  #@NEW_LINE#@#  All sequence data are available from the NCBI Sequence Read Archive (SRA) under BioProject PRJNA357367.  #@NEW_LINE#@#  The SNP dataset is available in Dryad under doi:10.5061/dryad.jn630.  #@NEW_LINE#@#  
Funding: This work was supported by the Swedish Research Council (2014-5096), the Swedish Research Council Formas (2013-722) http://www.formas.se/, the SciLifeLab Biodiversity Program (2014/R2-49) https://www.scilifelab.se/ to MTW.  #@NEW_LINE#@#  MH was supported by the Deutsche Forschungsgemeinschaft (HA 5499/3-2) http://www.dfg.de/.  #@NEW_LINE#@#  AW and CS did not have independent funding.  #@NEW_LINE#@#  The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  
Competing interests:  The authors have declared that no competing interests exist.  #@NEW_LINE#@#  
Introduction  #@NEW_LINE#@#  
Genetic adaptation to different environmental conditions is a key process in evolution and speciation.  #@NEW_LINE#@#  However, identifying the genetic variants involved in adaptation and the underlying regulatory networks and biological mechanisms by which they impact fitness is challenging.  #@NEW_LINE#@#  There are relatively few instances where the genetic basis of environmental adaptation is well understood [1].  #@NEW_LINE#@#  Some examples where genetic variation has been linked to locally adaptive phenotypic differences are the pigmentation differences in the rock pocket mouse driven by variation in at least one melanocortin receptor [2], the industrial melanism of the peppered moth driven by a transposal element in the cortex gene [3,4] and the adaptive evolution of populations of sticklebacks [5], including the pelvic reduction driven by recurrent deletion of a tissue specific enhancer [6].  #@NEW_LINE#@#  
Studies of highland populations have proven informative for understanding the genetic basis of adaptation [711].  #@NEW_LINE#@#  First, they inhabit different environments in close proximity to lowland populations.  #@NEW_LINE#@#  Genetic exchange or recent ancestry between the highland and neighboring lowland populations is therefore likely to result in low differentiation in neutrally evolving markers between highland and lowland populations, making it easier to distinguish loci involved in local adaptation.  #@NEW_LINE#@#  Secondly, analysis of interconnected populations spanning different habitats affords the opportunity to determine how processes such as convergent evolution [12] or adaptation from standing variation [13] have contributed to their adaptations.  #@NEW_LINE#@#  For example, genomic analysis of genetic adaptation of human populations living at high altitudes on three continents have revealed that convergent evolution involving selection on variants in different genes related to adaptation to hypoxia are responsible for their adaptations [8,1416].  #@NEW_LINE#@#  Conversely, analysis of freshwater adaptation in sticklebacks has implicated that a suite of genetic variants are present in multiple geographically distant localities, implicating selection on standing variation [5,17].  #@NEW_LINE#@#  
Most genes demonstrated to be involved in adaptation have effects on morphology or physiology [1,18].  #@NEW_LINE#@#  However, some studies have also identified putatively adaptive variation involved in differences in fitness related to behavior [19], such as genes that control variation in burrow architectures of Peromyscus mice [20].  #@NEW_LINE#@#  Genome comparisons allow us to identify genes involved in local adaptations to different habitats where the phenotypic nature of these adaptations is not necessarily well characterized [18].  #@NEW_LINE#@#  Many adaptations in social insects are likely to be behavioral [21].  #@NEW_LINE#@#  In particular, honey bees have sophisticated cognitive abilities, which are needed to efficiently perform the diverse set of tasks necessary for optimal functioning of a colony.  #@NEW_LINE#@#  Furthermore, efficient foraging requires recognition of floral scents, location of flowers, association with a food reward and advertising food sources with a characteristic dance [22].  #@NEW_LINE#@#  Optimal foraging strategies are likely to be variable between habitats and subject to selection [23].  #@NEW_LINE#@#  
The honey bee Apis mellifera has a large native range incorporating a wide variety of habitats.  #@NEW_LINE#@#  There is substantial variation in morphology, physiology and behavior across this range, which are likely to represent local adaptations [24,25].  #@NEW_LINE#@#  The mountain regions of East Africa are highly complex in their topography with scattered high mountains, most of them of volcanic origin and comprising of three distinct vegetation belts: montane forest, subalpine heathlands and an alpine zone [26].  #@NEW_LINE#@#  The average annual temperature of mountain rain forest habitats at 2600 m altitude is only 11.2°C, remarkably different from lowland savannah regions below 1500 m (20.8°C) [24].  #@NEW_LINE#@#  
The honey bees found in the mountain forests differ in phenotype compared to the bees of the savannah.  #@NEW_LINE#@#  They have been designated as a separate subspecies A. m. monticola Smith 1961 [27], whereas savannah bees have been assigned to A. m. scutellata Lepeletier de Saint Fargeau 1836 [24].  #@NEW_LINE#@#  Mountain and savannah bees can be distinguished on the basis of morphometrics, although the status of monticola as a distinct subspecies from scutellata has been a matter of debate [2832].  #@NEW_LINE#@#  Bees from colonies identified as monticola tend to be darker in color, larger and less aggressive than scutellata savannah bees [24,27,33].  #@NEW_LINE#@#  Measurement of mating frequencies indicates that levels of polyandry in monticola honey bees are significantly lower than in scutellata [34].  #@NEW_LINE#@#  Descriptions of the behavior of monticola honey bees suggest that they can fly at lower temperatures than scutellata colonies, conserve honey stores during times of reduced nectar flow by reducing brood rearing and are less prone to abandon their nests by swarming or absconding [24,27,32,35,36].  #@NEW_LINE#@#  It is therefore likely that monticola honey bees possess adaptations for life in cool mountain forests.  #@NEW_LINE#@#  
The population history of the mountain bees is debated.  #@NEW_LINE#@#  The mountain refugia hypothesis proposes that mountain bees have survived as small and reproductively isolated populations for thousands of generations [29,31].  #@NEW_LINE#@#  Such isolation can be expected to result in distinctly different patterns of genetic diversity compared to the widespread lowland bees.  #@NEW_LINE#@#  The results of a study based on mtDNA data supported this scenario [31].  #@NEW_LINE#@#  However, a separate study of mtDNA and microsatellites did not identify genetic differences between the monticola honey bees and surrounding lowland populations [28], which could suggest that the phenotypes observed in monticola honey bees represent phenotypic plasticity [28] or that they are determined genetically but have not led to reproductive isolation.  #@NEW_LINE#@#  A perennial hybridization of monticola with scutellata in a transitory zone of altitude has previously been reported [24,27].  #@NEW_LINE#@#  
In this study, we compare whole-genome sequences from 39 worker bees representing two Kenyan mountain areas that are approximately 100km apart: Mt Kenya and Mau (Fig 1).  #@NEW_LINE#@#  Each locality includes unmanaged bees from neighboring highland forest and lowland savannah environments that are separated by approximately 1000m in altitude.  #@NEW_LINE#@#  We aim to clarify the evolutionary origin of these populations and the genetic basis of their adaptation to high-altitude habitats.  #@NEW_LINE#@#  
The monticola bee is associated with the isolated highland forests and the scutellata bee occurs in the surrounding lowland savannahs.  #@NEW_LINE#@#  High mountain peaks where monticola has been found are indicated with black triangles.  #@NEW_LINE#@#  Mount Kenya and Mau boxes indicate sample locations (grey = monticola; yellow = scutellata).  #@NEW_LINE#@#  Mt Kenya Forest (average sample elevation 2,300 m above sea level; n = 10), Mt Kenya Savannah (1,100 m asl; n = 9), Mau Forest (2,900 m asl; n = 10) and Mau Savannah (1,900 m asl; n = 10).  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pgen.1006792.g001  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
Population-scale_sequencing_of_honey_bees_from_highland_and_lowland_habitats_in_Kenya  #@NEW_LINE#@#  
We mapped genome variation in the East African mountain honey bees (A. m. monticola) in order to infer the evolutionary history of the population and identify loci involved in adaptation to altitude.  #@NEW_LINE#@#  We sequenced 39 samples previously collected from four native feral populations [28]: Mt Kenya Forest (MKF, 2,300 m above sea level; n = 10), Mt Kenya Savannah (MKS, 1,100 m above sea level; n = 9), Mau Forest (MF, 2,900 m above sea level; n = 10) and Mau Savannah (MS, 1,900 m above sea level; n = 10) (Fig 1; S1A Table).  #@NEW_LINE#@#  The bees collected from the highland forest localities are referred to as A. m. monticola (hereafter monticola), whereas lowland savannah samples are referred to as A. m. scutellata (hereafter scutellata).  #@NEW_LINE#@#  Samples from the highland and lowland regions could be separated by morphometrics in a previous study [28].  #@NEW_LINE#@#  We produced 490 million short-reads to generate a 463× dataset spanning the sixteen assembled nuclear chromosomes, unplaced contigs and mitochondrial genome (see Materials and methods).  #@NEW_LINE#@#  Some unplaced contigs and the mitochondrion in particular were sequenced at extremely high coverage, inflating the average coverage.  #@NEW_LINE#@#  The assembled nuclear genome was sequenced to 10.4× per sample (80% of the genome was covered by  greater than 5× per sample) and unless indicated otherwise, the results below refer to analyses of this data (S1A Table).  #@NEW_LINE#@#  
We next called single nucleotide polymorphisms (SNPs) across the 39 samples.  #@NEW_LINE#@#  8.6 million biallelic SNPs were retained after filtering and imputation (Table 1).  #@NEW_LINE#@#  For some comparative analyses, we expanded the dataset to include previously published Kenyan honey bee genomes (n = 11; data from [37]) and a worldwide sample of honey bees (n = 98; data from [25]; S1B and S1C Table).  #@NEW_LINE#@#  This makes it possible to position the Mt Kenya and Mau samples among other honey bee populations and detect uniquely divergent regions in highland genomes.  #@NEW_LINE#@#  The expanded dataset was produced using the same methods and spanned 13.6 million SNPs.  #@NEW_LINE#@#  The genome sequence of the Eastern honey bee A. cerana [38] was aligned against the A. mellifera reference genome in order to further facilitate assessments of divergence and distinguish between ancestral and derived variants.  #@NEW_LINE#@#  The corresponding A. cerana sequence was present at 78% of the A. mellifera genome.  #@NEW_LINE#@#  Genome-wide divergence between the two species was estimated as 6.9%.  #@NEW_LINE#@#  
The mountain refugia hypothesis suggests that monticola populations are small relicts that have been reproductively isolated from lowland scutellata bees [31].  #@NEW_LINE#@#  This hypothesis makes predictions about genetic variation in highland bees compared to lowland bees.  #@NEW_LINE#@#  Assuming that small populations have comparatively low effective population sizes (NE), we can expect lower levels of neutral variation in monticola than in scutellata under equilibrium [39,40].  #@NEW_LINE#@#  The number of SNPs detected within each of the four populations ranged between 5.55.9 million, corresponding to nearly identical estimates of nucleotide diversity ( = 0.650.67%/bp), the population mutation rate (w = 0.750.78%/bp) and effective sizes of each population (NE = 470×103488×103) (Table 1).  #@NEW_LINE#@#  We do not observe reduced variation in highland bees.  #@NEW_LINE#@#  
The hypothesis also predicts that highland populations share a common ancestral population and evolutionary history separate from other bees [31].  #@NEW_LINE#@#  Accordingly, we should expect highland genomes to diverge from lowland genomes.  #@NEW_LINE#@#  We therefore calculated genome-wide FST between populations using the Reynolds et al.  #@NEW_LINE#@#  estimator [41].  #@NEW_LINE#@#  FST between the Mt Kenya and Mau monticola and scutellata populations range between 0.05 and 0.068 and they all group with other Kenyan and African bees (neighbor-joining tree; Fig 2A; Table 1).  #@NEW_LINE#@#  Among the Kenyan bees, the monticola populations cluster on a short separate branch in the population tree (Fig 2A).  #@NEW_LINE#@#  Likewise, average pairwise genetic distances (dXY) split monticola and scutellata samples into different groups (Fig 2B).  #@NEW_LINE#@#  While this could indicate limited degrees of independent evolutionary history, we note that the excess distance between monticola and scutellata samples is very small: dXY is only 1.02x higher between any random pair of highland and lowland samples compared with samples drawn within either habitat.  #@NEW_LINE#@#  We thus find that monticola populations do not diverge strongly from other Kenyan bees and that highland and lowland bees appear to be nearly undifferentiated.  #@NEW_LINE#@#  
It should be noted that all Kenyan populations cluster to the exclusion of the Nigerian adansonii and South African scutellata and capensis populations (the sub Saharan bees from [25]).  #@NEW_LINE#@#  Some of this increased divergence may be artificial and result from technical differences in short-read sequencing and mapping technologies used to assemble the extended dataset (Illumina paired-end reads+BWA herein and in [37] vs SOLiD fragments+Lifescope in [25]).  #@NEW_LINE#@#  For instance, the mean FST between the four Kenyan populations (Illumina) and the three European M-group (SOLiD) populations is 0.392, whereas it is 0.358 between the three African populations previously sequenced on SOLiD and the same European populations.  #@NEW_LINE#@#  We therefore estimate the magnitude of this technology-bias to be an increase in divergence of 9%, assuming that the distances should be the same.  #@NEW_LINE#@#  However, this bias does not affect our comparisons of the highland and lowland populations, which were all sequenced on the same technology and processed identically.  #@NEW_LINE#@#  
To determine the relationship between the closely related highland forest and lowland savannah bees, accommodating the possibility of contradictory genealogies across the genome, we inferred FST and the corresponding population interrelationships in 10 kbp segments.  #@NEW_LINE#@#  In contrast to the whole-genome signal, we found that the most common pattern of relatedness in the genome groups populations by locality (40% of windows; Fig 2C).  #@NEW_LINE#@#  The pattern that groups populations by habitat is the least common (29%).  #@NEW_LINE#@#  By partitioning the inference by chromosome, we further found that the latter pattern is recovered at approximately the same frequency on all chromosomes (25%31%) except on chromosome 9, where it is significantly enriched (49%; pless_than105; Fishers exact test; Fig 2D).  #@NEW_LINE#@#  The major pattern of relatedness across the genome is therefore consistent with exchange of genetic material between local highland and lowland populations, whereas signals that cluster the populations by environment are restricted to a smaller proportion of the genome.  #@NEW_LINE#@#  Taken together, these analyses suggest that the extant populations of highland and lowland honey bees have the same evolutionary origin and are not isolated from each other.  #@NEW_LINE#@#  Our results therefore disagree with the mountain refugia hypothesis.  #@NEW_LINE#@#  

Two_distinct_regions_segregate_between_highland_and_lowland_populations  #@NEW_LINE#@#  
Genetic diversity is nearly undifferentiated between highland and lowland populations.  #@NEW_LINE#@#  Nevertheless, highland genomes appear to contain a small set of loci that are different from lowland genomes.  #@NEW_LINE#@#  These are putative targets of natural selection.  #@NEW_LINE#@#  Variants that are shared between the geographically separated highland populations but absent in local and closely related lowland populations could be associated with adaptation to high altitudes.  #@NEW_LINE#@#  We calculated FST (Weir-Cockerham estimator [42]) for every SNP segregating between highland samples and lowland samples in order to produce a high resolution map of differentiation across the full dataset (~29 bp/SNP) and detect such loci.  #@NEW_LINE#@#  The result corroborates the whole-genome estimates above.  #@NEW_LINE#@#  Divergence is low across the genome: genome-wide FST is only 0.036 and 7.7 million (97%) of SNPs have FSTless_than0.1 (Fig 3A and 3B).  #@NEW_LINE#@#  The striking exceptions are two regions on chromosomes 7 and 9, hereafter called r7 and r9.  #@NEW_LINE#@#  Out of the 24,445 SNPs that segregate with FST greater than 0.5, only 4 occur on other chromosomes or outside of these regions (Fig 3A).  #@NEW_LINE#@#  The same divergent regions are identified when the two highland/lowland population pairs are analyzed independently (S1 Fig).  #@NEW_LINE#@#  A strong association between highland and lowland habitats and these two chromosomal regions were detected in a genome-wide association study (GWAS) using PLINK, where SNPs within the r7 and r9 regions are clear outliers from the expected distribution of allele frequency differences between two groups as indicated by a Q-Q plot (S2 Fig).  #@NEW_LINE#@#  
We delineated the r7 and r9 regions by their first and last SNPs with FST greater than 0.5 (Table 2), respectively.  #@NEW_LINE#@#  r7 bridges across four scaffolds and is composed of two blocks that together span 0.573 Mbp close to the start of chromosome 7 (i and ii; Fig 3C).  #@NEW_LINE#@#  Although these blocks are separated by almost 0.9 Mbp and appear to be discontinuous, we suspect that the second smaller block is located on a misoriented scaffold in an ambiguous region of the current assembly.  #@NEW_LINE#@#  This scaffold (7.5) is minus oriented in the reference genome, whereas upstream scaffolds have unknown orientation.  #@NEW_LINE#@#  The high similarity in sample genotypes between the two blocks, as well as their shared gene family components (see below), suggest that it should be reoriented.  #@NEW_LINE#@#  r9 spans 3 scaffolds and 1.639 Mbp on chromosome 9 (Fig 3C).  #@NEW_LINE#@#  FST between highland and lowland populations is ~0.7 and ~0.3 across the r7 and r9, respectively (Fig 3C; Table 2).  #@NEW_LINE#@#  They contain 111,161 SNPs in total, representing only 1.39% of the data, yet exclusion of these SNPs alone removes the split between highland and lowland samples and shifts the interrelationships of the four populations from clustering by environment to cluster by locality (Fig 3D).  #@NEW_LINE#@#  It is therefore clear that these narrow but divergent regions stand out against the genomic background and influence the analyses of the genome-wide interrelationships (see Fig 2B above).  #@NEW_LINE#@#  
The distinct blocks of highly differentiated SNPs with clear boundaries are suggestive of the presence of non-recombining haplotypes with high levels of divergence between them (Fig 3A).  #@NEW_LINE#@#  These patterns are unlikely to result from selective sweeps, which would be expected to result in a gradual decay of LD over shorter genetic distance.  #@NEW_LINE#@#  r7 contains 12,042 SNPS with FST of 0.80.85 but only 2,866 SNPs with FST of 0.50.8 (Fig 3B).  #@NEW_LINE#@#  Likewise, r9 contains 3,587 SNPs with FST of 0.650.7 and similarly to r7, no individual bin with FST greater than 0.5 contains more SNPs than the 0.650.7 bin in the region (Fig 3B).  #@NEW_LINE#@#  The regions therefore appear to be enriched for SNPs at a particular high FST bin, indicating strong association between the segregating variants.  #@NEW_LINE#@#  One explanation for these patterns is that the haplotypes represent structural polymorphisms, such as inversions that prevent recombination occurring between them.  #@NEW_LINE#@#  
To further characterize r7 and r9, we counted the genotypes of every sample at all divergent SNPs (FST greater than 0.5; Table 2).  #@NEW_LINE#@#  Worker honey bees are diploid and at every such SNP, a sample can therefore be homozygous for the reference sequence allele (0/0), homozygous for the non-reference allele (1/1) or heterozygous (0/1).  #@NEW_LINE#@#  The reference sequence is derived from a US managed population and matches the lowland haplotype [43].  #@NEW_LINE#@#  Across both regions, we found that 1/1 genotypes are significantly more frequent in highland bees than in lowland bees: 83.7% (n = 267,947) vs. 2.7% (n = 8,484) in r7 and 74.7% (n = 126,136) vs. 13.4% (n = 21,526) in r9, respectively, showing that highland bees have haplotypes that are strongly enriched for non-reference variants (pless_than105 for both regions; Fishers exact test; Fig 4).  #@NEW_LINE#@#  Notably, we detected several samples that appear to be nearly completely heterozygous across either region: these are heterozygous for  greater than 88% of genotypes (Fig 4).  #@NEW_LINE#@#  We detected a few outlier samples that are homozygous for the opposite haplotype compared to the majority of samples from either environment.  #@NEW_LINE#@#  The same samples are heterozygous or atypical at the two physically linked r7i and r7ii sub-blocks on chromosome 7 (S3A Fig), supporting the idea that they are closely located on the chromosome.  #@NEW_LINE#@#  This pattern pertains to other samples at the independently transmitted chromosome 9.  #@NEW_LINE#@#  We performed principal component analyses (PCAs) using the multidimensional scaling algorithm implemented in PLINK [44] to further evaluate these divergence patterns.  #@NEW_LINE#@#  The PCA was carried out for all SNPs within and outside of the r7 and r9 regions, respectively.  #@NEW_LINE#@#  In accordance with the FST-based analyses, we found that divergence between highland and lowland samples was much higher at r7 and r9 than across the rest of the genome and that outlier and heterozygous samples clustered as predicted (S4 Fig).  #@NEW_LINE#@#  Honey bees have among the highest recorded recombination rates of any animal [45].  #@NEW_LINE#@#  Continuous megabase-scale heterozygosity suggests that they have both a lowland and highland haplotype and that meiotic recombination between them is greatly suppressed.  #@NEW_LINE#@#  
The r7 highland haplotype (r7h) is completely fixed in the Mt Kenya highland samples and absent from the Mt Kenya lowland population, whereas we detect heterozygous samples or outliers in the Mau populations (Fig 4).  #@NEW_LINE#@#  The r9 highland haplotype (r9h) follows similar, albeit less extreme segregation.  #@NEW_LINE#@#  We estimate the average population frequencies of both r7h and r9h to be 93% across highland bees and 8% or 21% across lowland bees, respectively.  #@NEW_LINE#@#  Haplotype frequencies are strongly associated with environment (pless_than105 for both regions; 2 test), corresponding to FST values of 0.832 at r7 and 0.682 at r9.  #@NEW_LINE#@#  
We performed coalescent simulations in order to determine the probability that the extreme differences in haplotype frequencies we observe between populations could occur in the absence of natural selection on these regions.  #@NEW_LINE#@#  We used ms [46] to model the evolution of a highland and lowland population and test this alternative scenario.  #@NEW_LINE#@#  We adopted a basic split model without subsequent gene flow between descendant populations and without recombination.  #@NEW_LINE#@#  Inclusion of these processes would homogenize genetic variation between the descendant populations.  #@NEW_LINE#@#  We applied population demographic parameters inferred from the data to model the split (see Methods) to simulate the evolution of 1 million independent loci across the genome using the same sample size as in our dataset (20 vs. 19 diploids).  #@NEW_LINE#@#  We then estimated FST between populations using the same methods with the empirical dataset.  #@NEW_LINE#@#  The split was inferred to have occurred 28,410 generations ago and the average divergence between simulated populations was very close the empirical data (0.037 vs 0.036).  #@NEW_LINE#@#  However, FST values as high as those observed for the r7 and r9 haplotypes (r7: FST = 0.832; r9: FST = 0.682) were never observed in the simulated data, where the most divergent locus had FST = 0.655 (S5 Fig).  #@NEW_LINE#@#  This indicates that such levels of divergence between two populations are highly unlikely to occur by drift alone under this scenario.  #@NEW_LINE#@#  
It is also important to note that we observe similarly extreme levels of divergence at the r7 and r9 loci in two independent highland/lowland comparisons (Mau forest vs. savannah and Mt.  #@NEW_LINE#@#  Kenya forest vs. savannah).  #@NEW_LINE#@#  There can be no direct contact between the two highland populations due to their geographic isolation, but gene flow can occur between them via the lowland populations, where frequencies of the highland haplotypes are very low.  #@NEW_LINE#@#  The pattern we observe, where the same haplotype variants at two loci are associated with the highland habitat in two independent comparisons is therefore indicative of selection favoring these haplotypes in highland environments.  #@NEW_LINE#@#  The possibility that these patterns could occur in the absence of selection can be ruled out.  #@NEW_LINE#@#  

Segregation_patterns_on_unmapped_fragments  #@NEW_LINE#@#  
About 13% (29 Mbp) of the honey bee reference genome is not placed on any chromosome.  #@NEW_LINE#@#  We assessed these sequences separately and detected 982 additional SNPs with FST greater than 0.5, distributed across 31 scaffolds/contigs (S2A Table).  #@NEW_LINE#@#  We scanned these SNPs for genotype and haplotype patterns consistent with those in r7 and r9 (Fig 4).  #@NEW_LINE#@#  We find that 30 of them can be assigned to either r7 or r9 based on the pattern of segregation at the SNPs: 16 fragments spanning 28.6 kbp and 682 SNPs match r7 and 14 fragments covering 62.5 kbp and 299 SNPs match r9 (S2A Table; S3BS3D Fig).  #@NEW_LINE#@#  The unassigned fragment GroupUn869 contains only a single outlier SNP (FST = 0.52).  #@NEW_LINE#@#  To verify the assignments, we scanned the paired-end data for evidence of split read-pairs that could anchor the unmapped fragments to the regions using Delly2 [47] in translocation mode.  #@NEW_LINE#@#  All 30 fragments assigned to either r7 or r9, but not GroupUn869, contain evidence that place them within haplotype scaffolds or close to their borders (S2B Table).  #@NEW_LINE#@#  Taken together, the results suggest that they may belong to the two regions, possibly extending them by up to 45%.  #@NEW_LINE#@#  

Highland_haplotypes_in_other_parts_of_Kenya_and_across_the_species__range  #@NEW_LINE#@#  
We detect homozygosity for the highland haplotypes in the single monticola bee collected at Mt Elgon and sequenced by Fuller and co-workers[37] (S6A Fig), and currently the only representative from a third Kenyan mountain location.  #@NEW_LINE#@#  The highland haplotypes appear to be absent from coastal or desert populations of Kenya.  #@NEW_LINE#@#  Querying the global dataset, we do not detect the r7h haplotype in any population outside of Kenya (S6B Fig).  #@NEW_LINE#@#  We do however detect genotypes matching r9h heterozygosity in two savannah scutellata samples from South Africa (S6B Fig).  #@NEW_LINE#@#  These samples are heterozygous for  greater than 77% of the outlier genotypes at scaffold 9.7 and have intermediate genetic distances to the Kenyan highland haplotypes compared with South African scutellata homozygous lowland haplotypes (S6C and S6D Fig).  #@NEW_LINE#@#  Interestingly, this pattern is less clear on the upstream 9.5 scaffold, where the two samples and additional South African honey bees appear to be heterozygous for only ~50% of the outlier genotypes (S6D Fig).  #@NEW_LINE#@#  These results suggest the presence of r9h-like haplotypes at low frequency outside of Kenya, which may include additional structural diversity.  #@NEW_LINE#@#  

Highland_and_lowland_haplotypes_are_highly_diverged  #@NEW_LINE#@#  
We assessed genetic differentiation between populations at the r7 and r9 regions.  #@NEW_LINE#@#  For this analysis, we first subsampled the Kenyan data to contain only the individuals that were homozygous for the major haplotype associated with either environment (Fig 4).  #@NEW_LINE#@#  We included sequence variation from other honey bee populations for either region in order to analyze the haplotypes in the context of global haplotype diversity within the species.  #@NEW_LINE#@#  For both regions, we find that the Kenyan lowland bees have haplotypes that are typical for African honey bees (FSTless_than0.10 against other African bees), while the highland haplotypes diverge strongly from African and other subspecies (FST greater than 0.5; Fig 5A and 5B; Table 3).  #@NEW_LINE#@#  Other population interrelationships are consistent with the whole-genome analyses above and previous results (Fig 2A above; [25])  #@NEW_LINE#@#  
We next compared the genetic distance between the two haplotypes in order to estimate timing of their divergence.  #@NEW_LINE#@#  Across the full genome, dXY is 0.67% between any random pair of two haploid genomes (Fig 3D; Table 3).  #@NEW_LINE#@#  At r7 on the other hand, divergence at non-coding sites is 3.34% (95% CIs: 2.97%3.49%, 2,000 bootstrap replicates) between highland and lowland haplotypes, dating the split between them to about 3.2(2.83.3) million years ago (Fig 5C; Table 3) assuming a mutation rate of  = 5.27×109 mutations per base per generation and a one-year generation time.  #@NEW_LINE#@#  For r9, divergence is 1.34% (95% CIs: 1.28%1.36%, 2,000 bootstrap replicates; Fig 5D), corresponding to the haplotypes having diverged about 1.28 (1.221.30) million years ago.  #@NEW_LINE#@#  These molecular clock estimates suggest that the r7 and r9 highland haplotypes have originated independently but are both very old, possibly predating the diversification of modern honey bee populations and the colonization of their current ranges by hundreds of thousands of years [25].  #@NEW_LINE#@#  

Functional_characterization_of_genes_within_the_highland_haplotypes  #@NEW_LINE#@#  
The r7 region has been annotated for 38 gene accessions in the current gene set, the coding regions of which span 46 kbp (8.3% of the haplotype), whereas r9 includes 50 accessions, many of which are uncharacterized, spanning only 23 kbp of coding sequence (1.4% of the haplotype) (S3 Table).  #@NEW_LINE#@#  By comparing fixed variants between haplotypes against the corresponding sites in A. cerana, it is possible to estimate the number of derived changes that have occurred on each haplotype after the split from their common ancestor.  #@NEW_LINE#@#  We inferred that 66% of the 9,941 fixed mutations have taken place on the highland haplotype, indicating higher rates of fixation in this haplotype.  #@NEW_LINE#@#  
To assess functional evolution on each haplotype, we quantified the ratio between fixed non-synonymous and synonymous changes that has occurred on either haplotype since their common ancestor (S3 Table).  #@NEW_LINE#@#  In the r7 region, there are 560 fixed coding differences between highland and lowland haplotypes, 57% (n = 323) of which we infer to have occurred on the highland haplotype.  #@NEW_LINE#@#  Of the derived variants fixed on the highland haplotype, 44% of (142/323) are non-synonymous.  #@NEW_LINE#@#  On the lowland haplotype, only 28% (66/237) of the fixed derived variants are non-synonymous.  #@NEW_LINE#@#  The proportion of non-synonymous variants that are fixed on the highland haplotype is therefore significantly higher than the proportion fixed on the lowland haplotype (Fisher's exact test; pless_than105).  #@NEW_LINE#@#  In the r9 region we only detect 28 fixed mutations.  #@NEW_LINE#@#  Out of these, 21 have occurred on the highland haplotype.  #@NEW_LINE#@#  Of the derived variants fixed on the highland haplotypes, 62% (n = 13) are non-synonymous.  #@NEW_LINE#@#  In the r9 lowland haplotype, only 28% (2 out of 7) variants are non-synonymous.  #@NEW_LINE#@#  These proportions show the same trend as the r7 haplotype, although they are not significantly different.  #@NEW_LINE#@#  It therefore appears that highland haplotypes have accumulated non-synonymous changes at a substantially higher rate.  #@NEW_LINE#@#  
The two divergent regions span many divergent genes and mutations that may alter protein function, making it difficult to identify the specific targets of selection in highland bees with full certainty.  #@NEW_LINE#@#  Both regions contain genes that influence honey bee worker behavior that we consider to be interesting candidate genes for mediating adaptation to the montane forest habitat.  #@NEW_LINE#@#  The r7 region includes genes encoding four octopamine receptors: AmOct1R (oa2), AmOct3R/4R (isoforms X2, X1 & X3) and AmOct2R (on r7ii), which together contain 12 derived non-synonymous mutations in the highland haplotypes (Fig 6A; S3 Table).  #@NEW_LINE#@#  Octopamines are biogenic amines and essential neurotransmitters, modulators and circulatory hormones in invertebrates.  #@NEW_LINE#@#  They interact with specific G protein coupled receptors to increase Ca2+ or cAMP levels and modulate physiology and behavior in response to environmental stimuli [48,49].  #@NEW_LINE#@#  In honey bee workers, octopamine increases responsiveness to sucrose and sensitivity to sensory inputs and regulates olfactory learning and memory formation [5053].  #@NEW_LINE#@#  The r9 region contains genes for encoding several isoforms of calcium/calmodulin-dependent Serine protein Kinase enzyme (CASK; LOC411347; isoforms identified with BLAST; Fig 6B).  #@NEW_LINE#@#  CASK interacts with a second Ca2+/calmodulin kinase, CaMKII, in a fundamental pathway for memory formation that is shared between humans, fly and honey bees [5456].  #@NEW_LINE#@#  We therefore hypothesize that one or both of the divergent haplotypes contain changes to genes that underlie adaptive foraging behaviors at high altitudes.  #@NEW_LINE#@#  Future work could focus on identifying behavioral differences in honey bees bearing contrasting haplotypes at the r7 and r9 loci.  #@NEW_LINE#@#  

Genomic_signal_of_divergent_haplotype_blocks_is_unaffected_by_stringency_of_SNP_calling  #@NEW_LINE#@#  
We observed reduced mapping coverage in many locations across the r7 highland haplotype compared to the lowland haplotype (Fig 6A).  #@NEW_LINE#@#  For r7h samples, the average genotype depth was 9.2× (0.90x the genome average), with 7% of genotypes missing in the original FreeBayes SNP call.  #@NEW_LINE#@#  Among FST greater than 0.5 outlier SNPs, 2% of genotypes were missing.  #@NEW_LINE#@#  For r7l samples, the average genotype depth was 11.9× (1.13x the genome average), with 0.5% missing genotypes.  #@NEW_LINE#@#  Reduced short-read coverage can be expected due to high genetic distance between r7h and the reference genome and the difference in mapping depth is smaller for the less divergent r9 region (Fig 6B).  #@NEW_LINE#@#  Both regions contain a few regions with very high mapping depth that are shared between both haplotypes (Fig 6A and 6B).  #@NEW_LINE#@#  
Structural variants such as duplications/deletions that segregate between populations and the reference genome can alter mapping depths and result in incorrect genotyping.  #@NEW_LINE#@#  To assess the influence of mapping depths for the results, we analyzed a dataset of SNPs where a set of strict filters had been applied.  #@NEW_LINE#@#  We masked all SNPs and base pairs in the genome which had less_than30% or  greater than 30% read depth, compared to the average mapping depth, or where less_than50% of samples had been genotyped by FreeBayes.  #@NEW_LINE#@#  Filters were applied per environment (n = 20 highland vs. n = 19 lowland bees), for each subsample of individuals that were homozygous for either haplotype (Fig 4) or across the Kenyan bee dataset as a whole.  #@NEW_LINE#@#  
The filters retained ~80% of bases across the whole genome and full dataset (156 Mbp/200 Mbp) and for the r9 region (S7A Fig).  #@NEW_LINE#@#  At r7, 62% of the region passed the filter in the highland subsample (vs. 80% in the lowland subsample; S7A Fig).  #@NEW_LINE#@#  Of the original outlier SNPs with FST greater than 0.5, 7,205 (45%) and 5,134 (61%) were retained for r7 and r9, respectively.  #@NEW_LINE#@#  For both r7h and r7l subsamples, the resulting average genotype depth was ~0.95x the genome average and less_than0.1% of genotypes were missing.  #@NEW_LINE#@#  We then re-estimated and compared levels of diversity across the whole genome and the r7 and r9 haplotypes, with or without these extra filters.  #@NEW_LINE#@#  For the same regions, we also compared FST between all highland and lowland bees and re-inferred haplotypes for r7 and r9 (as in Fig 4).  #@NEW_LINE#@#  The results are highly congruent between datasets (S7BS7D Fig).  #@NEW_LINE#@#  We therefore conclude that poorly mapped regions do not drive the patterns of diversity and divergence that we have inferred across r7, r9 or the genome.  #@NEW_LINE#@#  

Haplotype_breakpoint_assessment  #@NEW_LINE#@#  
Detection of haplotype breakpoints can help to disentangle the nature of putative structural variants.  #@NEW_LINE#@#  In fly and mosquito, inversion breakpoints have previously been linked to crossover between repeated sequence and mobile elements [57,58].  #@NEW_LINE#@#  We scanned the genomic regions around the outermost outlier SNPs of each region (Table 2) for patterns of divergent read mapping and repeated motifs.  #@NEW_LINE#@#  These SNPs occur close to scaffold borders and it is possible that the genome assembly is incomplete for these regions.  #@NEW_LINE#@#  
For r7, we find that the first outlier SNP (pos.  #@NEW_LINE#@#  11,056 bp) occurs in a 500 bp region (pos.  #@NEW_LINE#@#  11,00011,500 bp) where scutellata reads map normally but very few monticola reads map (S8A Fig).  #@NEW_LINE#@#  The monticola reads that contain the first outlier SNP are truncated by BWA to ~36 bp and have mate pairs that are either unmapped or mapped to scattered regions in the genome, indicating potentially aberrant alignment.  #@NEW_LINE#@#  Regular monticola read mapping resumes at pos.  #@NEW_LINE#@#  ~11,420 bp.  #@NEW_LINE#@#  The region overlaps with repetitive sequence containing three iterations of a 176 bp AluI-like monomer with starting positions 8,814, 10,709 and 10,885, respectively (S8A Fig).  #@NEW_LINE#@#  This AluI-like element has been experimentally estimated to be a common repeat at honey bee telomeres [59,60].  #@NEW_LINE#@#  The two latter motifs correlate with the extremely high mapping depth observed in our data (Fig 6A).  #@NEW_LINE#@#  The average per-sample coverage across three 100 bp windows between positions 10,70011,000 is 8,300×, approximately 830 times the per-sample genome average (10×).  #@NEW_LINE#@#  This suggests that many AluI-like short reads from across the genome have been mapped to these motifs.  #@NEW_LINE#@#  Within the same region, we identify a 26 bp motif with high probability (aattgataaaggaagggaggaagagg; pless_than6.20 x 1029) using MEME suite [61].  #@NEW_LINE#@#  It is repeated 65 times between positions 8,94210,667 and has high similarities towards a Winged Helix-turn-Helix (HTH) DNA binding protein motif likely containing the optix transcription factor binding site (tgata, relative score = 1), as predicted by JASPAR [62].  #@NEW_LINE#@#  Beside their roles in transcription, proteins with HTH-binding domains are involved in recombination and may cause rearrangements[63,64].  #@NEW_LINE#@#  
The corresponding downstream region of r7 that may contain a haplotype breakpoint occurs around position 1,511,853, where we detect the first outlier SNP in r7ii (Table 2).  #@NEW_LINE#@#  This SNP and the subsequent divergent SNPs are located inside the third intron of the octopamine receptor AmOct2R gene (Fig 6; S8B Fig).  #@NEW_LINE#@#  Due to the strong linkage between r7i and r7ii (S3 Fig), we hypothesize that the first outlier SNP represents one end of the r7 haplotype region and that the 7.5 scaffold should be reoriented to join the octopamine receptor gene family into a continuous block.  #@NEW_LINE#@#  This region does not appear to contain AluI-like fragments or HTH motifs.  #@NEW_LINE#@#  As the7ii border is not as repetitive as the r7i upstream border, we designed a long-range PCR experiment to amplify the third intron of AmOct2R.  #@NEW_LINE#@#  If the intron contains the second breakpoint, we expect to be able to amplify the sequence in most reference-like scutellata samples but not in the rearranged monticola samples.  #@NEW_LINE#@#  We successfully amplified the expected 2 kbp fragments for all scutellata samples from Mt Kenya and Mau predicted to have the reference-like haplotype (n = 19; S8C Fig).  #@NEW_LINE#@#  Amplification failed for all monticola samples from Mt Kenya (n = 10) and four of the Mau samples predicted to be homozygous for the highland haplotypes (S8C Fig).  #@NEW_LINE#@#  However, amplification also worked for four Mau monticola samples predicted to be homozygous for the highland haplotypes.  #@NEW_LINE#@#  These have excess numbers of heterozygous variants for r7ii (S3A Fig), and are heterozygous across the test region before they switch from lowland to highland haplotypes (S8 Fig), indicating breakpoint polymorphism in this region.  #@NEW_LINE#@#  These results strongly suggest the presence of breakpoints within the third AmOct2R intron.  #@NEW_LINE#@#  It is possible that disruption of this octopamine receptor gene has been important for local adaptation in highland bees.  #@NEW_LINE#@#  
The SNP-delineated borders of the r9 region occur very close to scaffold ends (less_than7 kbp).  #@NEW_LINE#@#  In both cases, the outmost SNPs are located within 500 bp from short read alignment gaps (approx.  #@NEW_LINE#@#  pos.  #@NEW_LINE#@#  1,729,290 and 3,468,837) that are shared between highland and lowland bees, suggesting that the data may be incomplete for these regions and that the actual r9 breakpoints are not mapped.  #@NEW_LINE#@#  

No_clear_association_with_haplotype_identity_and_body_color  #@NEW_LINE#@#  
There is a tendency for monticola bees to be darker in color, whereas scutellata bees are more yellow, although color on its own does not distinguish highland and lowland bees and even varies within colonies [28,30].  #@NEW_LINE#@#  We compared the color of our specimens with the identity of their haplotypes at r7 and r9 in order to determine if either of these loci controlled these differences in color (S9 Fig).  #@NEW_LINE#@#  There was no clear association with color at either of the loci.  #@NEW_LINE#@#  Five of the 19 specimens collected in the lowlands have uniformly dark abdomens.  #@NEW_LINE#@#  Of these, three are homozygous for the lowland haplotype at both loci, which would not be predicted if the highland haplotype is associated with dark abdomens.  #@NEW_LINE#@#  Three of the 20 highland specimens have uniformly dark abdomens.  #@NEW_LINE#@#  One of these is heterozygous at the r9 locus, whereas the others are fixed for highland haplotypes at both loci.  #@NEW_LINE#@#  It is therefore clear that there is a much stronger distinction between highland and lowland bees in the genome at r7 and r9 than there is in their color.  #@NEW_LINE#@#  This suggests that, while these loci may have some subtle effect on body color, they are likely associated with adaptations to highland habitats that have greater fitness consequences than differences in color.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
This comprehensive study of the genomes of mountain honey bees in Kenya reveals novel insights into their evolutionary history and population structure.  #@NEW_LINE#@#  Throughout most of the genome, mountain bees are not differentiated from neighboring lowland populations, indicating that they have a recent common origin or are experiencing gene flow (Fig 2).  #@NEW_LINE#@#  Our results therefore contradict the mountain refugia hypothesis [29,31] but are consistent with gene flow between the highland and lowland areas [24,27].  #@NEW_LINE#@#  This evidence indicates that monticola should not be considered a distinct subspecies but rather a regional ecotype tied to mountain forests [32,65].  #@NEW_LINE#@#  
We identify two haplotype blocks, r7 and r9 (on chromosomes 7 and 9, respectively), which segregate strongly between highland bees at two distinct localities and neighboring lowland bees (Fig 3).  #@NEW_LINE#@#  These loci are extreme outliers in terms of levels of genetic differentiation between populations, and compared to the rest of the genome and to coalescent simulations (Fig 3, S2 and S5 Figs).  #@NEW_LINE#@#  These blocks likely represent chromosomal rearrangements such as inversions that provide the basis for adaptation to the mountain forest environment.  #@NEW_LINE#@#  We find divergence between the haplotypes at r7 and r9 to be extremely high, suggesting that they began diverging much earlier than the split between extant lineages of honey bees.  #@NEW_LINE#@#  We hypothesize that candidate genes within these regions that have effects on foraging behavior could provide the molecular basis for local adaptation to montane forest habitats.  #@NEW_LINE#@#  
Inversion_polymorphisms_likely_govern_local_adaptation_in_mountain_honey_bees  #@NEW_LINE#@#  
The presence of long genomic blocks with high divergence between highland and lowland populations with distinct boundaries indicates that the regions harbor two distinct haplotypes.  #@NEW_LINE#@#  This is further supported by analysis of patterns of segregation of highly differentiated SNPs in this region among individuals, which made it possible to identify individuals that were homozygous or heterozygous for the two diverged haplotypes (Fig 4).  #@NEW_LINE#@#  These patterns are indicative of a form of balancing selection, where haplotypes are locally adaptive coupled with repression of interallelic exchange of genetic material through recombination between haplotypes.  #@NEW_LINE#@#  The most likely mechanism to prevent recombination that would lead to the observed pattern of diverged haplotypes, is a structural rearrangement such as an inversion.  #@NEW_LINE#@#  
Only one putative inversion breakpoint (on the r7 haplotype) mapped to known sequence in the honey bee genome assembly.  #@NEW_LINE#@#  We are able to amplify sequence across this breakpoint in lowland bees, but not in most highland bees, consistent with an inversion.  #@NEW_LINE#@#  We infer that the other breakpoint for the r7 haplotype is located close to the end of chromosome 7.  #@NEW_LINE#@#  There are many Alu1-like monomers and a repeated helix-turn-helix motif in the vicinity of this region.  #@NEW_LINE#@#  The Alu family of mobile element has previously been associated with chromosomal rearrangements in mammals [66].  #@NEW_LINE#@#  It is possible that Alu-like repeats cause chromosome instabilities and rearrangements also in other taxa and have been involved in the origin of the highland haplotype in mountain bees.  #@NEW_LINE#@#  We are unable to identify such sequence patterns for the r9 boundaries, which correlate more strongly with scaffold borders and incomplete mapping.  #@NEW_LINE#@#  
There are two non-mutually-exclusive ways in which an inversion could have an effect on phenotype and fitness.  #@NEW_LINE#@#  The first is that the inversion mutation itself has an effect on genome function.  #@NEW_LINE#@#  This could be because the breakpoint disrupts a transcribed region or has an effect on gene regulation.  #@NEW_LINE#@#  The second is that the suppression of recombination is selectively favored because it maintains associations between co-adapted alleles.  #@NEW_LINE#@#  Theory suggests that inversions that capture locally adapted alleles in two populations that are connected by gene flow can quickly spread in a population [67].  #@NEW_LINE#@#  Recent studies suggest that adaptation by inversions or supergenes is more common than previously thought [68,69].  #@NEW_LINE#@#  
There are many examples of structural inversions that are involved in local adaptation.  #@NEW_LINE#@#  For example in sticklebacks [5] several inversions govern local adaptation to fresh water habitats, and are present in many geographically separated regions.  #@NEW_LINE#@#  Adaptation to environmental clines in Drosophila also correlates with the frequency of cosmopolitan inversions, providing a striking example of rapid evolution [70].  #@NEW_LINE#@#  It has been shown that these clines have shifted as a response to global climate change and that increased cold-tolerance may have arisen several times despite the presence of gene flow.  #@NEW_LINE#@#  Among butterfly species, the mimetic wing patterning of Heliconius numata provides a compelling example of chromosomal rearrangements that lead to co-adapted gene complexes involved in adaption and speciation [71].  #@NEW_LINE#@#  A similar mechanism controls Batesian mimicry in the Papilio genus [72,73].  #@NEW_LINE#@#  A polymorphic inversion governs worker behavior and reproductive strategies in the fire ant Solenopsis invicta [74,75].  #@NEW_LINE#@#  
We observe the same haplotypes associated with highland habitats in the two localities studied here (Mau and Mt.  #@NEW_LINE#@#  Kenya) and in another published dataset from Mt.  #@NEW_LINE#@#  Elgon [37] whereas these haplotypes appear to be rare outside of montane forest environments.  #@NEW_LINE#@#  This shared pattern indicates that their high frequencies in highlands is the result of selection on standing variation, rather than selection on new mutations.  #@NEW_LINE#@#  It is similar to the pattern of genetic adaptation observed in sticklebacks, where the same set of genetic variants, including inversions, are associated with freshwater streams and lakes across the world, but are rare in the oceans that connect them [5].  #@NEW_LINE#@#  

Putative_candidate_genes_for_adaptation_to_montane_forest  #@NEW_LINE#@#  
A number of genes located within the r7 and r9 regions are potential candidates for environmental adaptation in highland bees.  #@NEW_LINE#@#  r7 contains four out of five of the honey bee octopamine receptor genes in the genome.  #@NEW_LINE#@#  These are all four cAMP-inducing octopamine -receptors (AmOct1R to AmOct4R; Fig 6A; S3 Table), whereas the single Ca2+ regulating AmOctR1/oa1 is located outside of the region, on chromosome 15 [76].  #@NEW_LINE#@#  Experiments with microinjections have shown that octopamine can modify neuronal responses in different neuropils of the bee brain [52].  #@NEW_LINE#@#  Octopamine signaling affects complex behaviors in bees and has a key role in social division of labor and foraging [77].  #@NEW_LINE#@#  Expression of octopamine receptors correlates with worker tasks and age and experimental application of the amine induces foraging in nurse bees [7880].  #@NEW_LINE#@#  Increased octopamine levels in honey bees positively affects scouting for new food sources or new nest sites [81].  #@NEW_LINE#@#  In particular, octopamine plays a major role in olfactory learning and memory formation in the honey bee [50], important tasks for adapting to different environmental conditions.  #@NEW_LINE#@#  Interestingly, octopamine has also been shown to be important for stabilizing signaling integrity during hypoxic and thermal stress in other insects [82,83].  #@NEW_LINE#@#  The four octopamine receptor genes located within r7 have many fixed differences between highland and lowland bees.  #@NEW_LINE#@#  Moreover, we infer that a rearrangement breakpoint is present in one of these genes that could potentially disrupt gene function (S8 Fig).  #@NEW_LINE#@#  We therefore hypothesize that genetic variants in the octopamine receptors, that exert their effects via mediating foraging behavior, are responsible for selective advantage of the highland version of the r7 locus in montane forests.  #@NEW_LINE#@#  
Another putative candidate for controlling honey bee behavior is the Ent2 gene (LOC55249) on r7, which has been associated with synaptic transmission and associative learning in Drosophila [84] and the Ca2+/calmodulin-dependent Serine protein Kinase (CASK) isoforms encoded by genes at one edge of the r9 region (Fig 6B; S3 Table).  #@NEW_LINE#@#  CASK acts together with CaMKII to affect long-term memory formation in honey bees [56,85].  #@NEW_LINE#@#  Differences in these genes could contribute to foraging performance in highland bees.  #@NEW_LINE#@#  However, we cannot rule out the possibility that the divergent haplotypes have broader functional implications as they include changes to genes with Drosophila orthologues involved in regulating chromatin (transcriptional activator protein Pur-; LOC72639; r7), lipid (calcium-independent phospholipase A2-gamma-like; LOC726656; r7) and polypeptide-folding functions (prefold in subunit 5-like; LOC411936; r9) as well as muscle development (myosin-2 heavy chain; LOC100576864; r9) [86].  #@NEW_LINE#@#  Any of these could be important for adaptation, either independently, or as part of a co-adapted supergene complex, evolving in concert with other genes.  #@NEW_LINE#@#  
In addition to adaptive sequence evolution, highland haplotypes appear to have been affected by more genetic drift than lowland haplotypes.  #@NEW_LINE#@#  First, the levels of genetic variation are much reduced on the highland haplotypes compared to the lowland haplotypes (Table 3; Fig 6): by 76% for r7h vs r7l and by 28% for r9h vs r9l.  #@NEW_LINE#@#  Reduced diversity among highland haplotypes likely equates to lower NE in these haplotypes compared to lowland haplotypes, probably due to them being more geographically restricted.  #@NEW_LINE#@#  Second, highland haplotypes have accumulated considerably more derived non-synonymous variants than lowland haplotypes (S3 Table), which may indicate accumulation of slightly deleterious variants.  #@NEW_LINE#@#  This could reflect that NE of the mountain haplotypes may historically have been lower due to restricted distribution to particular habitats compared to the widespread lowland haplotypes and despite prevalent gene flow across the rest of the genome.  #@NEW_LINE#@#  

Ancient_origin_of_inversions_and_the_evolution_of_mountain_bees  #@NEW_LINE#@#  
High divergence between the haplotypes at r7 and r9 suggests their origin is ancient.  #@NEW_LINE#@#  Divergence between haplotypes at these loci is substantially higher than divergence between the major honey bee lineages found on different continents.  #@NEW_LINE#@#  We estimate r9 to have evolved 1.3 million years ago (MYA) and the r7 3.2 MYA using a molecular clock.  #@NEW_LINE#@#  Both of these dates are considerably older than estimations of the emergence of extant populations of A. mellifera [25].  #@NEW_LINE#@#  There are two main explanations for such an ancient origin.  #@NEW_LINE#@#  First, it is possible that the haplotypes were present in the ancestral population of A. mellifera, before the split of extant lineages.  #@NEW_LINE#@#  They could have been involved in local adaptation before modern lineages came to inhabit their current ranges in Europe, Africa and the Middle East.  #@NEW_LINE#@#  Despite phenotypic similarities to European bees [27], we have not detected the monticola haplotypes outside Africa (Table 3; S6 Fig).  #@NEW_LINE#@#  A second possibility is that the highland haplotype arose from introgression with another related species in the past.  #@NEW_LINE#@#  This scenario is inferred to be the case with the haplotype encompassing the EPAS1 gene in humans, which is responsible for high altitude adaptation in Tibetans and inferred to have arisen by adaptive introgression from archaic humans to modern humans [11].  #@NEW_LINE#@#  In the case of monticola mountain bees, a potential donor population is not known.  #@NEW_LINE#@#  All other Apis species are found in Asia and their native distributions have not overlapped with that of A. mellifera until the beginning of the 20th century when A. mellifera was introduced in East Asian countries.  #@NEW_LINE#@#  

Conclusion  #@NEW_LINE#@#  
Our studies of honey bee genomes from highland and lowland populations reveal patterns that are consistent with pervasive gene flow between them, with the exception of two large and divergent blocks on chromosomes 7 and 9.  #@NEW_LINE#@#  Haplotypes at these loci appear to represent long inversions that are strongly differentiated between populations from different habitats.  #@NEW_LINE#@#  These loci are reminiscent of supergenes that have been demonstrated to govern adaptation in several other species.  #@NEW_LINE#@#  Many genes within these blocks are linked to honey bee behavior.  #@NEW_LINE#@#  In particular, we identify a haplotype breakpoint that disrupts the transcript of an octopamine receptor, part of a family of genes involved in foraging and learning.  #@NEW_LINE#@#  We therefore hypothesize that these loci govern the behavioral traits that are characteristic for mountain bees and likely constitute local adaptations to the highland environment.  #@NEW_LINE#@#  High levels of divergence between haplotypes at both loci indicate an ancient origin, suggesting that they were involved in environmental adaptation before the dispersal of honey bees to their present geographic range.  #@NEW_LINE#@#  


Materials_and_methods  #@NEW_LINE#@#  
Sample_collection_and_DNA_extraction  #@NEW_LINE#@#  
Female worker honey bees from each highland locality in Kenya (eastern slope of Mount Kenya and Eastern Mau Forest) and lowland samples from neighboring locations were collected as part of a previous study [28].  #@NEW_LINE#@#  The highland bees are referred to as A. m. monticola (hereafter monticola), whereas lowland bees are referred to as A. m. scutellata (hereafter scutellata).  #@NEW_LINE#@#  The monticola sampling sites were closed canopy forest areas above 2000m, whereas the corresponding lowland scutellata samples were collected in savannah vegetation or agricultural land surrounded by savannah vegetation (Fig 1; S1A Table).  #@NEW_LINE#@#  We used the Maxwell Tissue DNA Purification Kit (Promega) to extract total genomic DNA from the thorax of single honey bees, each from a different colony.  #@NEW_LINE#@#  Images of individual abdomens were taken using a ZEISS Stereo Microscope unit Stemi 305 with an Axiocam 105 color (Fa.  #@NEW_LINE#@#  Zeiss, Germany).  #@NEW_LINE#@#  

Sequencing_and_read_mapping  #@NEW_LINE#@#  
The 39 DNA samples were barcoded and 2x125 bp paired-end reads were sequenced on an Illumina HiSeq 2500 sequencer.  #@NEW_LINE#@#  Reads were mapped against v4.5 of the honey bee reference genome (Amel_4.5) [43] using the default settings in the BWA v0.7.12 aligner with the mem algorithm [87].  #@NEW_LINE#@#  Read groups and duplicates were tagged and marked with Picard v1.118.  #@NEW_LINE#@#  Indel-realignment and quality score recalibration was performed with GATK v3.3.0 [88], using SNPs from Wallberg et al.  #@NEW_LINE#@#  [25].  #@NEW_LINE#@#  These programs were used with default settings and parameters.  #@NEW_LINE#@#  
Two datasets were produced.  #@NEW_LINE#@#  The first dataset contained genome data only from the 39 new libraries and was used for most analyses comparing Kenyan highland and lowland bees.  #@NEW_LINE#@#  For the second dataset, we used 11 short read archives from [37] (Kenyan samples; NCBI project ID: PRJNA237819; Illumina reads) and 98 archives from [25] (worldwide samples; NCBI project ID: PRJNA236426; SOLiD reads) in order to expand the population sample and facilitate additional comparative analyses.  #@NEW_LINE#@#  The former dataset was mapped with BWA as above, whereas the latter dataset was mapped with Lifescope as in [25].  #@NEW_LINE#@#  See S1B and S1C Table for detailed sample information.  #@NEW_LINE#@#  

SNP_calling_and_imputation  #@NEW_LINE#@#  
We called single-nucleotide polymorphisms (SNPs) across all samples using the haplotype-based variant detector Freebayes v0.9.2016 [89] for both datasets.  #@NEW_LINE#@#  We used the flags -E 0, -X and -u to suppress construction of short multi-nucleotide haplotypes from closely positioned polymorphisms and to avoid making composite polymorphisms.  #@NEW_LINE#@#  We used the flag theta 0.008 to better match the expected population mutation rate estimated in [25], as compared to the human default value (0.001).  #@NEW_LINE#@#  Putative SNPs were filtered for quality by accepting only biallelic SNPs with QUAL scores  greater than 50.  #@NEW_LINE#@#  In addition, we removed known problematic positions where a drone closely related to the DH4 individual used to produce the reference genome had been inferred to be heterozygous in [25].  #@NEW_LINE#@#  As drones are haploid, they should never be heterozygous.  #@NEW_LINE#@#  Such SNPs are errors that indicate problematic regions in the assembly where genotyping is unreliable.  #@NEW_LINE#@#  This filter removed 61,157 SNPs.  #@NEW_LINE#@#  The procedure is detailed in [25].  #@NEW_LINE#@#  The restricted dataset (n = 39 samples) contained 8,593,016 SNPs and the expanded dataset (n = 148) included 13,672,645 SNPs.  #@NEW_LINE#@#  BEAGLE v3.3.2 [90] was used to impute missing variants and phase haplotypes.  #@NEW_LINE#@#  We used the flags iterations = 30, nsamples = 10 and lowmem = true to increase accuracy and reduce memory usage as per the recommendations in the program manual.  #@NEW_LINE#@#  

Variant_annotation  #@NEW_LINE#@#  
Gene models provided by the latest official gene set (OGSv3.2) [43] in GFF format were used to associate SNPs with genes and annotate synonymous and non-synonymous variants in coding sequences.  #@NEW_LINE#@#  In order to determine gene names, orthologues and putative functions, the models were cross-referenced with genes in Amel_4.5,the NCBI Annotation Release 103 (AR103) and a comprehensive set of Drosophila Flybase orthologues detected in [25,86].  #@NEW_LINE#@#  Custom Perl scripts were used to parse the coordinates and label SNPs.  #@NEW_LINE#@#  We aligned the genome sequence of the Eastern honey bee A. cerana (v1.0; from Park et al.  #@NEW_LINE#@#  [38]) against the A. mellifera genome using the whole genome synteny aligner Satsuma v1 [91].  #@NEW_LINE#@#  This allowed us to: i) root phylogenetic trees; and ii) use parsimony to distinguish between ancestral and derived variants at SNPs across the divergent haplotypes.  #@NEW_LINE#@#  In this method, the shared allele between A. mellifera and A. cerana is taken as ancestral and the non-shared allele is taken as derived.  #@NEW_LINE#@#  

Divergence_estimates  #@NEW_LINE#@#  
We used the FST statistic to estimate divergence between populations from pairwise differences in allele frequencies.  #@NEW_LINE#@#  For individual SNPs, we used the FST estimator of Weir and Cockerham [42].  #@NEW_LINE#@#  Outlier SNPs with high FST compared to the genomic background served as a basis for detecting genomic regions segregating between highland and lowland bees.  #@NEW_LINE#@#  We applied the Reynolds FST estimator [41] to produce whole-genome distance matrices between all populations, allowing us to determine whether divergent regions were associated with mutations in highland or lowland bees.  #@NEW_LINE#@#  Reynolds FST was also used to compute divergence in 10 kbp windows along the genome in order to detect local support for conflicting genealogies between Kenyan populations.  #@NEW_LINE#@#  These statistics were estimated using custom Perl scripts.  #@NEW_LINE#@#  Population interrelationships were inferred from genetic distances using the neighbour-joining algorithm [92] as implemented in PHYLIP v3.696 [93] or SplitsTree v4.14.2 [94] using default settings.  #@NEW_LINE#@#  
Average pairwise differences were computed to estimate per-base genetic distance between all samples or between the highland and lowland haplotypes detected on chromosomes 7 and 9.  #@NEW_LINE#@#  These per-base genetic distances were formulated by Nei and Li [95] and are expressed as  when considering nucleotide diversity within populations and dXY when measured between populations or haplotypes.  #@NEW_LINE#@#  Divergence was calculated using custom Perl scripts.  #@NEW_LINE#@#  We applied a constant molecular clock to date the origin of the haplotypes from dXY estimated from presumably functionally neutral variants (those located outside of gene bodies).  #@NEW_LINE#@#  For these calculations, we used a mutation rate  = 5.27×109 mutations per base per generation, which was previously estimated from neutral divergence between A. mellifera and its sister species A. cerana [25].  #@NEW_LINE#@#  We assumed one generation per year as in ref [25].  #@NEW_LINE#@#  We estimated 95% confidence intervals by partitioning the haplotypes into 10 kbp windows and bootstrapping the data using per-window dXY estimates (2,000 replicates per region).  #@NEW_LINE#@#  
We performed a genome-wide association study (GWAS) to study associations between SNPs and the environment, using lowland and highland location for each sample as the case and control phenotype (S1 Table).  #@NEW_LINE#@#  We used the association (assoc) function in PLINK v1.9 [44] to implement the test and plotted the observed associations over the expected assuming a random normal distribution in a Q-Q plot using theadjust andqq-plot flags.  #@NEW_LINE#@#  We also used PLINK to make a principal component analysis inside and outside the putative haplotype inversion regions using the multidimensional scaling algorithm (mds).  #@NEW_LINE#@#  The regions were defined by the intervals provided in Table 2.  #@NEW_LINE#@#  

Diversity_estimates  #@NEW_LINE#@#  
To measure genetic diversity within populations, we estimated  (see divergence section above) and w (Wattersons theta; the population mutation rate) per base for each population [96].  #@NEW_LINE#@#  Locally reduced genetic diversity can be a signal of selection or indicate reduced effective population size at that locus.  #@NEW_LINE#@#  Relative levels of genetic diversity between highland haplotypes (h) and lowland (l) haplotypes on chromosomes 7 and 9 was computed using the equation:  #@NEW_LINE#@#  

Strongly negative values indicate reduced variation in highland haplotypes.  #@NEW_LINE#@#  We used the population mutation rate (w) and the honey bee mutation rate () above to estimate effective population size (NE) using the following equation:  #@NEW_LINE#@#  

Because honey bees are haplodiploid, we used the inheritance scalar of 3 rather than 4, used for diploids.  #@NEW_LINE#@#  

Demographic_simulations  #@NEW_LINE#@#  
We used the program ms [46] to simulate the neutral coalescent under a basic population split scenario under a Wright-Fisher model, assuming no gene flow, no recombination and constant population size.  #@NEW_LINE#@#  In this scenario, a hypothetical ancestral honey bee population split into a highland and a lowland population without secondary contact.  #@NEW_LINE#@#  We used realistic empirical estimates of the model parameters.  #@NEW_LINE#@#  We first estimated the generation time since the split.  #@NEW_LINE#@#  Under a model of neutral divergence of two populations from a common ancestor, it is possible to convert FST into an estimate of time since divergence, measured in units of scaled time, which we define as T = t/3NE, where t is the number of generations since the split.  #@NEW_LINE#@#  The factor of 3 is applicable for haplodiploids.  #@NEW_LINE#@#  T can be estimated using the following formula [41]:  #@NEW_LINE#@#  

The average divergence between highland and lowland honey bees (FST = 0.036) was used to estimate T as 0.01833.  #@NEW_LINE#@#  We next determined the number of independent loci to simulate.  #@NEW_LINE#@#  Excluding gaps and undetermined sites, the 16 honey bee chromosomes span 199.7 Mbp in total.  #@NEW_LINE#@#  Given the extremely high recombination rate across the genome [45], linkage between sites is expected to decay very rapidly and the genome should therefore contain many unlinked loci.  #@NEW_LINE#@#  r2 was previously estimated to decay below 0.05 at distances greater than 200 bp in African honey bees [25].  #@NEW_LINE#@#  We therefore assumed that the 200 Mbp genome would contain 1 million unlinked loci.  #@NEW_LINE#@#  Assuming the population mutation rate w to be 0.0082 per base pair, as estimated from all data (Table 1), we simulated a coalescent process across a theoretical 1 kbp locus (an arbitrarily chosen size) where w is scaled to 8.2.  #@NEW_LINE#@#  We repeated the simulation 1 million times, instructing ms to export 1 segregating site (SNP) per replicate.  #@NEW_LINE#@#  We sampled 40 chromosomes for one descendant population (n = 20 diploid workers) and 38 chromosomes for the other (n = 19 diploid workers).  #@NEW_LINE#@#  Since the coalescent tracks events back in time, the model is implemented using a population join (-ej flag) rather than a population split.  #@NEW_LINE#@#  The simulation was performed with a single command:  #@NEW_LINE#@#  
ms 78 1000000 -t 8.2 -I 2 40 38 -ej 0.01833 2 1 -s 1  greater than  ms.simulation.data  #@NEW_LINE#@#  
Here, we specify to sample 78 chromosomes, repeat the analysis 1 million times, use the 1 kbp scaled mutation rate of 8.2 (-t 8.2), specify that the chromosome count for two populations is 40 and 38, respectively (-I 2 40 38), model a population join between population 2 and 1 at generation time 0.01833 (-ej 0.01833) and export one segregating locus per replicate (-s 1).  #@NEW_LINE#@#  This produced 1 million loci for which we calculated Weir and Cockerham FST individually, as for the empirical data.  #@NEW_LINE#@#  We produced a distribution of these simulated estimates by partitioning them into FST bins of 0.01.  #@NEW_LINE#@#  

Haplotype_breakpoint_assessment  #@NEW_LINE#@#  
Distal outlier SNPs were used delineate haplotypes in each divergent region.  #@NEW_LINE#@#  Read mapping was manually inspected around these coordinates using Tablet 1.16.09.06 [97].  #@NEW_LINE#@#  Repetitive element motifs in the haplotype breakpoint region on chromosome 7 were detected with the BLAST [98] and MEME [61] web services.  #@NEW_LINE#@#  
Some unmapped fragments (aggregated into virtual chromosome GroupUN) had outlier SNPs and genotype patterns consistent with those detected at the divergent haplotypes.  #@NEW_LINE#@#  In order to collect additional lines of evidence that those candidate fragments may belong to these regions, we performed split-read and paired-end analyses delly2 [47] in translocation mode (-t TRA) for the GroupUN and chromosome 7 and 9 BAM files.  #@NEW_LINE#@#  The program was used with default settings and the output VCF file was parsed for links between unmapped fragments and either region.  #@NEW_LINE#@#  
In order to test a breakpoint experimentally, oligonucleotides were developed flanking the putative breakpoint located within Oct2R (GB49696) in chromosome 7 between positions 1,511,194 to 1,513,199.  #@NEW_LINE#@#  Oligonucleotide Ex3in_Ex4_1fw TTTTCTTCTCCCCCTTCTTTTC and Ex3inEx4in_1rev TTCCACTATAACCGCTTTTCC were used in a standard PCR reaction setup using high-fidelity Q5 Taq polymerase (NEB Biolabs, UK) and the following cycle conditions: 98°C 120 sec, 33x 98°C 30 sec, 58°C 25 sec, 72° 90 sec and 72°C 4 min.  #@NEW_LINE#@#  PCR fragments were size separated on a 1.3% agarose gel (0.5x TBE) on 140 voltage for 2.5 h in 0.5x TBE buffer.  #@NEW_LINE#@#  Sequence information of a subset of these PCR fragments were obtained following subsequent standard cloning procedure with pGEM-T vector system (Promega, Germany) and double strand sequencing of clones (GATC Biotech, Konstanz, Germany).  #@NEW_LINE#@#  


Supporting_information  #@NEW_LINE#@#  
S1_Fig_Allele_frequency_differences_between_population_pairs  #@NEW_LINE#@#  
(A) Genome-wide plot of allele frequency differences (FST) of every nuclear SNP segregating between Mount Kenya highland bees (n = 10) and lowland bees (n = 9).  #@NEW_LINE#@#  Divergent regions r7 (chromosome 7; blue) and r9 (chromosome 9; green).  #@NEW_LINE#@#  Black line indicates overall FST across 10 kbp non-overlapping windows.  #@NEW_LINE#@#  (B) Corresponding contrast for Mau highland bees (n = 10) and lowland bees (n = 10).  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pgen.1006792.s001  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S2_Fig_Quantile-quantile_plot_of_a_genome-wide_association_study_between_SNPs_and_highland_and_lowland_habitats  #@NEW_LINE#@#  
SNP p-values associated with the observed (y-axis) and the expected (x-axis) distribution of allele frequency differences between highland bees (n = 20) and lowland bees (n = 19).  #@NEW_LINE#@#  Blue line indicates the distribution where observed data equals expected data (y = x) under ideal assumptions of no population stratification.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pgen.1006792.s002  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S3_Fig_Distribution_of_haplotypes_as_inferred_from_divergent_SNP_genotypes_(n)_across_r7i__r7ii_and_the_unplaced_scaffolds  #@NEW_LINE#@#  
(A) Genotype and haplotype distributions on r7i and r7ii at SNPs that diverge between highland and lowland populations.  #@NEW_LINE#@#  At every genotype, a sample can be homozygous for the reference allele (0/0), homozygous for the non-reference allele (1/1) or heterozygous (0/1).  #@NEW_LINE#@#  Bar plots indicate the proportions of each genotype for all divergent SNPs (FST greater than 0.5).  #@NEW_LINE#@#  Sample order as in Fig 4.  #@NEW_LINE#@#  (B) 16 unplaced scaffolds have similar genotype and haplotype distribution to r7.  #@NEW_LINE#@#  Symbols as in (A).  #@NEW_LINE#@#  (C) 14 scaffolds have similar genotype and haplotype distribution to r9.  #@NEW_LINE#@#  Symbols as in (A).  #@NEW_LINE#@#  (D) One scaffold without similarity to either r7 or r9.  #@NEW_LINE#@#  Symbols as in (A).  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pgen.1006792.s003  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S4_Fig_PCA_clustering_of_samples_using_PLINK_multidimensional_scaling  #@NEW_LINE#@#  
(A) Clustering based on all SNPs outside of the r7 and r9 regions.  #@NEW_LINE#@#  (B) Clustering in the r7 region on chromosome 7.  #@NEW_LINE#@#  Yellow circle indicates samples that are homozygous for the lowland haplotype.  #@NEW_LINE#@#  Grey circle indicates samples that are homozygous for the highland haplotype.  #@NEW_LINE#@#  Pink circle indicates samples that are heterozygous.  #@NEW_LINE#@#  Heterozygous samples and outlier samples with the opposite haplotype compared to the expected are labeled.  #@NEW_LINE#@#  (C) Clustering in the r9 region on chromosome 9.  #@NEW_LINE#@#  Symbols as in B.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pgen.1006792.s004  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S5_Fig_FST_distribution_produced_by_coalescent_simulations_of_a_population_split  #@NEW_LINE#@#  
1 million simulated SNPs were binned according to 0.01 intervals.  #@NEW_LINE#@#  Blue area represents SNP FST distribution (y1-axis).  #@NEW_LINE#@#  Red line is the cumulate proportion of SNPs (y2-axis).  #@NEW_LINE#@#  Black dots indicate the proportion (p) of SNPs above an FST threshold (p = 0.05 is the top 50,000 SNPs; p = 0.01 top 10,000 SNPs; p = 0.001 top 1,000 SNPs; p = 0.0001 top 100 SNPs; p = 0.00001 top 10 SNPs; p = 0.000001 top 1 SNP).  #@NEW_LINE#@#  Blue and green markers indicate the respective haplotype frequency differences at r7 and r9.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pgen.1006792.s005  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S6_Fig_Worldwide_distribution_of_highland_and_lowland_haplotypes  #@NEW_LINE#@#  
(A) Haplotypes detected for the 11 samples sequenced by Fuller et al.  #@NEW_LINE#@#  Color codes and bottom panels as in Fig 4.  #@NEW_LINE#@#  Sample order as in S1B Table.  #@NEW_LINE#@#  (B) A global sample of honey bees from [25].  #@NEW_LINE#@#  Symbols as in Fig 4.  #@NEW_LINE#@#  Sample order as in S1C Table.  #@NEW_LINE#@#  (C) The r9 region for the African samples and subdivided for the two main scaffolds (scaffold 9.5; n = 2,231 SNPs; scaffold 9.7; n = 6,208 SNPs).  #@NEW_LINE#@#  (D) Divergence (dXY) between the two South African (SA) scutellata samples that appear to be heterozygous for the r9h highland haplotype (scu_3 and scu_5) and the Kenyan (KE) bees that are either homozygous for r9h (upper plot) or r9l (lower plot).  #@NEW_LINE#@#  dXY between South African (SA) scutellata samples homozygous for the lowland haplotype and the same Kenyan bees indicated in yellow.  #@NEW_LINE#@#  dXY within either group of Kenyan bees indicated in black.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pgen.1006792.s006  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S7_Fig_Extended_filtering_and_quality_control  #@NEW_LINE#@#  
(A) Proportion of retained sites across the genome or divergent regions r7 and r9 after stringent filtering for mapping depth and sample coverage (see Results section for filters; r7h = r7 highland haplogroup; r7l = r7 lowland haplogroup; r9h = r9 highland haplogroup; r9l = r9 lowland haplogroup).  #@NEW_LINE#@#  (B) Average genetic diversity across the regions in A based on all data or after filtering.  #@NEW_LINE#@#  (C) FST between highland and lowland bees based on all data or after filtering.  #@NEW_LINE#@#  (D) Haplotype patterns for r7 and r9 after filtering (as compared to Fig 4).  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pgen.1006792.s007  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S8_Fig_r7_haplotype_breakpoints  #@NEW_LINE#@#  
(A) Tablet visualization of read mapping across the putative breakpoint at the start of the r7 haplotype using.  #@NEW_LINE#@#  Reads from bees with r7 lowland haplotypes are yellow.  #@NEW_LINE#@#  Reads from bees with r7 highland haplotypes are grey.  #@NEW_LINE#@#  Reads from heterozygous samples are pink.  #@NEW_LINE#@#  Light blue box indicates spuriously mapped region in highland samples and contains the first outlier SNP at position 11,056 bp.  #@NEW_LINE#@#  Dashed blue box indicates a potential breakpoint region where no full read pairs from highland samples map.  #@NEW_LINE#@#  Red bands indicate location of AluI-like elements detected with BLAST.  #@NEW_LINE#@#  (B) SNPs across the octopamine receptor gene AmOct2R (GB49696).  #@NEW_LINE#@#  Gene body depicted in green (thin lines = introns; thick lines = exons).  #@NEW_LINE#@#  Dashed blue line indicates a putative breakpoint and amplification target in intron 3.  #@NEW_LINE#@#  Triangles indicate points where four Mau (MF) samples switch from being heterozygous for highland haplotypes to being homozygous.  #@NEW_LINE#@#  (C) Gel pictures of PCR products after attempting to amplify across the region indicated in (B).  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pgen.1006792.s008  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S9_Fig_Abdominal_pigmentation_in_monticola_forest_highland_bees_and_scutellata_savannah_lowland_bees  #@NEW_LINE#@#  
Stars indicate samples with contrasting haplotypes for r7 (blue) or r9 (green) from the common haplotype in either habitat (see Fig 4).  #@NEW_LINE#@#  Black bars indicate individuals with back/dark pigmentation across all tergites of the abdomen.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pgen.1006792.s009  #@NEW_LINE#@#  
(TIF)  #@NEW_LINE#@#  

S1_Table_Sample_locations_and_sequence_information  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pgen.1006792.s010  #@NEW_LINE#@#  
(XLSX)  #@NEW_LINE#@#  

S2_Table_Possible_locations_of_unplaced_scaffolds_with_outlier_SNPs  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pgen.1006792.s011  #@NEW_LINE#@#  
(XLSX)  #@NEW_LINE#@#  

S3_Table_Divergence_and_substitutions_across_genes_in_highland_and_lowland_haplotypes  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pgen.1006792.s012  #@NEW_LINE#@#  
(XLSX)  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
We wish to thank Washington Njagi for field assistance and Wanja Kinuthia for logistical support.  #@NEW_LINE#@#  We are grateful to Brian Fisher and April Nobile at the California Academy of Sciences for providing the marvelous Automontage pictures of the honey bee worker specimens from Mount Kenya.  #@NEW_LINE#@#  We thank Birgit Gessler, Sandra Gündel and Victoria Seeburger for their enthusiastic technical support.  #@NEW_LINE#@#  The National Council for Science and Technology of Kenya (Permit No.  #@NEW_LINE#@#  NCST/5/002/R/066) and the Kenya Wildlife Service (Permit No.  #@NEW_LINE#@#  KWS/BRM/5001) kindly gave permission to collect the bee samples.  #@NEW_LINE#@#  

Author_Contributions  #@NEW_LINE#@#  


Conceptualization: MH CS MTW.  #@NEW_LINE#@#  
Data curation: MH CS AW.  #@NEW_LINE#@#  
Formal analysis: AW.  #@NEW_LINE#@#  
Funding acquisition: MTW MH.  #@NEW_LINE#@#  
Investigation: MH CS AW.  #@NEW_LINE#@#  
Methodology: AW MTW.  #@NEW_LINE#@#  
Project administration: MTW MH CS.  #@NEW_LINE#@#  
Resources: MTW MH CS.  #@NEW_LINE#@#  
Software: AW.  #@NEW_LINE#@#  
Supervision: MTW MH.  #@NEW_LINE#@#  
Validation: MH CS.  #@NEW_LINE#@#  
Visualization: AW MH.  #@NEW_LINE#@#  
Writing  original draft: AW MTW MH.  #@NEW_LINE#@#  
Writing  review & editing: AW MTW CS MH.  #@NEW_LINE#@#  



References  #@NEW_LINE#@#  



