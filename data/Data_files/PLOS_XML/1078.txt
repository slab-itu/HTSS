article id="http://dx.doi.org/10.1371/journal.pone.0170586"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Automated Remote Focusing, Drift Correction, and Photostimulation to Evaluate Structural Plasticity in Dendritic Spines  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Long-term structural plasticity of dendritic spines plays a key role in synaptic plasticity, the cellular basis for learning and memory.  #@NEW_LINE#@#  The biochemical step is mediated by a complex network of signaling proteins in spines.  #@NEW_LINE#@#  Two-photon imaging techniques combined with two-photon glutamate uncaging allows researchers to induce and quantify structural plasticity in single dendritic spines.  #@NEW_LINE#@#  However, this method is laborious and slow, making it unsuitable for high throughput screening of factors necessary for structural plasticity.  #@NEW_LINE#@#  Here we introduce a MATLAB-based module built for Scanimage to automatically track, image, and stimulate multiple dendritic spines.  #@NEW_LINE#@#  We implemented an electrically tunable lens in combination with a drift correction algorithm to rapidly and continuously track targeted spines and correct sample movements.  #@NEW_LINE#@#  With a straightforward user interface to design custom multi-position experiments, we were able to adequately image and produce targeted plasticity in multiple dendritic spines using glutamate uncaging.  #@NEW_LINE#@#  Our methods are inexpensive, open source, and provides up to a five-fold increase in throughput for quantifying structural plasticity of dendritic spines.  #@NEW_LINE#@#  

Citation: Smirnov MS, Evans PR, Garrett TR, Yan L, Yasuda R (2017) Automated Remote Focusing, Drift Correction, and Photostimulation to Evaluate Structural Plasticity in Dendritic Spines.  #@NEW_LINE#@#  PLoS ONE 12(1):  #@NEW_LINE#@#  
           e0170586.  #@NEW_LINE#@#  

        https://doi.org/10.1371/journal.pone.0170586  #@NEW_LINE#@#  
Editor: Anna Dunaevsky, University of Nebraska Medical Center, UNITED STATES  #@NEW_LINE#@#  
Received: September 7, 2016; Accepted: January 8, 2017; Published:  January 23, 2017  #@NEW_LINE#@#  
Copyright:  © 2017 Smirnov et al.  #@NEW_LINE#@#  This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.  #@NEW_LINE#@#  
Data Availability: All programming code is available via GitHub at https://github.com/mikeusru/mdia.  #@NEW_LINE#@#  The corresponding author may be contacted for data.  #@NEW_LINE#@#  
Funding: This work was supported by the National Institutes of Health (DP1NS096787 to RY and 1F31NS086174 to PRE) and funding from The Max Planck Florida Institute for Neuroscience and the Max Planck Society.  #@NEW_LINE#@#  The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  
Competing interests:  The authors have declared that no competing interests exist.  #@NEW_LINE#@#  
Introduction  #@NEW_LINE#@#  
Structural changes in dendritic spines, tiny postsynaptic protrusions on the dendritic surface of neurons, are considered to be the basis of synaptic plasticity, learning, and memory [15].  #@NEW_LINE#@#  Among several forms of spine structural plasticity, structural long-term potentiation (sLTP) of single dendritic spines has been extensively examined as a structural correlate of functional LTP (fLTP), an electrophysiological model of learning and memory [3, 5, 6].  #@NEW_LINE#@#  Applying two-photon glutamate uncaging at a single dendritic spine induces a rapid and long lasting spine enlargement at the stimulated spine, but not the surrounding spines [3].  #@NEW_LINE#@#  The signaling cascades necessary for sLTP have been studied by combining sLTP imaging with pharmacological and genetic manipulation.  #@NEW_LINE#@#  Both sLTP and fLTP depend on NMDA-type glutamate receptors (NDMAR), Ca2+/Calmodulin-dependent kinase II (CaMKII) and several small GTPase proteins including Ras, Cdc42, Rac1 and RhoA [4, 711].  #@NEW_LINE#@#  However, due to the low-throughput nature of the measurement, the study of sLTP has been limited to only a few proteins, and among more than 1000 proteins expressed in spines [1214], it is largely unknown which ones are necessary for spine structural plasticity.  #@NEW_LINE#@#  
The quantification of long-term structural plasticity of dendritic spines requires imaging single spines over extended periods of time (typically ~1 h), and it is necessary to continuously refocus to the target spines.  #@NEW_LINE#@#  Moreover, in general, imaging and stimulating multiple dendrites over long periods of time has been difficult with regular two-photon microscopy, limiting the throughput of the quantification of spine structural plasticity.  #@NEW_LINE#@#  Thus, it was necessary to develop a system that allows for 1) automatic focus and drift correction for long-term tracking of dendritic spines and 2) imaging and stimulation of several regions of interests (ROIs).  #@NEW_LINE#@#  
Although automated focusing for microscopy is a well-studied topic in literature [1522], most algorithms are designed for highly specific imaging modes and preparations.  #@NEW_LINE#@#  These techniques have been tested under well-defined parameters, therefore, their application in a novel paradigm often results in an overwhelming amount of trial-and-error.  #@NEW_LINE#@#  Algorithms tend to be uniquely suited to either bright-field, phase, or fluorescence microscopy [23].  #@NEW_LINE#@#  A lack of functional specificity for software focusing has led some groups to development more inclusive algorithms [20], but the wide variety of imaging setups and biological preparations leaves these attempts incomplete.  #@NEW_LINE#@#  Hardware focusing systems that correct focus by tracking coverslip location are also commercially available [24], but are incapable of correcting focus drift due to sample deformation which occurs in soft neuronal tissue such as brain slices.  #@NEW_LINE#@#  In order to optimize software focusing for dendritic spine imaging, an automated algorithm selection tool is necessary to best adapt to the optical parameters and tissue characteristics in the experiment.  #@NEW_LINE#@#  In addition, since live neuronal tissue can be highly sensitive to objective movements, it is necessary to use a focusing system without objective movements, e.g.  #@NEW_LINE#@#  an electro-tunable lens (ETL) [2527].  #@NEW_LINE#@#  
Based on the open-source MATLAB imaging suite Scanimage [28] and an ETL, we have developed an automated system to stimulate and image several individual spines over extended periods of time.  #@NEW_LINE#@#  With the implementation of an ETL and custom tracking software, our system avoids any artifacts caused by objective or stage movement.  #@NEW_LINE#@#  We demonstrate that this system allows us to rapidly quantify sLTP in large number of spines.  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
In order to achieve rapid and reliable focusing required for auto-focusing system, we employed ETL to our two-photon microscope by placing it at a conjugate plane of the back-focal plane of the objective (Fig 1A).  #@NEW_LINE#@#  A pre-ETL lens resizes the beam to fit the full aperture of the ETL, while two more lenses serve to resize the beam to fit the galvanometers.  #@NEW_LINE#@#  In this setup, regardless of ETL shape, the beam size is constant at the galvanometers and the back aperture plane of the objective.  #@NEW_LINE#@#  This setup minimizes the loss of beam intensity and spherical aberration.  #@NEW_LINE#@#  
(A) An ETL in the excitation pathway shapes the incoming beam for remote focusing.  #@NEW_LINE#@#  Beam shape (red/green) is controlled by curvature of the ETL.  #@NEW_LINE#@#  L2 and L3 lenses are placed to conjugate the ETL to the back aperture of the objective lens.  #@NEW_LINE#@#  (B) ETL voltages are correlated to linear stage movements using an automated alignment routine.  #@NEW_LINE#@#  (C) A GUI controls ETL shape.  #@NEW_LINE#@#  Voltage values are translated to Z position, and the relative shift of the imaging plane is previewed in a 3D graphic.  #@NEW_LINE#@#  Z values corresponding to voltages are set either by a linear constant or polynomial curve.  #@NEW_LINE#@#  (D) Tilted imaging is previewed by adjusting voltage range, as the ETL voltage is altered in phase with the slow-scanning galvanometer.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0170586.g001  #@NEW_LINE#@#  
Initial tuning of the ETL is accomplished by stepwise movement of a Z motor combined with an autofocusing step using solely the ETL.  #@NEW_LINE#@#  The resulting voltages used to control the ETL are automatically associated with Z displacement values, while a conversion function is set using either a linear constant or polynomial fitted curve (Fig 1B and 1C).  #@NEW_LINE#@#  ETL focal length is controlled by changing current passing through the lens using a custom interface built into Scanimage using MATLAB (Fig 1C).  #@NEW_LINE#@#  A 3D preview of the imaging plane shows the relative position of the Z plane as a result of ETL offset.  #@NEW_LINE#@#  Finally, by varying the ETL current in phase with the galvanometer scanning cycle, we were able to tilt the imaging plane up to 90°, thus allowing users to capture objects which would otherwise require multiple Z slices [27] (Fig 1D).  #@NEW_LINE#@#  
In order to make long-term imaging possible, we added an interface to compensate for both axial and lateral drift (Fig 2B).  #@NEW_LINE#@#  Before the start of imaging, users define the range, step size, and frequency parameters for an autofocus routine.  #@NEW_LINE#@#  When Z-stacks are collected, images are automatically used for auto-focusing.  #@NEW_LINE#@#  A region of interest (ROI) is defined around the dendritic spine to be stimulated.  #@NEW_LINE#@#  In order to expand the applicability of our autofocus module to various imaging setups, we have included 30 different autofocusing algorithms, previously described by Pertuz et al.  #@NEW_LINE#@#  [29].  #@NEW_LINE#@#  To test the appropriate algorithm for our purpose, we designed an additional application which tests each algorithm against a set of pre-acquired Z stack images, comparing both accuracy and computation time (Fig 2A).  #@NEW_LINE#@#  In order to ensure that the autofocus algorithm is running normally and using the appropriate part of an image, each collected slice is displayed along with its respective ROI and Z position (Fig 2D).  #@NEW_LINE#@#  Finally, lateral drift is measured by comparing the imaged position with a reference image by calculating cross-correlation (8), and corrected by immediately shifting the galvanometer scanning angle.  #@NEW_LINE#@#  While both autofocus and lateral drift correction speeds are dependent on the pixel count of an image, the speed of calculation for a 128x128 pixel image is consistently less than 10 ms (Fig 2C), far exceeding the speed required for most imaging setups.  #@NEW_LINE#@#  
(A) Sample result of the autofocus algorithm selection tool based on 30 Z stacks with 6 slices each.  #@NEW_LINE#@#  All algorithms adapted from Pertuz, et al.  #@NEW_LINE#@#  [29].  #@NEW_LINE#@#  Abbreviations expanded in Table 1.  #@NEW_LINE#@#  Percent relative accuracy (gray bars) indicates standardized mean distance of Z position selected by algorithm vs target.  #@NEW_LINE#@#  100% = no distance, 0% = maximum distance, 50% = distance if position is picked at random.  #@NEW_LINE#@#  Blue lines indicate average time to calculate focus value for each slice.  #@NEW_LINE#@#  (B) Parameters for focus and drift correction are controlled through a GUI.  #@NEW_LINE#@#  Users identify an algorithm, Z range and amount of steps, and whether extra images are collected for autofocus.  #@NEW_LINE#@#  Drift correction can be enabled to use galvanometers (scan shift) or motor repositioning.  #@NEW_LINE#@#  Users also have the option to enable or disable the ETL.  #@NEW_LINE#@#  (C) Reference-based drift correction speed is correlated with pixel size.  #@NEW_LINE#@#  Image resolution indicates pixel count for one dimension of a square image.  #@NEW_LINE#@#  (D) Live updates inform users of the selected focus position (red box) and spine ROI (white box) used to determine relative focus value.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0170586.g002  #@NEW_LINE#@#  
In addition, we designed a user-friendly interface to rapidly find, store, image, and photostimulate multiple positions (Fig 3).  #@NEW_LINE#@#  Either motor or scanning controls are used to identify dendritic spines for photostimulation (glutamate uncaging).  #@NEW_LINE#@#  A central GUI allows users to manage multiple positions and set multiple experimental parameters (Fig 3B).  #@NEW_LINE#@#  As positions are defined, reference images are automatically collected (Fig 3D).  #@NEW_LINE#@#  Once all positions are defined, all motor positions are mapped to galvanometer scanning angles relative to a single motor coordinate which defines the field of view (Fig 3A).  #@NEW_LINE#@#  A separate window allows users to design a timeline for their experiment (Fig 3C).  #@NEW_LINE#@#  The timeline allows users to control imaging frequency, duration, and define when glutamate uncaging will occur to stimulate dendritic spines.  #@NEW_LINE#@#  Timeline events can be staggered between positions to avoid conflict between successive uncaging or exclusive imaging events.  #@NEW_LINE#@#  If the amount of defined positons exceeds the maximum which could be concurrently imaged within a given time constraint, new positions are rotated into the imaging sessions as imaging for other positions is completed (Fig 3C).  #@NEW_LINE#@#  As imaging proceeds, each position is continuously updated using its reference image (Fig 3D), while an automatic re-alignment of the photoactivation ROI to the cell membrane immediately precedes photoactivation (Fig 3E).  #@NEW_LINE#@#  
(A) GUI showing all motor positions that are translated to galvanometer scanning coordinates within a single field of view (FOV, large square).  #@NEW_LINE#@#  (B) A master GUI to keep track of and move between all imaging positions.  #@NEW_LINE#@#  Settings and coordinates can be saved and loaded.  #@NEW_LINE#@#  Z depth is set for each position to automatically modulate uncaging laser power to amounts of tissue interference in brain slices.  #@NEW_LINE#@#  Experimental Notes are automatically saved with each imaging cycle and can be altered to reflect experimental parameters.  #@NEW_LINE#@#  (C) A custom timeline interface allows users to design and preview imaging and (blue, green) and uncaging (red) cycles at each position.  #@NEW_LINE#@#  (D) Sample reference images used for drift correction.  #@NEW_LINE#@#  A zoomed-out reference image (right) is used for initial alignment.  #@NEW_LINE#@#  Threshold intensity values are set so each uncaging ROI (E, red) is shifted appropriately relative to the cell dendrite perimeter (E, blue).  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0170586.g003  #@NEW_LINE#@#  
To test and further optimize the efficacy of our non-motor multi-position imaging system, we measured structural plasticity of dendritic spines in hippocampal CA1 neurons transfected with enhanced green fluorescent protein (EGFP) in organotypic hippocampal slice prepared from mice (Fig 4).  #@NEW_LINE#@#  The lateral and axial drift corrections were successful at tracking most spines over an hour-long imaging session.  #@NEW_LINE#@#  Out of 60 spines which were randomly chosen for analysis, only four drifted out of the field of view over a period of 50 minutes.  #@NEW_LINE#@#  Of the four cases, two involved drastic morphological changes in the dendrite resulting from cell death, while the other two suffered from unusually low fluorescence and high background noise.  #@NEW_LINE#@#  
(Top) CA1 dendrite pre- and post- uncaging.  #@NEW_LINE#@#  Arrow indicates photoactivation ROI.  #@NEW_LINE#@#  Scale = 1m.  #@NEW_LINE#@#  Middle: Average volume change in spines following glutamate uncaging at t = 0.  #@NEW_LINE#@#  Uncaging lasts 60s.  #@NEW_LINE#@#  Bottom: Quantification of transient (13 min) and sustained (2630 min) change in spine volume.  #@NEW_LINE#@#  **** = pless_than0.0001, * = pless_than0.05.  #@NEW_LINE#@#  n = 24 Stimulated spines, 7 neurons.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0170586.g004  #@NEW_LINE#@#  
Although drift correction was effective at keeping the general dendritic region in place, the spine set to be stimulated sometimes moves relative to the dendrite.  #@NEW_LINE#@#  Since glutamate uncaging had to be precisely targeted to the surface of the spine, we added a secondary drift correction method which would relocate the uncaging target to the surface of the spine immediately prior to uncaging (Fig 3E).  #@NEW_LINE#@#  Correction of the uncaging target was achieved by binarizing the image, locating the perimeter of the resulting objects, and moving the uncaging target to the closest spot on the perimeter.  #@NEW_LINE#@#  This allowed automated glutamate uncaging on multiple spines at consistent locations at the spine surface.  #@NEW_LINE#@#  We found that glutamate uncaging induced a rapid increase in volume within few minutes (transient phase) followed by long lasting enlargement (sustained phase), consistent with previous studies [3, 10, 41].  #@NEW_LINE#@#  During the entire imaging session, the user did not need to be present at the microscope, demonstrating the capability of the automated tracking and stimulating software.  #@NEW_LINE#@#  

Discussion  #@NEW_LINE#@#  
We have designed an easily implementable module for Scanimage to allow for multi-position scanning and photoactivation of dendritic spines to study postsynaptic plasticity.  #@NEW_LINE#@#  Furthermore, we described an implementation of an ETL in the excitation path which minimizes the signal loss and distortion.  #@NEW_LINE#@#  The ETL served both to increase imaging speed and remove sample drift caused by rapid stage or objective movements when changing focus.  #@NEW_LINE#@#  Our optical implementation of the ETL as a remote focusing element is combined with a straightforward user interface which is able to align and control the ETL current, and as a result, the axial focus.  #@NEW_LINE#@#  Furthermore, our software interface allows users to tilt the imaging plane in 3D by rapidly modulating the axial focus position in phase with the Y-scanning galvanometer.  #@NEW_LINE#@#  We expect this feature to be particularly useful in neuroscience, where long, straight neuronal projections can be scanned along their own axis, resulting in a significant increase in scanning efficiency.  #@NEW_LINE#@#  We found that an ETL-based system is relatively low price and easily implemented in any two-photon microscope.  #@NEW_LINE#@#  While the focusing speed of an ETL (15 ms) is sufficient for multi-position imaging, tilted-plane imaging needs to be performed fairly slowly, at around 1Hz, to allow the ETL sufficient refocusing time along the imaging plane.  #@NEW_LINE#@#  
It should be noted that there are faster (but more expensive and potentially more complicated) focusing devices which could be used with our software.  #@NEW_LINE#@#  For example, spatial light modulators (SLMs) can create 3D holograms within 24 ms, and have adaptive optics capabilities to potentially decrease distortion and aberration [4244].  #@NEW_LINE#@#  A focusing device using a secondary objective and a galvanic mirror [45] provides even faster focus movement (~ 1 ms).  #@NEW_LINE#@#  Perhaps the most well-established remote focusing element is the acoustic optic deflector (AOD), which can provide high-performance volume imaging in tissue [46, 47].  #@NEW_LINE#@#  
As for controlling software, we implemented a highly capable and customizable focus and drift correction system in order to broaden biological applications.  #@NEW_LINE#@#  Previously, dozens of autofocus algorithms have been made available through primary literature and open source code [20].  #@NEW_LINE#@#  However, these algorithms were not widely implemented.  #@NEW_LINE#@#  Since imaging conditions may be drastically different for many users, we designed a tool capable of narrowing down the optimal algorithm based on accuracy and speed (Fig 2A), allowing us to optimize our autofocusing algorithm to spine imaging experiments.  #@NEW_LINE#@#  Since the benefits of most of the 27 autofocus algorithm have been described in previous literature (Table 1), we did not feel it necessary to identify the ideal imaging conditions which would necessitate their respective use.  #@NEW_LINE#@#  Regardless, we felt that their implementation stands as a clear benefit to future users whose experimental designs might differ from ours.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pone.0170586.t001  #@NEW_LINE#@#  
Finally, in order to allow the software to optimize experiments for biological events occurring at multiple time scales, we introduced a modular timeline scheduling feature which allows users to designate custom timeframes for imaging and photo-stimulation.  #@NEW_LINE#@#  This feature was especially important for studying sLTP, which has two distinct phases at different time scales (Fig 4).  #@NEW_LINE#@#  During transient phase (first ~5 min following stimulation), it is crucial to acquire images with higher frequency (typically ~1060 s per image) since the volume change is rapid.  #@NEW_LINE#@#  However, during the steady state (~1060 min), spine volume is stable and fast acquisition is unnecessary and rather damaging to the sample.  #@NEW_LINE#@#  The typical sampling time for the steady state is ~220 min.  #@NEW_LINE#@#  We demonstrated that this implementation allows us to measure the time course of sLTP in several spines (so far up to ~5 spines) with high efficiency.  #@NEW_LINE#@#  

Conclusion  #@NEW_LINE#@#  
We successfully designed and implemented an automated system capable of reliably measuring sLTP in multiple dendritic spines.  #@NEW_LINE#@#  The implementation of an ETL in the excitation path, combined with galvanoic mirror scanning, allowed us to quickly switch between imaging positions with minimum perturbation to the sample.  #@NEW_LINE#@#  The customizable autofocus and drift correction system allows our software to track and stimulate individual dendritic spines over extended imaging sessions.  #@NEW_LINE#@#  By dramatically increasing the throughput of spine imaging and stimulation experiments, our system will accelerate studies to understand molecular basis of spine structural plasticity.  #@NEW_LINE#@#  In addition, the flexible implementation of software would allow researchers to use it for many imaging/photostimulation experiments.  #@NEW_LINE#@#  

Methods  #@NEW_LINE#@#  
ETL_Implementation  #@NEW_LINE#@#  
An EL-10-30 ETL (Optotune) was implemented in the excitation pathway (Fig 1).  #@NEW_LINE#@#  The light path was designed in OpticStudio (Zemax) and optimized during setup so the ETL is conjugated to the back aperture of the objective.  #@NEW_LINE#@#  Lens L1 shapes the beam to fill the ETL.  #@NEW_LINE#@#  L2 and L3 are used to conjugate the ETL to the back aperture of the objective.  #@NEW_LINE#@#  A typical scan lens and tube lens setup passes the beam to the objective.  #@NEW_LINE#@#  The ETL is controlled by a current range of 0-300mA as indicated in the manual.  #@NEW_LINE#@#  A custom lens holder was designed to hold the ETL in place, and fine positioning in X, Y, and tilt was achieved using a 30 mm-Cage-Compatible SM1-Threaded Kinematic Mount with Slip Plate (Thorlabs).  #@NEW_LINE#@#  ETL shape was actively oscillated by a 10Hz sinusoidal wave during alignment, ensuring that the resulting beam did not stray from its target during axial shifts in imaging.  #@NEW_LINE#@#  

Software_Design  #@NEW_LINE#@#  
All programming was done in MATLAB to be compatible with Scanimage 3.8, available online for free (http://scanimage.vidriotechnologies.com).  #@NEW_LINE#@#  Autofocus and drift correction functions were implemented based on published code [29, 48].  #@NEW_LINE#@#  Abbreviations for focus measure operators are listed in Table 1.  #@NEW_LINE#@#  Maximum Brightness (BRGT) assigns focus values based on the maximum pixel intensity within the image.  #@NEW_LINE#@#  Maximum Brightness Gradient (MGRD) assigns focus values based on the maximum gradient magnitude value of the image.  #@NEW_LINE#@#  

Evaluation_of_Plasticity  #@NEW_LINE#@#  
Mouse pups were euthanized by deep anesthesia by isofluorane followed by decapitation.  #@NEW_LINE#@#  Organotypic hippocampal slice cultures were prepared as described previously [49] from p4-p6 wild-type mice and were cultured for 1012 days before transfection.  #@NEW_LINE#@#  A biolostic particle delivery system (Helios® Gene Gun System, Bio-Rad) was used to introduce fluorescent GFP labels to obtain sparse transfection of neurons.  #@NEW_LINE#@#  Two to six days after transfection, neurons in sparsely GFP-labeled CA1 hippocampal regions were chosen for imaging.  #@NEW_LINE#@#  Individual spines in the striatum radiatum on secondary apical dendrites were chosen for observation.  #@NEW_LINE#@#  MNI-caged L-glutamate (4-methoxy-7-nitroindolinyl-caged L-glutamate, Tocris) was uncaged with a train of 820-nm laser pulses (3.54 mW under the objective, 30 times at 1 Hz) near a spine of interest.  #@NEW_LINE#@#  Pulse duration was varied 4-8ms based on depth of the spine in tissue, allowing for reliable uncaging without excess light exposure.  #@NEW_LINE#@#  Experiments were performed at room temperature in ACSF solution containing (in mM): 127 NaCl, 2.5 KCl, 25 NaHCO3, 1.25 NaH2PO4, 4 CaCl2, 25 glucose, 0.001 tetrodotoxin (Tocris) and 4 MNI-caged L-glutamate, bubbled with 95% O2 and 5% CO2.  #@NEW_LINE#@#  

Animals  #@NEW_LINE#@#  
Wild-type C57BL/6J mice used in the study were purchased from Charles River Laboratories.  #@NEW_LINE#@#  P4-p6 pups were taken from mothers housed individually in Tecniplast® ventilated cages.  #@NEW_LINE#@#  Animals were housed on a 12 hour light cycle with a room temperature of 74°F, 50% humidity, with Harlan 7092 ¼ corn cob bedding.  #@NEW_LINE#@#  All animal procedures were approved by the Max Planck Florida Institute for Neuroscience Animal Care and Use Committee, in accordance with guidelines by the US National Institutes of Health.  #@NEW_LINE#@#  Max Planck Florida Institute has been AAALAC Accredited since June, 2014.  #@NEW_LINE#@#  

Quantification_and_Statistics  #@NEW_LINE#@#  
Spine volume was quantified using custom software written in MATLAB; all Z slices were summed together and oval and polygonal ROIs were drawn to select spines and dendrites, respectively.  #@NEW_LINE#@#  Volumes for each object were standardized to their average pre-uncaging values.  #@NEW_LINE#@#  Statistical significance was obtained using unpaired t-tests comparing the stimulated spine and adjacent spine averages to the dendrite as a control.  #@NEW_LINE#@#  Raw data used in quantification for Fig 4 is available online [50].  #@NEW_LINE#@#  


Author_Contributions  #@NEW_LINE#@#  


Conceptualization: MSS RY LY.  #@NEW_LINE#@#  
Data curation: MSS.  #@NEW_LINE#@#  
Formal analysis: PRE TRG.  #@NEW_LINE#@#  
Funding acquisition: RY.  #@NEW_LINE#@#  
Investigation: MSS PRE TRG.  #@NEW_LINE#@#  
Methodology: MSS RY LY.  #@NEW_LINE#@#  
Project administration: RY.  #@NEW_LINE#@#  
Software: MSS.  #@NEW_LINE#@#  
Supervision: RY.  #@NEW_LINE#@#  
Validation: MSS PRE TRG.  #@NEW_LINE#@#  
Visualization: MSS PRE.  #@NEW_LINE#@#  
Writing  original draft: MSS RY.  #@NEW_LINE#@#  
Writing  review & editing: MSS RY LY.  #@NEW_LINE#@#  



References  #@NEW_LINE#@#  



