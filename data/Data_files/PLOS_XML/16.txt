article id="http://dx.doi.org/10.1371/journal.pcbi.1004490"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Scalability of Asynchronous Networks Is Limited by One-to-One Mapping between Effective Connectivity and Correlations  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Network models are routinely downscaled compared to nature in terms of numbers of nodes or edges because of a lack of computational resources, often without explicit mention of the limitations this entails.  #@NEW_LINE#@#  While reliable methods have long existed to adjust parameters such that the first-order statistics of network dynamics are conserved, here we show that limitations already arise if also second-order statistics are to be maintained.  #@NEW_LINE#@#  The temporal structure of pairwise averaged correlations in the activity of recurrent networks is determined by the effective population-level connectivity.  #@NEW_LINE#@#  We first show that in general the converse is also true and explicitly mention degenerate cases when this one-to-one relationship does not hold.  #@NEW_LINE#@#  The one-to-one correspondence between effective connectivity and the temporal structure of pairwise averaged correlations implies that network scalings should preserve the effective connectivity if pairwise averaged correlations are to be held constant.  #@NEW_LINE#@#  Changes in effective connectivity can even push a network from a linearly stable to an unstable, oscillatory regime and vice versa.  #@NEW_LINE#@#  On this basis, we derive conditions for the preservation of both mean population-averaged activities and pairwise averaged correlations under a change in numbers of neurons or synapses in the asynchronous regime typical of cortical networks.  #@NEW_LINE#@#  We find that mean activities and correlation structure can be maintained by an appropriate scaling of the synaptic weights, but only over a range of numbers of synapses that is limited by the variance of external inputs to the network.  #@NEW_LINE#@#  Our results therefore show that the reducibility of asynchronous networks is fundamentally limited.  #@NEW_LINE#@#  

Author_Summary  #@NEW_LINE#@#  
Neural networks have two basic components: their structural elements (neurons and synapses), and the dynamics of these constituents.  #@NEW_LINE#@#  The so-called effective connectivity combines both components to yield a measure of the actual influence of physical connections.  #@NEW_LINE#@#  Previous work showed effective connectivity to determine correlations, which quantify the co-activation of different neurons.  #@NEW_LINE#@#  Conversely, methods for estimating network structure from correlations have been developed.  #@NEW_LINE#@#  We here extend the range of networks for which the mapping between effective connectivity and correlations can be shown to be one-to-one, and clarify the conditions under which this equivalence holds.  #@NEW_LINE#@#  These findings apply to a class of networks that is often used, with some variations, to model the activity of cerebral cortex.  #@NEW_LINE#@#  Since the numbers of neurons and synapses in real mammalian brains are vast, such models tend to be reduced in size for simulation purposes.  #@NEW_LINE#@#  However, our findings imply that if we wish to retain the original dynamics including correlations, effective connectivity needs to be unchanged, from which we derive scaling laws for synaptic strengths and external inputs, and fundamental limits on the reducibility of network size.  #@NEW_LINE#@#  The work points to the importance of considering networks with realistic numbers of neurons and synapses.  #@NEW_LINE#@#  

Citation: van Albada SJ, Helias M, Diesmann M (2015) Scalability of Asynchronous Networks Is Limited by One-to-One Mapping between Effective Connectivity and Correlations.  #@NEW_LINE#@#  PLoS Comput Biol 11(9):  #@NEW_LINE#@#  
           e1004490.  #@NEW_LINE#@#  

        https://doi.org/10.1371/journal.pcbi.1004490  #@NEW_LINE#@#  
Editor: Peter E. Latham,  #@NEW_LINE#@#  
University College London, UNITED KINGDOM  #@NEW_LINE#@#  

Received: November 18, 2014; Accepted: August 5, 2015; Published:  September 1, 2015  #@NEW_LINE#@#  
Copyright:  Â© 2015 van Albada et al.  #@NEW_LINE#@#  This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited  #@NEW_LINE#@#  
Data Availability: All data and simulation and analysis files are available from the Dryad database: http://dx.doi.org/10.5061/dryad.2m85h.  #@NEW_LINE#@#  
Funding: We acknowledge funding by the Helmholtz Association: portfolio theme Supercomputing and Modeling for the Human Brain (SMHB) (MD) and Helmholtz young investigators group VH-NG-1028 (MH); and European Union Grants 269921 (BrainScaleS) (SJvA, MD) and 604102 (Human Brain Project, HBP) (MD).  #@NEW_LINE#@#  The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  
Competing interests:  The authors have declared that no competing interests exist.  #@NEW_LINE#@#  
Introduction  #@NEW_LINE#@#  
While many aspects of brain dynamics and function remain unexplored, the numbers of neurons and synapses in a given volume are well known, and as such constitute basic parameters that should be taken seriously.  #@NEW_LINE#@#  Despite rapid advances in neural network simulation technology and increased availability of computing resources [1], memory and time constraints still lead to neuronal networks being routinely downscaled both on traditional architectures [2] and in systems dedicated to neural network simulation [3].  #@NEW_LINE#@#  As synapses outnumber neurons by a factor of 103  105, these constitute the main constraint on network size.  #@NEW_LINE#@#  Computational capacity ranges from a few tens of millions of synapses on laptop or desktop computers, or on dedicated hardware when fully exploited [4, 5], to 1012  1013 synapses on supercomputers [6].  #@NEW_LINE#@#  This upper limit is still about two orders of magnitude below the full human brain, underlining the need for downscaling in computational modeling.  #@NEW_LINE#@#  In fact, any brain model that approximates a fraction of the recurrent connections as external inputs is in some sense downscaled: the missing interactions need to be absorbed into the network and input parameters in order to obtain the appropriate statistics.  #@NEW_LINE#@#  Unfortunately, the implications of such scaling are usually not investigated.  #@NEW_LINE#@#  
The opposite type of scaling, taking the infinite size limit, is sometimes used in order to simplify equations describing the network (Fig 1A).  #@NEW_LINE#@#  Although this can lead to valuable insights, real networks in the human brain often contain on the order of 105  107 neurons (Fig 1B), too few to simplify certain equations in the limit of infinite size.  #@NEW_LINE#@#  This is illustrated in Fig 1C using as an example the intrinsic contribution to correlations due to fluctuations generated within the network, and the extrinsic contribution due to common external inputs to different neurons in random networks.  #@NEW_LINE#@#  Although the intrinsic contribution falls off more rapidly than the extrinsic one, it is the main contribution up to large network sizes (around 108 for the given parameters).  #@NEW_LINE#@#  Therefore, taking the infinite size limit and neglecting the intrinsic contribution leads to the wrong conclusions: The small correlations in finite random networks cannot be explained by the network activity tracking the external drive [7], but rather require the consideration of negative feedback [8] that suppresses intrinsically generated and externally imprinted fluctuations alike [9].  #@NEW_LINE#@#  
A Downscaling facilitates simulations, while taking the N   limit often affords analytical insight.  #@NEW_LINE#@#  B Relevant scales.  #@NEW_LINE#@#  The local cortical microcircuit containing roughly 105 neurons is the smallest network where the majority of the synapses ( 104 per neuron) can be represented using realistic connection probabilities ( 0.1).  #@NEW_LINE#@#  C Results for the N   limit may not apply even for large networks.  #@NEW_LINE#@#  In this example, analytically determined intrinsic and extrinsic contributions to correlations between excitatory neurons are shown.  #@NEW_LINE#@#  The extrinsic contribution to the correlation between two neurons arises due common external input, and the intrinsic contribution due to fluctuations generated within the network (cf.  #@NEW_LINE#@#  [9] Eq 24).  #@NEW_LINE#@#  The intrinsic contribution falls off more rapidly than the extrinsic contribution, but nevertheless dominates up to large network sizes, here around 108.  #@NEW_LINE#@#  The crosses indicate simulation results.  #@NEW_LINE#@#  Adapted from [9] Fig 7.  #@NEW_LINE#@#  D Scaling transformations may be designed to preserve average single-neuron or pairwise statistics for selected quantities, population statistics, or a combination of these.  #@NEW_LINE#@#  When average single-neuron and pairwise properties are preserved, the downscaled network of size N behaves to second order like a subsample of the full network of size N0.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pcbi.1004490.g001  #@NEW_LINE#@#  
Taking the infinite size limit for analytical tractability and downscaling to make networks accessible by direct simulation are two separate problems.  #@NEW_LINE#@#  We concentrate in the remainder of this study on such downscaling, which is often performed not only in neuroscience [10, 11, 12, 13] but also in other disciplines [14, 15, 16, 17].  #@NEW_LINE#@#  Neurons and synapses may either be subsampled or aggregated [18]; here we focus on the former.  #@NEW_LINE#@#  One intuitive way of scaling is to ensure that the statistics of particular quantities of interest in the downscaled network match those of a subsample of the same size from the full network (Fig 1D).  #@NEW_LINE#@#  Alternatively, it may sometimes be useful to preserve the statistics of population sums of certain quantities, for instance population fluctuations.  #@NEW_LINE#@#  
We here focus on the preservation of mean population-averaged activities and pairwise averaged correlations in the activity.  #@NEW_LINE#@#  We consider both the size and temporal structure of correlations, but not distributions of mean activities and correlations across the network.  #@NEW_LINE#@#  Means and correlations present themselves as natural quantities to consider, because they are the first- and second-order and as such the most basic measures of the dynamics.  #@NEW_LINE#@#  If it is already difficult to preserve these measures, it is even less likely that preserving higher-order statistics will be possible, in view of their higher dimensionality.  #@NEW_LINE#@#  However, other choices are possible, for instance maintaining total input instead of output spike rates [19].  #@NEW_LINE#@#  
Besides being the most basic dynamical characteristics, means and correlations of neural activity are biologically relevant.  #@NEW_LINE#@#  Mean firing rates are important in many theories of network function [20, 21], and their relevance is supported by experimental results [22, 23].  #@NEW_LINE#@#  For instance, neurons exhibit orientation tuning of spike rate in the visual system [24] and directional tuning in the motor system [25], and sustained rates are implicated in the working memory function of the prefrontal cortex [22].  #@NEW_LINE#@#  Firing rates have also been shown to be central to pattern learning and retrieval in highly connected recurrent neural networks [21].  #@NEW_LINE#@#  Furthermore, mean firing rates distinguish between states of arousal and attention [26, 27], and between healthy and disease conditions [28].  #@NEW_LINE#@#  The relevance of correlations is similarly supported by a large number of findings.  #@NEW_LINE#@#  They are widely present; multi-unit recordings have revealed correlated neuronal activity in various animals and behavioral conditions [29, 30, 31].  #@NEW_LINE#@#  Pairwise correlations were even shown to capture the bulk of the structure in the spiking activity of retinal and cultured cortical neurons [32].  #@NEW_LINE#@#  They are also related to information processing and behavior.  #@NEW_LINE#@#  Synchronous spiking (corresponding to a narrow peak in the cross-correlogram) has for example been shown to occur in relation to behaviorally relevant events [33, 34, 35].  #@NEW_LINE#@#  The relevance of correlations for information processing is further established by the fact that they can increase or decrease the signal-to-noise ratio of population signals [36, 37].  #@NEW_LINE#@#  Moreover, correlations are important in networks with spike-timing-dependent plasticity, since they affect the average change in synaptic strengths [38].  #@NEW_LINE#@#  Correspondingly, for larger correlations, stronger depression is needed for an equilibrium state with asynchronous firing and a unimodal weight distribution to exist in balanced random networks [39].  #@NEW_LINE#@#  The level of correlations in neuronal activity has furthermore been shown to affect the spatial range of local field potentials (LFPs) effectively sampled by extracellular electrodes [40].  #@NEW_LINE#@#  More generally, mesoscopic and macroscopic measures like the LFP and fMRI depend on interneuronal correlations [41].  #@NEW_LINE#@#  Considering the wide range of dynamical and information processing properties affected by mean activities and correlations, it is important that they are accurately modeled.  #@NEW_LINE#@#  
We allow the number of neurons N and the number of incoming synapses per neuron K (the in-degree) to be varied independently, generalizing the common type of scaling where the connection probability is held constant so that N and K change proportionally.  #@NEW_LINE#@#  It is well known that reducing the number of neurons in asynchronous networks increases correlation sizes in inverse proportion to the network size [19, 42, 43, 44, 45].  #@NEW_LINE#@#  However, the influence of the number of synapses on the correlations, including their temporal structure, is less studied.  #@NEW_LINE#@#  When reducing the number of synapses, one may attempt to recover aspects of the network dynamics by adjusting parameters such as the synaptic weights J, the external drive, or neurotransmitter release probabilities [11, 19].  #@NEW_LINE#@#  In the present work, spike transmission is treated as perfectly reliable.  #@NEW_LINE#@#  We only adjust the synaptic weights and a combination of the neuronal threshold and the mean and variance of the external drive to make up for changes in N and K.  #@NEW_LINE#@#  
A few suggestions have been made for adjusting synaptic weights to numbers of synapses.  #@NEW_LINE#@#  In the balanced random network model, the asynchronous irregular (AI) firing often observed in cortex is explained by a domination of inhibition which causes a mean membrane potential below spike threshold, and sufficiently large fluctuations that trigger spikes [46].  #@NEW_LINE#@#  In order to achieve such an AI state for a large range of network sizes, one choice is to ensure that input fluctuations remain similar in size, and adjust the threshold or a DC drive to maintain the mean distance to threshold.  #@NEW_LINE#@#  As fluctuations are proportional to J2 K for independent inputs, this suggests the scaling  #@NEW_LINE#@#  
(1)  #@NEW_LINE#@#  
proposed in [46].  #@NEW_LINE#@#  Since the mean input to a neuron is proportional to J K, Eq (1) leads, all else being equal, to an increase of the population feedback with , changing the correlation structure of the network, as illustrated in Fig 2 for a simple network of inhibitory leaky integrate-and-fire neurons (note that in this example we fix the connection probability).  #@NEW_LINE#@#  This suggests the alternative [42, 44, 45]  #@NEW_LINE#@#  
(2)  #@NEW_LINE#@#  
where now the variance of the external drive needs to be adjusted to maintain the total input variance onto neurons in the network.  #@NEW_LINE#@#  
A reference network of 10,000 inhibitory leaky integrate-and-fire neurons is scaled up to 50,000 neurons, fixing the connection probability and adjusting the external Poisson drive to keep the mean and variance of total (external plus internal) inputs fixed.  #@NEW_LINE#@#  Single-neuron parameters and connection probability are as in Table 2.  #@NEW_LINE#@#  Delays are 1 ms, mean and standard deviation of total inputs are 15 mV and 10 mV, respectively, and the reference network has J = 0.1 mV.  #@NEW_LINE#@#  Each network is simulated for 50 s. A Onset of oscillations induced by scaling of network size N, visualized by changes in the poles z of the covariance function in the frequency domain.  #@NEW_LINE#@#  Re(z) determines the frequency of oscillations and Im(z) their damping, such that -Im(z)  0 means that small deviations from the fixed-point activity of the network grow with time [cf.  #@NEW_LINE#@#  Eq (76)].  #@NEW_LINE#@#  The transformation  preserves the poles, while  induces a Hopf bifurcation so that the scaled network is outside the linearly stable regime.  #@NEW_LINE#@#  B Covariance in the network where coupling strength J is scaled with the in-degree K matches that in the reference network, whereas large oscillations appear in the network scaled with .  #@NEW_LINE#@#  Colors as in A.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pcbi.1004490.g002  #@NEW_LINE#@#  
For a given network size N and mean activity level, the size and temporal structure of pairwise averaged correlations are determined by the so-called effective connectivity, which quantifies the linear dependence of the activity of each target population on the activity of each source population.  #@NEW_LINE#@#  The effective connectivity is proportional to synaptic strength and the number of synapses a target neuron establishes with the source population, and additionally depends on the activity of the target neurons.  #@NEW_LINE#@#  Effective connectivity has previously been defined as the experiment and time-dependent, simplest possible circuit diagram that would replicate the observed timing relationships between the recorded neurons [47].  #@NEW_LINE#@#  In our analysis we consider the stationary state, but at different times the network may be in a different state exhibiting a different effective connectivity.  #@NEW_LINE#@#  The definition of [47] highlights the fact that identical neural timing relationships can in principle occur in different physical circuits and vice versa.  #@NEW_LINE#@#  However, with a given model of interactions or coupling, the activity may allow a unique effective connectivity to be derived [48].  #@NEW_LINE#@#  We define effective connectivity in a forward manner with knowledge of the physical connectivity as well as the form of interactions.  #@NEW_LINE#@#  We show in this study that with this model of interactions, and with independent external inputs, the activity indeed determines a unique effective connectivity, so that the forward and reverse definitions coincide.  #@NEW_LINE#@#  This complements the groundbreaking general insight of [47].  #@NEW_LINE#@#  
We consider networks of binary model neurons and networks of leaky integrate-and-fire (LIF) neurons with current-based synapses to investigate how and to what extent changes in network parameters can be used to preserve mean population-averaged activities and pairwise averaged correlations under reductions in the numbers of neurons and synapses.  #@NEW_LINE#@#  The parameters allowed to vary are the synaptic weights, neuronal thresholds, and the mean and variance of the external drive.  #@NEW_LINE#@#  We apply and extend the theory of correlations in randomly connected binary and LIF networks in the asynchronous regime developed in [7, 8, 9, 42, 45, 49, 50, 51, 52, 53], which explains the smallness and structure of correlations experimentally observed during spontaneous activity in cortex [54, 55], and we compare analytical predictions of correlations with results from simulations.  #@NEW_LINE#@#  The results are organized as follows.  #@NEW_LINE#@#  In Correlations uniquely determine effective connectivity: a simple example we provide an intuitive example that illustrates why the effective connectivity uniquely determines correlation structure.  #@NEW_LINE#@#  In Correlations uniquely determine effective connectivity: the general case we show that this one-to-one relationship generalizes to networks of several populations apart from degenerate cases.  #@NEW_LINE#@#  In Correlation-preserving scaling we conclude that, in general, only scalings that preserve the effective connectivity, such as J  1/K, are able to preserve correlations.  #@NEW_LINE#@#  In Limit to in-degree scaling we identify the limits of the resulting scaling procedure, demonstrating the restricted scalability of asynchronous networks.  #@NEW_LINE#@#  Robustness of correlation-preserving scaling shows that the scaling J  1/K can preserve correlations, within the identified restrictive bounds, for different networks either adhering to or deviating from the assumptions of the analytical theory.  #@NEW_LINE#@#  Zero-lag correlations in binary network investigates how to maintain the instantaneous correlations in a binary network, while Symmetric two-population spiking network considers the degenerate case of a connectivity with special symmetries, in which correlations may be maintained under network scaling without preserving the effective connectivity.  #@NEW_LINE#@#  Preliminary results have been published in abstract form [56].  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
Correlations_uniquely_determine_effective_connectivity__A_simple_example  #@NEW_LINE#@#  
In this section we give an intuitive one-dimensional example to show that effective connectivity determines the shapes of the average pairwise cross-covariances and vice versa.  #@NEW_LINE#@#  For the following, we first introduce a few basic quantities.  #@NEW_LINE#@#  Consider a binary or spiking network consisting of several excitatory and inhibitory populations with potentially source- and target-type-dependent connectivity.  #@NEW_LINE#@#  For the spiking networks, we assume leaky integrate-and-fire (LIF) dynamics with exponential synaptic currents.  #@NEW_LINE#@#  The dynamics of the binary and LIF networks are respectively introduced in Binary network dynamics and Spiking network dynamics.  #@NEW_LINE#@#  We assume irregular network activity, approximated as Poissonian for the spiking network, with population means .  #@NEW_LINE#@#  For the binary network,  = n is the expectation value of the binary variable.  #@NEW_LINE#@#  For the spiking network, we absorb the membrane time constant into , defining  = m r where r is the firing rate of the population.  #@NEW_LINE#@#  The external drive can consist of both a DC component ,ext and fluctuations with variance , provided either by Poisson spikes or by a Gaussian current.  #@NEW_LINE#@#  The working points of each population, characterized by mean  and variance  of the combined input from within and outside the network, are given by  #@NEW_LINE#@#  
(3) (4) (5)  #@NEW_LINE#@#  
where J is the synaptic strength from population  to population , and K is the number of synapses per target neuron (the in-degree) for the corresponding projection (we use  in the sense of is defined as).  #@NEW_LINE#@#  We call  external variance in the following, and the remainder internal variance.  #@NEW_LINE#@#  The mean population activities are determined by  and  according to Eqs (39) and (67).  #@NEW_LINE#@#  Expressions for correlations in binary and LIF networks are given respectively in First and second moments of activity in the binary network and First and second moments of activity in the spiking network.  #@NEW_LINE#@#  
As a one-dimensional example, consider a binary network with a single population and vanishing transmission delays.  #@NEW_LINE#@#  The effective connectivity W is just a scalar, and the population-averaged autocovariance a and cross-covariance c are functions of the time lag .  #@NEW_LINE#@#  We define the population-averaged effective connectivity as  #@NEW_LINE#@#  
(6)  #@NEW_LINE#@#  
where w(J, , ) is an effective synaptic weight that depends on the mean  [Eq (3)] and the variance 2 [Eq (4)] of the input.  #@NEW_LINE#@#  For LIF networks, w = rtarget/rsource is defined via Eq (68) and can be obtained as the derivative of Eq (67).  #@NEW_LINE#@#  Note that we treat the effective influence of individual inputs as independent.  #@NEW_LINE#@#  A more accurate definition of the population-level effective connectivity, beyond the scope of this paper, could be obtained by also considering combinations of inputs in the sense of a Volterra series [57].  #@NEW_LINE#@#  When the dependence of w on J is linearized, the effective connectivity can be written as  #@NEW_LINE#@#  
(7)  #@NEW_LINE#@#  
where the susceptibility S(, ) measures to linear order the effect of a unit input to a neuron on its outgoing activity.  #@NEW_LINE#@#  In our one-dimensional example, W quantifies the self-influence of an activity fluctuation back onto the population.  #@NEW_LINE#@#  Expressed in these measures, the differential equation for the covariance function [Eq (52)] takes the form  #@NEW_LINE#@#  
(8)  #@NEW_LINE#@#  
with initial condition [from Eq (41)]  #@NEW_LINE#@#  
(9)  #@NEW_LINE#@#  
which is solved by  #@NEW_LINE#@#  
(10) Eq (10) shows that the effective connectivity W together with the time constant  of the neuron (which we assume fixed under scaling) determines the temporal structure of the correlations.  #@NEW_LINE#@#  Furthermore, since a sum of exponentials cannot equal a sum of exponentials with a different set of exponents, the temporal structure of the correlations uniquely determines W. Hence we see that there is a one-to-one correspondence between W and the correlation structure if the time constant  is fixed, which implies that preserving correlation structure under a reduction in the in-degrees K requires adjusting the effective synaptic weights w(J, , ) such that the effective connectivity W is maintained.  #@NEW_LINE#@#  If, in addition, the mean activity n is kept constant this also fixes the variance a = n(1  n).  #@NEW_LINE#@#  Eq (10) shows that, under these circumstances with W and a fixed, correlation sizes are determined by N.  #@NEW_LINE#@#  

Correlations_uniquely_determine_effective_connectivity__The_general_case  #@NEW_LINE#@#  
More generally, networks consist of several neural populations each with different dynamic properties and with population-dependent transmission delays d. Since this setting does not introduce additional symmetries, intuitively the one-to-one relationship between the effective connectivity and the correlations should still hold.  #@NEW_LINE#@#  We here show that, under certain conditions, this is indeed the case.  #@NEW_LINE#@#  
Instead of considering the covariance matrix in the time domain, for population-dependent dynamic properties we find it convenient to stay in the frequency domain.  #@NEW_LINE#@#  The influence of a fluctuating input on the output of the neuron can to lowest order be described by the transfer function H().  #@NEW_LINE#@#  This quantity measures the amplitude and phase of the modulation of the neuronal activity given that the neuron receives a small sinusoidal perturbation of frequency  in its input.  #@NEW_LINE#@#  The transfer function depends on the mean  [Eq (3)] and the variance 2 [Eq (4)] of the input to the neuron.  #@NEW_LINE#@#  We here first consider LIF networks; in the Supporting Information we show how the results carry over to the binary model.  #@NEW_LINE#@#  
In First and second moments of activity in the spiking network, we give the covariance matrix including the autocovariances in the frequency domain, , as  #@NEW_LINE#@#  
(11)  #@NEW_LINE#@#  
where M has elements H()W. If  is invertible, we can expand the inverse of Eq (11) to obtain  #@NEW_LINE#@#  
(12)  #@NEW_LINE#@#  
where we assumed the transfer function to have the form  which is often a good approximation for the LIF model [45].  #@NEW_LINE#@#  In the second step we distinguish terms that only contribute on the diagonal ( = ), those that only contribute off the diagonal (  ), and those that contribute in either case.  #@NEW_LINE#@#  For  = , only the first and last terms contribute, and we get  #@NEW_LINE#@#  
(13)  #@NEW_LINE#@#  
If we want to preserve , this fixes A and thereby also W, since it multiplies terms with unique -dependence.  #@NEW_LINE#@#  For   , we obtain  #@NEW_LINE#@#  
(14)  #@NEW_LINE#@#  
With A fixed, this additionally fixes W, in view of the unique -dependence it multiplies.  #@NEW_LINE#@#  
Since , a constraint on A necessary for preserving  may not translate into the same constraint when we only require the cross-covariances C() to be preserved.  #@NEW_LINE#@#  However, C() and  have identical -dependence, as they differ only by constants on the diagonal (approximating autocorrelations as delta functions in the time domain [45]).  #@NEW_LINE#@#  To derive conditions for preserving C(), we therefore ignore the constraint on A but still require the -dependence to be unchanged.  #@NEW_LINE#@#  A potential transformation leaving the -dependent terms in both Eqs (13) and (14) unchanged is A  kA, W  kW, W  kW, but this only works if  = , d  d = d  d for some , and if the terms for the corresponding  are also transformed to offset the change in ; or if some of the entries of W vanish.  #@NEW_LINE#@#  The -dependence of  and C would otherwise change, showing that, at least in the absence of such symmetries in the delays or time constants, or zeros in the effective connectivity matrix (i.e., absent connections at the population level, or inactive populations), there is a one-to-one relationship between covariances and effective connectivity.  #@NEW_LINE#@#  Hence, preserving the covariances requires preserving A and W except in degenerate cases.  #@NEW_LINE#@#  Note that the autocovariances and hence the firing rates can be changed while affecting only the size but not the shape of the correlations, but that the correlation shapes determine W.  #@NEW_LINE#@#  
Even in case of identical transfer functions across populations, including in particular equal transmission delays and identical , the one-to-one correspondence between effective connectivity and correlations can be demonstrated except for a narrower set of degenerate cases.  #@NEW_LINE#@#  The argument for d = 0 proceeds in the time domain along the same lines as Correlations uniquely determine effective connectivity: a simple example, using the fact that for a population-independent transfer function, the correlations can be expressed in terms of the eigenvalues and eigenvectors of the effective connectivity matrix (cf.  #@NEW_LINE#@#  First and second moments of activity in the binary network and First and second moments of activity in the spiking network).  #@NEW_LINE#@#  For general delays, a derivation in the frequency domain can be used.  #@NEW_LINE#@#  Through these arguments, we show in the Supporting Information that the one-to-one correspondence holds at least if W is diagonalizable and has no eigenvalues that are zero or degenerate.  #@NEW_LINE#@#  

Correlation-preserving_scaling  #@NEW_LINE#@#  
If the working point (, ) is maintained, the one-to-one correspondence between the effective connectivity and the correlations implies that requiring unchanged average covariances leaves no freedom for network scaling except for a possible trade-off between in-degrees and synaptic weights.  #@NEW_LINE#@#  In the linear approximation W(J, , ) = S(, )JK, this trade-off is J  1/K.  #@NEW_LINE#@#  
When this scaling is implemented naively without adjusting the external drive to recover the original working point, the covariances change, as illustrated in Fig 3B for a two-population binary network with parameters given in Table 1.  #@NEW_LINE#@#  The results of J  1/K scaling with appropriate adjustment of the external drive are shown in Fig 3C.  #@NEW_LINE#@#  The scaling shown in Fig 3B also increases the mean activities (E: from 0.16 to 0.23, I: from 0.07 to 0.11), whereas that in Fig 3C preserves them.  #@NEW_LINE#@#  
If one relaxes the constraint on the working point while still requiring mean activities to be preserved, the network does have additional symmetries due to the fact that only some combination of  and  needs to be fixed, rather than each of these separately.  #@NEW_LINE#@#  This combination is more easily determined for binary than for LIF networks, for which the mean firing rates depend on  and  in a complex manner [cf.  #@NEW_LINE#@#  Eq (67)].  #@NEW_LINE#@#  When the derivative of the gain function is narrow (e.g., having zero width in the case of the Heaviside function used here) compared to the input distribution, the mean activities of binary networks depend only on (  )/ [9].  #@NEW_LINE#@#  Changing  while preserving (  )/ leads for a Heaviside gain function to a new susceptibility S = (/)S [cf.  #@NEW_LINE#@#  Eq (43)].  #@NEW_LINE#@#  For constant K, if the standard deviation of the external drive is changed proportionally to the internal standard deviation, we have   J and thus J S = JS, implying an insensitivity of the covariances to the synaptic weights J [52].  #@NEW_LINE#@#  In particular, this symmetry applies in the absence of an external drive.  #@NEW_LINE#@#  When K is altered, this choice for adjusting the external drive causes the covariances to change.  #@NEW_LINE#@#  However, adjusting the external drive such that / = (J K)/(JK), the change in S is countered to preserve W and correlations.  #@NEW_LINE#@#  This is illustrated in Fig 3D for , which is another natural choice, as it preserves the internal variance if one ignores the typically small contribution of the correlations to the input variance ([9] Fig 3D illustrates the smallness of this contribution for an example network).  #@NEW_LINE#@#  This is only one of a continuum of possible scalings preserving mean activities and covariances (within the bounds described in the following section) when the working point and hence the susceptibility are allowed to change.  #@NEW_LINE#@#  

Limit_to_in-degree_scaling  #@NEW_LINE#@#  
We now show that both the scaling J  1/K for LIF networks (for which we do not consider changes to the working point, as analytic expressions for countering these changes are intractable), and correlation-preserving scalings for binary networks (where we allow changes to the working point that preserve mean activities) are applicable only up to a limit that depends on the external variance.  #@NEW_LINE#@#  
For the binary network, assume a generic scaling K = K, J = J and a Heaviside gain function.  #@NEW_LINE#@#  We denote variances due to inputs from within the network and due to the external drive respectively by  and  The preservation of the mean activities implies S = (/)S as above, where .  #@NEW_LINE#@#  To keep SJK fixed we thus require  #@NEW_LINE#@#  
(15)  #@NEW_LINE#@#  
where we have used  in the second line.  #@NEW_LINE#@#  For ext = 0 this scaling only works for   1, i.e., increasing instead of decreasing the in-degrees.  #@NEW_LINE#@#  More generally, the limit to downscaling occurs when  or  #@NEW_LINE#@#  
(16)  #@NEW_LINE#@#  
independent of the scaling of the synaptic weights.  #@NEW_LINE#@#  Thus, larger external and smaller internal variance before scaling allow a greater reduction in the number of synapses.  #@NEW_LINE#@#  The in-degrees of the example network of Fig 3 could be maximally reduced to 73%.  #@NEW_LINE#@#  Note that  could in principle be chosen in a -dependent manner such that  is fixed or increased instead of decreased upon downscaling, namely .  #@NEW_LINE#@#  However, Eq (16) is still the limit beyond which this fails, as  then diverges at that point.  #@NEW_LINE#@#  
Note that the limit to the in-degree scaling also implies a limit on the reduction in the number of neurons for which the scaling equations derived here allow the correlation structure to be preserved, as a greater reduction of N compared to K increases the number of common inputs neurons receive and thereby the deviation from the assumptions of the diffusion approximation.  #@NEW_LINE#@#  This is shown by the thin curves in Fig 3C,3D.  #@NEW_LINE#@#  
Now consider correlation-preserving scaling of LIF networks.  #@NEW_LINE#@#  Reduced K with constant JK does not affect mean inputs [cf.  #@NEW_LINE#@#  Eq (3)] but increases the internal variance according to Eq (4).  #@NEW_LINE#@#  To maintain the working point (, ), it is therefore necessary to reduce the variance of the external drive.  #@NEW_LINE#@#  When the drive consists of excitatory Poisson input, one way of keeping the mean external drive constant while changing the variance is to add an inhibitory Poisson drive.  #@NEW_LINE#@#  With K = K/ and J = J, the change in internal variance is , where  is the internal variance due to input currents in the full-scale model.  #@NEW_LINE#@#  This is canceled by an opposite change in  by choosing excitatory and inhibitory Poisson rates  #@NEW_LINE#@#  
(17) (18)  #@NEW_LINE#@#  
where re,0 is the Poisson rate in the full-scale model, and the excitatory and inhibitory synapses have weights Jext and g Jext, respectively.  #@NEW_LINE#@#  Eqs (17) and (18) match Eq (E.1) in [45] except for the 1 + g in the denominator, which was there erroneously given as 1+g2.  #@NEW_LINE#@#  Since downscaling K implies   1, it is seen that the required rate of the inhibitory inputs is negative.  #@NEW_LINE#@#  Therefore, this method only allows upscaling.  #@NEW_LINE#@#  An alternative is to use a balanced Poisson drive with weights Jext and  Jext, choosing the rate of both excitatory and inhibitory inputs to generate the desired variance, and adding a DC drive Iext to recover the mean input,  #@NEW_LINE#@#  
(19) (20)  #@NEW_LINE#@#  
In this manner, the network can be downscaled up to the point where the variance of the external drive vanishes.  #@NEW_LINE#@#  Substituting this condition into Eq (15), the same expression for the minimal in-degree scaling factor Eq (16) is obtained as for the binary network.  #@NEW_LINE#@#  

Robustness_of_correlation-preserving_scaling  #@NEW_LINE#@#  
In this section, we show that the scaling J  1/K, which maintains the population-level feedback quantified by the effective connectivity, can preserve correlations (within the bounds given in Limit to in-degree scaling) under fairly general conditions.  #@NEW_LINE#@#  To this end, we consider two types of networks: 1. a multi-layer cortical microcircuit model with distributed in- and out-degrees and lognormally distributed synaptic strengths (cf.  #@NEW_LINE#@#  Network structure and notation); 2. a two-population LIF network with different mean firing rates (parameters in Table 2).  #@NEW_LINE#@#  For both types of models, we contrast the scaling J  1/K with , in each case maintaining the working point given by Eqs (3) and (4).  #@NEW_LINE#@#  Fig 4 illustrates that the former closely preserves average pairwise cross-covariances in the cortical microcircuit model, whereas the latter changes both their size and temporal structure.  #@NEW_LINE#@#  

Fig 5 demonstrates the robustness of J  1/K scaling to the firing rate of the network.  #@NEW_LINE#@#  In this example, both the full-scale network and the downscaled networks receive a balanced Poisson drive producing the desired variance, while the mean input is provided by a DC drive.  #@NEW_LINE#@#  By changing the parameters of the external drive, we create two networks each with irregular spiking but with widely different mean rates (3.3 spikes/s and 29.6 spikes/s).  #@NEW_LINE#@#  Downscaling only the number of synapses but not the number of neurons, both the temporal structure and the size of the correlations are closely preserved.  #@NEW_LINE#@#  Reducing the in-degrees and the number of neurons N by the same factor, the correlations are scaled by 1/N.  #@NEW_LINE#@#  Hence, the correlations of the full-scale network of size N0 can be estimated simply by multiplying those of the reduced network by N/N0.  #@NEW_LINE#@#  In contrast,  changes correlation sizes even when N is held constant, and combined scaling of N and K can therefore not simply be compensated for by the factor N/N0.  #@NEW_LINE#@#  In the high-rate network, the spiking statistics of the neurons is non-Poissonian, as seen from the gap in the autocorrelations (insets in Fig 5B, 5D).  #@NEW_LINE#@#  Nevertheless, J  1/K preserves the correlations more closely than , showing that the predicted scaling properties hold beyond the strict domain of validity of the underlying theory.  #@NEW_LINE#@#  

Zero-lag_correlations_in_binary_network  #@NEW_LINE#@#  
Although it is not generally possible to keep mean activities and correlations invariant upon downscaling, transformations may be found when only one aspect of the correlations is important, such as their zero-lag values.  #@NEW_LINE#@#  We illustrate this using a simple, randomly connected binary network of N excitatory and N inhibitory binary neurons, where each neuron receives K = pN excitatory and K inhibitory inputs.  #@NEW_LINE#@#  The parameters are given in Table 3.  #@NEW_LINE#@#  The linearized effective connectivity matrix for this example is  #@NEW_LINE#@#  
(21)  #@NEW_LINE#@#  
When the threshold  is  0, the network is spontaneously active without external inputs.  #@NEW_LINE#@#  In the diffusion approximation and assuming stationarity, the mean zero-lag cross-covariances between pairs of neurons from each population can be estimated from Eq (41) (see also [52])  #@NEW_LINE#@#  
 (22)  #@NEW_LINE#@#  
where the subscripts e and i respectively denote excitatory and inhibitory populations.  #@NEW_LINE#@#  Moreover, We is the effective excitatory coupling,  #@NEW_LINE#@#  
(23)  #@NEW_LINE#@#  
with S the susceptibility as defined in Eq (43).  #@NEW_LINE#@#  Furthermore, a is the variance of the single-neuron activity,  #@NEW_LINE#@#  
(24)  #@NEW_LINE#@#  
which is identical for the excitatory and inhibitory populations.  #@NEW_LINE#@#  The mean input to each neuron is given by [cf.  #@NEW_LINE#@#  Eq (3)],  #@NEW_LINE#@#  
(25)  #@NEW_LINE#@#  
and, under the assumption of near-independence of the neurons, the variance of the inputs is well approximated by the sum of the variances from each sending neuron [cf.  #@NEW_LINE#@#  Eq (4)],  #@NEW_LINE#@#  
(26)  #@NEW_LINE#@#  
Finally, the mean activity can be obtained from the self-consistency relation Eq (39).  #@NEW_LINE#@#  

Eq (22) shows that, when excitatory and inhibitory synaptic weights are scaled equally, the covariances scale with 1/N as long as the network feedback is strong (We  1), (for this argument, we assume that n is held constant, which may be achieved by adjusting a combination of  and the external drive).  #@NEW_LINE#@#  Hence, conventional downscaling of population sizes tends to increase covariances.  #@NEW_LINE#@#  
We use Eq (22) to perform a more sophisticated downscaling (cf.  #@NEW_LINE#@#  Fig 6).  #@NEW_LINE#@#  Let the new size of the excitatory population be N. Eq (22) shows that the covariances can only be preserved when a combination of We, , and g is adjusted.  #@NEW_LINE#@#  We take  constant, and apply the transformation  #@NEW_LINE#@#  
(27)  #@NEW_LINE#@#  
Solving Eq (22) for f and g yields (cf.  #@NEW_LINE#@#  Fig 6B)  #@NEW_LINE#@#  
(28) (29)  #@NEW_LINE#@#  
The change in We can be captured by K  f K as long as the working point (, ) is maintained.  #@NEW_LINE#@#  This intuitively corresponds to a redistribution of the synapses so that a fraction f comes from inside the network, and 1  f from outside (cf.  #@NEW_LINE#@#  Fig 6A).  #@NEW_LINE#@#  However, the external drive does not have the same mean and variance as the internal inputs, since it needs to make up for the change in g. The external input can be modeled as a Gaussian noise with parameters  #@NEW_LINE#@#  
(30) (31)  #@NEW_LINE#@#  
independent for each neuron.  #@NEW_LINE#@#  
An alternative is to perform the downscaling in two steps: First change the relative inhibitory weights according to Eq (29) but keep the connection probability constant.  #@NEW_LINE#@#  The mean activity can be preserved by solving Eq (39) for , but the covariances are changed.  #@NEW_LINE#@#  The second step, which restores the original covariances, then amounts to redistributing the synapses so that a fraction  comes from inside the network, and  from outside, where the external (non-modeled) neurons have the same mean activity as those inside the network.  #@NEW_LINE#@#  This mean activity is negative, as the balanced regime implies stronger inhibition than excitation.  #@NEW_LINE#@#  Note that , since We changes already in the first step.  #@NEW_LINE#@#  
The requirement that inhibition dominate excitation places a lower limit on the network size for which the scaling is effective.  #@NEW_LINE#@#  The reason is that g decreases with network size, so that a bifurcation occurs at g = 1/, beyond which the only steady states correspond to a silent network or a fully active one.  #@NEW_LINE#@#  

Symmetric_two-population_spiking_network  #@NEW_LINE#@#  
We have seen that the one-to-one relationship between effective connectivity and correlations does not hold in certain degenerate cases.  #@NEW_LINE#@#  Here we consider such a degenerate case and perform a scaling that preserves mean activities as well as both the size and the temporal structure of the correlations under reductions in both the number of neurons and the number of synapses.  #@NEW_LINE#@#  The network consists of one excitatory and one inhibitory population of LIF neurons with a population-independent connection probability and vanishing transmission delays.  #@NEW_LINE#@#  Due to the appearance of the eigenvalues in the numerator of the expression for the correlations in LIF networks [cf.  #@NEW_LINE#@#  Eqs (70) and (71)], such networks are subject to a reduced number of constraints when W has a zero eigenvalue, as this leaves a freedom to change the corresponding eigenvectors.  #@NEW_LINE#@#  Furthermore, identically vanishing delays greatly simplify the equations for the covariances.  #@NEW_LINE#@#  
The single-neuron and network parameters are as in Table 2 except that, here, N = 10,000, J = 0.2 mV, and the external drive is chosen such that the mean and standard deviation of the total input to each neuron are  = 15 mV,  = 10 mV.  #@NEW_LINE#@#  Furthermore, the delay is chosen equal to the simulation time step to approximate d = 0, which we assume here.  #@NEW_LINE#@#  The effective connectivity matrix for this network is  #@NEW_LINE#@#  
(32)  #@NEW_LINE#@#  
where w = rtarget/rsource is the effective excitatory synaptic weight obtained as the derivative of Eq (67).  #@NEW_LINE#@#  Here, we take into account the dependence of w on J to quadratic order.  #@NEW_LINE#@#  The inhibitory weight is approximated as gw to allow an analytical expression for the relative inhibitory weight in the scaled network to be derived.  #@NEW_LINE#@#  The left and right eigenvectors are   corresponding to eigenvalue L = w K(1   g) and   corresponding to eigenvalue 0.  #@NEW_LINE#@#  The normalization is chosen such that the bi-orthogonality condition Eq (47) is fulfilled.  #@NEW_LINE#@#  
A transformed connectivity matrix should have the same eigenvalues as W, and can thus be written as  #@NEW_LINE#@#  
(33) (34)  #@NEW_LINE#@#  
Denote the new population sizes by N1 and N2.  #@NEW_LINE#@#  Equating the covariances before and after the transformation yields using Eq (71) and Ajk = vjT A vk [cf.  #@NEW_LINE#@#  Eq (49)],  #@NEW_LINE#@#  
(35)  #@NEW_LINE#@#  
In Eq (35) we have assumed that the working points, and thus a1 and a2, are preserved, which may be achieved with an appropriate external drive as long as the corresponding variance remains positive.  #@NEW_LINE#@#  The four equations are simultaneously solved by  #@NEW_LINE#@#  
(36)  #@NEW_LINE#@#  
where w K may be chosen freely.  #@NEW_LINE#@#  Thus, the new connectivity matrix reads  #@NEW_LINE#@#  
(37)  #@NEW_LINE#@#  
which may also be cast into the form  #@NEW_LINE#@#  
(38)  #@NEW_LINE#@#  
where  = N2/N1 and .  #@NEW_LINE#@#  
When the populations receive statistically identical external inputs, we have a1 = a2 = r, since the internal inputs are also equal.  #@NEW_LINE#@#  Fig 7 illustrates the network scaling for the choice w = w. Results are shown as a function of the relative size N1/N of the excitatory population.  #@NEW_LINE#@#  External drive is provided at each network size to keep the mean and standard deviation of the total inputs to each neuron at the level indicated.  #@NEW_LINE#@#  The mean is supplied as a constant current input, while the variability is afforded by Poisson inputs according to Eqs (17) and (18) (Fig 7D).  #@NEW_LINE#@#  It is seen that the transformations (Fig 7B) are able to reduce both the total numbers of neurons and the total number of synapses (Fig 7C) while approximately preserving covariance sizes and shapes (Fig 7E,7F).  #@NEW_LINE#@#  Small fluctuations in the theoretical predictions in Fig 7E are due to the discreteness of numbers of neurons and synapses, and deviations of the effective inhibitory weight from the linear approximation g w. The fact that the theoretical prediction in Fig 7F misses the small dips around t = 0 may be due to the approximation of the autocorrelations by delta functions, eliminating the relative refractoriness due to the reset.  #@NEW_LINE#@#  The numbers of neurons and synapses increase again below some N1/N, and diverge as g becomes zero.  #@NEW_LINE#@#  This limits the scalability despite the additional freedom provided by the symmetry.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
By applying and extending the theory of correlations in asynchronous networks of binary and networks of leaky integrate-and-fire (LIF) neurons, our present work shows that the scalability of numbers of neurons and synapses is fundamentally limited if mean activities and pairwise averaged activity correlations are to be preserved.  #@NEW_LINE#@#  We analytically derive a limit on the reducibility of the number of incoming synapses per neuron, K (the in-degree), which depends on the variance of the external drive, and which indirectly restricts the scalability of the number of neurons.  #@NEW_LINE#@#  Within these restrictive bounds, we propose a scaling of the synaptic strengths J and the external drive with K that can preserve mean activities and the size and temporal structure of pairwise averaged correlations.  #@NEW_LINE#@#  Mean activities can be approximately preserved by maintaining the mean and variance of the total input currents to the neurons, also referred to as the working point.  #@NEW_LINE#@#  The temporal structure of pairwise averaged correlations depends on the effective connectivity, a measure of the effective influence of source populations on target populations determined both by the physical connectivity and the working point of the target neurons.  #@NEW_LINE#@#  When the dependence of the effective connectivity on the synaptic strengths J is linearized, it can be written as SJK, where S is the susceptibility of the target neurons (quantifying the change in output activity for a unit change in input).  #@NEW_LINE#@#  Scalings and analytical predictions of pairwise averaged correlations are tested using direct simulations of randomly connected networks of excitatory and inhibitory neurons.  #@NEW_LINE#@#  
Our most important findings are:  #@NEW_LINE#@#  



The population-level effective connectivity matrix and pairwise averaged correlations are linked by a one-to-one mapping except in degenerate cases.  #@NEW_LINE#@#  Therefore, with few exceptions, any network scaling that preserves the correlations needs to preserve the effective connectivity.  #@NEW_LINE#@#  
The most straightforward way of simultaneously preserving mean activities and pairwise averaged correlations is to change the synaptic strengths in inverse proportion to the in-degrees (J  1/K), and to adjust the variance of the external drive to make up for the change in variance of inputs from within the network.  #@NEW_LINE#@#  Other scalings, such as , can in principle also preserve both mean activities and pairwise averaged correlations, but then change the working point (hence the neuronal susceptibility determining the strength of stimulus responses, and the degree to which the activity is mean- or fluctuation-driven), and are analytically intractable for LIF networks due to the complicated dependence of the firing rates and the impulse response on the mean and variance of the inputs.  #@NEW_LINE#@#  
When downscaling the in-degrees K and scaling synaptic strengths as J  1/K, the variance of inputs from within the network increases, so that the variance of external inputs needs to be decreased to restore the working point.  #@NEW_LINE#@#  This is only possible up to the point where the variance of the external drive vanishes.  #@NEW_LINE#@#  The minimal in-degree scaling factor equals the ratio between the variance of inputs coming from within the network, and the total input variance due to both internal inputs and the external drive.  #@NEW_LINE#@#  The same limit to in-degree scaling holds more generally for scalings that simultaneously preserve mean activities and correlations.  #@NEW_LINE#@#  Thus, in the absence of a variable external drive, no downscaling is possible without changing mean activities, correlations, or both.  #@NEW_LINE#@#  
Within the identified restrictive bounds, the scaling J  1/K, where the external variance is adjusted to maintain the working point, can preserve mean activities and pairwise averaged correlations also in asynchronous networks deviating from the assumptions of the analytical theory presented here.  #@NEW_LINE#@#  We show this robustness for an example network with distributed in- and out-degrees and distributed synaptic weights, and for a network with non-Poissonian spiking.  #@NEW_LINE#@#  
For a sufficiently large change in in-degrees, a scaling that affects correlations can push the network from the linearly stable to an oscillatory regime or vice versa.  #@NEW_LINE#@#  
Transformations derived using the diffusion approximation are able to closely preserve the relevant quantities (mean activities, correlation shapes and sizes) in simulated networks of binary and spiking neurons within the given bounds.  #@NEW_LINE#@#  Reducing the number of neurons only increases correlation magnitudes without affecting their structure in this approximation.However, strong deviations from the assumptions of the diffusion approximation can cause also correlation structure to change in simulated networks under scalings originally constructed to maintain correlation structure.  #@NEW_LINE#@#  This occurs for instance when a drastic reduction in network size is coupled with a less than proportional reduction in in-degrees, leading to large numbers of common inputs and increased synchrony.  #@NEW_LINE#@#  Thus, the scalability of the number of neurons with available analytical results is indirectly limited by the minimal in-degree scaling factor.  #@NEW_LINE#@#  

In conclusion, we have identified limits to the reducibility of neural networks, even when only considering first- and second-order statistical properties.  #@NEW_LINE#@#  Networks are inevitably irreducible in some sense, in that downscaled networks are clearly not identical to their full-scale counterparts.  #@NEW_LINE#@#  However, mean activity, a first-order macroscopic quantity, can usually be preserved.  #@NEW_LINE#@#  The present work makes it clear that non-reducibility already sets in at the second-order macroscopic level of correlations.  #@NEW_LINE#@#  This does not imply a general minimal size for network models to be valid, merely that each network in question needs to be studied near its natural size to verify results from any scaled versions.  #@NEW_LINE#@#  
Our analytical theory is based on the diffusion approximation, in which inputs are treated as Gaussian noise, valid in the asynchronous irregular regime when activities are sufficiently high and synaptic weights are small.  #@NEW_LINE#@#  Moreover, external inputs are taken to be independent across populations, and delays and time constants are assumed to be unchanged under scaling.  #@NEW_LINE#@#  A further assumption of the theory is that the dynamics is stationary and linearly stable.  #@NEW_LINE#@#  
The one-to-one correspondence between effective connectivity and correlations applies with a few exceptions.  #@NEW_LINE#@#  For non-identical populations with different impulse responses, an analysis in the frequency domain demonstrates the equivalence under the assumption that the correlation matrix is invertible.  #@NEW_LINE#@#  An argument that assumes a diagonalizable effective connectivity matrix extends the equivalence to identical populations apart from cases where the effective connectivity matrix has eigenvalues that are zero or degenerate.  #@NEW_LINE#@#  
The equivalence of correlations and effective connectivity ties in with efforts to infer structure from activity, not only in neuroscience [59, 60, 61, 62, 63, 64, 65, 66] but also in other disciplines [67, 68, 69], as it implies that one should in principle be able to find the onlyand therefore the realeffective connectivity that accounts for the correlations.  #@NEW_LINE#@#  Within the same framework as that used here, [65] shows that knowledge of the cross-spectrum at two distinct frequencies allows a unique reconstruction of the effective connectivity matrix by splitting the covariance matrix into symmetric and antisymmetric parts.  #@NEW_LINE#@#  The derivation considers a class of transfer functions (the Fourier transform of the neuronal impulse response) rather than any specific form, but the transfer function is taken to be unique, whereas the present work allows for differences between populations.  #@NEW_LINE#@#  Furthermore, we here present a more straightforward derivation of the equivalence, not focused on the practical aim of network reconstruction, and clarify the conditions under which reconstruction is possible.  #@NEW_LINE#@#  
In practice, using our results to infer structure from correlations may not be straightforward, due to both deviations from the assumptions of the theory and problems with measuring the relevant quantities.  #@NEW_LINE#@#  For instance, neural activity is often nonstationary [70], transfer functions are normally not measured directly, and correlations are imperfectly known due to measurement noise.  #@NEW_LINE#@#  Furthermore, inference of anatomical from functional connectivity (correlations) is often done based on functional magnetic resonance imaging (fMRI) measurements, which are sensitive only to very low frequencies and therefore only allow the symmetric part of the effective connectivity to be reliably determined [66].  #@NEW_LINE#@#  The presence of unobserved populations providing correlated input to two or more observed populations can also hinder inference of network structure.  #@NEW_LINE#@#  Thus, high-resolution measurements (e.g., two-photon microscopy combined with optogenetics to record activity in a cell-type-specific manner [71, 72]) of networks with controlled input (e.g., in brain slices) hold the most promise for network reconstruction from correlations.  #@NEW_LINE#@#  
The effects on correlation-based synaptic plasticity of scaling-related changes in correlations may be partly compensated for by adjusting the learning parameters.  #@NEW_LINE#@#  For instance, an increase in average correlation size with factor 1/N without a change in temporal shape may be to some extent countered by reducing the learning rate by the same factor.  #@NEW_LINE#@#  Changes in the temporal structure of the correlations are more difficult to compensate for.  #@NEW_LINE#@#  When learning is linear or slow, so that the learning function can be approximated as constant (independent of the weights), the mean drift in the synaptic weights is determined by the integral of the product of the correlations and the learning function [73, 74].  #@NEW_LINE#@#  Therefore, this mean drift may be kept constant under a change in correlation shapes by adjusting the learning function such that this product is preserved for all time lags.  #@NEW_LINE#@#  However, given that the expression for the correlations is a complicated function of the network parameters, the required adjustment of the learning function will also be complex.  #@NEW_LINE#@#  Moreover, the effects of this adjustment on precise patterns of weights are difficult to predict, since the distribution of correlations between neuron pairs may change under the proposed scalings, and this solution does not apply when learning is fast and weight-dependent.  #@NEW_LINE#@#  
The groundbreaking work of [46] identified a dynamic balance between excitation and inhibition as a mechanism for the asynchronous irregular activity in cortex, and showed that  can robustly lead to a balanced state in the limit N   for constant K/N.  #@NEW_LINE#@#  However, it is not necessary to scale synaptic weights as  in order to obtain a balanced network state, even in the limit of infinite network size (and infinite K).  #@NEW_LINE#@#  For instance, J  1/K can retain balance in the infinite size limit in the sense that the sum of the excitatory and inhibitory inputs is small compared to each of these inputs separately.  #@NEW_LINE#@#  To retain irregular activity with this scaling one merely needs to ensure a variable external drive, as the internal variance vanishes for N  .  #@NEW_LINE#@#  Moreover, in binary networks with neurons that have a Heaviside gain function (a hard threshold) identical across neurons, one does not even need a variable drive in order to stay in a balanced state [46, p. 1360].  #@NEW_LINE#@#  This can be seen from a simple example of a network of N excitatory and N inhibitory neurons with random connectivity with probability p, where J = J0/N  0 is the synaptic amplitude of an excitatory synapse, and gJ the amplitude of an inhibitory synapse.  #@NEW_LINE#@#  The network may receive a DC drive, which we absorb into the threshold .  #@NEW_LINE#@#  The summed input to each cell is then  = pNJ(1  g) n, where n  [0, 1] is the mean activity in the network.  #@NEW_LINE#@#  For a balanced state to arise, the negative feedback must be sufficiently strong, so that the mean activity n settles on a level where the summed input is close to the threshold   .  #@NEW_LINE#@#  This will always be achieved if pJ0(1  g) less_than  less_than 0: in a completely activated network (n = 1) the summed input is below threshold, and in a silent network (n = 0) the summed input is above threshold, hence the activity will settle close to the value n  /[pJ0(1  g)].  #@NEW_LINE#@#  As the variance of the synaptic input decreases with network size, the latter estimate of the mean activity will become exact in the limit N  .  #@NEW_LINE#@#  The underlying reason for both 1/K and  scaling to lead to a qualitatively identical balanced state is the absence of a characteristic scale on which to measure the synaptic input: the threshold is hard.  #@NEW_LINE#@#  Only by introducing a characteristic scale, for example distributed values for the thresholds, the 1/K scaling with a DC drive will in the large N limit lead to a freezing of the balanced state due to the vanishing variance of the summed input, while with either  scaling, or 1/K scaling with a fluctuating external drive, the balanced state is conserved.  #@NEW_LINE#@#  
In [46],  refers not only to a comparison between differently-sized networks, but also to the assumption that approximately  excitatory synapses need to be active to reach spike threshold.  #@NEW_LINE#@#  However, this is also not a necessary condition for balance, which can arise for a wide range of synaptic strengths relative to threshold, as long as inhibition is sufficiently strong compared to excitation.  #@NEW_LINE#@#  As discussed in Correlation-preserving scaling, with appropriately chosen external drive, J even drops out of the mean-field theory for binary networks with a Heaviside gain function altogether [52].  #@NEW_LINE#@#  The difficulty in the interpretation of the [46] results illustrates a more general point: The primary goal of scaling studies is to identify the mechanisms governing network dynamics.  #@NEW_LINE#@#  Nevertheless, these studies usually also specify requirements on the robustness of the mechanism, leading to scaling laws for network parameters that may be more restrictive than a description of the mechanism per se.  #@NEW_LINE#@#  An example is the robustness to strong synapses, defined such that activation of  excitatory synapses suffices to reach threshold in the absence of an external drive [46, p. 1324].  #@NEW_LINE#@#  This scenario was considered in order to create a condition under which dynamic balance is clearly necessary for achieving asynchronous irregular activity in balanced random networks, since combined inputs would otherwise far exceed the threshold.  #@NEW_LINE#@#  However, dynamic balance can arise also with weak synapses, e.g., with strength  1/K of the distance to threshold.  #@NEW_LINE#@#  Without questioning the value of scaling studies, which can distill essential mechanisms and are sometimes possible where finite-size analytical descriptions are intractable, this shows that scaling laws need to be interpreted with care.  #@NEW_LINE#@#  
The issue of the interrelation between network size, synaptic strengths, numbers of synapses per neuron, and activity is embedded in the wider context of anatomical and physiological scaling laws observed experimentally.  #@NEW_LINE#@#  In homeostatic synaptic plasticity, synaptic strengths are adjusted in a manner that keeps the activity of the postsynaptic neurons within a certain operating range [75, 76, 77].  #@NEW_LINE#@#  Since postsynaptic activity depends not only on the strength of inputs but also on their number, this may induce a correlation between synaptic strengths and in-degree.  #@NEW_LINE#@#  In line with this hypothesis, excitatory postsynaptic currents (EPSCs) at single synapses were found to be inversely related to the density of active synapses onto cultured hippocampal neurons [78], and the size of both miniature EPSCs and evoked EPSCs between neurons decreased with network size and with the number of synapses per neuron in patterned cultures [79], although contrasting results have also been reported [80, 81].  #@NEW_LINE#@#  In the development of a mammal, the neuronal network grows by orders of magnitude and is continuously modified.  #@NEW_LINE#@#  For instance, the amplitude of miniature EPSCs is reduced in a period of heightened synaptogenesis in rat primary visual cortex [82].  #@NEW_LINE#@#  During such developmental processes, some functions are conserved and new functions emerge.  #@NEW_LINE#@#  This balance between stability and flexibility is an intriguing theoretical problem.  #@NEW_LINE#@#  Here, network scaling is deeply related to biological principles.  #@NEW_LINE#@#  Our results open up a new perspective for analyzing and interpreting such biological scaling laws.  #@NEW_LINE#@#  
Certainly, most network models will not fit neatly into the categories considered here, and detailed models often provide valuable insights regardless of whether they are scaled in a systematic manner.  #@NEW_LINE#@#  Nevertheless, it is usually possible to at least mention whether and how a particular model is scaled.  #@NEW_LINE#@#  When the results are not amenable to mathematical analysis, we suggest investigating through simulations of networks of different sizes how essential characteristics depend on numbers of neurons and synapses (the relevant characteristics depend on the model at hand, and do not necessarily include mean activities or correlations).  #@NEW_LINE#@#  Thus, while both the investigation of the infinity limit and the exploration of downscaled networks remain powerful methods of computational neuroscience, we argue for a more careful approach to network scaling than has hitherto been customary, making the type of scaling and its consequences explicit.  #@NEW_LINE#@#  Fortunately, in neuroscience full-scale simulations are now becoming routinely possible due to the technological advances of recent years.  #@NEW_LINE#@#  

Methods  #@NEW_LINE#@#  
Software  #@NEW_LINE#@#  
We verify analytical results for networks of binary neurons and networks of spiking neurons using direct simulations performed with NEST [83] revisions 10711 and 11264 for the spiking networks and revision 11540 for the binary networks.  #@NEW_LINE#@#  For simulating the multi-layer microcircuit model, PyNN version 0.7.6 (revision 1312) [84] was used with NEST 2.6.0 as back end, single-threaded on 12 MPI processes on a high-performance cluster.  #@NEW_LINE#@#  All simulations have a time step of 0.1 ms. Spike times in the microcircuit model are constrained to the grid.  #@NEW_LINE#@#  The other spiking network simulations use precise spike timing [85].  #@NEW_LINE#@#  In part, Sage was used for symbolic linear algebra [86].  #@NEW_LINE#@#  Pre- and post-processing and numerical analysis were performed with Python.  #@NEW_LINE#@#  

Network_structure_and_notation  #@NEW_LINE#@#  
For both the binary and the spiking networks, we derive analytical results where both the number of populations Npop and the population-level connectivity are arbitrary.  #@NEW_LINE#@#  Specific examples are given of networks with a single, inhibitory population, or with two populations (one excitatory, one inhibitory) with either population-specific or population-independent connectivities.  #@NEW_LINE#@#  In addition, we discuss a multi-layer spiking cortical microcircuit model consisting of 77,169 neurons with approximately 3 Ã 108 synapses, with eight populations (2/3E, 2/3I, 4E, 4I, 5E, 5I, 6E, 6I) and population-specific connection probabilities [58], slightly adjusted to enhance the asynchrony of the activity.  #@NEW_LINE#@#  The adjustments consist of replacing normally by lognormally distributed weights with the same mean and with coefficient of variation 3; and using 4.5 instead of 4 as the relative strength of synapses from 4I to 4E compared to excitatory synaptic strengths.  #@NEW_LINE#@#  Besides distributed synaptic strengths, the model has binomially distributed in- and out-degrees, and normally distributed delays (clipped at the simulation time step), thereby deviating from the assumptions of our analytic theory.  #@NEW_LINE#@#  It thus serves to evaluate the robustness of our analytical results to such deviations from the underlying assumptions.  #@NEW_LINE#@#  
In all cases, pairs of populations are randomly connected.  #@NEW_LINE#@#  In the binary and one- and two-population LIF network simulations, in-degrees are fixed and multiple directed connections between pairs of neurons (multapses) are disallowed.  #@NEW_LINE#@#  In the multi-layer microcircuit model, in-degrees are distributed and multapses are allowed.  #@NEW_LINE#@#  In case of population-specific connectivities, we denote the (unique or mean) in-degree for connections from population  to population  by K, and synaptic strengths by J.  #@NEW_LINE#@#  Population sizes are denoted by N. For the example networks with population-independent connection probability, we denote the size of the excitatory population by N, the in-degree from excitatory neurons by K = pN, and the size of the inhibitory relative to the excitatory population by , so that the inhibitory in-degree is K. Synaptic strengths are also taken to only depend on the source population, and are written as J for excitatory and gJ for inhibitory synapses.  #@NEW_LINE#@#  

Binary_network_dynamics  #@NEW_LINE#@#  
We denote the activity of neuron j by nj(t).  #@NEW_LINE#@#  The state nj(t) of a binary neuron is either 0 or 1, where 1 indicates activity, 0 inactivity [7, 42, 87].  #@NEW_LINE#@#  The state of the network of N such neurons is described by a binary vector n = (n1, , nN)  {0,1}N. We denote the mean activity by nj(t)t, where the average t is over time and realizations of the stochastic activity.  #@NEW_LINE#@#  The neuron model shows stochastic transitions (at random points in time) between the two states 0 and 1.  #@NEW_LINE#@#  In each infinitesimal interval [t, t + t), each neuron in the network has the probability  to be chosen for update [88], where  is the time constant of the neuronal dynamics.  #@NEW_LINE#@#  We use an equivalent implementation in which the time points of update are drawn independently for all neurons.  #@NEW_LINE#@#  For a particular neuron, the sequence of update points has exponentially distributed intervals with mean duration , i.e., update times form a Poisson process with rate 1.  #@NEW_LINE#@#  The stochastic update constitutes a source of noise in the system.  #@NEW_LINE#@#  Given that the j-th neuron is selected for update, the probability to end in the up state (nj = 1) is determined by the gain function Fj(n(t)) = (k Jjk nk(t)  ) which in general depends on the activity n of all other neurons.  #@NEW_LINE#@#  Here  denotes the threshold of the neuron and (x) the Heaviside function.  #@NEW_LINE#@#  The probability of ending in the down state (nj = 0) is 1  Fj(n).  #@NEW_LINE#@#  This model has been considered previously [42, 87, 89], and here we follow the notation introduced in [87] that we also employed in our earlier works.  #@NEW_LINE#@#  We skip details of the derivation here that are already contained in [9].  #@NEW_LINE#@#  

First_and_second_moments_of_activity_in_the_binary_network  #@NEW_LINE#@#  
The combined distribution of large numbers of independent inputs can be approximated as a Gaussian (, 2) by the central limit theorem.  #@NEW_LINE#@#  The arguments  and  are the mean and standard deviation of the synaptic input noise, together referred to as the working point [cf.  #@NEW_LINE#@#  Eqs (3) and (4)].  #@NEW_LINE#@#  The stationary mean activity of a given population of neurons then obeys [7, 9, 46, 52]  #@NEW_LINE#@#  
(39)  #@NEW_LINE#@#  
This equation needs to be solved self-consistently because n influences ,  through interactions within the population itself and with other populations.  #@NEW_LINE#@#  
When network activity is stationary, the covariance of the activities of a pair (j, k) of neurons is defined as cjk() = nj(t + )nk(t)t, where nj(t) = nj(t)  nj(t)t is the deviation of neuron js activity from expectation, and  is a time lag.  #@NEW_LINE#@#  Instead of the raw correlation nj(t + )nk(t)t, here and for the spiking networks we measure the covariance, i.e., the second centralized moment, which is also identical to the second cumulant.  #@NEW_LINE#@#  To derive analytical expressions for the covariances in binary networks in the asynchronous regime, we follow the theory developed in [7, 9, 42, 52, 53].  #@NEW_LINE#@#  We first consider the case of vanishing transmission delays d = 0 and then discuss networks with delays.  #@NEW_LINE#@#  
Let  #@NEW_LINE#@#  
(40)  #@NEW_LINE#@#  
be the covariance averaged over disjoint pairs of neurons in two (possibly identical) populations , , and  the population-averaged single-neuron variance aj() = nj(t + )nj(t)t. Note that for  =  there are only N(N  1) disjoint pairs of neurons, so c differs from the average pairwise cross-correlation by a factor (N  1)/N, but we choose this definition because it slightly simplifies the population-level equations.  #@NEW_LINE#@#  For sufficiently weak synapses and sufficiently high firing rates, and when higher-order correlations can be neglected, a linearized equation relating these quantities can be derived for the case d = 0 ([42] Eqs (9.14)(9.16); [7] supplementary material Eq (36), [9] Eq (10)),  #@NEW_LINE#@#  
(41)  #@NEW_LINE#@#  
Here, we have assumed identical time constants across populations, and  #@NEW_LINE#@#  
(42)  #@NEW_LINE#@#  
is the linearized effective connectivity.  #@NEW_LINE#@#  The susceptibility S is defined as the slope of the gain function averaged over the noisy input to each neuron [9, 52, 53], reducing for a Heaviside gain function to  #@NEW_LINE#@#  
(43)  #@NEW_LINE#@#  
With the definitions  #@NEW_LINE#@#  
(44) (45) Eq (41) is recognized as a continuous Lyapunov equation  #@NEW_LINE#@#  
(46)  #@NEW_LINE#@#  
which can be solved using known methods.  #@NEW_LINE#@#  Let vj,uk be the left and right eigenvectors of W, with eigenvalues j and k, respectively.  #@NEW_LINE#@#  Choose the normalization such that the left and right eigenvectors are biorthogonal,  #@NEW_LINE#@#  
(47)  #@NEW_LINE#@#  
Then multiplying Eq (46) from the left with vjT and from the right with vk yields  #@NEW_LINE#@#  
(48)  #@NEW_LINE#@#  
Define  #@NEW_LINE#@#  
(49)  #@NEW_LINE#@#  
for .  #@NEW_LINE#@#  Then solving Eq (48) for  gives  #@NEW_LINE#@#  
(50)  #@NEW_LINE#@#  
as can be verified using Eq (47).  #@NEW_LINE#@#  This provides an approximation of the population-averaged zero-lag correlations, including contributions from both auto- and cross-correlations.  #@NEW_LINE#@#  
To determine the temporal structure of the population-averaged cross-correlations, we start from the single-neuron level, for which the correlations approximately obey ([53] Eq (29))  #@NEW_LINE#@#  
(51)  #@NEW_LINE#@#  
where wij is the neuron-level effective connectivity (wij = Si Jij if a connection exists and wij = 0 otherwise).  #@NEW_LINE#@#  This equation also holds on the diagonal, j = k. To obtain the population-level equation, we use Eqs (40) and (44) and count the numbers of connections, which yields a factor K for each projection.  #@NEW_LINE#@#  Eq (51) then becomes  #@NEW_LINE#@#  
(52)  #@NEW_LINE#@#  
This step from the single-neuron to the population level constitutes an approximation when the out-degrees are distributed, but is exact for fixed out-degree [8, 53].  #@NEW_LINE#@#  The correlations for  less_than 0 are determined by .  #@NEW_LINE#@#  With the definition Eq (49), Eq (52) yields  #@NEW_LINE#@#  
(53)  #@NEW_LINE#@#  
Using the initial condition for  from Eq (50) and multiplying Eq (53) by uj ukT, summing over j and k, we obtain the solution  #@NEW_LINE#@#  
(54)  #@NEW_LINE#@#  
The shape of the autocovariances is well approximated by that for isolated neurons, , with corrections due to interactions being O(1/N) [42].  #@NEW_LINE#@#  Substituting this form in Eq (54) leads to  #@NEW_LINE#@#  
(55)  #@NEW_LINE#@#  
equivalent to [42] Eq (6.20).  #@NEW_LINE#@#  Note that this equation still needs to be solved self-consistently, because the variance of the inputs to the neurons, which goes into S(, ), depends on the correlations.  #@NEW_LINE#@#  However, correlations tend to contribute only a small fraction of the input variance in the asynchronous regime (cf.  #@NEW_LINE#@#  [9] Fig 3D).  #@NEW_LINE#@#  The accuracy of the result Eq (55) is illustrated in Fig 3A for a network with parameters given in Table 1 by comparison with a direct simulation.  #@NEW_LINE#@#  Note that the delays were not zero but equal to the simulation time step of 0.1 ms, sufficiently small for the correlations to be well approximated by Eq (55).  #@NEW_LINE#@#  
Now consider arbitrary transmission delay d  0, and let both d and the input statistics be population-independent.  #@NEW_LINE#@#  This case is most easily approached from the Fourier domain, where the population-averaged covariances including autocovariances can be approximated as [53]  #@NEW_LINE#@#  
(56)  #@NEW_LINE#@#  
Here, H() is the transfer function  #@NEW_LINE#@#  
(57)  #@NEW_LINE#@#  
which is equal for all populations under the assumptions made.  #@NEW_LINE#@#  The transfer function is the Fourier transform of the impulse response, which is a jump followed by an exponential relaxation,  #@NEW_LINE#@#  
(58)  #@NEW_LINE#@#  
where  is the Heaviside step function.  #@NEW_LINE#@#  
For the case of population-independent H(), Fourier back transformation to the time domain is feasible, and was performed in [53] for symmetric connectivity matrices.  #@NEW_LINE#@#  Here, we consider generic connectivity (insofar as consistent with equal H()), and again use projection onto the eigenspaces of W to obtain a form similar to Eq (55), i.e., insert the identity matrix  #@NEW_LINE#@#  
(59)  #@NEW_LINE#@#  
both on the left and on the right of Eq (56), and Fourier transform to obtain  #@NEW_LINE#@#  
(60)  #@NEW_LINE#@#  
In the third line of Eq (60), we used Ajk = vjT A vk and collected the frequency-dependent terms for clarity.  #@NEW_LINE#@#  The exponential ei does not have any poles, so the only poles stem from fjk, which we denote by zl(j) and the corresponding residues by Resj,k[zl(j)].  #@NEW_LINE#@#  We only need to consider   0, since the solution for negative lags follows from .  #@NEW_LINE#@#  The equation can then be solved by contour integration over the upper half of the complex plane, as the integrand vanishes at   +i.  #@NEW_LINE#@#  Stability requires that the poles of the first term of Eq (60) lie only in the upper half plane (note that the linear approximation we have employed only applies in the stable regime).  #@NEW_LINE#@#  The poles of the second term correspondingly lie in the lower half plane and hence need not be considered.  #@NEW_LINE#@#  For d  0, the locations of the poles are given by [53] Eq (12),  #@NEW_LINE#@#  
(61)  #@NEW_LINE#@#  
where Wl is the lth of the infinitely many branches of the Lambert-W function defined by x = W(x)eW(x) [90].  #@NEW_LINE#@#  For d = 0, the poles are .  #@NEW_LINE#@#  Using the residue theorem thus brings Eq (60) into the form  #@NEW_LINE#@#  
(62)  #@NEW_LINE#@#  
where I() = 1 is the winding number of the contour  around the poles.  #@NEW_LINE#@#  To see that Eq (62) reduces to Eq (55) when d = 0, substitute the poles in the upper half plane  with residues [i(2  j  k)]1 and note that .  #@NEW_LINE#@#  
When the input statistics and hence transfer functions are population-specific, Eq (56) becomes  #@NEW_LINE#@#  
(63) (64)  #@NEW_LINE#@#  
where M() = H()W.  #@NEW_LINE#@#  

Spiking_network_dynamics  #@NEW_LINE#@#  
The spiking networks consist of single-compartment leaky integrate-and-fire neurons with exponential current-based synapses.  #@NEW_LINE#@#  The subthreshold dynamics of neuron i is given by  #@NEW_LINE#@#  
(65)  #@NEW_LINE#@#  
where we have set the resting potential to zero without loss of generality, and absorbed the membrane resistance into the synaptic current Ii, in line with previous works [45, 91].  #@NEW_LINE#@#  Bringing back the corresponding parameters, the dynamics reads  #@NEW_LINE#@#  
(66)  #@NEW_LINE#@#  
Thus, our scaled synaptic amplitudes Jij in terms of the amplitudes  of the synaptic current due to a single spike are .  #@NEW_LINE#@#  Here, m and s are membrane and synaptic time constants, EL is the leak or resting potential, Rm is the membrane resistance, d is the transmission delay,  is the total synaptic current, and  are the incoming spike trains.  #@NEW_LINE#@#  When Vi reaches a threshold , a spike is assumed, and the membrane potential is clamped to a level Vr for a refractory period ref.  #@NEW_LINE#@#  Threshold and reset potential in physical units are shifted by the leak potential (, ), showing that the assumption EL = 0 in Eq (65) does not limit generality.  #@NEW_LINE#@#  The intrinsic dynamics of the neurons in the different populations are taken to be identical, so that population differences are only expressed in the couplings.  #@NEW_LINE#@#  

First_and_second_moments_of_activity_in_the_spiking_network  #@NEW_LINE#@#  
An approximation of the stationary mean firing rate of LIF networks with exponential current-based synapses was derived in [91],  #@NEW_LINE#@#  
(67)  #@NEW_LINE#@#  
where the summed synaptic input is characterized by a Gaussian noise with first moment  and second moment 2 based on the diffusion approximation, and  is the Riemann zeta function.  #@NEW_LINE#@#  
For the covariances, we follow and extend the theory developed in [45, 53], starting with the average influence of a single synapse.  #@NEW_LINE#@#  Assuming that the network is in the asynchronous state, and that synaptic amplitudes are small, the synaptic influences can be averaged around the mean activity rj of each neuron j.  #@NEW_LINE#@#  These influences are characterized by linear response kernels hjk(t, t) defined as the derivative of the density of spikes of spike train sj(t) of neuron j with respect to an incoming spike train sk(t), averaged over realizations of the remaining incoming spike trains s\sk that act as noise.  #@NEW_LINE#@#  In the stationary state, the kernel only depends on the time difference t  t, giving  #@NEW_LINE#@#  
 (68)  #@NEW_LINE#@#  
where sj  sj  rj is the j-th centralized (zero-mean) spike train.  #@NEW_LINE#@#  Here, wjk is the integral of hjk(t  t), and h(t  t) is a normalized function capturing its time dependence, which may be source- and target-specific.  #@NEW_LINE#@#  The dimensionless effective weights wjk are determined nonlinearly by the synaptic strengths Jjk, the single-neuron parameters, and the working point (j,j) (cf.  #@NEW_LINE#@#  [45] Eq (A.3) but note that  as given there has a spurious factor J).  #@NEW_LINE#@#  We approximate the impulse response by the form Eq (58), where  is now an effective time constant depending on the working point (j,j) and the parameters of the target neurons.  #@NEW_LINE#@#  This form of the impulse response, corresponding to a low-pass filter, appears to be a good approximation in the noisy regime when the neuron fires irregularly.  #@NEW_LINE#@#  In the mean-driven regime (  ) the transfer function of the LIF neuron is known to exhibit resonant behavior with a peak close to its firing rate.  #@NEW_LINE#@#  In this regime a single exponential response kernel is expected to be a poor approximation (see, e.g., [92] Fig 1).  #@NEW_LINE#@#  In general, the source population dependence of Eq (58) comes in through the delay d, and the target population dependence through both  and d.  #@NEW_LINE#@#  
As for binary networks with delays, the average pairwise covariance functions cij()  si(t + )sj(t)t are most conveniently derived starting from the frequency domain.  #@NEW_LINE#@#  In case of identical transfer functions for all populations, the matrix of average cross-covariances is given by [53] Eq (16) minus the autocovariance contribution,  #@NEW_LINE#@#  
(69)  #@NEW_LINE#@#  
Here, W contains the effective weights of single synapses from population  to population  times the corresponding in-degrees, w K; and A contains the population-averaged autocovariances, which we approximate as , with r the mean firing rate, as also done in [45].  #@NEW_LINE#@#  In [53], Eq (69) was written using a more general diagonal matrix instead of A, to help clarify close similarities between binary and LIF networks and Ornstein-Uhlenbeck processes or linear rate models; however, for LIF networks, this diagonal matrix corresponds precisely to the autocovariance matrix.  #@NEW_LINE#@#  We chose the form Eq (69) because it separates terms that vanish at either   i or   i depending on .  #@NEW_LINE#@#  This facilitates Fourier back transformation, as contour integration with an appropriate contour can be used for each term.  #@NEW_LINE#@#  
To perform the Fourier back transformation, we apply the same method as used for the binary network.  #@NEW_LINE#@#  Let vj,uj be the left and right eigenvectors of the connectivity matrix W, and j the corresponding eigenvalues.  #@NEW_LINE#@#  Insert j uj vjT =  into Eq (69) on the left and right, and Fourier transform,  #@NEW_LINE#@#  
(70)  #@NEW_LINE#@#  
As for the binary case, we only need to consider   0, as the solution for  less_than 0 is given by c() = cT().  #@NEW_LINE#@#  The contour can then be closed over the upper half plane, where the term containing only H() has no poles due to the stability condition.  #@NEW_LINE#@#  When  less_than d, the contour for the term containing only H() can also be closed in the lower half plane where it has no poles, so that the corresponding integral vanishes.  #@NEW_LINE#@#  Analogously, the integral of the term with only H() vanishes when 0    d. Therefore, the second and third terms represent echoes of spikes arriving after one transmission delay [53].  #@NEW_LINE#@#  For  = 0 and d  0, only the first term contributes, and the contour can be closed in either half plane.  #@NEW_LINE#@#  As before, the poles are given by Eq (61) for d  0, and by  for d = 0.  #@NEW_LINE#@#  The residue theorem yields a solution of the form Eq (62), the only difference being the precise form of the residues, and the fact that we here consider c as opposed to .  #@NEW_LINE#@#  
In the absence of delays, an explicit solution can again be derived.  #@NEW_LINE#@#  For   0, the poles inside the contour are  corresponding to the terms with H()1.  #@NEW_LINE#@#  The residue corresponding to  is , and the term  is finite and evaluates at the pole to .  #@NEW_LINE#@#  Using Ajk = vjT A vk we get  #@NEW_LINE#@#  
(71)  #@NEW_LINE#@#  
which is reminiscent of but not identical to Eq (55) for the binary network.  #@NEW_LINE#@#  Note that Eq (71) for the LIF network corresponds to spike train covariances with the dimensionality of 1/t2 due to [Ajk] = [1/t] and the factor 1/, whereas the covariances for the binary network are dimensionless.  #@NEW_LINE#@#  
The population-specific generalization of Eq (69) reads  #@NEW_LINE#@#  
(72)  #@NEW_LINE#@#  
where M() has elements H()K w, as before.  #@NEW_LINE#@#  The covariance matrix including autocovariances can be more simply written as  #@NEW_LINE#@#  
(73)  #@NEW_LINE#@#  
The only difference compared to the expression Eq (63) for the binary network is the form of the diagonal matrix, here analogous to white output noise in a linear rate model, whereas the binary network resembles a linear rate model with white noise on the input side, which is passed through the transfer function before affecting the correlations [53].  #@NEW_LINE#@#  

Fluctuating_rate_equation_and_stability_condition  #@NEW_LINE#@#  
An alternative description of the spiking dynamics can be obtained by considering a system of linear coupled rate equations that produces the same moments to second order as the spiking dynamics [53].  #@NEW_LINE#@#  The convolution equation  #@NEW_LINE#@#  
(74)  #@NEW_LINE#@#  
with pairwise uncorrelated white noises xj and the response kernel hjk given by Eq (68) can be shown to yield a cross-covariance matrix of the form Eq (69) by considering the Fourier transform of Eq (74), written in matrix notation as  #@NEW_LINE#@#  
(75)  #@NEW_LINE#@#  
We can expand the latter equation into eigenmodes by multiplying from the left with the left-sided eigenvector vk of W and by writing the general solution as a linear combination of right-sided eigenmodes Y() = j j() uj to obtain (with the bi-orthogonality relation vkT uj = kj)  #@NEW_LINE#@#  
(76)  #@NEW_LINE#@#  
The latter equation shows that the same poles z(k) that appear in the covariance function Eq (70) also determine the evolution of the effective rate equation.  #@NEW_LINE#@#  Moreover, transforming Eq (76) back to the time domain, we see with  #@NEW_LINE#@#  

that the eigenmodes have a time evolution determined by eiz(k)t. Hence the imaginary part of the pole z(k) controls whether the mode is exponentially growing (Im(z) less_than 0) or decaying (Im(z)  0), while the real part determines the oscillation frequency.  #@NEW_LINE#@#  




