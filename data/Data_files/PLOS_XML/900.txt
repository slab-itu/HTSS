article id="http://dx.doi.org/10.1371/journal.pcbi.1005148"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Error-Robust Modes of the Retinal Population Code  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Across the nervous system, certain population spiking patterns are observed far more frequently than others.  #@NEW_LINE#@#  A hypothesis about this structure is that these collective activity patterns function as population codewordscollective modescarrying information distinct from that of any single cell.  #@NEW_LINE#@#  We investigate this phenomenon in recordings of 150 retinal ganglion cells, the retinas output.  #@NEW_LINE#@#  We develop a novel statistical model that decomposes the population response into modes; it predicts the distribution of spiking activity in the ganglion cell population with high accuracy.  #@NEW_LINE#@#  We found that the modes represent localized features of the visual stimulus that are distinct from the features represented by single neurons.  #@NEW_LINE#@#  Modes form clusters of activity states that are readily discriminated from one another.  #@NEW_LINE#@#  When we repeated the same visual stimulus, we found that the same mode was robustly elicited.  #@NEW_LINE#@#  These results suggest that retinal ganglion cells collective signaling is endowed with a form of error-correcting codea principle that may hold in brain areas beyond retina.  #@NEW_LINE#@#  

Author_Summary  #@NEW_LINE#@#  
Neurons in most parts of the nervous system represent and process information in a collective fashion, yet the nature of this collective code is poorly understood.  #@NEW_LINE#@#  An important constraint placed on any such collective processing comes from the fact that individual neurons signaling is prone to corruption by noise.  #@NEW_LINE#@#  The information theory and engineering literatures have studied error-correcting codes that allow individual noise-prone coding units to check each other, forming an overall representation that is robust to errors.  #@NEW_LINE#@#  In this paper, we have analyzed the population code of one of the best-studied neural systems, the retina, and found that it is structured in a manner analogous to error-correcting schemes.  #@NEW_LINE#@#  Indeed, we found that the complex activity patterns over ~150 retinal ganglion cells, the output neurons of the retina, could be mapped onto collective code words, and that these code words represented precise visual information while suppressing noise.  #@NEW_LINE#@#  In order to analyze this coding scheme, we introduced a novel quantitative model of the retinal output that predicted neural activity patterns more accurately than existing state-of-the-art approaches.  #@NEW_LINE#@#  

Citation: Prentice JS, Marre O, Ioffe ML, Loback AR, Tkaik G, Berry MJ II (2016) Error-Robust Modes of the Retinal Population Code.  #@NEW_LINE#@#  PLoS Comput Biol 12(11):  #@NEW_LINE#@#  
           e1005148.  #@NEW_LINE#@#  

        https://doi.org/10.1371/journal.pcbi.1005148  #@NEW_LINE#@#  
Editor: Ian H. Stevenson, University of Connecticut, UNITED STATES  #@NEW_LINE#@#  
Received: July 15, 2015; Accepted: September 15, 2016; Published:  November 17, 2016  #@NEW_LINE#@#  
Copyright:  Â© 2016 Prentice et al.  #@NEW_LINE#@#  This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.  #@NEW_LINE#@#  
Data Availability: All supporting data files are available from the Dryad database under doi:10.5061/dryad.1f1rc.  #@NEW_LINE#@#  
Funding: JSP was supported by a C.V. Starr Fellowship from the Starr Foundation (http://www.starrfoundation.org/).  #@NEW_LINE#@#  GT was supported by Austrian Research Foundation (https://www.fwf.ac.at/en/) grant FWF P25651.  #@NEW_LINE#@#  MJB received support from National Eye Institute (https://nei.nih.gov/) grant EY 14196 and from the National Science Foundation grant 1504977.  #@NEW_LINE#@#  The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  
Competing interests:  The authors have declared that no competing interests exist.  #@NEW_LINE#@#  
Introduction  #@NEW_LINE#@#  
Understanding the manner in which population of neurons encode information is fundamental to systems neuroscience.  #@NEW_LINE#@#  Recent years have seen rapid progress in experimental techniques for recording simultaneously from hundreds of neurons of more [15], which provide us with excellent access to the activity states of relevant neural populations.  #@NEW_LINE#@#  However, what continues to make this problem challenging and mathematically complex is the fact that collective neural activity patterns have enormous dimensionalityfor instance, if we only need to keep track of spiking or silence for each neuron, a population of N neurons still has 2N possible activity states [6, 7].  #@NEW_LINE#@#  While debate rages about the amplitude and significance of noise correlations [710], it is well established that nearby neurons have overlap in their receptive fields or tuning curves which introduces signal correlation and redundancy.  #@NEW_LINE#@#  Notwithstanding the popularity of ideas about efficient coding and redundancy reduction [11, 12], direct measurement reveals extensive information redundancy among neurons in many brain regions [1317].  #@NEW_LINE#@#  
One popular framework has been ring models or probabilistic population codes, in which a population of neurons with a spectrum of different tuning curves encode for scalar stimulus variables, such as neurons in V1 encoding the orientation of a bar of light [1821].  #@NEW_LINE#@#  Study of these models has revealed many important insights into population codes, such as the dramatic effect that weak pairwise correlations can have on the code of a large neural population as well as the sensitivity of these effects to the specific pattern of correlation among neurons [7, 18, 2224].  #@NEW_LINE#@#  However, the generalization of this framework to the high-dimensional stimuli that we often encounter in real life is not so obvious.  #@NEW_LINE#@#  
An alternative approach is to formulate approximate models of the probability distribution over all possible neural activity patterns [2527] and examine the structure of this entire probability landscape.  #@NEW_LINE#@#  An appealing hypothesis about the function of large populations of sensory neurons is that their combinatorially huge space of possible codewords could enable a form of error correction.  #@NEW_LINE#@#  Specifically, the high capacity N-dimensional coding space could be partitioned into subsets, and within each subset distinct words would be considered noise-corrupted versions of one another.  #@NEW_LINE#@#  The actual information conveyed by the channel is then the identity of the relevant subset, as opposed to the precise word within that subset.  #@NEW_LINE#@#  This qualitative picture is the intuitive basis of error-correcting codes [28]; it is natural to then ask whether the redundancy observed in local neural circuits is a signature of such codes being operative in the neural population.  #@NEW_LINE#@#  
In the retina, each image point is encoded by many ganglion cells with overlapping receptive fields [2931].  #@NEW_LINE#@#  The population code of the retinal ganglion cells is understood as having parallel channels of visual information: each channel is formed by ganglion cells of a single functional/morphological type, whose receptive fields tile visual space with minimal overlap, and each such mosaic conveys qualitatively different visual information to the brain using receptive fields with different spatiotemporal selectivity [32].  #@NEW_LINE#@#  The simplest idea is that different visual channels project to different targets in the central brain, thus subserving different visual behaviors.  #@NEW_LINE#@#  However, there are many ganglion cell types, at least 32 [31], and only two major targets in the central brain: the LGN and the superior colliculus.  #@NEW_LINE#@#  Furthermore, most ganglion cell axons branch and project to multiple targets [33].  #@NEW_LINE#@#  In fact, almost all of the ganglion cells send collaterals to the superior colliculus / optic tectum in many species [3437].  #@NEW_LINE#@#  
One might argue that different ganglion cell types segregate to different lamina in thalamus [38] and colliculus [39], thereby keeping the visual channels distinct.  #@NEW_LINE#@#  However, these channels recombine by synapsing into the same target neurons as early as layer 2/3 of the primary visual cortex [40] and the intermediate layers of the colliculus [41].  #@NEW_LINE#@#  Therefore, visual centers just beyond the retina are able to combine information across the different parallel channels.  #@NEW_LINE#@#  Important for the scope of population codes, correlation is significant between nearest neighbor ganglion cells in each mosaic [4244] as well as among ganglion cells of different functional type [13, 30, 45].  #@NEW_LINE#@#  And combinations of firing among multiple ganglion cells have been shown to encode different visual features than those encoded by the constituent cells [4648].  #@NEW_LINE#@#  As a result, populations of hundreds of neurons from a combinatorial neural code as early as the level of the retinal ganglion cells.  #@NEW_LINE#@#  
Since downstream areas infer visual information solely from the ganglion cell spike trains, this choice of readout must be derived from the statistical structure of the retinal population output.  #@NEW_LINE#@#  The question of optimal statistical structure over noisy, spiking sensory neurons has been investigated theoretically [49].  #@NEW_LINE#@#  In conditions of high noise, an error-correcting organization featuring discrete clusters of population words optimizes information transfer.  #@NEW_LINE#@#  Is this the case in real neural populations?  #@NEW_LINE#@#  In the present paper, we address this question empirically by fitting a statistical model to the retinal ganglion cell population representing a small visual patch, and show that a discrete population structure emerges from the model and naturally captures qualitatively important features of the visual stimulus.  #@NEW_LINE#@#  
We obtained multi-electrode array data from 150 salamander retinal ganglion cells simultaneously responding to various visual stimuli, including natural movies.  #@NEW_LINE#@#  Our electrode array covered a small, dense patch of retina, so that the cells in our recording had largely overlapping receptive fields conveying information about a restricted region of visual space [1].  #@NEW_LINE#@#  We then investigated a model in which the complex, fluctuating patterns of spikes across the population could be grouped into a modest number of collective modes.  #@NEW_LINE#@#  The possibility of this dimensionality reduction is a consequence of redundancy in the retinal code.  #@NEW_LINE#@#  Our model is highly tractable to fit, and allows for exact sampling from the probability distribution over retinal population response patterns.  #@NEW_LINE#@#  We found that this model provided an excellent description of the frequency of occurrence of activity patterns in the neural population, and we further investigated its implications for information encoding.  #@NEW_LINE#@#  After fitting the model, we inferred the temporal sequence of mode occurrence underlying the data.  #@NEW_LINE#@#  Population modes carried a detailed representation of the visual stimulus.  #@NEW_LINE#@#  Moreover, our model grouped spiking patterns together into discriminable modes in a manner reminiscent of error-correcting codes, and the modes were indeed far more reliable over repeated stimulus presentations than were individual spiking patterns.  #@NEW_LINE#@#  Thus, the organization of the activity states into collective modes may constitute an important aspect of the population neural code of retinal ganglion cells.  #@NEW_LINE#@#  We also note that nothing in our analysis methods was specific to the retina, and so this approach can be readily applied to population codes in other brain regions as well.  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
Decomposing_the_activity_states_of_the_retinal_ganglion_cell_population_into_collective_modes  #@NEW_LINE#@#  
We recorded spike trains from 152 retinal ganglion cells in response to a non-repeated natural movie stimulus (see Methods).  #@NEW_LINE#@#  In our recordings, the retinal population response was characterized by rapidly fluctuating groups of 10 neurons spiking simultaneously, interspersed with periods of relative quiescence (Fig 1A and 1B).  #@NEW_LINE#@#  If such patterns involve specific subsets of neurons firing together more regularly than expected by chance, they may represent distinct population code words that capture collective information not represented by single-cell responses alone.  #@NEW_LINE#@#  In this paper, we refer to these patterns as collective modes of the retinal ganglion cell population, and we investigate a model that explicitly captures their structure.  #@NEW_LINE#@#  
A natural way to incorporate such structure into a statistical model is by assuming the existence of a discrete set of hidden states representing the set of collective modes in the population, which we denote by the symbol .  #@NEW_LINE#@#  Modes were therefore described by a latent variable of our model that changed across time, (t).  #@NEW_LINE#@#  The observed pattern of population spiking at a given time then depends on the instantaneous mode present at that time.  #@NEW_LINE#@#  Since the observed spiking pattern depends upon unobserved stimulus- and noise-driven fluctuations, the spiking pattern {i(t)} will be generated probabilistically by the mode (t).  #@NEW_LINE#@#  To model this relationship quantitatively, we introduced for each mode a probability distribution over spiking patterns, Q({i}).  #@NEW_LINE#@#  This is the conditional distribution of the spike pattern given the mode, and is termed the modes emission distribution.  #@NEW_LINE#@#  
The mean of this distribution assigns to each cell, i, a mode-dependent firing probability mi = E[i|], where i = 1 if cell i spiked in a time bin, and i = 0 otherwise (see Methods).  #@NEW_LINE#@#  By associating to each mode a unique pattern of firing probability, with different subsets of cells likely to be active in different modes, many spiking patterns can be combined in a flexible way.  #@NEW_LINE#@#  Therefore, a latent variable model can, in principle, capture arbitrary patterns of high-order correlation among cells, even without incorporating complex correlations into the emission distributions Q({i}).  #@NEW_LINE#@#  However, we found that model performance was improved by the addition of weak mode-dependent correlations (see below, and Methods).  #@NEW_LINE#@#  After learning the model parameters (see Methods), we could then invert the model to infer the probability of each mode as a function of time (Fig 1C).  #@NEW_LINE#@#  Our techniques therefore allowed us to transform the observed population spike raster (Fig 1A) into a simpler representation, the temporal sequence of modes (Fig 1C).  #@NEW_LINE#@#  
Formally, we modeled population spiking activity with a hidden Markov model [50] (Fig 2).  #@NEW_LINE#@#  In order to better understand the full structure of this model, it is instructive to introduce features of the model sequentially.  #@NEW_LINE#@#  In the limit in which there are no temporal dependencies, this form reduces to a mixture model, in which the static probability distribution is described as a weighted sum over a set of emission distributions (Fig 2A).  #@NEW_LINE#@#  If there are no mode-dependent correlations among cells, then emission distributions are simply a product over each mode-dependent response probability (Fig 2A, i).  #@NEW_LINE#@#  However, we can capture some of the effects of neural correlation given a particular mode by adding pairwise correlations having a tree structure to the emission distribution (Fig 2A, ii).  #@NEW_LINE#@#  These pairwise correlations are characterized by a joint response probability, p(i,j).  #@NEW_LINE#@#  We can represent this emission distribution with a graph having nodes for each cell and edges for each joint probability (Fig 2B).  #@NEW_LINE#@#  This graph has the structure of a tree, meaning that there are no loops formed by the edges of the graph.  #@NEW_LINE#@#  
Our full model included temporal correlations within ganglion cell spike trains through a non-uniform probability to transition from one mode to another mode in the subsequent time bin (Fig 2B).  #@NEW_LINE#@#  This probability of a transition between modes in adjacent time bins, P((t)|(t1)), is termed the transition matrix.  #@NEW_LINE#@#  The model was completed by specifying the emission distributions, Q({i}).  #@NEW_LINE#@#  We found that the simplest choice of independent emission probabilities predicted too-small correlations between cells, necessitating the inclusion of correlations into the emission probabilities.  #@NEW_LINE#@#  In order to incorporate weak correlations while still maintaining tractability of the model, we parameterized the emission probability distributions by constraining joint distributions on pairs of neurons chosen to form a tree (Fig 2B).  #@NEW_LINE#@#  With this choice, correlation coefficients between neuron pairs fall off exponentially with the number of tree links separating the two neurons (see Supporting Information File).  #@NEW_LINE#@#  Most neuron pairs were thus only weakly correlated within a given mode, and the overall correlation structure was captured by the fluctuating hidden mode.  #@NEW_LINE#@#  Intuitively, one can think of the visual stimulus as determining which mode is activated, in which case the tree structure represents noise correlation while the presence of multiple emission distributions induces signal correlation.  #@NEW_LINE#@#  For some purposes, we would like our model to estimate a static (time-independent) probability distribution.  #@NEW_LINE#@#  To this end, we calculated the weights, {w}, that solved the detailed balance equation (Fig 2C) and then used the mixture model formed with the fitted emission distributions (Fig 2A).  #@NEW_LINE#@#  
A latent variable model provides great flexibility in capturing arbitrary dependency structures, but the costs of this flexibility are (i) the possibility of overfitting to training data, and (ii) of needing an intractably large number of hidden states to accurately model the data.  #@NEW_LINE#@#  As an extreme example, experimental data from N neurons could be perfectly reproduced by a model with 2N hidden states, one for each possible word.  #@NEW_LINE#@#  We therefore controlled overfitting by selecting the number of modes by a cross-validation procedure (Fig 2D).  #@NEW_LINE#@#  For the natural movie recording presented in Figs 18, 70 modes optimized the cross-validated likelihood.  #@NEW_LINE#@#  We note that there were fewer modes than cells (N = 152 cells in this data set), suggesting that the complexity of the model would remain relatively low even for large populations.  #@NEW_LINE#@#  

Qualitative_structure_of_the_model  #@NEW_LINE#@#  
We next analyzed the fitted parameters of the model in order to understand the structure of the response probability distribution and its decomposition into modes.  #@NEW_LINE#@#  The structure and distribution of the modes may be described at a high level by three quantities per mode: the overall probability weight, the centroid location, and the size.  #@NEW_LINE#@#  There was one mode with significantly higher probability than the others; this corresponded to the mode with the highest emission probability for the all-silent state.  #@NEW_LINE#@#  The remaining modes had roughly similar probability to one another (Fig 3A).  #@NEW_LINE#@#  
In addition to its overall probability w, each mode has a location in response space given by its mean spike probability vector, mi = E[i|].  #@NEW_LINE#@#  To visualize the distribution of these N-dimensional centroid vectors, we projected them into two dimensions by applying multidimensional scaling (MDS).  #@NEW_LINE#@#  This projection preserves the location of the zero point, and approximately preserves Euclidean distance between points.  #@NEW_LINE#@#  Therefore, radial distance from zero in the MDS plane closely corresponds to the overall activity level of the mode.  #@NEW_LINE#@#  Modes were found dispersed throughout the MDS plane, roughly tiling most of this space.  #@NEW_LINE#@#  Notably, the high-activity modes appeared to pack less densely than the low-activity modes (Fig 3B).  #@NEW_LINE#@#  
Finally, we sought to examine the width of each mode, which we quantified by the entropy of the emission distribution, S (see Methods).  #@NEW_LINE#@#  This measure increased with the modes average population spike count k, suggesting that the modes occupied an expanding region of response space at higher activity levels (Fig 3C).  #@NEW_LINE#@#  Notice that this property is complementary to the observation that high-activity modes pack the MDS space less densely.  #@NEW_LINE#@#  The mode identity code therefore became coarser with increasing spike count k. However, the tremendous increase in the number of possible activity patterns at higher k potentially compensate for this coarse-binning (Fig 3C, dashed line).  #@NEW_LINE#@#  Indeed, the total amount of response capacity increased faster than the entropy per mode (Fig 3C, inset).  #@NEW_LINE#@#  Therefore, provided sufficiently non-overlapping mode distributions, this high capacity of activity patterns at higher k could be partitioned into a larger number of discriminable modes than at lower k. The increasing size of these regions could then support noise suppression, as in error-correcting codes.  #@NEW_LINE#@#  
A schematic depiction of the structure implied by examining the parameters of our model is shown in Fig 3D.  #@NEW_LINE#@#  The probability distribution resembles a mountain with an overall peak given by the all-silent state and an overall slope that corresponds to a decrease in the probability as the spike count increases due to the sparseness of neural activity.  #@NEW_LINE#@#  Extending out from the central peak are localized lumps of probabilitypeaks and ridgesthat correspond to each mode.  #@NEW_LINE#@#  Each local lump decreases in amplitude and increases in area as the overall activity level increases.  #@NEW_LINE#@#  Because the volume of response space increases with activity level (represented by rings around the central peak with increasing circumference), the number of modes increases with activity level.  #@NEW_LINE#@#  
Another important element of our HMM is the matrix of transition probabilities, P( | ), which describes the probability of finding mode  at time step t given the presence of mode  at time step t-1.  #@NEW_LINE#@#  This matrix was dominated by the diagonal elements (Fig 4A), which introduced a persistence of each mode across several time bins (20 ms).  #@NEW_LINE#@#  Because the temporal kernel of ganglion cell receptive fields typically has a width of ~100 ms [30], it is expected that the activity state of the ganglion cell population exhibits persistence on this time scale.  #@NEW_LINE#@#  The median probability of remaining in the same mode on a subsequent time step was 0.70.  #@NEW_LINE#@#  The average dwell time spent in the same mode ranged from 20 ms to 77 ms. We also found weaker, distributed off-diagonal transition elements (Fig 4B).  #@NEW_LINE#@#  These off-diagonal elements reflect temporal correlations in the stimulus and are expected to depend strongly on the choice of stimulus ensemble.  #@NEW_LINE#@#  
In order to assess the structure and significance of the off-diagonal transition elements, we calculated the transition entropy, Htrans(), which measures how many modes can be accessed when starting from mode  (defined in Methods).  #@NEW_LINE#@#  This transition entropy had a value of ~2 bits, which implies that the number of accessible states was   22 = 4 (Fig 4C).  #@NEW_LINE#@#  If we removed the diagonal transition element and renormalized the probabilities, we found a much higher number of accessible states, ~24 = 16 (Fig 4C), consistent with the fact that the diagonal transition element always dominated.  #@NEW_LINE#@#  The transition entropy was roughly constant across different modes, and there were no modes with exceptionally low values.  #@NEW_LINE#@#  These results are consistent with a picture in which each mode eventually transitions to a broad set of other possible modes, and hence there were no strong sequences of modes preferentially observed in our data.  #@NEW_LINE#@#  
Finally, we can gain more intuition about the structure of our model by investigating how individual ganglion cells are organized into collective modes.  #@NEW_LINE#@#  One important measure of this organization is the number of individual cells that participate in each collective mode.  #@NEW_LINE#@#  Another complementary measure is the number of modes containing a given cell.  #@NEW_LINE#@#  Because each cell has a mode-dependent firing probability, mi, that varies continuously from zero to one, both of these measures are subject to an arbitrary choice of how large mi must be in order for a cell to participate in that mode.  #@NEW_LINE#@#  Thus, we calculated these measures as a function of the threshold criterion, , where  is the average firing probability for cell i across all the modes (Fig 5A).  #@NEW_LINE#@#  At  = 0, these values matched the total number of cells and modes, respectively, and they decayed monotonically to zero for large .  #@NEW_LINE#@#  At a threshold of  = 3, the number of cells participating in a given mode showed a highly skewed distribution with an average of 13.  #@NEW_LINE#@#  Another way of viewing these statistics is to note that the majority of the modes had 10 or fewer cells participating, and less than 30% had more than 20 cells participating.  #@NEW_LINE#@#  Thus, collective modes had a broad distribution of overall firing, and there was only a small fraction of modes with more than 20 out 152 cells participating.  #@NEW_LINE#@#  In contrast, we can see that the average number of modes containing a given cell had a roughly normal distribution around an average of 6.  #@NEW_LINE#@#  Thus, individual ganglion cells can belong to multiple modes, and this partitioning is relatively even across the different modes.  #@NEW_LINE#@#  

The_model_accurately_captures_the_statistics_of_spiking_patterns  #@NEW_LINE#@#  
We found that this model closely reproduced the statistics of the data.  #@NEW_LINE#@#  Model performance was assessed by training on half the data, and evaluating goodness-of-fit on the other half using the log-likelihood measure.  #@NEW_LINE#@#  The log-likelihood is given by , where w indexes each unique binary spike word in the population, femp (w) is the empirical frequency of that word in the test data, and Pmodel (w) is the probability predicted by the model.  #@NEW_LINE#@#  For the full HMM, which includes temporal structure, we took Pmodel (w) to be the stationary distribution (see Fig 2).  #@NEW_LINE#@#  The overall cross-validated likelihood of our model compared favorably to previous state-of-the-art models (Fig 6), including the K-pairwise maximum entropy model of [25], which incorporates constraints on the mean spike rates, pairwise correlations, and spike-count distribution, and the reliable interactions (RI) model [51].  #@NEW_LINE#@#  Because our HMM also reproduces some of the temporal structure of the data, we expect that the full likelihood of the HMM to be even better than indicated here.  #@NEW_LINE#@#  
Our model was as good as the RI model (with a word-count threshold parameter nRI = 2 counts) in reproducing the probabilities of words appearing at least two times in the data (Fig 6B).  #@NEW_LINE#@#  We note that our HMM effectively reached the upper bound on possible performance for this metric, because the RI models performance on many of these words reached sampling error, by construction.  #@NEW_LINE#@#  Our model has the advantage over the RI model of being a well-defined probability distribution, whereas the RI model is a non-normalized pseudo-likelihood.  #@NEW_LINE#@#  For example, many words occurring only once in the data were assigned probabilities greater than one by the RI model.  #@NEW_LINE#@#  The HMM is therefore more amenable to interpretation and statistical sampling for simulation.  #@NEW_LINE#@#  
As a detailed assessment of goodness-of-fit, we compared our models predictions to the actual values (measured from a held-out test set) of many statistical quantities, again using the stationary distribution of the HMM.  #@NEW_LINE#@#  The low-order moments were well-reproduced (Fig 7A7C): the coefficient of determination between model-predicted and true pairwise correlation coefficients was r2 = 0.95 for pairwise correlations and 0.80 for triplet correlations.  #@NEW_LINE#@#  The incorporation of tree-structured correlations into the emission distributions improved these values relative to a model with only independent emission probabilities; in the latter case the pairwise correlations had r2 = 0.92, and the triplet correlations had r2 = 0.74.  #@NEW_LINE#@#  Moreover, the model accurately predicted probabilities of individual population words (Fig 7D and 7E) and the probability distribution of population spike count,  (Fig 7F).  #@NEW_LINE#@#  The latter is a sensitive measure of the degree of high-order correlation [25].  #@NEW_LINE#@#  
The empirical frequency distribution of population words was highly skewed, and approximated a power law distribution (see Supporting Information File).  #@NEW_LINE#@#  Indeed, in this particular dataset, words occurring once each accounted for 90% of the unique observed words, and 38% of the probability mass.  #@NEW_LINE#@#  The model-predicted probability of such low-count words, and, of course, of the many unobserved words, is poorly constrained by the data.  #@NEW_LINE#@#  The consequent underestimation of such words probability (Fig 7E) translated into a slight downward bias in the predicted second- and third-order moments (Fig 7B and 7C).  #@NEW_LINE#@#  However, there was no explicit constraint on these moments in fitting the model (in contrast to the maximum entropy paradigm [6, 25, 53]) and the slight inaccuracy in their prediction was compensated by good performance on the frequently occurring words (Fig 7D).  #@NEW_LINE#@#  Furthermore, a parametric bootstrap analysis showed that the degree of mismatch between predicted probability and empirical frequency in the low-count words was largely consistent with sampling error in a highly skewed distribution (Fig 7E, gray band).  #@NEW_LINE#@#  

Modes_correspond_to_discriminable_clusters_in_activity_space  #@NEW_LINE#@#  
We have demonstrated that a hidden Markov model, based on the assumption that neural population responses may be grouped into a collection of discrete modes, constituted an excellent statistical description of our data.  #@NEW_LINE#@#  Nevertheless, the success of the model is not in itself evidence that the population responses form discrete clusters, since our model contains no constraint preventing the recovered modes from overlapping to an arbitrary degree.  #@NEW_LINE#@#  Moreover, it is not a priori obvious that clustering structure, if present, is due to any nontrivial processing within the retina beyond the pattern of correlations induced by overlapping receptive fields.  #@NEW_LINE#@#  
To check that the modes identified by our model indeed formed discriminable clusters, we applied linear discriminant analysis (LDA).  #@NEW_LINE#@#  We first identified the set of unique population words that were mapped into each mode by the model (Fig 8A and 8B, top).  #@NEW_LINE#@#  We carried out Fishers LDA to project the set of words assigned to each pair of modes onto the one dimension that best separated them (Fig 8A and 8B, bottom) [54].  #@NEW_LINE#@#  We then measured the discriminability of modes by d (the distance between mode means along the LDA axis, scaled by the standard deviation) and identified for each mode the distance to its nearest neighbor, i.e.  #@NEW_LINE#@#  the mode with smallest d. Such neighboring pairs typically involved the activation of non-overlapping subpopulations of cells.  #@NEW_LINE#@#  Furthermore, the nearest-neighbor d was at least 1.5 standard deviations for all modes, and above 2 standard deviations for many modes (Fig 8C).  #@NEW_LINE#@#  The degree of discriminability also increased slightly with k. This is the worst case, nearest-neighbor discriminability: d between arbitrary mode pairs was typically higher: 1.5  4.5 standard deviations (Fig 8D).  #@NEW_LINE#@#  Since the LDA procedure seeks out the one-dimensional projection of a 152-dimensional space that maximizes d, there is some possibility that this high degree of nearest-neighbor discriminability could be obtained by chance.  #@NEW_LINE#@#  We therefore repeated the same analysis after randomly shuffling the assignment of time bins to modes.  #@NEW_LINE#@#  These shuffled modes had robustly smaller d (Fig 8C and 8D).  #@NEW_LINE#@#  
We concluded from the above analyses that the modes captured by our model indeed corresponded to discriminable response clusters, especially for patterns with many spikes across the population.  #@NEW_LINE#@#  We next checked whether the degree of clustering identified by our model was a nontrivial feature of the data by comparing to simplified models.  #@NEW_LINE#@#  First, the specific patterns of synchronous spiking characterizing our modes may naively be expected to arise from receptive field overlap.  #@NEW_LINE#@#  We therefore constructed a linear-nonlinear (LN) model of the population that reproduced this effect of common stimulus drive.  #@NEW_LINE#@#  In order to do so, we analyzed a data set in which the retina was driven by a binary white noise stimulus, so that the receptive fields could be estimated by spike-triggered average analysis [55].  #@NEW_LINE#@#  This dataset consisted of 155 ganglion cells.  #@NEW_LINE#@#  We fit an LN model to each neuron in the recording (Methods) and then simulated data by sampling from the LN model, driven by the actual white noise sequence used in our experiment and assuming conditional independence across neurons.  #@NEW_LINE#@#  We then fit our model to both the real data and the simulated LN data, and evaluated the models likelihood in 10-fold cross-validation to assess the optimal number of modes (Fig 9).  #@NEW_LINE#@#  There was a substantial difference between the two models, with 50 modes being selected as optimally describing the real data (Fig 9, blue) but only 6 for the LN data (Fig 9, green).  #@NEW_LINE#@#  
Finally, we verified that correlations were necessary to give rise to mode structure by randomly shuffling each spike train in the data in order to eliminate all correlation between all cells.  #@NEW_LINE#@#  The resulting shuffled data was best fit by just one mode (Fig 9, red), which is unsurprising since our model with one mode should, in principle, capture uncorrelated data exactly.  #@NEW_LINE#@#  However, this analysis does demonstrate that the mode structure is a specific consequence of correlated spiking among cells, and not a statistical artifact of sparse firing.  #@NEW_LINE#@#  

Modes_encode_distinct_stimulus_features  #@NEW_LINE#@#  
Our model was fit in an unsupervised way, without explicitly accounting for the stimulus.  #@NEW_LINE#@#  Nevertheless, the time-varying mode sequence drives spiking responses in a manner analogous to the unknown stimulus.  #@NEW_LINE#@#  It is thus natural to ask whether the modes have any meaningful relationship to the stimulus, and, if so, which features of the visual input are represented.  #@NEW_LINE#@#  We trained the model on the white-noise checkerboard data introduced above, which was well described by 50 modes.  #@NEW_LINE#@#  We then estimated the receptive fields of all cells by computing the spike-triggered average stimulus [55], and classified cells into ON- and OFF-type.  #@NEW_LINE#@#  We next evaluated each modes receptive field by taking the mode-triggered stimulus average, i.e.  #@NEW_LINE#@#  by averaging all stimuli preceding a time bin in which the mode was active.  #@NEW_LINE#@#  We split all receptive fields (cell and modes) into a spatial and temporal part by finding the best-fitting separable approximation, and compared each modes spatial receptive field to those of the cells most active within the mode.  #@NEW_LINE#@#  Next, we fit the best 2D Difference of Gaussian function to the spatial profile of each modes receptive field (see Supporting Information File for details).  #@NEW_LINE#@#  We used the parameters of these fitting functions to divide the mode receptive fields into four qualitative types: 1) intersection, 2) union, 3) oriented dipole, and 4) independent (Fig 10).  #@NEW_LINE#@#  
Half the modes resembled the intersection of many individual ganglion cells receptive fields (24 modes; Fig 10A).  #@NEW_LINE#@#  These modes had small, compact fields, often concentrated over only 14 checks.  #@NEW_LINE#@#  The receptive fields of the cells with highest mode-dependent firing probability mi tended to be larger than the receptive field of the mode itself, and overlapped extensively.  #@NEW_LINE#@#  This arrangement represents a straightforward mechanism by which the retinal population code can achieve greater spatial acuity than individual cells, by encoding highly localized stimuli through the simultaneous spiking of several cells each containing the stimulus in their receptive field.  #@NEW_LINE#@#  The intersection-type modes predominantly had an OFF response, and the cells overlapping the center of these were OFF-cells.  #@NEW_LINE#@#  This may reflect the high asymmetry of OFF- to ON-cells in our recording (122 OFF cells and 33 ON cells), which is characteristic for the tiger salamander retina [30].  #@NEW_LINE#@#  
Similar features were found to be encoded by the simultaneous spiking patterns of groups of 24 retinal ganglion cells [46].  #@NEW_LINE#@#  We view our finding of intersection-type receptive fields as an extension of these previous results to the case of ~150 cells.  #@NEW_LINE#@#  However, we also find other qualitatively different spatial features not reported in [46] (see below).  #@NEW_LINE#@#  In addition, the approach of studying the features encoded by specific, multi-neuronal spiking patterns [46, 47] suffers from the difficulty that combinations of spiking and silence among increasingly many neurons become prohibitively rare to observe.  #@NEW_LINE#@#  In contrast, our current approach maps many neural activity patterns onto the same collective mode, and consequently our collective modes were all observed with significant frequency (Fig 3A).  #@NEW_LINE#@#  Thus, our current approach generalizes better to large neural populations.  #@NEW_LINE#@#  
Other modes had extended receptive fields which were larger than many of the underlying individual cells receptive fields.  #@NEW_LINE#@#  We call these union-type modes, and they occurred with both OFF- and ON-polarity (8 modes, 6-OFF type, 2 ON-type; Fig 10B).  #@NEW_LINE#@#  Extracting such population responses could be useful for detecting complex spatiotemporal stimulus features that require pooling over several spatial subunits.  #@NEW_LINE#@#  These modes might also embody a form of position invariance for the occurrence of a similar stimulus feature over a wider area.  #@NEW_LINE#@#  
We quantified the size of intersection and union mode receptive fields by examining the receptive field radius, defined as the semi-major axis length of the 95% confidence ellipse of the best-fit 2D single Gaussian (see Supporting Information File).  #@NEW_LINE#@#  The median radius of the union modes spatial receptive fields was 165 m, whereas it was 121 m for intersection modes, and 138 m for independent modes (see below).  #@NEW_LINE#@#  For cells, the median radius was 143 m. We compared modes receptive field radius to the individual cells contributing to the mode by computing an average cell radius, which we denote , for each mode as the weighted average of each cells receptive field radius, weighted by the cells mode-dependent firing probability (see Supporting Information File).  #@NEW_LINE#@#  For the union-type modes, the mode receptive field was 16% larger than the average cell receptive field, as a median value, and intersection-type modes were 19% smaller than cells.  #@NEW_LINE#@#  Both of these differences were statistically significant (p less_than 0.01, Wilcoxon signed-rank test).  #@NEW_LINE#@#  
Intriguingly, several modes had oriented dipole-type receptive fields (3 modes; Fig 10C).  #@NEW_LINE#@#  In these modes, OFF-cells and ON-cells both had high mode-dependent spiking probability.  #@NEW_LINE#@#  The receptive fields of these OFF and ON subpopulations, however, formed distinct spatial regions with minimal overlap.  #@NEW_LINE#@#  This arrangement resulted in a mode receptive field that had separate ON- and OFF-polarity subfields.  #@NEW_LINE#@#  These modes are therefore well-suited to detecting an oriented contrast edge.  #@NEW_LINE#@#  Interestingly, this orientation-selective receptive field is reminiscent of a V1 simple cell [56].  #@NEW_LINE#@#  However, we note with caution that the amphibian pallium has been poorly studied, and the responses of tectal neuronsthe predominant downstream targets of the retinahave not traditionally been reported to be tuned to static, oriented stimuli [57] (but see [58] for a recent demonstration of orientation selectivity in the mouse superior colliculus).  #@NEW_LINE#@#  Nevertheless, our results demonstrate that important visual primitives emerge as statistically robust features of the retinal population code.  #@NEW_LINE#@#  We find this result particularly intriguing, because the stimulus ensemble was spatiotemporal white noisei.e., having no spatial features with orientation that were statistically over-represented.  #@NEW_LINE#@#  This suggests that retinal circuitry itself may be biased to extract oriented spatial features from the visual scene.  #@NEW_LINE#@#  
Lastly, several of the modes had receptive fields that were not statistically different than expected from their constituent ganglion cells (14 modes, not shown in Fig 10; see Supporting Information File for more details).  #@NEW_LINE#@#  In addition, 1 of our 50 modes had a spatial profile that was too noisy to analyze further.  #@NEW_LINE#@#  
The temporal profiles of the mode-triggered averages qualitatively resembled those of individual cells, with most having a monophasic and some a biphasic time course.  #@NEW_LINE#@#  Mode temporal profiles were slower than those of individual cells, which is to be expected due to the autocorrelation in the mode response.  #@NEW_LINE#@#  

Collective_modes_are_robust_to_noise  #@NEW_LINE#@#  
The results reported in the previous section imply that each mode corresponds to a discriminable cluster of response words.  #@NEW_LINE#@#  Noise in the retinal response will produce a number of distinct words, all evoked by the same input stimulus.  #@NEW_LINE#@#  If distinct words, related by noise, preferentially fall within one modes cluster, then the mode identity will be robust to noisei.e., the mode representation would constitute a form of error-correcting code.  #@NEW_LINE#@#  To test whether this was the case, we evaluated the reproducibility of modes across stimulus repeats.  #@NEW_LINE#@#  
We evaluated the models fit to several different stimulus classes featuring identical, repeated segments: a natural movie (170 cells, 100 modes, 73 repeats), a dark bar extended across the recording area, randomly moving in the transverse direction (140 cells, 30 modes, 108 repeats), and the white noise checkerboard stimulus analyzed above (155 cells, 50 modes, 69 repeats).  #@NEW_LINE#@#  All three stimuli featured a long period of non-repeated stimulation interspersed with the shorter repeats.  #@NEW_LINE#@#  We fit the model to the non-repeated data and evaluated reproducibility on the repeated portion.  #@NEW_LINE#@#  
The same modes were frequently activated on different stimulus repeats, with especially robust reproducibility apparent at high population activity level k. An example portion of the bar stimulus is shown in Fig 11A, where each color indicates a mapping of the neural activity pattern onto the same mode.  #@NEW_LINE#@#  Generally, mode reproducibility tended to degrade during (i) periods of quiescence (time bins with no more than two cells spiking), and (ii) transitions between modes.  #@NEW_LINE#@#  Both results are expected a priori.  #@NEW_LINE#@#  During periods of quiescence, too few cells are spiking to embody much robustness to noise, and during transitions between modes, there must always be one point in time in which the likelihood of the earlier and later modes is exactly equal.  #@NEW_LINE#@#  
To quantity the overall degree of reliability of modes, we generated a binary vector for each mode, which was 1 when the mode was active at a given time bin and 0 otherwise.  #@NEW_LINE#@#  We then calculated, for each mode, the fraction of the modes entropy that was informative about the stimulus (see Methods).  #@NEW_LINE#@#  This information efficiency measure had a median of 0.57 for the natural movie and 0.60 for the bar stimulus; moreover, it was above 0.80 for some modes.  #@NEW_LINE#@#  Information efficiency was lower for the less-structured white noise, with a median of 0.44, but still comparable to the other stimuli for many modes (Fig 11B).  #@NEW_LINE#@#  Moreover, the information efficiency of modes exceeded that of individual cells.  #@NEW_LINE#@#  For the natural movie, the median efficiency of single cells was 0.41 (c.f.  #@NEW_LINE#@#  0.57 for modes).  #@NEW_LINE#@#  The most efficient single cell reached 0.68, while the best mode had an efficiency of 0.81.  #@NEW_LINE#@#  
Since the natural movie stimulus is most representative of the retinal input under ecological conditions, and it evoked the largest number of modes, we focused further analysis on this dataset.  #@NEW_LINE#@#  We sought to compare the reproducibility of individual population spiking words to the reproducibility of modes.  #@NEW_LINE#@#  Since most individual words occur very rarely, and not at all on some repeats, the above information measure is poorly estimated for words.  #@NEW_LINE#@#  We instead quantified the reproducibility of words (modes) as the fraction of repeats on which a word (mode) was active at a particular time bin, given that the same word (mode) occurred within 80 ms on a different repeat.  #@NEW_LINE#@#  Individual words were highly variable, with reproducibility decreasing with k and dropping to its minimal possible level by k = 5 (Fig 11C).  #@NEW_LINE#@#  In fact, high-activity words often occurred only once each in the entire dataset.  #@NEW_LINE#@#  Nevertheless, mode reproducibility was substantially higher and increased slightly with activity level (Fig 11C).  #@NEW_LINE#@#  
We also quantified noise in the underlying population response by the average Hamming distance between pairs of words occurring at the same time bin within the stimulus, but on different repeats.  #@NEW_LINE#@#  By this measure as well, population responses were quite noisy, with Hamming distance exceeding spike count k and increasing with activity level (Fig 11D).  #@NEW_LINE#@#  This result is consistent with the variability in the spike count of individual single ganglion cells [59] and provides additional insight into the low reproducibility of high-activity words.  #@NEW_LINE#@#  
Certain trivial effects may explain the high level of mode reproducibility.  #@NEW_LINE#@#  We sought to control for these by carrying out two manipulations comparing the mode assignment produced by our model to randomized modes preserving only limited structure (Fig 11E).  #@NEW_LINE#@#  Details of the construction of both controls are reported in Methods.  #@NEW_LINE#@#  First, there is a similarity effect: the model assigns to the same mode words which are similar to one another or that occur close in time (due to the temporal correlation incorporated into the model).  #@NEW_LINE#@#  This grouping by similarity and temporal proximity may automatically reduce noise.  #@NEW_LINE#@#  We constructed a control which randomized the location of each mode in response spaceits meanwhile approximately preserving its entropy, as well as preserving the overall form of the HMM (including temporal correlations).  #@NEW_LINE#@#  To ensure that the temporal correlations were optimal relative to the newly constructed modes, we re-fit the full HMM while fixing the randomized mode means.  #@NEW_LINE#@#  We will refer to this construction as the shuffled means manipulation.  #@NEW_LINE#@#  It groups words by similarity to the randomized means and by temporal proximity induced by the learned temporal correlations, and thereby reproduces the similarity effect.  #@NEW_LINE#@#  This control produced modes that were significantly less informative than the true modes identified by our model (Fig 11E), with a median information efficiency of 0.37.  #@NEW_LINE#@#  The fact that this randomized control still carried some information likely reflects the underlying reproducibility of single cells, since some of the random modes ended up being highly selective for certain individual cells.  #@NEW_LINE#@#  Indeed, the median single-cell efficiency was 0.41, quite close to the value for the shuffled means control.  #@NEW_LINE#@#  
Another possible explanation for the high degree of reproducibility is that the mode representation compresses tens-of-thousands of words into a much smaller number of modes.  #@NEW_LINE#@#  This large reduction of entropy may be expected to enhance reproducibility by chance.  #@NEW_LINE#@#  To control for this compression effect, we constructed modes in which each word was assigned to a random, unique mode, while matching the overall number and probability distribution of modes to that in the full model.  #@NEW_LINE#@#  We refer to this control as the random partition.  #@NEW_LINE#@#  We found that modes defined by random partition had very poor information efficiency, with a median of 0.17 (Fig 11E).  #@NEW_LINE#@#  The random partition modes in fact had a reproducibility near chance, here defined by randomly permuting the time bins within each stimulus repeat before calculating information efficiency on the original basins.  #@NEW_LINE#@#  This chance value had a median of 0.14.  #@NEW_LINE#@#  The only randomized modes that were comparably informative to the true modes were those that contained the all-silent state and other very low spike count words.  #@NEW_LINE#@#  
There is also a word reliability effect: although most individual words had extremely low reproducibility (Fig 11D), some were more reliable across repeats (in particular, the all-silent statewhich is also overwhelmingly the most frequently occurring word).  #@NEW_LINE#@#  Therefore, it is conceivable that modes automatically inherit this reproducibility, even without detecting any special structure.  #@NEW_LINE#@#  Both randomized manipulations control for this reliability effect.  #@NEW_LINE#@#  
Together, the poor information efficiency of both of these controls (compared with that of the true modes) suggests that there is an underlying structure to the data that is captured by the full model, but not by arbitrary mappings of activity patterns onto modes.  #@NEW_LINE#@#  Thus, collective modes form a representation of the visual stimulus that is highly robust to noise in the activity of individual neurons.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
We have demonstrated that the spike trains emitted by the ganglion cells composing a densely covered patch of retina are statistically structured into a sequence of discrete collective modes.  #@NEW_LINE#@#  This decomposition provided an accurate model of the retinal output under a variety of stimuli, including natural movies.  #@NEW_LINE#@#  Different modes were readily discriminated from each other, especially at high activity levels (Fig 8).  #@NEW_LINE#@#  These modes carried meaningful information about the stimulus, as their activation was correlated with specific stimulus features not present in individual cells (Fig 10).  #@NEW_LINE#@#  Finally, we found that modes were highly robust to noise in comparison to individual words: the response fluctuations that occur over identical presentations of the stimulus preferentially mapped words onto the same mode (Fig 11).  #@NEW_LINE#@#  
Adopting_a_neural_coding_approach  #@NEW_LINE#@#  
There are two distinct and complementary ways to create a probabilistic model of the retinal output (or, indeed, of any sensory system).  #@NEW_LINE#@#  One approach attempts to explicitly capture the dependence of neural responses on the stimulus.  #@NEW_LINE#@#  Models of this class include standard linear-nonlinear (LN) models, generalized linear models (GLMs) [26] [60], and stimulus-dependent maximum entropy models [61].  #@NEW_LINE#@#  These models, which we will call encoding models, have two primary advantages: they may highlight the circuit-level computation by which the retina transforms its input, and they provide a principled basis for deriving decoders that transform the retinal output into a reconstruction of the stimulus [26, 62].  #@NEW_LINE#@#  Mathematically, all such models are parameterizations of the conditional distribution of responses on stimulus, P({i(t)}|s(t)), where s(t) denotes the stimulus.  #@NEW_LINE#@#  Many versions of such models also have the benefit that they can be applied to arbitrary patterns of light, putting them at the highest level of generality.  #@NEW_LINE#@#  
The drawback of this approach is that these models do not correctly predict ganglion cell spike trains in many, if not most, visual conditions.  #@NEW_LINE#@#  To give a few examples: 1) LN models (and their generalizations including ganglion cell gain control) do a good job predicting the firing rate for objects moving at constant velocity [63, 64], but fail for discontinuities of motion [6567] or for wide field motion [68, 69]; 2) LN models (and their generalizations including refractory periods) do a good job for random flicker that is spatially uniform or nearly uniform across the receptive field center [26, 70, 71], yet fail for random flicker with small checkers [72]; 3) even the primate midget and parasol cells, which seem more closely linear than most other ganglion cell types, require models with multiple gain control stages to predict the firing rate for temporal-chromatic natural movies [73].  #@NEW_LINE#@#  
The picture that emerges from these studies is that there are multiple sources of non-linearity within the retinal circuit that are significant in some (but not all) visual conditions and that endow ganglion cells with light responses qualitatively different from the LN model.  #@NEW_LINE#@#  Examples include bipolar cells with rectification and synaptic depression in their axon terminal [7476] as well as different types of amacrine cells that veto ganglion cell response when specific visual features are present [68, 7780].  #@NEW_LINE#@#  Given the extreme diversity of amacrine cell types [81] as well as the fact that they can individually remold each bipolar-to-ganglion cell transfer function [82], the prospect for deriving an input-output model that will succeed over the entire range of natural visual conditions currently seems quite remote.  #@NEW_LINE#@#  
An alternative approachthe one adopted in the present workis to directly model the structure of retinal responses, without reference to the stimulus.  #@NEW_LINE#@#  Mathematically, these models represent the distribution P({i(t)}).  #@NEW_LINE#@#  Models of this form, which we call activity models, have their own advantages, complementary to those of encoding (stimulus-dependent) models.  #@NEW_LINE#@#  Most importantly, they correspond to the problem faced by the rest of the brain, which lacks direct access to either the stimulus or the internal structure of the retina.  #@NEW_LINE#@#  These models, rather than highlighting the circuit-level computation, instead emphasize the structure of the neural code produced by the system.  #@NEW_LINE#@#  
Such activity models address the question of how the information conveyed to the rest of the brain is formatted by the retina, and therefore how it could be most naturally interpreted.  #@NEW_LINE#@#  Note that this question is quite distinct from the notion of stimulus decodingin our view, the goal of the visual system is decidedly not to reconstruct the exact light pattern comprising the stimulus, which anyway already exists in the photoreceptors.  #@NEW_LINE#@#  Rather, the goal is to amplify behaviorally relevant stimulus features while suppressing irrelevant onese.g., the operation of recognizing the same object in the environment under different viewing conditions [83]which is ultimately a complex function of information encoded at the photoreceptor level.  #@NEW_LINE#@#  Activity models provide neuroscientists with data-driven hypotheses of what these features may be.  #@NEW_LINE#@#  Our results reported in the present paper suggest that the collective modes are one example of a relevant signal emphasized at the retinal ganglion cell level; there could be others as well.  #@NEW_LINE#@#  
One advantage of activity models is that they can be formulated in circumstances in which there exists no satisfactory encoding model, such as under natural movie stimulation.  #@NEW_LINE#@#  The method is simply to measure simultaneously the activity states of the neural population over a stimulus ensemble, as is possible with techniques like multi-electrode recording or optical imaging.  #@NEW_LINE#@#  In taking this approach, we were able to identify many more collective modes in response to checkerboard flicker than could be identified with matched LN models of each neuron (Fig 9).  #@NEW_LINE#@#  This result demonstrates the benefit of direct experimental measurement of neural activity over inferences from encoding models, at least in the context of our study.  #@NEW_LINE#@#  
A consequent obvious disadvantage of the approach based on activity models is that the distribution of states, P({i(t)}), will depend strongly on the choice of stimulus ensemble.  #@NEW_LINE#@#  However, it should be pointed out that encoding models also suffer implicitly from this difficulty, as the form of model that succeeds for one stimulus ensemble may not succeed in others.  #@NEW_LINE#@#  This limitation is a consequence of the aforementioned circuit complexity arising from gain control, amacrine cell network interactions, and other effects.  #@NEW_LINE#@#  Finally, we note that even a perfect encoding modelwhich would necessarily be far more complex and sophisticated than the present state-of-the-art modelswould require an analysis along the lines of the present work in order to address questions at the level of the output neural code that we have studied here.  #@NEW_LINE#@#  
Our modeling work suggests that neural circuits downstream of the retina can extract meaningful information about the visual stimulus merely by clustering retinal activity patterns into a sequence of collective modes.  #@NEW_LINE#@#  Our model enabled us to extract population modes that were informative about the stimulus and robust to noise.  #@NEW_LINE#@#  Since the modes were defined without any information about the stimulus (i.e., its repeat structure), the reproducibility results of Fig 11 are highly nontrivial.  #@NEW_LINE#@#  Furthermore, these modes often encoded features of the stimulus that were not represented by any individual neuron.  #@NEW_LINE#@#  

Properties_of_the_collective_modes  #@NEW_LINE#@#  
How much information is carried by the sequence of modes?  #@NEW_LINE#@#  For our non-repeated natural movie stimulus, with 70 modes, the modes carry 2.0 bits/s per neuron of entropy.  #@NEW_LINE#@#  This is about 25% of the maximum-entropy upper bound on total response entropy estimated in [25] for a separate dataset of salamander ganglion cells responding to a natural movie.  #@NEW_LINE#@#  There are three possible explanations for this gap, which may be explored in future work.  #@NEW_LINE#@#  First, much of the population entropy is noise: estimating noise entropy for the dataset used in [25], we find that almost 60% of the population entropy is noise entropy (this is an upper bound, assuming neurons are conditionally independent given the stimulus).  #@NEW_LINE#@#  Since we found that modes are less noisy than population words, we expect a smaller fraction of the mode entropy to be noise.  #@NEW_LINE#@#  
Second, the modes as we have defined them may only represent one channel of meaningful stimulus information.  #@NEW_LINE#@#  Further information may be represented as substructure of the modes, or as a distinct partitioning of the population activity.  #@NEW_LINE#@#  Such a multiplexed population code would then allow different downstream targets to readily extract different information streams from the same input.  #@NEW_LINE#@#  For example, given that we find substantial variation of population spike count within each mode, one hypothesis may be that mode identity represents a particular stimulus feature while population spike count encodes the contrast or intensity of that feature.  #@NEW_LINE#@#  Other examples of such multiplexed encoding are known to exist.  #@NEW_LINE#@#  In the retina, contrast adaptation leads to a multiplexed neural code: the visual information encoded by individual spikes is roughly invariant to the contrast, while the total firing rate encodes the absolute contrast on a longer time scale of ~10 sec [84, 85].  #@NEW_LINE#@#  In the visual cortex, information about different aspects of the stimulussuch as the spatial phase, contrast, and orientation of gratingsis represented at different time scales in the same cortical spike trains [86, 87].  #@NEW_LINE#@#  
Finally, we may be vastly underestimating the total number of modes, as we are limited by finite sampling.  #@NEW_LINE#@#  With greater samplingnote that our recording times of  1 hr are orders of magnitude lower than whats available to the organism under natural conditionsmany more rare words would be expected to occur.  #@NEW_LINE#@#  These new words would form new modes, and the entropy of the probability distribution over modes would increase.  #@NEW_LINE#@#  In contrast, the aforementioned maximum entropy bound should be fairly stable against improved sampling, since its based on a maximum entropy model constrained on a set of consistent statistics (indeed, as more structure is revealed, the true population entropy may decrease further below the maximum entropy bound).  #@NEW_LINE#@#  Likewise, sampling a larger fraction of the cells overlapping the patch of visual field would likely yield a larger number of more readily distinguished modes.  #@NEW_LINE#@#  In contrast, the entropy per cell reported in [25] continues to decrease with neuron number, apparently not saturating until 200  300 neurons.  #@NEW_LINE#@#  Therefore, we expect the fraction of total entropy captured by the modes to increase with sampling in both time and cells, provided that the observations we have made about the response distribution are generalizable to unobserved data.  #@NEW_LINE#@#  

Other_activity_models  #@NEW_LINE#@#  
One approach to identifying error-robust sets of codewords was suggested by the application of maximum entropy (MaxEnt) models that constrained the pairwise correlations among retinal ganglion cells [6].  #@NEW_LINE#@#  The pairwise interactions learned by fitting these models typically feature both positive and negative interaction strengths.  #@NEW_LINE#@#  In models of physical magnetic systems, such disordered interactions are known to lead to a probability distribution featuring many local peaks [88].  #@NEW_LINE#@#  Error-corrected codewords have been identified in retinal data as local maxima of the probability landscape defined by MaxEnt models, and indeed were shown to encode reliable information [25].  #@NEW_LINE#@#  Fitting maximum entropy models is computationally demanding, especially for datasets from a large number of cells.  #@NEW_LINE#@#  Moreover, the definition of local probability maxima depends on an arbitrary choice of metric distance between population statessuch as the Hamming distancewhich may not weigh cells in a way that facilitates optimal discrimination.  #@NEW_LINE#@#  We therefore adopted a more direct approach to extracting the robust collective representations of the retinal population code, by exploring a model of population neural activity that explicitly incorporates dependence of the observed spike patterns on a hidden variable identifying the population mode.  #@NEW_LINE#@#  The coding symbols identified in [25] persisted with an average timescale of 48 ms, consistent with the dwell time of modes that we discovered by our methods.  #@NEW_LINE#@#  Therefore, we predict a close relationship between the two constructions.  #@NEW_LINE#@#  
Latent variable models have been successfully applied to other neural systems; several related approaches and findings have recently been reviewed [89].  #@NEW_LINE#@#  Dimensionality reduction methods applicable to single-trial spiking data, the paradigm adopted in our work, include continuous state-space models in addition to HMMs.  #@NEW_LINE#@#  Hidden Markov models have been employed to capture population spiking in a variety of cortical structures, including frontal [9092], premotor [93], gustatory [94], and somatosensory areas [91].  #@NEW_LINE#@#  A similar latent-variable-based approach, restricted Boltzmann machines, were applied to visual cortex in [95].  #@NEW_LINE#@#  Relatedly, a clustering algorithm was employed to show that auditory cortical dynamics were organized into transitions between discrete states [96].  #@NEW_LINE#@#  Our methodology extends the prior applications of HMM, which assumed conditional independence of different neurons within each hidden state, by introducing correlations into the emission distribution in a way that enables efficient inference.  #@NEW_LINE#@#  Moreover, that a discrete state-space model such as HMM should apply to the retina, as we have demonstrated, is perhaps more surprising than in cortex, where such a discrete structure may be expected as a consequence of recurrent attractor dynamics or global brain state fluctuations.  #@NEW_LINE#@#  In the present work, we have argued that such discreteness of the population response is desirable in early sensory stages for functional reasons, facilitating error-robust encoding of information.  #@NEW_LINE#@#  
An important question in extending the present model to larger neural populations is how the number of modes scales with the number of neurons.  #@NEW_LINE#@#  For the dense, local patch of 100200 retinal ganglion cells sampled in the experiments analyzed in this paper, we found that the optimal number of modes was less than the number of neurons.  #@NEW_LINE#@#  However, we expect this result to be a consequence of the high degree of redundancy among these cells, due to their mutual receptive field overlap.  #@NEW_LINE#@#  If cells are not so highly correlated, the number of modes may scale faster.  #@NEW_LINE#@#  For example, for our model to describe two completely non-overlapping and statistically independent retinal patches would require a number of modes equal to the product of the number of modes in each patch.  #@NEW_LINE#@#  To describe such data, future work could explore a hierarchical model tying together several HMMs into deeper layers, modeling structure at a variety of scales.  #@NEW_LINE#@#  More generally, the appropriate latent variable model for a given neural population will depend on the balance between redundancy and synergy.  #@NEW_LINE#@#  We expect our results to apply to predominantly redundant populations elsewhere in the brain.  #@NEW_LINE#@#  

Population_neural_codes_beyond_the_retina  #@NEW_LINE#@#  
The general problem faced by the retina is to extract relevant features from a complex, high-dimensional input, and then to package those into output spike trains in a way that facilitates downstream recognition of the relevant features while suppressing irrelevant features (e.g., noise).  #@NEW_LINE#@#  This way of thinking about neural computation clearly generalizes beyond the retina, applying broadly across the nervous system.  #@NEW_LINE#@#  The techniques introduced in the present work allow such hidden relevant features to be explicitly inferred from output spike trains alone, and our application of these ideas to the retina forms a simple test case in which the inputthe visual stimulusis well understood.  #@NEW_LINE#@#  
Future work could apply our model to analyze the collective mode structure of more complex, higher-order, brain areas where the relevant features of the input are unknown.  #@NEW_LINE#@#  For example, in a study that recorded from large populations of neurons in the inferotemporal cortex while the monkey was viewing different categories of objects, the activity states of the neural population clustered into categories that matched the object categories [97].  #@NEW_LINE#@#  In both this study and in ours, the clustering of activity states was only observed in large populations.  #@NEW_LINE#@#  Measurement at the scale of hundreds of neurons may reveal this structure in other brain areas as well.  #@NEW_LINE#@#  
In cortical areas involved in higher-level sensory perception or decision making, the partition of the input into relevant and irrelevant features could be dynamic, depending on behavioral demands.  #@NEW_LINE#@#  It would be quite interesting to apply our model to such areas to see how the mode structure changes with attentional state or task structure.  #@NEW_LINE#@#  Our approach also reduces complex population activity to a single, scalar, codewordthe mode identity.  #@NEW_LINE#@#  In brain areas where individual neurons demonstrate difficult-to-interpret mixed selectivity, it may be the case that the collective representation is more explicit than that of any single neuron [98].  #@NEW_LINE#@#  Our model provides a straightforward method to test similar hypotheses and to explicitly identify the relevant population codewords in spiking neural populations across the nervous system.  #@NEW_LINE#@#  


Methods  #@NEW_LINE#@#  
Ethics_statement  #@NEW_LINE#@#  
This study was performed in strict accordance with the recommendations in the Guide for the Care and Use of Laboratory Animals of the National Institutes of Health.  #@NEW_LINE#@#  The protocol was approved by the Institutional Animal Care and Use Committee (IACUC) of Princeton University (Protocol Number: 1828).  #@NEW_LINE#@#  

Experimental_procedures  #@NEW_LINE#@#  
We recorded responses from larval tiger salamander retinal ganglion cells using a custom 252-electrode multi-electrode array (MEA).  #@NEW_LINE#@#  For all but the natural movie experiments, eyes were removed in darkness and the retina separated from the pigment epithelium.  #@NEW_LINE#@#  The natural movie experiments were conducted with the pigment epithelium intact and surgery performed in dim light.  #@NEW_LINE#@#  The isolated retina was then placed onto the array and superfused with oxygenated Ringers medium at room temperature.  #@NEW_LINE#@#  Offline spike sorting was performed with custom software.  #@NEW_LINE#@#  Detailed recording and analysis methods, including the spike-sorting algorithm, are described in [1].  #@NEW_LINE#@#  

Visual_stimulation  #@NEW_LINE#@#  
Stimuli were projected onto the array from a CRT monitor at 60 Hz.  #@NEW_LINE#@#  We presented three stimulus classes, in different experiments: a natural movie, a binary white noise checkerboard, and a diffusively moving dark bar.  #@NEW_LINE#@#  The natural movie consisted of a 7minute gray scale recording of leaves and branches blowing in the wind.  #@NEW_LINE#@#  We conducted natural movie experiments with two different designs: in the first, the movie was looped with a different pixel centered on the recording area for each repeat.  #@NEW_LINE#@#  Since the patch of retina recorded by the MEA subtended only a small portion of the stimulus, we were able to construct this stimulus in such a way that the retinal input was effectively non-repeated over the full recording session.  #@NEW_LINE#@#  In a second design, we generated a similar non-repeated movie, but alternated every 60 sec of non-repeated stimulation with an identical 60 sec clip.  #@NEW_LINE#@#  The binary white noise stimulus consisted of a 40 x 40 flickering checkerboard, randomly updated every frame.  #@NEW_LINE#@#  Each checker had a size of 55 x 55 m when projected onto the retina.  #@NEW_LINE#@#  The drifting bars motion was a random walk subject to a restoring force to keep it, on average, centered on the recording area [99].  #@NEW_LINE#@#  Both the checkerboard and drifting bar designs consisted of a long period of non-repeated stimulation interspersed with repeated segments at randomly-chosen time intervals (repeat duration = 60 sec for the bar, 30 sec for the checkerboard).  #@NEW_LINE#@#  

Model_specification  #@NEW_LINE#@#  
We binned spike trains into 20 ms time bins, producing a sequence of binary spike words i(t), where i = 1N labels the neuron identity and t the time bin.  #@NEW_LINE#@#  We set i(t) = 1 whenever at least one spike occurred within bin t, and 0 otherwise.  #@NEW_LINE#@#  Because our hidden Markov model (HMM) incorporates temporal correlations between adjacent time bins [50], we fit the parameters of this model to the entire sequence of binary spike words, which we denote by ({i(0),,i(T)}) (see Fig 2):  #@NEW_LINE#@#  

where the summation is over all possible sequences of modes from time 0 to T. Because there are M possible modes in each time bin, this sum involves a total of MT+1 terms.  #@NEW_LINE#@#  Here, (t) and {i(t)} denote the mode index and binary spike word in a single time bin, t, respectively.  #@NEW_LINE#@#  The transition matrix was assumed to be stationary, i.e.  #@NEW_LINE#@#  independent of t: P((t)|(t1))  P(|).  #@NEW_LINE#@#  The emission probabilities  were defined by constraining joint probabilities between certain neuron pairs as follows:  #@NEW_LINE#@#  

where the pairs indexing the second product, i,j, are chosen to form a tree (Fig 2B).  #@NEW_LINE#@#  This tree constraint is necessary for the factorized form to give a correctly normalized probability distribution; the choice of tree topology, however, is a priori arbitrary and was learned during the fitting step.  #@NEW_LINE#@#  The motivation behind this choice was that these interaction terms help describe correlations within the neural population, yet have a form with parameters that can be readily fit to data.  #@NEW_LINE#@#  In the statistics literature, this emission distribution is known as the Chow-Liu tree [100].  #@NEW_LINE#@#  In our model, the tree topology may differ for each mode .  #@NEW_LINE#@#  
The parameters of the full model are therefore: M, the number of modes; the M Ã M transition matrix P( | ); the choice of tree topology for each mode; and the collection of joint probabilities on each modes tree, p(i,j).  #@NEW_LINE#@#  The latter may be parameterized by a mode-dependent spiking probability for each cell, mi = p(i = 1), and a pairwise correlation for each tree edge, Cij = p(i = 1,j = 1), giving M (2N  1) parameters describing the emission distributions.  #@NEW_LINE#@#  Finally, we introduced a single regularization parameter , described below.  #@NEW_LINE#@#  
After fitting the full model, we inferred the mode that was active at each time bin of the data by maximizing the posterior probability of the mode sequence, conditioned on all the observed spike train data from the beginning of the experiment up until time t: *(t) = argmax PHMM((t)|({i(0),,i(T)})).  #@NEW_LINE#@#  This maximization was implemented by the Viterbi algorithm [101].  #@NEW_LINE#@#  
For some purposes, we wanted to reduce the full HMM to a static (time-independent) probability distribution, which describes the probability of occurrence of a single binary spike word.  #@NEW_LINE#@#  This static probability distribution had a mixture form (see Fig 2C):  #@NEW_LINE#@#  

where we used the set of tree emission distributions fit for the full HMM along with mode-dependent weights, {w}, defined by the detailed balance equation:  #@NEW_LINE#@#  


Model_fitting  #@NEW_LINE#@#  
For fixed M, we inferred the parameters by maximum likelihood, using the Baum-Welch algorithm with an M-step modified to accommodate the specified form of Q [50].  #@NEW_LINE#@#  Full details are reported in the Supplement.  #@NEW_LINE#@#  
To mitigate overfitting, we introduced a regularization parameter   [0,1] (see Supporting Information File).  #@NEW_LINE#@#  The above maximum likelihood fitting was carried out for fixed M and  Increasing M and decreasing  both increase the complexity of the model, and lead to a strictly improved likelihood on the training data.  #@NEW_LINE#@#  To choose these parameters we carried out an n-fold cross-validation procedure; generating n non-overlapping splits of the data into training and test sets.  #@NEW_LINE#@#  M was then chosen to maximize the test set likelihood, averaged over the n folds (Fig 2D).  #@NEW_LINE#@#  In practice, we chose n = 2.  #@NEW_LINE#@#  
Our results were little affected by the precise value of , provided it was small but nonzero.  #@NEW_LINE#@#  We used  = 0.002 throughout the present work.  #@NEW_LINE#@#  

Entropy_of_emission_distributions  #@NEW_LINE#@#  
To calculate the entropy of the emission distributions plotted in Fig 2, we used an analytical formula obtainable from the above-factorized probability distribution:  #@NEW_LINE#@#  

After fitting the full model (see above), we were able to obtain all parameters necessary to evaluate this equation exactly.  #@NEW_LINE#@#  
To calculate the maximum entropy possible for an emission distribution with a given average spike count, less_thank, we started by observing that the maximum entropy would be obtained when all possible states were equally likely.  #@NEW_LINE#@#  For an integer spike count, this uniform emission distribution is given by:  #@NEW_LINE#@#  

Thus, the maximum entropy is given by:  #@NEW_LINE#@#  

where (N) is the Gamma distribution.  #@NEW_LINE#@#  

Transition_entropy  #@NEW_LINE#@#  
To characterize the statistics of how one mode transitions to another mode in the next time step, we calculated the transition entropy:  #@NEW_LINE#@#  

This quantity has the interpretation that from mode , transitions can be made to roughly  different modes.  #@NEW_LINE#@#  Because self-transitions dominated, we also calculated the transition entropy using transition probabilities with only off-diagonal components:  for   .  #@NEW_LINE#@#  

Information_efficiency  #@NEW_LINE#@#  
For each mode, we computed r(t), the fraction of stimulus repeats on which the mode was active at time bin t, and its time average .  #@NEW_LINE#@#  We then defined the output entropy of mode occurrence, Sout, and its noise entropy, Snoise, as follows:  #@NEW_LINE#@#  


The information efficiency was defined to be the mutual information divided by the output entropy: .  #@NEW_LINE#@#  

Linear-nonlinear_modeling  #@NEW_LINE#@#  
For each cell individually, we fit a linear-nonlinear (LN) model with a logistic nonlinearity:  #@NEW_LINE#@#  

where  is the probability of the cell i spiking within time bin t, given the stimulus  in that time bin, and spiking is modeled as independent (Bernoulli) across time bins.  #@NEW_LINE#@#  The stimulus  and the linear filter  contain both spatial (pixels) and temporal (past time bins) dimensions, with Ki*s denoting summation over the spatial dimensions and convolution over the temporal:  #@NEW_LINE#@#  

where  indexes time bins and  spatial pixels.  #@NEW_LINE#@#  
To fit the model, we first set the linear filter  equal to the spike-triggered average in a binary white-noise checkerboard experiment.  #@NEW_LINE#@#  In our experiments, the receptive field centers typically occupied a small region of only 24 checks across, while the stimulus was 40x40 checks.  #@NEW_LINE#@#  We therefore set all checks outside of a 7x7 patch centered on the receptive field peak to zero, in order to suppress noise introduced in the spike-triggered average estimate.  #@NEW_LINE#@#  The remaining two parameters  and  were then estimated by numerical maximum likelihood on the model.  #@NEW_LINE#@#  

Randomized_reproducibility_controls  #@NEW_LINE#@#  




