article id="http://dx.doi.org/10.1371/journal.pbio.2002930"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Cell signaling heterogeneity is modulated by both cell-intrinsic and -extrinsic mechanisms: An integrated approach to understanding targeted therapy  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
During the last decade, our understanding of cancer cell signaling networks has significantly improved, leading to the development of various targeted therapies that have elicited profound but, unfortunately, short-lived responses.  #@NEW_LINE#@#  This is, in part, due to the fact that these targeted therapies ignore context and average out heterogeneity.  #@NEW_LINE#@#  Here, we present a mathematical framework that addresses the impact of signaling heterogeneity on targeted therapy outcomes.  #@NEW_LINE#@#  We employ a simplified oncogenic rat sarcoma (RAS)-driven mitogen-activated protein kinase (MAPK) and phosphoinositide 3-kinase-protein kinase B (PI3K-AKT) signaling pathway in lung cancer as an experimental model system and develop a network model of the pathway.  #@NEW_LINE#@#  We measure how inhibition of the pathway modulates protein phosphorylation as well as cell viability under different microenvironmental conditions.  #@NEW_LINE#@#  Training the model on this data using Monte Carlo simulation results in a suite of in silico cells whose relative protein activities and cell viability match experimental observation.  #@NEW_LINE#@#  The calibrated model predicts distributional responses to kinase inhibitors and suggests drug resistance mechanisms that can be exploited in drug combination strategies.  #@NEW_LINE#@#  The suggested combination strategies are validated using in vitro experimental data.  #@NEW_LINE#@#  The validated in silico cells are further interrogated through an unsupervised clustering analysis and then integrated into a mathematical model of tumor growth in a homogeneous and resource-limited microenvironment.  #@NEW_LINE#@#  We assess posttreatment heterogeneity and predict vast differences across treatments with similar efficacy, further emphasizing that heterogeneity should modulate treatment strategies.  #@NEW_LINE#@#  The signaling model is also integrated into a hybrid cellular automata (HCA) model of tumor growth in a spatially heterogeneous microenvironment.  #@NEW_LINE#@#  As a proof of concept, we simulate tumor responses to targeted therapies in a spatially segregated tissue structure containing tumor and stroma (derived from patient tissue) and predict complex cell signaling responses that suggest a novel combination treatment strategy.  #@NEW_LINE#@#  

Author_summary  #@NEW_LINE#@#  
A signaling pathway is a network of molecules in a cell that is typically initiated by stimuli (e.g., microenvironmental cues) acting on receptors and internal signaling molecules to determine cell fate.  #@NEW_LINE#@#  Signaling pathways in cancer cells are different from those in normal cells, and this difference helps cancer cells to grow and thrive indefinitely.  #@NEW_LINE#@#  Drugs that target the aberrant signaling pathways in cancer cells (often referred to as targeted therapy) are promising for improving treatment outcomes of many different cancers in patients.  #@NEW_LINE#@#  However, most patients eventually develop resistance to these drugs.  #@NEW_LINE#@#  Resistance may already be present in the tumor or may emerge via mutation or via microenvironmental mediation.  #@NEW_LINE#@#  Tumor heterogeneity, which is characterized by subtle or dramatic differences among tumor cells, plays a key role in the development of drug resistance.  #@NEW_LINE#@#  Some tumor cells respond well to therapy, while others may adapt to the stress induced by the drug within the microenvironment.  #@NEW_LINE#@#  Moreover, removal of drug-sensitive cells may result in the competitive release of drug-resistant cells.  #@NEW_LINE#@#  Here, we present mathematical models to assess the impact of heterogeneity in signaling pathways within tumor cells on the outcomes of targeted therapy.  #@NEW_LINE#@#  We consider a simplified version of two well-known signaling pathways that modulate the growth of lung cancer cells.  #@NEW_LINE#@#  By using different targeted therapies, we quantify the effect of pathway inhibition on protein activity and cell viability and developed a mathematical model of the network, which is trained to reproduce these data and to develop a panel of heterogeneous in silico cells.  #@NEW_LINE#@#  The model predicts potential mechanisms of drug resistance and proposes combination therapies that are effective across the panel.  #@NEW_LINE#@#  We validate these combination therapies experimentally using the lung cancer cells and integrated the in silico cells into a computational lung tissue model that explicitly captures the microenvironment of lung cancer.  #@NEW_LINE#@#  Our results suggest that heterogeneity in both the tumor and microenvironment impacts treatment response in different ways and suggest a novel combination therapy for a better response.  #@NEW_LINE#@#  

Citation: Kim E, Kim J-Y, Smith MA, Haura EB, Anderson ARA (2018) Cell signaling heterogeneity is modulated by both cell-intrinsic and -extrinsic mechanisms: An integrated approach to understanding targeted therapy.  #@NEW_LINE#@#  PLoS Biol 16(3):  #@NEW_LINE#@#  
           e2002930.  #@NEW_LINE#@#  

        https://doi.org/10.1371/journal.pbio.2002930  #@NEW_LINE#@#  
Academic Editor: Sui Huang, Institute for Systems Biology, United States of America  #@NEW_LINE#@#  
Received: May 5, 2017; Accepted: February 5, 2018; Published:  March 9, 2018  #@NEW_LINE#@#  
Copyright:  Â© 2018 Kim et al.  #@NEW_LINE#@#  This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.  #@NEW_LINE#@#  
Data Availability: All relevant data are within the paper and its Supporting information files.  #@NEW_LINE#@#  
Funding: NIH/NCI (grant number U154CA193489-01A1).  #@NEW_LINE#@#  Eunjung Kim and Alexander Anderson were supported by this grant.  #@NEW_LINE#@#  The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  NCI (grant number R21CA181848).  #@NEW_LINE#@#  Jae-Young Kim, Matthew A. Smith, Eric B. Haura were supported by this grant.  #@NEW_LINE#@#  The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  State of Florida Biomedical Research Program-Bankhead Coley (grant number 5BC07).  #@NEW_LINE#@#  Matthew A. Smith, Eric B. Haura were supported by this grant.  #@NEW_LINE#@#  The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  Chungnam National University and National Research Foundation of Korea (grant number NRF-2017R1D1A1B03029896).  #@NEW_LINE#@#  Jae-Young Kim was supported by this grant.  #@NEW_LINE#@#  The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  
Competing interests:  The authors have declared that no competing interests exist.  #@NEW_LINE#@#  
Abbreviations:  #@NEW_LINE#@#  
          AKT (PKB),  #@NEW_LINE#@#  
            protein kinase B; DMSO,  #@NEW_LINE#@#  
            Dimethyl sulfoxide (control); EGFR,  #@NEW_LINE#@#  
            epidermal growth factor receptor; ERK,  #@NEW_LINE#@#  
            extracellular receptor kinase; FDA,  #@NEW_LINE#@#  
            Food and Drug Administration; GRB2,  #@NEW_LINE#@#  
            growth factor receptor bound protein 2; HCA,  #@NEW_LINE#@#  
            hybrid cellular automata; HGF,  #@NEW_LINE#@#  
            hepatocyte growth factor; KRAS,  #@NEW_LINE#@#  
            Kirsten rate sarcoma; MAPK,  #@NEW_LINE#@#  
            mitogen-activated protein kinase; MEK,  #@NEW_LINE#@#  
            Mitogen-activated protein kinase kinase; MET (c-MET),  #@NEW_LINE#@#  
            tyrosine-protein kinase Met or hepatocyte growth factor receptor (HGFR); NSCLC,  #@NEW_LINE#@#  
            nonsmall-cell lung cancer; ODE,  #@NEW_LINE#@#  
            ordinary differential equation; PI3K,  #@NEW_LINE#@#  
            phosphoinositide 3-kinase; RAF,  #@NEW_LINE#@#  
            rapidly accelerated fibrosarcoma; RAS,  #@NEW_LINE#@#  
            rat sarcoma; RMSE,  #@NEW_LINE#@#  
            root-mean-squared-error; RSK,  #@NEW_LINE#@#  
            ribosomal S6 kinase; RTK,  #@NEW_LINE#@#  
            receptor tyrosine kinase; Ser,  #@NEW_LINE#@#  
            serine; Thr,  #@NEW_LINE#@#  
            threonine; Tyr,  #@NEW_LINE#@#  
            tyrosine  #@NEW_LINE#@#  
Introduction  #@NEW_LINE#@#  
Normal cell signaling is significantly altered in cancer as a result of genetic and epigenetic changes, facilitating uncontrolled proliferation and cell survival [1, 2].  #@NEW_LINE#@#  Targeted therapies directly exploit these alterations by blocking the activity of specific proteins typically mutated or abnormally up-regulated [3].  #@NEW_LINE#@#  These therapies have elicited dramatic success in controlling the growth of multiple cancers [410] but showed little to moderate impact on others [11, 12].  #@NEW_LINE#@#  Drug resistance, however, remains a major problem due to both cancer cellintrinsic (innate and acquired) resistance mechanisms [13] and microenvironment-mediated resistance [1416].  #@NEW_LINE#@#  
Tumor heterogeneity is known to contribute to drug resistance [17, 18].  #@NEW_LINE#@#  Cancer cells within a tumor exhibit differential genetic and phenotypic characteristics [19].  #@NEW_LINE#@#  Genomic heterogeneity leads to cell-to-cell variability in protein expression and activity as genes drive the production of proteins.  #@NEW_LINE#@#  Protein activity is variable even in genetically identical cancer cell populations in the same microenvironment [2022].  #@NEW_LINE#@#  This cell-to-cell variability arises from intrinsic stochastic fluctuations [2330] and variation in microenvironmental conditions that affect the protein-signaling network.  #@NEW_LINE#@#  This variation can affect sensitivity to stimuli, contribute to cell phenotype decisions, and cause clonal cells to differently respond to stimulus and targeted therapies (e.g., erlotinib) [31, 32].  #@NEW_LINE#@#  
Understanding how cancer cell signaling variation affects targeted therapy outcomes is challenging.  #@NEW_LINE#@#  Cancer-driven signaling proteins do not function in isolation but rather function in protein complexes that belong to large and complex signaling networks that govern key phenotypic processes such as proliferation, apoptosis, and response to targeted therapy [33, 34].  #@NEW_LINE#@#  Furthermore, the cancer signaling network and drug response are modulated by microenvironmental factors [35, 36].  #@NEW_LINE#@#  Therefore, experimental data obtained from simplified cell-based experiments in single uniform environments will have limited ability to tease apart the impact of signaling network and microenvironmental variation on targeted therapy outcomes.  #@NEW_LINE#@#  A number of previous studies have used mathematical models to understand complex signaling networks and improve treatment strategies.  #@NEW_LINE#@#  Various modeling approaches were developed (reviewed in [37]).  #@NEW_LINE#@#  Boolean or probabilistic Boolean models were developed to analyze cancer signal pathways and predict treatment outcomes [3841].  #@NEW_LINE#@#  A logical modeling approach was employed to understand various cell signaling pathways [4247].  #@NEW_LINE#@#  An artificial neural network approach was used to map between microenvironments, pathways, and phenotypes [48].  #@NEW_LINE#@#  Detailed kinetic models of cell signaling pathways have been studied using systems of ordinary differential equations (ODEs) [4957].  #@NEW_LINE#@#  Most studies, however, ignore signaling heterogeneity or extrinsic variation in microenvironmental cues that will differentially stimulate the signaling network.  #@NEW_LINE#@#  
To investigate the effects of signaling heterogeneity on targeted therapy outcomes, we develop an integrated approach combining in vitro experiments with three different mathematical models, an intracellular signaling model, a cancer cell population growth model, and a hybrid cellular automata (HCA) model of tumor and stroma (see Fig 1 for an overview).  #@NEW_LINE#@#  
A simplified signaling pathway was derived based on literature.  #@NEW_LINE#@#  Various kinase inhibitors were applied to an experimental model system to perturb the simplified pathway in different microenvironmental conditions (e.g., HGF and no-HGF).  #@NEW_LINE#@#  A mathematical model of the pathway was developed and calibrated by comparing model predictions with experimental data.  #@NEW_LINE#@#  The model predictions were validated with experimental data.  #@NEW_LINE#@#  A validated pathway model was integrated into a logistic growth model to simulate the impact of competition between cells in a homogeneous and resource-limited microenvironment.  #@NEW_LINE#@#  Another integration of the pathway model into a hybrid model highlighted the impact of both microenvironmental heterogeneity and direct spatial competition of one cell with its direct neighbors on targeted treatment outcomes.  #@NEW_LINE#@#  AKT (PKB), protein kinase B; DMSO, Dimethyl sulfoxide (control); EGFR, epidermal growth factor receptor; ERK, extracellular receptor kinase; HGF, hepatocyte growth factor; MEK, Mitogen-activated protein kinase kinase; MET (c-MET), tyrosine-protein kinase Met or hepatocyte growth factor receptor (HGFR); PI3K, phosphoinositide 3-kinase; RAF, rapidly accelerated fibrosarcoma; RAS, rat sarcoma; RAS_m, mutated RAS; RAS_w, wild-type RAS; RSK, ribosomal S6 kinase.  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pbio.2002930.g001  #@NEW_LINE#@#  

Materials_and_methods  #@NEW_LINE#@#  
Mathematical_modeling_of_MAPK_and_PI3K-AKT_pathway  #@NEW_LINE#@#  
We consider a simplified signaling network composed of interactions between key proteins in an oncogenic rat sarcoma (RAS)-driven mitogen-activated protein kinase (MAPK) and phosphoinositide 3-kinase (PI3K)protein kinase B (AKT, PKB) pathway (Fig 2A).  #@NEW_LINE#@#  This pathway has been studied extensively, and the positive or negative feedback regulations between proteins in the pathway are known [5862].  #@NEW_LINE#@#  Of note, mammalian cells express three RAS gene family members (HRAS, NRAS, and KRAS), and our model is based on empirical data obtained from a lung cancer cell line (A549); KRAS is always activated by a point mutation (Gly12Ser), whereas the other two RAS proteins (HRAS and NRAS) are wild type.  #@NEW_LINE#@#  Recent studies reported the importance of crosstalk between wild-type and mutant RAS proteins in cancers driven by oncogenic mutant RAS [59, 63, 64].  #@NEW_LINE#@#  Therefore, we consider two different types of RAS, wild type (RAS_w) and mutant type (RAS_m).  #@NEW_LINE#@#  The network node connectivity is based on prior pathway information between signaling proteins [5862].  #@NEW_LINE#@#  Most interactions are feed-forward and positive (Fig 2A, green lines) except the one negative feedback regulation of epidermal growth factor receptor (EGFR) by extracellular receptor kinase (ERK) (Fig 2A, red line).  #@NEW_LINE#@#  While network connectivity is assumed fixed in the model, the strength of interactions is variable and is modeled using a weight matrix (W).  #@NEW_LINE#@#  Each element in the network (node xi) is updated by solving the following equation,  #@NEW_LINE#@#  
(1)  #@NEW_LINE#@#  
where x1,2 correspond to two inputs (growth factor and hepatocyte growth factor [HGF]), and 3,4,n correspond to the relative change of protein activities or cell viability due to an inhibitor with respect to untreated conditions (log2 (treated/untreated)) to be consistent with experimental data.  #@NEW_LINE#@#  Of note, all of the experimental measures in our study are relative values, normalized to the unperturbed condition.  #@NEW_LINE#@#  The absolute concentration or activity of signaling proteins as well as cell viability are difficult to acquire from experiments performed in our study, namely western blot experiments and cell viability measurement assays.  #@NEW_LINE#@#  Therefore, the weights in the model represent relative abundance or protein activities in treated conditions compared to treatment-naÃ¯ve conditions.  #@NEW_LINE#@#  The model assumes that the rate of change of a variable is determined by the linear combination of neighboring nodes with corresponding weights.  #@NEW_LINE#@#  This additive linear function has successfully described protein reaction networks [54, 55, 65] although other functions such as Michaelis-Menten kinetics are viable options [51].  #@NEW_LINE#@#  In the experiments we carried out, the microenvironmental conditions are growth factor and HGF.  #@NEW_LINE#@#  The growth factor (model variable x1) is always present, while HGF (model variable x2) is present in only some of the experimental conditions.  #@NEW_LINE#@#  In particular, the HGF is not present in the control condition.  #@NEW_LINE#@#  All experimental results are normalized to this control (no-HGF) condition.  #@NEW_LINE#@#  To represent these experimental conditions in the model, the input value x1 is set to a nonzero constant value (e.g., x1  C), while the variable x2 is set to be 0 or nonzero (e.g., x2  C) if HGF is present.  #@NEW_LINE#@#  We chose to set the parameter constant C to be 10.  #@NEW_LINE#@#  N(i) represents the neighborhood of a protein node i (a set of nodes connected to the node i), and  indicates a tendency to return to the untreated state.  #@NEW_LINE#@#  The transfer function T accounts for saturation effects, and the constants  and  modulate amplitude and slope.  #@NEW_LINE#@#  In the model, we set  to be 4.5 and  to be 0.5 to model a smooth sigmoidal behavior.  #@NEW_LINE#@#  
Drug inhibition is modeled by knocking out a corresponding protein activity.  #@NEW_LINE#@#  For example, if a drug inhibits a protein xi, then the variable xi is set to be a very small number ().  #@NEW_LINE#@#  It is worth noting that we modeled the effect of drugs tyrosine-protein kinase Met inhibitor (METi), EGFRi, and AKTi by inhibiting pMET, pEGFR, and pAKT activities, respectively.  #@NEW_LINE#@#  Two other drugs, mitogen-activated protein kinase kinase (MEKi), and ERKi, are modeled to inhibit pERK and pRSK, respectively (Fig 2B).  #@NEW_LINE#@#  

Logistic_tumor_growth  #@NEW_LINE#@#  
We combine the pathway model to a logistic growth ODE model to simulate the growth of in silico cells as a well-mixed population in a resource-limited environment.  #@NEW_LINE#@#  The model is defined as follows,  #@NEW_LINE#@#  
(2)  #@NEW_LINE#@#  
where yi represents the number of in silico cell i, ri is the cell intrinsic growth rate of the cell i, N is the total number of cell types, and K is the carrying capacity (set to be 1 billion).  #@NEW_LINE#@#  To model influence of the signaling pathway on cell population growth, we formulate a cell population growth rate, ri, as a function of cell viability solutions and the treatment-naÃ¯ve growth rate (ri  f (i, r0); i: cell viability solution in linear scale not in log2 scale; r0: growth rate in an untreated control condition).  #@NEW_LINE#@#  Specifically, the cell viability for each cell type is obtained by fitting pathway model to our experimental data, as described in the Results section.  #@NEW_LINE#@#  The cell viability of cell type i (i) represents the number of cell type i that survived after being given therapy relative to an untreated control condition (i.e., i = Pi(t)/P0(t), i: cell viability, Pi,0(t): number of cell type i at time t in a treated and untreated condition, respectively).  #@NEW_LINE#@#  To obtain a functional form for the growth rate, we make the following assumptions.  #@NEW_LINE#@#  We assume that a cell population initially grows exponentially  for some time T).  #@NEW_LINE#@#  We also assume that the number of initial cell population is the same in a treated condition and in an untreated control condition (Pi(0) = P0(0)).  #@NEW_LINE#@#  Then, cell viability is presented as a function of growth rates and time ().  #@NEW_LINE#@#  Solving the function for growth rate ri, we obtain a functional form for the growth rate.  #@NEW_LINE#@#  We use the doubling time of A549 cells (22 hours from [66]) to obtain the treatment-naÃ¯ve growth rate (r0 = 0.76 per day).  #@NEW_LINE#@#  We use our cell viability assay experimental time point (t = 3 days, described in Results section).  #@NEW_LINE#@#  Now, we have a constant growth rate of cell type i for each treatment condition (500 cells x 28 treatment conditions, total 14,000 growth rates, ri).  #@NEW_LINE#@#  Then, the ODE Eq (2) is solved to simulate a given treatment response of cell i over time.  #@NEW_LINE#@#  All of the in silico cells are solved simultaneously competing for limited resource (carrying capacity K).  #@NEW_LINE#@#  

HCA_tumor_model  #@NEW_LINE#@#  
The pathway model is integrated into an HCA model [67, 68] to simulate treatment responses in a spatially heterogeneous microenvironment.  #@NEW_LINE#@#  The model has the following assumptions.  #@NEW_LINE#@#  In the HCA, the cells are defined as points on a two-dimensional lattice that also contains continuous concentration fields of microenvironmental factors, together representing a cross-section of tumor composed of cancer cells and stroma (50 cells x 38 cells).  #@NEW_LINE#@#  Here, we define the tumor and stroma region explicitly based on an image segmentation of lung adenocarcinoma tissue from a patient.  #@NEW_LINE#@#  The tumor region contains cancer cells.  #@NEW_LINE#@#  Each cancer cell contains the pathway model, as developed above (Fig 2A), that links the microenvironment to cell phenotypes.  #@NEW_LINE#@#  The model grid can contain any number of possible microenvironmental variables.  #@NEW_LINE#@#  For simplicity, however, we consider only growth factors and HGF.  #@NEW_LINE#@#  The growth factors are assumed to be constant in the domain.  #@NEW_LINE#@#  We explicitly model HGF dynamics in space and time using the following partial differential equation,  #@NEW_LINE#@#  
(3)  #@NEW_LINE#@#  
where H(x,t) represents the concentration of HGF at a lattice point x in tumor region and at time t. D represents the diffusion rate, and  is a decay rate.  #@NEW_LINE#@#  The parameter values used in a simulation are given in the corresponding figure legend.  #@NEW_LINE#@#  The concentration of HGF is fixed to be a constant value (H(x,t) = ) in the stromal region.  #@NEW_LINE#@#  A Neumann boundary condition (, normal derivative = 0) was imposed on the domain boundary.  #@NEW_LINE#@#  A Dirichlet condition (H(x,t) = ) was imposed at the interface between tumor and stroma.  #@NEW_LINE#@#  
The steady state solution of Eq (3) is fed into one of the inputs (HGF) in the pathway model in each cell (Fig 2A).  #@NEW_LINE#@#  The pathway determines cell viability and controls three different phenotypesproliferation, quiescence, and deathas defined by the rules summarized in the flowchart (S1 Fig).  #@NEW_LINE#@#  Each cell is allowed to execute only one phenotype per time step (day).  #@NEW_LINE#@#  Of note, the model considers only orthogonal neighbors (north, west, south, and east) for space to divide or move.  #@NEW_LINE#@#  Cells are not allowed to leave nor enter across the boundary and are thus confined within the domain.  #@NEW_LINE#@#  We assume that the distribution of HGF barely changes during HCA simulation.  #@NEW_LINE#@#  For example, if a cell divides into two daughter cells, this increased number of cells does not impact the HGF distribution because we assume the consumption of HGF by cells negligible and that cells do not produce HGF.  #@NEW_LINE#@#  Because HGF consumption is minimal and the HGF diffusion timescale (approximate seconds) is a lot shorter than cell division time scale (approximate day) and the model domain size is small (50 cells x 38 cells), any consumption would quickly be equilibrated to the steady state.  #@NEW_LINE#@#  

Cell_line  #@NEW_LINE#@#  
A549 lung adenocarcinoma cell line was maintained in RPMI 1640 medium supplemented with 10% FBS.  #@NEW_LINE#@#  Cells were confirmed to be free of mycoplasma using PlasmoTest (Invivogen, San Diego, CA).  #@NEW_LINE#@#  

Western_blots  #@NEW_LINE#@#  
Cells were washed with ice-cold PBS, and whole cell extracts were prepared using lysis buffer (0.5% NP-40, 50 mM Tris-Cl, pH 8.0, 150 mM NaCl, 1 mM EDTA) supplemented with protease inhibitor (Roche, Mannheim, Germany) and phosphatase inhibitor cocktail (Sigma-Aldrich, Carlsbad, CA).  #@NEW_LINE#@#  Whole-cell extracts were resolved on SDS-PAGE and transferred to nitrocellulose membrane.  #@NEW_LINE#@#  The membrane was blocked in 5% skim milk/PBST and then incubated in primary antibody at 4Â°C overnight.  #@NEW_LINE#@#  Bound antibodies were visualized by horseradish peroxidase-conjugated secondary antibodies and SuperSignal West Pico Chemiluminescent Substrate (Thermo Scientific, Waltham, MA).  #@NEW_LINE#@#  Primary antibodies used for our study were purchased from Cell Signaling Technology (Danvers, MA) (except for -actin, which was from Sigma-Aldrich, St. Louis, MO).  #@NEW_LINE#@#  

Cell_viability_measurement  #@NEW_LINE#@#  
Cells were plated on 96-well plate at 2,000 cells per well and then exposed to drugs for 72 hours.  #@NEW_LINE#@#  Cell viability was analyzed by CellTiter-Glo (Promega, Madison, WI) according to the manufacturers recommendations.  #@NEW_LINE#@#  

Proximity_ligation_assays  #@NEW_LINE#@#  
Proximity ligation assays were performed as described using Duolink Far Red kit (Sigma-Aldrich, Carlsbad, CA) with antibodies to the following: EGFR (clone B38, Cell Signaling, Danvers, MA), GRB2 (clone 81, BD, San Jose, CA), and AF488-conjugated pan cytokeratin (clone Ae1/Ae3, eBioSciences, San Diego, CA).  #@NEW_LINE#@#  Tissue specimen was from a de-identified patient treated at Moffitt Cancer Center and was obtained via an institutionally approved protocol.  #@NEW_LINE#@#  


Results  #@NEW_LINE#@#  
We followed the steps described in Fig 1 to investigate the effects of signaling heterogeneity on targeted therapy outcomes.  #@NEW_LINE#@#  First, we develop an intracellular signaling pathway model.  #@NEW_LINE#@#  We construct a simplified cancer signaling pathway based on prior information about the pathway, and we experimentally perturb the pathway using various kinase inhibitors in two different microenvironmental conditions (Fig 1 Design & Experiments).  #@NEW_LINE#@#  Among key microenvironmental factors, HGF has been shown to contribute to resistance in multiple Food and Drug Administration (FDA)-approved targeted therapy drugs [35, 36].  #@NEW_LINE#@#  Therefore, we consider HGF as an additional microenvironmental stimulus.  #@NEW_LINE#@#  Then, we build a mathematical model of the cancer signaling pathway to predict both signaling and a phenotypic response (cell viability change due to a given therapy) to different inhibitors that target the pathway (Fig 1 prior pathway information).  #@NEW_LINE#@#  It is important to note that the model includes two microenvironmental factors (i.e., growth factor or HGF) and cell viability (Fig 1 prior pathway information) in addition to intracellular proteins (Fig 1 prior pathway information).  #@NEW_LINE#@#  Model parameters are calibrated using experimentally measured protein expression levels and cell viability after different inhibitors are applied under different microenvironmental conditions (Fig 1 Pathway Modeling, model calibration).  #@NEW_LINE#@#  Now using this panel of in silico cells with calibrated signaling networks, we predict distributional responses to different targeted therapies, reveal possible mechanisms of drug response and resistance, and propose combination therapy strategies that could deal with heterogeneity.  #@NEW_LINE#@#  The model predictions are then tested experimentally.  #@NEW_LINE#@#  
Next, we develop a logistic cancer cell population growth model to describe tumor growth in a homogeneous but resource-limited microenvironment (Fig 1 Multiscale Mathematical Modeling).  #@NEW_LINE#@#  The intrinsic growth rate of each cancer cell is estimated based on the treatment-naÃ¯ve growth rate and cell viability obtained from the signaling pathway model calibration.  #@NEW_LINE#@#  We predict post-treatment cell population heterogeneity and average efficacy after continuous application of various inhibitors (both mono and combination therapies).  #@NEW_LINE#@#  Finally, we develop an HCA model to investigate the effects of spatially heterogeneous microenvironments on targeted therapy outcomes (Fig 1 Multiscale Mathematical Modeling).  #@NEW_LINE#@#  The model couples continuous microenvironmental factors with a discrete cellbased model.  #@NEW_LINE#@#  Each individual cell contains the trained network model that links microenvironment to its phenotype, which determines cell fate in a given condition.  #@NEW_LINE#@#  As a proof of concept, we simulate the response to an inhibitor in a section of tissue composed of both tumor cells and stroma.  #@NEW_LINE#@#  The model predicts complex cancer cell signaling responses and treatment outcomes, driven by both cell-intrinsic and -extrinsic mechanisms.  #@NEW_LINE#@#  
Experimentally_measured_cancer_cell_response_to_various_kinase_inhibitors  #@NEW_LINE#@#  
Kirsten rat sarcoma (KRAS)-driven cancer treatment is an important clinical need that remains largely unmet due to limited targeted drug efficacy of key downstream effectors, including MAPK and PI3K-AKT pathways.  #@NEW_LINE#@#  We therefore choose the KRAS mutant nonsmall-cell lung cancer (NSCLC) cell line (A549 cell line) as our experimental model system.  #@NEW_LINE#@#  Using our simplified oncogenic KRAS signaling pathway (Fig 2A, Mathematical modeling section for an explanation of how we obtained this simplified pathway) as a guide, we pharmacologically inhibited individual proteins in the MAPK pathway (MET, EGFR, MEK, ERK inhibitors) and PI3K-AKT (AKT inhibitor) pathway in A549 cells in the both absence and presence of HGF.  #@NEW_LINE#@#  Drug-induced changes in the phosphorylation of pathway proteins, surrogates for protein activity, were measured by western blotting (Fig 2B).  #@NEW_LINE#@#  Cell viability was also assessed after 72 hours of drug treatment (Fig 2C).  #@NEW_LINE#@#  These experimental data were quantified using ImageJ (Fig 2D), and all data were normalized to the control experimental condition (treatment-naÃ¯ve condition).  #@NEW_LINE#@#  

Model_calibration  #@NEW_LINE#@#  
The quantified changes (Fig 2D) and the Monte Carlo simulation were then employed as an optimization procedure to estimate model parameters (weights, Wij) that minimize our cost function.  #@NEW_LINE#@#  A network with lower cost represents the experimental data more accurately.  #@NEW_LINE#@#  The cost function is defined as follows,  #@NEW_LINE#@#  
(4)  #@NEW_LINE#@#  
where  is the steady state activity of protein or cell viability xi in treatment condition d, yd represents experimental data, and M is the total number of treatment conditions.  #@NEW_LINE#@#  The weight wjr indicates the weight between RAS_m (r) and its neighbors (N(r)), and the constants (, ) modulate the magnitude of the penalty.  #@NEW_LINE#@#  The first term explains the difference between model prediction and experimental data for a network W. The second term is directed at the activating RAS mutation and incorporates a penalty for estimated weights from the RAS_m node (mutant RAS) that are too small.  #@NEW_LINE#@#  We included this penalty because our model is based on empirical data of a KRAS mutant cancer cell line (A549 cell), where the resulting KRAS protein is constitutively active.  #@NEW_LINE#@#  We aimed to capture this activating mutation by penalizing small weights from RAS_m to its neighbors.  #@NEW_LINE#@#  
We used the following method to implement Monte Carlo simulations:  #@NEW_LINE#@#  
The model calibration resulted in more than 5,000 weight matrices that fit to the experimental data.  #@NEW_LINE#@#  We selected the best 500 (top 10%) weight matrices and used these to define our 500 in silico cells.  #@NEW_LINE#@#  The distributions of in silico cells are presented as box plots in Fig 2E along with the experimental measures.  #@NEW_LINE#@#  Errors (root-mean-squared-error [RMSE] formula given in S1 Text) are in the range of (0.030.56, except ERK: 0.96).  #@NEW_LINE#@#  The fit of ERK was poor because of unexpected inhibition of pERK by the drug (ERK inhibitor, SCH772984) [69].  #@NEW_LINE#@#  The trained networks (weights) are quite heterogeneous (S1 Table).  #@NEW_LINE#@#  The distribution for each weight is different (S1 Table, skewed, normal, bimodal distributions, with a range of heterogeneity [Shannon] index values).  #@NEW_LINE#@#  
The weights here may represent relative protein abundance or protein-binding activity.  #@NEW_LINE#@#  There is ample evidence for differential abundance of protein species across cellular populations.  #@NEW_LINE#@#  An excellent example was recently published showing that variations in adaptor protein abundance are a major source of regulation of the EGFR-MAPK pathway [70].  #@NEW_LINE#@#  There are several examples of differential binding activity of proteins in cell signal transduction.  #@NEW_LINE#@#  It is well established that adaptors such as GRB2, SHC1, and GAB1 can be recruited to receptor tyrosine kinases (RTKs) either directly or indirectly.  #@NEW_LINE#@#  Therefore, stochastic variation in multiprotein complex composition at individual receptors exists, and this will vary both within and between cells.  #@NEW_LINE#@#  It is also accepted that activation-induced receptor degradation and phosphatase activity will affect not only RTK adaptor interactions but also downstream signaling molecules such as rapidly accelerated fibrosarcoma (RAF), MEK, and ERK.  #@NEW_LINE#@#  Additionally, we have previously shown that, in EGFR mutant cell lines, only a fraction of the receptor is phosphorylated, and cell lines harboring the same oncogenic mutation have different levels of phosphorylated Tyrosine (Tyr) and Serine/threonine (Ser/Thr) residues [71].  #@NEW_LINE#@#  Collectively, these examples indicate that proteinprotein interactions in response to growth factors are not simply onoff states and that multiple factors independent of protein abundance control final signaling output.  #@NEW_LINE#@#  

Distributional_responses_to_kinase_inhibitors  #@NEW_LINE#@#  
We simulated responses of in silico cells to seven different inhibitors (EGFRi, METi, RAS_mi, AKTi, RAFi, MEKi, and ERKi).  #@NEW_LINE#@#  Of note, cell viability in untreated conditions is set to be a single constant value (cell viabilityuntreated  1).  #@NEW_LINE#@#  It is also worth noting that RAS_mi is assumed to inhibit only RAS_m (RAS mutant), not RAS_w.  #@NEW_LINE#@#  Distributions of relative cell viability (log2 scale, log2 (treated/untreated)) of all in silico cells are presented in Fig 3A.  #@NEW_LINE#@#  Similar to the experimental results (Fig 2B2D), MEKi and ERKi reduced average cell viability significantly, whereas mean effects of EGFRi, METi, and AKTi are marginal.  #@NEW_LINE#@#  These results reveal quite heterogeneous responses to drugs, which could be assessed by experimental approaches [72, 73].  #@NEW_LINE#@#  For example, the distribution of EGFRi treatment is bimodal due to a bimodal distribution of trained MEK-ERK weights (S1 Table and S2 Fig), suggesting the presence of a subpopulation that responds significantly differently to drug from the rest of the population (S2 Fig, green versus pink).  #@NEW_LINE#@#  

In_silicopredicted_rational_drug_combinations  #@NEW_LINE#@#  
With our calibrated in silico cell lines, we next examine which drug combinations significantly reduce cell viability and which show marginal effects.  #@NEW_LINE#@#  For example, what should be cotargeted with AKTi to decrease cell viability significantly?  #@NEW_LINE#@#  The model predicts that activation of alternative pathways under therapy may provide an escape route to therapy.  #@NEW_LINE#@#  For example, AKT inhibitor induced increased activity of ERK and ribosomal S6 kinase (RSK) (S3 Fig).  #@NEW_LINE#@#  Cells with high ERK and RSK activity display resistance (cell viability  greater than 0) under the inhibitor, which implies that simultaneous inhibition of this alternative pathway would overcome resistance.  #@NEW_LINE#@#  We reasoned that combination targeting of proteins that are highly correlated with relative cell viability under a given treatment would be beneficial.  #@NEW_LINE#@#  In order to identify such protein nodes, scatter plots between predicted protein activity (phosphorylation) and predicted relative cell viability were considered (S4 Fig).  #@NEW_LINE#@#  Then, the Pearsons coefficient was calculated for all cases.  #@NEW_LINE#@#  We observed that, under multiple treatment conditionsincluding inhibition of EGFR, MET, RAS_m, AKT, and RAFERK and RSK showed the highest correlation with relative cell viability (S4 Fig, pink box).  #@NEW_LINE#@#  This suggests that co-inhibition of ERK (by MEKi) or RSK (by ERKi) activity with other therapies would decrease cell viability most significantly.  #@NEW_LINE#@#  Further simulation revealed an additional application of either MEKi or ERKi to eachEGFRi, METi, RAS_mi, RAFi, and AKTisignificantly decreased cell viability compared to monotherapy of EGFRi, METi, RAS_mi, RAFi, and AKTi (Fig 3B).  #@NEW_LINE#@#  We tested some of these model predictions experimentally and validated, to some degree, the models predictive ability (Fig 3C).  #@NEW_LINE#@#  

Hierarchical_clustering_of_in_silico_cell_responses  #@NEW_LINE#@#  
We next systematically assessed cell viability reduction to all mono and combination therapies using an unsupervised hierarchical clustering approach to classify cell populations on the basis of their treatment response (relative cell viability).  #@NEW_LINE#@#  The treatments were categorized into multiple groups (Fig 4A, a tree diagram on the right end of heat-map).  #@NEW_LINE#@#  The combination of AKTi with MEKi is uniformly effective to all the cells (see the red asterisk [*] row, dark blue across all in silico cells, with little variation between cells).  #@NEW_LINE#@#  This combination (MEKi/AKTi) has previously been shown to be effective in NSCLC both in vitro and in vivo [74].  #@NEW_LINE#@#  A striking variation is observed in response to the treatments of AKTi, RAS_mi, and RAS_mi/AKTi (Fig 4A, red bars in the first two groups versus dark blue to yellow bars in the rest of the groups).  #@NEW_LINE#@#  The first two clusters (pink and black color on the top of the heat-map) are associated with poor responses (little to no reduction of cell viability after a given therapy), while others are correlated with good treatment outcomes (significant reduction of cell viability after a given therapy).  #@NEW_LINE#@#  

Possible_mechanisms_of_response_and_resistance  #@NEW_LINE#@#  
Why are some cells sensitive to a given therapy while others are resistant to the same therapy?  #@NEW_LINE#@#  We hypothesize that this differential drug sensitivity, at least within the context of our model, must be attributed to differential protein activity as modulated by proteinprotein interactions (i.e., the weights).  #@NEW_LINE#@#  To highlight possible mechanisms, we visualized the weights between protein nodes (Wij in our model) using both circular chord diagrams [75] and network diagrams with weighted edges (Fig 4, bottom panels; left: chord diagram; right: weighted network with different edge widths).  #@NEW_LINE#@#  In the circular diagrams, protein nodes are arranged around a circle with the weight between protein nodes connected to each other through the use of arcs.  #@NEW_LINE#@#  The width of each arc is determined proportionally by the weight between two protein nodes.  #@NEW_LINE#@#  To illustrate differences in signaling, we selected two representative in silico cells (Fig 4A and 4B), where cell a is resistant to AKTi, RAS_mi, and RAS_mi/AKTi and cell b is more sensitive to these therapies.  #@NEW_LINE#@#  In addition, we compared ranges of all weights of all in silico cells between clusters defined by the hierarchical clustering (S5A Fig).  #@NEW_LINE#@#  We observe heterogeneity of weights within each cluster and between clusters.  #@NEW_LINE#@#  Differences between clusters are significant for some weights such as weights of growth factor EGFR, EGFR-RAS_w, MET-RAS_w, RAS_w-RAF, and MEK-ERK (S5A Fig).  #@NEW_LINE#@#  

Heterogeneous_responses_to_HGF_stimulation  #@NEW_LINE#@#  
We next asked how an additional microenvironmental stimulation would modulate the responses to targeted treatments.  #@NEW_LINE#@#  To address this question, all in silico cells were treated in the presence of HGF, a significant stromal factor that contributes to drug resistance [35, 36].  #@NEW_LINE#@#  An unsupervised hierarchical clustering on the basis of cell viability changes, from the no-HGF condition, separated the treatments into several groups (Fig 5A, clustering of treatments on the right tree diagram).  #@NEW_LINE#@#  The analysis also classified the in silico cells into several groups based on cell viability changes due to HGF stimulation (Fig 5A, tree diagram on the top of heat-map).  #@NEW_LINE#@#  
To test some of these model predictions, we considered three different combination therapies, AKTi/MEKi, EGFRi/MEKi, and EGFRi/AKTi.  #@NEW_LINE#@#  Of note, the model predicted that the treatments AKTi/MEKi and EGFRi/MEKi are not affected by HGF stimulation (Fig 5B, first two red bar graphs).  #@NEW_LINE#@#  The experimental data matched well with these predictions (Fig 5B, first two gray bar graphs).  #@NEW_LINE#@#  The model also predicted that the effect of combination therapy EGFRi/AKTi is significantly modulated by HGF stimulation (Fig 5B, the third red bar).  #@NEW_LINE#@#  This was also corroborated by experiment (Fig 5B, the third gray bar).  #@NEW_LINE#@#  

Possible_mechanisms_explaining_HGF_modulation  #@NEW_LINE#@#  
The suite of in silico cells is differentially affected by HGF stimulation.  #@NEW_LINE#@#  For example, some cells are not affected by the HGF stimulation (e.g., gray bars in EGFRi/RAS_mi in Fig 5A), while others are significantly affected by stimulation (e.g., red bars in EGFRi/RAS_mi in Fig 5A).  #@NEW_LINE#@#  Why are some cells affected by HGF stimulation, while others are not?  #@NEW_LINE#@#  To understand why this is the case, we selected two representative cells (a and b) and visualized the weights between protein nodes using both chord diagrams and weighted network diagrams (Fig 5C, bottom panels).  #@NEW_LINE#@#  In cell a, the influence of MET on RAS_w is relatively small (Fig 5C, thin blue chords from MET  RAS_w).  #@NEW_LINE#@#  In contrast to cell a, the influence of MET on RAS_w in cell b is much stronger (Fig 5C, cell b, thick blue chord from MET  RAS_w).  #@NEW_LINE#@#  This may explain why cell b increased its viability significantly upon HGF stimulation compared to no-HGF condition.  #@NEW_LINE#@#  In addition, distributions of all weights in each cluster show differential activity of proteins and its effects across all six different clusters (S5B Fig).  #@NEW_LINE#@#  

Competition_between_in_silico_cells_drives_different_dominant_populations  #@NEW_LINE#@#  
So far, treatment responses were assessed as if all in silico cells were treated in isolation.  #@NEW_LINE#@#  To address the effects of cell competition on treatment outcomes, we simulated all cells growing together under treatment with various inhibitors in a homogeneous, resource-limited microenvironment (Methods section).  #@NEW_LINE#@#  The entire in silico cell population responds in a similar way on some therapies (Fig 6, e.g., EGFRi, METi, RAFi, EGFRi/RAS_mi, etc.  #@NEW_LINE#@#  ), but under other therapies (Fig 6, e.g., MEKi, ERKi, MEKi/ERKi, AKTi/RAFi, etc.  #@NEW_LINE#@#  )due to differential viabilitysome cells became dominant.  #@NEW_LINE#@#  Interestingly, some treatments simultaneously selected for the same dominant in silico cell (Fig 6, color-shaded boxes).  #@NEW_LINE#@#  Addition of HGF to some treatments (e.g., EGFRi, RAS_mi, RAFi) significantly changes the fitness of in silico cells and thus drives a different dominant in silico cell (S6 Fig, dotted lines in no-HGF vs solid lines in HGF).  #@NEW_LINE#@#  

Assessment_of_post-treatment_in_silico_cell_population_heterogeneity  #@NEW_LINE#@#  
We assessed post-treatment population heterogeneity by measuring the Shannon index (H(x) = ipi(x)log(pi(x)), where pi(x) is the probability of finding an in silico cell i after a given therapy).  #@NEW_LINE#@#  We compared the index with average cell viability change (Fig 6B).  #@NEW_LINE#@#  The two are linearly correlated ( = 0.65), implying that the less effective a treatment is in controlling the average in silico population growth, the more heterogeneous the post-treatment population would be (Fig 6B).  #@NEW_LINE#@#  Combination therapies not only display a better average treatment response but also a less diverse post-treatment population (Fig 6B, boxes versus circles).  #@NEW_LINE#@#  Among all combination therapies, those that combined either with ERKi or MEKi display much better average therapeutic responses (Fig 6B, small cell viability).  #@NEW_LINE#@#  These treatments not only effectively decrease average cell viability but also lead to a less diverse post-treatment population (e.g., Fig 6B, EGFRi/[ERKi or MEKi] vs EGFRi/[METi,AKTi,RAFI] in red-color circles).  #@NEW_LINE#@#  HGF stimulation minimally affected the linear relationship between post-treatment heterogeneity and average cell viability reduction (Fig 6C,  = 0.63 vs Fig 6B,  = 0.65).  #@NEW_LINE#@#  However, a few treatments did elicit significant changes in both average response and heterogeneity due to HGF stimulation (Fig 6D).  #@NEW_LINE#@#  

Impact_of_microenvironmental_heterogeneity_on_targeted_therapy_outcomes  #@NEW_LINE#@#  
Because activated receptors require multiple protein interactions to activate downstream signaling, we have utilized proximity ligation assays that measure the functional association of RTKs and adaptor proteins.  #@NEW_LINE#@#  Using NSCLC patient specimens and xenograft models, we have previously identified an association of EGFR:GRB2 complexes and response to EGFR inhibition [76] and more recently identified a correlation between MET:GRB2 complexes and response to MET kinase inhibitors [77].  #@NEW_LINE#@#  Using this approach, we consistently observe spatial heterogeneity in abundance of RTKs binding to adaptor complexes.  #@NEW_LINE#@#  The abundance is often highest at tumor regions that are adjacent to stromal regions (Fig 7A).  #@NEW_LINE#@#  
Motivated by this experimental observation (Fig 7A), we developed an HCA model to investigate the effects of microenvironmental heterogeneity on treatment outcomes (See Methods section and S1 Fig).  #@NEW_LINE#@#  A steady state configuration of HGF is considered throughout the whole simulation (See Methods section and Fig 7B).  #@NEW_LINE#@#  We randomly initialized in silico cells that contain calibrated signaling networks (Fig 2) in the domain to mimic a slice of tumor tissue (Fig 7C first, time step = 0; domain size: 50 cells Ã 38 cells).  #@NEW_LINE#@#  As proof of concept, we simulated RAS_m inhibition.  #@NEW_LINE#@#  After 180 days of the inhibition, distinct cells emerge near stroma (high HGF) in contrast to the nonstroma region (Fig 7C second, light- and dark-blue cells near stroma versus orange, red cells elsewhere).  #@NEW_LINE#@#  A clearer separation among the cell population emerges as therapy continues (S1 Movie).  #@NEW_LINE#@#  We also observed heterogeneous protein activity across the tissue (Fig 7D and S2 Movie).  #@NEW_LINE#@#  The signaling responses of some cells are affected by HGF (Fig 7D, e.g., high MET and RAF, black arrows near stroma), while signaling in other cells is not (Fig 7D, e.g., low activity of MET and RAF near stroma, red arrow).  #@NEW_LINE#@#  
The treatment selects for cells with high MET and RAF activity (phosphorylation), especially residing near the stroma (high HGF), which suggests that a therapy of METi or RAFi in addition to RAS_mi may be more effective.  #@NEW_LINE#@#  To test this suggestion, we simulated two sequential therapies of RAS_mi and RAFi and one concurrent therapy (Fig 7E and S3S6 Movies).  #@NEW_LINE#@#  Depending on the order of the sequence (RAS_mi first versus RAFi first), different patterns of cells emerge after 400 days of treatment (Fig 7E, first versus second).  #@NEW_LINE#@#  Importantly, a concurrent combination of the two inhibitors was effective enough to eradicate all cells in this small region just after 30 days of treatment (S5 Movie and Fig 7E third, number of cells).  #@NEW_LINE#@#  The direct spatial competition of each cell within the tissue directly facilitated this result.  #@NEW_LINE#@#  To be more relevant to the clinical timeframe, we also simulated a shorter treatment schedule (e.g., 60 days) and observed similar cell behavior (S7 Fig).  #@NEW_LINE#@#  
Until now, we assumed that the initial states of the protein activities in our in silico cells were all zero.  #@NEW_LINE#@#  In order to examine the impact of changing this on the above treatment outcomes, we randomly seeded in silico cells in a slice of tissue (Fig 7C), and for each in silico cell, a random number was assigned to each initial protein activity.  #@NEW_LINE#@#  Then, we simulated RAS_m inhibitor for 30 days using our HCA model (S1 Fig) and repeated this process 100 times.  #@NEW_LINE#@#  The resulting configurations display some degree of heterogeneity (S8A Fig, shows representative results for three different initial configurations) due to cellcell spatial competition as well as variable HGF modulation of the in silico cells.  #@NEW_LINE#@#  The HGF selects for cells whose cell viability is significantly modulated by HGF (violet to red cells near stroma).  #@NEW_LINE#@#  To illustrate this more accurately, we quantified the total number of surviving cells at time step 30 for each simulation (see S8B Fig for distributions) and classified them in terms of HGF modulation (S8C Fig).  #@NEW_LINE#@#  The treatment consistently selected for certain cells (S8C Fig), some of which are more influenced by HGF than others (S8C Fig).  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
We implemented an integrated mathematical and experimental approach to develop a panel of in silico cells that readily reproduced average kinase inhibitor responses in two different microenvironments (HGF and no-HGF).  #@NEW_LINE#@#  The mathematical model of a simplified oncogenic RAS-driven MAPK and AKT-PI3K pathway describes weighted interactions between proteins in the pathway.  #@NEW_LINE#@#  The weights here may represent relative protein abundance or protein activity.  #@NEW_LINE#@#  The calibrated model predicted heterogeneous responses to kinase inhibitors due to differential activities of proteins from the in silico cells under a given therapy condition.  #@NEW_LINE#@#  In addition, the model identified a combination therapy that effectively reduced cell viability across the entire in silico cell population (Fig 4, AKTi/MEKi).  #@NEW_LINE#@#  Critically, the effects are not modulated by HGF stimulation (Fig 5).  #@NEW_LINE#@#  This combination has been shown to be effective in NSCLC both in vitro and in vivo [74].  #@NEW_LINE#@#  Integrating the pathway model into a two-dimensional lattice-based model allowed us to take a significant step toward modeling the multiscale behavior of cancer by bridging the signaling, cell, and multicellular scales with feedback from the microenvironment.  #@NEW_LINE#@#  We were also able to simulate the impact of an inhibitor on a tissue structure composed of tumor and stroma, showing complex signaling responses and selection for distinct in silico cells by the stroma (Fig 7 and S1 and S2 Movies), which highlighted a novel combination therapy (Fig 7 and S3S6 Movies).  #@NEW_LINE#@#  
We are only just beginning to understand the importance of nongenetic heterogeneity [19, 78].  #@NEW_LINE#@#  Much more needs to be done in teasing apart the different scales of heterogeneity (genetic, cellular, microenvironmental), how they interact and modulate one another, and how this might alter our current combination treatment strategies.  #@NEW_LINE#@#  Variable protein activity has been observed in previous studies of isogenic cancer cell lines, revealing that single-cell heterogeneity and proteinprotein interaction strength is different [73].  #@NEW_LINE#@#  A more recent study, of an isogenic cancer, showed striking variation in genetic, cellular, and phenotypic heterogeneity [79].  #@NEW_LINE#@#  Our own experiments and simulations showed heterogeneous cancer cell signaling in a section of lung adenocarcinoma (Fig 7) [76, 77].  #@NEW_LINE#@#  
There are other modeling approaches for analysis of signaling pathways including logical, Boolean, and artificial neural network (reviewed in [37]).  #@NEW_LINE#@#  In particular, several recent studies developed integrated approaches of mathematical modeling with systematic perturbation experiments applying various kinase inhibitors to cancer cells.  #@NEW_LINE#@#  Some of these studies proposed novel combination therapies [43, 51, 54], just as we have.  #@NEW_LINE#@#  However, in addition to predicting average cell viability, we also consider post-treatment heterogeneity and, critically, the impact of the microenvironment.  #@NEW_LINE#@#  Historically, Boolean models have been used in understanding cancer cellsignaling responses.  #@NEW_LINE#@#  To investigate applicability of such a Boolean approach, we constructed an equivalent Boolean model of the signaling pathway (S2 Text and S9 Fig).  #@NEW_LINE#@#  This model predicted the treatment combinations (AKTi/MEKi and AKTi/RAFi) consistent with experimental data (Fig 3C, two out of seven different combination therapies).  #@NEW_LINE#@#  However, the other five combination therapies were not consistent with experimental data (yellow asterisks in S9C Fig).  #@NEW_LINE#@#  Taken together, these results suggest that the Boolean model (S9A Fig) is insufficient to predict combination therapies.  #@NEW_LINE#@#  
To obtain a tractable model, several simplifications have been made in this study.  #@NEW_LINE#@#  The model considered only two microenvironmental variables (HGF and a generic growth factor) on a two-dimensional square lattice, where the heterogeneous population of in silico cells mimicked a slice of lung tissue.  #@NEW_LINE#@#  Although three-dimensional models will describe these dynamics in a more realistic way, the key predictionsfor example, the effect of stromawill be consistent in a three-dimensional setting.  #@NEW_LINE#@#  Other simplifying aspects of the HCA approach included not considering tissue mechanical properties as well as constraining cell movement to orthogonal neighbors with discontinuous displacement.  #@NEW_LINE#@#  A potential alternative approach would be to consider off-lattice models that allow force-driven interactions that better describe mechanical aspects of tumor growth [8083] and tumor morphology [8486].  #@NEW_LINE#@#  We are also acutely aware that the signaling network considered is only a fragment of a much larger and far more complex signaling cascade that turns external signals into phenotypic decisions.  #@NEW_LINE#@#  Because not all proteins in cancer cells are directly measurable due to experimental limitations, many players and intermediate proteins in the pathway are not included in our study.  #@NEW_LINE#@#  Therefore, an interaction between two proteins represents diverse influence of one entity on other entity in steady state, such that an entity can be a microenvironmental variable, an intracellular protein, or cell viability.  #@NEW_LINE#@#  We emphasize that, by definition, all models are but simplifications of reality and the true utility of a model is not that it can mimic reality but that it provides useful insight into the system.  #@NEW_LINE#@#  Despite this simplicity, our integrated approach provided multiple testable hypotheses for the complex KRAS NSCLC cell signaling network, proposed possible drug resistance mechanisms, and suggested better treatment strategies.  #@NEW_LINE#@#  
Finally, while we relied on western blots for protein activity (phosphorylation) readouts, alternative approaches such as Reverse Phase Protein Array exist [87].  #@NEW_LINE#@#  The important step, however, was combining this average protein activity with prior information about network connectivity, allowing us to generate a suite of in silico cell lines that not only reproduced this average behavior but also gave insights into potential single-cell variability.  #@NEW_LINE#@#  This highlights a key need to improve our understanding of heterogeneous cell signaling networks: single-cell profiling.  #@NEW_LINE#@#  Such data would ideally include intracellular, cellular, and phenotypic profiling in multiple, uniform microenvironments.  #@NEW_LINE#@#  However, our results also emphasize the importance of interactions between heterogeneous cell populations and spatially structured environments.  #@NEW_LINE#@#  Therefore, while quantifying single-cell dynamics will provide key information about intrinsic cell heterogeneity, to fully understand how these differences impact treatment responses, we must consider how interactions that change through space and time alter this heterogeneity and thus treatment outcomes.  #@NEW_LINE#@#  

Supporting_information  #@NEW_LINE#@#  
S1_Fig_Flowchart_of_each_cell_in_the_HCA_model  #@NEW_LINE#@#  
Each cell contains its own signaling network (calibrated network model, Fig 2A) and processes signaling to determine its viability.  #@NEW_LINE#@#  If the viability is low, the cell commits death with a probability of the viability.  #@NEW_LINE#@#  Otherwise, the cell waits for the next time step.  #@NEW_LINE#@#  If the cell viability is not too low, we check for an empty space in its nearest four neighbors (north, east, south, west from the cell).  #@NEW_LINE#@#  If there is an empty space, the cell divides with a probability of the viability.  #@NEW_LINE#@#  If there is no empty space, the cell becomes quiescent and waits for next time step.  #@NEW_LINE#@#  HCA, hybrid cellular automata.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002930.s001  #@NEW_LINE#@#  
(TIFF)  #@NEW_LINE#@#  

S2_Fig_The_in_silico_cells_were_divided_into_two_groups_based_on_MEK-ERK_weights_(large_weights__Green_versus_small_weights__Pink;_a_distribution_figure_on_the_right_upper_corner)  #@NEW_LINE#@#  
Then, distributions of treatment responses for each group were considered.  #@NEW_LINE#@#  The in silico cells with larger MEK-ERK weights seem to be more sensitive to both EGFRi and RAFi and are more resistant to AKTi than the ones with smaller MEK-ERK weights.  #@NEW_LINE#@#  AKT (PKB), protein kinase B; EGFR, epidermal growth factor receptor; ERK, extracellular receptor kinase; MEK, mitogen-activated protein kinase kinase; RAF, rapidly accelerated fibrosarcoma.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002930.s002  #@NEW_LINE#@#  
(TIFF)  #@NEW_LINE#@#  

S3_Fig_Activation_of_alternative_pathway_in_response_to_AKTi  #@NEW_LINE#@#  
A scatter plot of relative cell viability (ratio of cell viability after treatment to cell viability before treatment, log 2 scale) as a function of relative activities of ERK and RSK (ratio of protein activity after treatment to protein activity before treatment, log 2 scale) is given.  #@NEW_LINE#@#  Color represents cell viability (blue: small and yellow: large).  #@NEW_LINE#@#  Gray plane indicates no change of cell viability.  #@NEW_LINE#@#  AKT (PKB), protein kinase B; ERK, extracellular receptor kinase; RSK, ribosomal S6 kinase.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002930.s003  #@NEW_LINE#@#  
(TIFF)  #@NEW_LINE#@#  

S4_Fig_Linear_correlation_between_cell_viability_and_each_protein_activity  #@NEW_LINE#@#  
Scatter plots of cell viability changes (y axis) against individual protein activity changed (labeled on the bottom, EGFR, MET, RAS_m, RAS_w, AKT, RAF, MEK, ERK, RSK) after each monotherapy (labeled on the top of each row; first row: EGFRi; second row: METi; third: RAS_mi; fourth: AKTi; fifth: RAFi; sixth: MEKi; seventh: ERKi).  #@NEW_LINE#@#  Each dot represents an individual in silico cell.  #@NEW_LINE#@#  Dotted lines: no change; colored box: highly correlated relations; r: correlation coefficient.  #@NEW_LINE#@#  AKT (PKB), protein kinase B; EGFR, epidermal growth factor receptor; ERK, extracellular receptor kinase; MEK, mitogen-activated protein kinase kinase; MET (c-MET), tyrosine-protein kinase Met or hepatocyte growth factor receptor (HGFR); RAF, rapidly accelerated fibrosarcoma; RAS, rat sarcoma.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002930.s004  #@NEW_LINE#@#  
(TIFF)  #@NEW_LINE#@#  

S5_Fig_Distributions_of_weights  #@NEW_LINE#@#  
(A) Box plots of weights from each cluster in Fig 4A.  #@NEW_LINE#@#  Colors correspond to the different clusters in Fig 4A.  #@NEW_LINE#@#  (B) Boxplots of weights from each cluster in Fig 5A.  #@NEW_LINE#@#  Colors correspond to the different clusters in Fig 5A.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002930.s005  #@NEW_LINE#@#  
(TIFF)  #@NEW_LINE#@#  

S6_Fig_Each_therapy_was_applied_to_all_in_silico_cells_with_HGF_stimulation_for_three_months  #@NEW_LINE#@#  
Color-shaded boxes indicate treatments selecting the same dominant clone.  #@NEW_LINE#@#  Compared with no-HGF treatment (Fig 6A), the treatments of EGFRi/MEKi, RAS_mi/MEKi, and EGFRi/ERKi select a different dominant cell (dashed-color line vs solid-color line).  #@NEW_LINE#@#  AKT (PKB), protein kinase B; corr, linear correlation; EGFR, epidermal growth factor receptor; ERK, extracellular receptor kinase; HGF, hepatocyte growth factor; MEK, mitogen-activated protein kinase kinase; MET (c-MET), tyrosine-protein kinase Met or hepatocyte growth factor receptor (HGFR); PI3K, phosphoinositide 3-kinase; RAF, rapidly accelerated fibrosarcoma; RAS, rat sarcoma.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002930.s006  #@NEW_LINE#@#  
(TIFF)  #@NEW_LINE#@#  

S7_Fig_Treatments_considered_in_Fig_7_(RAS_mi__RAFi_and_RAFi__RAS_mi)_were_simulated_over_60_days  #@NEW_LINE#@#  
(A) Cell configuration after 30 days of RAS_mi first followed by 30 days of RAFi.  #@NEW_LINE#@#  Different cells are represented by different colors.  #@NEW_LINE#@#  (B) Cell configuration after 30 days of RAFi first followed by 30 days of RAS_mi.  #@NEW_LINE#@#  Different cells are represented by different colors.  #@NEW_LINE#@#  (C) Total number of cells over time; blue: RAS_mi  RAFi; red: RAFi  RAS_mi.  #@NEW_LINE#@#  HCA, hybrid cellular automata; RAF, rapidly accelerated fibrosarcoma; RAS, rat sarcoma.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002930.s007  #@NEW_LINE#@#  
(TIFF)  #@NEW_LINE#@#  

S8_Fig_We_considered_100_different_randomly_selected_initial_conditions_of_protein_states_and_simulated_RAS_m_inhibitor_for_30_days  #@NEW_LINE#@#  
(A) Three different representative configurations of cells at time step 30.  #@NEW_LINE#@#  Color: HGF modulation, gray: no change of cell viability due to HGF stimulation; violet: significant increase of cell viability due to HGF.  #@NEW_LINE#@#  (B) Distribution of number of cells at time step 30.  #@NEW_LINE#@#  Boxplots of number of all of 500 cells at time step 30.  #@NEW_LINE#@#  + indicates outliers.  #@NEW_LINE#@#  The maximum difference of interquartile range is 30 cells (approximately 0.02% of total cell population).  #@NEW_LINE#@#  (C) Boxplots of the number of cells whose median cell numbers at time step 30 is greater than 0.  #@NEW_LINE#@#  Color: HGF modulation; gray: no change of cell viability due to HGF stimulation; violet: significant increase of cell viability due to HGF.  #@NEW_LINE#@#  HCA, hybrid cellular automata; HGF, hepatocyte growth factor; RAS, rat sarcoma.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002930.s008  #@NEW_LINE#@#  
(TIFF)  #@NEW_LINE#@#  

S9_Fig_  #@NEW_LINE#@#  
(A) Boolean network model.  #@NEW_LINE#@#  (B) Seven different attractors represented by different colors.  #@NEW_LINE#@#  (C) Active or inactive state of proteins and cell viability after various mono and combination therapies were applied.  #@NEW_LINE#@#  Yellow star: cell viability state that is inconsistent with experimental data (Figs 2 and 3).  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002930.s009  #@NEW_LINE#@#  
(TIFF)  #@NEW_LINE#@#  

S1_Text_RMSE_formula_used_in_Fig_2  #@NEW_LINE#@#  
RMSE, root-mean-squared-error.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002930.s010  #@NEW_LINE#@#  
(DOCX)  #@NEW_LINE#@#  

S2_Text_Boolean_network_model  #@NEW_LINE#@#  
We constructed an equivalent Boolean model of the signaling pathway (S9 Fig).  #@NEW_LINE#@#  In the model, each node has a binary value (1: active, on; 0: inactive, off).  #@NEW_LINE#@#  The behavior of each node is modeled as a sequence of discrete steps in a Boolean function defining the value of a node on the next step based on values of its neighbor nodes (S9A Fig).  #@NEW_LINE#@#  For all nodes except EGFR, a node will be active if at least one of its neighbors is active.  #@NEW_LINE#@#  The node EGFR will be active if either growth factor is active or ERK is inactive (inhibitory regulation of EGFR by ERK).  #@NEW_LINE#@#  Of note, RAS_m node is always active, representing RAS mutation in the cell line (A549) used in our experiments.  #@NEW_LINE#@#  Assuming both of the input nodes(growth factor and HGF) and RAS_mare always active, all possible initial states (210) are exhaustively simulated, using the R package BoolNet [88], until reaching attractors (steady states).  #@NEW_LINE#@#  The simulations converged on seven different attractors (S9B Fig).  #@NEW_LINE#@#  We then simulated seven different combination therapies that we tested in our experiments (Fig 3C).  #@NEW_LINE#@#  To simulate drug-induced inhibition, we made each target node constitutively inactive (e.g., EGFR = 0 for EGFRi; MET = 0 for METi; AKT = 0 for AKTi; ERK = 0 for MEKi; and RSK = 0 for ERKi).  #@NEW_LINE#@#  Two drug combinations result in an inactive viability state (S9C Fig, viability in red, AKTi/RAFi, AKTi/MEKi), which are consistent with both our modeling and experimental data (Fig 3C and Fig 4A).  #@NEW_LINE#@#  The Boolean network model predicts that other combinations are not effective (S9C Fig, active viability state in green), which are not consistent with both our model predictions and experimental data (yellow asterisks in S9C Fig vs Fig 3C).  #@NEW_LINE#@#  Taken together, these results suggest that this simple Boolean network is insufficient to recapitulate our experimental data.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002930.s011  #@NEW_LINE#@#  
(DOCX)  #@NEW_LINE#@#  

S1_Table_For_each_weight_of_interaction__kernel_density_of_distribution_was_estimated_using_R_(gray_probability_density_plots_on_the_edge)  #@NEW_LINE#@#  
Shannon index (SI) was also reported.  #@NEW_LINE#@#  A blue box indicates weights with the lowest Shannon index, while red boxes indicate weights with large Shannon index ( greater than 4.0).  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002930.s012  #@NEW_LINE#@#  
(TIFF)  #@NEW_LINE#@#  

S1_Data_Numerical_data_used_in_figures  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002930.s013  #@NEW_LINE#@#  
(XLSX)  #@NEW_LINE#@#  

S1_Movie_RAS_m_inhibitor_simulation_(cells)  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002930.s014  #@NEW_LINE#@#  
(AVI)  #@NEW_LINE#@#  

S2_Movie_RAS_m_inhibitor_simulation;_protein_phosphorylation_(activity)  #@NEW_LINE#@#  
Yellow: high activity; blue: low activity.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002930.s015  #@NEW_LINE#@#  
(AVI)  #@NEW_LINE#@#  

S3_Movie_A_sequential_therapy_of_RAS_m_inhibitor_for_the_first_200_days_and_then_RAF_inhibitor_for_200_more_days  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002930.s016  #@NEW_LINE#@#  
(AVI)  #@NEW_LINE#@#  

S4_Movie_A_sequential_therapy_of_RAF_inhibitor_for_the_first_200_days_and_then_RAS_m_inhibitor_for_200_days  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002930.s017  #@NEW_LINE#@#  
(AVI)  #@NEW_LINE#@#  

S5_Movie_Concurrent_combination_of_RAS_m_inhibitor_with_RAF_inhibitor_for_30_days  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002930.s018  #@NEW_LINE#@#  
(AVI)  #@NEW_LINE#@#  

S6_Movie_Temporal_evolution_of_the_number_of_cells_(bar_graphs;_color__Different_in_silico_cells)  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pbio.2002930.s019  #@NEW_LINE#@#  
(AVI)  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
Authors would like to thank Dr. Philip Gerlee (Department of Mathematics, Chalmers University of Technology, Gothenburg, Sweden) for his valuable initial inputs and fruitful discussion.  #@NEW_LINE#@#  

References  #@NEW_LINE#@#  



