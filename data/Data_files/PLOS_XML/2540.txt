article id="http://dx.doi.org/10.1371/journal.pone.0201446"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Modeling functional specialization of a cell colony under different fecundity and viability rates and resource constraint  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
The emergence of functional specialization is a core problem in biology.  #@NEW_LINE#@#  In this work we focus on the emergence of reproductive (germ) and vegetative viability-enhancing (soma) cell functions (or germ-soma specialization).  #@NEW_LINE#@#  We consider a group of cells and assume that they contribute to two different evolutionary tasks, fecundity and viability.  #@NEW_LINE#@#  The potential of cells to contribute to fitness components is traded off.  #@NEW_LINE#@#  As embodied in current models, the curvature of the trade-off between fecundity and viability is concave in small-sized organisms and convex in large-sized multicellular organisms.  #@NEW_LINE#@#  We present a general mathematical model that explores how the division of labor in a cell colony depends on the trade-off curvatures, a resource constraint and different fecundity and viability rates.  #@NEW_LINE#@#  Moreover, we consider the case of different trade-off functions for different cells.  #@NEW_LINE#@#  We describe the set of all possible solutions of the formulated mathematical programming problem and show some interesting examples of optimal specialization strategies found for our objective fitness function.  #@NEW_LINE#@#  Our results suggest that the transition to specialized organisms can be achieved in several ways.  #@NEW_LINE#@#  The evolution of Volvocalean green algae is considered to illustrate the application of our model.  #@NEW_LINE#@#  The proposed model can be generalized to address a number of important biological issues, including the evolution of specialized enzymes and the emergence of complex organs.  #@NEW_LINE#@#  

Citation: Tverskoi D, Makarenkov V, Aleskerov F (2018) Modeling functional specialization of a cell colony under different fecundity and viability rates and resource constraint.  #@NEW_LINE#@#  PLoS ONE 13(8):  #@NEW_LINE#@#  
           e0201446.  #@NEW_LINE#@#  

        https://doi.org/10.1371/journal.pone.0201446  #@NEW_LINE#@#  
Editor: Bryan C. Daniels, Arizona State University & Santa Fe Institute, UNITED STATES  #@NEW_LINE#@#  
Received: July 14, 2017; Accepted: July 16, 2018; Published:  August 8, 2018  #@NEW_LINE#@#  
Copyright:  Â© 2018 Tverskoi et al.  #@NEW_LINE#@#  This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.  #@NEW_LINE#@#  
Data Availability: All relevant data are within the paper and its Supporting Information files.  #@NEW_LINE#@#  
Funding: The paper was prepared within the framework of the Basic Research Program at the National Research University Higher School of Economics of Moscow (HSE) and supported within the framework of a subsidy by the Russian Academic Excellence Project 5100.  #@NEW_LINE#@#  The work was conducted by the International Laboratory of Decision Choice and Analysis (DeCAn Lab) of the National Research University Higher School of Economics of Moscow.  #@NEW_LINE#@#  This work was also supported by Le Fonds Quebecois de la Recherche sur la Nature et les Technologies (grant no.  #@NEW_LINE#@#  173878 to VM) and Natural Sciences and Engineering Research Council of Canada (grant no.  #@NEW_LINE#@#  249644 to VM).  #@NEW_LINE#@#  The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  
Competing interests:  The authors have declared that no competing interests exist.  #@NEW_LINE#@#  
Introduction  #@NEW_LINE#@#  
The division of labor and functional specialization emerge ubiquitously in different biological systems and at different levels of life organization.  #@NEW_LINE#@#  For instance, the division of labor occurs in simple multicellular individuals [12], such that cyanobacteria [34], mycobacteria [5], Volvocalean green algae [67] and multicellular yeast [8].  #@NEW_LINE#@#  Various specialization patterns can be observed in different multicellular organisms.  #@NEW_LINE#@#  We can underline two major directions here: specialization in distinct somatic functions and germ-soma specialization [57].  #@NEW_LINE#@#  In this work we mainly focus on the emergence of germ-soma specialization.  #@NEW_LINE#@#  
There are some mathematical models that try to describe the evolution of specialization among somatic functions [5,9].  #@NEW_LINE#@#  For example, Ispolatov et al.  #@NEW_LINE#@#  have considered the process of formation of two-cell aggregates [5].  #@NEW_LINE#@#  Each aggregate can exist either in a unicellular or in a two-cell form.  #@NEW_LINE#@#  The fraction of time that a cell spends in a two-cell form is controlled by cell stickiness, which can evolve in time.  #@NEW_LINE#@#  Also, each cell produces two metabolites.  #@NEW_LINE#@#  In a two-cell form cells can exchange the produced metabolites with other cells, whereas a single cell cannot be involved in such an exchange.  #@NEW_LINE#@#  Ispolatov et al.  #@NEW_LINE#@#  [5] have shown that multicellular organisms can emerge from genetically identical ancestors and that the benefits of aggregation, achieved through specialization in metabolites production, stimulate this emergence.  #@NEW_LINE#@#  This aggregation allows increasing the dimension of phenotype space and provides new global maxima of the fitness function.  #@NEW_LINE#@#  It is worth noting that the changes in cell stickiness can lead to further differentiation of cell types in the colony.  #@NEW_LINE#@#  
Now we will discuss the main issue of our study: the emergence of germ-soma specialization [1012].  #@NEW_LINE#@#  Volvocalean green algae are the most appropriate biological system for studying this issue [1314].  #@NEW_LINE#@#  Volvocalean green algae are flagellated photosynthetic organisms.  #@NEW_LINE#@#  Their lineage contains unicellular organisms, multicellular organisms without cell differentiation, multicellular organisms with partial specialization and multicellular organisms with full germ-soma specialization [13].  #@NEW_LINE#@#  In their seminal work, Michod et al.  #@NEW_LINE#@#  [14] have studied the origin of specialization in colonies of identical cells.  #@NEW_LINE#@#  The fitness of the colony has been defined through its two basic components: viability and fecundity.  #@NEW_LINE#@#  These authors have introduced a specific trade-off function reflecting the intrinsic relationships that link viability and fecundity within a given cell.  #@NEW_LINE#@#  This trade-off emerges due to the cells physiology and other constraints.  #@NEW_LINE#@#  Michod et al.  #@NEW_LINE#@#  [14] have shown how the colonys fitness can be defined using the trade-off functions of individual cells.  #@NEW_LINE#@#  Their work suggests that the curvature of trade-off functions is an important factor that influences the emergence of functional specialization.  #@NEW_LINE#@#  Moreover, Michod et al.  #@NEW_LINE#@#  [14] have stated that small-sized colonies with low initial costs of reproduction have concave trade-off functions at each cell; large-sized colonies require high initial costs of reproduction and, hence, convex trade-off functions.  #@NEW_LINE#@#  
Solari et al.  #@NEW_LINE#@#  [15] have supported the idea that initial costs of reproduction play a significant role in the process of germ-soma separation.  #@NEW_LINE#@#  The model proposed by these authors allows explaining the GS (undifferentiated colonies)GS/S (colonies composed of specialized somatic cells and unspecialized cells)G/S (colonies with complete germ-soma specialization) form of the complexity evolving process in Volvocalean green algae.  #@NEW_LINE#@#  Hallmann [16] has examined in detail the evolution of reproductive development in Volvocalean green algae.  #@NEW_LINE#@#  Gavrilets [17] has studied the emergence of germ-soma specialization via developmental plasticity.  #@NEW_LINE#@#  This author has investigated how regulatory gene expressions, mutation rate, size of a colony and costs of plasticity influence the dynamics of the division of labor.  #@NEW_LINE#@#  Willensdorfer [18] has discussed the phenomenon of somatic cells.  #@NEW_LINE#@#  No any full-terminate somatic cell can reproduce.  #@NEW_LINE#@#  It dies after the colony reproduces.  #@NEW_LINE#@#  This means that these cells should provide some benefits to the organism in order to justify their existence.  #@NEW_LINE#@#  Willensdorfer has presented a model that allows one to determine whether somatic cells are advantageous for the organism or not, and to calculate the optimal fraction of these cells.  #@NEW_LINE#@#  Solari et al.  #@NEW_LINE#@#  [19] have considered the problem under study using some knowledge about different physical processes underlying the organism's evolution.  #@NEW_LINE#@#  Rueffler et al.  #@NEW_LINE#@#  [20] have introduced a general mathematical model of multicellular individuals.  #@NEW_LINE#@#  The main assumption of the model presented in [20] is the presence of some modules that can contribute to different evolutionary functions connected by a trade-off relationship.  #@NEW_LINE#@#  It has been shown that three factors favor different contributions of modules to taskspositional effects, accelerating performance functions and interaction between modules.  #@NEW_LINE#@#  Despite of its generality, the model of Rueffler et al.  #@NEW_LINE#@#  does not predict whether specialization emerges in the system or not.  #@NEW_LINE#@#  
Several authors have developed new models based on the concept of a fitness function.  #@NEW_LINE#@#  In [2123], the models of social choice have been applied to the problem under study.  #@NEW_LINE#@#  It has been shown that the use of the axiomatic approach allows one to construct different social welfare functions that describe the types of fitness-ranking on the set of alternatives representing all states relevant to the group.  #@NEW_LINE#@#  Bossert et al.  #@NEW_LINE#@#  [23] have suggested applying extensive social welfare functions and using their axiomatic properties to better describe the fitness functions of colonies.  #@NEW_LINE#@#  These authors have shown that their axioms are in complete agreement with the fact that the emergence of germ-soma specialization is accompanied by replacing concavity by convexity in the trade-off functions.  #@NEW_LINE#@#  
Most of the fundamental studies discussed above focus on a trade-off relationship between the germ and somatic functions and, in particular, on how this relationship drives the emergence of specialization.  #@NEW_LINE#@#  These studies shed light on how different model's parameters, such as the number of cells in the colony, different levels of regulatory genes expression or the initial cost of reproduction, can change the shape of a trade-off relationship.  #@NEW_LINE#@#  There are, however, some other factors whose impact on the germ-soma separation has not been studied in detail.  #@NEW_LINE#@#  For instance, it is well known that the emergence of specialization is closely related to environmental conditions [24].  #@NEW_LINE#@#  More precisely, a number of empirical studies have shown that the reproduction strategy varies in response to environmental changes [25].  #@NEW_LINE#@#  Kisdi et al.  #@NEW_LINE#@#  [24] have suggested that environmental conditions influence reproductive strategy of cell colonies.  #@NEW_LINE#@#  Also, differences in environmental factors influence viability of the colony.  #@NEW_LINE#@#  If we use a trait-like flagellar motility as an approximation of viability, then viability would depend on the amount of resources dissolved in the surrounding fluid [19] and the type of environment, e.g., still or mixed (see [26]).  #@NEW_LINE#@#  In [27], the rate of survival is used as an approximation of viability.  #@NEW_LINE#@#  In this case, restricted resources lead to a competition between colonies and this competition influences the rates of survival of all interacting colonies.  #@NEW_LINE#@#  It means that there exists a relationship linking fecundity of the colony to its viability and environmental factors.  #@NEW_LINE#@#  
The models described in [1415] assume that all cells of the colony are identical and thus have the same trade-off relationships.  #@NEW_LINE#@#  However, this is a very strong simplification.  #@NEW_LINE#@#  There are several factors which can lead to the emergence of non-identical cells in the colony and to a non-equivalence of cells with respect to biological functions.  #@NEW_LINE#@#  The first such a factor is the presence of mutations.  #@NEW_LINE#@#  Mutations and the natural selection trigger and drive the process of evolution.  #@NEW_LINE#@#  A number of important theoretical approaches to evolution are based on the process of selection involving mutations.  #@NEW_LINE#@#  One of them uses the concept of adaptive dynamics, which is derived based on the selection gradients [2830].  #@NEW_LINE#@#  Mutations occur during cell divisions and change intrinsic structures of cells.  #@NEW_LINE#@#  In other words, this means that different cells can have different trade-off functions.  #@NEW_LINE#@#  Even though initially all cells in the colony are identical, the situation can changes further.  #@NEW_LINE#@#  For instance, Ispolatov et al.  #@NEW_LINE#@#  [5] have considered a model where the genetic parameter of stickiness evolves in time and thus takes different values for different cells.  #@NEW_LINE#@#  A difference between stickiness among cells within the group can lead to the emergence of non-equivalence of cells with respect to a task and, thus, to different trade-off functions of cells.  #@NEW_LINE#@#  
The second factor here is the presence of a specific developmental program which is characterized by asymmetric divisions [31] (Developmental program 2 in Volvocalean green algae [13]).  #@NEW_LINE#@#  The activation of the gls genes in the embryos leads to the appearance of large-small sister-cell pairs [31].  #@NEW_LINE#@#  Gavrilets [17] has provided a model with two prototypes (proto-soma and proto-germ) that can be easily linked to large-small sister-cell pairs.  #@NEW_LINE#@#  However, it would be also interesting to elucidate how the number of these prototypes evolves and to develop a model that deals with an arbitrary number of prototypes.  #@NEW_LINE#@#  
The third factor here is the presence of positional effects described by Rueffler et al.  #@NEW_LINE#@#  [20].  #@NEW_LINE#@#  More precisely, positional effects mean that the contribution of different cells to different tasks depends on the position of each cell within the colony.  #@NEW_LINE#@#  For example, in Volvocalean green algae, cells in the interior or on the edges of the colony do not need to have the same opportunity to contribute to viability.  #@NEW_LINE#@#  Michod et al.  #@NEW_LINE#@#  [14] have assumed that specialization occurs first, and pointed out that specialized germ cells are nonflagellated and thus do not contribute to motility.  #@NEW_LINE#@#  These cells are located in the interior of the colony, making the colony spheroid smaller and lowering drag.  #@NEW_LINE#@#  Another vision would be that if for some reason cells are located in the interior of the colony, then it would make sense for them to become specialized in germ.  #@NEW_LINE#@#  Thus, difference in cells locations generates difference in trade-off relationships among cells.  #@NEW_LINE#@#  
In this work we consider a colony of cells and try to understand incentives for specialization within this colony depending on a given fitness function, encompassing different fecundity and viability rates, and a specific resource constraint.  #@NEW_LINE#@#  We describe three new mathematical models which represent some important generalizations and extensions of the core model of Michod et al.  #@NEW_LINE#@#  [14].  #@NEW_LINE#@#  Firstly, the colony of identical cells is studied.  #@NEW_LINE#@#  We examine whether the changes in available resources and/or fecundity and viability rates can increase the number of specialized cells in small-sized and large-sized colonies.  #@NEW_LINE#@#  Secondly, the colony of cells of different types is studied.  #@NEW_LINE#@#  This differentiation of types may occur as a result of gene mutations, an asymmetric division or positional effects.  #@NEW_LINE#@#  It corresponds to the changes in trade-off functions between viability and fecundity within cells.  #@NEW_LINE#@#  We investigate whether the differentiation of types can lead to the increase in the number of specialized cells in small-sized and large-sized colonies.  #@NEW_LINE#@#  Moreover, we explore how the difference in the types of trade-off functions, available resources or fecundity and viability rates influences the optimal number of specialized cells in the colony.  #@NEW_LINE#@#  Thirdly, we describe a possible generalization of the models considered in the two previous sections.  #@NEW_LINE#@#  The last section provides further discussion and presents some ideas for future research.  #@NEW_LINE#@#  

Materials_and_methods  #@NEW_LINE#@#  
Optimization_model_for_the_colony_of_identical_cells  #@NEW_LINE#@#  

Optimization_model_for_the_colony_of_cells_of_different_types  #@NEW_LINE#@#  

Generalization_of_the_original_model__Considering_inequalities_in_trade-offs  #@NEW_LINE#@#  
Here we consider Problem 6 with different types of trade-offs, assuming that the trade-off relationships have the form (1), i.e., they are represented by inequalities.  #@NEW_LINE#@#  First of all, we need to point out that this problem has a nonempty domain, because the point (b,v) = (0,0) belongs to its domain for all possible values of parameters in the resource constraint.  #@NEW_LINE#@#  Further, we provide general results to describe the solutions of this problem and compare them to the results from the sub-section General statements of the previous section, where the trade-off relationships were represented by equalities.  #@NEW_LINE#@#  Here we also have three possible cases which are as follows:  #@NEW_LINE#@#  
Case 1'.  #@NEW_LINE#@#  Consider Problem (6) with different types of trade-offs represented by inequalities.  #@NEW_LINE#@#  First, we assume that there is no any resource constraint in the model, and identify the set of optimal strategies of the colony, {(b*, v*)}.  #@NEW_LINE#@#  These optimal strategies require the binding of all trade-off constraints.  #@NEW_LINE#@#  Let us now add the resource constraint to the model.  #@NEW_LINE#@#  Case 1' requires that at least one strategy from {(b*, v*)} would remain optimal.  #@NEW_LINE#@#  This case corresponds to the situation in which the resource constraint does not influence the colony's well-being.  #@NEW_LINE#@#  In other words, Case 1' occurs in environments of good quality.  #@NEW_LINE#@#  
Case 2'.  #@NEW_LINE#@#  This case implies that the resource constraint influences the colonys well-being.  #@NEW_LINE#@#  Consider the following set of strategies:  #@NEW_LINE#@#  
(25)  #@NEW_LINE#@#  
Case 2' assumes that the set A' is not empty.  #@NEW_LINE#@#  This set includes the solutions of Problem (6) with different types of trade-offs represented by inequalities and the binding resource constraint.  #@NEW_LINE#@#  The set A' is similar to the set A described in the sub-section General statements of the previous section.  #@NEW_LINE#@#  In Appendix C in S1 Appendix we show that the elements of A' (and only these elements) are the solutions of Problem (6) with different types of trade-offs represented by inequalities.  #@NEW_LINE#@#  The maximum fitness that the colony can reach (i.e., the optimal fitness that the colony can reach by choosing any strategy from A') can be calculated using Eq (8).  #@NEW_LINE#@#  
Case 3'.  #@NEW_LINE#@#  This case implies that the resource constraint influences the colonys well-being and that the set A' is empty.  #@NEW_LINE#@#  Here, the mathematical solution becomes more complex and depends on the parameters of the model (see Appendix C in S1 Appendix).  #@NEW_LINE#@#  If all trade-off functions are concave or linear, then the set of optimal strategies can be found as follows.  #@NEW_LINE#@#  We should find strategies that maximize or minimize (depending of the model's parameters) the total fecundity of the colony subject to all trade-off constraints and under the assumption that all available resources are consumed by the colony (i.e., subject to the resource constraint, assuming that this constraint is binding).  #@NEW_LINE#@#  
Let us now consider Problem (6) with different types of trade-off functions (i.e., Original problem).  #@NEW_LINE#@#  We wonder how the solutions of Original problem change after replacing equalities by inequalities in trade-offs (after these changes we get Problem (6) with different types of trade-off functions and trade-offs inequalities, i.e., Modified problem).  #@NEW_LINE#@#  
- First, we assume that initially we had Case 1.  #@NEW_LINE#@#  The change of equalities by inequalities in the trade-off constraints does not change the problem's solutions.  #@NEW_LINE#@#  After this change, we get Case 1' in Modified problem.  #@NEW_LINE#@#  Indeed, assume that the strategy (b*,v*) is a solution of Original problem.  #@NEW_LINE#@#  This strategy remains feasible in the corresponding Modified problem.  #@NEW_LINE#@#  Let us now consider the strategy (b,v) in Modified problem, such that there exists a subset of cells, M, in the colony, such that for any cell i of M, we have: vi less_than i(bi).  #@NEW_LINE#@#  The strategy (b,v) is not optimal.  #@NEW_LINE#@#  To prove this statement, we consider a strategy (b1,v1), such that bi = bi1 for each cell i of the colony, and vi = vi1 for each cell i that is not in M, and vi1 = i(bi) for each cell i in M. We can see that B(b,v) = B(b1,v1) and V(b,v) less_than V(b1,v1), and so W(b, v) less_than W(b1, v1).  #@NEW_LINE#@#  If the strategy (b1,v1) is in the domain of Modified problem, the statement is proved.  #@NEW_LINE#@#  If not, we have to prove that W(b1,v1)  W(b*,v*).  #@NEW_LINE#@#  Indeed, let us consider the strategy (b*,v*)a solution of Original problem in Case 1.  #@NEW_LINE#@#  It means that (b*,v*) is a solution of Original problem in the absence of the resource constraint.  #@NEW_LINE#@#  Because (b1,v1) belongs to the domain of this problem, we can conclude that W(b1, v1)  W(b*, v*).  #@NEW_LINE#@#  Taking into account that the strategy (b*,v*) is feasible in Modified problem, we can also conclude that (b,v) is not optimal.  #@NEW_LINE#@#  Therefore, the solution of Modified problem belongs to the domain of Original problem.  #@NEW_LINE#@#  Furthermore, the domain of Original problem is a subset of the domain of Modified problem.  #@NEW_LINE#@#  Thus, we conclude that (b*,v*) is a solution of Modified problem in Case 1'.  #@NEW_LINE#@#  
- Second, we assume that initially we had Case 2.  #@NEW_LINE#@#  Thus, the set A represents the solution of Original problem.  #@NEW_LINE#@#  After changing the trade-off constraints (from equalities to inequalities), all points of the set A becomes points of the set A'.  #@NEW_LINE#@#  It means that we get Case 2' in Modified problem and all solutions of Original problem become solutions of Modified problem.  #@NEW_LINE#@#  More precisely, the set A' of all solutions of Modified problem contains all strategies from A as well as possible additional solutions, (b*,v*), for which some trade-off constraints are not binding.  #@NEW_LINE#@#  
- Third, we assume that initially we had Case 3.  #@NEW_LINE#@#  It means that the resource constraint matters and the set A is empty.  #@NEW_LINE#@#  As mentioned above, after changing the trade-off constraints (from = to ), all points of A becomes points of A'.  #@NEW_LINE#@#  Even though the set A is empty, the set A' can be nonempty.  #@NEW_LINE#@#  It leads to two different cases.  #@NEW_LINE#@#  The first case implies that the set A' is nonempty, and we get Case 2' of Modified problem.  #@NEW_LINE#@#  Here all optimal strategies require the existence of at least one cell in the colony, such that viability of this cell is smaller than the maximal possible viability that this cell can attain for a fixed level of fecundity (under the assumption that the only constraint that matters is the trade-off constraint).  #@NEW_LINE#@#  The second case implies that the set A' is empty.  #@NEW_LINE#@#  It means that we get Case 3' of Modified problem.  #@NEW_LINE#@#  
To complete our analysis, we consider the case of an empty domain in Original problem (denoted here as Case 0).  #@NEW_LINE#@#  Assume that we have an environment, such that the domain in Original problem is empty.  #@NEW_LINE#@#  After changing the trade-off constraints (from equalities to inequalities), we get Modified problem.  #@NEW_LINE#@#  In this case, we state that we get Case 2 in Modified problem.  #@NEW_LINE#@#  To prove this statement, we need to show that the set A' in Modified problem is non-empty.  #@NEW_LINE#@#  Because we are in Case 0 in Original problem, , and thus .  #@NEW_LINE#@#  Therefore, there exists b from RN, such that  for all i and .  #@NEW_LINE#@#  Because we are in Case 0, we have .  #@NEW_LINE#@#  Because  and , we get: .  #@NEW_LINE#@#  Therefore, there exists v from RN such that 0vii(bi) for all i and .  #@NEW_LINE#@#  It means that the point (b, v) is in A'.  #@NEW_LINE#@#  Thus, we are in Case 2 of Modified problem.  #@NEW_LINE#@#  
Case 0 can occur here only with equalities in the trade-off relationships.  #@NEW_LINE#@#  This case arises with a very low level of available resources and implies that the colony has no feasible strategies.  #@NEW_LINE#@#  In other words, if the environment is very poor, the colony dies in this environment.  #@NEW_LINE#@#  It looks reasonable from a biological point of view, that there exists a certain resource threshold, C#, such that if the amount of resources available to the colony becomes smaller than C#, then the colony dies.  #@NEW_LINE#@#  In our opinion, the existence of Case 0 is an advantage of the model with trade-offs in the form of equalities.  #@NEW_LINE#@#  Conversely, for each positive value of C, there is a feasible strategy for the colony in the model with trade-offs in the form of inequalities.  #@NEW_LINE#@#  Of course, the fitness of the colony tends to zero as the quality of environmental conditions tends to zero.  #@NEW_LINE#@#  So, formally, the colony has a feasible strategy and a positive, but a very low, fitness even though the amount of available resources is close to zero, i.e., the colony can survive in such an environment.  #@NEW_LINE#@#  Therefore, we should artificially introduce the threshold value of fitness, W#, into the model with trade-offs in the form of inequalities, such that the colony dies in an environment in which the highest attainable fitness is smaller than W#.  #@NEW_LINE#@#  Thus, we showed that the replacement of the trade-off functions vi = i(bi) by vi less_than i(bi) leads to a different analysis in Cases 3 and 0.  #@NEW_LINE#@#  It is worth noting that these results hold as well for non-additive forms of the viability function.  #@NEW_LINE#@#  
In addition, we will show that for Problem (6) with different types of trade-offs represented by inequalities, there is a direct link between the quality of the environment and the Case of solution obtained for this environment.  #@NEW_LINE#@#  Precisely, Case 1' occurs with large values of C, Case 2' with small values of C, and Case 3', if any, with intermediate values of C. This conclusion stems from the two following observations:  #@NEW_LINE#@#  
- Let us consider Problem (6) with different types of trade-offs represented by inequalities, but without the resource constraint.  #@NEW_LINE#@#  We will determine the set S of all solutions of this problem.  #@NEW_LINE#@#  This set is compact, so we can identify the minimal possible value, C*, of , such that there exists a solution (b*,v*) in S satisfying the following inequality: .  #@NEW_LINE#@#  Let us now consider Problem (6) with different types of trade-offs represented by inequalities and the resource constraint.  #@NEW_LINE#@#  For all C C*, Case 1' should occur here.  #@NEW_LINE#@#  
- Let us assume that there exists a level of available resources, C**  greater than  0, such that the set A'(C**) is nonempty.  #@NEW_LINE#@#  It means that Case 2' occurs in Problem (6) with different types of trade-offs represented by inequalities when C** is the amount of available resources.  #@NEW_LINE#@#  Let (b**,v**) be a solution belonging to A'(C**).  #@NEW_LINE#@#  We need to show that for all positive C less_than C**, Case 2' occurs in the considered version of Problem (6).  #@NEW_LINE#@#  In other words, we have to prove that A'(C) is nonempty for all positive C less_than C**.  #@NEW_LINE#@#  First of all, that each value of , such that 0    C**, can be represented as  = C**, where 0    1.  #@NEW_LINE#@#  We need to show that the strategy (b**,v**) belongs to A'().  #@NEW_LINE#@#  Indeed, bi**  0 and vi**  0 for all cells of a given colony, and .  #@NEW_LINE#@#  Moreover, for all cells of the colony we also have:  where the last inequality results from the assumption of a strictly decreasing form of trade-off functions.  #@NEW_LINE#@#  Thus, we showed that for the trade-off relationships of the form vi  i(bi), Case 3' takes place in environments of intermediate quality, Case 1' in environments of good quality, and Case 2' in environments of bad quality.  #@NEW_LINE#@#  In general, this is not true for the trade-off relationships of the form vi = i(bi).  #@NEW_LINE#@#  Here, Case 1 takes place in environments of good quality too, and Case 0 in environments of bad quality, but the situation with Cases 2 and 3 is more sophisticated.  #@NEW_LINE#@#  To show this, we consider the following numerical example which involves three cells with the following trade-off functions: v1 = 6  3b12, v2 = 4 b22 and v3 = 5  2b32.  #@NEW_LINE#@#  These trade-off functions are concave because we consider a small-sized colony.  #@NEW_LINE#@#  Let  =  = 1, k1 = 2 and k2 = 3.  #@NEW_LINE#@#  We will vary the level of available resources, C, in order to determine the Case of solution corresponding to it.  #@NEW_LINE#@#  First of all, assume that all trade-off relationships have the form of inequalities.  #@NEW_LINE#@#  For all values of C that are larger than C1 (C1  36.055), Case 1' takes place, so all cells are unspecialized.  #@NEW_LINE#@#  For all values of C that are smaller than C1 and larger than C2 (C2  18.3), Case 3' takes place.  #@NEW_LINE#@#  Here, the solution of the problem is a single point.  #@NEW_LINE#@#  Moreover, for all values of C that are smaller than C3 (C3  30.3) and larger than C2, the optimal strategy implies that the second cell specializes in reproductive function.  #@NEW_LINE#@#  For all values of C that are slightly larger than C2, the optimal strategy implies that b3*  b3max, i.e., we can say that at the optimum, cells 2 and 3 should specialize in reproductive function, while cell 1 remains unspecialized.  #@NEW_LINE#@#  For all positive values of C that are smaller than C2, Case 2' takes place and the solution represents a set of states.  #@NEW_LINE#@#  Furthermore, the decrease in the value of C directs the colony to unspecialized states.  #@NEW_LINE#@#  Thus, this example confirms that Case 3' takes place in environments of intermediate quality, Case 1' in environments of good quality and Case 2' in environments of bad quality when trade-offs are represented by inequalities.  #@NEW_LINE#@#  Now we replace now inequalities by equalities in trade-offs.  #@NEW_LINE#@#  Following our theory, for all values of C that are larger than C1, Case 1 takes place and for all values of C that are smaller than C1 and larger than C2, Case 3 takes place.  #@NEW_LINE#@#  Moreover, for these values of C, the solution does not change.  #@NEW_LINE#@#  However, for the values of C that are smaller than C2, some changes occur.  #@NEW_LINE#@#  Precisely, for all values of C that are smaller than C2 and larger than C4 (C4  16.5), Case 2 with unspecialized optimal states takes place, but for all values of C that are smaller than C4 and larger than C5 (C5  9.9), Case 3 occurs again.  #@NEW_LINE#@#  In the latter situation, cells 1 and 3 specialize in germ, while cell 2 remains unspecialized.  #@NEW_LINE#@#  For all values of C that are smaller than C5, Case 0 takes place.  #@NEW_LINE#@#  It means that the amount of resources available to the colony is smaller than the amount of resources sufficient for the colonys existence.  #@NEW_LINE#@#  
In this example, considering trade-offs in the form of inequalities, specialization occurs when the resource constraint influences the colonys well-being, but the amount of available resources is rather high.  #@NEW_LINE#@#  For trade-offs in the form of equalities, specialization occurs when the resource constraint influences the colonys well-being, whereas the amount of available resources can be rather high or rather small, but sufficient for the colonys survival.  #@NEW_LINE#@#  This case arises because the resource constraint prohibits the second cell from being specialized in germ.  #@NEW_LINE#@#  Thus, the second cell remains unspecialized.  #@NEW_LINE#@#  Moreover, in this example fecundity is cheaper than viability.  #@NEW_LINE#@#  Consequently, the first and the third cells should be specialized in germ.  #@NEW_LINE#@#  If we replace trade-offs in the form of equalities by those in the form of inequalities, each cell would have the opportunity to reduce its viability when its fecundity is fixed.  #@NEW_LINE#@#  Thus, in this case, the colony will be able to choose strategies that yield better fitness, and the unspecialized strategy becomes optimal.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
We have presented and analyzed a new general mathematical model for studying the emergence of germ-soma specialization.  #@NEW_LINE#@#  We have examined how the division of labor in a cell colony depends on the shape of trade-off functions, a resource constraint and different fecundity and viability rates.  #@NEW_LINE#@#  Thus, here we have generalized the popular fitness model introduced by Michod et al.  #@NEW_LINE#@#  [14].  #@NEW_LINE#@#  We have described the set of all possible solutions of the formulated mathematical programming problem and have depicted some interesting examples of optimal solutions found using our fitness function.  #@NEW_LINE#@#  We have shown that the changes in structural complexity in unspecialized large-sized colonies can lead to the emergence of specialization as well as to unspecialized optimal states in the case of environmental quality degradation (i.e., the lack of available environmental resources).  #@NEW_LINE#@#  This means that the process of functional specialization of Volvocalean green algae (GSGS/S) can be explained not only in terms of increasing the colony size [15].  #@NEW_LINE#@#  Moreover, we argue that significant resource restrictions and a trade-off between the production difficulties and the fitness benefits of fecundity can cause the emergence of specialization in small-sized colonies.  #@NEW_LINE#@#  We have also considered the case of different trade-off functions for different cells of the colony.  #@NEW_LINE#@#  Thus, we have assumed that some cells of the colony may not be equivalent with respect to viability or fecundity.  #@NEW_LINE#@#  We have explored several factors that can lead to the emergence of this non-equivalence, such as mutations, a specific developmental program, and positional effects.  #@NEW_LINE#@#  We have shown that positional effects and mutations in small-sized colonies can lead to the emergence of soma specialization without changes in size or in resource restrictions.  #@NEW_LINE#@#  
To conclude, we have described some cases in which the colony specialization can emerge.  #@NEW_LINE#@#  The existence of these cases is supported by a variety of experimental work [13], [26] and [27], but it would be certainly reasonable to provide more detailed quantitative analysis for testing the predictions of our models.  #@NEW_LINE#@#  Thus, it would be interesting to test our model in practice.  #@NEW_LINE#@#  One possible test of our model is to evolve Volvocalean green algae (small-sized and large-sized colonies) under different resource constraints and environmental conditions.  #@NEW_LINE#@#  Moreover, in this kind of experiment we should keep in mind that the generation time, or the time for growth, can change during the evolutionary process, and take it into account in the model.  #@NEW_LINE#@#  It is worth noting that different positional effects can occur during the experiment.  #@NEW_LINE#@#  Consequently, we should divide cells into different relevant groups.  #@NEW_LINE#@#  Such a division will allow testing the model with different types of cells.  #@NEW_LINE#@#  
Another interesting issue is the model's specification.  #@NEW_LINE#@#  In particular, this issue concerns the form of trade-off relationships.  #@NEW_LINE#@#  We have considered two versions of our model: with trade-offs of the form vi = i(bi) and those of the form vi  i (bi).  #@NEW_LINE#@#  In the previous section, we have described all possible situations where the solutions of the related problems have the same structure, or even coincide, as well as where they have different structures.  #@NEW_LINE#@#  We have discussed different specialization effects that can take place in different instances of our model.  #@NEW_LINE#@#  Clearly, focusing on a specific type of organisms would allow a better understanding of the true specialization effects and, consequently, would indicate the best way of modeling the trade-off constraints.  #@NEW_LINE#@#  Moreover, it is worth noting that clarifying the best way of modeling the environmental impact is an essential issue as well.  #@NEW_LINE#@#  Here, we have considered the resource constraint of the form (5).  #@NEW_LINE#@#  However, some questions concerning the parameters of this constraint remain open.  #@NEW_LINE#@#  For example, should the cost, in terms of resources necessary to produce a unit of fecundity or a unit of viability, depend on the size of the colony, i.e., should the parameters k1 and k2 be functions of N?  #@NEW_LINE#@#  Or, should the cost, in terms of resources necessary to produce a unit of fecundity, be the same when this fecundity is produced by a single germ cell or two generalist cells, i.e., should the parameter k1 be a function of B and V?  #@NEW_LINE#@#  Or, should the quantity of resources necessary to produce a unit of viability depend on positional effects, i.e., should the parameter k2 be a function of the variables v1,..,vN?  #@NEW_LINE#@#  There are also some interesting questions concerning the best way of modeling the effect of a limiting environment.  #@NEW_LINE#@#  For example, instead of the resource constraint of the form (5), one could consider a parameterized family of trade-off functions, such that vi = i(bi,C) (see for example [14] or [32]).  #@NEW_LINE#@#  Such a model would be different from that described in our paper, though possibly, some equivalence between the two models could be found at some optimal states.  #@NEW_LINE#@#  One important advantage of the resource constraint of the form (5) is that all parameters of this constraint can be measured directly.  #@NEW_LINE#@#  In the case of a parameterized family, vi = i(bi,C), the parameter estimation process seems to be much more complicated.  #@NEW_LINE#@#  
Another important issue is the robustness of our model.  #@NEW_LINE#@#  On one hand, our model is robust because its qualitative results do not depend on the specific form of trade-off functions.  #@NEW_LINE#@#  They depend only on the curvature of these functions (i.e., convex, linear or concave), which is determined by the size of the colony.  #@NEW_LINE#@#  On the other hand, we have mentioned that the assumption of additivity is rather questionable for the viability function.  #@NEW_LINE#@#  We have shown that in many instances of our model the property of additivity is not necessary for the viability functions.  #@NEW_LINE#@#  However, some of our results are based on the additivity assumption.  #@NEW_LINE#@#  It would be interesting to investigate how these results would change in the case of a non-additive form of the viability function.  #@NEW_LINE#@#  For example in this work, as well as in the studies of Michod et al.  #@NEW_LINE#@#  and Solari et al.  #@NEW_LINE#@#  [1415], it is assumed that all cells of the colony have trade-offs with the same type of curvature.  #@NEW_LINE#@#  It would be also interesting to analyze the case where some cells of the colony have convex trade-offs and the other have concave trade-offs.  #@NEW_LINE#@#  According to a recent study of Leslie et al.  #@NEW_LINE#@#  [33], it is natural to assume that such a case can occur in an intermediate-sized colony in which we have cell generation times such that the colony's trade-off functions are linear, on average, but due to within-colony variation some of them can be slightly convex or concave.  #@NEW_LINE#@#  Moreover, some cells can have neither convex nor concave trade-off functions that correspond to intermediate initial costs of reproduction [14].  #@NEW_LINE#@#  It is clear that in such a situation Case 2 described here does not change, but the analysis of Cases 1 and 3 becomes more complicated because some additional parameters, including the numbers of convex and concave cells in the colony, will be added to the model.  #@NEW_LINE#@#  An extensive additional analysis would be required to find optimal specialization patterns in these instances.  #@NEW_LINE#@#  If both convex and concave trade-offs are allowed in the model, Case 1 of this model should represent a kind of average between Case 1 in the strictly convex and Case 1 in the strictly concave trade-off models in terms of the number of specialized cells in the colony.  #@NEW_LINE#@#  Also, we can anticipate that the general principle of finding solutions in Case 3 with concave and linear trade-offs would not change here: the optimal reproductive strategies would be the available strategies from the resource surface such that they have the same total fecundity and the value of this total fecundity is the closest one (among all available strategies from the resource surface) to the unavailable total fecundity calculated according to Eq (7).  #@NEW_LINE#@#  Nevertheless, the detailed structure and the geometry of these solutions seem to be much more diverse and complex than the solution structure of Case 3 presented in this paper.  #@NEW_LINE#@#  
Another challenging question is the investigation of the role of positional effects in our model.  #@NEW_LINE#@#  We can incorporate into the model the information about the form of the colony (e.g., sphere or line) and consider the impact of positional effects in each case.  #@NEW_LINE#@#  Such a development will enable us to gain more insight into the structure and properties of trade-off functions.  #@NEW_LINE#@#  
It is worth noting that the proposed model can be generalized to address a number of relevant biological issues, including the evolution of specialized enzymes or the emergence of complex organs.  #@NEW_LINE#@#  Importantly, the presented fitness model is of a general nature and could be also applied to address a number of parallel issues in different fields, such as economics, where fitness could be associated with the production volume, or education, where fitness could be associated with the effectiveness of the process of education, or health care, where fitness could be associated with life expectancy or life quality.  #@NEW_LINE#@#  

Supporting_information  #@NEW_LINE#@#  
S1_Appendix_The_proofs_of_main_results  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pone.0201446.s001  #@NEW_LINE#@#  
(DOCX)  #@NEW_LINE#@#  


Acknowledgments  #@NEW_LINE#@#  
The authors thank two anonymous reviewers and Dr Sergey Gavrilets for helpful comments and suggestions.  #@NEW_LINE#@#  

References  #@NEW_LINE#@#  



