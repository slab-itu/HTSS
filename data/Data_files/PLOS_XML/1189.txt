article id="http://dx.doi.org/10.1371/journal.pcbi.1005341"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Scalable Design of Paired CRISPR Guide RNAs for Genomic Deletion  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
CRISPR-Cas9 technology can be used to engineer precise genomic deletions with pairs of single guide RNAs (sgRNAs).  #@NEW_LINE#@#  This approach has been widely adopted for diverse applications, from disease modelling of individual loci, to parallelized loss-of-function screens of thousands of regulatory elements.  #@NEW_LINE#@#  However, no solution has been presented for the unique bioinformatic design requirements of CRISPR deletion.  #@NEW_LINE#@#  We here present CRISPETa, a pipeline for flexible and scalable paired sgRNA design based on an empirical scoring model.  #@NEW_LINE#@#  Multiple sgRNA pairs are returned for each target, and any number of targets can be analyzed in parallel, making CRISPETa equally useful for focussed or high-throughput studies.  #@NEW_LINE#@#  Fast run-times are achieved using a pre-computed off-target database.  #@NEW_LINE#@#  sgRNA pair designs are output in a convenient format for visualisation and oligonucleotide ordering.  #@NEW_LINE#@#  We present pre-designed, high-coverage library designs for entire classes of protein-coding and non-coding elements in human, mouse, zebrafish, Drosophila melanogaster and Caenorhabditis elegans.  #@NEW_LINE#@#  In human cells, we reproducibly observe deletion efficiencies of 50% for CRISPETa designs targeting an enhancer and exonic fragment of the MALAT1 oncogene.  #@NEW_LINE#@#  In the latter case, deletion results in production of desired, truncated RNA.  #@NEW_LINE#@#  CRISPETa will be useful for researchers seeking to harness CRISPR for targeted genomic deletion, in a variety of model organisms, from single-target to high-throughput scales.  #@NEW_LINE#@#  

Author_Summary  #@NEW_LINE#@#  
CRISPR-Cas9 is a revolutionary biological technique for precisely editing cells genomes.  #@NEW_LINE#@#  Amongst its many capabilities is the deletion of defined regions of DNA, creating a wide range of applications from modelling rare human diseases, to performing very large knock-out screens of candidate regulatory DNA.  #@NEW_LINE#@#  CRISPR-Cas9 requires researchers to design small RNA molecules called sgRNAs to target their region of interest.  #@NEW_LINE#@#  A large number of bioinformatic tools exist for this task.  #@NEW_LINE#@#  However, CRISPR deletion requires the design of optimised pairs of such RNA molecules.  #@NEW_LINE#@#  This manuscript describes the first pipeline designed to accomplish this, called CRISPETa, with a range of useful features.  #@NEW_LINE#@#  We use CRISPETa to design comprehensive libraries of paired sgRNA for many thousands of target regions that may be used by the scientific community.  #@NEW_LINE#@#  Using CRISPETa designs in human cells, we show that predicted pairs of sgRNAs produce the expected deletions at high efficiency.  #@NEW_LINE#@#  Finally, we show that these deletions of genomic DNA give rise to correspondingly truncated RNA molecules, supporting the power of this technology to create cells with precisely deleted DNA.  #@NEW_LINE#@#  

Citation: Pulido-Quetglas C, Aparicio-Prat E, Arnan C, Polidori T, Hermoso T, Palumbo E, et al.  #@NEW_LINE#@#  (2017) Scalable Design of Paired CRISPR Guide RNAs for Genomic Deletion.  #@NEW_LINE#@#  PLoS Comput Biol 13(3):  #@NEW_LINE#@#  
           e1005341.  #@NEW_LINE#@#  

        https://doi.org/10.1371/journal.pcbi.1005341  #@NEW_LINE#@#  
Editor: Ilya Ioshikhes, Ottawa University, CANADA  #@NEW_LINE#@#  
Received: August 2, 2016; Accepted: December 30, 2016; Published:  March 2, 2017  #@NEW_LINE#@#  
Copyright:  © 2017 Pulido-Quetglas et al.  #@NEW_LINE#@#  This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.  #@NEW_LINE#@#  
Data Availability: All files are available from crispeta.crg.eu.  #@NEW_LINE#@#  
Funding: This work was financially supported by the following grants: CSD2007-00050 from the Spanish Ministry of Science (http://www.mineco.gob.es/portal/site/mineco/idi), grant SGR-1430 from the Catalan Government (http://web.gencat.cat/ca/temes/tecnologia/), grant ERC-2011-AdG-294653-RNA-MAPS from the European Community financial support under the FP7 (https://erc.europa.eu/) and grant R01MH101814 by the National Human Genome Research Institute of the National Institutes of Health (https://www.genome.gov/), to RG.  #@NEW_LINE#@#  Ramón y Cajal RYC-2011-08851 and Plan Nacional BIO2011-27220, both from the Spanish Ministry of Science (http://www.mineco.gob.es/portal/site/mineco/idi), to RJ.  #@NEW_LINE#@#  We also acknowledge support of the Spanish Ministry of Economy and Competitiveness, Centro de Excelencia Severo Ochoa 2013-2017, SEV-2012-0208 (http://www.mineco.gob.es/portal/site/mineco/idi).  #@NEW_LINE#@#  We also acknowledge the support of the CERCA Programme / Generalitat de Catalunya (http://web.gencat.cat/ca/temes/tecnologia/).  #@NEW_LINE#@#  This research was partly supported by the NCCR RNA & Disease funded by the Swiss National Science Foundation (http://www.nccr-rna-and-disease.ch/).  #@NEW_LINE#@#  The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  
Competing interests:  The authors have declared that no competing interests exist.  #@NEW_LINE#@#  
Introduction  #@NEW_LINE#@#  
CRISPR/Cas9 is a simple and versatile method for genome editing that can be applied to deleting virtually any genomic region for loss-of-function studies.  #@NEW_LINE#@#  Deletion requires the design of optimal pairs of single guide RNA (sgRNA) molecules that hybridise to sequences flanking the target region.  #@NEW_LINE#@#  While this approach is being employed for diverse applications, from single target studies [13] to high parallelized screening studies [4,5], there presently exists no bioinformatic solution for selection of optimal pairs of sgRNAs.  #@NEW_LINE#@#  We present here a highly customisable design pipeline to address the needs of all such deletion projects, regardless of scale.  #@NEW_LINE#@#  
CRISPR/Cas9 makes it possible to investigate the function of genomic elements in their endogenous genetic context.  #@NEW_LINE#@#  The Cas9 nuclease is recruited to desired genomic sites through its binding to an engineered, single guide RNA (sgRNA) [6].  #@NEW_LINE#@#  Early studies focussed on protein coding genes, utilizing individual sgRNAs to induce small indel mutations in genomic regions encoding target proteins open reading frame (ORFs).  #@NEW_LINE#@#  Such mutations frequently give rise to inactivating frameshift mutations, resulting in complete loss of function [7,8].  #@NEW_LINE#@#  The delivery of a single sgRNA in such experiments is technically straightforward, and can be scaled to genome-wide, virally-delivered screens.  #@NEW_LINE#@#  
CRISPR has also been brought to bear on non-coding genomic elements, including regulatory regions and non-coding RNAs, which have traditionally resisted standard RNA interference (RNAi) [2,9].  #@NEW_LINE#@#  With some exceptions (for example [10]), functional knockout of non-coding elements with a single sgRNA is not practical, because small indel mutations caused by single sgRNAs are less likely to ablate function to the same extent as in a protein-coding sequence.  #@NEW_LINE#@#  Instead, a deletion strategy has been pursued: a pair of sgRNAs are used to recruit Cas9 to sites flanking the target region [2,4].  #@NEW_LINE#@#  Simultaneous strand breaks are induced, and non-homologous end joining (NHEJ) activity repairs the lesion.  #@NEW_LINE#@#  In a certain fraction of cases, this results in a genomic deletion with a well-defined junction [4].  #@NEW_LINE#@#  
Cas9 targeting is achieved by engineering the 5 variable region of the sgRNA.  #@NEW_LINE#@#  This hybridises to a complementary protospacer region in DNA, immediately upstream of the protospacer adjacent motif (PAM) [11].  #@NEW_LINE#@#  For the most commonly-used S. pyogenes Cas9 variant, the PAM sequence consists of NGG.  #@NEW_LINE#@#  A growing number of software tools are available for the selection of optimal individual protospacer targeting sequences [1218].  #@NEW_LINE#@#  The key selection criteria are (1) the efficiency of a given sequence at generating mutations, and (2) off-targeting, or the propensity for recognising similar, yet undesired, sites in the genome.  #@NEW_LINE#@#  Based on experimental data, scoring models for on-target efficiency have been developed, for example that presented by Doench et al [16].  #@NEW_LINE#@#  At the same time, tools have become available for identifying unique sgRNA sites genome-wide, mitigating to some extent the problem of off-targeting [19].  #@NEW_LINE#@#  However, few tools presented so far are designed for large-scale designs, and to the best of our knowledge, none was created to identify optimal sgRNA pairs required for deletion studies.  #@NEW_LINE#@#  
To address this need, we here present a new software pipeline called CRISPETa (CRISPR Paired Excision Tool) that selects optimal sgRNAs for deletion of user-defined target sites.  #@NEW_LINE#@#  The pipeline has several useful features: first, it can be used for any number of targets in a single, rapid analysis; second, it returns multiple, optimal pairs of sgRNAs, with maximal predicted efficiency and minimal off-target activity; third, the user has control over the full range of design parameters.  #@NEW_LINE#@#  The pipeline is available as both standalone software and as a user-friendly webserver.  #@NEW_LINE#@#  In addition, we make available a number of pre-designed deletion libraries for various classes of non-coding genomic elements in a variety of species.  #@NEW_LINE#@#  Finally, using a quantitative deletion assay, we find that CRISPETa predictions are highly efficient in deleting fragments of a human gene locus, resulting in detectable changes to the cellular transcriptome.  #@NEW_LINE#@#  CRISPETa is available at http://crispeta.crg.eu.  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
The_CRISPETa_pipeline_for_paired_sgRNA_design  #@NEW_LINE#@#  
To address the need for bioinformatic design of paired sgRNAs for genomic deletion, we created the CRISPETa pipeline (Fig 1A and 1B).  #@NEW_LINE#@#  The guiding principles of CRISPETa are flexibility and scalability: the user has control over all aspects of the design process if desired (otherwise reasonable defaults are provided), and the design may be carried out on individual targets, or target libraries of essentially unlimited size.  #@NEW_LINE#@#  The full set of user-defined variables, and their default values, are shown in Table 1.  #@NEW_LINE#@#  
The core objective of sgRNA design is the selection of optimal protospacers, defined as the 20 bp of genomic DNA sequence preceding the PAM sequence [11].  #@NEW_LINE#@#  This is distinct from the sgRNA sequence itself, composed of the protospacer sequence and the constant, scaffold region (Fig 1A).  #@NEW_LINE#@#  
The CRISPETa workflow is divided into three main steps: target region definition, protospacer selection, and sgRNA pair prioritisation (Fig 1B).  #@NEW_LINE#@#  Given a genomic target region or regions in BED format, CRISPETa first establishes pairs of design regions of defined length in which to search.  #@NEW_LINE#@#  Design regions may be separated from the target itself by exclude regions of defined length.  #@NEW_LINE#@#  The user may also specify mask regions: sgRNAs falling within the positive mask are prioritised, whereas those within the negative mask will be de-prioritized (although not removed altogether).  #@NEW_LINE#@#  Positive masks might include regions of DNaseI-accessible chromatin, while negative masks may be composed of, for example, repetitive regions or compact chromatin.  #@NEW_LINE#@#  
Using this information, the entire set of potential protospacers is defined.  #@NEW_LINE#@#  First, the design region sequence is extracted and searched for all possible 20mer sites followed by canonical S. pyogenes NGG PAM sitescandidate protospacers.  #@NEW_LINE#@#  These are considered with respect to two core metrics: their potential for off-target binding, and their predicted efficiency.  #@NEW_LINE#@#  Off-targeting, or the number of identical or similar sites with a given number of mismatches, is estimated using precomputed data for each genome.  #@NEW_LINE#@#  This strategy increases the speed of CRISPETa dramatically.  #@NEW_LINE#@#  We created off-target databases for five commonly-studied species, human, mouse, zebrafish, Drosophila melanogaster, Caenorhabditis elegans (Table 2), varying widely in genome size (Fig 2A).  #@NEW_LINE#@#  The default off-targeting cutoff is set at (0:1, 1:0, 2:0, 3:x, 4:x), that is, sequences having no other genomic site with 2 mismatches (in our notation, x represents infinity).  #@NEW_LINE#@#  At this default, 78% of candidate protospacers are discarded in human, compared to just 29% in Drosophila, reflecting the relative uniqueness and compactness of the latter (compare dark blue bars in Fig 2B).  #@NEW_LINE#@#  
To estimate their efficiency in inducing double stranded breaks at their target sites, candidate protospacers are scored using the logistic regression measure of Doench et al[16].  #@NEW_LINE#@#  This model was trained on experimental assays for 6085 and 1151 sgRNAs tiled across six mouse and three human genes, respectively.  #@NEW_LINE#@#  This score predicts sgRNA efficiency based on informative nucleotide preferences both within the core 20mer and in its immediate flanking nucleotides.  #@NEW_LINE#@#  Protospacers passing defined off-target and on-target thresholds are retainedhenceforth referred to as filtered protospacers.  #@NEW_LINE#@#  In contrast to off-target filtering, efficiency score filters are more consistent across genomes, removing 6070% of protospacers in the five genomes tested (light blue bars in Fig 2B, Table 2 and Supplementary S8 File).  #@NEW_LINE#@#  Together, off-target and efficiency score filters eliminate 96% of candidate protospacers in human (Fig 2B), but nevertheless yielding an average density of 6.6 usable protospacers per kilobase (Fig 2A).  #@NEW_LINE#@#  Comparison across species shows that there is markedly lower density of usable filtered protospacer sequences in vertebrates compared to invertebrates (Fig 2A).  #@NEW_LINE#@#  In general, and even after applying off-targets and score filters, the minimum deletion size constrained by sequence features alone is less than 150 bp for the majority of genomic regions (Supplementary S7 File).  #@NEW_LINE#@#  
In the final step, optimal sgRNA pairs are selected.  #@NEW_LINE#@#  First, all possible pairs of filtered protospacers are enumerated and ranked.  #@NEW_LINE#@#  Two ranking approaches are available: by combined efficiency score (default), or by length of deleted region.  #@NEW_LINE#@#  Ranking by score will tend to result in pairs that are more evenly distributed throughout the targeting region, but with a heterogeneous distribution of deletion sizes.  #@NEW_LINE#@#  Conversely, ranking by length favours shorter intervals within the constraints of the targeting design.  #@NEW_LINE#@#  Short segments may be more efficiently deleted [20], but will tend to be clustered into a smaller genomic region.  #@NEW_LINE#@#  
The top-ranked pairs, up to a user-defined maximum of n, are returned for each feature.  #@NEW_LINE#@#  In principle, a single high-scoring sgRNA may end up contributing to many or all of the highest-scoring pairs.  #@NEW_LINE#@#  To control this process, the diversity measure is used to control the maximum fraction of pairs containing a single sgRNA sequence (Table 1).  #@NEW_LINE#@#  
Finally, the user may specify constraints in sgRNA pair selection based on the plasmid construction method.  #@NEW_LINE#@#  Many plasmids employ the U6 promoter, which requires the sgRNA to commence with a G. For instance, the DECKO plasmid expresses two sgRNAs in tandem from U6 and H1 promoters, thus requiring the 5 sgRNA to commence with G [4].  #@NEW_LINE#@#  The construction method variable allows users to incorporate this constraint, specifically by ensuring that the first sgRNA commences with a natural or prepended G.  #@NEW_LINE#@#  
CRISPETa returns a ranked series of paired sgRNA constructs for each target.  #@NEW_LINE#@#  Sequences are output in a format suitable for immediate ordering from commercial oligonucleotide synthesis services.  #@NEW_LINE#@#  Summary statistics and figures are produced for each design job.  #@NEW_LINE#@#  

Controlling_CRISPETa_performance_by_adjusting_parameters  #@NEW_LINE#@#  
We tested the standalone pipeline using a set of 7000 human target genomic features compiled from a mixture of sources (see Materials and Methods).  #@NEW_LINE#@#  At default settings, CRISPETa returns successful, full depth (n = 10) designs for 68% of features, with a further 18% of partial depth (0less_thannless_than10) and 14% failures (default in Fig 2C, Table 3).  #@NEW_LINE#@#  We here define full depth to indicate the situation where all of n requested sgRNA pairs are successfully returned, and partial depth when the returned number is less than n. Performed on a workstation running CentOS6, 86.6 Gb of memory and 12 CPUs (Intel(R) Xeon(R) CPU E5649 @ 2.53GHz), the analysis took 44 minutes with a maximum RAM requirement of less_than100 MB.  #@NEW_LINE#@#  
This benchmarking was repeated several times, in each case modifying a single parameter (Fig 2C and Table 3).  #@NEW_LINE#@#  As expected, strengthening the diversity requirement resulted in a drastic reduction of design success (diversity0), while a complete relaxation (diversity1) did not produce a substantial gain.  #@NEW_LINE#@#  Some improvement was observed when relaxing off-targeting, but this benefit is negligible after off1 (allowing a single other match with two mismatches, (0:1, 1:0, 2:1, 3:x, 4:x).  #@NEW_LINE#@#  As expected, increasing the paired score threshold has a strong effect on design depth, particularly after 0.6 (pScore0.6) (the default is 0.4).  #@NEW_LINE#@#  The most dramatic improvement was observed when the length of the design region was increased to 2000 bp, boosting the fraction of successfully targeted regions from 70% to 95%.  #@NEW_LINE#@#  Thus, by adjusting these parameters, the depth of library designs can be optimised for each target set.  #@NEW_LINE#@#  

Genome-scale_deletion_libraries_for_protein-coding_and_non-coding_genomic_elements_in_five_species  #@NEW_LINE#@#  
We next used CRISPETa to design knockout libraries for a variety of genomic element classes that cannot be targeted by traditional RNAi, either because their function is not thought to depend on RNA production (eg ultraconserved elements [UCEs])[21], or because their RNA product is too short (eg microRNAs) (see Table 4).  #@NEW_LINE#@#  We also created a collection of 3170 random intergenic target regions in human as a reference and for use as negative controls in screening projects.  #@NEW_LINE#@#  An example is shown in Fig 3A, created using the standard output of CRISPETa, where the IRX3 gene promoter and an upstream ultraconserved element (UCE) were targeted.  #@NEW_LINE#@#  
The characteristics of these libraries are shown in Fig 3B and 3C and Table 4.  #@NEW_LINE#@#  Overall, 68% of features could be targeted at full depth, with an additional 18% at incomplete depth.  #@NEW_LINE#@#  We observe considerable heterogeneity in the design success across classes, with protein-coding gene promoters reaching a full depth for 82% of cases, compared to 39% in random intergenic regions.  #@NEW_LINE#@#  We expect these differences arise from the formers high sequence uniqueness (decreasing off-target frequency) and high GC-content (increasing PAM density and predicted efficiency).  #@NEW_LINE#@#  
To compare performance across species, we created designs targeting the entire annotated catalogue of microRNA genes in human, mouse, zebrafish, D. melanogaster and C. elegans (Fig 3C).  #@NEW_LINE#@#  We observe considerably more efficient designs in non-mammalian species, likely reflecting their more compact, less repetitive nature.  #@NEW_LINE#@#  Nevertheless, at default settings we managed to create full or partial depth designs for 82% of human miRNA precursors, and this could likely be improved by altering design parameters.  #@NEW_LINE#@#  
The entire set of designs are available for download from crispeta.crg.eu.  #@NEW_LINE#@#  Overall these results demonstrate the practicality of creating large-scale paired sgRNA knockout designs across diverse genomic element classes.  #@NEW_LINE#@#  

CRISPETa_designs_efficiently_delete_targets_in_human_cells  #@NEW_LINE#@#  
We next evaluated the performance of CRISPETa designs in an experimental setting.  #@NEW_LINE#@#  As an model, we focussed on the MALAT1 locus, which expresses a potent oncogenic mono-exonic lncRNA [22].  #@NEW_LINE#@#  In previous work, we managed to delete the MALAT1 promoter using pairs of sgRNAs delivered by a lentiviral vector, pDECKO [4,22].  #@NEW_LINE#@#  We have created an updated version, pDECKO_mCherry (hereafter referred to as pDECKO for brevity), carrying both antibiotic and fluorescence markers, into which designed sgRNA sequences can be rapidly cloned and expressed from independent promoters (Fig 4A).  #@NEW_LINE#@#  We also developed a streamlined protocol for cloning these vectors, DECKO2, described in detail in Supplementary S1 File.  #@NEW_LINE#@#  
We selected two target regions: a conserved upstream element with enhancer-like chromatin modifications (enhancer) and a region of conserved exonic sequence (exon) (Fig 4C).  #@NEW_LINE#@#  Each was submitted to CRISPETa, and from the resulting sgRNA designs we selected the three highest scoring pairs and one lower scoring pair (details can be found in Supplementary S5 File).  #@NEW_LINE#@#  HEK293T cells, stably expressing Cas9-BFP, were transfected with pDECKO, and selected by antibiotic resistance for 6 days, after which their genomic DNA (gDNA) was extracted (Fig 4D).  #@NEW_LINE#@#  
In order to observe genomic deletion, we used two distinct PCR-based methodologies.  #@NEW_LINE#@#  The first, non-quantitative approach allows one to verify the correct size of deleted regions using primers flanking the target region (Fig 4E, left panels).  #@NEW_LINE#@#  We used this conventional approach to genotype MALAT1 deletions in a previous study [4].  #@NEW_LINE#@#  The second approach, which we call quantitative CRISPR PCR (QC-PCR), allows one to estimate the deletion efficiency, in terms of percent of wild-type (uncut) alleles remaining in a cellular population (Fig 4B and 4E, right panels).  #@NEW_LINE#@#  In tests using mixtures of wild type and deleted alleles, QC-PCR could accurately estimate known concentrations (Supplementary S6 File).  #@NEW_LINE#@#  The primer configurations used by both approaches are shown as black arrowheads in Fig 4C and 4E.  #@NEW_LINE#@#  
We used both conventional genotyping and QC-PCR to investigate target region deletion in gDNA of transfected HEK293T cells (Fig 4D).  #@NEW_LINE#@#  Conventional PCR genotyping, using out-out primers, yielded amplification product sizes consistent with target site deletion for all pDECKO constructs, but not for control cells (Fig 4E, left panels).  #@NEW_LINE#@#  QC-PCR analysis, using in-out primers, of independent biological replicates showed loss of ~40% of enhancer target sites for each of the four sgRNA pair designs targeting the enhancer region (Fig 4E, top right).  #@NEW_LINE#@#  A non-targeted genomic region was not affected (Non-targeted).  #@NEW_LINE#@#  Higher efficiencies were observed for the exon-targeting constructs, yielding 60% efficiency for the top two sgRNA pairs (Fig 4E, bottom right).  #@NEW_LINE#@#  We did not observe a strong difference in the deletion efficiency between the four sgRNA pairs targeting the enhancer, although for the exon region, the lower-scoring two constructs displayed reduced efficiency.  #@NEW_LINE#@#  This underlines the value of using predicted efficiency scores in sgRNA selection, and supports the effectiveness of CRISPETa-predicted sgRNA pairs.  #@NEW_LINE#@#  

Genomic_deletion_results_in_mutant_RNA_production  #@NEW_LINE#@#  
We next sought to verify that the engineered deletions in the MALAT1 exon result in the expected changes to transcribed RNA.  #@NEW_LINE#@#  cDNA was generated from bulk cells treated with pDECKO vectors targeting MALAT1 exon.  #@NEW_LINE#@#  Given that not all cells have both alleles deleted, this sample should contain a mixture of RNA from both wild-type and mutated alleles.  #@NEW_LINE#@#  RT-PCR using primers flanking the targeted region amplified two distinct products, of sizes expected for wild-type and deleted sequence (Fig 5A).  #@NEW_LINE#@#  TA cloning and Sanger sequencing of individual cDNA clones revealed a variety of deletion sites around the expected position within the MALAT1 exon (Fig 5B).  #@NEW_LINE#@#  Therefore, targeted deletions by CRISPETa are reproduced in the transcriptome, and may be used in future dissect RNA functional elements.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
We have here presented a versatile and scalable design solution for CRISPR deletion projects.  #@NEW_LINE#@#  To our knowledge, CRISPETa is the first tool for selection of optimal sgRNA pairs.  #@NEW_LINE#@#  A key feature is its scalability, making it equally suitable for focussed projects involving single target regions, and screening projects involving thousands of targets.  #@NEW_LINE#@#  The user has a large degree of control over the design process, enabling projects to be optimised for target regions with diverse sequence uniqueness and GC content.  #@NEW_LINE#@#  On-target efficiency is predicted using the latest, experimentally-informed design algorithm, while running speed is boosted by an efficient off-target calculation.  #@NEW_LINE#@#  
A growing number of laboratories are adopting CRISPR deletion in their research for diverse applications, including modelling of human genetic disease [1], functional dissection of enhancer elements [3] or insulators [23], or loss-of-function studies on small or long noncoding RNAs [2].  #@NEW_LINE#@#  In each case, it was necessary to manually design pairs of sgRNAs using available, single sgRNA design tools.  #@NEW_LINE#@#  There is clearly ample space to streamline this process.  #@NEW_LINE#@#  The second main application for CRISPR-deletion is for high-throughput loss-of-function screening studies, through the cloning of complex, pooled targeting libraries.  #@NEW_LINE#@#  These have enormous potential for the systematic identification of functional, non-coding genomic elements for the first time [3].  #@NEW_LINE#@#  Manual design of paired sgRNAs for such projects is clearly out of the question.  #@NEW_LINE#@#  CRISPETa has been designed with both types of project in mind.  #@NEW_LINE#@#  
The QC-PCR technique presented here now allows one to quantify and compare the efficiency of CRISPETa designs.  #@NEW_LINE#@#  For the 8 sgRNA pairs in two regions that we tested, deletion efficiencies of ~4060% were consistently observed.  #@NEW_LINE#@#  Given that DECKO gives rise to an approximately equal mixture of heterozygous and homozygous mutants [4], this would imply that over half of the cells in the mixture are being mutated.  #@NEW_LINE#@#  The induced deletions, when occurring within a transcribed region, are also observed in expressed RNA molecules.  #@NEW_LINE#@#  This is, to our knowledge, the first demonstration of the production of truncated RNA from an edited locus.  #@NEW_LINE#@#  
It should be noted that our understanding of on- and off-target sgRNA efficiencies is evolving rapidly.  #@NEW_LINE#@#  The Doench score used here is trained on a limited number of protein-coding genes, and it is likely that its scoring algorithm will be further refined in the near future.  #@NEW_LINE#@#  We plan to incorporate such improvements into CRISPETa as they become available.  #@NEW_LINE#@#  Users who wish to omit the on-target filter, may simply set the on-target score thresholds to zero.  #@NEW_LINE#@#  Similarly, to remove off-target filters, users may set all mismatch settings to infinity.  #@NEW_LINE#@#  
CRISPR enables us to study the function of non-coding genomic elements in their endogenous cellular context for the first time.  #@NEW_LINE#@#  The power of CRISPR-Cas9 genome-engineering lies both in its versatility, but also in its ready adaptation to large-scale screening approaches.  #@NEW_LINE#@#  The CRISPETa pipeline and experimental methods described here will, we hope, be useful for such studies.  #@NEW_LINE#@#  

Materials_and_Methods  #@NEW_LINE#@#  
Details_of_CRISPETa_code  #@NEW_LINE#@#  
The pipeline is outlined in Fig 1A.  #@NEW_LINE#@#  As input, CRISPETa requires a standard BED6-format file describing one or more target regions of the supported genomes.  #@NEW_LINE#@#  Presently these are hg19 (human), mm10 (mouse), danRer10 (zebrafish), dm6 (Drosophila), ce11 (C. elegans).  #@NEW_LINE#@#  The webserver also directly accepts input as sequence, in FASTA format.  #@NEW_LINE#@#  Unstranded entries are assigned to the + strand, while those without identifiers are assigned a random ID.  #@NEW_LINE#@#  CRISPETa first defines design regions based on parameters g/du/dd/eu/ed (see Table 1 for full list of parameters) (Fig 1A and 1B), and extracts their sequences using the BEDtools getfasta function.  #@NEW_LINE#@#  Design regions are searched for canonical PAM elements (NGG) using a regular expression.  #@NEW_LINE#@#  For every such PAM, a total of 30 nucleotides (NNNN[20nt]NGGNNN) are stored.  #@NEW_LINE#@#  Protospacers containing the RNA Pol III stop sequence (TTTTT) are removed.  #@NEW_LINE#@#  
Next, candidate protospacers are searched against a precomputed, database-stored list of potential protospacers and their number of similar sequences with up to 4 mismatches, genome-wide (see Off-target analysis section, below).  #@NEW_LINE#@#  Matches (2 mismatches) to non-canonical (NAG) protospacers in any annotated protein-coding region are excluded from all analyses.  #@NEW_LINE#@#  By default, protospacers with one or more off-targets with 2 mismatch are discarded (this cutoff can be modified by the user through parameter t).  #@NEW_LINE#@#  Remaining protospacers are then compared with the positive and negative mask BED files using BEDtools intersectBed.  #@NEW_LINE#@#  Candidate sequences not fully overlapping the positive mask file, or overlapping the negative mask by one basepair, are tagged as disfavoured.  #@NEW_LINE#@#  Next, 30mer regions encompassing remaining protospacers, including disfavoured ones, are assigned an efficiency score (see below) between 0 and 1, and those above the score threshold (controlled by parameter si) are carried forward.  #@NEW_LINE#@#  
Next, candidate sequences are assembled into pairs and filtered.  #@NEW_LINE#@#  For each target region, all possible pairs of upstream and downstream candidates are generated.  #@NEW_LINE#@#  If pairs are designed for DECKO cloning (which utilizes the U6 promoter for the 5 sgRNA gene, controlled by c), an additional step is applied: sgRNA pairs, where one of the pairs commences with G, are reordered as necessary such that the first sgRNA starts with G; for pairs where neither commences with G, an additional G is prepended to the first sgRNA[24].  #@NEW_LINE#@#  It should be noted that this DECKO construction mode thus results in oligonucleotide libraries that vary in length by one nucleotide.  #@NEW_LINE#@#  A combined score for the resulting pairs is computed.  #@NEW_LINE#@#  By default, this is the sum of the two individual sgRNA scores, but users may choose to define the pair score as the product of individual scores (parameter sc).  #@NEW_LINE#@#  Pairs are now filtered with a pair score threshold, and ranked first by mask score and then by pair score (or, optionally, reverse ranked by distance, using parameter r).  #@NEW_LINE#@#  An optional diversity cutoff can be used to remove pairs such that no individual candidate sequence appears in more than a given fraction of returned pairs (parameter v).  #@NEW_LINE#@#  Finally the program returns the top ranked pairs up to the maximum number specified by the user, n.  #@NEW_LINE#@#  
CRISPETa is implemented in Python and available for download from git-hub and the CRISPETa web-server (see availability below).  #@NEW_LINE#@#  

Target_features_and_mask_files  #@NEW_LINE#@#  
All target sets and mask files were prepared in BED format, and obtained in April 2016.  #@NEW_LINE#@#  Coding genes were obtained from the Gencode v19 annotation, filtered for the protein_coding biotype [25].  #@NEW_LINE#@#  CTCF binding sites for GM12878 cells were downloaded from ENCODE data hosted in the UCSC Browser [26].  #@NEW_LINE#@#  Enhancers were obtained from Vista [27].  #@NEW_LINE#@#  Pre-miRNAs were obtained from miRBASE [28].  #@NEW_LINE#@#  Disease-associated SNPs were obtained from the GWAS database (http://www.ebi.ac.uk/gwas/api/search/downloads/full).  #@NEW_LINE#@#  Ultraconserved regions were obtained from UCNEbase [21].  #@NEW_LINE#@#  For human positive and negative masks we used DNaseI hypersensitive sites identified through genome-wide profiling in 125 diverse cell and tissue types by the ENCODE consortium [29] and RepeatMasker repetitive regions [30], respectively.  #@NEW_LINE#@#  To generate random intergenic locations, the entire span of all Gencode v19 genes (both coding and noncoding, introns and exons), in addition to 100 kb up- and downstream, were subtracted.  #@NEW_LINE#@#  Random locations were selected within the remaining regions.  #@NEW_LINE#@#  

Off-target_analysis  #@NEW_LINE#@#  
Off-target analysis was performed using Crispr-Analyser [19].  #@NEW_LINE#@#  We searched for all canonical PAM regions (NGG) in the genome and stored the 20nt that precedes each.  #@NEW_LINE#@#  Then using search and align options we obtained the number of off-targets with 0,1,2,3 and 4 mismatches for each unique 20mer.  #@NEW_LINE#@#  A second step was performed to remove protospacers with potential off-targeting in coding regions: for each genome, all 20mers followed by NGG were mapped using BWA mapper against sequences of 20nt followed either by NGG or NAG in all annotated protein-coding regions [31].  #@NEW_LINE#@#  Those 20mers having alignments with 2 mismatches were removed in order to avoid potential off-targets in coding regions.  #@NEW_LINE#@#  Filtered 20mers were stored in a MySQL database.  #@NEW_LINE#@#  Precomputed files containing this information for various genomes can be directly downloaded (see CRISPETa availability section).  #@NEW_LINE#@#  Downloadable files contain 6 comma-separated fields in this order: sequence of the sgRNA without the PAM sequence and the number of off-targets with 0,1,2,3, and 4 mismatches for this sgRNA.  #@NEW_LINE#@#  These files can be used as input for CRISPETa-MySQL module to generate the MySQL database.  #@NEW_LINE#@#  

sgRNA_scoring_algorithm  #@NEW_LINE#@#  
CRISPETa uses the scoring method developed by Doench et al [16], based on an experimentally trained logistic regression model employing 72 sequence features.  #@NEW_LINE#@#  The code was downloaded from http://www.broadinstitute.org/rnai/public/analysis-tools/sgrna-design-v1.  #@NEW_LINE#@#  

Benchmarking  #@NEW_LINE#@#  
A test target set was assembled from 1000 randomly-selected elements from each of the individual target annotations, for a total of 7000.  #@NEW_LINE#@#  Benchmarking analyses were run on a workstation running CentOS6, 86.6 Gb of memory and 12 CPUs (Intel(R) Xeon(R) CPU E5649 @ 2.53GHz).  #@NEW_LINE#@#  

CRISPETa_availability_and_webserver  #@NEW_LINE#@#  
CRISPETa can be run through the web-server (http://crispeta.crg.eu) or locally.  #@NEW_LINE#@#  The software runs on python2.7.  #@NEW_LINE#@#  In order to run CRISPETa locally two additional programs are required: BEDtools and MySQL.  #@NEW_LINE#@#  Source code to run locally can be found at git-hub (https://github.com/guigolab/CRISPETA) and also at the Get CRISPETa section of the web-server.  #@NEW_LINE#@#  Source code consist of two scripts: CRISPETA.py that execute the main pipeline described above, and crispeta_mysql.py that helps users to create the off-target MySQL database.  #@NEW_LINE#@#  Two other files can be found within the source code: func.py that contains all functions necessary to execute the two main scrips, and config.py that stores the information needed to login to MySQL.  #@NEW_LINE#@#  

Molecular_cloning_of_pDECKO_paired_sgRNA_vector  #@NEW_LINE#@#  
We used a modified version of our previously-described protocol for the creation of pDECKO_mCherry vectors expressing pairs of sgRNAs, DECKO2 [4].  #@NEW_LINE#@#  A detailed protocol is available in Supplementary S1 File, as well as on CRISPETa webpage.  #@NEW_LINE#@#  Selected sgRNA pairs were converted to overlapping series of 6 oligonucleotides using a custom design spreadsheet (available as Supplementary S2 File).  #@NEW_LINE#@#  All described plasmids are available from Addgene.org under plasmid numbers 7853478545.  #@NEW_LINE#@#  

QC-PCR_assay  #@NEW_LINE#@#  
gDNA was extracted with GeneJET Genomic DNA Purification Kit (Thermo Scientific) and quantitative real time PCR (qPCR) from 1.6 ng of purified gDNA was performed using Lightcycler 480 SYBR Green master kit (Roche) on a LightCycler 480 Real-Time PCR System (Roche).  #@NEW_LINE#@#  Primer sequences can be found in Supplementary S3 File.  #@NEW_LINE#@#  Target sequence primers (TFRC_B out F / TFRC_B in R, Enhancer in F / Enhancer out R for enhancer, Exon in F / Exon out R for exon) were normalised to primers GAPDH F/R amplifying a distal, non-targeted region.  #@NEW_LINE#@#  Another non-targeting primer set, LdhA F/R were treated in the same way.  #@NEW_LINE#@#  Data were normalised using the Ct method [32], incorporating primer efficiencies.  #@NEW_LINE#@#  The latter were estimated using a dilution series of gDNA, and efficiency calculated by the slope of the linear region only (Supplementary S4 File).  #@NEW_LINE#@#  We noted a decrease in efficiency at high template concentrations.  #@NEW_LINE#@#  
For testing the accuracy of the QC-PCR method, we used genomic templates containing known proportions of a target allele from our previous study [4].  #@NEW_LINE#@#  Genomic DNA from a heterozygous clone for TFRC gene of the human, diploid cell line HCT-116, was used, combined with WT gDNA in controlled proportions.  #@NEW_LINE#@#  




