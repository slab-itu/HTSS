article id="http://dx.doi.org/10.1371/journal.pcbi.1006044"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Physics-based simulations of aerial attacks by peregrine falcons reveal that stooping at high speed maximizes catch success against agile prey  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
The peregrine falcon Falco peregrinus is renowned for attacking its prey from high altitude in a fast controlled dive called a stoop.  #@NEW_LINE#@#  Many other raptors employ a similar mode of attack, but the functional benefits of stooping remain obscure.  #@NEW_LINE#@#  Here we investigate whether, when, and why stooping promotes catch success, using a three-dimensional, agent-based modeling approach to simulate attacks of falcons on aerial prey.  #@NEW_LINE#@#  We simulate avian flapping and gliding flight using an analytical quasi-steady model of the aerodynamic forces and moments, parametrized by empirical measurements of flight morphology.  #@NEW_LINE#@#  The model-birds flight control inputs are commanded by their guidance system, comprising a phenomenological model of its vision, guidance, and control.  #@NEW_LINE#@#  To intercept its prey, model-falcons use the same guidance law as missiles (pure proportional navigation); this assumption is corroborated by empirical data on peregrine falcons hunting lures.  #@NEW_LINE#@#  We parametrically vary the falcons starting position relative to its prey, together with the feedback gain of its guidance loop, under differing assumptions regarding its errors and delay in vision and control, and for three different patterns of prey motion.  #@NEW_LINE#@#  We find that, when the prey maneuvers erratically, high-altitude stoops increase catch success compared to low-altitude attacks, but only if the falcons guidance law is appropriately tuned, and only given a high degree of precision in vision and control.  #@NEW_LINE#@#  Remarkably, the optimal tuning of the guidance law in our simulations coincides closely with what has been observed empirically in peregrines.  #@NEW_LINE#@#  High-altitude stoops are shown to be beneficial because their high airspeed enables production of higher aerodynamic forces for maneuvering, and facilitates higher roll agility as the wings are tucked, each of which is essential to catching maneuvering prey at realistic response delays.  #@NEW_LINE#@#  

Author_summary  #@NEW_LINE#@#  
Peregrine falcons are famed for their high-speed, high-altitude stoops.  #@NEW_LINE#@#  Hunting prey at perhaps the highest speed of any animal places a stooping falcon under extraordinary physical, physiological, and cognitive demands, yet it remains unknown how this behavioural strategy promotes catch success.  #@NEW_LINE#@#  Because the behavioral aspects of stooping are intimately related to its biomechanical constraints, we address this question through an embodied cognition approach.  #@NEW_LINE#@#  We model the falcons cognition using guidance laws inspired by theory and experiment, and embody this in a physics-based simulation of predator and prey flight.  #@NEW_LINE#@#  Stooping maximizes catch success against agile prey by minimizing roll inertia and maximizing the aerodynamic forces available for maneuvering, but requires a tightly tuned guidance law, and exquisitely precise vision and control.  #@NEW_LINE#@#  

Citation: Mills R, Hildenbrandt H, Taylor GK, Hemelrijk CK (2018) Physics-based simulations of aerial attacks by peregrine falcons reveal that stooping at high speed maximizes catch success against agile prey.  #@NEW_LINE#@#  PLoS Comput Biol 14(4):  #@NEW_LINE#@#  
           e1006044.  #@NEW_LINE#@#  

        https://doi.org/10.1371/journal.pcbi.1006044  #@NEW_LINE#@#  
Editor: Joseph Ayers,  #@NEW_LINE#@#  
Northeastern University, UNITED STATES  #@NEW_LINE#@#  

Received: October 17, 2017; Accepted: February 15, 2018; Published:  April 12, 2018  #@NEW_LINE#@#  
Copyright:  Â© 2018 Mills et al.  #@NEW_LINE#@#  This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.  #@NEW_LINE#@#  
Data Availability: Data, code, and analysis scripts are available publicly via: https://gitlab.com/BirdFlightSimulator/BirdFlightSimulation.git.  #@NEW_LINE#@#  
Funding: The project grant for the PhD position of Robin Mills was provided by Nederlandse Organisatie voor Wetenschappelijk Onderzoek (NWO; file 823.01.017) to CKH.  #@NEW_LINE#@#  This project has received funding from the European Research Council (ERC) under the European Unions Horizon 2020 research and innovation programme (grant agreement No 682501) to GKT.  #@NEW_LINE#@#  Funding for research exchange has been provided by the Dobberke foundation.  #@NEW_LINE#@#  The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.  #@NEW_LINE#@#  
Competing interests:  The authors have declared that no competing interests exist.  #@NEW_LINE#@#  
Introduction  #@NEW_LINE#@#  
The stoop is a remarkable attack strategy used by peregrine falcons Falco peregrinus, and a range of other raptors [14].  #@NEW_LINE#@#  It involves a steep, controlled dive in which the attacker strikes its prey at high-speed with a massive blow in mid-air [1].  #@NEW_LINE#@#  The high momentum of the attacker places it at obvious risk of harm, especially when diving into flocks of birds [1] or when pulling out only meters from the ground [3].  #@NEW_LINE#@#  Arguably, for the stoop to evolve as an habitual attack strategy, these risks must be outweighed by certain survival advantages, and stooping has therefore been proposed either to save energy [5], or to enhance catch success [6].  #@NEW_LINE#@#  These hypothetical advantages remain unproven, however, because it is challenging to compare the success rates of different attack strategies empirically.  #@NEW_LINE#@#  Success rates are confounded by a variety of factors, including the experience [1, 5] and reproductive status [7] of the attacker, the season of the attack [8], and the species of prey [6].  #@NEW_LINE#@#  Even the seriousness of the attackers behavior may be an important source of variation: falcons seem to not always focus on achieving a high success rate, and appear sometimes to be practising or playing with their prey [9].  #@NEW_LINE#@#  Moreover, the outcome of the stoop is often difficult to observe due to its high speed [6].  #@NEW_LINE#@#  
There presumably exists a trade-off between different factors influencing catch success in a stoop.  #@NEW_LINE#@#  On the one hand, it has been proposed that the high speed of the attack provides an element of surprise, leaving little time for the prey to evade [5, 10].  #@NEW_LINE#@#  On the other hand, it is possible that the high speed of the attack decreases the precision of interception [2], and makes it harder for the attacker to follow the prey if it turns sharply [11].  #@NEW_LINE#@#  Such trade-offs are difficult to investigate empirically, and we therefore turn to modeling and simulation.  #@NEW_LINE#@#  Because physical and physiological constraints influence catch success, we use an embodied cognition approach [12].  #@NEW_LINE#@#  We investigate the success of different attack strategies by incorporating in a physics-based simulation model the aerodynamics, flight mechanics, guidance, and control.  #@NEW_LINE#@#  Such detailed simulations have already proven useful in work on missile guidance: the increasing demand for better performing missiles forces the inclusion of the detailed dynamics of the missile and its target when comparing the effectiveness of different guidance systems [13].  #@NEW_LINE#@#  The nonlinear nature of these dynamics restricts the use of analytic methods, such as linear-quadratic optimal control, and the effectiveness of different mechanisms must therefore be examined through parametric variation of the system between repeated simulations of interception.  #@NEW_LINE#@#  Here, we study the general intercept problem under the particular dynamics of flapping and gliding bird flight.  #@NEW_LINE#@#  Interception in this biological context differs from that of missiles in that gravity plays a pivotal role in determining the best attack strategy: in missiles, the speed and acceleration are so high that the effects of gravity are marginal, but in birds, the acceleration due to gravity dominates the dynamics.  #@NEW_LINE#@#  
The flight performance of the model-birds in our simulations depends on their flight morphology, and differs considerably between predator and prey.  #@NEW_LINE#@#  To maneuver, model-birds flap, glide, and vary their wing span.  #@NEW_LINE#@#  We use the model to study attacks by peregrine falcons on a habitual prey species, the common starling Sturnus vulgaris.  #@NEW_LINE#@#  We simulate three different patterns of flight by the preystraight flight, smooth turning, and non-smooth turning (see Fig 1).  #@NEW_LINE#@#  This approach to varying the target motion is standard in simulations of missile guidance systems, and broadly summarizes the main options for the target to maneuver [13, 14].  #@NEW_LINE#@#  It also captures the range of different prey behaviors found in nature.  #@NEW_LINE#@#  For instance, if a bird is caught by surprise while commuting, then typically it will be flying in a straight line.  #@NEW_LINE#@#  Conversely, when turning, birds usually maneuver smoothly, but they will also fly erratically if a threat is detected, in a kind of non-smooth maneuvering flight known as jinking.  #@NEW_LINE#@#  Here we investigate whether, when, and why stooping increases catch success in each of these three situations (see S1S5 Videos for a visualization of attacks in each scenario).  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pcbi.1006044.g001  #@NEW_LINE#@#  
Because falcons often attack in wide, open spaces at high altitude, there are no objects or boundaries in our simulation space.  #@NEW_LINE#@#  We parametrically vary the falcons initial position relative to its prey to simulate a continuum of possible attack strategies (e.g.  #@NEW_LINE#@#  stoops versus level chases).  #@NEW_LINE#@#  Predator and prey are each free to move with 6 degrees of freedom in translation and rotation, and are subject to gravitational and aerodynamic forces, which they manipulate by controlling their wings (Fig 2).  #@NEW_LINE#@#  The model-birds flight controller determines the changes in wing shape and motion that best meet the accelerations commanded by its guidance system, under a quasi-steady blade element model of the aerodynamics.  #@NEW_LINE#@#  In model-falcons, the guidance system commands turning toward the prey in closed-loop, whereas in model-starlings the guidance system is a forcing function that is set to ensure that the prey remain within approximately Â±20 m of their starting altitude.  #@NEW_LINE#@#  Because we assume that birds maximize their flight speed during escape and pursuit, model-birds always generate the maximum possible forward acceleration given their instantaneous velocity and orientation, subject to the constraint that they must simultaneously meet, as closely as possible, the acceleration demanded normal to their flight direction by their guidance system.  #@NEW_LINE#@#  
This diagram is intended to communicate the general structure of the model.  #@NEW_LINE#@#  A detailed explanation of the model equations is provided in Materials and methods.  #@NEW_LINE#@#  The boxes denote transfer functions, and additional parameters of the functions are noted in between brackets.  #@NEW_LINE#@#  Most of the feedback loop is generic, except for the detailed implementation of flapping flight contained in the black box labelled dynamics and control.  #@NEW_LINE#@#  A brief summary of the feedback loop now follows, in which we walk through each of the different segments of the feedback loop summarised as Vision, Guidance, Dynamics and Control, Kinematics, and Vector Geometry.  #@NEW_LINE#@#  Vision: to determine how it should turn, the falcon first extracts the line-of-sight angle , which is measured subject to visual error .  #@NEW_LINE#@#  The measured line-of-sight angle  is subsequently transformed into an angular velocity vector  that denotes the estimated rate of change in the line-of-sight.  #@NEW_LINE#@#  The resulting signal from the visual system is fed to the guidance function every time interval , as denoted by the block labelled sample  and hold.  #@NEW_LINE#@#  Note that we also test an alternative implementation of visual processing delay in the model (continuous and delayed, instead of in discrete update intervals), as little is known about the nature of delay in birds.  #@NEW_LINE#@#  Results using either form of delay are highly similar (see S1 Fig).  #@NEW_LINE#@#  Guidance: the falcons guidance system multiplies the estimated line-of-sight rate  by the navigation constant N to obtain the commanded change in the angle of the falcons velocity  (see Eq 1), and the cross product is taken with the velocity of the falcon to obtain the commanded acceleration .  #@NEW_LINE#@#  The dynamics and control function depends on the morphological parameters 1,  n and manipulates the wing shape and motion to produce an acceleration  which maximizes the forward acceleration whilst meeting the commanded acceleration as closely as possible (see Materials and methods section D.2 and E for detailed model equations).  #@NEW_LINE#@#  Kinematics and Vector Geometry: the acceleration of the falcon  is integrated in the kinematics section and fed back to the visual system through the medium of the vector geometry needed to relate the line-of-sight angle to the updated positions of the model-falcon and model-starling.  #@NEW_LINE#@#  Note that the segment of the block diagram labeled Vector Geometry operates outside of the model-falcon, so we do not imply that the falcon cognitively represents either its own position or that of its target.  #@NEW_LINE#@#  In particular, the falcon has no knowledge ofand no need to knowthe distance to its target; all that the falcon needs to know is the direction of its target as measured visually by the line-of-sight angle, and its own velocity, which is needed to determine the commanded acceleration from the commanded turn rate.  #@NEW_LINE#@#  Model-starlings have a similar control-loop, in which the segments of the feedback loop labelled Vision and Guidance are replaced by a forcing function (t) that determines their (desired) trajectory (see Materials and methods section C).  #@NEW_LINE#@#  


              https://doi.org/10.1371/journal.pcbi.1006044.g002  #@NEW_LINE#@#  
The falcons closed-loop guidance is essential in commanding the changes in velocity that are needed to intercept prey, whether maneuvering or not, and to deal with the effects of steering error.  #@NEW_LINE#@#  Our model-falcons use a guidance law called pure proportional navigation, which has been shown to fit the empirically measured attack trajectories of peregrine falcons closely [15].  #@NEW_LINE#@#  Proportional navigation is also favored as a guidance law in missiles, because it provides a simple way of implementing the geometric rule known as parallel navigation or constant absolute target direction (CATD), according to which the attacker holds the geographic direction of the line-of-sight to target constant through time [14, 1618].  #@NEW_LINE#@#  This geometry guarantees interception if the attacker is closing range, because at every instant it is set on a collision course with its target (i.e.  #@NEW_LINE#@#  would hit its target if both continued flying at constant velocity thereafter).  #@NEW_LINE#@#  Under pure proportional navigation, the attacker turns at an angular rate proportional to the angular rate of the line-of-sight to target.  #@NEW_LINE#@#  Although this guidance law can be written in three-dimensional vector form, it is more intuitively explained in the two-dimensional case, for which:  #@NEW_LINE#@#  
(1)  #@NEW_LINE#@#  
where  denotes the bearing of the attackers velocity vector and  denotes the bearing of the line-of-sight to target, both measured in an inertial reference frame; the dot notation denotes the time derivative, and N is called the navigation constant.  #@NEW_LINE#@#  The numerical value of N determines the rate of convergence to a parallel navigation (CATD) course: in missiles, low values of N result in slow convergence, whilst high values can cause overshoot, leading to control instability [14].  #@NEW_LINE#@#  Partly for these reasons, intermediate values of N between 3 and 5 are typical in most missile applications.  #@NEW_LINE#@#  
The overall objective of our simulations is to identify the attack strategy that maximizes the catch success of the falcon for a given prey motion, a range of assumptions regarding the delay in the falcons response, and the error in its vision and control (see Materials and methods).  #@NEW_LINE#@#  Here, an attack strategy is defined as some particular combination of the predators navigation constant N, and its initial vertical and horizontal distance from the prey.  #@NEW_LINE#@#  The optimization was conducted via parametric variation of the attack strategy, in combination with Generalized Additive Modeling (GAM), which we used to interpolate between the 106 randomly chosen attack strategies that we simulated in each optimization [19, 20].  #@NEW_LINE#@#  We hypothesise that stooping maximizes catch success, and that it does so as a direct consequence of the flight physics in our simulation model.  #@NEW_LINE#@#  We test this by asking whether a model-falcons catch success is maximized by attacking from a high altitude, which couples into a high flight speed in our simulations.  #@NEW_LINE#@#  Remarkably, we find that the optimality of stooping depends not only on the motion of the prey, but also on the tuning of the underlying guidance law.  #@NEW_LINE#@#  Specifically, we show that stooping is only expected to evolve in conjunction with the same low values of the navigation constant N that have been identified empirically in peregrine falcons [15].  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
Starlings_outmaneuver_falcons_in_slow_flight  #@NEW_LINE#@#  
Flight performance is expected to be a key determinant of catch success in a chase.  #@NEW_LINE#@#  Clearly, any prey species that can fly faster than a falcon will be able to outrun its attacker in straight flight.  #@NEW_LINE#@#  In practice, peregrine falcons fly much faster than starlings, and our aerodynamic model predicts that they hold a considerable speed advantage in both level flight (maximum speed: 29 versus 23 ms1; Fig 3a) and vertical dives (terminal speed: 123 versus 52 ms1; Fig 3b; see section K for a comparison between flight performance in the model and empirical measurements).  #@NEW_LINE#@#  Even so, escape is possible if the prey species can outmaneuver its attacker.  #@NEW_LINE#@#  For instance, if at a given flight speed the prey can produce a higher aerodynamic force relative to body weight than its attacker (i.e.  #@NEW_LINE#@#  produce a higher load factor), then it may escape by turning more tightly than its attacker in a smooth maneuver called a turning gambit [21, 22].  #@NEW_LINE#@#  Our aerodynamic model shows that starlings can indeed sustain higher load factors than peregrine falcons flying at the same speed (Fig 3c), and that although falcons can achieve even higher load factors by flying faster (Fig 3c), the net effect is such that a starling will always be able to turn on a tighter radius than a faster-flying falcon (Fig 3e).  #@NEW_LINE#@#  Similarly, if the prey can achieve a higher roll acceleration than the falcon, then it will be able to redirect its lift faster, and hence outmaneuver its attacker in a non-smooth jinking maneuver.  #@NEW_LINE#@#  Our aerodynamic model predicts that a starling can indeed produce a higher roll acceleration than a falcon flying at the same speed (Fig 3d).  #@NEW_LINE#@#  So great is a model-starlings advantage in this respect that a model-falcon can only be expected to match a model-starlings maximum roll acceleration by diving at close to terminal velocity (i.e.  #@NEW_LINE#@#  at close to its maximum speed).  #@NEW_LINE#@#  Hence, model-starlings may often escape model-falcons in our simulations, even though their maneuvers are not implemented as an evasive response to the falcon.  #@NEW_LINE#@#  In summary, a starling can always outmaneuver a falcon that is flying at a similar speed, but a falcon can always beat the load factor and roll acceleration of a starling by diving at a sufficiently higher speed.  #@NEW_LINE#@#  Whether this strategy enhances catch success will presumably depend on the flight pattern of the prey, and the complex ways in which the predators flight speed, response delay, and errors in vision and control interact to affect its guidance.  #@NEW_LINE#@#  We explore the outcome of these complex interactions in the simulations presented below.  #@NEW_LINE#@#  

Stooping_maximizes_catch_success_if_the_prey_maneuvers  #@NEW_LINE#@#  
The catch success of model-falcons was always maximized by entering a steep dive, but the optimal starting altitude varied greatly between the three different flight patterns of the prey (Table 1; see asterisked points in Fig 4).  #@NEW_LINE#@#  Catch success in attacks on straight-flying prey (Fig 4a) was maximized by stooping from a low altitude (less_than 200m), leading to a low flight speed at the point of intercept (35  45ms1).  #@NEW_LINE#@#  Optimal stoop altitude was somewhat higher (c. 350m) when prey maneuvered smoothly (Fig 4b), leading to a moderate intercept speed (50  55ms1).  #@NEW_LINE#@#  Catch success with non-smoothly maneuvering prey (Fig 4c) was maximized by stooping from a very high altitude (c. 1500m), leading to a very high intercept speed ( greater than  100ms1) approaching the terminal velocity of the model-falcon (see Fig 3).  #@NEW_LINE#@#  Interestingly, catch success barely declined when the model-falcon attacked from a higher altitude than the optimum (Fig 4), but was greatly reduced if the model-falcon attacked from a lower starting position (Fig 4), so stooping from a high altitude is never a bad strategy provided that the guidance system is appropriately tuned (see below).  #@NEW_LINE#@#  

Optimization_of_the_navigation_constant_for_stooping  #@NEW_LINE#@#  
The attack strategy of a model-falcon encompasses both its initial position relative to the prey, and the setting of its navigation constant N. The global optima that we have so far discussed (asterisked points in Fig 4) assume joint optimization of the predators initial attack position and its navigation constant N, and the optima for both parameters depend on the motion of the prey (see also Table 1).  #@NEW_LINE#@#  Selection on N is expected to be strongest when prey execute non-smooth maneuvers, for which high catch success is achieved over only a narrow range of N (compare width of dark blue area denoting high catch success in Fig 5c with the equivalent areas in Fig 5a and 5b).  #@NEW_LINE#@#  Interestingly, for all three types of prey motion, the optimal setting of N tends to be lower the faster the stoop (see dashed lines in Fig 5 plotting the optimal setting of N conditional upon the speed at intercept).  #@NEW_LINE#@#  Conversely, for a given setting of N, the optimal intercept speed becomes lower the higher the value of N (see solid lines in Fig 5 plotting the optimal speed at intercept conditional upon the setting of N).  #@NEW_LINE#@#  Thus, for any given type of prey motion, high-speed, high-altitude stoops only maximize catch success over a small range of comparatively low values of N. At higher values of N, catch success is maximized by using a low-speed (Fig 5), low-altitude (Fig 4) attack, but this is generally less successful than a high-speed, high-altitude attack at a lower value of N.  #@NEW_LINE#@#  
In summary, it turns out to be essential for our model-falcons to set their navigation constant appropriately: if a sub-optimal value of N were used, then stooping might no longer be the best attack strategy, because of poor catch success.  #@NEW_LINE#@#  For instance, if a model-falcon were to use the optimal value of N for smoothly maneuvering prey (N = 5.6) against prey executing non-smooth maneuvers, then a high-altitude stoop would be unlikely to result in prey capture (third panel of Fig 4c).  #@NEW_LINE#@#  This does not necessarily mean that a falcon must actively adjust N to match the maneuverability of its prey: the best attack strategy of a model-falcon against the best defensive flight pattern of a model-starling (i.e.  #@NEW_LINE#@#  non-smooth) involves entering a high-speed, high-altitude stoop at N  3.  #@NEW_LINE#@#  This minimax strategy not only yields maximal catch success against non-smoothly maneuvering prey, but also yields near-maximal catch success against prey that are flying straight or maneuvering smoothly (second row of Fig 4).  #@NEW_LINE#@#  Hence, subject to the assumptions of our model, we expect falcons to adopt a general strategy of stooping from high-altitude at N  3, because this strategy is effective against all of the different patterns of prey flight that we have tested here.  #@NEW_LINE#@#  
Some interesting flight trajectories emerge at N less_than 2 (see S2 Fig).  #@NEW_LINE#@#  In this case, the model-falcon exerts most of its acceleration towards the end of its attack (see also [14]), often diving below its prey before looping upward to intercept.  #@NEW_LINE#@#  This upward-curved trajectory is regularly observed in nature [4, 23], and has previously been suggested to be a strategy of a falcon to fly into the blind spot of its preys vision [9].  #@NEW_LINE#@#  Our model provides a more parsimonious explanation for these flight paths, which can emerge naturally from the dynamics of the underlying feedback law.  #@NEW_LINE#@#  

Response_delays_and_errors_in_vision_and_control_drive_the_need_to_stoop  #@NEW_LINE#@#  
The most important factor that causes the reduction in catch success observed at high values of the navigation constant N is the response delay of the model-falcon.  #@NEW_LINE#@#  A robustness analysis (Fig 6a) shows that high values of N are no longer associated with a low catch success if the reactions of the falcon are effectively instantaneous (compare catch success as a function of N at  = 0.1ms delay with the equivalent line for the default  = 50ms delay used in our baseline model; see Materials and methods).  #@NEW_LINE#@#  Conversely, if the falcons actual response delay is greater than the default assumed in our baseline model, then the optimal value of N is driven towards an even lower value (Fig 6a).  #@NEW_LINE#@#  Visual error also affects the optimal value of N in our simulations: if the falcon is subject to greater visual error than the default value assumed in our model, then the navigation constant is again driven towards an even lower value of N (Fig 6b).  #@NEW_LINE#@#  This reflects the fact that the propagation of this visual error into the commanded acceleration is directly proportional to N (see Fig 2).  #@NEW_LINE#@#  In contrast, the optimal value of N is robust to the error assumed in the control system itself (Fig 6b).  #@NEW_LINE#@#  
How do response delays, or errors in vision and control, impact the success of a given attack strategy?  #@NEW_LINE#@#  As expected, catch success declines as each of these quantities increases (Fig 2).  #@NEW_LINE#@#  Remarkably, however, the optimal starting altitude becomes lower when the visual error or control error is increased (Fig 6c and 6d).  #@NEW_LINE#@#  Thus, a high-speed, high-altitude stoop only maximizes catch success if the falcon is accurate in both vision and control.  #@NEW_LINE#@#  A high-speed stoop maximizes catch success for all of the response delays that we tested, noting that any much longer delay would have resulted in very low catch success (Fig 6e).  #@NEW_LINE#@#  On the other hand, if the falcons response is effectively instantaneous ( = 0.1ms), then 100% catch success is attained even in a low-altitude dive from less_than 200m.  #@NEW_LINE#@#  This implies that the falcons flight performance is sufficient to catch a starling in a low-level stoop, but that delays in the model-falcons response hamper its ability to catch prey.  #@NEW_LINE#@#  The lower catch success that results from having a slower response can be ameliorated by diving from higher altitudes at lower N.  #@NEW_LINE#@#  

What_mechanisms_underlie_the_increased_catch_success_in_a_stoop?  #@NEW_LINE#@#  
When a falcon stoops from high altitude, its attack is characterized by both a very high flight speed, and a very steep descent angleeither of which could promote catch success.  #@NEW_LINE#@#  To investigate the effect of steepness of the descent, we altered the initial conditions of the simulations so as to model a horizontal attack at very high initial speed (112 ms1).  #@NEW_LINE#@#  This effectively simulates the final approach of a falcon that stoops from a very high altitude to gain speed before levelling off to intercept.  #@NEW_LINE#@#  Remarkably, the maximum catch success of these model-falcons is only 3% lower than for those intercepting their prey at the same speed in a steep dive (61 vs 64%).  #@NEW_LINE#@#  This implies that the steep descent angle is not directly responsible for the overwhelming success of a stoop, and hence that the key reason for starting from a very high altitude is to gain airspeed by converting potential energy to kinetic energy.  #@NEW_LINE#@#  
The very high airspeed attained in a stoop enables model-falcons to exceed the model-starlings maximal load factor and roll acceleration (Fig 3).  #@NEW_LINE#@#  To test which of these two dimensions of flight performance causes an increase in catch success in a stoop, we artificially capped the maximal load factor or maximal roll acceleration of our model-falcons.  #@NEW_LINE#@#  We thus investigated the catch success of a bird flying at the same high speed achieved in a high-altitude stoop ( greater than  100ms1), but with the lower maximal acceleration associated with sustained level flight (30ms1).  #@NEW_LINE#@#  Limiting either component of the model-falcons flight performance resulted in a substantial drop in catch success (51% when limiting roll acceleration and 42% when limiting load factor).  #@NEW_LINE#@#  This suggests that the high speed that a falcon attains in a stoop is important partly because of the higher load factors and higher roll accelerations that can be achieved in high-speed flight.  #@NEW_LINE#@#  Interestingly though, model-falcons flying at high speed still performed considerably better than model-falcons in sustained level flight (31% vs 26%) even though the maximal load factor and roll acceleration was made the same, and even when these fast falcons levelled off before interception.  #@NEW_LINE#@#  This implies that a high flight speed is beneficial in and of itself, independent of the higher acceleration performance that is usually also associated with fast flight.  #@NEW_LINE#@#  
This result might seem surprising, because model-falcons fly faster than model-starlings even in sustained level flight (Fig 3a), and the most obvious consequence of increasing the falcons flight speed further is to increase its turning radius, potentially causing it to overshoot when attacking sharply turning prey.  #@NEW_LINE#@#  However, the flight speed of a falcon varies continuously in our model, on account of its varying acceleration demand, and work on missile guidance and control has shown that the accelerations commanded in response to variations in speed are lower when the angle between the current line-of-sight and the expected point of intercept is smaller.  #@NEW_LINE#@#  The faster the falcon, the smaller this angle, which reduces the risk of control saturation, and thereby decreases the probability of missing the target.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
Previous authors have suggested that falcons stoop at high-speed to add an element of surprise to their attack, thereby preventing escape maneuvers by the prey.  #@NEW_LINE#@#  Our simulations suggest that there are many other, previously unrecognized advantages to stooping: for example, a high-speed stoop still provides a clear advantage over an attack from lower altitudes even if the prey individuals fly erratically, which models how real prey behave when alerted to the presence of a predator.  #@NEW_LINE#@#  This is because fast-flying falcons can obtain a higher load factor, can roll faster into a turn, and can slow down less when increasing their load factor to maneuvereach of which increases the falcons catch success.  #@NEW_LINE#@#  Moreover, the steep angle of the stoop, and the details of the attack geometry of a fast-flying falcon further enhance catch success.  #@NEW_LINE#@#  The functional reasons for stooping are therefore far richer than considered previously, and are closely related to the physical constraints upon the problem (see [24] for a wider discussion of the operation of natural selection in relation to biomechanical constraint).  #@NEW_LINE#@#  
In order to intercept prey successfully at high speed, our model-falcons required a suitably optimized guidance law.  #@NEW_LINE#@#  Informed by a recent empirical study [15], our model-falcons used a pure proportional navigation guidance law, but we identified the optimal value of the navigation constant N post hoc through Monte Carlo simulation.  #@NEW_LINE#@#  A range of different values of N can be used successfully in low-speed flight, or when attacking non-maneuvering and smoothly-maneuvering prey, so the tightly-defined optimum of N  3 that applies in a high-speed stoop works well under all of the conditions that we tested (Fig 4).  #@NEW_LINE#@#  This most broadly effective value of the navigation constant coincides closely with the median value of N = 2.6 that has been found empirically in captive-bred peregrine falcons attacking artificial targets [15].  #@NEW_LINE#@#  It also coincides with a classical result of linear-quadratic optimal guidance theory, which shows that proportional navigation with an effective navigation constant N = 3 minimizes the control effort needed to intercept a non-maneuvering target [14] (the effective navigation constant is defined as N = N(v cos )/vc for pure proportional navigation, where v is the attackers speed relative to the ground, vc its closing speed relative to the target, and  the deviation angle between the attackers velocity vector and its line-of-sight to target [14]).  #@NEW_LINE#@#  The fact that a navigation constant of N  3 is found to be optimal or near-optimal in so wide a range of circumstancesand in so wide a range of systems, from birds to missilesstrongly indicates the robustness of our analysis and conclusions.  #@NEW_LINE#@#  
The results of our simulations also offer insight into the variability that is intrinsic to the attack behavior of real falcons.  #@NEW_LINE#@#  Captive-bred falcons have been shown to use a range of navigation constants around the median value of N = 2.6 that is comparable to the range of values of N that are optimal under the various conditions simulated in our model [15].  #@NEW_LINE#@#  Whereas these real falcons seem to maintain an approximately constant value of N during a single interception attempt, they also vary it appreciably between attacks.  #@NEW_LINE#@#  It is currently unknown what drives this variability in the tuning of the navigation constant.  #@NEW_LINE#@#  Our model suggests that the details of the preys motion, and the details of the falcons flight speed, response delay, and precision in vision and control are all important determinants of the optimal tuning of N, and might therefore explain any adaptive variation in N.  #@NEW_LINE#@#  
Surprisingly, attacking at high speed does not require a faster response from the falcon than attacking at low speed (Fig 6e).  #@NEW_LINE#@#  By increasing the falcons flight performance, the stoop compensates for the decrease in catch success that would otherwise result from a slow response.  #@NEW_LINE#@#  In contrast, the need for accuracy in vision and control is especially acute when flying at high speed, and stooping is only optimal if the falcon has reasonably low error in both (Fig 6).  #@NEW_LINE#@#  Hence, we assume that selection for high visual acuity will be especially strong in species that use high-speed attacks.  #@NEW_LINE#@#  It follows that stooping should be considered a specialist hunting technique, because only accurate falcons with optimized guidance will be able to increase catch success by stooping.  #@NEW_LINE#@#  This arguably poses an exploration-exploitation dilemma for a falcon learning to catch prey: either it may seek to optimize its current catch success by adopting the easy strategy of a low-speed attack, for which the details of the parameter tuning are not critical; or, it may explore the more difficult strategy of a high-speed stoop, which could decrease catch success at first in an unskilled falcon, but can be expected to increase catch success in the long-run.  #@NEW_LINE#@#  The playful attacks by falcons in which they do not seriously attempt to kill their prey [6], may be necessary for acquiring sufficient skill in stooping.  #@NEW_LINE#@#  
Limitations_and_wider_implications  #@NEW_LINE#@#  
Although our physics-based model is realistic enough for its intended purpose, there are obviously further constraints in nature that we have not modelled here, including the effects of unsteady aerodynamics, the dynamics of pitch and yaw instability, and the mechanics of catching or knocking the prey with the talons at intercept.  #@NEW_LINE#@#  There are also other complicating factors that we have not modelled, including the effects of explicit evasive maneuvers by the prey, or the impact of intra- and inter-specific variation in flight morphology and physiology, and hence variation in the flight performance of predator or prey.  #@NEW_LINE#@#  These factors can be studied through extensions of the model and through parametric variation of the model between simulations, and will be considered elsewhere.  #@NEW_LINE#@#  Nevertheless, our approach to studying the dynamics of aerial predation is unique among behavioral studies of complex systems in combining guidance and control laws inspired by missile theory [14] with a detailed simulation model of the biology and physics of animal flight.  #@NEW_LINE#@#  The underlying feedback laws are well-founded in the theory of optimal guidance [14], and their validity as a phenomenological model of guidance and control in peregrine falcons has already been verified in nature [15].  #@NEW_LINE#@#  Furthermore, the simulation approach that we have used proves necessary because of the complexity of the flight dynamics, which precludes an analytical approach [13].  #@NEW_LINE#@#  Even setting aside the aerodynamic complexities that we have handled using a blade-element model of flapping flight, the mere fact that the birds must reorient their body to redirect their lift vector generates dynamics that are known to have no analytical solution in the most-closely analogous case of bank-to-turn missiles [25].  #@NEW_LINE#@#  Our modeling therefore follows an embodiment approach, which states that behavior emerges through feedback-loops between the brain, the body, and the world.  #@NEW_LINE#@#  Aspects of cognition, such as the guidance laws used to intercept prey, are shaped by properties of the body and therefore bodily traits need to be considered to fully understand behavior [12, 26].  #@NEW_LINE#@#  In summary, our agent-based simulation approach provides insights into the optimization of attack strategies by an aerial predator that could not have been reached in any other way, and thereby paves the way for a new generation of studies into the optimization of complex multi-agent flight behaviors.  #@NEW_LINE#@#  


Materials_and_methods  #@NEW_LINE#@#  
Summary_of_simulation_procedure  #@NEW_LINE#@#  
In our simulations, model-birds fly with six degrees of freedom through an open three-dimensional space without objects or boundaries.  #@NEW_LINE#@#  In each simulation run, a model-falcon aims to intercept a lone model-starling in mid-air, using a pure proportional navigation guidance law (Eq 1).  #@NEW_LINE#@#  In model-starlings, the guidance command is a forcing function that ensures that they either fly linearly, or execute smooth or non-smooth maneuvers, always keeping within Â±20m of their initial altitude.  #@NEW_LINE#@#  Model-birds are subject to gravitational and aerodynamic forces, and flap, glide and retract their wings to manipulate the aerodynamic forces.  #@NEW_LINE#@#  Model-birds maximize their forward acceleration at a given speed and orientation, subject to the constraint that they meet the normal acceleration commanded by their guidance system.  #@NEW_LINE#@#  A flight controller determines the changes in wing shape and motion that best meet the desired acceleration.  #@NEW_LINE#@#  When the commanded normal acceleration cannot be met, model-birds simply exert the maximum attainable lift force.  #@NEW_LINE#@#  
At the start of an attack, the model-starling is located at the origin of the global coordinate system, with its body coordinate system oriented randomly.  #@NEW_LINE#@#  This variation in initial orientation ensures sufficient randomization to avoid artificial results due to coupling of highly specific initial conditions of the falcon and starling.  #@NEW_LINE#@#  The model starling begins flying at an initial speed of 11 ms1, calculated as the airspeed at which the cost of transport is minimized under the model.  #@NEW_LINE#@#  The model-falcon initially flies at a speed of 16 ms1, with its longitudinal body axis pointing directly towards the starling, and its lateral body axis horizontal.  #@NEW_LINE#@#  We parametrically vary the falcons initial position relative to the prey, and vary the navigation constant N (i.e.  #@NEW_LINE#@#  the one free parameter of the falcons guidance law; see below) to simulate a continuum of different attack strategies.  #@NEW_LINE#@#  For each attack, we sample at random from a uniform distribution, sampling the navigation constant N between 1 and 20, the falcons initial altitude above the prey between 200 and 1500 m, and the initial horizontal distance to the prey between 0 and 800 m. The simulation ends when the falcon either intercepts the starling or is unsuccessful in its attempt to intercept, according to the criteria defined below.  #@NEW_LINE#@#  For a visualization of the simulations, see SI videos.  #@NEW_LINE#@#  

Analysis  #@NEW_LINE#@#  
Every simulation ends in either the success or failure of the model-falcon to catch the model-starling.  #@NEW_LINE#@#  A catch is defined as occurring when the model-falcon comes within 0.2m of the model-starling.  #@NEW_LINE#@#  Failure occurs if either the falcon has not caught the starling within 40 s, or if it experiences a near-miss from which it cannot recover.  #@NEW_LINE#@#  A near-miss occurs when the model-falcon comes within 5.0 m of the model-starling, but subsequently finds itself further than this from the model-starling and with the model-starling in the blind zone of the model-falcon (a cone of 45Â° behind the bird) such that the falcon would effectively need to begin a new engagement in order to re-acquire its target.  #@NEW_LINE#@#  In order to analyze how the model parameters affect catch success, we apply Generalized Additive Modeling (GAM; [19, 20]).  #@NEW_LINE#@#  This is a nonlinear regression method which places no assumptions on the shape of the relationship between predictor and outcome.  #@NEW_LINE#@#  The estimation of the smoothing functions is conducted by automated cross-validation procedures (quadratic penalized likelihood), which reduce the likelihood of over-fitting and therefore ensure that our (conditional) maxima are not spurious.  #@NEW_LINE#@#  We applied GAMs with a logit link function, with catch success as the outcome variable and with the navigation constant N, initial-altitude and horizontal-distance as the independent variables.  #@NEW_LINE#@#  We built separate models for each combination of prey motion, response delay, and error.  #@NEW_LINE#@#  No constraints on the effective degrees of freedom were applied.  #@NEW_LINE#@#  

Software  #@NEW_LINE#@#  
Model simulations were programmed in C++, using openGL for graphics rendering.  #@NEW_LINE#@#  Hildenbrandts StarDisplay model [27] was used as the framework for graphical display.  #@NEW_LINE#@#  Optimization studies of the blade-element model were conducted in MATLAB 2014a, and the mgcv package [28] of R statistics [29] was used for GAM regression.  #@NEW_LINE#@#  

Detailed_description_of_the_bird-flight_simulator  #@NEW_LINE#@#  
Here we explain the detail of our simulation model, using the block structure depicted in Fig 2, and discussing each of the following four segments of the block diagram in turn: A. Kinematics, B.  #@NEW_LINE#@#  Vision, C. Guidance, D. Control and E. Aerodynamics.  #@NEW_LINE#@#  We justify each variable and mechanism by parameterization to empirical data, and justify mathematical argument in terms of physics or optimality.  #@NEW_LINE#@#  For symbol meanings, see Table 2.  #@NEW_LINE#@#  


Supporting_information  #@NEW_LINE#@#  
S1_Fig_Prey_accelerations  #@NEW_LINE#@#  
The figure portrays the distribution of prey accelerations along the x, y and z axes of the inertial axis system, for smooth and non-smooth maneuvering prey.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1006044.s001  #@NEW_LINE#@#  
(EPS)  #@NEW_LINE#@#  

S2_Fig_Flight_trajectories  #@NEW_LINE#@#  
Examples of flight trajectories of the falcon when hunting non-smooth maneuvering prey, and when the navigation constant N of the falcon is low (N less_than 2).  #@NEW_LINE#@#  In some curved flight paths, the peregrine falcon drops below the prey; a phenomenon also observed in nature.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1006044.s002  #@NEW_LINE#@#  
(EPS)  #@NEW_LINE#@#  

S3_Fig_Alternative_delay_implementation  #@NEW_LINE#@#  
In our model, a parameter  affects both the differencing time of the line-of-sight, as well as the sample rate from vision to guidance.  #@NEW_LINE#@#  Here, we show that our results are not implementation specific.  #@NEW_LINE#@#  When we implement a continuous delay function with analytic differentiation, the same qualitative patterns are found: (a) a peak success at an N value of around 34, (b) and an increase in success when the falcon dives from a high-altitude.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1006044.s003  #@NEW_LINE#@#  
(EPS)  #@NEW_LINE#@#  

S4_Fig_Example_of_a_trajectory_using_a_time_step_size_104s_or_105s  #@NEW_LINE#@#  
The differences of the trajectories of the prey and predator between step sizes is marginal (i.e.  #@NEW_LINE#@#  the trajectories converge), and we thus use the larger step size such that run-time of the simulations is minimized.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1006044.s004  #@NEW_LINE#@#  
(EPS)  #@NEW_LINE#@#  

S5_Fig_Change_in_bank_angle_over_time_for_different_step_sizes  #@NEW_LINE#@#  
It portrays the bank angle change over time of a falcon stooping at 100ms1, and exerting a roll acceleration of 5000 rad s2 using Bang-Bang control to turn  rad.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1006044.s005  #@NEW_LINE#@#  
(EPS)  #@NEW_LINE#@#  

S1_Video_Video_of_simulated_attacks_by_peregrine_falcons_in_level_flight_on_starlings_in_smooth_maneuvering_flight  #@NEW_LINE#@#  
The camera is set up to follow the falcon from below at a fixed position, mimicking how a human observer would view the spectacle.  #@NEW_LINE#@#  The falcon misses the starling three times and catches it once.  #@NEW_LINE#@#  A catch is defined as occurring when the model-falcon comes within 0.2m of the model-starling.  #@NEW_LINE#@#  A near-miss occurs (MISS!  #@NEW_LINE#@#  appears on the screen in the video) when the model-falcon comes within 5.0 m of the model-starling, but subsequently finds itself further than this from the model-starling and with the model-starling in the blind zone of the model-falcon (a cone of 45Â° behind the bird).  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1006044.s006  #@NEW_LINE#@#  
(AVI)  #@NEW_LINE#@#  

S2_Video_Video_of_simulated_attacks_by_peregrine_falcons_in_level_flight_on_starlings_in_straight_flight  #@NEW_LINE#@#  
The starling is caught by the falcon in the two attacks of the video, where a catch occurs when the falcon comes within 20cm of the starling.  #@NEW_LINE#@#  Colored ribbons behind the birds show their recent trajectories, and follow the motion of the wings; the white marker at fixed time intervals of 0.5s is used to show the speed of the birds along their trajectories.  #@NEW_LINE#@#  The wingbeat averaged aerodynamic forces due to flapping are analytically derived and act at every time step of the model; there is no explicit model of the tail dynamics.  #@NEW_LINE#@#  We assume that the lift contribution of the tail is negligible, and that it contributes to the overall body drag measured empirically.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1006044.s007  #@NEW_LINE#@#  
(AVI)  #@NEW_LINE#@#  

S3_Video_Video_of_simulated_attacks_by_peregrine_falcons_in_level_flight_on_starlings_in_smooth_maneuvering_flight  #@NEW_LINE#@#  
The falcon misses in the first two attacks and catches the starling in the third.  #@NEW_LINE#@#  A catch is defined as occurring when the model-falcon comes within 0.2m of the model-starling.  #@NEW_LINE#@#  A near-miss occurs (MISS!  #@NEW_LINE#@#  appears on the screen in the video) when the model-falcon comes within 5.0 m of the model-starling, but subsequently finds itself further than this from the model-starling and with the model-starling in the blind zone of the model-falcon (a cone of 45Â° behind the bird).  #@NEW_LINE#@#  Colored ribbons behind the birds show their recent trajectories, and follow the motion of the wings; the white marker at fixed time intervals of 0.5s is used to show the speed of the birds along their trajectories.  #@NEW_LINE#@#  The wingbeat averaged aerodynamic forces due to flapping are analytically derived and act at every time step of the model; there is no explicit model of the tail dynamics.  #@NEW_LINE#@#  We assume that the lift contribution of the tail is negligible, and that it contributes to the overall body drag measured empirically.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1006044.s008  #@NEW_LINE#@#  
(AVI)  #@NEW_LINE#@#  

S4_Video_Video_of_simulated_attacks_by_peregrine_falcons_in_level_flight_on_starlings_in_non-smooth_maneuvering_flight  #@NEW_LINE#@#  
The falcon misses the starling three times and catches it once.  #@NEW_LINE#@#  A catch is defined as occurring when the model-falcon comes within 0.2m of the model-starling.  #@NEW_LINE#@#  A near-miss occurs (MISS!  #@NEW_LINE#@#  appears on the screen in the video) when the model-falcon comes within 5.0 m of the model-starling, but subsequently finds itself further than this from the model-starling and with the model-starling in the blind zone of the model-falcon (a cone of 45Â° behind the bird).  #@NEW_LINE#@#  Colored ribbons behind the birds show their recent trajectories, and follow the motion of the wings; the white marker at fixed time intervals of 0.5s is used to show the speed of the birds along their trajectories.  #@NEW_LINE#@#  The wingbeat averaged aerodynamic forces due to flapping are analytically derived and act at every time step of the model; there is no explicit model of the tail dynamics.  #@NEW_LINE#@#  We assume that the lift contribution of the tail is negligible, and that it contributes to the overall body drag measured empirically.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1006044.s009  #@NEW_LINE#@#  
(AVI)  #@NEW_LINE#@#  

S5_Video_Video_of_simulated_attacks_by_peregrine_falcons_in_stooping_flight_on_starlings_in_non-smooth_maneuvering_flight  #@NEW_LINE#@#  
The falcon catches the starling three times and misses it once.  #@NEW_LINE#@#  A catch is defined as occurring when the model-falcon comes within 0.2m of the model-starling.  #@NEW_LINE#@#  A near-miss occurs (MISS!  #@NEW_LINE#@#  appears on the screen in the video) when the model-falcon comes within 5.0 m of the model-starling, but subsequently finds itself further than this from the model-starling and with the model-starling in the blind zone of the model-falcon (a cone of 45Â° behind the bird).  #@NEW_LINE#@#  Colored ribbons behind the birds show their recent trajectories, and follow the motion of the wings; the white marker at fixed time intervals of 0.5s is used to show the speed of the birds along their trajectories.  #@NEW_LINE#@#  The wingbeat averaged aerodynamic forces due to flapping are analytically derived and act at every time step of the model; there is no explicit model of the tail dynamics.  #@NEW_LINE#@#  We assume that the lift contribution of the tail is negligible, and that it contributes to the overall body drag measured empirically.  #@NEW_LINE#@#  
https://doi.org/10.1371/journal.pcbi.1006044.s010  #@NEW_LINE#@#  
(AVI)  #@NEW_LINE#@#  


References  #@NEW_LINE#@#  



