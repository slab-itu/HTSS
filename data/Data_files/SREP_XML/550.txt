article id="http://dx.doi.org/10.1038/SREP41339"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Discovering novel phenotypes with automatically inferred dynamic models: a partial melanocyte conversion in Xenopus  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Progress in regenerative medicine requires reverse-engineering cellular control networks to infer perturbations with desired systems-level outcomes.  #@NEW_LINE#@#  Such dynamic models allow phenotypic predictions for novel perturbations to be rapidly assessed in silico.  #@NEW_LINE#@#  Here, we analyzed a Xenopus model of conversion of melanocytes to a metastatic-like phenotype only previously observed in an all-or-none manner.  #@NEW_LINE#@#  Prior in vivo genetic and pharmacological experiments showed that individual animals either fully convert or remain normal, at some characteristic frequency after a given perturbation.  #@NEW_LINE#@#  We developed a Machine Learning method which inferred a model explaining this complex, stochastic all-or-none dataset.  #@NEW_LINE#@#  We then used this model to ask how a new phenotype could be generated: animals in which only some of the melanocytes converted.  #@NEW_LINE#@#  Systematically performing in silico perturbations, the model predicted that a combination of altanserin (5HTR2 inhibitor), reserpine (VMAT inhibitor), and VP16-XlCreb1 (constitutively active CREB) would break the all-or-none concordance.  #@NEW_LINE#@#  Remarkably, applying the predicted combination of three reagents in vivo revealed precisely the expected novel outcome, resulting in partial conversion of melanocytes within individuals.  #@NEW_LINE#@#  This work demonstrates the capability of automated analysis of dynamic models of signaling networks to discover novel phenotypes and predictively identify specific manipulations that can reach them.  #@NEW_LINE#@#  

Introduction  #@NEW_LINE#@#  
One of the key areas in which artificial intelligence and the information sciences can contribute to biology is by helping human scientists understand cellular behavior in the context of a complex organism1,2.  #@NEW_LINE#@#  Computational methods can reverse-engineer mechanistic models of tissue patterning and shape formation from expression data and experimental phenotypes3,4,5,6,7,8,9.  #@NEW_LINE#@#  The utility of these methods is their ability to find novel regulatory interactions10 and even novel necessary regulatory genes11.  #@NEW_LINE#@#  These methods are indeed becoming indispensable for understanding the complex coordination of signals necessary to develop and maintain correct body shapes and organs.  #@NEW_LINE#@#  Moreover, such methods are required in order to develop interventions to make rational changes to complex anatomy and physiology, in the context of regenerative medicine and systems-level diseases such as cancer12.  #@NEW_LINE#@#  
The coordination of cellular behavior towards the anatomical needs of the host organism, and away from tumorigenesis, is achieved in part via bioelectrical communication among many cell types13,14,15,16,17,18,19.  #@NEW_LINE#@#  Recent work showed that depolarization of resting potential in a special cell population in Xenopus embryos, so-called instructor cells, results in a metastatic-like conversion of normal melanocytes20.  #@NEW_LINE#@#  Throughout the body (including at considerable distance from the depolarized region), these pigment cells become hyper-proliferative, acquire a highly arborized morphology, and invade organs and blood vessels, colonizing ectopic regions of the body.  #@NEW_LINE#@#  This conversion recapitulates the main features of a melanoma-like phenotype (including up-regulation of cancer-related genes)21.  #@NEW_LINE#@#  It is quite distinct from pigment changes occurring due to light exposure22,23,24 because it affects not the pigment level of individual melanocytes but instead triggers drastic invasiveness that does not significantly change as a function of light level.  #@NEW_LINE#@#  The molecular pathway involved is only partially understood, and comprises voltage-dependent movement of serotonin and subsequent serotonergic signaling25.  #@NEW_LINE#@#  This pathway is an important proof-of-principle of activating a melanoma-like invasive phenotype in the absence of oncogenic mutation or carcinogens26.  #@NEW_LINE#@#  
Although the background rate in control populations is very low (1% of the animals), the incidence of conversion from a depolarization treatment (such as the chloride channel opener ivermectin, which in Xenopus depolarizes cells bearing the GlyR channel20,27) is ~98%21.  #@NEW_LINE#@#  Other treatments (e.g., those interfering with serotonergic steps that mediate bioelectric control of melanocytes) result in intermediate penetrance of the phenotype, with each of them occurring in various characteristic percentages of a treated population21.  #@NEW_LINE#@#  However, a most striking aspect is that it is all-or-none at the level of the individual.  #@NEW_LINE#@#  While the decision to convert or not is stochastic within the treated cohort21, it is always made at the level of the whole animal: no partially converted tadpoles have been seen in any of the experiments (including dozens of different reagents and means of altering serotonergic or bioelectric properties of cells in vivo).  #@NEW_LINE#@#  Each animal is either fully covered with the ectopic, highly-arborized melanocytes, or it looks completely normal (Fig 1).  #@NEW_LINE#@#  The cellular network either reaches a fully-converted outcome or not, but the entire larva does it as a coordinated unit.  #@NEW_LINE#@#  For any given treatment, each individual makes a stochastic decision to convert or not (so that the population converts at a rate specific for that perturbation), but that decision is coordinated among all the cells.  #@NEW_LINE#@#  A salt-and-pepper pattern, which would be expected from cells that made independent stochastic decisions, has not been reported in this context.  #@NEW_LINE#@#  Despite the detailed molecular and cell-level dissection of the signaling pathway involved, the stochastic nature and whole-body coordination in this system remains largely mysterious.  #@NEW_LINE#@#  We thus turned to Machine Learning as a way to discover models that could help understand the global systems properties of this event.  #@NEW_LINE#@#  
Attempting to understand this synchronized stochasticity, a recent computational approach inferred a fully specified signaling network that quantitatively explained the dynamics of this system21.  #@NEW_LINE#@#  Using incidence of conversion from each perturbation experiment as input, together with a basic pathway that had been uncovered between the relevant signaling components20,25, the method reverse-engineered a complete signaling network including all the necessary and sufficient regulatory elements, interactions, and parameters that could recapitulate the frequencies of converted vs. wild-type larvae observed in vivo in each experiment.  #@NEW_LINE#@#  
The use of machine learning to understand complex dynamics from molecular functional data is an important strategy for addressing the gap between increasingly available genetic data and the control of large-scale system behaviors in biomedicine28,29,30,31.  #@NEW_LINE#@#  The ultimate goal for such systems is not only to explain available data, but to be used to rapidly identify treatments that would give rise to desired outcomes, especially in situations too complex for human scientists to infer by hand what course of action will lead to a desired systems-level response.  #@NEW_LINE#@#  Thus, we sought to validate the identified network and approach using a most stringent test: interrogating the network to discover a treatment that produced a capability not reached in any of the previous experiments in this field.  #@NEW_LINE#@#  Specifically, we asked what experimental condition could break the synchrony and achieve partially-converted tadpoles.  #@NEW_LINE#@#  Our results validate the approach, identifying a treatment that for the first time produced partial melanocyte conversion within individual animals.  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
In_silico_discovery_of_a_novel_phenotype  #@NEW_LINE#@#  
We employed a stochastic model of the regulation of melanocyte conversion in Xenopus, uncovered by a Machine Learning approach21, to computationally discover a novel phenotype and the pharmacological perturbations necessary to produce it.  #@NEW_LINE#@#  Figure 2A shows the inferred dynamic model, including the entities used to perturb the system in past work21, the signaling elements participating in the pathway20,25, the incidence of conversion produced by various phenotypes, unknown required components inferred (predicted) by the system, and all the interactions between all the components.  #@NEW_LINE#@#  The perturbation experiments consist in the application of a precise combination of reagents during Xenopus development, which stochastically results in a wild-type phenotype (correct numbers of round melanocytes in their normal locations) or a completely converted phenotype (embryo covered extensively with highly-arborized melanocytes that invade many internal tissues and blood vessels) (Fig 1).  #@NEW_LINE#@#  Interestingly, no intermediate phenotype was observed in the training data set (20 experiments with none, one, or two reagents applied) or the validation data set (seven experiments with two or three reagents applied)tadpoles converted or not, stochastically but always in an all-or-none manner for each animal21.  #@NEW_LINE#@#  Could this coordination be broken, and if so, how?  #@NEW_LINE#@#  
We then performed in silico all possible experiments involving the application of up to three reagents, for a total of 576 different experiments, each repeated 100 times.  #@NEW_LINE#@#  Figure 2B shows, for each experiment, the average distance from the resultant phenotype (degree of conversion) to either of the extreme phenotypes: normal or complete conversion (see methods section for the exact formulation of the distance metric).  #@NEW_LINE#@#  In green are those experiments (combination of reagents) used in the training dataset to infer the model, in red are those used in the validation dataset, and in blue are all the experiments that had never been performed in vivo.  #@NEW_LINE#@#  The results show that all except one experiment (red arrow) are below the 0.1 threshold to an extreme phenotype (normal or converted).  #@NEW_LINE#@#  The experiment above the 0.1 threshold indicates an intermediate phenotype between the previously observed wild-type normal pigmentation and the converted phenotype (i.e., a novel situation in which only some melanocytes within a single animal convert to the metastatic-like phenotype).  #@NEW_LINE#@#  This phenotype is predicted by the inferred model to result from a combined application of altanserin (an R2 inhibitor), reserpine (a VMAT inhibitor), and VP16-XlCreb1 (constitutively active CREB).  #@NEW_LINE#@#  

Dynamics_of_the_partially_converted_phenotype  #@NEW_LINE#@#  
We first investigated in silico the dynamic characteristics of the predicted partially converted phenotype with the inferred model using the combined application of the drugs altanserin and reserpine, and constitutively active CREB.  #@NEW_LINE#@#  Figure 3 shows the phase portraits of 100 simulations of the wild type and the treated embryos with the trajectories of the state of two serotonin receptors (5HT-R1 and 5HT-R2) and the degree of conversion through time.  #@NEW_LINE#@#  The simulation starts in the instable initial state (yellow dot) and, due to the inherent stochasticity of the model, ends in one of several stable attractors, representing a final partial converted state.  #@NEW_LINE#@#  Without treatment (wild type, Fig 3A), the embryos stochastically develop normally (blue dot, 99% of simulations) or high conversion levels (red dot, 1% of simulations).  #@NEW_LINE#@#  In contrast, applying the discovered treatment with three drugs, the embryos stochastically develop with an intermediate conversion level (green dot, 75% of simulations) or a normal conversion level like the wild type (blue dot, 25% of simulations).  #@NEW_LINE#@#  
The partially converted attractor (green dot) was not observed in any previous simulation or experiment in vivo21, representing a novel bifurcation in the signaling networks dynamics due to the specific perturbation caused by the application of the three reagents.  #@NEW_LINE#@#  In this way, the inferred model predicted a partially converted phenotype at about 25% between wild-type and totally converted.  #@NEW_LINE#@#  
The effects of the three reagents in the treatment can be observed in the temporal dynamics of the level of conversion and pathway components targeted by the drugs (Fig 4).  #@NEW_LINE#@#  Embryos with no treatment (wild type, Fig 4A) stochastically develop normal levels of conversion (99% of the simulations) or high levels of conversion (1% of the simulations).  #@NEW_LINE#@#  These embryos always have high levels of VMAT and low levels of CREB.  #@NEW_LINE#@#  However, the levels of serotonin receptor R2 are stochastically either low (blue line, corresponding to high levels of conversion) or high (all other colors, corresponding to normal levels of conversion).  #@NEW_LINE#@#  Embryos under the three drugs treatment (Fig 4B), stochastically develop either the normal level of conversion (25% of the simulations) or the partial conversion phenotype (75% of simulations).  #@NEW_LINE#@#  The plots show how the inhibition drugs reserpine and altanserin causes VMAT and R2, respectively, to converge to a low level, whereas the constitutively active CREB causes CREB levels to reach a high transient state and then converge to a lower level, but overall staying higher than the wild type.  #@NEW_LINE#@#  

In_vivo_validation_of_the_computationally_discovered_treatment_and_phenotype  #@NEW_LINE#@#  
We then sought to validate the partially converted phenotype predicted by the inferred model by applying in vivo the newly discovered combination of reagents.  #@NEW_LINE#@#  Control embryos exposed to vehicle alone were 99% normal (N=258, Fig 5A-A).  #@NEW_LINE#@#  Embryos exposed to ivermectin (which depolarizes instructor cells; the effect has been characterized extensively20,25) exhibited 97% conversion (N=313, Fig 5B-B).  #@NEW_LINE#@#  In contrast, embryos expressing constitutively active CREB (tom-VP16-XlCreb1) and simultaneously treated with a cocktail of Altanserin (R2 blocker, 10uM) and Reserpine (VMAT blocker, 100uM) exhibited the predicted never before-seen partial conversion in 22% of the animals (N=167, Fig 5C-D), while 24% were completely normal, and 54% exhibited the standard full conversion phenotype.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
Here, we have presented the discovery of a novel in vivo phenotype, and the precise intervention required to obtain it, by means of a computational methodology.  #@NEW_LINE#@#  From a reverse-engineered signaling network able to recapitulate the stochasticity of two phenotypes representing wild-type and extreme levels of melanocyte conversion in Xenopus laevis larvae, we sought to discover a pharmacological intervention that could generate a never-seen partially converted phenotype.  #@NEW_LINE#@#  We performed in silico all the possible experiments combining one, two, or three reagents and found that only one specific combination that was able to produce an intermediate phenotype.  #@NEW_LINE#@#  The model dynamics of this intervention showed that this precise combination produced a bifurcation in the dynamical system, generating an attractor corresponding to a phenotype 25% in between the known wild type and totally converted phenotypes.  #@NEW_LINE#@#  Almost a decade of highly diverse experiments focused on this pathway had not revealed such an outcome20,25.  #@NEW_LINE#@#  While detailed mechanistic dissection of the pathway explained signaling on a single cell level, explanations for the stochastic concordance throughout each animal, the possibility of partial conversion, or the reagents that could achieve it, had all remained unknown without the described automated approach that strongly augmented human analysis of this complex dynamical system.  #@NEW_LINE#@#  
We validated these predictions in vivo, confirming the in silico discovery of the novel phenotype.  #@NEW_LINE#@#  When we applied the discovered combination of three reagents, two drugs and constituently active CREB, we observed for the first time the predicted partial converted phenotypeanimals in which some melanocytes and melanocyte-free regions were normal, while others were converted and colonizing ectopic sites.  #@NEW_LINE#@#  It is crucial to note that each of these reagents alone causes some incidence of full conversionthe individual reagents have already been validated to work in Xenopus (i.e., they do penetrate the embryo, reach target cells, and affect this pathway sufficiently to fully convert some percentage of each treated sample)21; however it is of an all-or-none character.  #@NEW_LINE#@#  Moreover, we have previously shown that injection of just a few cells in the embryo (for example, with depolarizing reagents) is sufficient to cause complete conversion21,25the partial conversion here is not due to mosaic expression of the CREB construct, as injected alone, in one cell of the 32-cell stage embryos as above, causes an incidence of ~45% complete conversion.  #@NEW_LINE#@#  The model predicted the wild-type phenotype within 1% (24% in vivo vs 25% in silico), yet it aggregated the partially and fully converted phenotypes observed in vivo (22% partial, 54% fully converted) into a single partial phenotype (75% partial).  #@NEW_LINE#@#  This difference in the frequency of partial and fully converted phenotypes between the in silico and in vivo results may be explained by the lack of time information in the training dataset and the observed dynamics of the system (Figs 3 and 4).  #@NEW_LINE#@#  In particular, a number of trajectories ending in the partially converted phenotype actually are crossing the levels of highly converted phenotypes.  #@NEW_LINE#@#  This observation may indicate that the full conversion that we observed in vivo may be transient.  #@NEW_LINE#@#  Further investigations, and methods that enabled the tadpoles to survive to older stages for tracking any subsequent changes in melanocyte status, would be necessary to validate predictions of transient (time-dependent) changes of the phenotypes predicted by the model.  #@NEW_LINE#@#  Indeed, the training dataset does not contain any time information, and hence the current system does not yet capture realistic timing, which would allow a finer-course analysis of trajectories and comparison with in vivo results; in future work we will extend this platform to include time-series data, so that these transient phenotypes can be better investigated.  #@NEW_LINE#@#  
Identification of interventions that alter system-level physiology or pattern formation is a crucial nascent field with many implications for biomedicine32,33.  #@NEW_LINE#@#  The complexity of biological regulation makes it very hard to completely and mechanistically understand signaling networks, the prediction of resultant experimental outcomes, and hence the discovery of novel phenotypes.  #@NEW_LINE#@#  Computational dynamic modeling of complex regulatory networks is essential for the discovery of new capabilities of biological systems and prediction of specific perturbations that result in desired outcomes.  #@NEW_LINE#@#  Using these models, we can computationally and systematically interrogate the system to find the precise interventions necessary for the development of specific phenotypes33.  #@NEW_LINE#@#  The computational methodology presented here shows how a reverse-engineered signaling system can be used in this way to precisely find a set of reagents that produce a never before seen outcome at the intersection of embryogenesis and metastatic-like conversion.  #@NEW_LINE#@#  These computational methods are paving the way for the discovery and further understanding and manipulations of multicellular, stochastic, and multidimensional biological phenomena, as well as for the discovery of novel and effective therapies that target cooperative or group aspects of cell function in vivo.  #@NEW_LINE#@#  

Methods  #@NEW_LINE#@#  
Animal_husbandry  #@NEW_LINE#@#  
Xenopus embryos were maintained according to standard protocols34 in 0.1× Marcs Modified Ringers (MMR; pH 7.8).  #@NEW_LINE#@#  Xenopus embryos were staged according to Nieuwkoop and Faber35.  #@NEW_LINE#@#  All experimental procedures involving Xenopus embryos were approved by the Institutional Animal Care and Use Committees (IACUC) and Tufts University Department of Laboratory Animal Medicine under protocol M2014-79.  #@NEW_LINE#@#  All experiments were performed in accordance with relevant guidelines and regulations.  #@NEW_LINE#@#  Although we have not observed light to make any difference to the converted phenotype, all groups were subjected to the same light conditions.  #@NEW_LINE#@#  

Microinjection__drug_exposure__sectioning__and_image_collection  #@NEW_LINE#@#  
Embryos were injected with mRNA encoding constitutively active CREB (tom-VP16-XlCreb136) at 1/32 cell stage and then exposed to a mix of Altanserin (5HT-R2 blocker, 10uM) and Reserpine (VMAT blocker, 100 uM) using the same methods described previously20,21,37,38.  #@NEW_LINE#@#  Sections were made at 40 on a Leica vibratome after JB4 embedding.  #@NEW_LINE#@#  Images were collected using a Nikon SMZ-1500 microscope and each phenotype was visually characterized as having normal melanocyte status, partial conversion, or full conversion; these three classes are discrete and readily distinguished as categorical data; the quantification of the definition of these states was described in refs 20 and 39.  #@NEW_LINE#@#  

Dynamic_signaling_model_of_melanocyte_conversion  #@NEW_LINE#@#  
We used the dynamic signaling model of Xenopus melanocyte conversion presented in ref.  #@NEW_LINE#@#  21.  #@NEW_LINE#@#  The model is based on Hill-kinetics and includes 14 stochastic ordinary differential equations describing the interactions of signaling molecules, pharmacological compounds (drugs, set to 0 when not applied and 1 when applied), and the level of melanocyte conversion (the phenotype, equivalent to the pigmentation level) of a developing embryo.  #@NEW_LINE#@#  The interaction between signaling molecules and drugs are modeled with a combination of Hill functions, each of them representing the interaction between two products.  #@NEW_LINE#@#  When multiple interactions regulate a product, they can be grouped as sufficient, necessary, or a combination of them.  #@NEW_LINE#@#  Sufficient interactions can regulate the production of the target product independently of other sufficient interactions (modeled with a max operator, similar to a logic OR interaction; hence, activation has preference over inhibition).  #@NEW_LINE#@#  In contrast, all the necessary interactions need to be coordinated to regulate the production of the target product (modeled with a min operator, similar to a logic AND interaction; hence, inhibition has preference over activation).  #@NEW_LINE#@#  This scheme allows the modeling of a rich variety of regulatory interaction combinations.  #@NEW_LINE#@#  In addition, each product includes a decay term (with a specific decay constant) and a Gaussian random noise of zero mean to model the stochasticity of the system.  #@NEW_LINE#@#  
The following set of differential equations, including all the kinetic parameters, define the complete model ((t) represents a Gaussian random noise of zero mean):  #@NEW_LINE#@#  
This set of equations (defined in the model) together with a set of initial conditions of the signaling products (defined in the model) and the drugs (defined in the experiment) form an initial value problem which is then numerically solved until reaching a steady state.  #@NEW_LINE#@#  Due to the stochastic nature of the equations, different runs with the same initial conditions (same experiment) can result in different phenotypic outcomes (level of melanocyte conversion) as observed in vivo.  #@NEW_LINE#@#  The model was reverse-engineered directly from a dataset of 20 experiments combining different pharmacological drugs and resulting in a specific frequency of two different and extreme phenotypes (within each phenotype, the animal-to-animal variation in pigmentation level was not visually detectable): either normal (pigmentation level 0) or high level (pigmentation level 1) of melanocyte conversion, never an intermediate level as described in ref.  #@NEW_LINE#@#  21.  #@NEW_LINE#@#  The model was further validated with an additional dataset of 7 experiments not used during the training21.  #@NEW_LINE#@#  The model kinetic constants, also inferred from the experimental data, are in arbitrary units.  #@NEW_LINE#@#  

Phenotype_distance_metric  #@NEW_LINE#@#  
To discover phenotypes different from the two extreme levels of conversion (normal or high) previously observed in silico with the model and in vivo with Xenopus experiments, we defined a distance metric for simulated phenotypes obtained with the model.  #@NEW_LINE#@#  The metric quantifies the level of intermediate conversion obtained in a set of resultant in silico phenotypes simulated with the model for a specific experiment (combination of reagents).  #@NEW_LINE#@#  The distance metric is defined with the following equation:  #@NEW_LINE#@#  
where d(E) is the mean distance of experiment E (a combination of reagents) when simulated 100 times with the model and resulting in phenotypes with level of conversion pi (the level of conversion is a dynamic variable in the model, with values from 0 for the wild type to 1 for a total conversion).  #@NEW_LINE#@#  




