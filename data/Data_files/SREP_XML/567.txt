article id="http://dx.doi.org/10.1038/srep37584"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Cas9-catalyzed DNA Cleavage Generates Staggered Ends: Evidence from Molecular Dynamics Simulations  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
The CRISPR-associated endonuclease Cas9 from Streptococcus pyogenes (spCas9) along with a single guide RNA (sgRNA) has emerged as a versatile toolbox for genome editing.  #@NEW_LINE#@#  Despite recent advances in the mechanism studies on spCas9-sgRNA-mediated double-stranded DNA (dsDNA) recognition and cleavage, it is still unclear how the catalytic Mg2+ ions induce the conformation changes toward the catalytic active state.  #@NEW_LINE#@#  It also remains controversial whether Cas9 generates blunt-ended or staggered-ended breaks with overhangs in the DNA.  #@NEW_LINE#@#  To investigate these issues, here we performed the first all-atom molecular dynamics simulations of the spCas9-sgRNA-dsDNA system with and without Mg2+ bound.  #@NEW_LINE#@#  The simulation results showed that binding of two Mg2+ ions at the RuvC domain active site could lead to structurally and energetically favorable coordination ready for the non-target DNA strand cleavage.  #@NEW_LINE#@#  Importantly, we demonstrated with our simulations that Cas9-catalyzed DNA cleavage produces 1-bp staggered ends rather than generally assumed blunt ends.  #@NEW_LINE#@#  

Introduction  #@NEW_LINE#@#  
The clustered regularly interspaced short palindromic repeats (CRISPR)/CRISPR-associated (Cas) systems provide bacteria and archaea with adaptive immunity against invasive viruses and plasmids1,2,3,4.  #@NEW_LINE#@#  The Cas9 protein from Streptococcus pyogenes (spCas9), combined with a single guide RNA (sgRNA), a synthetic fusion of CRISPR RNA (crRNA) and trans-activating crRNA (tracrRNA), has been adapted to a most widely used toolbox for gene editing in various living cells and organisms, demonstrating great potential toward further therapeutics applications5,6,7,8.  #@NEW_LINE#@#  
The biochemical experiments have established that double-stranded DNA (dsDNA) recognition and cleavage by Cas9 strictly require the presence of a short protospacer-adjacent-motif (PAM) in the non-target, or non-complementary, DNA strand (ntDNA) and the complementarity of the target DNA strand (tDNA) to the 1012 nucleotide (nt) PAM-proximal seed region in the guide RNA6,9.  #@NEW_LINE#@#  Recently solved crystal structures of spCas9 reveal a bilobed architecture comprising of an -helical recognition (REC) lobe and a nuclease (NUC) lobe (Fig 1A)10,11,12,13,14,15,16.  #@NEW_LINE#@#  The NUC lobe incorporates two Mg2+-dependent nuclease domains, dubbed as RuvC and HNH, which are responsible for cutting the ntDNA and tDNA, respectively (Fig 1B,C)6,9.  #@NEW_LINE#@#  The RuvC domain features a typical ribonuclease H (RNase H) fold with four functionally essential residues, D10, E762, H983 and D986 (Fig 1B)6,12, in line with a two-metal-ion catalysis mechanism17,18,19.  #@NEW_LINE#@#  In contrast, the HNH domain is characterized by a -metal motif with three catalytic residues, D839, H840 and N863 (Fig 1C)6,10,12, consistent with a one-meta-ion mechanism17,18,19.  #@NEW_LINE#@#  
A wealth of biochemical and structural information has made remarkable contributions to the mechanistic insights into RNA-guided DNA recognition and cleavage by Cas9.  #@NEW_LINE#@#  However, many details of the cleavage process, such as how the catalytic Mg2+ ions mediate the connections between Cas9 and DNA, remain elusive in this system11,12,16.  #@NEW_LINE#@#  The recent crystal structures show a closest distance of ~5.5Å between the superimposed Mn2+ ions and the non-bridging oxygen atoms of the putative scissile phosphate on the ntDNA11,16, which is considerably larger than the typical Mg-O coordination distance of 2.1Å for catalysis, indicating the crystalized conformation is inactive for catalysis.  #@NEW_LINE#@#  Intriguingly, the HNH domain assumes an inactive conformation in all the complex structures10,11,12,13,14,15,16, in which the shortest distance of the catalytic residue H840 to the opposite cleavable site on the DNA is around 14Å, which is far beyond the range required for catalysis.  #@NEW_LINE#@#  To date, no active state conformation together with Mg2+ ion has been reported.  #@NEW_LINE#@#  We hypothesize that the catalytic Mg2+ ions induce the conformational change to an active state by facilitating the proximity of Cas9 active sites and DNA.  #@NEW_LINE#@#  Here, we used molecular dynamics simulations to search for the active state and to test our hypothesis.  #@NEW_LINE#@#  
Unlike HNH domain-mediated tDNA cleavage, determining the exact cleavage site on the ntDNA is complicated due to the additional 3- greater than 5 exonuclease activity of the RuvC domain6,16, especially when the protospacer 5-end is used for direct sequencing analysis or radiolabeled for gel electrophoresis analysis2,6,9.  #@NEW_LINE#@#  Moreover, the target site detection methods, including direct sequencing and gel electrophoresis analysis, appear to exhibit limited resolution in terms of discrimination of 1-nt length6,9.  #@NEW_LINE#@#  Therefore, it is still controversial as to whether the spCas9 cuts the ntDNA at the phosphate 3 base pair (bp) upstream of the canonical 5-NGG-3 PAM motif (denoted as 3P) or 4bp apart (4P) (see Fig 1D)6,9,10,11,20.  #@NEW_LINE#@#  This naturally elicits another interesting and critical question: Does Cas9 produce blunt-ended breaks or staggered-ended breaks with overhangs in the target dsDNA?  #@NEW_LINE#@#  Some studies reported that Cas9 cuts the ntDNA at 3P as the tDNA at +3P, thereby leaving blunt ends9,20, whereas others argued that 4P is the ntDNA cleavage site, implying staggered ends generated by Cas910,11.  #@NEW_LINE#@#  Meanwhile, there exists another view that Cas9 produces either blunt or 1-bp staggered ends5,6.  #@NEW_LINE#@#  For genome-editing, staggered-ended DNA is more controllable than the blunt-ended DNA because the DNA repair would only occur at the staggered end rather than at either end.  #@NEW_LINE#@#  To determine which type of ends generated by Cas9 is critical to understand the mechanism of non-homologous end joining (NHEJ)-based gene repair following the DNA cleavage21,22,23, hence shedding lights on strategy development to enhance precise genome engineering.  #@NEW_LINE#@#  
Molecular dynamics (MD) simulation has emerged as a powerful tool to explore bio-macromolecule dynamics in complementary with experimental data.  #@NEW_LINE#@#  To investigate the mechanisms underlying Cas9-catalyzed cleavage process, here, we present the first computational simulation study on the Cas9-sgRNA-dsDNA system at the atomic level to address the following two questions: 1) Could the Mg2+ ions bridge the distance gap between the active sites of Cas9 and ntDNA?  #@NEW_LINE#@#  2) Where is the cleavage site on ntDNA?  #@NEW_LINE#@#  Our simulation results demonstrate that introduction of two Mg2+ ions at 4P remarkably induces conformation changes to bring the active site of the RuvC domain and ntDNA into proximity, forming structurally and energetically favorable coordination in between the catalytic residues and the scissile phosphate for cleavage reaction to occur.  #@NEW_LINE#@#  Thus, we evidence that Cas9 generates 1-bp 5-staggered breaks in the dsDNA.  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
Mg2+_Ions_Induce_Conformational_Changes_to_Bridge_the_Distance_Gap_between_the_Active_Site_of_the_RuvC_Domain_and_the_ntDNA  #@NEW_LINE#@#  
To probe the effect of Mg2+ on conformational change, one Mg2+ ion was placed in the HNH domain on the basis of the one-metal ion catalysis mechanism (Fig 1C), whereas two Mg2+ ions were positioned at the interface of the RuvC domain and the ntDNA at various positions according to the two-metal-ion mechanism (Fig 1D)17,18,19.  #@NEW_LINE#@#  For simplicity, S0 here represents the simulation in the absence of Mg2+; S1/S2, and S5/S6 denote the repeated simulations in which the Mg2+ pair were positioned around 3P and around 4P, respectively, whereas S3/S4 are the two simulations with the Mg2+ ions placed in between 3P and 4P (see Materials and Methods for details).  #@NEW_LINE#@#  Analysis of the root-mean-square deviations (RMSD) of the simulated systems revealed that the overall stability of the entire complex is largely determined by the sgRNA (Supplementary Fig S1), as its long middle segment protrudes into the solvent, exhibiting high flexibility (Fig 1A).  #@NEW_LINE#@#  The Cas9 protein and the duplex DNA tended to reach equilibrium after dozens of nanoseconds, with RMSD fluctuating around 3Å.  #@NEW_LINE#@#  The above observations are in line with a most recent study by Palermo et al.24.  #@NEW_LINE#@#  If not otherwise specified, all the following results were derived since 40ns of the simulation trajectories.  #@NEW_LINE#@#  
We first monitored the proximity of the ntDNA and RuvC active center by measuring the distances between 3P and His983 (d-3P/His983) and between 4P and Asp10 (d-4P/Asp10) (Fig 2A,B) for each trajectory.  #@NEW_LINE#@#  Without Mg2+ ions (S0), the distances between the ntDNA and the RuvC domain active residues peak at ~10Å for both measurements (Fig 2A,B).  #@NEW_LINE#@#  Compared to the control simulation (S0), addition of the Mg2+ ions obviously shifted the distance distributions of ntDNA and RuvC active center to smaller values in varying degrees regardless of the Mg2+ ions positions (S1 to S6), indicating the presence of metal ions could indeed induce the conformational change toward the active state and close the distance gap between the ntDNA and the RuvC domain as previously postulated11,12,16 and as we hypothesized.  #@NEW_LINE#@#  Among all simulations, the double Mg2+ binding at the 4P in S5 and S6 leads to the largest reduction in d-3P/His983 (by ~4Å) as well as in d-4P/Asp10 (by ~6Å) when comparing the highest peaks with that of S0 (Fig 2A,B).  #@NEW_LINE#@#  
However, the HNH domain still adopted an inactive conformational state exhibiting no trend of moving close to the tDNA in all the simulations, as characterized by the distribution profiles of the distance of +3P and His840 (d+3P/His840) that are largely overlaid with each other (Fig 2C).  #@NEW_LINE#@#  Though the high intrinsic flexibility in the HNH domain11,13,16,25, our observation might result from the simulation time scale (hundreds of ns) far from sampling an activated state.  #@NEW_LINE#@#  More likely, in the context of dsDNA, the conformational switch of HNH domain is dependent on the completion of RuvC domain-catalyzed ntDNA cleavage accompanying by its product release13,25, which is beyond the scope of conventional MD simulation.  #@NEW_LINE#@#  In the following section, we focus on Mg2+-involved interactions with the RuvC domain and ntDNA.  #@NEW_LINE#@#  

Mg2+_Ions_Binding_at_4P_Lead_to_Active_State_Formation_for_ntDNA_Cleavage  #@NEW_LINE#@#  
Further inspection of the simulation trajectories revealed distinct binding poses of the Mg2+ pair at the interface of RuvC domain and ntDNA.  #@NEW_LINE#@#  In S1 and S2, the Mg2+ ion A (the one on the 3 side of ntDNA) moves toward the 2P from its initial location at 3P (Fig 1D, Fig 3A and Supplementary Fig S3A).  #@NEW_LINE#@#  In S3 and S4, the Mg2+ B (the one on the 5 side of ntDNA) departs from the middle position in between 3P and 4P, entering the negatively charged center enclosed by Asp10, E762 and D986 or 4P (Fig 1D, Fig 3B and Supplementary Fig S3B).  #@NEW_LINE#@#  Positioning Mg2+ at either 3P (S1/S2) or in between 3P and 4P (S3/S4) all led to the Mg-Mg distance larger than 6Å (Fig 2D).  #@NEW_LINE#@#  In S5 and S6, the Mg2+ pair stays around 4P (Fig 1D, Fig 3C and Supplementary Fig S3C), resulting in the lowest Mg-Mg separation distance (4.3~4.7Å) among all simulations, which is comparable to the inter-Mg2+ distance (4.1Å) from the experimental and theoretical studies on another two-metal-ion catalytic system with two Mg2+ trapped in between the Bacillus halodurans ribonuclease H (RNase H) and an RNA/DNA hybrid (Fig 3D and Supplementary Fig S3D)17,26,27,28.  #@NEW_LINE#@#  
In the framework of two-metal-ion mechanism, the two metal ions are coordinated by an invariable Asp (that may be a phosphate in ribozymes) and the scissile phosphate17,18,19.  #@NEW_LINE#@#  Among all the simulations, only the coordination composition and geometry captured in S5 and S6 (Fig 3C; Supplementary Fig S3C), in which the conserved Asp10 and the 4P contribute two coordination ligands to the double Mg2+, respectively, closely match those observed in the prototype RNase H system (Fig 3D and Supplementary Fig S3D).  #@NEW_LINE#@#  Unlike the other simulations (S1/S3 in Fig 3A,B and S2/S4 in Supplementary Fig S3A,B), in which Mg2+ ions only coordinated with one or two catalytic residues, all three acid catalytic residues (Asp10, E762 and Asp986) are involved in coordination with the two metal ions in S5 and S6.  #@NEW_LINE#@#  Specifically, it is interesting to note that despite the similarity in the coordination configuration, the general base His983 in S6 is directly engaged to the Mg2+ A (Supplementary Fig 3C), whereas in S5 it is hydrogen-bonded to a water molecule that provides a ligand to the Mg2+ A coordination (Fig S3C).  #@NEW_LINE#@#  
Taken together, the observations uncover formation of an active state for ntDNA cleavage stemming from the binding of two Mg2+ at 4P.  #@NEW_LINE#@#  Yet it should be mentioned that compared with the canonical two-mental-ion coordination in the RNase H system, there exists a noticeable difference in terms of the scissile phosphate-mediated coordination with the two Mg2+.  #@NEW_LINE#@#  Both in S5 and S6, the two non-bridging oxygens (pro-Sp and pro-Rp) of 4P together form a bidentate coordination with the double Mg2+ ions (Fig 3C and Supplementary Fig S3C), whereas in the RNase H-substrate complex, only the pro-Sp oxygen is implicated (Fig 3D and Supplementary Fig S3D).  #@NEW_LINE#@#  This may account for why the separation of the two Mg2+ (Fig 2D) and that of the Mg2+ B and the leaving group 3-O in S5 and S6 (Fig 3C and Supplementary Fig S3C) are slightly larger than those observed in the crystal structure of RNase H complex (Fig 3D and Supplementary Fig S3D).  #@NEW_LINE#@#  

The_Double_Mg2+_Binding_at_4P_is_Energetically_More_Favorable_than_Binding_at_Other_Positions  #@NEW_LINE#@#  
To provide a quantitative view of the preference of the two Mg2+ ions for the scissile phosphate, we estimated the binding free energies of the Mg2+ pair at various positions via the end-point MM-GBSA approach29,30,31.  #@NEW_LINE#@#  Compared to the alternative MM-PBSA, MM-GBSA is computationally more efficient and has demonstrated the advantage in ranking the affinities of a series of ligands32,33,34.  #@NEW_LINE#@#  Given that water molecules play an important role in coordinating the catalytic ions (Fig 3 and Supplementary Fig S3), we consistently retained four water molecules that are closest to the two Mg2+ as part of receptor in the trajectories for MM-GBSA calculations (see Materials and Methods for details).  #@NEW_LINE#@#  The results showed that the binding of the Mg2+ pair at 4P in S5 and S6 is more stable than those at 3P or in between 3P and 4P in other simulations (S1S4) (Table 1).  #@NEW_LINE#@#  Moreover, the binding free energy values of the set of parallel simulations are comparable in magnitude, indicating similar stability for the two coordination geometries captured in S5 and S6 (Fig 3C and Supplementary Fig S3C).  #@NEW_LINE#@#  We also calculated the non-bonded interaction energy of the Mg2+ pair with all surrounding residues and water and found a similar trend to that of MM-GBSA (Supplementary Table S1).  #@NEW_LINE#@#  
The biochemical experiments have evidenced the functional importance of four residues (viz.  #@NEW_LINE#@#  Asp10, Glu762, His983 and Asp986) at the RuvC active center for Cas9 catalytic activity6,12.  #@NEW_LINE#@#  We further performed per-residue free energy decomposition on these four residues to determine the contributions of individual catalytic residues to the binding of the metal ions.  #@NEW_LINE#@#  In S2, all of the four active residues hardly contribute to the binding of the two Mg2+, while Asp10 is the sole major contributor in S1 (Fig 4).  #@NEW_LINE#@#  Compared to S3, Asp986 in S4 shows much stronger binding affinity (Fig 4), accounting for the marked difference in binding free energy for the two simulations (Table 1).  #@NEW_LINE#@#  Notably, the two acid residues, Asp10 and Glu762 in S5/S6 make much larger contributions to the binding than in other simulations (Fig 4), again suggesting most favorable binding of the Mg2+ at 4P (Table 1).  #@NEW_LINE#@#  In contrast, His983 contributes marginally to stabilizing Mg2+, which is consistent with its major role as a general base activating the nucleophile17,18,19.  #@NEW_LINE#@#  The per-residue contribution analyses here are in line with the above structural observations (Fig 3 and Supplementary Fig S3).  #@NEW_LINE#@#  


Discussion_and_Conclusions  #@NEW_LINE#@#  
Several crystal structures of spCas9 have been solved, however, none of these structures assume the catalytic active state.  #@NEW_LINE#@#  One of the reasons is that to crystalize the ternary complex of spCas9-sgRNA-dsDNA, cleavage has to be prevented by substitution of catalytic residues and/or chelation of metal ions so that the systems do not support catalysis12,16.  #@NEW_LINE#@#  The use of partial ntDNA (cleaved product) for complex crystallization may also impair two metal ion binding10,14,15.  #@NEW_LINE#@#  In the complex structure with PAM-containing partial DNA duplex (PDB code: 4UN3), for example, only a single Mg2+ is non-specially bound at the RuvC active site, forming an incomplete coordination due to lack of the involvement of phosphate group (Supplementary Fig S4A)10.  #@NEW_LINE#@#  It is interesting to note that the ion A of the Mg2+ pair in our simulations spatially overlaps with that one in 4UN3 (Supplementary Fig S4A).  #@NEW_LINE#@#  In the apo-Cas9 without sgRNA and dsDNA (PDB code: 4CMQ), two Mn2+ ions instead of Mg2+ were found at the RuvC active site but only at a concentration much higher than physiologically relevant11 (Supplementary Fig S4B).  #@NEW_LINE#@#  Here, for the first time, we determined the catalytic active state for the RuvC domain and the ntDNA by scanning the possible scissile phosphates on the ntDNA with a pair of Mg2+.  #@NEW_LINE#@#  The presence of Mg2+ ions at 4P remarkably drive the RuvC domain active center to the opposite phosphate backbone (Fig 2), leading to a reactant-like coordination primed for cleavage (Fig 3 and Supplementary Fig S3).  #@NEW_LINE#@#  We demonstrated that beyond its catalytic role, the second role of Mg2+ ions is to lead the inactive conformation of the RuvC domain and the ntDNA toward the active state for catalysis.  #@NEW_LINE#@#  Our results add a piece of evidence corroborating the argument that acquisition of metal ions could strength specific substrate recognition and association, as observed in many polymerases and nucleases17,18,19.  #@NEW_LINE#@#  
From the twin Mg2+ coordination fashions and the calculated binding free energies in different sets of simulations, we concluded that it is very unlikely for the RuvC domain to cut the ntDNA at 3P due to obvious disobedience with the two-metal-ion mechanism that entails joint coordination of the Mg2+ pair by the scissile phosphate and a conserved Asp (Fig 3 and Supplementary Fig S3), as well as the unfavorable binding free energy comparing to other binding conformations (Table 1).  #@NEW_LINE#@#  Rather, we argue that 4P is the ntDNA cleavage site based on the formation of structurally and energetically favorable coordination, which is supported by the enzymatic footprinting experiments11, and also consistent with the structural observation showing the acidic residue cluster in the RuvC domain active center is spatially closer to 4P than 3P16.  #@NEW_LINE#@#  To further enhance the reliability of the conclusion, we additionally performed four shorter simulations (4×60ns) starting with randomly assigned velocities for each of the three binding configurations (i.e.  #@NEW_LINE#@#  Mg2+ pair placed at 3P, 3P/4P and 4P, respectively), and found very similar results with respect to the two longer simulations here (2×200 or 2×300ns) (see full details in the Supplementary Information).  #@NEW_LINE#@#  Since the HNH domain-mediated tDNA cleavage has been more unambiguously identified as occurring at +3P9,11, we rationalize 1-bp 5-staggered ends initially generated by Cas9 other than generally assumed blunt ends9,20.  #@NEW_LINE#@#  This staggered end may be further extended to a length of interest by rationally exploiting the additional 3- greater than 5 exonuclease-trimming activity in the RuvC domain6,16, which could be particularly advantageous for facilitating non-homologous end joining (NHEJ)-mediated gene insertion into the mammalian genome21,22,23.  #@NEW_LINE#@#  Considering that the small molecules that enhance NHEJ activities have been demonstrated to enhance the CRISPR/Cas genome editing35,36, we speculate that mutations or small molecules that could modulate the cleavage site to make the 1-bp staggered end more stagger may also help to enhance the CRISPR/Cas9 genome editing.  #@NEW_LINE#@#  
In this report, we did not address the questions on the HNH domain.  #@NEW_LINE#@#  For example, what triggers the HNH domain to convert into an active conformation?  #@NEW_LINE#@#  How does the Mg2+ ion bridge the distance gap between the HNH domain and the tDNA?  #@NEW_LINE#@#  These intriguing questions will be investigated in our future studies.  #@NEW_LINE#@#  We also noticed the derived two-metal-ion coordination geometries are somewhat deviated from that by the RNase H (Fig 3C,D and Supplementary Fig S3C,D), though this does not qualitatively influence the conclusions drawn here.  #@NEW_LINE#@#  We suspect that the discrepancy is related to the additive force field, but we cannot rule out the possibility that two-metal-ion catalysis mechanism of Cas9 is slightly different from that of RNase H. These issues will be addressed in our future studies by using the polarizable force fields in the MD simulations and using the quantum mechanical/molecular mechanical (QM/MM) approaches to explore the free energy surface for catalysis reactions28.  #@NEW_LINE#@#  
In summary, our study indicates that binding of two catalytic Mg2+ ions at the RuvC domain catalytic center facilitates the formation of an active state for ntDNA cleavage, and, importantly, that Cas9-catalyzed target DNA cleavage produces 1-bp staggered ends rather than the blunt ends.  #@NEW_LINE#@#  The staggered ends have more advantages than the blunt ends in genome editing because the staggered ends help the DNA insertion in the right direction, making genome editing more efficient and more specific.  #@NEW_LINE#@#  The short staggered ends revealed in this study shed lights on further improvement of CRISPR/Cas9 technology to increase its efficiency and specificity.  #@NEW_LINE#@#  

Materials_and_Methods  #@NEW_LINE#@#  
System_Setup  #@NEW_LINE#@#  
The initial coordinates of Cas9-sgRNA-dsDNA were taken from the Protein Data Bank (PDB code: 5F9R16).  #@NEW_LINE#@#  Compared to other DNA-bound crystal structures10,12,14,15, 5F9R has no missing residues and contains no mutations.  #@NEW_LINE#@#  Of particular note is that the dsDNA in 5F9R is trapped in a pre-cleavage state with an intact non-target strand, which is especially suitable for this study.  #@NEW_LINE#@#  However, catalytic metal ions are excluded from all the available DNA-bound crystal structures.  #@NEW_LINE#@#  Based on the two-metal-ion catalysis mechanism proposed for the RuvC domain11,12,16, two Mg2+ ions were positioned at 5- and 3-sides of the pre-Sp oxygen of the -3 phosphate (3P) or 4 phosphate (4P) (Fig 1D and Table 2), respectively, by reference to the crystal structure of Mg2+-bound RNase H in complex with an RNA/DNA hybrid (PDB code: 1ZBI)17,26,27.  #@NEW_LINE#@#  Additionally, the intermediate Mg2+ locations between 3P and 4P were also taken into account, in which one Mg2+ ion was placed close to 5-side of the pro-Sp oxygen of 3P, and the other to 3-side of the pro-Sp oxygen of 4P (Fig 1D and Table 2).  #@NEW_LINE#@#  Given that other sites except 3P and 4P are evidently too far from RuvC catalytic center, we did not introduce Mg2+ ions therein (Fig 1B,D).  #@NEW_LINE#@#  Meanwhile, we added one Mg2+ ion to the HNH domain following the one-metal-ion mechanism17,18,19.  #@NEW_LINE#@#  Note that in this crystal structure, the HNH domain active site is still considerably apart from the cleavable site on the tDNA as reflected by a distance of 17.25Å between the His840 C atom and the P atom of +3P, while the corresponding value is far higher in other target-bound structures (32~35Å)10,12,14,15.  #@NEW_LINE#@#  Each Mg2+-bound complex above was solvated with TIP3P water molecules with a thickness of 13.5Å, leading to a periodic boundary box of 139×124×187Å3.  #@NEW_LINE#@#  To mimic the reaction buffer6,9, extra 16 Mg2+ were added into the water box to generate a concentration of 10mM, and the ionic strength of KCl was set to 100mM.  #@NEW_LINE#@#  As a control, the original system without Mg2+ was also simulated (Table 2).  #@NEW_LINE#@#  The total atoms of each system add up to ~282,000.  #@NEW_LINE#@#  

Molecular_Dynamics_Simulations  #@NEW_LINE#@#  
All the simulations were performed by the AMBER15 pmemd engine with GPU acceleration37.  #@NEW_LINE#@#  The amber ff14SB force fields38 were used to describe the atomic interactions involving the protein and nucleic acids, and the recently developed ion parameter sets optimized in TIP3P water39,40 were selected for the mono- and divalent ions.  #@NEW_LINE#@#  It is noted that none of the available non-bonded models for Mg2+ ion is able to reproduce various experimental properties simultaneously; the set of Mg2+ parameters here represent the best possible compromise targeting the experimental Mg-O distance, hydration free energy as well as coordination number40.  #@NEW_LINE#@#  The non-bonded interactions were truncated at 10Å, and the long-range electrostatics were treated via the particle mesh Eward summation (PME) method41 with a grid spacing of 1Å.  #@NEW_LINE#@#  The covalent bonds involving hydrogen atoms were constrained employing the SHAKE algorithm42.  #@NEW_LINE#@#  Each simulation system was first subjected to a thorough energy minimization with the solute backbone atoms restrained, followed by slow heating from 0K to 310.15K and 10-ns equilibration in the isothermal-isochoric (NVT) ensemble with a time step of 1fs.  #@NEW_LINE#@#  The production simulations were conducted under the isothermal-isobaric (NpT) conditions using a time step of 2fs and were extended to at least 200ns (Table 2), in which the temperature was maintained at 310.15K through the Langevin thermostat and the pressure was controlled at 1.013bar by the Monte Carlo barostat.  #@NEW_LINE#@#  The trajectory snapshots were saved every 10ps.  #@NEW_LINE#@#  Except for the control system, two long parallel simulations (2×200 or 2×300 ns) and four additional short simulations (4×60 ns) with different random seeds were performed for the remaining ones (Table 2; see also Supplementary Information).  #@NEW_LINE#@#  

Cluster_Analysis  #@NEW_LINE#@#  
The representative (i.e.  #@NEW_LINE#@#  most-populated) configurations involving the double-Mg2+ coordination were determined through the cluster analysis with the package VMD43.  #@NEW_LINE#@#  For each simulation trajectory, the structure ensemble of snapshots since 40ns was grouped into four clusters by trying varying root-mean-square deviation (RMSD) cutoffs (0.61.4Å), after structural alignment on the reaction interface comprising the four catalytic residues (D10, E762, H983 and D986) on the RuvC domain, the backbone of nucleotides -3 and -4 on the ntDNA and the Mg2+ pair lying between them.  #@NEW_LINE#@#  In the final trials, the first two clusters were found to account for  greater than 90% of total population and the snapshot closest to the centroid of largest structural ensemble was extracted for comparative analysis.  #@NEW_LINE#@#  

Binding_Free_Energy_Calculations_and_Per-residue_Energy_Decomposition  #@NEW_LINE#@#  
The binding stability of the Mg2+ pair at respective positions was evaluated via the end-point Molecular Mechanics-Generalized Born Surface Area (MM-GBSA) approach29,30,31.  #@NEW_LINE#@#  Compared to the alternative Molecular Mechanics-Poisson Boltzmann Surface Area (MM-PBSA), MM-GBSA is computationally more efficient and has proved to give comparable or even better accuracy in ranking ligand affinities32,33,34.  #@NEW_LINE#@#  The energy terms were calculated via the program MMPBSA.py in AmberTools1444.  #@NEW_LINE#@#  The entropy contribution was not included here, as omission of this term does not qualitatively affect the accurate ranking of a series of ligands against the same receptor32,33,34.  #@NEW_LINE#@#  The snapshots used for MM-GBSA calculations were extracted since 40ns of the production simulation at 50-ps intervals, generating 3,600 structures for S1 to S4 and 5,600 structures for S5 and S6, respectively (Table 2).  #@NEW_LINE#@#  In each trajectory snapshot, four water molecules closest to the Mg2+ pair were consistently kept and considered as part of the Cas9-sgRNA-dsDNA receptor, while the double ions were regarded as a whole ligand.  #@NEW_LINE#@#  Meanwhile, per-residue free energy decomposition was performed to estimate the binding strengths of the RuvC active residues (viz.  #@NEW_LINE#@#  D10, E762, H983 and D986) to the Mg2+ pair.  #@NEW_LINE#@#  In the final results, we reported the block averaging over even non-overlapping trajectory sections (each containing 400 snapshots) together with the standard error of the mean.  #@NEW_LINE#@#  




