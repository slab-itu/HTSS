article id="http://dx.doi.org/10.1038/srep14637"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Feasibility of long-distance heart rate monitoring using transmittance photoplethysmographic imaging (PPGI)  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Photoplethysmography (PPG) devices are widely used for monitoring cardiovascular function.  #@NEW_LINE#@#  However, these devices require skin contact, which restricts their use to at-rest short-term monitoring.  #@NEW_LINE#@#  Photoplethysmographic imaging (PPGI) has been recently proposed as a non-contact monitoring alternative by measuring blood pulse signals across a spatial region of interest.  #@NEW_LINE#@#  Existing systems operate in reflectance mode, many of which are limited to short-distance monitoring and are prone to temporal changes in ambient illumination.  #@NEW_LINE#@#  This paper is the first study to investigate the feasibility of long-distance non-contact cardiovascular monitoring at the supermeter level using transmittance PPGI.  #@NEW_LINE#@#  For this purpose, a novel PPGI system was designed at the hardware and software level.  #@NEW_LINE#@#  Temporally coded illumination (TCI) is proposed for ambient correction, and a signal processing pipeline is proposed for PPGI signal extraction.  #@NEW_LINE#@#  Experimental results show that the processing steps yielded a substantially more pulsatile PPGI signal than the raw acquired signal, resulting in statistically significant increases in correlation to ground-truth PPG in both short-  and long-distance  monitoring.  #@NEW_LINE#@#  The results support the hypothesis that long-distance heart rate monitoring is feasible using transmittance PPGI, allowing for new possibilities of monitoring cardiovascular function in a non-contact manner.  #@NEW_LINE#@#  

Introduction  #@NEW_LINE#@#  
Photoplethysmography (PPG) is a non-invasive light-based method that has been used since the 1930s for monitoring cardiovascular activity1,2,3.  #@NEW_LINE#@#  These devices have been used to assess cardiovascular factors such as blood oxygen saturation, heart rate, autonomic function, and peripheral vascular disease2.  #@NEW_LINE#@#  Conventional contact PPG devices are fastened onto peripheral sites including the finger, ear, and toe2.  #@NEW_LINE#@#  Standard devices are comprised of either a single or multiple light-emitting diodes (LED) and a photodetector.  #@NEW_LINE#@#  These devices monitor cardiovascular activity by evaluating the change in light intensity resulting from temporal fluctuations in local blood volume.  #@NEW_LINE#@#  However, contact PPG devices are limited to single patient monitoring, resulting in increased cost per individual, and limiting the number of possible concurrent measurements.  #@NEW_LINE#@#  Furthermore, these devices produce single-point blood pulse measurements, which do not provide information about blood perfusion patterns which may be important for assessing tissue viability4.  #@NEW_LINE#@#  Finally, their contact nature makes them unsuitable for scenarios in which skin contact is problematic, such as neonatal monitoring, burn wound assessment, and sleep studies, as well as long-term continuous monitoring due to user comfort and movement artefacts2.  #@NEW_LINE#@#  
To address these issues, photoplethysmographic imaging (PPGI) systems have been proposed for non-contact heart rate monitoring.  #@NEW_LINE#@#  The goal of PPGI systems is to extract hemodynamic waveforms without intrusive tissue contact.  #@NEW_LINE#@#  Although existing designs differ, the primary components are analogous to contact PPG devices: a light source (LED) and a light detector (camera).  #@NEW_LINE#@#  Such systems rely either on active5,6,7,8,9,10 or ambient11,12,13,14,15 tissue illumination.  #@NEW_LINE#@#  Both active and ambient PPGI systems are sensitive to temporal changes in uncontrolled ambient illumination.  #@NEW_LINE#@#  Some studies mitigated this effect by using dark room settings for device validation5,7,8,10.  #@NEW_LINE#@#  Normalising ambient illumination changes using software has been proposed15, however this technique relies on a spectral estimation of the ambient illumination, which may fail in difficult lighting conditions.  #@NEW_LINE#@#  
A potential, yet largely uninvestigated, advantage of PPGI is the ability to perform long-distance monitoring (i.e., monitoring at the supermeter level).  #@NEW_LINE#@#  In contrast to existing short-distance PPGI monitoring, long-distance PPGI monitoring can enable whole-room monitoring and multi-individual assessment.  #@NEW_LINE#@#  This can be beneficial in settings such as assessing infants health conditions in a neonatal intensive care unit.  #@NEW_LINE#@#  Whole-room, multi-individual assessment is difficult or infeasible with contact PPG devices, since the devices are either are attached via a cable to a monitor, must store the data on the device, or must transmit the data wirelessly, resulting in the need for a specialised network infrastructure.  #@NEW_LINE#@#  Additionally, one contact device can only monitor one individual.  #@NEW_LINE#@#  This is also challenging in PPGI systems.  #@NEW_LINE#@#  Many existing PPGI systems operate in reflectance mode, where the camera and illumination source are positioned on the same side of the tissue under investigation.  #@NEW_LINE#@#  These reflectance PPGI systems have been limited in utility for long-distance monitoring due to two primary factors.  #@NEW_LINE#@#  First, the signal that is scattered back to the sensor is relatively low compared to the incident illumination.  #@NEW_LINE#@#  Light-tissue interaction can be summarized by the equation:  #@NEW_LINE#@#  
where I0 is the illumination incident on the skin, Rs and Rd are specular and diffuse reflectance, A is absorption and T is transmittance.  #@NEW_LINE#@#  Since the illumination source and sensor are positioned on the same side of the tissue in reflectance systems, the only component of the sensor irradiance that contains blood-related activities is Rd (some of which may have scattered prior to hemoglobin absorption), which has experienced scattering and absorption events due to the highly scattering nature of skin in visible and near infrared wavelengths16,17.  #@NEW_LINE#@#  Second, divergent illumination sources exhibit an intensity decrease proportional to the square of the distance, leading to reduced tissue irradiance at long distances.  #@NEW_LINE#@#  A second decrease happens from the tissue to the sensor, since the illumination source and sensor are positioned on the same side of the tissue in reflectance systems.  #@NEW_LINE#@#  These factors render long-distance monitoring a challenging problem in typical reflectance-based systems.  #@NEW_LINE#@#  These constraints may be alleviated using a transmittance PPGI system, where the LED is positioned behind a thin anatomical location (e.g., finger or toe), resulting in a lower number of scattering events and high hemoglobin absorption.  #@NEW_LINE#@#  To the best of the authors knowledge, this paper is the first to investigate long-distance transmittance PPGI monitoring.  #@NEW_LINE#@#  
This paper presents a pilot study to assess the feasibility of long-distance cardiovascular monitoring using transmittance PPGI.  #@NEW_LINE#@#  For this purpose, a novel non-contact transmittance PPGI system is proposed which is able to monitor cardiovascular activity remotely by correcting for ambient lighting fluctuations and extracting the subtle blood pulse signal using signal processing tools.  #@NEW_LINE#@#  This system comprises a 100fps camera, a high-powered LED (655nm), a microcontroller to synchronise frame captures and illumination, and image and signal processing software on a computer.  #@NEW_LINE#@#  Figure 1 shows a graphical representation of this system, and Figure 2 shows the processing steps.  #@NEW_LINE#@#  Temporally coded illumination (TCI) is introduced to remove ambient lighting artefacts at the acquisition level, thus correcting the data prior to further processing, similar to that introduced in our previous work18.  #@NEW_LINE#@#  The proposed PPGI system used for this study extends substantially beyond our previously reported work by incorporating a comprehensive set of signal processing steps, a larger testing sample size, and more rigorous statistical and qualitative analysis.  #@NEW_LINE#@#  The signal processing is particularly important for this study, as long-distance cardiovascular monitoring scenarios result in acquired signals with low signal-to-noise ratios (SNR).  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
Experimental_Setup  #@NEW_LINE#@#  
For this pilot study, five of the authors data (age  were collected using the proposed system.  #@NEW_LINE#@#  A 3:1 TCI code (alternating 3 frames with LED on, followed by 1 frame with LED off) was used with 100fps frame rate and 8ms exposure time.  #@NEW_LINE#@#  The aperture was manually adjusted to limit pixel saturation.  #@NEW_LINE#@#  The EasyPulse PPG device19 was used to collect the ground-truth PPG signal for validation.  #@NEW_LINE#@#  Approval for this study was obtained from the institutions office of research ethics.  #@NEW_LINE#@#  
Two experiments were performed to assess the feasibility of long-distance monitoring.  #@NEW_LINE#@#  In Experiment 1, the camera and LED were separated by 20cm, serving as short-distance base case validation.  #@NEW_LINE#@#  The participants were asked to position their fingers between the LED and camera so that their fingers covered the beam of the LED.  #@NEW_LINE#@#  In Experiment 2, the camera and LED were separated by 1.5m (long-distance), and the participants were asked to position their fingers at approximately 10cm from the LED.  #@NEW_LINE#@#  Figure 3 shows example images of both experiments before and after ambient correction.  #@NEW_LINE#@#  For each experiment, a 10s window was chosen that yielded a clean ground-truth PPG signal for validation.  #@NEW_LINE#@#  The normalised power spectral density (PSD) was computed for spectral analysis to demonstrate each signals dominant frequency components.  #@NEW_LINE#@#  In an ideal signal, the fundamental heart rate should be the dominant frequency.  #@NEW_LINE#@#  Furthermore, to assess temporal signal fidelity, the Pearsons linear correlation coefficient  was computed between PPGI and PPG signals.  #@NEW_LINE#@#  This metric is offset- and scale-invariant, suitable for the problem of comparing unit-less PPG signals:  #@NEW_LINE#@#  
where X,Y are the finger PPG and PPGI signal, XY is the covariance between the two signals, and X, Y are the standard deviations of the same variables.  #@NEW_LINE#@#  This generates a value , where 1 is perfect linear correlation, 1 is a perfect negative linear correlation, and 0 is uncorrelated.  #@NEW_LINE#@#  A perfectly reconstructed PPGI signal would yield =1, indicating that the PPGI signal is a linear scaling of the finger PPG signal.  #@NEW_LINE#@#  
The PPGI signals were statistically analysed using a novel physiologically-motivated t-test to quantify the degree to which the proposed system processing improved the signal.  #@NEW_LINE#@#  For each participant, each heart beat instance (i.e., diastole-to-diastole) was semi-automatically labeled using a custom gradient descent approach.  #@NEW_LINE#@#  was computed for each such heart beat instance, yielding n correlation values.  #@NEW_LINE#@#  In order to assess an improvement in correlation after processing, a two-tailed paired-sample t-test (=0.05) was conducted using the correlation values for each heart beat instance, yielding a p-value indicating the probability of a zero-mean difference between signal correlation.  #@NEW_LINE#@#  

Distance_Parameters  #@NEW_LINE#@#  
It is important to study the effects of distance on the optical imaging parameters, primarily resolution and illumination intensity (i.e., irradiance).  #@NEW_LINE#@#  By calculating the area imaged by a single pixel, the spatial resolution of the imaging area can be determined.  #@NEW_LINE#@#  This can be computed using the optical magnification equation:  #@NEW_LINE#@#  
where ho, hi are the object and image heights, respectively, and do, di are the distances from the lens to the object and imaging sensor, respectively.  #@NEW_LINE#@#  According to the experimental setup,  for short- and long-distance monitoring respectively, di=6mm (focal length of the lens), and hi=4.8m pixel pitch.  #@NEW_LINE#@#  Then, the field of view of a single pixel is  for short- and long-distance monitoring respectively.  #@NEW_LINE#@#  Thus, to measure a 40mm×40mm area around the fingers, the resolution is 250×250 pixels for short-distance and 33×33 pixels for long-distance monitoring, yielding acceptable imaging resolution for spatial analysis.  #@NEW_LINE#@#  
Due to the inverse-square law of electromagnetic radiation, long-distance monitoring will exhibit greatly reduced irradiance relative to the source.  #@NEW_LINE#@#  Given two objects at distances d1 and d2 (d2 greater than d1) from an illumination source, noting the inverse-square law of intensity , the change in illumination intensity can be computed as follows:  #@NEW_LINE#@#  
That is, the irradiance is reduced by a factor of 56 between long- and short-distance monitoring in the experimental setup.  #@NEW_LINE#@#  

Experiment_1__Short-Distance  #@NEW_LINE#@#  
The goal of Experiment 1 was to validate the base case short-distance setup.  #@NEW_LINE#@#  Figure 4 shows the effect of processing the PPGI signal for three participants.  #@NEW_LINE#@#  The processed PPGI signal contained amplified pulsatility over the unprocessed (raw) PPGI.  #@NEW_LINE#@#  Pulsatile signals were extracted for all five participants (P1 through P5), resulting in discernible systolic peaks of each blood pulse.  #@NEW_LINE#@#  Much of the noise was subdued upon processing.  #@NEW_LINE#@#  The high-frequency information not expected in the naturally smooth blood pulse waveforms was denoised, yielding smooth blood pulses.  #@NEW_LINE#@#  Furthermore, non-linear trends were corrected, yielding stable PPGI signals.  #@NEW_LINE#@#  These non-linear trends resulted in low correlation values between the raw PPGI and the ground-truth PPG (e.g., at 1.5s for P3).  #@NEW_LINE#@#  The processed PPGI stabilised the signal, yielding larger correlation values at those time windows.  #@NEW_LINE#@#  The heart rate was discernible in both raw and processed PPGI as a peak frequency power coincident with the PPG peak.  #@NEW_LINE#@#  However, although all PPGI signals showed strong spectral similarity to the PPG signal in the PSD, the processed PPGI signal exhibited a stronger peak at the heart rate, thus subduing extraneous frequencies.  #@NEW_LINE#@#  
Table 1 summarises the statistical results for this experiment.  #@NEW_LINE#@#  The correlation values across whole-signal comparisons were substantially increased for each participant from unprocessed (=0.25±0.21) to processed (=0.84±0.08) due to recovered stability and pulsatility.  #@NEW_LINE#@#  This indicates a large correction across the entire signal, demonstrating an overall improvement in signal fidelity.  #@NEW_LINE#@#  Statistical analysis using the heart beat instance correlation values showed a statistically significant increase in correlation for each participant .  #@NEW_LINE#@#  Thus, the resulting PPGI signal contained strong pulsatile components, enabling temporal inter-beat analysis.  #@NEW_LINE#@#  

Experiment_2__Long-Distance  #@NEW_LINE#@#  
The goal of Experiment 2 was to validate long-distance PPGI measurement for long-distance monitoring.  #@NEW_LINE#@#  Figure 5 shows the effect of processing the PPGI signal for three participants.  #@NEW_LINE#@#  The raw PPGI signals were noisy, and pulsatility was not easily discernible in the signals of P1 and P3.  #@NEW_LINE#@#  This was emphasised by the lack of a distinct peak in the PSD.  #@NEW_LINE#@#  The processed PPGI signals yielded a higher degree of pulsatility, although the signals were noisier than the short-distance measurements (discussed later).  #@NEW_LINE#@#  This pulsatility was reflected in the PSDs, where there was a distinct peak coincident with the heart rate for each participant.  #@NEW_LINE#@#  However, in cases such as P2 and P3, distinct blood pulses were not easily observed, making beat-to-beat timing analysis difficult at long-distances.  #@NEW_LINE#@#  The correlation plots showed a general increase across each participant with processing, demonstrating the increased pulsatility.  #@NEW_LINE#@#  However, there were some areas that were not improved (e.g., P3 at 67 s), largely resulting from unsuppressed noise likely due to amplified movement artefacts (discussed later).  #@NEW_LINE#@#  This high-frequency noise did not have a major effect on the PSD within the physiologically valid heart rate range.  #@NEW_LINE#@#  
Table 2 summarises the statistical results for this experiment.  #@NEW_LINE#@#  As in Experiment 1, the correlation values for whole-signal results increased from unprocessed (=0.26±0.14) to processed (=0.58±0.17), indicating recovered pulsatility and stability for an overall increase in signal fidelity.  #@NEW_LINE#@#  Statistical analysis using the heart beat instance correlation values showed a statistically significant increase in correlation for each participant except P3 .  #@NEW_LINE#@#  However, P3 exhibited substantial improvement upon processing (p=0.053).  #@NEW_LINE#@#  This emphasises the increased beat-to-beat recovery of pulsatile components.  #@NEW_LINE#@#  Overall, correlation values were lower than for short-distance monitoring, but heart rate monitoring was achieved.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
Strong results were obtained for short-distance measurement results, producing visually pulsatile signals and accurately extracting heart rate.  #@NEW_LINE#@#  Statistical significance was achieved , exemplifying the recovery of hemodynamic waveforms from a transmittance PPGI signal.  #@NEW_LINE#@#  The processed PPGI signal yielded smooth pulsatile components, making temporal beat-to-beat analysis feasible.  #@NEW_LINE#@#  For example, heart rate variability can be used as a measurement for autonomic nervous system activity20,21.  #@NEW_LINE#@#  The variability in correlation values across participants may be due to factors such as movement artefacts, and differences in scattering and absorptive media across tissues, such as melanin (skin tone) and adipose tissue22.  #@NEW_LINE#@#  
Long-distance monitoring yielded lower correlation values to ground-truth PPG than those for short-distance monitoring.  #@NEW_LINE#@#  Due to the diffuse nature of light traveling through highly scattering tissue23, the sensor irradiance is reduced, yielding weaker signals at greater distances.  #@NEW_LINE#@#  Furthermore, the area imaged by a single pixel increases with larger distances, thus small movements affected a larger number of pixels than in short-distance monitoring.  #@NEW_LINE#@#  This is apparent in the results for participant P3 (see Figure 5).  #@NEW_LINE#@#  The participants fingers were shaky, yielding high-frequency noise which the system was unable to fully remove.  #@NEW_LINE#@#  Automatic object tracking may alleviate this source of noise, During long-distance monitoring, statistical significance was achieved for heart beat instance correlation values in all but one participant (P3, p=0.053), indicating the recovery of a PPGI signal.  #@NEW_LINE#@#  
Although temporal pulsatility was extracted in some but not all cases, the fundamental heart rate was identifiable across all participants.  #@NEW_LINE#@#  This indicates that beat-to-beat timing analysis becomes difficult, but heart rate is identifiable during long-distance PPGI monitoring.  #@NEW_LINE#@#  These results validate the feasibility of long-distance heart rate monitoring, but further work must be done to demonstrate beat-to-beat temporal analysis in long-distance monitoring.  #@NEW_LINE#@#  Such an imaging system could benefit settings in which the individual exhibits low motion, such as cardiovascular monitoring during neonatal monitoring or sleep studies.  #@NEW_LINE#@#  In both settings, minimizing the amount of tissue contact is preferable.  #@NEW_LINE#@#  Such an imaging system could provide physiologically relevant information in a non-contact manner.  #@NEW_LINE#@#  Additionally, the imaging system could monitor multiple individuals within the cameras field of view by analysing each individuals signal independently, thus decreasing the per-individual cost of the system.  #@NEW_LINE#@#  
The current system is best suited for situations in which there is minimal movement, such as in neonatal monitoring and sleep studies.  #@NEW_LINE#@#  In these cases, less expensive and simpler electrical and photoplethysmographic techniques may be problematic, as they require contact with the individual.  #@NEW_LINE#@#  In the case of neonatal monitoring, the infants skin may be too fragile for contact probes, and their size may not be suited for standard equipment.  #@NEW_LINE#@#  In the case of sleep studies, unnatural contact monitoring may hamper sleep quality, which can affect the data.  #@NEW_LINE#@#  In both of these cases, non-contact long-distance monitoring can provide essential physiological monitoring without inconveniencing the user.  #@NEW_LINE#@#  
The current PPGI system has three primary limitations.  #@NEW_LINE#@#  First, very bright ambient illumination may cause pixel saturation when using a fixed aperture setting.  #@NEW_LINE#@#  This can be mitigated with the use of optical filters, and automatic camera adjustment, such as exposure time and aperture.  #@NEW_LINE#@#  Second, physical obstructions may inhibit measurements.  #@NEW_LINE#@#  Long-distance transmittance PPGI requires an unobstructed view between the illuminated tissue and the camera.  #@NEW_LINE#@#  In many situations, this can be guaranteed by affixing the camera to the ceiling.  #@NEW_LINE#@#  However, there are settings in which completely unobstructed views are infeasible, especially in natural settings.  #@NEW_LINE#@#  In these cases, more advanced setups may be explored, such as the use of mirrors.  #@NEW_LINE#@#  Third, large movements may impact results.  #@NEW_LINE#@#  Automatic object tracking can be performed to track an area on an object in space over time, yielding spatially-invariant monitoring.  #@NEW_LINE#@#  These problems are grounds for future work.  #@NEW_LINE#@#  

Methods  #@NEW_LINE#@#  
To investigate the feasibility of long-distance PPGI monitoring, a non-contact PPGI system is proposed whose design integrates hardware (active illumination, a camera, and synchronisation electronics) and software (image and signal processing).  #@NEW_LINE#@#  Figure 1 depicts a graphical overview of the proposed PPGI system.  #@NEW_LINE#@#  A participants fingers were placed between a high-power LED (Philips LUXEON Rebel, 655nm, 580mW) and a camera (PointGrey Flea3, 100fps) with a 6mm lens.  #@NEW_LINE#@#  The camera frames and LED illumination patterns were synchronised by a microcontroller (MCU) and custom electronics.  #@NEW_LINE#@#  Temporally coded illumination (TCI) is proposed for controlling this illumination sequence.  #@NEW_LINE#@#  Figure 2 shows the stages of processing to yield the final PPGI signal.  #@NEW_LINE#@#  The following subsections provide detailed descriptions of the processing steps.  #@NEW_LINE#@#  
Light_Transport_Model  #@NEW_LINE#@#  
A temporal extension of the Beer-Lambert law (BLL) was used.  #@NEW_LINE#@#  The BLL shows that the attenuation of light follows an exponentially decay as it passes through a homogeneous light-absorbing medium:  #@NEW_LINE#@#  
where T is transmittance, I0 is incident light, I is transmitted light,  is the tabulated molar extinction coefficient for the light-absorbing medium (e.g., oxyhemoglobin), l is the photon path length, and c is the concentration of the medium.  #@NEW_LINE#@#  The temporal transmittance can be written as a function of time t:  #@NEW_LINE#@#  
The path length for oxyhemoglobin is the dominant temporally changing parameter in heart beat analysis3.  #@NEW_LINE#@#  The standard measurement signal for PPG analysis is absorbance, which is related to transmittance as A=log(T).  #@NEW_LINE#@#  Then, expressing this as temporal absorbance yields:  #@NEW_LINE#@#  
This model assumes constant ambient conditions.  #@NEW_LINE#@#  However, I(t) may be affected by temporal changes in ambient illumination, potentially corrupting the subtle blood pulse signal.  #@NEW_LINE#@#  Thus, in the next section, an ambient correction method is proposed.  #@NEW_LINE#@#  

Temporally_Coded_Illumination_(TCI)  #@NEW_LINE#@#  
A TCI process is proposed to remove the effect of ambient light changes in the data, thus ensuring that the reflectance signal is due solely to the controlled active illumination (e.g., LED).  #@NEW_LINE#@#  A dual-mode temporal code was defined by which frames contain irradiance due to either ambient illumination or a combination of ambient and active illumination.  #@NEW_LINE#@#  By coding the illumination synchronously with frame captures, ambient measurements can be performed according to the temporal code, and subtracted from the actively illuminated frames.  #@NEW_LINE#@#  For example, a temporal code of 3:1 defines a TCI sequence that measures one ambient frame after every three actively illuminated frames.  #@NEW_LINE#@#  Figure 1 shows a graphical example of 3:1 TCI.  #@NEW_LINE#@#  
Mathematically, given an intensity image I(t) at time t, according to the TCI sequence, I(t) can either be:  #@NEW_LINE#@#  
where Iamb(t) and Iact(t) are the irradiance due to ambient illumination and active illumination, respectively.  #@NEW_LINE#@#  Then, given a recently acquired ambient frame Iamb(tt), by modeling light reflectance as a linear combination of ambient and active lighting, the ambient correction can be applied to the current frame:  #@NEW_LINE#@#  
With a fast frame rate, t becomes negligible, yielding illumination due solely to controlled active illumination:  #@NEW_LINE#@#  
Since the camera operates at 100fps, t approximately satisfies this condition (t=10ms).  #@NEW_LINE#@#  Substituting equation (9) into equation (7) yields the ambient-corrected absorbance measurement:  #@NEW_LINE#@#  
Once the ambient frame Iamb(t) was acquired, the previously acquired active frame I(tt) was used in its place to ensure constant frame rate for frequency analysis.  #@NEW_LINE#@#  
TCI was implemented at the hardware level, and requires control of an active light source.  #@NEW_LINE#@#  Thus an active illumination system was chosen.  #@NEW_LINE#@#  Camera and illumination synchronisation was performed using custom circuitry and microcontroller code.  #@NEW_LINE#@#  Figure 3 shows the results of ambient correction via TCI on a single frame.  #@NEW_LINE#@#  Video 1 and Video 2 demonstrate ambient correction across a series of frames with varying incident light.  #@NEW_LINE#@#  

Signal_Processing  #@NEW_LINE#@#  
Capturing data using the given light transport model and TCI yields an ambient-corrected PPGI signal.  #@NEW_LINE#@#  However, this signal may still be affected by various sources of noise.  #@NEW_LINE#@#  This section proposes a signal processing pipeline for extracting a stable pulsatile PPGI signal.  #@NEW_LINE#@#  First, a denoising step is proposed, which reduces the noise based on camera and process characteristics.  #@NEW_LINE#@#  Second, a detrending step is proposed, which removes trends in intensity due to external factors such as movement.  #@NEW_LINE#@#  This processing was performed using the average pixel intensity across a manually selected region of interest across the imaged fingers.  #@NEW_LINE#@#  See Figure 2 for a graphical depiction of this process.  #@NEW_LINE#@#  

Denoising  #@NEW_LINE#@#  
The goal of signal denoising is to recover the smooth blood pulse waveform from a noisy signal.  #@NEW_LINE#@#  Kalman filtering24 was used since its model is consistent with PPGI denoising.  #@NEW_LINE#@#  First, its noise model assumes a combination of measurement noise and process noise.  #@NEW_LINE#@#  In this setup, measurement noise models camera read noise, and process noise models the stochastic process of light-tissue interaction.  #@NEW_LINE#@#  Second, Kalman filtering is a recursive algorithm that can operate in real-time, as denoising at time t depends only on the state and uncertainty matrix at time t1.  #@NEW_LINE#@#  Third, Kalman filtering models the system state based on Newtons laws of physics, which describe smooth motion.  #@NEW_LINE#@#  This is well-suited for denoising PPGI signals, as blood pulse waveforms are inherently smooth in nature, with varying temporal acceleration.  #@NEW_LINE#@#  
Kalman filtering requires as inputs the system state and noise statistics.  #@NEW_LINE#@#  The system state was defined using Newtons laws of motion using the raw camera intensity values:  #@NEW_LINE#@#  
where, at time point k, Ik is signal amplitude,  is the rate of change of the amplitude, and  is acceleration of amplitude change.  #@NEW_LINE#@#  The measurement noise was assessed by imaging a dark field and quantifying the standard deviation of pixel intensities m across the sensor.  #@NEW_LINE#@#  During the experiments, m=1.02 for 8bit pixel values and 8ms integration time.  #@NEW_LINE#@#  Denoising was performed on the raw camera signal I(t) rather than the computed absorbance signal A(t) since m was learned using the untransformed raw camera intensity values.  #@NEW_LINE#@#  
Process noise is more difficult to model due to the complex and stochastic interaction of light with tissue.  #@NEW_LINE#@#  Thus, a grid search optimisation was performed to assess the optimal process noise value p using 8ms exposure time.  #@NEW_LINE#@#  Using a fixed measurement noise model and a training data set, a logarithmic grid search was performed over various values for p. The parameter value that yielded the highest correlation to the ground-truth PPG signal was chosen, resulting in p=1.84×102 for 8bit pixels.  #@NEW_LINE#@#  This denoising process was then performed on the acquired signal using the standard recursive predict-update Kalman optimisation24.  #@NEW_LINE#@#  For each time point, the denoised intensity signal was extracted using an observation matrix:  #@NEW_LINE#@#  
where H=[10]T, and  is the estimated true system state at time point k. Plugging this into equation (7) yields the denoised absorbance signal:  #@NEW_LINE#@#  

Detrending  #@NEW_LINE#@#  
The denoising process assumes constant incident illumination, which is an invalid assumption during movement.  #@NEW_LINE#@#  The goal of this detrending step is to remove oscillations in the signal, yielding a PPGI signal with constant mean.  #@NEW_LINE#@#  It was assumed that movements are relatively smooth over time.  #@NEW_LINE#@#  A detrending algorithm was used on the denoised absorbance signal A(t) from equation (14), in which the model assumes a smoothness prior25.  #@NEW_LINE#@#  In particular, the observed signal A(t) is modeled as the linear combination of the true absorbance signal Atrue(t) and a temporal trend Atrend(t).  #@NEW_LINE#@#  
Given that A(t) is measured, Atrue(t) can be solved by estimating Atrend(t) assuming a linear model, subtracting it from A(t), and solving this using regularised least squares, which provides the following estimate of the true detrended signal:  #@NEW_LINE#@#  
where I is the identity matrix,  is a relative weighting term, and D2 is the discrete approximation matrix of the second derivative.  #@NEW_LINE#@#  Figure 6 shows the recovery of a stable signal from a signal corrupted by movement using this detrending method.  #@NEW_LINE#@#  is the final processed PPGI signal.  #@NEW_LINE#@#  




