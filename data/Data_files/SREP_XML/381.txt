article id="http://dx.doi.org/10.1038/srep32706"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Automated Tubule Nuclei Quantification and Correlation with Oncotype DX risk categories in ER+ Breast Cancer Whole Slide Images  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Early stage estrogen receptor positive (ER+) breast cancer (BCa) treatment is based on the presumed aggressiveness and likelihood of cancer recurrence.  #@NEW_LINE#@#  Oncotype DX (ODX) and other gene expression tests have allowed for distinguishing the more aggressive ER+ BCa requiring adjuvant chemotherapy from the less aggressive cancers benefiting from hormonal therapy alone.  #@NEW_LINE#@#  However these tests are expensive, tissue destructive and require specialized facilities.  #@NEW_LINE#@#  Interestingly BCa grade has been shown to be correlated with the ODX risk score.  #@NEW_LINE#@#  Unfortunately Bloom-Richardson (BR) grade determined by pathologists can be variable.  #@NEW_LINE#@#  A constituent category in BR grading is tubule formation.  #@NEW_LINE#@#  This study aims to develop a deep learning classifier to automatically identify tubule nuclei from whole slide images (WSI) of ER+ BCa, the hypothesis being that the ratio of tubule nuclei to overall number of nuclei (a tubule formation indicator - TFI) correlates with the corresponding ODX risk categories.  #@NEW_LINE#@#  This correlation was assessed in 7513 fields extracted from 174 WSI.  #@NEW_LINE#@#  The results suggests that low ODX/BR cases have a larger TFI than high ODX/BR cases (pless_than0.01).  #@NEW_LINE#@#  The low ODX/BR cases also presented a larger TFI than that obtained for the rest of cases (pless_than0.05).  #@NEW_LINE#@#  Finally, the high ODX/BR cases have a significantly smaller TFI than that obtained for the rest of cases (pless_than0.01).  #@NEW_LINE#@#  

Introduction  #@NEW_LINE#@#  
The primary conundrum in treatment and management of early stage estrogen receptor positive (ER+) breast cancer (BCa) is identifying which of these cancers are candidates for adjuvant chemotherapy and which patients will respond to hormonal therapy alone.  #@NEW_LINE#@#  ODX and other gene expression tests have allowed for distinguishing the more aggressive ER+ BCa requiring adjuvant chemotherapy from the less aggressive cancer benefiting from hormonal therapy alone.  #@NEW_LINE#@#  However these gene expression tests tend to be expensive, tissue destructive and require physical shipping of tissue blocks for the test to be done.  #@NEW_LINE#@#  Interestingly BCa grade in these tumors has been shown to be highly correlated with the ODX risk score1,2,3.  #@NEW_LINE#@#  Unfortunately studies have shown that Bloom Richarsdon (BR) grade determined by pathologists can be highly variable4.  #@NEW_LINE#@#  The three constituent categories within the BR grading system are mitotic index, tubule formation and nuclear pleomorphism.  #@NEW_LINE#@#  Tubule formation is defined as the percentage of cancer tissue that still contains normal tubules.  #@NEW_LINE#@#  According to Elston and Ellis guidelines5, tumor cell clusters with glandular formation are also counted (Fig 1 shows some examples of tubule delineations for low and high risk BCa).  #@NEW_LINE#@#  Tubule scoring is determined by estimating tubule area and assigning to one of three categories: (i)  greater than 75%, (ii) between 1075%, and (iii) less_than10%.  #@NEW_LINE#@#  However, this estimation is highly influenced by experience of the pathologist.  #@NEW_LINE#@#  Additionally, previous studies have shown the correlation between manually determined tubule score and ER+ breast cancer prognosis and ODX risk categories6,7.  #@NEW_LINE#@#  
Since histologic criteria (such as tubule, nuclei pleomorphism, and mitotic activity) are used in pathological grading systems, several works using automated extraction algorithms have been proposed to quantify such criteria8.  #@NEW_LINE#@#  Tubule detection has been previously addressed in the literature9,10,11.  #@NEW_LINE#@#  Typically these approaches focus on the identification of tubule lumen (see Fig 1).  #@NEW_LINE#@#  Strategies focused on identifying tubules based off the lumen present a couple of challenges.  #@NEW_LINE#@#  Firstly the shape and size variability of the gland lumen makes accurate modeling of the tubules difficult.  #@NEW_LINE#@#  Secondly several structures, besides tubules, also contain lumen, i.e., blood vessels and other types of glands.  #@NEW_LINE#@#  Morphological operators have been used to connect proximal cancerous cells and generate blob structures9.  #@NEW_LINE#@#  These blobs were identified as tubules when they were found to be surrounding a white space or lumen.  #@NEW_LINE#@#  Another approach using the OCallaghan neighborhood graph to impose structural constraints on lumen, allowed for identification of true lumen with an accuracy of 86%10.  #@NEW_LINE#@#  An accuracy of 89% was obtained in the classification task of low (tubular BR score 2 and 3) and high tubule formation (tubular BR score 1).  #@NEW_LINE#@#  A similar strategy, using k-means to identify lumen followed by a level set based segmentation approach enabled the identification of the surrounding nuclei layer11.  #@NEW_LINE#@#  
The deep neural network (DNN) is a deep learning architecture that comprises more than two hidden layers.  #@NEW_LINE#@#  In supervised classification settings, a DNN uses the backpropagation algorithm to update its internal weights according to the label of input exemplars12.  #@NEW_LINE#@#  Some applications of the DNNs in histological image analysis include the mitosis identification task13 and the localization of regions of interest in histological images14.  #@NEW_LINE#@#  
With the recent emergence of whole slide tissue scanning and digital pathology15,16,17 there has been substantial interest in developing automated computerized histologic predictors of tumor grade and outcome for several diseases including oropharyngeal squamous cell carcinoma18, prostate cancer19,20 and glioblastoma21.  #@NEW_LINE#@#  The correlation of computerized extracted features with breast cancer survival has also been explored.  #@NEW_LINE#@#  Beck et al.22 performed a comprehensive analysis of several automatically quantified morphological features and their relationship with breast cancer survival.  #@NEW_LINE#@#  The authors reported a strong association of automatically extracted stromal features with survival in a set of 576 H&E breast cancer tissue microarray (TMA) images.  #@NEW_LINE#@#  Tambasco et al.23 used fractal analysis to compute the morphological complexity of 379 pan-cytokeratin stained TMA images.  #@NEW_LINE#@#  A significant association of survival with the computed fractal dimension was found.  #@NEW_LINE#@#  The correlation of automated extracted features with Oncotype DX risk score and risk categories has been investigated in a couple of studies.  #@NEW_LINE#@#  Basavanhally et al.24 showed that nuclear graphs built using Delaunay triangulation and minimum spanning trees can be used to distinguish breast cancer images with low and high recurrence ODX scores (RS).  #@NEW_LINE#@#  The authors used 37 H&E stained images from a cohort of 17 patients at 20× magnification and obtained a mean accuracy of 84.15% in distinguishing samples with low and high RS.  #@NEW_LINE#@#  Also, the combination of computer extracted features from both H&E and CD34 IHC stained images in a cohort of 29 patients (9 with low RS, 11 intermediate RS and 9 with high RS)25 was shown to distinguish high and low ODX risk patients.  #@NEW_LINE#@#  The authors reported an average classifier accuracy of 91% for distinguishing high and low RS cases.  #@NEW_LINE#@#  Other studies have explored the association between manually identified pathological measurements (e.g.  #@NEW_LINE#@#  nuclei grade, mitotic index, tubule degree) and the Oncotype DX score.  #@NEW_LINE#@#  Both Flanagan et al.6 and Klein et al.7 used regression analysis to obtain a set of equations that predicts Oncotype DX score based on histological variables such as nuclei grade, mitotic index, tubule formation degree among others.  #@NEW_LINE#@#  After eliminating cases from the intermediate risk category, concordance between the ODX score and the estimated score (using the obtained equations) range from 96.9% to 100%.  #@NEW_LINE#@#  
The contributions of the work presented in this paper are twofold.  #@NEW_LINE#@#  Firstly we aim to evaluate a customized DNN for automatic quantification of tubules in whole slide images (WSI).  #@NEW_LINE#@#  Secondly we seek to evaluate whether tubule score automatically identified by the DNN is correlated with the risk categories determined by ODX in a cohort of 174 patients.  #@NEW_LINE#@#  Our approach comprises the following main steps.  #@NEW_LINE#@#  First, a blue ratio transform is used to detect nuclei candidates.  #@NEW_LINE#@#  Image patches, each containing a nucleus, are then extracted.  #@NEW_LINE#@#  These patches are manually labeled as containing a tubule or not.  #@NEW_LINE#@#  The patches are used to train a DNN classifier to identify tubule nuclei in WSI.  #@NEW_LINE#@#  After tubule nuclei identification, the ratio between tubule nuclei and overall number of nuclei is computed as a tubule formation indicator (TFI).  #@NEW_LINE#@#  
The rest of this paper is organized as follows: Section 2 describes the methodology used for training and testing the DNN tubule nuclei classifier.  #@NEW_LINE#@#  Section 3 presents the experimental design to study the correlation of the TFI with ODX risk categories.  #@NEW_LINE#@#  Section 4 describes the results of the statistical experiments and the distribution of the TFI for the ER+ BCa cases.  #@NEW_LINE#@#  Finally, in Section 5 we present the main conclusions of our work.  #@NEW_LINE#@#  

Methodology  #@NEW_LINE#@#  
The whole methodology to use the automated TFI to study its correlation with ODX score and BR grading in WSI is presented in Fig 2.  #@NEW_LINE#@#  
Nuclei_detection  #@NEW_LINE#@#  
First, an automated algorithm based on blue ratio transformation26 is used to detect nuclei.  #@NEW_LINE#@#  After computing the blue ratio transform, a global threshold computed by using Otsus method27 is used to obtain a binary image.  #@NEW_LINE#@#  Then, an opening operation is applied.  #@NEW_LINE#@#  The centroid of each connected component corresponds to the centroid of a nucleus candidate.  #@NEW_LINE#@#  The nuclei detection algorithm is a lightweight method that provides a nuclei rough estimation that was found to be representative of the true nuclei population in terms of the TFI, as shown by the experiments described in the supplementary information.  #@NEW_LINE#@#  

Curating_the_Learning_Set  #@NEW_LINE#@#  
An RGB patch is extracted (size 64×64 at 20x magnification with a spatial resolution of approximately 0.5m per pixel) around the centroid of each candidate nuclei.  #@NEW_LINE#@#  This patch is labeled as either tubule or not, according to an annotation supplied by an expert pathologist (The expert breast pathologist annotation corresponds to a manual delineation of each tubule).  #@NEW_LINE#@#  These pathologist annotated patches are then used to train the DNN classifier.  #@NEW_LINE#@#  Exemplar RGB patches belonging to the tubule class and non-tubule class are presented in Fig 3.  #@NEW_LINE#@#  
The DNN architecture is illustrated in Fig 4 and is composed of three blocks: a convolution neural network (CNN), a Rectifier Linear Unit (ReLU) and a maximum pool (max pool) operator.  #@NEW_LINE#@#  Finally, two fully connected layers yield the probability representing the membership of the nucleus to the tubule class.  #@NEW_LINE#@#  

Independent_testing_of_the_DNN_classifier  #@NEW_LINE#@#  
During testing, the nuclei detection algorithm is used to identify candidate nuclear centroids.  #@NEW_LINE#@#  These patches then fed to the DNN, as shown in Fig 4.  #@NEW_LINE#@#  This process enables the generation of their tubule class membership probability.  #@NEW_LINE#@#  If the probability is higher than 0.5, the patch is assigned to the tubule class.  #@NEW_LINE#@#  
The DNN performance was evaluated on a dataset with 61 high power fields that were extracted from 11 WSI.  #@NEW_LINE#@#  Whole tubule structures (including epidermis surrounding the lumen) had been previously annotated by an expert pathologist.  #@NEW_LINE#@#  A 5-fold cross validation setup was used, ensuring each fold was split at the patient level.  #@NEW_LINE#@#  
Evaluation measures (Fscore, precision, recall (sensitivity) and specificity for the tubule nuclei class28) were computed for each of the 5-folds.  #@NEW_LINE#@#  The average +/ standard deviation of the Fscore, precision, recall and specificity were: 0.59±0.14, 0.72±0.12, 0.56±0.2 and 0.9±0.06 respectively (see Fig 5).  #@NEW_LINE#@#  
Observe that the recall for the tubule identification is lower than the specificity, indicating that a classification error is more likely for a tubule nuclei than for a non-tubule nuclei.  #@NEW_LINE#@#  Also, the variability of tubule sizes and shapes may explain the higher standard deviation obtained with the recall measure.  #@NEW_LINE#@#  Detailed results for each fold are presented in Table 1.  #@NEW_LINE#@#  
The detection results in Table 1 suggest that the tubule detector has a high specificity, a finding that might be caused by the unbalanced nature of the problem (there is a larger number of non-tubule nuclei as opposed to tubule nuclei in the BCa specimens).  #@NEW_LINE#@#  Also the tubule nuclei exhibit a substantially large inter-subject variation.  #@NEW_LINE#@#  The tubule nuclei samples used during training might not be adequate to capture all the variability observed in tubules from different patients.  #@NEW_LINE#@#  


Experimental_Design  #@NEW_LINE#@#  
Data_Description  #@NEW_LINE#@#  
A set of WSI extracted from 174 patients with ER+ BCa were used in this study.  #@NEW_LINE#@#  At most 50 high power fields per WSI were selected: the selected high power fields were those with the lower number of tubule nuclei ratio.  #@NEW_LINE#@#  This selection avoids high power fields with unusually large number of detected tubule nuclei (outliers).  #@NEW_LINE#@#  All of these high power fields were sampled from cancerous regions previously identified by an expert pathologist.  #@NEW_LINE#@#  

Correlation_with_ODX_risk_groups_via_t-test_analyses  #@NEW_LINE#@#  
After identifying the tubule nuclei the TFI was computed: the ratio between the tubule nuclei and the total number of nuclei.  #@NEW_LINE#@#  This TFI is evaluated as a potential risk predictor.  #@NEW_LINE#@#  
In order to compare the TFI with the risk associated to each BCa sample, the set was divided into a) High, b) Intermediate and c) Low risk categories according to the ODX score.  #@NEW_LINE#@#  Additionally, the BR grade is also used to define: d) The high ODX-high grade group (with both high ODX and BR score-HH), e) The low ODX-low grade group (with both low ODX and BR score-LL), f) All the BCa cases that dont belong to the HH group (HHc group) and g) All the BCa cases that dont belong to the LL group (LLc group).  #@NEW_LINE#@#  The dataset categorization is indicated in Table 2.  #@NEW_LINE#@#  
The t-test statistical analysis was applied to compare the distribution of the automated TFI with the high, intermediate and low ODX risk groups as well as the BCa cases with both a high ODX score and high grade and also cases with both low ODx score and low BR grade.  #@NEW_LINE#@#  The t-test for all the experiments was performed with equal mean and unequal variance hypothesis.  #@NEW_LINE#@#  Specifically, the t-test was applied to compare the different groups as described below:  #@NEW_LINE#@#  

Correlation_with_ODX_risk_groups_via_ROC_analysis  #@NEW_LINE#@#  
The risk prediction capability of the TFI was also evaluated using a Receiver Operating Curve (ROC).  #@NEW_LINE#@#  For doing so, the binary classification task was based solely in the tubule nuclei ratio: each WSI with a mean tubule ratio above a particular threshold is classified as low ODX.  #@NEW_LINE#@#  By varying the threshold from [0, 1] is possible to generate the ROC curve.  #@NEW_LINE#@#  In this particular experiment the goal was to distinguish the HH and LL categories (see Table 2).  #@NEW_LINE#@#  


Results  #@NEW_LINE#@#  
Correlation_with_ODX_and_BR_risk_categories_via_t-test_analyses  #@NEW_LINE#@#  
The DNN classifier was applied to the 174 WSI previously described.  #@NEW_LINE#@#  Qualitative results for high, intermediate and low ODX cases can be seen in the Fig 6.  #@NEW_LINE#@#  The significant t-test results for the comparison between the risk groups is presented in Table 3.  #@NEW_LINE#@#  
When observing the group distribution according to ODX score, it is difficult to distinguish between low and high ODX groups.  #@NEW_LINE#@#  However, when combined ODX and BR groups are analyzed, the high and low risk groups show different distributions as shown in Fig 7.  #@NEW_LINE#@#  
Results in Fig 7 reveal that the automated TFI is significantly different for the groups that have low ODX-low grade and high ODX-high grade.  #@NEW_LINE#@#  The HH group had a mean tubule nuclei ratio per high power field of 0.029.  #@NEW_LINE#@#  In contrast, the LL group had a mean tubule nuclei ratio of 0.126.  #@NEW_LINE#@#  The two groups are significantly different (pless_than0.01 with 95% CI [0.04, 0.16]).  #@NEW_LINE#@#  The differences in the TFI is still significant when we compare the HH group against the BCa cases that did not belong to this group (pless_than0.01 with 95% CI[0.013, 0.085]).  #@NEW_LINE#@#  The mean for non HH cases was 0.078.  #@NEW_LINE#@#  Finally, the difference in the average TFI value was also significant when comparing the LL group with the BCa cases outside this group (pless_than0.05 with 95% CI[0.014, 0.12]).  #@NEW_LINE#@#  The cases that did not belong to the LL group had a mean tubule nuclei ratio of 0.057.  #@NEW_LINE#@#  

Correlation_with_ODX_and_BR_risk_categories_via_ROC_curve  #@NEW_LINE#@#  
The distribution of the histologic images (ODX score vs tubule nuclei ratio) for the HH and LL groups is shown in the left column of Fig 8.  #@NEW_LINE#@#  While a low mean tubule nuclei ratio appears to require additional analysis to determine its risk category, it is observed that a WSI with a high tubule nuclei ratio is very likely to be member of the low ODX risk category.  #@NEW_LINE#@#  
The Receiver Operating Curve (ROC) for the binary classification task using only mean tubule nuclei ratio for each WSI is presented in the right column of Fig 8.  #@NEW_LINE#@#  The WSI with a mean tubule ratio above the threshold is classified as low ODX.  #@NEW_LINE#@#  The ROC curve shows that the tubule nuclei ratio yields an area under the curve (AUC) of 0.76 in distinguishing the low ODX-low grade from the high ODx-high grade categories.  #@NEW_LINE#@#  

Concluding_Remarks  #@NEW_LINE#@#  
In this paper we rigorously investigated the problem of objectively computing the tubule nuclei ratio, a potential computational histologic image biomarker of disease risk and aggressiveness in ER+ BCa.  #@NEW_LINE#@#  To evaluate whether automatically TFI was associated with the risk category determined by the Oncotype DX test, a deep learning classifier was developed to automatically identify tubules based off the surrounding nuclei.  #@NEW_LINE#@#  The automatically determined TFI was then evaluated in terms of its ability to distinguish the low and high ODX risk categories and cases with different permutations of ODX risk and grade.  #@NEW_LINE#@#  On a cohort of 174 WSI, the TFI was found to be significantly different for the BCa cases with low ODX-low grade and high ODX-high grade.  #@NEW_LINE#@#  When comparing the high ODX-high grade group with all the other BCa cases, the TFI was still significantly lower.  #@NEW_LINE#@#  Likewise, the calculated tubule quantification measure was larger in the BCa cases with low ODX-low grade compared to the remaining BCa cases.  #@NEW_LINE#@#  
The automated TFI appears to have a slightly weaker correlation with ODX risk categories than other previously investigated computerized image features such as nuclear architecture24.  #@NEW_LINE#@#  However it has been previously shown that using a combination of automated features (even extracted from differently stained samples from the same patient), might increase the ability to predict the corresponding ODX risk category25.  #@NEW_LINE#@#  Hence, developing strategies to integrate information from predictors that use different histological features (e.g.  #@NEW_LINE#@#  nuclear architecture, mitotic count, tubule density) will be a future research endeavor.  #@NEW_LINE#@#  
Automated tubule quantification could be potentially useful in streamlining clinical pathology workflows.  #@NEW_LINE#@#  The automated quantification aims to standardize the breast cancer grading and risk assessment process and reduce inter-reader variability.  #@NEW_LINE#@#  Our newly presented method was evaluated within manually selected cancerous regions.  #@NEW_LINE#@#  However, automatic delineation of regions of diagnostic interest is an open research problem14.  #@NEW_LINE#@#  Future work will focus on improving the tubule detector performance, validating our approach on larger test cohorts and incorporating automatic region of interest selection methods.  #@NEW_LINE#@#  




