article id="http://dx.doi.org/10.1038/srep13616"  #@NEW_LINE#@#  
title  #@NEW_LINE#@#  
Sequential Self-Folding Structures by 3D Printed Digital Shape Memory Polymers  #@NEW_LINE#@#  

Abstract  #@NEW_LINE#@#  
Folding is ubiquitous in nature with examples ranging from the formation of cellular components to winged insects.  #@NEW_LINE#@#  It finds technological applications including packaging of solar cells and space structures, deployable biomedical devices, and self-assembling robots and airbags.  #@NEW_LINE#@#  Here we demonstrate sequential self-folding structures realized by thermal activation of spatially-variable patterns that are 3D printed with digital shape memory polymers, which are digital materials with different shape memory behaviors.  #@NEW_LINE#@#  The time-dependent behavior of each polymer allows the temporal sequencing of activation when the structure is subjected to a uniform temperature.  #@NEW_LINE#@#  This is demonstrated via a series of 3D printed structures that respond rapidly to a thermal stimulus, and self-fold to specified shapes in controlled shape changing sequences.  #@NEW_LINE#@#  Measurements of the spatial and temporal nature of self-folding structures are in good agreement with the companion finite element simulations.  #@NEW_LINE#@#  A simplified reduced-order model is also developed to rapidly and accurately describe the self-folding physics.  #@NEW_LINE#@#  An important aspect of self-folding is the management of self-collisions, where different portions of the folding structure contact and then block further folding.  #@NEW_LINE#@#  A metric is developed to predict collisions and is used together with the reduced-order model to design self-folding structures that lock themselves into stable desired configurations.  #@NEW_LINE#@#  

Introduction  #@NEW_LINE#@#  
Folding and unfolding are one of the most important mechanisms for generating large deformation and motions in nature, with a plethora of examples such as the winged insects1 and tree leaves2,3,4.  #@NEW_LINE#@#  In recent years, folding has attracted increasing interest for technological applications.  #@NEW_LINE#@#  A contemporary example is origami5, the ancient art of paper folding that has found increasing engineering applications ranging from space exploration6, foldable photovoltaics7 and batteries8, to shopping bags9,10, biomedical devices11,12,13, and metamaterials14.  #@NEW_LINE#@#  Complimentary theoretical work shows that the controlled folding and unfolding are complicated due to the independent folding motions of individual folds.  #@NEW_LINE#@#  Self-folding is more attractive in many applications as it saves the expensive infrastructure investment, such as robotic arms, to automate the folding10.  #@NEW_LINE#@#  Several self-folding mechanisms have been developed, such as using residual stress15,16,17, shape memory alloy actuation18, DNA19 and hydrogels20.  #@NEW_LINE#@#  More recently, 3D printing technology is used to print active structures, leading to the emergence of 4D printing21,22,23,24,25.  #@NEW_LINE#@#  These works demonstrated structures and machines that are modular, self-assembled, self-reconfigurable, and capable of adapting to their environments.  #@NEW_LINE#@#  
Shape memory polymers (SMPs) are smart materials that can recover their permanent shapes from one (or sometimes multiple) programmed temporary shape(s) when an appropriate stimulus is applied, such as temperature26,27,28,29,30, magnetic fields31,32,33, and light34,35,36,37.  #@NEW_LINE#@#  Since this type of smart materials has the potential to sense environmental changes and react accordingly in a predetermined sequence, they are promising candidates for spontaneous configuration-changing applications.  #@NEW_LINE#@#  Besides, they can be chemically tuned to achieve biocompatibility and biodegradability, and hence have been studied extensively for biomedical and aerospace applications38,39,40,41.  #@NEW_LINE#@#  Recently, shape memory polymers have been used to self-fold flat sheets into target structures.  #@NEW_LINE#@#  Dickey and co-workers42,43 demonstrated self-folding of a SMP sheet activated by unfocused light where photo-absorbing inks were printed on the SMP surface to convert light energy into heat.  #@NEW_LINE#@#  Felton et al.44 further developed this concept and developed self-folding robots and structures by using similar SMPs.  #@NEW_LINE#@#  Our group21,22 applied 4D printing technology to design and fabricate active origami where a flat printed sheet can be folded into a 3D structure.  #@NEW_LINE#@#  There, shape memory polymer fibers were precisely printed into an elastomeric matrix to create an active composite that was used to fabricate integrated hinges to enable origami folding structures.  #@NEW_LINE#@#  Generally, the above mentioned self-folding origami structures have relatively simple folding patterns so that different folding parts would not collide with each other, rendering the folding kinetics inconsequential in terms of realization of the desired final configuration.  #@NEW_LINE#@#  However, this is not generally the case.  #@NEW_LINE#@#  One can easily envision what appear to be simple self-folding structures that cannot actually fold themselves (as we will show in this work) because the final configuration depends on the sequence of folding of the individual pieces due to self-collisions and contact that can occur.  #@NEW_LINE#@#  In the recent exciting work by Felton et al.45,46, folding patterns were achieved by using a computer to control the activation of a sequence of heaters that are attached to individual hinges; essentially this provides a time-dependent, spatially nonuniform temperature profile to actuate the SMP hinges in a prescribed sequence.  #@NEW_LINE#@#  
In this work we propose an alternative and in some ways simpler method to create sequentially self-folding structures by 3D printing hinges with digital SMPs into components.  #@NEW_LINE#@#  We avoid the use of complicated localized heating systems and actuate the sequenced folding with a spatially uniform temperature field.  #@NEW_LINE#@#  The proposed method involves 3D printing hinges from digital SMP materials that can self-fold at prescribed speeds, which are controlled by the thermomechanical properties of the individual SMPs and a prescribed thermomechanical training protocol.  #@NEW_LINE#@#  The so-called digital SMPs are digital materials that are formed by mixing two base materials at specific ratios on a digital voxelized domain to achieve prescribed thermomechanical and shape memory behaviors.  #@NEW_LINE#@#  We demonstrate the concept by designing and fabricating a series of complex self-folding structures and showing how we can control the folding by using SMPs with a uniform spatial temperature.  #@NEW_LINE#@#  A reduced-order model (ROM) is also developed with a metric to predict self-collisions of folding parts to simulate the folding process.  #@NEW_LINE#@#  We show this model is in good agreement with experiments and companion high-fidelity finite element simulations, and hence can be used to design self-folding and self-locking structures.  #@NEW_LINE#@#  

Results  #@NEW_LINE#@#  
Hinge_Folding  #@NEW_LINE#@#  
Hinges designed with digital SMPs with specified thermomechanical behaviors, especially recovery, are the key element of sequentially self-folding structures (shown in the inset of Fig 1a).  #@NEW_LINE#@#  We design, fabricate, and test hinges using seven different digital SMPs.  #@NEW_LINE#@#  We use H-i (i=1, 2, 3 7) to represent the i-th hinge material and the hinges all have a thickness of 0.8mm and a width of 6mm.  #@NEW_LINE#@#  The glass transition temperatures (Tgs, see the Method for details) of these hinge materials are shown in Fig 1a.  #@NEW_LINE#@#  The shape memory behavior of the hinges, including shape fixity and shape recovery, is controlled by the applied mechanical and thermal-temporal programming and recovery conditions.  #@NEW_LINE#@#  However, different programming methods can lead to the same recovery profile and fixity47 and we exploit this in the design of hinges.  #@NEW_LINE#@#  To understand the basic hinge behavior we consider a hinge printed with an initial angle of =90° and then programmed (by bending at TH=90°C) to assume a temporary flat state (=180°), which corresponds to a shape fixity of 100%.  #@NEW_LINE#@#  Then we recover the hinges to their original shape (=90°) by heating them in a constant temperature bath, during which we monitor the recovery of the hinges as a function of time.  #@NEW_LINE#@#  We quantify the shape recovery with the angular recovery ratio (Rr):  #@NEW_LINE#@#  
where (t) is the time dependent angle (Fig 1a).  #@NEW_LINE#@#  
The time-dependent angular recovery of the bending hinges can be examined by using a simple scaling approach with respect to the uniaxial shape memory behavior, which is modeled by a multi-branch constitutive model48,49,50 with 16 branches.  #@NEW_LINE#@#  Details regarding the model and its parameter identification can be found in the Supplementary Materials along with a demonstration of how it can be used to describe the rotational behavior of hinges during bending.  #@NEW_LINE#@#  Figure 1b shows the folding time at three different folding temperatures for the seven hinges by the 1D model.  #@NEW_LINE#@#  Here, the folding time is defined as the time needed for a hinge to fold to =91.8°, which corresponds to a recovery ratio of 98%.  #@NEW_LINE#@#  It can be seen that at the same folding temperature, hinges fabricated by higher Tg materials (the higher hinge numbers) need longer times to fold.  #@NEW_LINE#@#  In addition, the differences of folding times among these hinges increase as the temperature decreases.  #@NEW_LINE#@#  For example, if 80°C is used as the recovery temperature, the difference between H-1 and H-7 is about 7seconds; but at 100°C, the difference becomes about 2seconds.  #@NEW_LINE#@#  The differences in the folding times provide the opportunity to design the sequencing of folding, as will be shown next.  #@NEW_LINE#@#  

Sequential_self-folding  #@NEW_LINE#@#  
We design, fabricate by digital SMP printing, and test a seemingly-simple helical structure where rigid (non-active) panels are connected by active hinges on each corner with a radius of 5mm (Fig 2a).  #@NEW_LINE#@#  The thickness of the panels and hinges is 0.8mm, the depth is 6mm and the clearance between neighboring panels is 5mm.  #@NEW_LINE#@#  We program the self-folding structure by unfolding it into flat at an elevated programming temperature, which results in each of the hinges bending to the prescribed curvature.  #@NEW_LINE#@#  Here the prescribed curvature is achieved by a simple state of deformation (bending) and is amenable to analysis, but in general more complex deformations can be programmed.  #@NEW_LINE#@#  We then recover the desired final configuration by heating the structure uniformly to Tr.  #@NEW_LINE#@#  To demonstrate the importance of the folding dynamics and self-collisions in the process we design two structures that have identical geometry, but each has a different set of materials used for the hinges.  #@NEW_LINE#@#  In Sample 1 each of the 9 hinges uses the same SMP material (H-3), and in Sample 2 the hinges are made from seven different materials (H1-H7; Table 1).  #@NEW_LINE#@#  After printing the structure we deform it into a flat configuration in hot water at TH=90°C, which is above the Tg of all of the SMP sections.  #@NEW_LINE#@#  Then the sample is cooled to TL=10°C, at which all the SMP hinges are in their glassy states.  #@NEW_LINE#@#  After releasing the external load, the structure is fixed at the temporary straight shape.  #@NEW_LINE#@#  To activate the shape recovery of the structure, we immerse it in hot water with Tr=90°C so that all hinges experience the same thermal conditions.  #@NEW_LINE#@#  The shape recovery process is monitored by a video camera.  #@NEW_LINE#@#  
Figure 2b shows the recovery sequence of Sample 1.  #@NEW_LINE#@#  Since all the hinges possess the same thermomechanical behavior (H3 with Tg=~55°C), they start to recover their shape simultaneously.  #@NEW_LINE#@#  Before the inner hinges can fully fold, the outer layers of the sample coil back at the same speed.  #@NEW_LINE#@#  The uncoordinated and simultaneous motions of all hinges lead to two undesirable results.  #@NEW_LINE#@#  First, at ~7.5s, parts of the structure collide with each other because of folding pathway interference.  #@NEW_LINE#@#  The contact between different parts provides frictional resistance and leads to a significant reduction of folding speed.  #@NEW_LINE#@#  As seen in the figure, from 7.5s to 12.5s, folding proceeds slowly.  #@NEW_LINE#@#  Second, at 12.5s, the frictional force becomes so large that folding stops and the structure fails to reach its final target shape.  #@NEW_LINE#@#  
For the structure shown in Fig 2a, in order to recover its final target shape, the inner hinges require faster folding speeds than those of the outer hinges, which can be accomplished by assigning SMPs with lower Tgs.  #@NEW_LINE#@#  To this end we designed hinges unique to each corner as (shown as Case 2 in Table 1): H-1 with the lowest Tg (~32°C) is assigned to the two innermost corners; H-7 with highest Tg (~65°C) is assigned to the two outermost corners; the rest corners are assigned with hinges H-2 to H-6 with gradually increased Tg.  #@NEW_LINE#@#  
After experiencing the same programming procedure as described in the previous section, the structure is immersed in hot water at TH=90°C and the free recovery process is monitored.  #@NEW_LINE#@#  Figure 2c shows the snapshots of the material configurations at different recovery times, which visually demonstrates the sequential recovery of hinges to yield unconstrained and rapid (~7.0s) folding to the target configuration as shown in Fig 2c.  #@NEW_LINE#@#  The different folding speeds of the hinge sections due to their respective Tgs enable the avoidance of self-collisions.  #@NEW_LINE#@#  Since the folding speeds of the three inner hinges are faster than the outside ones, they first exhibit shape recovery (they start the shape recovery within ~1s and finish in ~3s).  #@NEW_LINE#@#  Then shape change is successively triggered along the helical line and the last two hinges start to recover after 3s and finish at ~7.0s.  #@NEW_LINE#@#  The hierarchical shape recovery profiles of the hinge sections enables the successful sequential shape recovery in the SMP component without interruption by collisions.  #@NEW_LINE#@#  
The above two cases demonstrate the importance of design and the ability to control the assembly sequence and dynamics by the spatial arrangement of SMPs with varying thermomechanical behavior.  #@NEW_LINE#@#  A bad design without careful coordination of different folding panels can lead to slower and even failed folding of the entire structure.  #@NEW_LINE#@#  

Folding_simulations__finite_element_analysis_and_reduced-order_model  #@NEW_LINE#@#  
To describe both unfolding and folding behaviors and use this understanding in the current design, we take a two-stage approach for analysis.  #@NEW_LINE#@#  First, we simulate the folding dynamics using finite element analysis (FEA).  #@NEW_LINE#@#  FEA provides high-fidelity simulation of the spatial and temporal variation of the programming (unfolding) and deployment (folding) processes as it accurately takes into account the complicated thermomechanical constitutive behavior of individual hinges as well as their interactions with the stiff, non-deforming panels.  #@NEW_LINE#@#  However, it is also time-consuming as it involves complicated contact (used for unfolding) as well as nonlinear geometrical mechanics.  #@NEW_LINE#@#  Since the panels are relatively rigid compared to the hinges and the focus of our work is the sequential folding and the potential issue of collisions during folding, we also develop a reduced-order model (ROM) to simulate rigid body motions of the panels (driven by the recovery of angular shape recovery of hinges) to investigate the folding pathways.  #@NEW_LINE#@#  During folding and unfolding the deformation is mainly localized in the hinges so in the ROM we idealize the structure as rigid panels connected by hinges with rotational behavior given by our constitutive model as described in Methods and Supplementary Materials sections.  #@NEW_LINE#@#  The simplicity offered by the ROM also facilitates the development of a simple criterion to predict if collisions will occur during self-folding before a structure is printed.  #@NEW_LINE#@#  
Figure 3a shows finite element simulations of the folding and unfolding processes.  #@NEW_LINE#@#  In the unfolding process, the structure is opened by rigid surfaces to successively unfold one panel after the other at a high temperature.  #@NEW_LINE#@#  After lowering the temperature and unloading, the structure is fixed into the flat configuration.  #@NEW_LINE#@#  Recovery is achieved by heating the structure uniformly and it folds into the original configuration as hinges are sequentially activated due to their individual time-dependent constitutive response.  #@NEW_LINE#@#  The simulated recovery ratios for representative hinges (H-1, H-4, and H-7) are presented in Fig 3b along with measurements and results form the ROM.  #@NEW_LINE#@#  The FEA predictions are in good agreement with the measurements, although they predict slightly faster folding than the experiment, probably due to the resistance from the water in the experiment, which is neglected in the simulation.  #@NEW_LINE#@#  Figure 3b also shows the ROM simulations and they are in good agreement with the FEA simulations and experiments.  #@NEW_LINE#@#  Figure 3c,d show ROM simulations of the two samples in Table 1.  #@NEW_LINE#@#  They describe both the unsuccessful (Fig 3c) and successful (Fig 3d) folding sequences well.  #@NEW_LINE#@#  Importantly the ROM captures the self-collisions that occur during the failed folding; based on this capability, we use it to design more complex folding scenarios in the next section.  #@NEW_LINE#@#  

Collision_determination  #@NEW_LINE#@#  
Utilizing the ROM simulation, we develop a simple collision index, which can be used to determine if two panels will collide during the folding process.  #@NEW_LINE#@#  As described in the Methods section, the collision index, Sij, is calculated based on the motion of any pair of panels (the i-th panel and the j-th panel) during each time increment of the simulation.  #@NEW_LINE#@#  In general, when 0less_thanSijless_than1, a collision will occur.  #@NEW_LINE#@#  Figure 4a,b show the collision indices of the two designs discussed above; there are 10 panels in each design which gives rise to 45 unique panel pairs.  #@NEW_LINE#@#  In Fig 4a, the structure can fold without collisions, therefore, no collision index falls between the band between 0 and 1 during the simulation.  #@NEW_LINE#@#  In Fig 3c two collisions occurred between panels and the structure cannot fold to its target shape; Fig 4b reflects this as two collision indices fall in span(0, 1).  #@NEW_LINE#@#  In the figure, the red dot between (0, 1) corresponds to first collision; the blue dot corresponds to the second collision.  #@NEW_LINE#@#  More collision will happen; but since our interest is the first collision, no further calculation is conducted.  #@NEW_LINE#@#  

A_self-locking_system  #@NEW_LINE#@#  
Here we use our ROM to design and then 3D print a self-folding and self-locking structure, as shown in Fig 5a.  #@NEW_LINE#@#  While this locking structure demonstrates the importance of controlling the folding sequence and how more complex structure folding can be obtained, we could also pursue other kinematic objectives such as making stops, kickstands, etc.  #@NEW_LINE#@#  Here, two holes with different dimensions are designed on one of the end panels.  #@NEW_LINE#@#  The objective is to sequentially guide the other end of the structure through the first hole and then through the second hole to lock the structure in place.  #@NEW_LINE#@#  The thickness of the SMP components is 0.6mm (0.8mm for the plates with holes) and the depth is 6mm.  #@NEW_LINE#@#  Five hinges (with a radius of 5mm in uniform) are used.  #@NEW_LINE#@#  
In order to ensure that the end of the strip passes through the two holes in sequence, we design each hinge to control the folding rate of each segment of the structure.  #@NEW_LINE#@#  This results in two requirements: First, the folding of hinges 1 and 2 should be faster than the others so that the two end sides reach each other in the correct position and angle.  #@NEW_LINE#@#  Second, folding of hinges 4 and 5 should be slower to guarantee them to pass through the two holes successively and then lock the structure.  #@NEW_LINE#@#  Using our ROM simulations with the collision index, we determined feasible folding rates for each hinge, and then realized them with hinges from Fig 1.  #@NEW_LINE#@#  Specifically we assigned hinges H-2, H-2, H-3, H-6 and H-6 for hinges 1 to 5 in Fig 5a.  #@NEW_LINE#@#  
The self-folding and self-locking structure is demonstrated experimentally in Fig 5.  #@NEW_LINE#@#  The structure shown in Fig 5a is first printed.  #@NEW_LINE#@#  At the temperature of 90°C, it is opened into a flat strip, or namely the unlocked configuration.  #@NEW_LINE#@#  It is then cooled to 10°C where the flat shape is maintained.  #@NEW_LINE#@#  After this programming step, the unlocked structure is immersed in hot water (90°C) and the free recovery process is monitored from both the top and side, as shown in the snapshots of Fig 5d.  #@NEW_LINE#@#  Fig 5b,c show the ROM simulated folding and locking procedure.  #@NEW_LINE#@#  As predicted by ROM, the active locking side is able to pass through the two holes successively, and finally recovers to the initial configuration.  #@NEW_LINE#@#  The ROM simulation and the experiment show good agreement.  #@NEW_LINE#@#  

A_3D_folding_structure  #@NEW_LINE#@#  
Folding boxes are notable folding structures in daily life and widely used in packaging.  #@NEW_LINE#@#  They normally require a folding sequence in order to form a stable and fully packed structure.  #@NEW_LINE#@#  Taking a USPS mailbox (Fig 6a) as an example, one can have a sheet of hard board paper cut into a specific shape.  #@NEW_LINE#@#  At the time of usage, one folds the box in a sequential manner; the red lines represent the first group of folds, where some lips are folded to form supports; the blue lines represents the second group of folds to partially close the box; the final folds (black lines) insert the two small lids (on the left top and bottom) into the holes formed by the long blue line folds to increase the stability of the box; also the white color patch represents glue that will seal the structure to from a final strong and stable box.  #@NEW_LINE#@#  Inspired by this, we design a 3D folding box with an internal locking mechanism, as shown in Fig 6b.  #@NEW_LINE#@#  Three types of hinges are used.  #@NEW_LINE#@#  Hinge H-3 is used on the smaller lips to enable fast folding of these lips (red lines).  #@NEW_LINE#@#  Hinge H-5 is used in the location indicated by the green line, to enable intermediate folding speeds such that some self-support and self-locking mechanism can be formed.  #@NEW_LINE#@#  Hinge H-6 (black lines) has the slowest folding speed and is used to form the final structure.  #@NEW_LINE#@#  The original shape of the box is shown in Fig 6c.  #@NEW_LINE#@#  Since curved portions of the hinges are not in the printing plane, these hinges are suspect to damage during unfolding.  #@NEW_LINE#@#  To improve the damage tolerance, hinges are specially designed (Fig 6df).  #@NEW_LINE#@#  A periodic step profile is employed along the surface contour of the hinge (Fig 6d).  #@NEW_LINE#@#  Thinner stepwise sections require lower bending stress and have higher thermal conductivity, making it both easier and faster to unfold complex assemblies.  #@NEW_LINE#@#  Additionally, the periodic profile allows for a wider range of bending motion since the hinge is not subject to restrictive compressive strains.  #@NEW_LINE#@#  Thicker stepwise sections serve to maintain part rigidity through higher average modulus than a thin hinge alone.  #@NEW_LINE#@#  To secure the interface between hinges and structural faces, the hinges are embedded within the structural faces and reinforced with a triangular interface to maximize axial strength (Fig 6e).  #@NEW_LINE#@#  Longer hinges are equipped with slots cut along the length of the jagged contours to isolate fracture points such that the assembly would not be compromised should a fracture occur (Fig 6f).  #@NEW_LINE#@#  Figure 6gj show the folding sequence.  #@NEW_LINE#@#  The whole structure folds back in about 11 seconds.  #@NEW_LINE#@#  


Discussion  #@NEW_LINE#@#  
Self-folding structures are an important contemporary research area that has great potential to impact a variety of technological applications, such as biomedical devices, soft robots, and space structures.  #@NEW_LINE#@#  In most previous work, self-folding was achieved by spatially controlled heating zones, which are generally difficult to fabricate.  #@NEW_LINE#@#  In this paper, we develop a new approach that results in easier manufacture of self-folding structures by 3D printing multimaterial integrated structures with hinges made of digital shape memory polymers with different thermomechanical properties at spatially-varying locations to facilitate self-folding by uniformly heating the structure after the thermomechanical programming step.  #@NEW_LINE#@#  Most previous efforts to self-folding have also focused on folded shapes that were kinematically simple in that the folded shape could be achieved without consideration of the sequence of folds.  #@NEW_LINE#@#  Even for fairly simple folded shapes as we considered here, we show folding path planning is critical for the successful completion of folding sequence, and this requires careful design of folding hinges.  #@NEW_LINE#@#  To this end we develop both high-fidelity finite element analysis simulations and a reduced-order model to describe the folding process.  #@NEW_LINE#@#  Although finite element simulations provide more comprehensive understanding of the folding procedure, it is time-consuming.  #@NEW_LINE#@#  The reduced-order model, which is verified by finite element simulations, considers the folding as rigid body motions of panels, whose motions are driven by the rotation of hinges with prescribed time-dependent constitutive response, and is able to capture the folding accurately and efficiently.  #@NEW_LINE#@#  When coupled with the collision index, it is an effective tool for the design of self-folding structures with complex kinematics, including self-locking and USPS mailbox.  #@NEW_LINE#@#  
There are some limitations of the current work.  #@NEW_LINE#@#  First, the shape memory effects in the 3D printed material can only have one-way actuation, i.e., if a second actuation is desirable, one has to conduct a second programming.  #@NEW_LINE#@#  The development of two-way actuation design is currently undertaken and will be reported in the near future.  #@NEW_LINE#@#  Second, folding time can be improved by using a higher recovery temperature.  #@NEW_LINE#@#  However, there is a limit on how fast an SMP can recovery, which we showed in our previous work to be about a few seconds49,51, as the total recovery time is determined by the times for heat transfer and material intrinsic recovery.  #@NEW_LINE#@#  Third, the printed materials tend to break easily, limiting the available reliable 3D structures.  #@NEW_LINE#@#  Therefore, it is desirable to have printed materials with good fracture toughness.  #@NEW_LINE#@#  
The development of practical and versatile digital SMP solids will enable self-adjusting and self-reinforcing structures to cope uniquely with different environmental conditions.  #@NEW_LINE#@#  It should be noted 3D printing is not the only method to create materials/structures with functional gradient.  #@NEW_LINE#@#  For example, functional graded SMPs were demonstrated before52.  #@NEW_LINE#@#  However, by using multimaterial 3D printing technology, self-folding structures using digital SMPs with both spontaneous and sequential folding behavior can be directly created with large design freedom and high resolution of spatial material properties distribution in complicated 3D structures.  #@NEW_LINE#@#  Besides, the manufacturing route can be easily implemented with the potential for immediate engineering applications for low-cost and rapid production.  #@NEW_LINE#@#  With the emergence of voxel printing, we believe the concept and examples demonstrated in this paper can be used for developing future self-deployable structure with more complicated folding patterns.  #@NEW_LINE#@#  

Methods  #@NEW_LINE#@#  
Materials_and_experiments  #@NEW_LINE#@#  
The materials used in this study are digital materials that are available from the multimaterial 3D printer (Objet Connex 260, Stratasys, Edina, MN, USA).  #@NEW_LINE#@#  The so-called digital materials refer to those created through mixing two base model materials, i.e., VeroWhite and Tangoblack, by jet spraying before UV curing.  #@NEW_LINE#@#  VeroWhite is a rigid plastic at room temperature polymerized with ink containing isobornyl acrylate, acrylic monomer, urethane acrylate, epoxy acrylate, acrylic monomer, acrylic oligomer, and photo-initiators.  #@NEW_LINE#@#  TangoBlack is a rubbery material at room temperature polymerized by monomers containing urethane acrylate oligomer, Exo-1,7,7-trimethylbicyclo [2.2.1] hept-2-yl acrylate, methacrylate oligomer, polyurethane resin and photo-initiators.  #@NEW_LINE#@#  The digital materials consist of varying compositions of these two materials that lead to different thermomechanical properties.  #@NEW_LINE#@#  In this work, the thermomechanical properties of seven digital materials (respectively labeled as polymer 1-7) are tested.  #@NEW_LINE#@#  After all the samples are printed with the dimension of 15mm (height)×3mm(width)×0.6mm(thickness), thermomechanical properties of these polymers are characterized by a dynamic mechanical analyzer (DMA, Model Q800, TA Instruments, New Castle, DE, USA).  #@NEW_LINE#@#  The samples are firstly heated to 100°C in the DMA tester and stabilized for 20minutes to ensure thermal equilibrium, then a preload of 1KPa is applied.  #@NEW_LINE#@#  During the DMA test, the strain is oscillated at a frequency of 1Hz with a peak-to-peak amplitude of 0.1% while the temperature is decreased from 100°C to a prescribed low temperature at a rate of 2°C/min.  #@NEW_LINE#@#  The temperature corresponding to the peak of the tan  curve is taken to be the glass transition temperature Tg 53,54 (Fig S2).  #@NEW_LINE#@#  

Finite_element_analysis_simulations  #@NEW_LINE#@#  
FEA simulations of unfolding and folding as shown in Fig 3 are conducted using the FEA software ABAQUS (Simulia, Providence, RI, USA) with a user-defined constitutive model implemented in a UMAT subroutine.  #@NEW_LINE#@#  The fitted material parameters are imported into the 3D finite deformation constitutive model.  #@NEW_LINE#@#  To simplify the FEA simulation, a 2D plane strain model is used.  #@NEW_LINE#@#  The hybrid CPE4HT element in ABAQUS element library is used, and hinge assignments are shown as case 2 in Table 1 while the non-active panels are considered as a linear elastic material with high modulus of 1GPa, which is much higher than the modulus of the SMPs in their rubbery state.  #@NEW_LINE#@#  For the FEA simulation, the strip is firstly unfolded into a straight configuration at 90°C, which is above Tg of all the SMP material sections, as shown as the process in Fig 3a by using rigid surfaces to unfold one panel after the other, which is consistent with the prescribed deformation of the experiments.  #@NEW_LINE#@#  Once the whole structure is deformed into a flat plate, it is cooled to 10°C, where all the hinge sections are in their glassy states.  #@NEW_LINE#@#  The external loading and constraints are then removed and the temporary configuration is fixed.  #@NEW_LINE#@#  The structure is then uniformly heated to a high temperature, causing the structure to fold sequentially.  #@NEW_LINE#@#  

Reduced-order_model_simulations  #@NEW_LINE#@#  
We use the scaling rule to predict the shape recovery ratio of hinge by the recovery behavior of a sample under linear stretch.  #@NEW_LINE#@#  Here, we assume that the folding structure can be represented by rigid panels connected by hinges, which occupy infinitesimal space but control the angles between two panels.  #@NEW_LINE#@#  Figure 7 shows panels are connected by hinges, which are represented by Pi with its coordinates of (xi, yi) for the i-th hinge.  #@NEW_LINE#@#  
In the ROM, we assume that the angular rotation of the hinge is equal to the linear recovery ratio of a SMP.  #@NEW_LINE#@#  This assumption is validated in the Supplementary Material.  #@NEW_LINE#@#  Following Eq.  #@NEW_LINE#@#  1, we have  #@NEW_LINE#@#  
where  is the angle between the i-th panel and (i+1)-th panel,  is the recovery ratio of the i-th hinge, which is between the i-th and (i+1)-th panels.  #@NEW_LINE#@#  In order to calculate the location of the hinges, the orientation of the i-th panel is calculated as  #@NEW_LINE#@#  
where  is the orientation of i-th panel.  #@NEW_LINE#@#  Finally, the coordinates of the i-th hinges are  #@NEW_LINE#@#  
where  is the length of the i-th panel.  #@NEW_LINE#@#  

Collision_index  #@NEW_LINE#@#  
We consider two arbitrary panels in the structure (as shown in Fig 6), denoted as Li, Lj, with coordinates of points as , , respectively.  #@NEW_LINE#@#  The parametric equation for the i-th panel (denoted as a solid line) is given as  #@NEW_LINE#@#  
where S is a parameter that is the distance from point i to point (x, y) normalized by the length of the panel.  #@NEW_LINE#@#  Therefore, for the point (x, y) on the panel, 0less_thanSless_than1.  #@NEW_LINE#@#  By using the parametric equations of the i-th panel and the j-th panel, the coordinates of the intersection between these two panels can be calculated as Cij(xij, yij).  #@NEW_LINE#@#  Substituting the coordinate of intersection point (Cij(xij, yij)) into the i-th line equation (Eq.  #@NEW_LINE#@#  (4)) yields a parametric index Si.  #@NEW_LINE#@#  When 0Si1, the intersection point is on the i-th panel, while when Si1 or Siless_than0 the intersection point sits on the extension line of the i-th panel.  #@NEW_LINE#@#  The same is true for parametric index, Sj, for the j-th panel.  #@NEW_LINE#@#  It is thus easy to conclude that when the two panels intersect, we have 0Si1 and 0Sj1; otherwise there is no intersection.  #@NEW_LINE#@#  We further define an interaction index for intersection of line i and line j as  #@NEW_LINE#@#  
In general, when 0less_thanSijless_than1, intersection occurs.  #@NEW_LINE#@#  However, three cases that can give 0less_thanSijless_than1 but no intersection: (1) 0less_thanSiless_than1 and Sj1 (for example, Sj is slightly larger than 1); (2) 0less_thanSjless_than1 and Si1 (for example, Si is slightly larger than 1); (3) Siless_than0 and Sjless_than0.  #@NEW_LINE#@#  
In ROM simulations, at each time increment, the coordinates of individual hinge points are first calculated; the intersections points and the intersection indices are calculated.  #@NEW_LINE#@#  If 0less_thanSijless_than1, the above three conditions will be checked; if any one of them is satisfied, there is no intersection; otherwise, an intersection exits and folding cannot be completed.  #@NEW_LINE#@#  




